!function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,function(t,e){"use strict";var n=[],r=t.document,i=Object.getPrototypeOf,o=n.slice,a=n.concat,s=n.push,u=n.indexOf,c={},l=c.toString,h=c.hasOwnProperty,f=h.toString,d=f.call(Object),p={},m=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType},g=function(t){return null!=t&&t===t.window},v={type:!0,src:!0,noModule:!0};function y(t,e,n){var i,o=(e=e||r).createElement("script");if(o.text=t,n)for(i in v)n[i]&&(o[i]=n[i]);e.head.appendChild(o).parentNode.removeChild(o)}function w(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?c[l.call(t)]||"object":typeof t}var b=function(t,e){return new b.fn.init(t,e)},x=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function _(t){var e=!!t&&"length"in t&&t.length,n=w(t);return!m(t)&&!g(t)&&("array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t)}b.fn=b.prototype={jquery:"3.3.1",constructor:b,length:0,toArray:function(){return o.call(this)},get:function(t){return null==t?o.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=b.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return b.each(this,t)},map:function(t){return this.pushStack(b.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return this.pushStack(o.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(n>=0&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:n.sort,splice:n.splice},b.extend=b.fn.extend=function(){var t,e,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[s]||{},s++),"object"==typeof a||m(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(t=arguments[s]))for(e in t)n=a[e],a!==(r=t[e])&&(c&&r&&(b.isPlainObject(r)||(i=Array.isArray(r)))?(i?(i=!1,o=n&&Array.isArray(n)?n:[]):o=n&&b.isPlainObject(n)?n:{},a[e]=b.extend(c,o,r)):void 0!==r&&(a[e]=r));return a},b.extend({expando:"jQuery"+("3.3.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,n;return!(!t||"[object Object]"!==l.call(t)||(e=i(t))&&("function"!=typeof(n=h.call(e,"constructor")&&e.constructor)||f.call(n)!==d))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t){y(t)},each:function(t,e){var n,r=0;if(_(t))for(n=t.length;r<n&&!1!==e.call(t[r],r,t[r]);r++);else for(r in t)if(!1===e.call(t[r],r,t[r]))break;return t},trim:function(t){return null==t?"":(t+"").replace(x,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(_(Object(t))?b.merge(n,"string"==typeof t?[t]:t):s.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:u.call(e,t,n)},merge:function(t,e){for(var n=+e.length,r=0,i=t.length;r<n;r++)t[i++]=e[r];return t.length=i,t},grep:function(t,e,n){for(var r=[],i=0,o=t.length,a=!n;i<o;i++)!e(t[i],i)!==a&&r.push(t[i]);return r},map:function(t,e,n){var r,i,o=0,s=[];if(_(t))for(r=t.length;o<r;o++)null!=(i=e(t[o],o,n))&&s.push(i);else for(o in t)null!=(i=e(t[o],o,n))&&s.push(i);return a.apply([],s)},guid:1,support:p}),"function"==typeof Symbol&&(b.fn[Symbol.iterator]=n[Symbol.iterator]),b.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){c["[object "+e+"]"]=e.toLowerCase()});var M=function(t){var e,n,r,i,o,a,s,u,c,l,h,f,d,p,m,g,v,y,w,b="sizzle"+1*new Date,x=t.document,_=0,M=0,E=at(),S=at(),T=at(),A=function(t,e){return t===e&&(h=!0),0},k={}.hasOwnProperty,C=[],R=C.pop,D=C.push,L=C.push,O=C.slice,P=function(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1},I="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",N="[\\x20\\t\\r\\n\\f]",F="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",j="\\["+N+"*("+F+")(?:"+N+"*([*^$|!~]?=)"+N+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+F+"))|)"+N+"*\\]",z=":("+F+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+j+")*)|.*)\\)|)",U=new RegExp(N+"+","g"),V=new RegExp("^"+N+"+|((?:^|[^\\\\])(?:\\\\.)*)"+N+"+$","g"),B=new RegExp("^"+N+"*,"+N+"*"),H=new RegExp("^"+N+"*([>+~]|"+N+")"+N+"*"),q=new RegExp("="+N+"*([^\\]'\"]*?)"+N+"*\\]","g"),G=new RegExp(z),W=new RegExp("^"+F+"$"),Y={ID:new RegExp("^#("+F+")"),CLASS:new RegExp("^\\.("+F+")"),TAG:new RegExp("^("+F+"|[*])"),ATTR:new RegExp("^"+j),PSEUDO:new RegExp("^"+z),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+N+"*(even|odd|(([+-]|)(\\d*)n|)"+N+"*(?:([+-]|)"+N+"*(\\d+)|))"+N+"*\\)|)","i"),bool:new RegExp("^(?:"+I+")$","i"),needsContext:new RegExp("^"+N+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+N+"*((?:-\\d)?\\d*)"+N+"*\\)|)(?=[^-]|$)","i")},X=/^(?:input|select|textarea|button)$/i,$=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Z=/[+~]/,K=new RegExp("\\\\([\\da-f]{1,6}"+N+"?|("+N+")|.)","ig"),tt=function(t,e,n){var r="0x"+e-65536;return r!=r||n?e:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},et=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,nt=function(t,e){return e?"\0"===t?"\ufffd":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},rt=function(){f()},it=yt(function(t){return!0===t.disabled&&("form"in t||"label"in t)},{dir:"parentNode",next:"legend"});try{L.apply(C=O.call(x.childNodes),x.childNodes)}catch(t){L={apply:C.length?function(t,e){D.apply(t,O.call(e))}:function(t,e){for(var n=t.length,r=0;t[n++]=e[r++];);t.length=n-1}}}function ot(t,e,r,i){var o,s,c,l,h,p,v,y=e&&e.ownerDocument,_=e?e.nodeType:9;if(r=r||[],"string"!=typeof t||!t||1!==_&&9!==_&&11!==_)return r;if(!i&&((e?e.ownerDocument||e:x)!==d&&f(e),e=e||d,m)){if(11!==_&&(h=J.exec(t)))if(o=h[1]){if(9===_){if(!(c=e.getElementById(o)))return r;if(c.id===o)return r.push(c),r}else if(y&&(c=y.getElementById(o))&&w(e,c)&&c.id===o)return r.push(c),r}else{if(h[2])return L.apply(r,e.getElementsByTagName(t)),r;if((o=h[3])&&n.getElementsByClassName&&e.getElementsByClassName)return L.apply(r,e.getElementsByClassName(o)),r}if(n.qsa&&!T[t+" "]&&(!g||!g.test(t))){if(1!==_)y=e,v=t;else if("object"!==e.nodeName.toLowerCase()){for((l=e.getAttribute("id"))?l=l.replace(et,nt):e.setAttribute("id",l=b),s=(p=a(t)).length;s--;)p[s]="#"+l+" "+vt(p[s]);v=p.join(","),y=Z.test(t)&&mt(e.parentNode)||e}if(v)try{return L.apply(r,y.querySelectorAll(v)),r}catch(t){}finally{l===b&&e.removeAttribute("id")}}}return u(t.replace(V,"$1"),e,r,i)}function at(){var t=[];return function e(n,i){return t.push(n+" ")>r.cacheLength&&delete e[t.shift()],e[n+" "]=i}}function st(t){return t[b]=!0,t}function ut(t){var e=d.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ct(t,e){for(var n=t.split("|"),i=n.length;i--;)r.attrHandle[n[i]]=e}function lt(t,e){var n=e&&t,r=n&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function ht(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ft(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function dt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&it(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function pt(t){return st(function(e){return e=+e,st(function(n,r){for(var i,o=t([],n.length,e),a=o.length;a--;)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}function mt(t){return t&&"undefined"!=typeof t.getElementsByTagName&&t}for(e in n=ot.support={},o=ot.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},f=ot.setDocument=function(t){var e,i,a=t?t.ownerDocument||t:x;return a!==d&&9===a.nodeType&&a.documentElement?(p=(d=a).documentElement,m=!o(d),x!==d&&(i=d.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",rt,!1):i.attachEvent&&i.attachEvent("onunload",rt)),n.attributes=ut(function(t){return t.className="i",!t.getAttribute("className")}),n.getElementsByTagName=ut(function(t){return t.appendChild(d.createComment("")),!t.getElementsByTagName("*").length}),n.getElementsByClassName=Q.test(d.getElementsByClassName),n.getById=ut(function(t){return p.appendChild(t).id=b,!d.getElementsByName||!d.getElementsByName(b).length}),n.getById?(r.filter.ID=function(t){var e=t.replace(K,tt);return function(t){return t.getAttribute("id")===e}},r.find.ID=function(t,e){if("undefined"!=typeof e.getElementById&&m){var n=e.getElementById(t);return n?[n]:[]}}):(r.filter.ID=function(t){var e=t.replace(K,tt);return function(t){var n="undefined"!=typeof t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}},r.find.ID=function(t,e){if("undefined"!=typeof e.getElementById&&m){var n,r,i,o=e.getElementById(t);if(o){if((n=o.getAttributeNode("id"))&&n.value===t)return[o];for(i=e.getElementsByName(t),r=0;o=i[r++];)if((n=o.getAttributeNode("id"))&&n.value===t)return[o]}return[]}}),r.find.TAG=n.getElementsByTagName?function(t,e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t):n.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,r=[],i=0,o=e.getElementsByTagName(t);if("*"===t){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},r.find.CLASS=n.getElementsByClassName&&function(t,e){if("undefined"!=typeof e.getElementsByClassName&&m)return e.getElementsByClassName(t)},v=[],g=[],(n.qsa=Q.test(d.querySelectorAll))&&(ut(function(t){p.appendChild(t).innerHTML="<a id='"+b+"'></a><select id='"+b+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&g.push("[*^$]="+N+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||g.push("\\["+N+"*(?:value|"+I+")"),t.querySelectorAll("[id~="+b+"-]").length||g.push("~="),t.querySelectorAll(":checked").length||g.push(":checked"),t.querySelectorAll("a#"+b+"+*").length||g.push(".#.+[+~]")}),ut(function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=d.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&g.push("name"+N+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&g.push(":enabled",":disabled"),p.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&g.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),g.push(",.*:")})),(n.matchesSelector=Q.test(y=p.matches||p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&ut(function(t){n.disconnectedMatch=y.call(t,"*"),y.call(t,"[s!='']:x"),v.push("!=",z)}),g=g.length&&new RegExp(g.join("|")),v=v.length&&new RegExp(v.join("|")),e=Q.test(p.compareDocumentPosition),w=e||Q.test(p.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,r=e&&e.parentNode;return t===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):t.compareDocumentPosition&&16&t.compareDocumentPosition(r)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},A=e?function(t,e){if(t===e)return h=!0,0;var r=!t.compareDocumentPosition-!e.compareDocumentPosition;return r||(1&(r=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!n.sortDetached&&e.compareDocumentPosition(t)===r?t===d||t.ownerDocument===x&&w(x,t)?-1:e===d||e.ownerDocument===x&&w(x,e)?1:l?P(l,t)-P(l,e):0:4&r?-1:1)}:function(t,e){if(t===e)return h=!0,0;var n,r=0,i=t.parentNode,o=e.parentNode,a=[t],s=[e];if(!i||!o)return t===d?-1:e===d?1:i?-1:o?1:l?P(l,t)-P(l,e):0;if(i===o)return lt(t,e);for(n=t;n=n.parentNode;)a.unshift(n);for(n=e;n=n.parentNode;)s.unshift(n);for(;a[r]===s[r];)r++;return r?lt(a[r],s[r]):a[r]===x?-1:s[r]===x?1:0},d):d},ot.matches=function(t,e){return ot(t,null,null,e)},ot.matchesSelector=function(t,e){if((t.ownerDocument||t)!==d&&f(t),e=e.replace(q,"='$1']"),n.matchesSelector&&m&&!T[e+" "]&&(!v||!v.test(e))&&(!g||!g.test(e)))try{var r=y.call(t,e);if(r||n.disconnectedMatch||t.document&&11!==t.document.nodeType)return r}catch(t){}return ot(e,d,null,[t]).length>0},ot.contains=function(t,e){return(t.ownerDocument||t)!==d&&f(t),w(t,e)},ot.attr=function(t,e){(t.ownerDocument||t)!==d&&f(t);var i=r.attrHandle[e.toLowerCase()],o=i&&k.call(r.attrHandle,e.toLowerCase())?i(t,e,!m):void 0;return void 0!==o?o:n.attributes||!m?t.getAttribute(e):(o=t.getAttributeNode(e))&&o.specified?o.value:null},ot.escape=function(t){return(t+"").replace(et,nt)},ot.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},ot.uniqueSort=function(t){var e,r=[],i=0,o=0;if(h=!n.detectDuplicates,l=!n.sortStable&&t.slice(0),t.sort(A),h){for(;e=t[o++];)e===t[o]&&(i=r.push(o));for(;i--;)t.splice(r[i],1)}return l=null,t},i=ot.getText=function(t){var e,n="",r=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=i(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[r++];)n+=i(e);return n},(r=ot.selectors={cacheLength:50,createPseudo:st,match:Y,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(K,tt),t[3]=(t[3]||t[4]||t[5]||"").replace(K,tt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||ot.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&ot.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return Y.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&G.test(n)&&(e=a(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(K,tt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=E[t+" "];return e||(e=new RegExp("(^|"+N+")"+t+"("+N+"|$)"))&&E(t,function(t){return e.test("string"==typeof t.className&&t.className||"undefined"!=typeof t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,e,n){return function(r){var i=ot.attr(r,t);return null==i?"!="===e:!e||(i+="","="===e?i===n:"!="===e?i!==n:"^="===e?n&&0===i.indexOf(n):"*="===e?n&&i.indexOf(n)>-1:"$="===e?n&&i.slice(-n.length)===n:"~="===e?(" "+i.replace(U," ")+" ").indexOf(n)>-1:"|="===e&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,r,i){var o="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;return 1===r&&0===i?function(t){return!!t.parentNode}:function(e,n,u){var c,l,h,f,d,p,m=o!==a?"nextSibling":"previousSibling",g=e.parentNode,v=s&&e.nodeName.toLowerCase(),y=!u&&!s,w=!1;if(g){if(o){for(;m;){for(f=e;f=f[m];)if(s?f.nodeName.toLowerCase()===v:1===f.nodeType)return!1;p=m="only"===t&&!p&&"nextSibling"}return!0}if(p=[a?g.firstChild:g.lastChild],a&&y){for(w=(d=(c=(l=(h=(f=g)[b]||(f[b]={}))[f.uniqueID]||(h[f.uniqueID]={}))[t]||[])[0]===_&&c[1])&&c[2],f=d&&g.childNodes[d];f=++d&&f&&f[m]||(w=d=0)||p.pop();)if(1===f.nodeType&&++w&&f===e){l[t]=[_,d,w];break}}else if(y&&(w=d=(c=(l=(h=(f=e)[b]||(f[b]={}))[f.uniqueID]||(h[f.uniqueID]={}))[t]||[])[0]===_&&c[1]),!1===w)for(;(f=++d&&f&&f[m]||(w=d=0)||p.pop())&&((s?f.nodeName.toLowerCase()!==v:1!==f.nodeType)||!++w||(y&&((l=(h=f[b]||(f[b]={}))[f.uniqueID]||(h[f.uniqueID]={}))[t]=[_,w]),f!==e)););return(w-=i)===r||w%r==0&&w/r>=0}}},PSEUDO:function(t,e){var n,i=r.pseudos[t]||r.setFilters[t.toLowerCase()]||ot.error("unsupported pseudo: "+t);return i[b]?i(e):i.length>1?(n=[t,t,"",e],r.setFilters.hasOwnProperty(t.toLowerCase())?st(function(t,n){for(var r,o=i(t,e),a=o.length;a--;)t[r=P(t,o[a])]=!(n[r]=o[a])}):function(t){return i(t,0,n)}):i}},pseudos:{not:st(function(t){var e=[],n=[],r=s(t.replace(V,"$1"));return r[b]?st(function(t,e,n,i){for(var o,a=r(t,null,i,[]),s=t.length;s--;)(o=a[s])&&(t[s]=!(e[s]=o))}):function(t,i,o){return e[0]=t,r(e,null,o,n),e[0]=null,!n.pop()}}),has:st(function(t){return function(e){return ot(t,e).length>0}}),contains:st(function(t){return t=t.replace(K,tt),function(e){return(e.textContent||e.innerText||i(e)).indexOf(t)>-1}}),lang:st(function(t){return W.test(t||"")||ot.error("unsupported lang: "+t),t=t.replace(K,tt).toLowerCase(),function(e){var n;do{if(n=m?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===p},focus:function(t){return t===d.activeElement&&(!d.hasFocus||d.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:dt(!1),disabled:dt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!r.pseudos.empty(t)},header:function(t){return $.test(t.nodeName)},input:function(t){return X.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:pt(function(){return[0]}),last:pt(function(t,e){return[e-1]}),eq:pt(function(t,e,n){return[n<0?n+e:n]}),even:pt(function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t}),odd:pt(function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t}),lt:pt(function(t,e,n){for(var r=n<0?n+e:n;--r>=0;)t.push(r);return t}),gt:pt(function(t,e,n){for(var r=n<0?n+e:n;++r<e;)t.push(r);return t})}}).pseudos.nth=r.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[e]=ht(e);for(e in{submit:!0,reset:!0})r.pseudos[e]=ft(e);function gt(){}function vt(t){for(var e=0,n=t.length,r="";e<n;e++)r+=t[e].value;return r}function yt(t,e,n){var r=e.dir,i=e.next,o=i||r,a=n&&"parentNode"===o,s=M++;return e.first?function(e,n,i){for(;e=e[r];)if(1===e.nodeType||a)return t(e,n,i);return!1}:function(e,n,u){var c,l,h,f=[_,s];if(u){for(;e=e[r];)if((1===e.nodeType||a)&&t(e,n,u))return!0}else for(;e=e[r];)if(1===e.nodeType||a)if(l=(h=e[b]||(e[b]={}))[e.uniqueID]||(h[e.uniqueID]={}),i&&i===e.nodeName.toLowerCase())e=e[r]||e;else{if((c=l[o])&&c[0]===_&&c[1]===s)return f[2]=c[2];if(l[o]=f,f[2]=t(e,n,u))return!0}return!1}}function wt(t){return t.length>1?function(e,n,r){for(var i=t.length;i--;)if(!t[i](e,n,r))return!1;return!0}:t[0]}function bt(t,e,n,r,i){for(var o,a=[],s=0,u=t.length,c=null!=e;s<u;s++)(o=t[s])&&(n&&!n(o,r,i)||(a.push(o),c&&e.push(s)));return a}function xt(t,e,n,r,i,o){return r&&!r[b]&&(r=xt(r)),i&&!i[b]&&(i=xt(i,o)),st(function(o,a,s,u){var c,l,h,f=[],d=[],p=a.length,m=o||function(t,e,n){for(var r=0,i=e.length;r<i;r++)ot(t,e[r],n);return n}(e||"*",s.nodeType?[s]:s,[]),g=!t||!o&&e?m:bt(m,f,t,s,u),v=n?i||(o?t:p||r)?[]:a:g;if(n&&n(g,v,s,u),r)for(c=bt(v,d),r(c,[],s,u),l=c.length;l--;)(h=c[l])&&(v[d[l]]=!(g[d[l]]=h));if(o){if(i||t){if(i){for(c=[],l=v.length;l--;)(h=v[l])&&c.push(g[l]=h);i(null,v=[],c,u)}for(l=v.length;l--;)(h=v[l])&&(c=i?P(o,h):f[l])>-1&&(o[c]=!(a[c]=h))}}else v=bt(v===a?v.splice(p,v.length):v),i?i(null,a,v,u):L.apply(a,v)})}function _t(t){for(var e,n,i,o=t.length,a=r.relative[t[0].type],s=a||r.relative[" "],u=a?1:0,l=yt(function(t){return t===e},s,!0),h=yt(function(t){return P(e,t)>-1},s,!0),f=[function(t,n,r){var i=!a&&(r||n!==c)||((e=n).nodeType?l(t,n,r):h(t,n,r));return e=null,i}];u<o;u++)if(n=r.relative[t[u].type])f=[yt(wt(f),n)];else{if((n=r.filter[t[u].type].apply(null,t[u].matches))[b]){for(i=++u;i<o&&!r.relative[t[i].type];i++);return xt(u>1&&wt(f),u>1&&vt(t.slice(0,u-1).concat({value:" "===t[u-2].type?"*":""})).replace(V,"$1"),n,u<i&&_t(t.slice(u,i)),i<o&&_t(t=t.slice(i)),i<o&&vt(t))}f.push(n)}return wt(f)}return gt.prototype=r.filters=r.pseudos,r.setFilters=new gt,a=ot.tokenize=function(t,e){var n,i,o,a,s,u,c,l=S[t+" "];if(l)return e?0:l.slice(0);for(s=t,u=[],c=r.preFilter;s;){for(a in n&&!(i=B.exec(s))||(i&&(s=s.slice(i[0].length)||s),u.push(o=[])),n=!1,(i=H.exec(s))&&(n=i.shift(),o.push({value:n,type:i[0].replace(V," ")}),s=s.slice(n.length)),r.filter)!(i=Y[a].exec(s))||c[a]&&!(i=c[a](i))||(n=i.shift(),o.push({value:n,type:a,matches:i}),s=s.slice(n.length));if(!n)break}return e?s.length:s?ot.error(t):S(t,u).slice(0)},s=ot.compile=function(t,e){var n,i=[],o=[],s=T[t+" "];if(!s){for(e||(e=a(t)),n=e.length;n--;)(s=_t(e[n]))[b]?i.push(s):o.push(s);(s=T(t,function(t,e){var n=e.length>0,i=t.length>0,o=function(o,a,s,u,l){var h,p,g,v=0,y="0",w=o&&[],b=[],x=c,M=o||i&&r.find.TAG("*",l),E=_+=null==x?1:Math.random()||.1,S=M.length;for(l&&(c=a===d||a||l);y!==S&&null!=(h=M[y]);y++){if(i&&h){for(p=0,a||h.ownerDocument===d||(f(h),s=!m);g=t[p++];)if(g(h,a||d,s)){u.push(h);break}l&&(_=E)}n&&((h=!g&&h)&&v--,o&&w.push(h))}if(v+=y,n&&y!==v){for(p=0;g=e[p++];)g(w,b,a,s);if(o){if(v>0)for(;y--;)w[y]||b[y]||(b[y]=R.call(u));b=bt(b)}L.apply(u,b),l&&!o&&b.length>0&&v+e.length>1&&ot.uniqueSort(u)}return l&&(_=E,c=x),w};return n?st(o):o}(o,i))).selector=t}return s},u=ot.select=function(t,e,n,i){var o,u,c,l,h,f="function"==typeof t&&t,d=!i&&a(t=f.selector||t);if(n=n||[],1===d.length){if((u=d[0]=d[0].slice(0)).length>2&&"ID"===(c=u[0]).type&&9===e.nodeType&&m&&r.relative[u[1].type]){if(!(e=(r.find.ID(c.matches[0].replace(K,tt),e)||[])[0]))return n;f&&(e=e.parentNode),t=t.slice(u.shift().value.length)}for(o=Y.needsContext.test(t)?0:u.length;o--&&!r.relative[l=(c=u[o]).type];)if((h=r.find[l])&&(i=h(c.matches[0].replace(K,tt),Z.test(u[0].type)&&mt(e.parentNode)||e))){if(u.splice(o,1),!(t=i.length&&vt(u)))return L.apply(n,i),n;break}}return(f||s(t,d))(i,e,!m,n,!e||Z.test(t)&&mt(e.parentNode)||e),n},n.sortStable=b.split("").sort(A).join("")===b,n.detectDuplicates=!!h,f(),n.sortDetached=ut(function(t){return 1&t.compareDocumentPosition(d.createElement("fieldset"))}),ut(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||ct("type|href|height|width",function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),n.attributes&&ut(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||ct("value",function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),ut(function(t){return null==t.getAttribute("disabled")})||ct(I,function(t,e,n){var r;if(!n)return!0===t[e]?e.toLowerCase():(r=t.getAttributeNode(e))&&r.specified?r.value:null}),ot}(t);b.find=M,b.expr=M.selectors,b.expr[":"]=b.expr.pseudos,b.uniqueSort=b.unique=M.uniqueSort,b.text=M.getText,b.isXMLDoc=M.isXML,b.contains=M.contains,b.escapeSelector=M.escape;var E=function(t,e,n){for(var r=[],i=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(i&&b(t).is(n))break;r.push(t)}return r},S=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},T=b.expr.match.needsContext;function A(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var k=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function C(t,e,n){return m(e)?b.grep(t,function(t,r){return!!e.call(t,r,t)!==n}):e.nodeType?b.grep(t,function(t){return t===e!==n}):"string"!=typeof e?b.grep(t,function(t){return u.call(e,t)>-1!==n}):b.filter(e,t,n)}b.filter=function(t,e,n){var r=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===r.nodeType?b.find.matchesSelector(r,t)?[r]:[]:b.find.matches(t,b.grep(e,function(t){return 1===t.nodeType}))},b.fn.extend({find:function(t){var e,n,r=this.length,i=this;if("string"!=typeof t)return this.pushStack(b(t).filter(function(){for(e=0;e<r;e++)if(b.contains(i[e],this))return!0}));for(n=this.pushStack([]),e=0;e<r;e++)b.find(t,i[e],n);return r>1?b.uniqueSort(n):n},filter:function(t){return this.pushStack(C(this,t||[],!1))},not:function(t){return this.pushStack(C(this,t||[],!0))},is:function(t){return!!C(this,"string"==typeof t&&T.test(t)?b(t):t||[],!1).length}});var R,D=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(b.fn.init=function(t,e,n){var i,o;if(!t)return this;if(n=n||R,"string"==typeof t){if(!(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:D.exec(t))||!i[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(i[1]){if(b.merge(this,b.parseHTML(i[1],(e=e instanceof b?e[0]:e)&&e.nodeType?e.ownerDocument||e:r,!0)),k.test(i[1])&&b.isPlainObject(e))for(i in e)m(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return(o=r.getElementById(i[2]))&&(this[0]=o,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):m(t)?void 0!==n.ready?n.ready(t):t(b):b.makeArray(t,this)}).prototype=b.fn,R=b(r);var L=/^(?:parents|prev(?:Until|All))/,O={children:!0,contents:!0,next:!0,prev:!0};function P(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}b.fn.extend({has:function(t){var e=b(t,this),n=e.length;return this.filter(function(){for(var t=0;t<n;t++)if(b.contains(this,e[t]))return!0})},closest:function(t,e){var n,r=0,i=this.length,o=[],a="string"!=typeof t&&b(t);if(!T.test(t))for(;r<i;r++)for(n=this[r];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&b.find.matchesSelector(n,t))){o.push(n);break}return this.pushStack(o.length>1?b.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?u.call(b(t),this[0]):u.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(b.uniqueSort(b.merge(this.get(),b(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),b.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return E(t,"parentNode")},parentsUntil:function(t,e,n){return E(t,"parentNode",n)},next:function(t){return P(t,"nextSibling")},prev:function(t){return P(t,"previousSibling")},nextAll:function(t){return E(t,"nextSibling")},prevAll:function(t){return E(t,"previousSibling")},nextUntil:function(t,e,n){return E(t,"nextSibling",n)},prevUntil:function(t,e,n){return E(t,"previousSibling",n)},siblings:function(t){return S((t.parentNode||{}).firstChild,t)},children:function(t){return S(t.firstChild)},contents:function(t){return A(t,"iframe")?t.contentDocument:(A(t,"template")&&(t=t.content||t),b.merge([],t.childNodes))}},function(t,e){b.fn[t]=function(n,r){var i=b.map(this,e,n);return"Until"!==t.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=b.filter(r,i)),this.length>1&&(O[t]||b.uniqueSort(i),L.test(t)&&i.reverse()),this.pushStack(i)}});var I=/[^\x20\t\r\n\f]+/g;function N(t){return t}function F(t){throw t}function j(t,e,n,r){var i;try{t&&m(i=t.promise)?i.call(t).done(e).fail(n):t&&m(i=t.then)?i.call(t,e,n):e.apply(void 0,[t].slice(r))}catch(t){n.apply(void 0,[t])}}b.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return b.each(t.match(I)||[],function(t,n){e[n]=!0}),e}(t):b.extend({},t);var e,n,r,i,o=[],a=[],s=-1,u=function(){for(i=i||t.once,r=e=!0;a.length;s=-1)for(n=a.shift();++s<o.length;)!1===o[s].apply(n[0],n[1])&&t.stopOnFalse&&(s=o.length,n=!1);t.memory||(n=!1),e=!1,i&&(o=n?[]:"")},c={add:function(){return o&&(n&&!e&&(s=o.length-1,a.push(n)),function e(n){b.each(n,function(n,r){m(r)?t.unique&&c.has(r)||o.push(r):r&&r.length&&"string"!==w(r)&&e(r)})}(arguments),n&&!e&&u()),this},remove:function(){return b.each(arguments,function(t,e){for(var n;(n=b.inArray(e,o,n))>-1;)o.splice(n,1),n<=s&&s--}),this},has:function(t){return t?b.inArray(t,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return i=a=[],o=n="",this},disabled:function(){return!o},lock:function(){return i=a=[],n||e||(o=n=""),this},locked:function(){return!!i},fireWith:function(t,n){return i||(n=[t,(n=n||[]).slice?n.slice():n],a.push(n),e||u()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!r}};return c},b.extend({Deferred:function(e){var n=[["notify","progress",b.Callbacks("memory"),b.Callbacks("memory"),2],["resolve","done",b.Callbacks("once memory"),b.Callbacks("once memory"),0,"resolved"],["reject","fail",b.Callbacks("once memory"),b.Callbacks("once memory"),1,"rejected"]],r="pending",i={state:function(){return r},always:function(){return o.done(arguments).fail(arguments),this},catch:function(t){return i.then(null,t)},pipe:function(){var t=arguments;return b.Deferred(function(e){b.each(n,function(n,r){var i=m(t[r[4]])&&t[r[4]];o[r[1]](function(){var t=i&&i.apply(this,arguments);t&&m(t.promise)?t.promise().progress(e.notify).done(e.resolve).fail(e.reject):e[r[0]+"With"](this,i?[t]:arguments)})}),t=null}).promise()},then:function(e,r,i){var o=0;function a(e,n,r,i){return function(){var s=this,u=arguments,c=function(){var t,c;if(!(e<o)){if((t=r.apply(s,u))===n.promise())throw new TypeError("Thenable self-resolution");m(c=t&&("object"==typeof t||"function"==typeof t)&&t.then)?i?c.call(t,a(o,n,N,i),a(o,n,F,i)):c.call(t,a(++o,n,N,i),a(o,n,F,i),a(o,n,N,n.notifyWith)):(r!==N&&(s=void 0,u=[t]),(i||n.resolveWith)(s,u))}},l=i?c:function(){try{c()}catch(t){b.Deferred.exceptionHook&&b.Deferred.exceptionHook(t,l.stackTrace),e+1>=o&&(r!==F&&(s=void 0,u=[t]),n.rejectWith(s,u))}};e?l():(b.Deferred.getStackHook&&(l.stackTrace=b.Deferred.getStackHook()),t.setTimeout(l))}}return b.Deferred(function(t){n[0][3].add(a(0,t,m(i)?i:N,t.notifyWith)),n[1][3].add(a(0,t,m(e)?e:N)),n[2][3].add(a(0,t,m(r)?r:F))}).promise()},promise:function(t){return null!=t?b.extend(t,i):i}},o={};return b.each(n,function(t,e){var a=e[2],s=e[5];i[e[1]]=a.add,s&&a.add(function(){r=s},n[3-t][2].disable,n[3-t][3].disable,n[0][2].lock,n[0][3].lock),a.add(e[3].fire),o[e[0]]=function(){return o[e[0]+"With"](this===o?void 0:this,arguments),this},o[e[0]+"With"]=a.fireWith}),i.promise(o),e&&e.call(o,o),o},when:function(t){var e=arguments.length,n=e,r=Array(n),i=o.call(arguments),a=b.Deferred(),s=function(t){return function(n){r[t]=this,i[t]=arguments.length>1?o.call(arguments):n,--e||a.resolveWith(r,i)}};if(e<=1&&(j(t,a.done(s(n)).resolve,a.reject,!e),"pending"===a.state()||m(i[n]&&i[n].then)))return a.then();for(;n--;)j(i[n],s(n),a.reject);return a.promise()}});var z=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;b.Deferred.exceptionHook=function(e,n){t.console&&t.console.warn&&e&&z.test(e.name)&&t.console.warn("jQuery.Deferred exception: "+e.message,e.stack,n)},b.readyException=function(e){t.setTimeout(function(){throw e})};var U=b.Deferred();function V(){r.removeEventListener("DOMContentLoaded",V),t.removeEventListener("load",V),b.ready()}b.fn.ready=function(t){return U.then(t).catch(function(t){b.readyException(t)}),this},b.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--b.readyWait:b.isReady)||(b.isReady=!0,!0!==t&&--b.readyWait>0||U.resolveWith(r,[b]))}}),b.ready.then=U.then,"complete"===r.readyState||"loading"!==r.readyState&&!r.documentElement.doScroll?t.setTimeout(b.ready):(r.addEventListener("DOMContentLoaded",V),t.addEventListener("load",V));var B=function(t,e,n,r,i,o,a){var s=0,u=t.length,c=null==n;if("object"===w(n))for(s in i=!0,n)B(t,e,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,m(r)||(a=!0),c&&(a?(e.call(t,r),e=null):(c=e,e=function(t,e,n){return c.call(b(t),n)})),e))for(;s<u;s++)e(t[s],n,a?r:r.call(t[s],s,e(t[s],n)));return i?t:c?e.call(t):u?e(t[0],n):o},H=/^-ms-/,q=/-([a-z])/g;function G(t,e){return e.toUpperCase()}function W(t){return t.replace(H,"ms-").replace(q,G)}var Y=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function X(){this.expando=b.expando+X.uid++}X.uid=1,X.prototype={cache:function(t){var e=t[this.expando];return e||(e={},Y(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var r,i=this.cache(t);if("string"==typeof e)i[W(e)]=n;else for(r in e)i[W(r)]=e[r];return i},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][W(e)]},access:function(t,e,n){return void 0===e||e&&"string"==typeof e&&void 0===n?this.get(t,e):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,r=t[this.expando];if(void 0!==r){if(void 0!==e){n=(e=Array.isArray(e)?e.map(W):(e=W(e))in r?[e]:e.match(I)||[]).length;for(;n--;)delete r[e[n]]}(void 0===e||b.isEmptyObject(r))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!b.isEmptyObject(e)}};var $=new X,Q=new X,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Z=/[A-Z]/g;function K(t,e,n){var r;if(void 0===n&&1===t.nodeType)if(r="data-"+e.replace(Z,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(r))){try{n=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:J.test(t)?JSON.parse(t):t)}(n)}catch(t){}Q.set(t,e,n)}else n=void 0;return n}b.extend({hasData:function(t){return Q.hasData(t)||$.hasData(t)},data:function(t,e,n){return Q.access(t,e,n)},removeData:function(t,e){Q.remove(t,e)},_data:function(t,e,n){return $.access(t,e,n)},_removeData:function(t,e){$.remove(t,e)}}),b.fn.extend({data:function(t,e){var n,r,i,o=this[0],a=o&&o.attributes;if(void 0===t){if(this.length&&(i=Q.get(o),1===o.nodeType&&!$.get(o,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&0===(r=a[n].name).indexOf("data-")&&(r=W(r.slice(5)),K(o,r,i[r]));$.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof t?this.each(function(){Q.set(this,t)}):B(this,function(e){var n;if(o&&void 0===e)return void 0!==(n=Q.get(o,t))?n:void 0!==(n=K(o,t))?n:void 0;this.each(function(){Q.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){Q.remove(this,t)})}}),b.extend({queue:function(t,e,n){var r;if(t)return r=$.get(t,e=(e||"fx")+"queue"),n&&(!r||Array.isArray(n)?r=$.access(t,e,b.makeArray(n)):r.push(n)),r||[]},dequeue:function(t,e){var n=b.queue(t,e=e||"fx"),r=n.length,i=n.shift(),o=b._queueHooks(t,e);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===e&&n.unshift("inprogress"),delete o.stop,i.call(t,function(){b.dequeue(t,e)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return $.get(t,n)||$.access(t,n,{empty:b.Callbacks("once memory").add(function(){$.remove(t,[e+"queue",n])})})}}),b.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?b.queue(this[0],t):void 0===e?this:this.each(function(){var n=b.queue(this,t,e);b._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&b.dequeue(this,t)})},dequeue:function(t){return this.each(function(){b.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,r=1,i=b.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)(n=$.get(o[a],t+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(e)}});var tt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,et=new RegExp("^(?:([+-])=|)("+tt+")([a-z%]*)$","i"),nt=["Top","Right","Bottom","Left"],rt=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&b.contains(t.ownerDocument,t)&&"none"===b.css(t,"display")},it=function(t,e,n,r){var i,o,a={};for(o in e)a[o]=t.style[o],t.style[o]=e[o];for(o in i=n.apply(t,r||[]),e)t.style[o]=a[o];return i};function ot(t,e,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return b.css(t,e,"")},u=s(),c=n&&n[3]||(b.cssNumber[e]?"":"px"),l=(b.cssNumber[e]||"px"!==c&&+u)&&et.exec(b.css(t,e));if(l&&l[3]!==c){for(u/=2,c=c||l[3],l=+u||1;a--;)b.style(t,e,l+c),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),l/=o;b.style(t,e,(l*=2)+c),n=n||[]}return n&&(l=+l||+u||0,i=n[1]?l+(n[1]+1)*n[2]:+n[2],r&&(r.unit=c,r.start=l,r.end=i)),i}var at={};function st(t){var e,n=t.ownerDocument,r=t.nodeName,i=at[r];return i||(e=n.body.appendChild(n.createElement(r)),i=b.css(e,"display"),e.parentNode.removeChild(e),"none"===i&&(i="block"),at[r]=i,i)}function ut(t,e){for(var n,r,i=[],o=0,a=t.length;o<a;o++)(r=t[o]).style&&(n=r.style.display,e?("none"===n&&(i[o]=$.get(r,"display")||null,i[o]||(r.style.display="")),""===r.style.display&&rt(r)&&(i[o]=st(r))):"none"!==n&&(i[o]="none",$.set(r,"display",n)));for(o=0;o<a;o++)null!=i[o]&&(t[o].style.display=i[o]);return t}b.fn.extend({show:function(){return ut(this,!0)},hide:function(){return ut(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){rt(this)?b(this).show():b(this).hide()})}});var ct=/^(?:checkbox|radio)$/i,lt=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,ht=/^$|^module$|\/(?:java|ecma)script/i,ft={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function dt(t,e){var n;return n="undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e||"*"):"undefined"!=typeof t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&A(t,e)?b.merge([t],n):n}function pt(t,e){for(var n=0,r=t.length;n<r;n++)$.set(t[n],"globalEval",!e||$.get(e[n],"globalEval"))}ft.optgroup=ft.option,ft.tbody=ft.tfoot=ft.colgroup=ft.caption=ft.thead,ft.th=ft.td;var mt,gt,vt=/<|&#?\w+;/;function yt(t,e,n,r,i){for(var o,a,s,u,c,l,h=e.createDocumentFragment(),f=[],d=0,p=t.length;d<p;d++)if((o=t[d])||0===o)if("object"===w(o))b.merge(f,o.nodeType?[o]:o);else if(vt.test(o)){for(a=a||h.appendChild(e.createElement("div")),s=(lt.exec(o)||["",""])[1].toLowerCase(),a.innerHTML=(u=ft[s]||ft._default)[1]+b.htmlPrefilter(o)+u[2],l=u[0];l--;)a=a.lastChild;b.merge(f,a.childNodes),(a=h.firstChild).textContent=""}else f.push(e.createTextNode(o));for(h.textContent="",d=0;o=f[d++];)if(r&&b.inArray(o,r)>-1)i&&i.push(o);else if(c=b.contains(o.ownerDocument,o),a=dt(h.appendChild(o),"script"),c&&pt(a),n)for(l=0;o=a[l++];)ht.test(o.type||"")&&n.push(o);return h}mt=r.createDocumentFragment().appendChild(r.createElement("div")),(gt=r.createElement("input")).setAttribute("type","radio"),gt.setAttribute("checked","checked"),gt.setAttribute("name","t"),mt.appendChild(gt),p.checkClone=mt.cloneNode(!0).cloneNode(!0).lastChild.checked,mt.innerHTML="<textarea>x</textarea>",p.noCloneChecked=!!mt.cloneNode(!0).lastChild.defaultValue;var wt=r.documentElement,bt=/^key/,xt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,_t=/^([^.]*)(?:\.(.+)|)/;function Mt(){return!0}function Et(){return!1}function St(){try{return r.activeElement}catch(t){}}function Tt(t,e,n,r,i,o){var a,s;if("object"==typeof e){for(s in"string"!=typeof n&&(r=r||n,n=void 0),e)Tt(t,s,n,r,e[s],o);return t}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=Et;else if(!i)return t;return 1===o&&(a=i,(i=function(t){return b().off(t),a.apply(this,arguments)}).guid=a.guid||(a.guid=b.guid++)),t.each(function(){b.event.add(this,e,i,r,n)})}b.event={global:{},add:function(t,e,n,r,i){var o,a,s,u,c,l,h,f,d,p,m,g=$.get(t);if(g)for(n.handler&&(n=(o=n).handler,i=o.selector),i&&b.find.matchesSelector(wt,i),n.guid||(n.guid=b.guid++),(u=g.events)||(u=g.events={}),(a=g.handle)||(a=g.handle=function(e){return"undefined"!=typeof b&&b.event.triggered!==e.type?b.event.dispatch.apply(t,arguments):void 0}),c=(e=(e||"").match(I)||[""]).length;c--;)d=m=(s=_t.exec(e[c])||[])[1],p=(s[2]||"").split(".").sort(),d&&(h=b.event.special[d]||{},h=b.event.special[d=(i?h.delegateType:h.bindType)||d]||{},l=b.extend({type:d,origType:m,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&b.expr.match.needsContext.test(i),namespace:p.join(".")},o),(f=u[d])||((f=u[d]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(t,r,p,a)||t.addEventListener&&t.addEventListener(d,a)),h.add&&(h.add.call(t,l),l.handler.guid||(l.handler.guid=n.guid)),i?f.splice(f.delegateCount++,0,l):f.push(l),b.event.global[d]=!0)},remove:function(t,e,n,r,i){var o,a,s,u,c,l,h,f,d,p,m,g=$.hasData(t)&&$.get(t);if(g&&(u=g.events)){for(c=(e=(e||"").match(I)||[""]).length;c--;)if(d=m=(s=_t.exec(e[c])||[])[1],p=(s[2]||"").split(".").sort(),d){for(h=b.event.special[d]||{},f=u[d=(r?h.delegateType:h.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=f.length;o--;)l=f[o],!i&&m!==l.origType||n&&n.guid!==l.guid||s&&!s.test(l.namespace)||r&&r!==l.selector&&("**"!==r||!l.selector)||(f.splice(o,1),l.selector&&f.delegateCount--,h.remove&&h.remove.call(t,l));a&&!f.length&&(h.teardown&&!1!==h.teardown.call(t,p,g.handle)||b.removeEvent(t,d,g.handle),delete u[d])}else for(d in u)b.event.remove(t,d+e[c],n,r,!0);b.isEmptyObject(u)&&$.remove(t,"handle events")}},dispatch:function(t){var e,n,r,i,o,a,s=b.event.fix(t),u=new Array(arguments.length),c=($.get(this,"events")||{})[s.type]||[],l=b.event.special[s.type]||{};for(u[0]=s,e=1;e<arguments.length;e++)u[e]=arguments[e];if(s.delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,s)){for(a=b.event.handlers.call(this,s,c),e=0;(i=a[e++])&&!s.isPropagationStopped();)for(s.currentTarget=i.elem,n=0;(o=i.handlers[n++])&&!s.isImmediatePropagationStopped();)s.rnamespace&&!s.rnamespace.test(o.namespace)||(s.handleObj=o,s.data=o.data,void 0!==(r=((b.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,u))&&!1===(s.result=r)&&(s.preventDefault(),s.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,s),s.result}},handlers:function(t,e){var n,r,i,o,a,s=[],u=e.delegateCount,c=t.target;if(u&&c.nodeType&&!("click"===t.type&&t.button>=1))for(;c!==this;c=c.parentNode||this)if(1===c.nodeType&&("click"!==t.type||!0!==c.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=e[n]).selector+" "]&&(a[i]=r.needsContext?b(i,this).index(c)>-1:b.find(i,this,null,[c]).length),a[i]&&o.push(r);o.length&&s.push({elem:c,handlers:o})}return c=this,u<e.length&&s.push({elem:c,handlers:e.slice(u)}),s},addProp:function(t,e){Object.defineProperty(b.Event.prototype,t,{enumerable:!0,configurable:!0,get:m(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[b.expando]?t:new b.Event(t)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==St()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===St()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&A(this,"input"))return this.click(),!1},_default:function(t){return A(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},b.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},b.Event=function(t,e){if(!(this instanceof b.Event))return new b.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?Mt:Et,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&b.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[b.expando]=!0},b.Event.prototype={constructor:b.Event,isDefaultPrevented:Et,isPropagationStopped:Et,isImmediatePropagationStopped:Et,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=Mt,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=Mt,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=Mt,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},b.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&bt.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&xt.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},b.event.addProp),b.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){b.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,r=t.relatedTarget,i=t.handleObj;return r&&(r===this||b.contains(this,r))||(t.type=i.origType,n=i.handler.apply(this,arguments),t.type=e),n}}}),b.fn.extend({on:function(t,e,n,r){return Tt(this,t,e,n,r)},one:function(t,e,n,r){return Tt(this,t,e,n,r,1)},off:function(t,e,n){var r,i;if(t&&t.preventDefault&&t.handleObj)return r=t.handleObj,b(t.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof t){for(i in t)this.off(i,e,t[i]);return this}return!1!==e&&"function"!=typeof e||(n=e,e=void 0),!1===n&&(n=Et),this.each(function(){b.event.remove(this,t,n,e)})}});var At=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,kt=/<script|<style|<link/i,Ct=/checked\s*(?:[^=]|=\s*.checked.)/i,Rt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Dt(t,e){return A(t,"table")&&A(11!==e.nodeType?e:e.firstChild,"tr")&&b(t).children("tbody")[0]||t}function Lt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Ot(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Pt(t,e){var n,r,i,o,a,s,u,c;if(1===e.nodeType){if($.hasData(t)&&(o=$.access(t),a=$.set(e,o),c=o.events))for(i in delete a.handle,a.events={},c)for(n=0,r=c[i].length;n<r;n++)b.event.add(e,i,c[i][n]);Q.hasData(t)&&(s=Q.access(t),u=b.extend({},s),Q.set(e,u))}}function It(t,e,n,r){e=a.apply([],e);var i,o,s,u,c,l,h=0,f=t.length,d=f-1,g=e[0],v=m(g);if(v||f>1&&"string"==typeof g&&!p.checkClone&&Ct.test(g))return t.each(function(i){var o=t.eq(i);v&&(e[0]=g.call(this,i,o.html())),It(o,e,n,r)});if(f&&(o=(i=yt(e,t[0].ownerDocument,!1,t,r)).firstChild,1===i.childNodes.length&&(i=o),o||r)){for(u=(s=b.map(dt(i,"script"),Lt)).length;h<f;h++)c=i,h!==d&&(c=b.clone(c,!0,!0),u&&b.merge(s,dt(c,"script"))),n.call(t[h],c,h);if(u)for(l=s[s.length-1].ownerDocument,b.map(s,Ot),h=0;h<u;h++)ht.test((c=s[h]).type||"")&&!$.access(c,"globalEval")&&b.contains(l,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?b._evalUrl&&b._evalUrl(c.src):y(c.textContent.replace(Rt,""),l,c))}return t}function Nt(t,e,n){for(var r,i=e?b.filter(e,t):t,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||b.cleanData(dt(r)),r.parentNode&&(n&&b.contains(r.ownerDocument,r)&&pt(dt(r,"script")),r.parentNode.removeChild(r));return t}b.extend({htmlPrefilter:function(t){return t.replace(At,"<$1></$2>")},clone:function(t,e,n){var r,i,o,a,s,u,c,l=t.cloneNode(!0),h=b.contains(t.ownerDocument,t);if(!(p.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||b.isXMLDoc(t)))for(a=dt(l),r=0,i=(o=dt(t)).length;r<i;r++)s=o[r],"input"===(c=(u=a[r]).nodeName.toLowerCase())&&ct.test(s.type)?u.checked=s.checked:"input"!==c&&"textarea"!==c||(u.defaultValue=s.defaultValue);if(e)if(n)for(o=o||dt(t),a=a||dt(l),r=0,i=o.length;r<i;r++)Pt(o[r],a[r]);else Pt(t,l);return(a=dt(l,"script")).length>0&&pt(a,!h&&dt(t,"script")),l},cleanData:function(t){for(var e,n,r,i=b.event.special,o=0;void 0!==(n=t[o]);o++)if(Y(n)){if(e=n[$.expando]){if(e.events)for(r in e.events)i[r]?b.event.remove(n,r):b.removeEvent(n,r,e.handle);n[$.expando]=void 0}n[Q.expando]&&(n[Q.expando]=void 0)}}}),b.fn.extend({detach:function(t){return Nt(this,t,!0)},remove:function(t){return Nt(this,t)},text:function(t){return B(this,function(t){return void 0===t?b.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return It(this,arguments,function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Dt(this,t).appendChild(t)})},prepend:function(){return It(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=Dt(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return It(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return It(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(b.cleanData(dt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return b.clone(this,t,e)})},html:function(t){return B(this,function(t){var e=this[0]||{},n=0,r=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!kt.test(t)&&!ft[(lt.exec(t)||["",""])[1].toLowerCase()]){t=b.htmlPrefilter(t);try{for(;n<r;n++)1===(e=this[n]||{}).nodeType&&(b.cleanData(dt(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=[];return It(this,arguments,function(e){var n=this.parentNode;b.inArray(this,t)<0&&(b.cleanData(dt(this)),n&&n.replaceChild(e,this))},t)}}),b.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){b.fn[t]=function(t){for(var n,r=[],i=b(t),o=i.length-1,a=0;a<=o;a++)n=a===o?this:this.clone(!0),b(i[a])[e](n),s.apply(r,n.get());return this.pushStack(r)}});var Ft=new RegExp("^("+tt+")(?!px)[a-z%]+$","i"),jt=function(e){var n=e.ownerDocument.defaultView;return n&&n.opener||(n=t),n.getComputedStyle(e)},zt=new RegExp(nt.join("|"),"i");function Ut(t,e,n){var r,i,o,a,s=t.style;return(n=n||jt(t))&&(""!==(a=n.getPropertyValue(e)||n[e])||b.contains(t.ownerDocument,t)||(a=b.style(t,e)),!p.pixelBoxStyles()&&Ft.test(a)&&zt.test(e)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=r,s.minWidth=i,s.maxWidth=o)),void 0!==a?a+"":a}function Vt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function e(){if(l){c.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",wt.appendChild(c).appendChild(l);var e=t.getComputedStyle(l);i="1%"!==e.top,u=12===n(e.marginLeft),l.style.right="60%",s=36===n(e.right),o=36===n(e.width),l.style.position="absolute",a=36===l.offsetWidth||"absolute",wt.removeChild(c),l=null}}function n(t){return Math.round(parseFloat(t))}var i,o,a,s,u,c=r.createElement("div"),l=r.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",p.clearCloneStyle="content-box"===l.style.backgroundClip,b.extend(p,{boxSizingReliable:function(){return e(),o},pixelBoxStyles:function(){return e(),s},pixelPosition:function(){return e(),i},reliableMarginLeft:function(){return e(),u},scrollboxSize:function(){return e(),a}}))}();var Bt=/^(none|table(?!-c[ea]).+)/,Ht=/^--/,qt={position:"absolute",visibility:"hidden",display:"block"},Gt={letterSpacing:"0",fontWeight:"400"},Wt=["Webkit","Moz","ms"],Yt=r.createElement("div").style;function Xt(t){var e=b.cssProps[t];return e||(e=b.cssProps[t]=function(t){if(t in Yt)return t;for(var e=t[0].toUpperCase()+t.slice(1),n=Wt.length;n--;)if((t=Wt[n]+e)in Yt)return t}(t)||t),e}function $t(t,e,n){var r=et.exec(e);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):e}function Qt(t,e,n,r,i,o){var a="width"===e?1:0,s=0,u=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(u+=b.css(t,n+nt[a],!0,i)),r?("content"===n&&(u-=b.css(t,"padding"+nt[a],!0,i)),"margin"!==n&&(u-=b.css(t,"border"+nt[a]+"Width",!0,i))):(u+=b.css(t,"padding"+nt[a],!0,i),"padding"!==n?u+=b.css(t,"border"+nt[a]+"Width",!0,i):s+=b.css(t,"border"+nt[a]+"Width",!0,i));return!r&&o>=0&&(u+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-o-u-s-.5))),u}function Jt(t,e,n){var r=jt(t),i=Ut(t,e,r),o="border-box"===b.css(t,"boxSizing",!1,r),a=o;if(Ft.test(i)){if(!n)return i;i="auto"}return a=a&&(p.boxSizingReliable()||i===t.style[e]),("auto"===i||!parseFloat(i)&&"inline"===b.css(t,"display",!1,r))&&(i=t["offset"+e[0].toUpperCase()+e.slice(1)],a=!0),(i=parseFloat(i)||0)+Qt(t,e,n||(o?"border":"content"),a,r,i)+"px"}function Zt(t,e,n,r,i){return new Zt.prototype.init(t,e,n,r,i)}b.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=Ut(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,n,r){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var i,o,a,s=W(e),u=Ht.test(e),c=t.style;if(u||(e=Xt(s)),a=b.cssHooks[e]||b.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(t,!1,r))?i:c[e];"string"==(o=typeof n)&&(i=et.exec(n))&&i[1]&&(n=ot(t,e,i),o="number"),null!=n&&n==n&&("number"===o&&(n+=i&&i[3]||(b.cssNumber[s]?"":"px")),p.clearCloneStyle||""!==n||0!==e.indexOf("background")||(c[e]="inherit"),a&&"set"in a&&void 0===(n=a.set(t,n,r))||(u?c.setProperty(e,n):c[e]=n))}},css:function(t,e,n,r){var i,o,a,s=W(e);return Ht.test(e)||(e=Xt(s)),(a=b.cssHooks[e]||b.cssHooks[s])&&"get"in a&&(i=a.get(t,!0,n)),void 0===i&&(i=Ut(t,e,r)),"normal"===i&&e in Gt&&(i=Gt[e]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),b.each(["height","width"],function(t,e){b.cssHooks[e]={get:function(t,n,r){if(n)return!Bt.test(b.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?Jt(t,e,r):it(t,qt,function(){return Jt(t,e,r)})},set:function(t,n,r){var i,o=jt(t),a="border-box"===b.css(t,"boxSizing",!1,o),s=r&&Qt(t,e,r,a,o);return a&&p.scrollboxSize()===o.position&&(s-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(o[e])-Qt(t,e,"border",!1,o)-.5)),s&&(i=et.exec(n))&&"px"!==(i[3]||"px")&&(t.style[e]=n,n=b.css(t,e)),$t(0,n,s)}}}),b.cssHooks.marginLeft=Vt(p.reliableMarginLeft,function(t,e){if(e)return(parseFloat(Ut(t,"marginLeft"))||t.getBoundingClientRect().left-it(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),b.each({margin:"",padding:"",border:"Width"},function(t,e){b.cssHooks[t+e]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];r<4;r++)i[t+nt[r]+e]=o[r]||o[r-2]||o[0];return i}},"margin"!==t&&(b.cssHooks[t+e].set=$t)}),b.fn.extend({css:function(t,e){return B(this,function(t,e,n){var r,i,o={},a=0;if(Array.isArray(e)){for(r=jt(t),i=e.length;a<i;a++)o[e[a]]=b.css(t,e[a],!1,r);return o}return void 0!==n?b.style(t,e,n):b.css(t,e)},t,e,arguments.length>1)}}),b.Tween=Zt,(Zt.prototype={constructor:Zt,init:function(t,e,n,r,i,o){this.elem=t,this.prop=n,this.easing=i||b.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=r,this.unit=o||(b.cssNumber[n]?"":"px")},cur:function(){var t=Zt.propHooks[this.prop];return t&&t.get?t.get(this):Zt.propHooks._default.get(this)},run:function(t){var e,n=Zt.propHooks[this.prop];return this.pos=e=this.options.duration?b.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Zt.propHooks._default.set(this),this}}).init.prototype=Zt.prototype,(Zt.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=b.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){b.fx.step[t.prop]?b.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[b.cssProps[t.prop]]&&!b.cssHooks[t.prop]?t.elem[t.prop]=t.now:b.style(t.elem,t.prop,t.now+t.unit)}}}).scrollTop=Zt.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},b.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},b.fx=Zt.prototype.init,b.fx.step={};var Kt,te,ee=/^(?:toggle|show|hide)$/,ne=/queueHooks$/;function re(){te&&(!1===r.hidden&&t.requestAnimationFrame?t.requestAnimationFrame(re):t.setTimeout(re,b.fx.interval),b.fx.tick())}function ie(){return t.setTimeout(function(){Kt=void 0}),Kt=Date.now()}function oe(t,e){var n,r=0,i={height:t};for(e=e?1:0;r<4;r+=2-e)i["margin"+(n=nt[r])]=i["padding"+n]=t;return e&&(i.opacity=i.width=t),i}function ae(t,e,n){for(var r,i=(se.tweeners[e]||[]).concat(se.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,e,t))return r}function se(t,e,n){var r,i,o=0,a=se.prefilters.length,s=b.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;for(var e=Kt||ie(),n=Math.max(0,c.startTime+c.duration-e),r=1-(n/c.duration||0),o=0,a=c.tweens.length;o<a;o++)c.tweens[o].run(r);return s.notifyWith(t,[c,r,n]),r<1&&a?n:(a||s.notifyWith(t,[c,1,0]),s.resolveWith(t,[c]),!1)},c=s.promise({elem:t,props:b.extend({},e),opts:b.extend(!0,{specialEasing:{},easing:b.easing._default},n),originalProperties:e,originalOptions:n,startTime:Kt||ie(),duration:n.duration,tweens:[],createTween:function(e,n){var r=b.Tween(t,c.opts,e,n,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(r),r},stop:function(e){var n=0,r=e?c.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)c.tweens[n].run(1);return e?(s.notifyWith(t,[c,1,0]),s.resolveWith(t,[c,e])):s.rejectWith(t,[c,e]),this}}),l=c.props;for(function(t,e){var n,r,i,o,a;for(n in t)if(i=e[r=W(n)],o=t[n],Array.isArray(o)&&(i=o[1],o=t[n]=o[0]),n!==r&&(t[r]=o,delete t[n]),(a=b.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete t[r],o)n in t||(t[n]=o[n],e[n]=i);else e[r]=i}(l,c.opts.specialEasing);o<a;o++)if(r=se.prefilters[o].call(c,t,l,c.opts))return m(r.stop)&&(b._queueHooks(c.elem,c.opts.queue).stop=r.stop.bind(r)),r;return b.map(l,ae,c),m(c.opts.start)&&c.opts.start.call(t,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),b.fx.timer(b.extend(u,{elem:t,anim:c,queue:c.opts.queue})),c}b.Animation=b.extend(se,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return ot(n.elem,t,et.exec(e),n),n}]},tweener:function(t,e){m(t)?(e=t,t=["*"]):t=t.match(I);for(var n,r=0,i=t.length;r<i;r++)(se.tweeners[n=t[r]]=se.tweeners[n]||[]).unshift(e)},prefilters:[function(t,e,n){var r,i,o,a,s,u,c,l,h="width"in e||"height"in e,f=this,d={},p=t.style,m=t.nodeType&&rt(t),g=$.get(t,"fxshow");for(r in n.queue||(null==(a=b._queueHooks(t,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,f.always(function(){f.always(function(){a.unqueued--,b.queue(t,"fx").length||a.empty.fire()})})),e)if(ee.test(i=e[r])){if(delete e[r],o=o||"toggle"===i,i===(m?"hide":"show")){if("show"!==i||!g||void 0===g[r])continue;m=!0}d[r]=g&&g[r]||b.style(t,r)}if((u=!b.isEmptyObject(e))||!b.isEmptyObject(d))for(r in h&&1===t.nodeType&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],null==(c=g&&g.display)&&(c=$.get(t,"display")),"none"===(l=b.css(t,"display"))&&(c?l=c:(ut([t],!0),c=t.style.display||c,l=b.css(t,"display"),ut([t]))),("inline"===l||"inline-block"===l&&null!=c)&&"none"===b.css(t,"float")&&(u||(f.done(function(){p.display=c}),null==c&&(c="none"===(l=p.display)?"":l)),p.display="inline-block")),n.overflow&&(p.overflow="hidden",f.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]})),u=!1,d)u||(g?"hidden"in g&&(m=g.hidden):g=$.access(t,"fxshow",{display:c}),o&&(g.hidden=!m),m&&ut([t],!0),f.done(function(){for(r in m||ut([t]),$.remove(t,"fxshow"),d)b.style(t,r,d[r])})),u=ae(m?g[r]:0,r,f),r in g||(g[r]=u.start,m&&(u.end=u.start,u.start=0))}],prefilter:function(t,e){e?se.prefilters.unshift(t):se.prefilters.push(t)}}),b.speed=function(t,e,n){var r=t&&"object"==typeof t?b.extend({},t):{complete:n||!n&&e||m(t)&&t,duration:t,easing:n&&e||e&&!m(e)&&e};return b.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration=r.duration in b.fx.speeds?b.fx.speeds[r.duration]:b.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){m(r.old)&&r.old.call(this),r.queue&&b.dequeue(this,r.queue)},r},b.fn.extend({fadeTo:function(t,e,n,r){return this.filter(rt).css("opacity",0).show().end().animate({opacity:e},t,n,r)},animate:function(t,e,n,r){var i=b.isEmptyObject(t),o=b.speed(e,n,r),a=function(){var e=se(this,b.extend({},t),o);(i||$.get(this,"finish"))&&e.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(t,e,n){var r=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each(function(){var e=!0,i=null!=t&&t+"queueHooks",o=b.timers,a=$.get(this);if(i)a[i]&&a[i].stop&&r(a[i]);else for(i in a)a[i]&&a[i].stop&&ne.test(i)&&r(a[i]);for(i=o.length;i--;)o[i].elem!==this||null!=t&&o[i].queue!==t||(o[i].anim.stop(n),e=!1,o.splice(i,1));!e&&n||b.dequeue(this,t)})},finish:function(t){return!1!==t&&(t=t||"fx"),this.each(function(){var e,n=$.get(this),r=n[t+"queue"],i=n[t+"queueHooks"],o=b.timers,a=r?r.length:0;for(n.finish=!0,b.queue(this,t,[]),i&&i.stop&&i.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<a;e++)r[e]&&r[e].finish&&r[e].finish.call(this);delete n.finish})}}),b.each(["toggle","show","hide"],function(t,e){var n=b.fn[e];b.fn[e]=function(t,r,i){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(oe(e,!0),t,r,i)}}),b.each({slideDown:oe("show"),slideUp:oe("hide"),slideToggle:oe("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){b.fn[t]=function(t,n,r){return this.animate(e,t,n,r)}}),b.timers=[],b.fx.tick=function(){var t,e=0,n=b.timers;for(Kt=Date.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||b.fx.stop(),Kt=void 0},b.fx.timer=function(t){b.timers.push(t),b.fx.start()},b.fx.interval=13,b.fx.start=function(){te||(te=!0,re())},b.fx.stop=function(){te=null},b.fx.speeds={slow:600,fast:200,_default:400},b.fn.delay=function(e,n){return e=b.fx&&b.fx.speeds[e]||e,this.queue(n=n||"fx",function(n,r){var i=t.setTimeout(n,e);r.stop=function(){t.clearTimeout(i)}})},function(){var t=r.createElement("input"),e=r.createElement("select").appendChild(r.createElement("option"));t.type="checkbox",p.checkOn=""!==t.value,p.optSelected=e.selected,(t=r.createElement("input")).value="t",t.type="radio",p.radioValue="t"===t.value}();var ue,ce=b.expr.attrHandle;b.fn.extend({attr:function(t,e){return B(this,b.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){b.removeAttr(this,t)})}}),b.extend({attr:function(t,e,n){var r,i,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof t.getAttribute?b.prop(t,e,n):(1===o&&b.isXMLDoc(t)||(i=b.attrHooks[e.toLowerCase()]||(b.expr.match.bool.test(e)?ue:void 0)),void 0!==n?null===n?void b.removeAttr(t,e):i&&"set"in i&&void 0!==(r=i.set(t,n,e))?r:(t.setAttribute(e,n+""),n):i&&"get"in i&&null!==(r=i.get(t,e))?r:null==(r=b.find.attr(t,e))?void 0:r)},attrHooks:{type:{set:function(t,e){if(!p.radioValue&&"radio"===e&&A(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,r=0,i=e&&e.match(I);if(i&&1===t.nodeType)for(;n=i[r++];)t.removeAttribute(n)}}),ue={set:function(t,e,n){return!1===e?b.removeAttr(t,n):t.setAttribute(n,n),n}},b.each(b.expr.match.bool.source.match(/\w+/g),function(t,e){var n=ce[e]||b.find.attr;ce[e]=function(t,e,r){var i,o,a=e.toLowerCase();return r||(o=ce[a],ce[a]=i,i=null!=n(t,e,r)?a:null,ce[a]=o),i}});var le=/^(?:input|select|textarea|button)$/i,he=/^(?:a|area)$/i;function fe(t){return(t.match(I)||[]).join(" ")}function de(t){return t.getAttribute&&t.getAttribute("class")||""}function pe(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(I)||[]}b.fn.extend({prop:function(t,e){return B(this,b.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[b.propFix[t]||t]})}}),b.extend({prop:function(t,e,n){var r,i,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&b.isXMLDoc(t)||(i=b.propHooks[e=b.propFix[e]||e]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(t,n,e))?r:t[e]=n:i&&"get"in i&&null!==(r=i.get(t,e))?r:t[e]},propHooks:{tabIndex:{get:function(t){var e=b.find.attr(t,"tabindex");return e?parseInt(e,10):le.test(t.nodeName)||he.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),p.optSelected||(b.propHooks.selected={get:function(t){return null},set:function(t){}}),b.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){b.propFix[this.toLowerCase()]=this}),b.fn.extend({addClass:function(t){var e,n,r,i,o,a,s,u=0;if(m(t))return this.each(function(e){b(this).addClass(t.call(this,e,de(this)))});if((e=pe(t)).length)for(;n=this[u++];)if(i=de(n),r=1===n.nodeType&&" "+fe(i)+" "){for(a=0;o=e[a++];)r.indexOf(" "+o+" ")<0&&(r+=o+" ");i!==(s=fe(r))&&n.setAttribute("class",s)}return this},removeClass:function(t){var e,n,r,i,o,a,s,u=0;if(m(t))return this.each(function(e){b(this).removeClass(t.call(this,e,de(this)))});if(!arguments.length)return this.attr("class","");if((e=pe(t)).length)for(;n=this[u++];)if(i=de(n),r=1===n.nodeType&&" "+fe(i)+" "){for(a=0;o=e[a++];)for(;r.indexOf(" "+o+" ")>-1;)r=r.replace(" "+o+" "," ");i!==(s=fe(r))&&n.setAttribute("class",s)}return this},toggleClass:function(t,e){var n=typeof t,r="string"===n||Array.isArray(t);return"boolean"==typeof e&&r?e?this.addClass(t):this.removeClass(t):m(t)?this.each(function(n){b(this).toggleClass(t.call(this,n,de(this),e),e)}):this.each(function(){var e,i,o,a;if(r)for(i=0,o=b(this),a=pe(t);e=a[i++];)o.hasClass(e)?o.removeClass(e):o.addClass(e);else void 0!==t&&"boolean"!==n||((e=de(this))&&$.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":$.get(this,"__className__")||""))})},hasClass:function(t){var e,n,r=0;for(e=" "+t+" ";n=this[r++];)if(1===n.nodeType&&(" "+fe(de(n))+" ").indexOf(e)>-1)return!0;return!1}});var me=/\r/g;b.fn.extend({val:function(t){var e,n,r,i=this[0];return arguments.length?(r=m(t),this.each(function(n){var i;1===this.nodeType&&(null==(i=r?t.call(this,n,b(this).val()):t)?i="":"number"==typeof i?i+="":Array.isArray(i)&&(i=b.map(i,function(t){return null==t?"":t+""})),(e=b.valHooks[this.type]||b.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,i,"value")||(this.value=i))})):i?(e=b.valHooks[i.type]||b.valHooks[i.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(i,"value"))?n:"string"==typeof(n=i.value)?n.replace(me,""):null==n?"":n:void 0}}),b.extend({valHooks:{option:{get:function(t){var e=b.find.attr(t,"value");return null!=e?e:fe(b.text(t))}},select:{get:function(t){var e,n,r,i=t.options,o=t.selectedIndex,a="select-one"===t.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!A(n.parentNode,"optgroup"))){if(e=b(n).val(),a)return e;s.push(e)}return s},set:function(t,e){for(var n,r,i=t.options,o=b.makeArray(e),a=i.length;a--;)((r=i[a]).selected=b.inArray(b.valHooks.option.get(r),o)>-1)&&(n=!0);return n||(t.selectedIndex=-1),o}}}}),b.each(["radio","checkbox"],function(){b.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=b.inArray(b(t).val(),e)>-1}},p.checkOn||(b.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),p.focusin="onfocusin"in t;var ge=/^(?:focusinfocus|focusoutblur)$/,ve=function(t){t.stopPropagation()};b.extend(b.event,{trigger:function(e,n,i,o){var a,s,u,c,l,f,d,p,v=[i||r],y=h.call(e,"type")?e.type:e,w=h.call(e,"namespace")?e.namespace.split("."):[];if(s=p=u=i=i||r,3!==i.nodeType&&8!==i.nodeType&&!ge.test(y+b.event.triggered)&&(y.indexOf(".")>-1&&(y=(w=y.split(".")).shift(),w.sort()),l=y.indexOf(":")<0&&"on"+y,(e=e[b.expando]?e:new b.Event(y,"object"==typeof e&&e)).isTrigger=o?2:3,e.namespace=w.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+w.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=i),n=null==n?[e]:b.makeArray(n,[e]),d=b.event.special[y]||{},o||!d.trigger||!1!==d.trigger.apply(i,n))){if(!o&&!d.noBubble&&!g(i)){for(ge.test((c=d.delegateType||y)+y)||(s=s.parentNode);s;s=s.parentNode)v.push(s),u=s;u===(i.ownerDocument||r)&&v.push(u.defaultView||u.parentWindow||t)}for(a=0;(s=v[a++])&&!e.isPropagationStopped();)p=s,e.type=a>1?c:d.bindType||y,(f=($.get(s,"events")||{})[e.type]&&$.get(s,"handle"))&&f.apply(s,n),(f=l&&s[l])&&f.apply&&Y(s)&&(e.result=f.apply(s,n),!1===e.result&&e.preventDefault());return e.type=y,o||e.isDefaultPrevented()||d._default&&!1!==d._default.apply(v.pop(),n)||!Y(i)||l&&m(i[y])&&!g(i)&&((u=i[l])&&(i[l]=null),b.event.triggered=y,e.isPropagationStopped()&&p.addEventListener(y,ve),i[y](),e.isPropagationStopped()&&p.removeEventListener(y,ve),b.event.triggered=void 0,u&&(i[l]=u)),e.result}},simulate:function(t,e,n){var r=b.extend(new b.Event,n,{type:t,isSimulated:!0});b.event.trigger(r,null,e)}}),b.fn.extend({trigger:function(t,e){return this.each(function(){b.event.trigger(t,e,this)})},triggerHandler:function(t,e){var n=this[0];if(n)return b.event.trigger(t,e,n,!0)}}),p.focusin||b.each({focus:"focusin",blur:"focusout"},function(t,e){var n=function(t){b.event.simulate(e,t.target,b.event.fix(t))};b.event.special[e]={setup:function(){var r=this.ownerDocument||this,i=$.access(r,e);i||r.addEventListener(t,n,!0),$.access(r,e,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=$.access(r,e)-1;i?$.access(r,e,i):(r.removeEventListener(t,n,!0),$.remove(r,e))}}});var ye=t.location,we=Date.now(),be=/\?/;b.parseXML=function(e){var n;if(!e||"string"!=typeof e)return null;try{n=(new t.DOMParser).parseFromString(e,"text/xml")}catch(t){n=void 0}return n&&!n.getElementsByTagName("parsererror").length||b.error("Invalid XML: "+e),n};var xe=/\[\]$/,_e=/\r?\n/g,Me=/^(?:submit|button|image|reset|file)$/i,Ee=/^(?:input|select|textarea|keygen)/i;function Se(t,e,n,r){var i;if(Array.isArray(e))b.each(e,function(e,i){n||xe.test(t)?r(t,i):Se(t+"["+("object"==typeof i&&null!=i?e:"")+"]",i,n,r)});else if(n||"object"!==w(e))r(t,e);else for(i in e)Se(t+"["+i+"]",e[i],n,r)}b.param=function(t,e){var n,r=[],i=function(t,e){var n=m(e)?e():e;r[r.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n)};if(Array.isArray(t)||t.jquery&&!b.isPlainObject(t))b.each(t,function(){i(this.name,this.value)});else for(n in t)Se(n,t[n],e,i);return r.join("&")},b.fn.extend({serialize:function(){return b.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=b.prop(this,"elements");return t?b.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!b(this).is(":disabled")&&Ee.test(this.nodeName)&&!Me.test(t)&&(this.checked||!ct.test(t))}).map(function(t,e){var n=b(this).val();return null==n?null:Array.isArray(n)?b.map(n,function(t){return{name:e.name,value:t.replace(_e,"\r\n")}}):{name:e.name,value:n.replace(_e,"\r\n")}}).get()}});var Te=/%20/g,Ae=/#.*$/,ke=/([?&])_=[^&]*/,Ce=/^(.*?):[ \t]*([^\r\n]*)$/gm,Re=/^(?:GET|HEAD)$/,De=/^\/\//,Le={},Oe={},Pe="*/".concat("*"),Ie=r.createElement("a");function Ne(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var r,i=0,o=e.toLowerCase().match(I)||[];if(m(n))for(;r=o[i++];)"+"===r[0]?(r=r.slice(1)||"*",(t[r]=t[r]||[]).unshift(n)):(t[r]=t[r]||[]).push(n)}}function Fe(t,e,n,r){var i={},o=t===Oe;function a(s){var u;return i[s]=!0,b.each(t[s]||[],function(t,s){var c=s(e,n,r);return"string"!=typeof c||o||i[c]?o?!(u=c):void 0:(e.dataTypes.unshift(c),a(c),!1)}),u}return a(e.dataTypes[0])||!i["*"]&&a("*")}function je(t,e){var n,r,i=b.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((i[n]?t:r||(r={}))[n]=e[n]);return r&&b.extend(!0,t,r),t}Ie.href=ye.href,b.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ye.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(ye.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Pe,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":b.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?je(je(t,b.ajaxSettings),e):je(b.ajaxSettings,t)},ajaxPrefilter:Ne(Le),ajaxTransport:Ne(Oe),ajax:function(e,n){"object"==typeof e&&(n=e,e=void 0);var i,o,a,s,u,c,l,h,f,d,p=b.ajaxSetup({},n=n||{}),m=p.context||p,g=p.context&&(m.nodeType||m.jquery)?b(m):b.event,v=b.Deferred(),y=b.Callbacks("once memory"),w=p.statusCode||{},x={},_={},M="canceled",E={readyState:0,getResponseHeader:function(t){var e;if(l){if(!s)for(s={};e=Ce.exec(a);)s[e[1].toLowerCase()]=e[2];e=s[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return l?a:null},setRequestHeader:function(t,e){return null==l&&(t=_[t.toLowerCase()]=_[t.toLowerCase()]||t,x[t]=e),this},overrideMimeType:function(t){return null==l&&(p.mimeType=t),this},statusCode:function(t){var e;if(t)if(l)E.always(t[E.status]);else for(e in t)w[e]=[w[e],t[e]];return this},abort:function(t){var e=t||M;return i&&i.abort(e),S(0,e),this}};if(v.promise(E),p.url=((e||p.url||ye.href)+"").replace(De,ye.protocol+"//"),p.type=n.method||n.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(I)||[""],null==p.crossDomain){c=r.createElement("a");try{c.href=p.url,c.href=c.href,p.crossDomain=Ie.protocol+"//"+Ie.host!=c.protocol+"//"+c.host}catch(t){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=b.param(p.data,p.traditional)),Fe(Le,p,n,E),l)return E;for(f in(h=b.event&&p.global)&&0==b.active++&&b.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Re.test(p.type),o=p.url.replace(Ae,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(Te,"+")):(d=p.url.slice(o.length),p.data&&(p.processData||"string"==typeof p.data)&&(o+=(be.test(o)?"&":"?")+p.data,delete p.data),!1===p.cache&&(o=o.replace(ke,"$1"),d=(be.test(o)?"&":"?")+"_="+we+++d),p.url=o+d),p.ifModified&&(b.lastModified[o]&&E.setRequestHeader("If-Modified-Since",b.lastModified[o]),b.etag[o]&&E.setRequestHeader("If-None-Match",b.etag[o])),(p.data&&p.hasContent&&!1!==p.contentType||n.contentType)&&E.setRequestHeader("Content-Type",p.contentType),E.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Pe+"; q=0.01":""):p.accepts["*"]),p.headers)E.setRequestHeader(f,p.headers[f]);if(p.beforeSend&&(!1===p.beforeSend.call(m,E,p)||l))return E.abort();if(M="abort",y.add(p.complete),E.done(p.success),E.fail(p.error),i=Fe(Oe,p,n,E)){if(E.readyState=1,h&&g.trigger("ajaxSend",[E,p]),l)return E;p.async&&p.timeout>0&&(u=t.setTimeout(function(){E.abort("timeout")},p.timeout));try{l=!1,i.send(x,S)}catch(t){if(l)throw t;S(-1,t)}}else S(-1,"No Transport");function S(e,n,r,s){var c,f,d,x,_,M=n;l||(l=!0,u&&t.clearTimeout(u),i=void 0,a=s||"",E.readyState=e>0?4:0,c=e>=200&&e<300||304===e,r&&(x=function(t,e,n){for(var r,i,o,a,s=t.contents,u=t.dataTypes;"*"===u[0];)u.shift(),void 0===r&&(r=t.mimeType||e.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||t.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(p,E,r)),x=function(t,e,n,r){var i,o,a,s,u,c={},l=t.dataTypes.slice();if(l[1])for(a in t.converters)c[a.toLowerCase()]=t.converters[a];for(o=l.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!u&&r&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),u=o,o=l.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=c[u+" "+o]||c["* "+o]))for(i in c)if((s=i.split(" "))[1]===o&&(a=c[u+" "+s[0]]||c["* "+s[0]])){!0===a?a=c[i]:!0!==c[i]&&(o=s[0],l.unshift(s[1]));break}if(!0!==a)if(a&&t.throws)e=a(e);else try{e=a(e)}catch(t){return{state:"parsererror",error:a?t:"No conversion from "+u+" to "+o}}}return{state:"success",data:e}}(p,x,E,c),c?(p.ifModified&&((_=E.getResponseHeader("Last-Modified"))&&(b.lastModified[o]=_),(_=E.getResponseHeader("etag"))&&(b.etag[o]=_)),204===e||"HEAD"===p.type?M="nocontent":304===e?M="notmodified":(M=x.state,f=x.data,c=!(d=x.error))):(d=M,!e&&M||(M="error",e<0&&(e=0))),E.status=e,E.statusText=(n||M)+"",c?v.resolveWith(m,[f,M,E]):v.rejectWith(m,[E,M,d]),E.statusCode(w),w=void 0,h&&g.trigger(c?"ajaxSuccess":"ajaxError",[E,p,c?f:d]),y.fireWith(m,[E,M]),h&&(g.trigger("ajaxComplete",[E,p]),--b.active||b.event.trigger("ajaxStop")))}return E},getJSON:function(t,e,n){return b.get(t,e,n,"json")},getScript:function(t,e){return b.get(t,void 0,e,"script")}}),b.each(["get","post"],function(t,e){b[e]=function(t,n,r,i){return m(n)&&(i=i||r,r=n,n=void 0),b.ajax(b.extend({url:t,type:e,dataType:i,data:n,success:r},b.isPlainObject(t)&&t))}}),b._evalUrl=function(t){return b.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},b.fn.extend({wrapAll:function(t){var e;return this[0]&&(m(t)&&(t=t.call(this[0])),e=b(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(t){return m(t)?this.each(function(e){b(this).wrapInner(t.call(this,e))}):this.each(function(){var e=b(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)})},wrap:function(t){var e=m(t);return this.each(function(n){b(this).wrapAll(e?t.call(this,n):t)})},unwrap:function(t){return this.parent(t).not("body").each(function(){b(this).replaceWith(this.childNodes)}),this}}),b.expr.pseudos.hidden=function(t){return!b.expr.pseudos.visible(t)},b.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},b.ajaxSettings.xhr=function(){try{return new t.XMLHttpRequest}catch(t){}};var ze={0:200,1223:204},Ue=b.ajaxSettings.xhr();p.cors=!!Ue&&"withCredentials"in Ue,p.ajax=Ue=!!Ue,b.ajaxTransport(function(e){var n,r;if(p.cors||Ue&&!e.crossDomain)return{send:function(i,o){var a,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(a in e.xhrFields)s[a]=e.xhrFields[a];for(a in e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),i)s.setRequestHeader(a,i[a]);n=function(t){return function(){n&&(n=r=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===t?s.abort():"error"===t?"number"!=typeof s.status?o(0,"error"):o(s.status,s.statusText):o(ze[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=n(),r=s.onerror=s.ontimeout=n("error"),void 0!==s.onabort?s.onabort=r:s.onreadystatechange=function(){4===s.readyState&&t.setTimeout(function(){n&&r()})},n=n("abort");try{s.send(e.hasContent&&e.data||null)}catch(t){if(n)throw t}},abort:function(){n&&n()}}}),b.ajaxPrefilter(function(t){t.crossDomain&&(t.contents.script=!1)}),b.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return b.globalEval(t),t}}}),b.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),b.ajaxTransport("script",function(t){var e,n;if(t.crossDomain)return{send:function(i,o){e=b("<script>").prop({charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&o("error"===t.type?404:200,t.type)}),r.head.appendChild(e[0])},abort:function(){n&&n()}}});var Ve,Be=[],He=/(=)\?(?=&|$)|\?\?/;b.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Be.pop()||b.expando+"_"+we++;return this[t]=!0,t}}),b.ajaxPrefilter("json jsonp",function(e,n,r){var i,o,a,s=!1!==e.jsonp&&(He.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&He.test(e.data)&&"data");if(s||"jsonp"===e.dataTypes[0])return i=e.jsonpCallback=m(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(He,"$1"+i):!1!==e.jsonp&&(e.url+=(be.test(e.url)?"&":"?")+e.jsonp+"="+i),e.converters["script json"]=function(){return a||b.error(i+" was not called"),a[0]},e.dataTypes[0]="json",o=t[i],t[i]=function(){a=arguments},r.always(function(){void 0===o?b(t).removeProp(i):t[i]=o,e[i]&&(e.jsonpCallback=n.jsonpCallback,Be.push(i)),a&&m(o)&&o(a[0]),a=o=void 0}),"script"}),p.createHTMLDocument=((Ve=r.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Ve.childNodes.length),b.parseHTML=function(t,e,n){return"string"!=typeof t?[]:("boolean"==typeof e&&(n=e,e=!1),e||(p.createHTMLDocument?((i=(e=r.implementation.createHTMLDocument("")).createElement("base")).href=r.location.href,e.head.appendChild(i)):e=r),o=k.exec(t),a=!n&&[],o?[e.createElement(o[1])]:(o=yt([t],e,a),a&&a.length&&b(a).remove(),b.merge([],o.childNodes)));var i,o,a},b.fn.load=function(t,e,n){var r,i,o,a=this,s=t.indexOf(" ");return s>-1&&(r=fe(t.slice(s)),t=t.slice(0,s)),m(e)?(n=e,e=void 0):e&&"object"==typeof e&&(i="POST"),a.length>0&&b.ajax({url:t,type:i||"GET",dataType:"html",data:e}).done(function(t){o=arguments,a.html(r?b("<div>").append(b.parseHTML(t)).find(r):t)}).always(n&&function(t,e){a.each(function(){n.apply(this,o||[t.responseText,e,t])})}),this},b.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){b.fn[e]=function(t){return this.on(e,t)}}),b.expr.pseudos.animated=function(t){return b.grep(b.timers,function(e){return t===e.elem}).length},b.offset={setOffset:function(t,e,n){var r,i,o,a,s,u,c=b.css(t,"position"),l=b(t),h={};"static"===c&&(t.style.position="relative"),s=l.offset(),o=b.css(t,"top"),u=b.css(t,"left"),("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1?(a=(r=l.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),m(e)&&(e=e.call(t,n,b.extend({},s))),null!=e.top&&(h.top=e.top-s.top+a),null!=e.left&&(h.left=e.left-s.left+i),"using"in e?e.using.call(t,h):l.css(h)}},b.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){b.offset.setOffset(this,t,e)});var e,n,r=this[0];return r?r.getClientRects().length?{top:(e=r.getBoundingClientRect()).top+(n=r.ownerDocument.defaultView).pageYOffset,left:e.left+n.pageXOffset}:{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,n,r=this[0],i={top:0,left:0};if("fixed"===b.css(r,"position"))e=r.getBoundingClientRect();else{for(e=this.offset(),n=r.ownerDocument,t=r.offsetParent||n.documentElement;t&&(t===n.body||t===n.documentElement)&&"static"===b.css(t,"position");)t=t.parentNode;t&&t!==r&&1===t.nodeType&&((i=b(t).offset()).top+=b.css(t,"borderTopWidth",!0),i.left+=b.css(t,"borderLeftWidth",!0))}return{top:e.top-i.top-b.css(r,"marginTop",!0),left:e.left-i.left-b.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===b.css(t,"position");)t=t.offsetParent;return t||wt})}}),b.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var n="pageYOffset"===e;b.fn[t]=function(r){return B(this,function(t,r,i){var o;if(g(t)?o=t:9===t.nodeType&&(o=t.defaultView),void 0===i)return o?o[e]:t[r];o?o.scrollTo(n?o.pageXOffset:i,n?i:o.pageYOffset):t[r]=i},t,r,arguments.length)}}),b.each(["top","left"],function(t,e){b.cssHooks[e]=Vt(p.pixelPosition,function(t,n){if(n)return n=Ut(t,e),Ft.test(n)?b(t).position()[e]+"px":n})}),b.each({Height:"height",Width:"width"},function(t,e){b.each({padding:"inner"+t,content:e,"":"outer"+t},function(n,r){b.fn[r]=function(i,o){var a=arguments.length&&(n||"boolean"!=typeof i),s=n||(!0===i||!0===o?"margin":"border");return B(this,function(e,n,i){var o;return g(e)?0===r.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+t],o["scroll"+t],e.body["offset"+t],o["offset"+t],o["client"+t])):void 0===i?b.css(e,n,s):b.style(e,n,i,s)},e,a?i:void 0,a)}})}),b.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(t,e){b.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}),b.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),b.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,r){return this.on(e,t,n,r)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)}}),b.proxy=function(t,e){var n,r,i;if("string"==typeof e&&(n=t[e],e=t,t=n),m(t))return r=o.call(arguments,2),(i=function(){return t.apply(e||this,r.concat(o.call(arguments)))}).guid=t.guid=t.guid||b.guid++,i},b.holdReady=function(t){t?b.readyWait++:b.ready(!0)},b.isArray=Array.isArray,b.parseJSON=JSON.parse,b.nodeName=A,b.isFunction=m,b.isWindow=g,b.camelCase=W,b.type=w,b.now=Date.now,b.isNumeric=function(t){var e=b.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},"function"==typeof define&&define.amd&&define("jquery",[],function(){return b});var qe=t.jQuery,Ge=t.$;return b.noConflict=function(e){return t.$===b&&(t.$=Ge),e&&t.jQuery===b&&(t.jQuery=qe),b},e||(t.jQuery=t.$=b),b}),function(t,e,n,r){"use strict";var i,o=["","webkit","Moz","MS","ms","o"],a=e.createElement("div"),s="function",u=Math.round,c=Math.abs,l=Date.now;function h(t,e,n){return setTimeout(y(t,n),e)}function f(t,e,n){return!!Array.isArray(t)&&(d(t,n[e],n),!0)}function d(t,e,n){var i;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==r)for(i=0;i<t.length;)e.call(n,t[i],i,t),i++;else for(i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i,t)}function p(e,n,r){var i="DEPRECATED METHOD: "+n+"\n"+r+" AT \n";return function(){var n=new Error("get-stack-trace"),r=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=t.console&&(t.console.warn||t.console.log);return o&&o.call(t.console,i,r),e.apply(this,arguments)}}i="function"!=typeof Object.assign?function(t){if(t===r||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(i!==r&&null!==i)for(var o in i)i.hasOwnProperty(o)&&(e[o]=i[o])}return e}:Object.assign;var m=p(function(t,e,n){for(var i=Object.keys(e),o=0;o<i.length;)(!n||n&&t[i[o]]===r)&&(t[i[o]]=e[i[o]]),o++;return t},"extend","Use `assign`."),g=p(function(t,e){return m(t,e,!0)},"merge","Use `assign`.");function v(t,e,n){var r,o=e.prototype;(r=t.prototype=Object.create(o)).constructor=t,r._super=o,n&&i(r,n)}function y(t,e){return function(){return t.apply(e,arguments)}}function w(t,e){return typeof t==s?t.apply(e&&e[0]||r,e):t}function b(t,e){return t===r?e:t}function x(t,e,n){d(S(e),function(e){t.addEventListener(e,n,!1)})}function _(t,e,n){d(S(e),function(e){t.removeEventListener(e,n,!1)})}function M(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function E(t,e){return t.indexOf(e)>-1}function S(t){return t.trim().split(/\s+/g)}function T(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function A(t){return Array.prototype.slice.call(t,0)}function k(t,e,n){for(var r=[],i=[],o=0;o<t.length;){var a=e?t[o][e]:t[o];T(i,a)<0&&r.push(t[o]),i[o]=a,o++}return n&&(r=e?r.sort(function(t,n){return t[e]>n[e]}):r.sort()),r}function C(t,e){for(var n,i,a=e[0].toUpperCase()+e.slice(1),s=0;s<o.length;){if((i=(n=o[s])?n+a:e)in t)return i;s++}return r}var R=1;function D(e){var n=e.ownerDocument||e;return n.defaultView||n.parentWindow||t}var L="ontouchstart"in t,O=C(t,"PointerEvent")!==r,P=L&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),I=25,N=1,F=4,j=8,z=1,U=2,V=4,B=8,H=16,q=U|V,G=B|H,W=q|G,Y=["x","y"],X=["clientX","clientY"];function $(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){w(t.options.enable,[t])&&n.handler(e)},this.init()}function Q(t,e,n){var i=n.pointers.length,o=n.changedPointers.length,a=e&N&&i-o==0,s=e&(F|j)&&i-o==0;n.isFirst=!!a,n.isFinal=!!s,a&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,i=e.pointers,o=i.length;n.firstInput||(n.firstInput=J(e)),o>1&&!n.firstMultiple?n.firstMultiple=J(e):1===o&&(n.firstMultiple=!1);var a=n.firstInput,s=n.firstMultiple,u=s?s.center:a.center,h=e.center=Z(i);e.timeStamp=l(),e.deltaTime=e.timeStamp-a.timeStamp,e.angle=nt(u,h),e.distance=et(u,h),function(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};e.eventType!==N&&o.eventType!==F||(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}(n,e),e.offsetDirection=tt(e.deltaX,e.deltaY);var f,d,p=K(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=p.x,e.overallVelocityY=p.y,e.overallVelocity=c(p.x)>c(p.y)?p.x:p.y,e.scale=s?(f=s.pointers,et((d=i)[0],d[1],X)/et(f[0],f[1],X)):1,e.rotation=s?function(t,e){return nt(i[1],i[0],X)+nt(t[1],t[0],X)}(s.pointers):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,i,o,a,s=t.lastInterval||e,u=e.timeStamp-s.timeStamp;if(e.eventType!=j&&(u>I||s.velocity===r)){var l=e.deltaX-s.deltaX,h=e.deltaY-s.deltaY,f=K(u,l,h);i=f.x,o=f.y,n=c(f.x)>c(f.y)?f.x:f.y,a=tt(l,h),t.lastInterval=e}else n=s.velocity,i=s.velocityX,o=s.velocityY,a=s.direction;e.velocity=n,e.velocityX=i,e.velocityY=o,e.direction=a}(n,e);var m=t.element;M(e.srcEvent.target,m)&&(m=e.srcEvent.target),e.target=m}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function J(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:u(t.pointers[n].clientX),clientY:u(t.pointers[n].clientY)},n++;return{timeStamp:l(),pointers:e,center:Z(e),deltaX:t.deltaX,deltaY:t.deltaY}}function Z(t){var e=t.length;if(1===e)return{x:u(t[0].clientX),y:u(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:u(n/e),y:u(r/e)}}function K(t,e,n){return{x:e/t||0,y:n/t||0}}function tt(t,e){return t===e?z:c(t)>=c(e)?t<0?U:V:e<0?B:H}function et(t,e,n){n||(n=Y);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function nt(t,e,n){return n||(n=Y),180*Math.atan2(e[n[1]]-t[n[1]],e[n[0]]-t[n[0]])/Math.PI}$.prototype={handler:function(){},init:function(){this.evEl&&x(this.element,this.evEl,this.domHandler),this.evTarget&&x(this.target,this.evTarget,this.domHandler),this.evWin&&x(D(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&_(this.element,this.evEl,this.domHandler),this.evTarget&&_(this.target,this.evTarget,this.domHandler),this.evWin&&_(D(this.element),this.evWin,this.domHandler)}};var rt={mousedown:N,mousemove:2,mouseup:F},it="mousedown",ot="mousemove mouseup";function at(){this.evEl=it,this.evWin=ot,this.pressed=!1,$.apply(this,arguments)}v(at,$,{handler:function(t){var e=rt[t.type];e&N&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=F),this.pressed&&(e&F&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}});var st={pointerdown:N,pointermove:2,pointerup:F,pointercancel:j,pointerout:j},ut={2:"touch",3:"pen",4:"mouse",5:"kinect"},ct="pointerdown",lt="pointermove pointerup pointercancel";function ht(){this.evEl=ct,this.evWin=lt,$.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}t.MSPointerEvent&&!t.PointerEvent&&(ct="MSPointerDown",lt="MSPointerMove MSPointerUp MSPointerCancel"),v(ht,$,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=st[r],o=ut[t.pointerType]||t.pointerType,a="touch"==o,s=T(e,t.pointerId,"pointerId");i&N&&(0===t.button||a)?s<0&&(e.push(t),s=e.length-1):i&(F|j)&&(n=!0),s<0||(e[s]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(s,1))}});var ft={touchstart:N,touchmove:2,touchend:F,touchcancel:j},dt="touchstart",pt="touchstart touchmove touchend touchcancel";function mt(){this.evTarget=dt,this.evWin=pt,this.started=!1,$.apply(this,arguments)}v(mt,$,{handler:function(t){var e=ft[t.type];if(e===N&&(this.started=!0),this.started){var n=(function(t,e){var n=A(t.touches),r=A(t.changedTouches);return e&(F|j)&&(n=k(n.concat(r),"identifier",!0)),[n,r]}).call(this,t,e);e&(F|j)&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}}});var gt={touchstart:N,touchmove:2,touchend:F,touchcancel:j},vt="touchstart touchmove touchend touchcancel";function yt(){this.evTarget=vt,this.targetIds={},$.apply(this,arguments)}v(yt,$,{handler:function(t){var e=gt[t.type],n=(function(t,e){var n=A(t.touches),r=this.targetIds;if(e&(2|N)&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,a=A(t.changedTouches),s=[],u=this.target;if(o=n.filter(function(t){return M(t.target,u)}),e===N)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<a.length;)r[a[i].identifier]&&s.push(a[i]),e&(F|j)&&delete r[a[i].identifier],i++;return s.length?[k(o.concat(s),"identifier",!0),s]:void 0}).call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}});var wt=2500;function bt(){$.apply(this,arguments);var t=y(this.handler,this);this.touch=new yt(this.manager,t),this.mouse=new at(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function xt(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout(function(){var t=r.indexOf(n);t>-1&&r.splice(t,1)},wt)}}v(bt,$,{handler:function(t,e,n){var r="mouse"==n.pointerType;if(!(r&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if("touch"==n.pointerType)(function(t,e){t&N?(this.primaryTouch=e.changedPointers[0].identifier,xt.call(this,e)):t&(F|j)&&xt.call(this,e)}).call(this,e,n);else if(r&&(function(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(e-i.x),a=Math.abs(n-i.y);if(o<=25&&a<=25)return!0}return!1}).call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var _t=C(a.style,"touchAction"),Mt=_t!==r,Et=function(){if(!Mt)return!1;var e={},n=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(r){e[r]=!n||t.CSS.supports("touch-action",r)}),e}();function St(t,e){this.manager=t,this.set(e)}St.prototype={set:function(t){"compute"==t&&(t=this.compute()),Mt&&this.manager.element.style&&Et[t]&&(this.manager.element.style[_t]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return d(this.manager.recognizers,function(e){w(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),function(t){if(E(t,"none"))return"none";var e=E(t,"pan-x"),n=E(t,"pan-y");return e&&n?"none":e||n?e?"pan-x":"pan-y":E(t,"manipulation")?"manipulation":"auto"}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,i=E(r,"none")&&!Et.none,o=E(r,"pan-y")&&!Et["pan-y"],a=E(r,"pan-x")&&!Et["pan-x"];if(i&&1===t.pointers.length&&t.distance<2&&t.deltaTime<250)return;if(!a||!o)return i||o&&n&q||a&&n&G?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Tt=1,At=2,kt=4,Ct=8,Rt=Ct,Dt=16;function Lt(t){this.options=i({},this.defaults,t||{}),this.id=R++,this.manager=null,this.options.enable=b(this.options.enable,!0),this.state=Tt,this.simultaneous={},this.requireFail=[]}function Ot(t){return t&Dt?"cancel":t&Ct?"end":t&kt?"move":t&At?"start":""}function Pt(t){return t==H?"down":t==B?"up":t==U?"left":t==V?"right":""}function It(t,e){var n=e.manager;return n?n.get(t):t}function Nt(){Lt.apply(this,arguments)}function Ft(){Nt.apply(this,arguments),this.pX=null,this.pY=null}function jt(){Nt.apply(this,arguments)}function zt(){Lt.apply(this,arguments),this._timer=null,this._input=null}function Ut(){Nt.apply(this,arguments)}function Vt(){Nt.apply(this,arguments)}function Bt(){Lt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Ht(t,e){return(e=e||{}).recognizers=b(e.recognizers,Ht.defaults.preset),new qt(t,e)}function qt(t,e){var n;this.options=i({},Ht.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((n=this).options.inputClass||(O?ht:P?yt:L?bt:at))(n,Q),this.touchAction=new St(this,this.options.touchAction),Gt(this,!0),d(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function Gt(t,e){var n,r=t.element;r.style&&(d(t.options.cssProps,function(i,o){n=C(r.style,o),e?(t.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=t.oldCssProps[n]||""}),e||(t.oldCssProps={}))}Lt.prototype={defaults:{},set:function(t){return i(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(f(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=It(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return f(t,"dropRecognizeWith",this)?this:(t=It(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(f(t,"requireFailure",this))return this;var e=this.requireFail;return-1===T(e,t=It(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(f(t,"dropRequireFailure",this))return this;t=It(t,this);var e=T(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function r(n){e.manager.emit(n,t)}n<Ct&&r(e.options.event+Ot(n)),r(e.options.event),t.additionalEvent&&r(t.additionalEvent),n>=Ct&&r(e.options.event+Ot(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(32|Tt)))return!1;t++}return!0},recognize:function(t){var e=i({},t);if(!w(this.options.enable,[this,e]))return this.reset(),void(this.state=32);this.state&(Rt|Dt|32)&&(this.state=Tt),this.state=this.process(e),this.state&(At|kt|Ct|Dt)&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},v(Nt,Lt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=e&(At|kt),i=this.attrTest(t);return r&&(n&j||!i)?e|Dt:r||i?n&F?e|Ct:e&At?e|kt:At:32}}),v(Ft,Nt,{defaults:{event:"pan",threshold:10,pointers:1,direction:W},getTouchAction:function(){var t=this.options.direction,e=[];return t&q&&e.push("pan-y"),t&G&&e.push("pan-x"),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,a=t.deltaY;return i&e.direction||(e.direction&q?(i=0===o?z:o<0?U:V,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===a?z:a<0?B:H,n=a!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return Nt.prototype.attrTest.call(this,t)&&(this.state&At||!(this.state&At)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Pt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),v(jt,Nt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&At)},emit:function(t){1!==t.scale&&(t.additionalEvent=this.options.event+(t.scale<1?"in":"out")),this._super.emit.call(this,t)}}),v(zt,Lt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||t.eventType&(F|j)&&!i)this.reset();else if(t.eventType&N)this.reset(),this._timer=h(function(){this.state=Rt,this.tryEmit()},e.time,this);else if(t.eventType&F)return Rt;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===Rt&&(t&&t.eventType&F?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=l(),this.manager.emit(this.options.event,this._input)))}}),v(Ut,Nt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&At)}}),v(Vt,Nt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:q|G,pointers:1},getTouchAction:function(){return Ft.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&(q|G)?e=t.overallVelocity:n&q?e=t.overallVelocityX:n&G&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&c(e)>this.options.velocity&&t.eventType&F},emit:function(t){var e=Pt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),v(Bt,Lt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return["manipulation"]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),t.eventType&N&&0===this.count)return this.failTimeout();if(r&&i&&n){if(t.eventType!=F)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,a=!this.pCenter||et(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,a&&o?this.count+=1:this.count=1,this._input=t,0==this.count%e.taps)return this.hasRequireFailures()?(this._timer=h(function(){this.state=Rt,this.tryEmit()},e.interval,this),At):Rt}return 32},failTimeout:function(){return this._timer=h(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Rt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Ht.VERSION="2.0.7",Ht.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[Ut,{enable:!1}],[jt,{enable:!1},["rotate"]],[Vt,{direction:q}],[Ft,{direction:q},["swipe"]],[Bt],[Bt,{event:"doubletap",taps:2},["tap"]],[zt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},qt.prototype={set:function(t){return i(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var r=this.recognizers,i=e.curRecognizer;(!i||i&&i.state&Rt)&&(i=e.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===e.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&n.state&(At|kt|Ct)&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof Lt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(f(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(f(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=T(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==r&&e!==r){var n=this.handlers;return d(S(t),function(t){n[t]=n[t]||[],n[t].push(e)}),this}},off:function(t,e){if(t!==r){var n=this.handlers;return d(S(t),function(t){e?n[t]&&n[t].splice(T(n[t],e),1):delete n[t]}),this}},emit:function(t,n){this.options.domEvents&&function(t,n){var r=e.createEvent("Event");r.initEvent(t,!0,!0),r.gesture=n,n.target.dispatchEvent(r)}(t,n);var r=this.handlers[t]&&this.handlers[t].slice();if(r&&r.length){n.type=t,n.preventDefault=function(){n.srcEvent.preventDefault()};for(var i=0;i<r.length;)r[i](n),i++}},destroy:function(){this.element&&Gt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},i(Ht,{INPUT_START:N,INPUT_MOVE:2,INPUT_END:F,INPUT_CANCEL:j,STATE_POSSIBLE:Tt,STATE_BEGAN:At,STATE_CHANGED:kt,STATE_ENDED:Ct,STATE_RECOGNIZED:Rt,STATE_CANCELLED:Dt,STATE_FAILED:32,DIRECTION_NONE:z,DIRECTION_LEFT:U,DIRECTION_RIGHT:V,DIRECTION_UP:B,DIRECTION_DOWN:H,DIRECTION_HORIZONTAL:q,DIRECTION_VERTICAL:G,DIRECTION_ALL:W,Manager:qt,Input:$,TouchAction:St,TouchInput:yt,MouseInput:at,PointerEventInput:ht,TouchMouseInput:bt,SingleTouchInput:mt,Recognizer:Lt,AttrRecognizer:Nt,Tap:Bt,Pan:Ft,Swipe:Vt,Pinch:jt,Rotate:Ut,Press:zt,on:x,off:_,each:d,merge:g,extend:m,assign:i,inherit:v,bindFn:y,prefixed:C}),("undefined"!=typeof t?t:"undefined"!=typeof self?self:{}).Hammer=Ht,"function"==typeof define&&define.amd?define(function(){return Ht}):"undefined"!=typeof module&&module.exports?module.exports=Ht:t.Hammer=Ht}(window,document);var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}"undefined"==typeof jQuery&&("function"==typeof require?jQuery=$=require("jquery"):jQuery=$),function(t){"function"==typeof define&&define.amd?define(["jquery"],function(e){return t(e)}):"object"==typeof module&&"object"==typeof module.exports?exports=t(require("jquery")):t(jQuery)}(function(t){t.easing.jswing=t.easing.swing;var e=Math.pow,n=Math.sqrt,r=Math.sin,i=Math.cos,o=Math.PI,a=1.70158,s=1.525*a,u=2*o/3,c=2*o/4.5;function l(t){var e=7.5625,n=2.75;return t<1/n?e*t*t:t<2/n?e*(t-=1.5/n)*t+.75:t<2.5/n?e*(t-=2.25/n)*t+.9375:e*(t-=2.625/n)*t+.984375}t.extend(t.easing,{def:"easeOutQuad",swing:function(e){return t.easing[t.easing.def](e)},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return 1-(1-t)*(1-t)},easeInOutQuad:function(t){return t<.5?2*t*t:1-e(-2*t+2,2)/2},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return 1-e(1-t,3)},easeInOutCubic:function(t){return t<.5?4*t*t*t:1-e(-2*t+2,3)/2},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1-e(1-t,4)},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-e(-2*t+2,4)/2},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1-e(1-t,5)},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1-e(-2*t+2,5)/2},easeInSine:function(t){return 1-i(t*o/2)},easeOutSine:function(t){return r(t*o/2)},easeInOutSine:function(t){return-(i(o*t)-1)/2},easeInExpo:function(t){return 0===t?0:e(2,10*t-10)},easeOutExpo:function(t){return 1===t?1:1-e(2,-10*t)},easeInOutExpo:function(t){return 0===t?0:1===t?1:t<.5?e(2,20*t-10)/2:(2-e(2,-20*t+10))/2},easeInCirc:function(t){return 1-n(1-e(t,2))},easeOutCirc:function(t){return n(1-e(t-1,2))},easeInOutCirc:function(t){return t<.5?(1-n(1-e(2*t,2)))/2:(n(1-e(-2*t+2,2))+1)/2},easeInElastic:function(t){return 0===t?0:1===t?1:-e(2,10*t-10)*r((10*t-10.75)*u)},easeOutElastic:function(t){return 0===t?0:1===t?1:e(2,-10*t)*r((10*t-.75)*u)+1},easeInOutElastic:function(t){return 0===t?0:1===t?1:t<.5?-e(2,20*t-10)*r((20*t-11.125)*c)/2:e(2,-20*t+10)*r((20*t-11.125)*c)/2+1},easeInBack:function(t){return 2.70158*t*t*t-a*t*t},easeOutBack:function(t){return 1+2.70158*e(t-1,3)+a*e(t-1,2)},easeInOutBack:function(t){return t<.5?e(2*t,2)*(7.189819*t-s)/2:(e(2*t-2,2)*((s+1)*(2*t-2)+s)+2)/2},easeInBounce:function(t){return 1-l(1-t)},easeOutBounce:l,easeInOutBounce:function(t){return t<.5?(1-l(1-2*t))/2:(1+l(2*t-1))/2}})}),jQuery.extend(jQuery.easing,{easeInOutMaterial:function(t,e,n,r,i){return(e/=i/2)<1?r/2*e*e+n:r/4*((e-=2)*e*e+2)+n}}),jQuery.Velocity?console.log("Velocity is already loaded. You may be needlessly importing Velocity again; note that Materialize includes Velocity."):(function(t){function e(t){var e=t.length,r=n.type(t);return"function"!==r&&!n.isWindow(t)&&(!(1!==t.nodeType||!e)||"array"===r||0===e||"number"==typeof e&&e>0&&e-1 in t)}if(!t.jQuery){var n=function(t,e){return new n.fn.init(t,e)};n.isWindow=function(t){return null!=t&&t==t.window},n.type=function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?i[a.call(t)]||"object":typeof t},n.isArray=Array.isArray||function(t){return"array"===n.type(t)},n.isPlainObject=function(t){var e;if(!t||"object"!==n.type(t)||t.nodeType||n.isWindow(t))return!1;try{if(t.constructor&&!o.call(t,"constructor")&&!o.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}for(e in t);return void 0===e||o.call(t,e)},n.each=function(t,n,r){var i=0,o=t.length,a=e(t);if(r){if(a)for(;o>i&&!1!==n.apply(t[i],r);i++);else for(i in t)if(!1===n.apply(t[i],r))break}else if(a)for(;o>i&&!1!==n.call(t[i],i,t[i]);i++);else for(i in t)if(!1===n.call(t[i],i,t[i]))break;return t},n.data=function(t,e,i){if(void 0===i){var o=(a=t[n.expando])&&r[a];if(void 0===e)return o;if(o&&e in o)return o[e]}else if(void 0!==e){var a=t[n.expando]||(t[n.expando]=++n.uuid);return r[a]=r[a]||{},r[a][e]=i,i}},n.removeData=function(t,e){var i=t[n.expando],o=i&&r[i];o&&n.each(e,function(t,e){delete o[e]})},n.extend=function(){var t,e,r,i,o,a,s=arguments[0]||{},u=1,c=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[u]||{},u++),"object"!=typeof s&&"function"!==n.type(s)&&(s={}),u===c&&(s=this,u--);c>u;u++)if(null!=(o=arguments[u]))for(i in o)t=s[i],s!==(r=o[i])&&(l&&r&&(n.isPlainObject(r)||(e=n.isArray(r)))?(e?(e=!1,a=t&&n.isArray(t)?t:[]):a=t&&n.isPlainObject(t)?t:{},s[i]=n.extend(l,a,r)):void 0!==r&&(s[i]=r));return s},n.queue=function(t,r,i){if(t){var o=n.data(t,r=(r||"fx")+"queue");return i?(!o||n.isArray(i)?o=n.data(t,r,function(t,n){var r=[];return null!=t&&(e(Object(t))?function(t,e){for(var n=+e.length,r=0,i=t.length;n>r;)t[i++]=e[r++];if(n!=n)for(;void 0!==e[r];)t[i++]=e[r++];t.length=i}(r,"string"==typeof t?[t]:t):[].push.call(r,t)),r}(i)):o.push(i),o):o||[]}},n.dequeue=function(t,e){n.each(t.nodeType?[t]:t,function(t,r){var i=n.queue(r,e=e||"fx"),o=i.shift();"inprogress"===o&&(o=i.shift()),o&&("fx"===e&&i.unshift("inprogress"),o.call(r,function(){n.dequeue(r,e)}))})},n.fn=n.prototype={init:function(t){if(t.nodeType)return this[0]=t,this;throw new Error("Not a DOM node.")},offset:function(){var e=this[0].getBoundingClientRect?this[0].getBoundingClientRect():{top:0,left:0};return{top:e.top+(t.pageYOffset||document.scrollTop||0)-(document.clientTop||0),left:e.left+(t.pageXOffset||document.scrollLeft||0)-(document.clientLeft||0)}},position:function(){function t(){for(var t=this.offsetParent||document;t&&"html"===!t.nodeType.toLowerCase&&"static"===t.style.position;)t=t.offsetParent;return t||document}var e=this[0],t=t.apply(e),r=this.offset(),i=/^(?:body|html)$/i.test(t.nodeName)?{top:0,left:0}:n(t).offset();return r.top-=parseFloat(e.style.marginTop)||0,r.left-=parseFloat(e.style.marginLeft)||0,t.style&&(i.top+=parseFloat(t.style.borderTopWidth)||0,i.left+=parseFloat(t.style.borderLeftWidth)||0),{top:r.top-i.top,left:r.left-i.left}}};var r={};n.expando="velocity"+(new Date).getTime(),n.uuid=0;for(var i={},o=i.hasOwnProperty,a=i.toString,s="Boolean Number String Function Array Date RegExp Object Error".split(" "),u=0;u<s.length;u++)i["[object "+s[u]+"]"]=s[u].toLowerCase();n.fn.init.prototype=n.fn,t.Velocity={Utilities:n}}}(window),function(t){"object"==typeof module&&"object"==typeof module.exports?module.exports=t():"function"==typeof define&&define.amd?define(t):t()}(function(){return function(t,e,n,r){function i(t){return d.isWrapped(t)?t=[].slice.call(t):d.isNode(t)&&(t=[t]),t}function o(t){var e=l.data(t,"velocity");return null===e?r:e}function a(t,n,r,i){function o(t,e){return 1-3*e+3*t}function a(t,e){return 3*e-6*t}function s(t){return 3*t}function u(t,e,n){return((o(e,n)*t+a(e,n))*t+s(e))*t}function c(t,e,n){return 3*o(e,n)*t*t+2*a(e,n)*t+s(e)}function l(e,n){for(var i=0;f>i;++i){var o=c(n,t,r);if(0===o)return n;n-=(u(n,t,r)-e)/o}return n}function h(e,n,i){var o,a,s=0;do{(o=u(a=n+(i-n)/2,t,r)-e)>0?i=a:n=a}while(Math.abs(o)>d&&++s<p);return a}var f=4,d=1e-7,p=10,m="Float32Array"in e;if(4!==arguments.length)return!1;for(var g=0;4>g;++g)if("number"!=typeof arguments[g]||isNaN(arguments[g])||!isFinite(arguments[g]))return!1;t=Math.min(t,1),r=Math.min(r,1),t=Math.max(t,0),r=Math.max(r,0);var v=m?new Float32Array(11):new Array(11),y=!1,w=function(e){return y||(y=!0,(t!=n||r!=i)&&function(){for(var e=0;11>e;++e)v[e]=u(.1*e,t,r)}()),t===n&&r===i?e:0===e?0:1===e?1:u(function(e){for(var n=0,i=1;10!=i&&v[i]<=e;++i)n+=.1;var o=n+(e-v[--i])/(v[i+1]-v[i])*.1,a=c(o,t,r);return a>=.001?l(e,o):0==a?o:h(e,n,n+.1)}(e),n,i)};w.getControlPoints=function(){return[{x:t,y:n},{x:r,y:i}]};var b="generateBezier("+[t,n,r,i]+")";return w.toString=function(){return b},w}function s(t,e){var n=t;return d.isString(t)?v.Easings[t]||(n=!1):n=d.isArray(t)&&1===t.length?(function(t){return function(e){return Math.round(e*t)*(1/t)}}).apply(null,t):d.isArray(t)&&2===t.length?y.apply(null,t.concat([e])):!(!d.isArray(t)||4!==t.length)&&a.apply(null,t),!1===n&&(n=v.Easings[v.defaults.easing]?v.defaults.easing:g),n}function u(t){if(t){var e=(new Date).getTime(),n=v.State.calls.length;n>1e4&&(v.State.calls=function(t){for(var e=-1,n=t?t.length:0,r=[];++e<n;){var i=t[e];i&&r.push(i)}return r}(v.State.calls));for(var i=0;n>i;i++)if(v.State.calls[i]){var a=v.State.calls[i],s=a[0],h=a[2],f=a[3],p=!!f,m=null;f||(f=v.State.calls[i][3]=e-16);for(var g=Math.min((e-f)/h.duration,1),y=0,b=s.length;b>y;y++){var _=s[y],M=_.element;if(o(M)){var E=!1;for(var S in h.display!==r&&null!==h.display&&"none"!==h.display&&("flex"===h.display&&l.each(["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex"],function(t,e){w.setPropertyValue(M,"display",e)}),w.setPropertyValue(M,"display",h.display)),h.visibility!==r&&"hidden"!==h.visibility&&w.setPropertyValue(M,"visibility",h.visibility),_)if("element"!==S){var T,A=_[S],k=d.isString(A.easing)?v.Easings[A.easing]:A.easing;if(1===g)T=A.endValue;else{var C=A.endValue-A.startValue;if(T=A.startValue+C*k(g,h,C),!p&&T===A.currentValue)continue}if(A.currentValue=T,"tween"===S)m=T;else{if(w.Hooks.registered[S]){var R=w.Hooks.getRoot(S),D=o(M).rootPropertyValueCache[R];D&&(A.rootPropertyValue=D)}var L=w.setPropertyValue(M,S,A.currentValue+(0===parseFloat(T)?"":A.unitType),A.rootPropertyValue,A.scrollData);w.Hooks.registered[S]&&(o(M).rootPropertyValueCache[R]=w.Normalizations.registered[R]?w.Normalizations.registered[R]("extract",null,L[1]):L[1]),"transform"===L[0]&&(E=!0)}}h.mobileHA&&o(M).transformCache.translate3d===r&&(o(M).transformCache.translate3d="(0px, 0px, 0px)",E=!0),E&&w.flushTransformCache(M)}}h.display!==r&&"none"!==h.display&&(v.State.calls[i][2].display=!1),h.visibility!==r&&"hidden"!==h.visibility&&(v.State.calls[i][2].visibility=!1),h.progress&&h.progress.call(a[1],a[1],g,Math.max(0,f+h.duration-e),f,m),1===g&&c(i)}}v.State.isTicking&&x(u)}function c(t,e){if(!v.State.calls[t])return!1;for(var n=v.State.calls[t][0],i=v.State.calls[t][1],a=v.State.calls[t][2],s=v.State.calls[t][4],u=!1,c=0,h=n.length;h>c;c++){var f=n[c].element;if(e||a.loop||("none"===a.display&&w.setPropertyValue(f,"display",a.display),"hidden"===a.visibility&&w.setPropertyValue(f,"visibility",a.visibility)),!0!==a.loop&&(l.queue(f)[1]===r||!/\.velocityQueueEntryFlag/i.test(l.queue(f)[1]))&&o(f)){o(f).isAnimating=!1,o(f).rootPropertyValueCache={};var d=!1;l.each(w.Lists.transforms3D,function(t,e){var n=/^scale/.test(e)?1:0,i=o(f).transformCache[e];o(f).transformCache[e]!==r&&new RegExp("^\\("+n+"[^.]").test(i)&&(d=!0,delete o(f).transformCache[e])}),a.mobileHA&&(d=!0,delete o(f).transformCache.translate3d),d&&w.flushTransformCache(f),w.Values.removeClass(f,"velocity-animating")}if(!e&&a.complete&&!a.loop&&c===h-1)try{a.complete.call(i,i)}catch(t){setTimeout(function(){throw t},1)}s&&!0!==a.loop&&s(i),o(f)&&!0===a.loop&&!e&&(l.each(o(f).tweensContainer,function(t,e){/^rotate/.test(t)&&360===parseFloat(e.endValue)&&(e.endValue=0,e.startValue=360),/^backgroundPosition/.test(t)&&100===parseFloat(e.endValue)&&"%"===e.unitType&&(e.endValue=0,e.startValue=100)}),v(f,"reverse",{loop:!0,delay:a.delay})),!1!==a.queue&&l.dequeue(f,a.queue)}v.State.calls[t]=!1;for(var p=0,m=v.State.calls.length;m>p;p++)if(!1!==v.State.calls[p]){u=!0;break}!1===u&&(v.State.isTicking=!1,delete v.State.calls,v.State.calls=[])}var l,h=function(){if(n.documentMode)return n.documentMode;for(var t=7;t>4;t--){var e=n.createElement("div");if(e.innerHTML="\x3c!--[if IE "+t+"]><span></span><![endif]--\x3e",e.getElementsByTagName("span").length)return e=null,t}return r}(),f=function(){var t=0;return e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||function(e){var n,r=(new Date).getTime();return n=Math.max(0,16-(r-t)),t=r+n,setTimeout(function(){e(r+n)},n)}}(),d={isString:function(t){return"string"==typeof t},isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)},isNode:function(t){return t&&t.nodeType},isNodeList:function(t){return"object"==typeof t&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(Object.prototype.toString.call(t))&&t.length!==r&&(0===t.length||"object"==typeof t[0]&&t[0].nodeType>0)},isWrapped:function(t){return t&&(t.jquery||e.Zepto&&e.Zepto.zepto.isZ(t))},isSVG:function(t){return e.SVGElement&&t instanceof e.SVGElement},isEmptyObject:function(t){for(var e in t)return!1;return!0}},p=!1;if(t.fn&&t.fn.jquery?(l=t,p=!0):l=e.Velocity.Utilities,8>=h&&!p)throw new Error("Velocity: IE8 and below require jQuery to be loaded before Velocity.");if(!(7>=h)){var m=400,g="swing",v={State:{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isAndroid:/Android/i.test(navigator.userAgent),isGingerbread:/Android 2\.3\.[3-7]/i.test(navigator.userAgent),isChrome:e.chrome,isFirefox:/Firefox/i.test(navigator.userAgent),prefixElement:n.createElement("div"),prefixMatches:{},scrollAnchor:null,scrollPropertyLeft:null,scrollPropertyTop:null,isTicking:!1,calls:[]},CSS:{},Utilities:l,Redirects:{},Easings:{},Promise:e.Promise,defaults:{queue:"",duration:m,easing:g,begin:r,complete:r,progress:r,display:r,visibility:r,loop:!1,delay:!1,mobileHA:!0,_cacheValues:!0},init:function(t){l.data(t,"velocity",{isSVG:d.isSVG(t),isAnimating:!1,computedStyle:null,tweensContainer:null,rootPropertyValueCache:{},transformCache:{}})},hook:null,mock:!1,version:{major:1,minor:2,patch:2},debug:!1};e.pageYOffset!==r?(v.State.scrollAnchor=e,v.State.scrollPropertyLeft="pageXOffset",v.State.scrollPropertyTop="pageYOffset"):(v.State.scrollAnchor=n.documentElement||n.body.parentNode||n.body,v.State.scrollPropertyLeft="scrollLeft",v.State.scrollPropertyTop="scrollTop");var y=function(){function t(t){return-t.tension*t.x-t.friction*t.v}function e(e,n,r){var i={x:e.x+r.dx*n,v:e.v+r.dv*n,tension:e.tension,friction:e.friction};return{dx:i.v,dv:t(i)}}function n(n,r){var i={dx:n.v,dv:t(n)},o=e(n,.5*r,i),a=e(n,.5*r,o),s=e(n,r,a),u=1/6*(i.dv+2*(o.dv+a.dv)+s.dv);return n.x=n.x+1/6*(i.dx+2*(o.dx+a.dx)+s.dx)*r,n.v=n.v+u*r,n}return function t(e,r,i){var o,a,s,u={x:-1,v:0,tension:null,friction:null},c=[0],l=0;for(e=parseFloat(e)||500,r=parseFloat(r)||20,i=i||null,u.tension=e,u.friction=r,a=(o=null!==i)?(l=t(e,r))/i*.016:.016;s=n(s||u,a),c.push(1+s.x),l+=16,Math.abs(s.x)>1e-4&&Math.abs(s.v)>1e-4;);return o?function(t){return c[t*(c.length-1)|0]}:l}}();v.Easings={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},spring:function(t){return 1-Math.cos(4.5*t*Math.PI)*Math.exp(6*-t)}},l.each([["ease",[.25,.1,.25,1]],["ease-in",[.42,0,1,1]],["ease-out",[0,0,.58,1]],["ease-in-out",[.42,0,.58,1]],["easeInSine",[.47,0,.745,.715]],["easeOutSine",[.39,.575,.565,1]],["easeInOutSine",[.445,.05,.55,.95]],["easeInQuad",[.55,.085,.68,.53]],["easeOutQuad",[.25,.46,.45,.94]],["easeInOutQuad",[.455,.03,.515,.955]],["easeInCubic",[.55,.055,.675,.19]],["easeOutCubic",[.215,.61,.355,1]],["easeInOutCubic",[.645,.045,.355,1]],["easeInQuart",[.895,.03,.685,.22]],["easeOutQuart",[.165,.84,.44,1]],["easeInOutQuart",[.77,0,.175,1]],["easeInQuint",[.755,.05,.855,.06]],["easeOutQuint",[.23,1,.32,1]],["easeInOutQuint",[.86,0,.07,1]],["easeInExpo",[.95,.05,.795,.035]],["easeOutExpo",[.19,1,.22,1]],["easeInOutExpo",[1,0,0,1]],["easeInCirc",[.6,.04,.98,.335]],["easeOutCirc",[.075,.82,.165,1]],["easeInOutCirc",[.785,.135,.15,.86]]],function(t,e){v.Easings[e[0]]=a.apply(null,e[1])});var w=v.CSS={RegEx:{isHex:/^#([A-f\d]{3}){1,2}$/i,valueUnwrap:/^[A-z]+\((.*)\)$/i,wrappedValueAlreadyExtracted:/[0-9.]+ [0-9.]+ [0-9.]+( [0-9.]+)?/,valueSplit:/([A-z]+\(.+\))|(([A-z0-9#-.]+?)(?=\s|$))/gi},Lists:{colors:["fill","stroke","stopColor","color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","outlineColor"],transformsBase:["translateX","translateY","scale","scaleX","scaleY","skewX","skewY","rotateZ"],transforms3D:["transformPerspective","translateZ","scaleZ","rotateX","rotateY"]},Hooks:{templates:{textShadow:["Color X Y Blur","black 0px 0px 0px"],boxShadow:["Color X Y Blur Spread","black 0px 0px 0px 0px"],clip:["Top Right Bottom Left","0px 0px 0px 0px"],backgroundPosition:["X Y","0% 0%"],transformOrigin:["X Y Z","50% 50% 0px"],perspectiveOrigin:["X Y","50% 50%"]},registered:{},register:function(){for(var t=0;t<w.Lists.colors.length;t++)w.Hooks.templates[w.Lists.colors[t]]=["Red Green Blue Alpha","color"===w.Lists.colors[t]?"0 0 0 1":"255 255 255 1"];var e,n,r;if(h)for(e in w.Hooks.templates){r=(n=w.Hooks.templates[e])[0].split(" ");var i=n[1].match(w.RegEx.valueSplit);"Color"===r[0]&&(r.push(r.shift()),i.push(i.shift()),w.Hooks.templates[e]=[r.join(" "),i.join(" ")])}for(e in w.Hooks.templates)for(var t in r=(n=w.Hooks.templates[e])[0].split(" "))w.Hooks.registered[e+r[t]]=[e,t]},getRoot:function(t){var e=w.Hooks.registered[t];return e?e[0]:t},cleanRootPropertyValue:function(t,e){return w.RegEx.valueUnwrap.test(e)&&(e=e.match(w.RegEx.valueUnwrap)[1]),w.Values.isCSSNullValue(e)&&(e=w.Hooks.templates[t][1]),e},extractValue:function(t,e){var n=w.Hooks.registered[t];if(n){var r=n[1];return(e=w.Hooks.cleanRootPropertyValue(n[0],e)).toString().match(w.RegEx.valueSplit)[r]}return e},injectValue:function(t,e,n){var r=w.Hooks.registered[t];if(r){var i,o=r[1];return(i=(n=w.Hooks.cleanRootPropertyValue(r[0],n)).toString().match(w.RegEx.valueSplit))[o]=e,i.join(" ")}return n}},Normalizations:{registered:{clip:function(t,e,n){switch(t){case"name":return"clip";case"extract":var r;return w.RegEx.wrappedValueAlreadyExtracted.test(n)?n:(r=n.toString().match(w.RegEx.valueUnwrap))?r[1].replace(/,(\s+)?/g," "):n;case"inject":return"rect("+n+")"}},blur:function(t,e,n){switch(t){case"name":return v.State.isFirefox?"filter":"-webkit-filter";case"extract":var r=parseFloat(n);if(!r&&0!==r){var i=n.toString().match(/blur\(([0-9]+[A-z]+)\)/i);r=i?i[1]:0}return r;case"inject":return parseFloat(n)?"blur("+n+")":"none"}},opacity:function(t,e,n){if(8>=h)switch(t){case"name":return"filter";case"extract":var r=n.toString().match(/alpha\(opacity=(.*)\)/i);return r?r[1]/100:1;case"inject":return e.style.zoom=1,parseFloat(n)>=1?"":"alpha(opacity="+parseInt(100*parseFloat(n),10)+")"}else switch(t){case"name":return"opacity";case"extract":case"inject":return n}}},register:function(){9>=h||v.State.isGingerbread||(w.Lists.transformsBase=w.Lists.transformsBase.concat(w.Lists.transforms3D));for(var t=0;t<w.Lists.transformsBase.length;t++)!function(){var e=w.Lists.transformsBase[t];w.Normalizations.registered[e]=function(t,n,i){switch(t){case"name":return"transform";case"extract":return o(n)===r||o(n).transformCache[e]===r?/^scale/i.test(e)?1:0:o(n).transformCache[e].replace(/[()]/g,"");case"inject":var a=!1;switch(e.substr(0,e.length-1)){case"translate":a=!/(%|px|em|rem|vw|vh|\d)$/i.test(i);break;case"scal":case"scale":v.State.isAndroid&&o(n).transformCache[e]===r&&1>i&&(i=1),a=!/(\d)$/i.test(i);break;case"skew":a=!/(deg|\d)$/i.test(i);break;case"rotate":a=!/(deg|\d)$/i.test(i)}return a||(o(n).transformCache[e]="("+i+")"),o(n).transformCache[e]}}}();for(t=0;t<w.Lists.colors.length;t++)!function(){var e=w.Lists.colors[t];w.Normalizations.registered[e]=function(t,n,i){switch(t){case"name":return e;case"extract":var o;if(w.RegEx.wrappedValueAlreadyExtracted.test(i))o=i;else{var a,s={black:"rgb(0, 0, 0)",blue:"rgb(0, 0, 255)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",red:"rgb(255, 0, 0)",white:"rgb(255, 255, 255)"};/^[A-z]+$/i.test(i)?a=s[i]!==r?s[i]:s.black:w.RegEx.isHex.test(i)?a="rgb("+w.Values.hexToRgb(i).join(" ")+")":/^rgba?\(/i.test(i)||(a=s.black),o=(a||i).toString().match(w.RegEx.valueUnwrap)[1].replace(/,(\s+)?/g," ")}return 8>=h||3!==o.split(" ").length||(o+=" 1"),o;case"inject":return 8>=h?4===i.split(" ").length&&(i=i.split(/\s+/).slice(0,3).join(" ")):3===i.split(" ").length&&(i+=" 1"),(8>=h?"rgb":"rgba")+"("+i.replace(/\s+/g,",").replace(/\.(\d)+(?=,)/g,"")+")"}}}()}},Names:{camelCase:function(t){return t.replace(/-(\w)/g,function(t,e){return e.toUpperCase()})},SVGAttribute:function(t){var e="width|height|x|y|cx|cy|r|rx|ry|x1|x2|y1|y2";return(h||v.State.isAndroid&&!v.State.isChrome)&&(e+="|transform"),new RegExp("^("+e+")$","i").test(t)},prefixCheck:function(t){if(v.State.prefixMatches[t])return[v.State.prefixMatches[t],!0];for(var e=["","Webkit","Moz","ms","O"],n=0,r=e.length;r>n;n++){var i;if(i=0===n?t:e[n]+t.replace(/^\w/,function(t){return t.toUpperCase()}),d.isString(v.State.prefixElement.style[i]))return v.State.prefixMatches[t]=i,[i,!0]}return[t,!1]}},Values:{hexToRgb:function(t){var e;return t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,n,r){return e+e+n+n+r+r}),(e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t))?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:[0,0,0]},isCSSNullValue:function(t){return 0==t||/^(none|auto|transparent|(rgba\(0, ?0, ?0, ?0\)))$/i.test(t)},getUnitType:function(t){return/^(rotate|skew)/i.test(t)?"deg":/(^(scale|scaleX|scaleY|scaleZ|alpha|flexGrow|flexHeight|zIndex|fontWeight)$)|((opacity|red|green|blue|alpha)$)/i.test(t)?"":"px"},getDisplayType:function(t){var e=t&&t.tagName.toString().toLowerCase();return/^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|var|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i.test(e)?"inline":/^(li)$/i.test(e)?"list-item":/^(tr)$/i.test(e)?"table-row":/^(table)$/i.test(e)?"table":/^(tbody)$/i.test(e)?"table-row-group":"block"},addClass:function(t,e){t.classList?t.classList.add(e):t.className+=(t.className.length?" ":"")+e},removeClass:function(t,e){t.classList?t.classList.remove(e):t.className=t.className.toString().replace(new RegExp("(^|\\s)"+e.split(" ").join("|")+"(\\s|$)","gi")," ")}},getPropertyValue:function(t,n,i,a){function s(t,n){function i(){f&&w.setPropertyValue(t,"display","none")}var u=0;if(8>=h)u=l.css(t,n);else{var c,f=!1;if(/^(width|height)$/.test(n)&&0===w.getPropertyValue(t,"display")&&(f=!0,w.setPropertyValue(t,"display",w.Values.getDisplayType(t))),!a){if("height"===n&&"border-box"!==w.getPropertyValue(t,"boxSizing").toString().toLowerCase()){var d=t.offsetHeight-(parseFloat(w.getPropertyValue(t,"borderTopWidth"))||0)-(parseFloat(w.getPropertyValue(t,"borderBottomWidth"))||0)-(parseFloat(w.getPropertyValue(t,"paddingTop"))||0)-(parseFloat(w.getPropertyValue(t,"paddingBottom"))||0);return i(),d}if("width"===n&&"border-box"!==w.getPropertyValue(t,"boxSizing").toString().toLowerCase()){var p=t.offsetWidth-(parseFloat(w.getPropertyValue(t,"borderLeftWidth"))||0)-(parseFloat(w.getPropertyValue(t,"borderRightWidth"))||0)-(parseFloat(w.getPropertyValue(t,"paddingLeft"))||0)-(parseFloat(w.getPropertyValue(t,"paddingRight"))||0);return i(),p}}c=o(t)===r?e.getComputedStyle(t,null):o(t).computedStyle?o(t).computedStyle:o(t).computedStyle=e.getComputedStyle(t,null),"borderColor"===n&&(n="borderTopColor"),(""===(u=9===h&&"filter"===n?c.getPropertyValue(n):c[n])||null===u)&&(u=t.style[n]),i()}if("auto"===u&&/^(top|right|bottom|left)$/i.test(n)){var m=s(t,"position");("fixed"===m||"absolute"===m&&/top|left/i.test(n))&&(u=l(t).position()[n]+"px")}return u}var u;if(w.Hooks.registered[n]){var c=n,f=w.Hooks.getRoot(c);i===r&&(i=w.getPropertyValue(t,w.Names.prefixCheck(f)[0])),w.Normalizations.registered[f]&&(i=w.Normalizations.registered[f]("extract",t,i)),u=w.Hooks.extractValue(c,i)}else if(w.Normalizations.registered[n]){var d,p;"transform"!==(d=w.Normalizations.registered[n]("name",t))&&(p=s(t,w.Names.prefixCheck(d)[0]),w.Values.isCSSNullValue(p)&&w.Hooks.templates[n]&&(p=w.Hooks.templates[n][1])),u=w.Normalizations.registered[n]("extract",t,p)}if(!/^[\d-]/.test(u))if(o(t)&&o(t).isSVG&&w.Names.SVGAttribute(n))if(/^(height|width)$/i.test(n))try{u=t.getBBox()[n]}catch(t){u=0}else u=t.getAttribute(n);else u=s(t,w.Names.prefixCheck(n)[0]);return w.Values.isCSSNullValue(u)&&(u=0),v.debug>=2&&console.log("Get "+n+": "+u),u},setPropertyValue:function(t,n,r,i,a){var s=n;if("scroll"===n)a.container?a.container["scroll"+a.direction]=r:"Left"===a.direction?e.scrollTo(r,a.alternateValue):e.scrollTo(a.alternateValue,r);else if(w.Normalizations.registered[n]&&"transform"===w.Normalizations.registered[n]("name",t))w.Normalizations.registered[n]("inject",t,r),s="transform",r=o(t).transformCache[n];else{if(w.Hooks.registered[n]){var u=n,c=w.Hooks.getRoot(n);i=i||w.getPropertyValue(t,c),r=w.Hooks.injectValue(u,r,i),n=c}if(w.Normalizations.registered[n]&&(r=w.Normalizations.registered[n]("inject",t,r),n=w.Normalizations.registered[n]("name",t)),s=w.Names.prefixCheck(n)[0],8>=h)try{t.style[s]=r}catch(t){v.debug&&console.log("Browser does not support ["+r+"] for ["+s+"]")}else o(t)&&o(t).isSVG&&w.Names.SVGAttribute(n)?t.setAttribute(n,r):t.style[s]=r;v.debug>=2&&console.log("Set "+n+" ("+s+"): "+r)}return[s,r]},flushTransformCache:function(t){function e(e){return parseFloat(w.getPropertyValue(t,e))}var n="";if((h||v.State.isAndroid&&!v.State.isChrome)&&o(t).isSVG){var r={translate:[e("translateX"),e("translateY")],skewX:[e("skewX")],skewY:[e("skewY")],scale:1!==e("scale")?[e("scale"),e("scale")]:[e("scaleX"),e("scaleY")],rotate:[e("rotateZ"),0,0]};l.each(o(t).transformCache,function(t){/^translate/i.test(t)?t="translate":/^scale/i.test(t)?t="scale":/^rotate/i.test(t)&&(t="rotate"),r[t]&&(n+=t+"("+r[t].join(" ")+") ",delete r[t])})}else{var i,a;l.each(o(t).transformCache,function(e){return i=o(t).transformCache[e],"transformPerspective"===e?(a=i,!0):(9===h&&"rotateZ"===e&&(e="rotate"),void(n+=e+i+" "))}),a&&(n="perspective"+a+" "+n)}w.setPropertyValue(t,"transform",n)}};w.Hooks.register(),w.Normalizations.register(),v.hook=function(t,e,n){var a=r;return t=i(t),l.each(t,function(t,i){if(o(i)===r&&v.init(i),n===r)a===r&&(a=v.CSS.getPropertyValue(i,e));else{var s=v.CSS.setPropertyValue(i,e,n);"transform"===s[0]&&v.CSS.flushTransformCache(i),a=s}}),a};var b=function(){function t(){return h?A.promise||null:f}function a(){function t(t){function f(t,e){var n=r,i=r,o=r;return d.isArray(t)?(n=t[0],!d.isArray(t[1])&&/^[\d-]/.test(t[1])||d.isFunction(t[1])||w.RegEx.isHex.test(t[1])?o=t[1]:(d.isString(t[1])&&!w.RegEx.isHex.test(t[1])||d.isArray(t[1]))&&(i=e?t[1]:s(t[1],c.duration),t[2]!==r&&(o=t[2]))):n=t,e||(i=i||c.easing),d.isFunction(n)&&(n=n.call(a,E,M)),d.isFunction(o)&&(o=o.call(a,E,M)),[n||0,i,o]}function p(t,e){var n,r;return r=(e||"0").toString().toLowerCase().replace(/[%A-z]+$/,function(t){return n=t,""}),n||(n=w.Values.getUnitType(t)),[r,n]}function m(){var t={myParent:a.parentNode||n.body,position:w.getPropertyValue(a,"position"),fontSize:w.getPropertyValue(a,"fontSize")},r=t.position===P.lastPosition&&t.myParent===P.lastParent,i=t.fontSize===P.lastFontSize;P.lastParent=t.myParent,P.lastPosition=t.position,P.lastFontSize=t.fontSize;var s=100,u={};if(i&&r)u.emToPx=P.lastEmToPx,u.percentToPxWidth=P.lastPercentToPxWidth,u.percentToPxHeight=P.lastPercentToPxHeight;else{var c=o(a).isSVG?n.createElementNS("http://www.w3.org/2000/svg","rect"):n.createElement("div");v.init(c),t.myParent.appendChild(c),l.each(["overflow","overflowX","overflowY"],function(t,e){v.CSS.setPropertyValue(c,e,"hidden")}),v.CSS.setPropertyValue(c,"position",t.position),v.CSS.setPropertyValue(c,"fontSize",t.fontSize),v.CSS.setPropertyValue(c,"boxSizing","content-box"),l.each(["minWidth","maxWidth","width","minHeight","maxHeight","height"],function(t,e){v.CSS.setPropertyValue(c,e,s+"%")}),v.CSS.setPropertyValue(c,"paddingLeft",s+"em"),u.percentToPxWidth=P.lastPercentToPxWidth=(parseFloat(w.getPropertyValue(c,"width",null,!0))||1)/s,u.percentToPxHeight=P.lastPercentToPxHeight=(parseFloat(w.getPropertyValue(c,"height",null,!0))||1)/s,u.emToPx=P.lastEmToPx=(parseFloat(w.getPropertyValue(c,"paddingLeft"))||1)/s,t.myParent.removeChild(c)}return null===P.remToPx&&(P.remToPx=parseFloat(w.getPropertyValue(n.body,"fontSize"))||16),null===P.vwToPx&&(P.vwToPx=parseFloat(e.innerWidth)/100,P.vhToPx=parseFloat(e.innerHeight)/100),u.remToPx=P.remToPx,u.vwToPx=P.vwToPx,u.vhToPx=P.vhToPx,v.debug>=1&&console.log("Unit ratios: "+JSON.stringify(u),a),u}if(c.begin&&0===E)try{c.begin.call(g,g)}catch(t){setTimeout(function(){throw t},1)}if("scroll"===T){var b,_,S,k=/^x$/i.test(c.axis)?"Left":"Top",C=parseFloat(c.offset)||0;c.container?d.isWrapped(c.container)||d.isNode(c.container)?(c.container=c.container[0]||c.container,S=(b=c.container["scroll"+k])+l(a).position()[k.toLowerCase()]+C):c.container=null:(b=v.State.scrollAnchor[v.State["scrollProperty"+k]],_=v.State.scrollAnchor[v.State["scrollProperty"+("Left"===k?"Top":"Left")]],S=l(a).offset()[k.toLowerCase()]+C),h={scroll:{rootPropertyValue:!1,startValue:b,currentValue:b,endValue:S,unitType:"",easing:c.easing,scrollData:{container:c.container,direction:k,alternateValue:_}},element:a},v.debug&&console.log("tweensContainer (scroll): ",h.scroll,a)}else if("reverse"===T){if(!o(a).tweensContainer)return void l.dequeue(a,c.queue);"none"===o(a).opts.display&&(o(a).opts.display="auto"),"hidden"===o(a).opts.visibility&&(o(a).opts.visibility="visible"),o(a).opts.loop=!1,o(a).opts.begin=null,o(a).opts.complete=null,x.easing||delete c.easing,x.duration||delete c.duration,c=l.extend({},o(a).opts,c);var R=l.extend(!0,{},o(a).tweensContainer);for(var D in R)if("element"!==D){var L=R[D].startValue;R[D].startValue=R[D].currentValue=R[D].endValue,R[D].endValue=L,d.isEmptyObject(x)||(R[D].easing=c.easing),v.debug&&console.log("reverse tweensContainer ("+D+"): "+JSON.stringify(R[D]),a)}h=R}else if("start"===T){for(var O in o(a).tweensContainer&&!0===o(a).isAnimating&&(R=o(a).tweensContainer),l.each(y,function(t,e){if(RegExp("^"+w.Lists.colors.join("$|^")+"$").test(t)){var n=f(e,!0),i=n[0],o=n[1],a=n[2];if(w.RegEx.isHex.test(i)){for(var s=["Red","Green","Blue"],u=w.Values.hexToRgb(i),c=a?w.Values.hexToRgb(a):r,l=0;l<s.length;l++){var h=[u[l]];o&&h.push(o),c!==r&&h.push(c[l]),y[t+s[l]]=h}delete y[t]}}}),y){var N=f(y[O]),F=N[0],j=N[1],z=N[2];O=w.Names.camelCase(O);var U=w.Hooks.getRoot(O),V=!1;if(o(a).isSVG||"tween"===U||!1!==w.Names.prefixCheck(U)[1]||w.Normalizations.registered[U]!==r){(c.display!==r&&null!==c.display&&"none"!==c.display||c.visibility!==r&&"hidden"!==c.visibility)&&/opacity|filter/.test(O)&&!z&&0!==F&&(z=0),c._cacheValues&&R&&R[O]?(z===r&&(z=R[O].endValue+R[O].unitType),V=o(a).rootPropertyValueCache[U]):w.Hooks.registered[O]?z===r?(V=w.getPropertyValue(a,U),z=w.getPropertyValue(a,O,V)):V=w.Hooks.templates[U][1]:z===r&&(z=w.getPropertyValue(a,O));var B,H,q,G=!1;if(z=(B=p(O,z))[0],q=B[1],F=(B=p(O,F))[0].replace(/^([+-\/*])=/,function(t,e){return G=e,""}),H=B[1],z=parseFloat(z)||0,F=parseFloat(F)||0,"%"===H&&(/^(fontSize|lineHeight)$/.test(O)?(F/=100,H="em"):/^scale/.test(O)?(F/=100,H=""):/(Red|Green|Blue)$/i.test(O)&&(F=F/100*255,H="")),/[\/*]/.test(G))H=q;else if(q!==H&&0!==z)if(0===F)H=q;else{i=i||m();var W=/margin|padding|left|right|width|text|word|letter/i.test(O)||/X$/.test(O)||"x"===O?"x":"y";switch(q){case"%":z*="x"===W?i.percentToPxWidth:i.percentToPxHeight;break;case"px":break;default:z*=i[q+"ToPx"]}switch(H){case"%":z*=1/("x"===W?i.percentToPxWidth:i.percentToPxHeight);break;case"px":break;default:z*=1/i[H+"ToPx"]}}switch(G){case"+":F=z+F;break;case"-":F=z-F;break;case"*":F*=z;break;case"/":F=z/F}h[O]={rootPropertyValue:V,startValue:z,currentValue:z,endValue:F,unitType:H,easing:j},v.debug&&console.log("tweensContainer ("+O+"): "+JSON.stringify(h[O]),a)}else v.debug&&console.log("Skipping ["+U+"] due to a lack of browser support.")}h.element=a}h.element&&(w.Values.addClass(a,"velocity-animating"),I.push(h),""===c.queue&&(o(a).tweensContainer=h,o(a).opts=c),o(a).isAnimating=!0,E===M-1?(v.State.calls.push([I,g,c,null,A.resolver]),!1===v.State.isTicking&&(v.State.isTicking=!0,u())):E++)}var i,a=this,c=l.extend({},v.defaults,x),h={};switch(o(a)===r&&v.init(a),parseFloat(c.delay)&&!1!==c.queue&&l.queue(a,c.queue,function(t){v.velocityQueueEntryFlag=!0,o(a).delayTimer={setTimeout:setTimeout(t,parseFloat(c.delay)),next:t}}),c.duration.toString().toLowerCase()){case"fast":c.duration=200;break;case"normal":c.duration=m;break;case"slow":c.duration=600;break;default:c.duration=parseFloat(c.duration)||1}!1!==v.mock&&(!0===v.mock?c.duration=c.delay=1:(c.duration*=parseFloat(v.mock)||1,c.delay*=parseFloat(v.mock)||1)),c.easing=s(c.easing,c.duration),c.begin&&!d.isFunction(c.begin)&&(c.begin=null),c.progress&&!d.isFunction(c.progress)&&(c.progress=null),c.complete&&!d.isFunction(c.complete)&&(c.complete=null),c.display!==r&&null!==c.display&&(c.display=c.display.toString().toLowerCase(),"auto"===c.display&&(c.display=v.CSS.Values.getDisplayType(a))),c.visibility!==r&&null!==c.visibility&&(c.visibility=c.visibility.toString().toLowerCase()),c.mobileHA=c.mobileHA&&v.State.isMobile&&!v.State.isGingerbread,!1===c.queue?c.delay?setTimeout(t,c.delay):t():l.queue(a,c.queue,function(e,n){return!0===n?(A.promise&&A.resolver(g),!0):(v.velocityQueueEntryFlag=!0,void t())}),""!==c.queue&&"fx"!==c.queue||"inprogress"===l.queue(a)[0]||l.dequeue(a)}var h,f,p,g,y,x,_=arguments[0]&&(arguments[0].p||l.isPlainObject(arguments[0].properties)&&!arguments[0].properties.names||d.isString(arguments[0].properties));if(d.isWrapped(this)?(h=!1,p=0,g=this,f=this):(h=!0,p=1,g=_?arguments[0].elements||arguments[0].e:arguments[0]),g=i(g)){_?(y=arguments[0].properties||arguments[0].p,x=arguments[0].options||arguments[0].o):(y=arguments[p],x=arguments[p+1]);var M=g.length,E=0;if(!/^(stop|finish)$/i.test(y)&&!l.isPlainObject(x)){x={};for(var S=p+1;S<arguments.length;S++)d.isArray(arguments[S])||!/^(fast|normal|slow)$/i.test(arguments[S])&&!/^\d/.test(arguments[S])?d.isString(arguments[S])||d.isArray(arguments[S])?x.easing=arguments[S]:d.isFunction(arguments[S])&&(x.complete=arguments[S]):x.duration=arguments[S]}var T,A={promise:null,resolver:null,rejecter:null};switch(h&&v.Promise&&(A.promise=new v.Promise(function(t,e){A.resolver=t,A.rejecter=e})),y){case"scroll":T="scroll";break;case"reverse":T="reverse";break;case"finish":case"stop":l.each(g,function(t,e){o(e)&&o(e).delayTimer&&(clearTimeout(o(e).delayTimer.setTimeout),o(e).delayTimer.next&&o(e).delayTimer.next(),delete o(e).delayTimer)});var k=[];return l.each(v.State.calls,function(t,e){e&&l.each(e[1],function(n,i){var a=x===r?"":x;return!0!==a&&e[2].queue!==a&&(x!==r||!1!==e[2].queue)||void l.each(g,function(n,r){r===i&&((!0===x||d.isString(x))&&(l.each(l.queue(r,d.isString(x)?x:""),function(t,e){d.isFunction(e)&&e(null,!0)}),l.queue(r,d.isString(x)?x:"",[])),"stop"===y?(o(r)&&o(r).tweensContainer&&!1!==a&&l.each(o(r).tweensContainer,function(t,e){e.endValue=e.currentValue}),k.push(t)):"finish"===y&&(e[2].duration=1))})})}),"stop"===y&&(l.each(k,function(t,e){c(e,!0)}),A.promise&&A.resolver(g)),t();default:if(!l.isPlainObject(y)||d.isEmptyObject(y)){if(d.isString(y)&&v.Redirects[y]){var C=(O=l.extend({},x)).duration,R=O.delay||0;return!0===O.backwards&&(g=l.extend(!0,[],g).reverse()),l.each(g,function(t,e){parseFloat(O.stagger)?O.delay=R+parseFloat(O.stagger)*t:d.isFunction(O.stagger)&&(O.delay=R+O.stagger.call(e,t,M)),O.drag&&(O.duration=parseFloat(C)||(/^(callout|transition)/.test(y)?1e3:m),O.duration=Math.max(O.duration*(O.backwards?1-t/M:(t+1)/M),.75*O.duration,200)),v.Redirects[y].call(e,e,O||{},t,M,g,A.promise?A:r)}),t()}var D="Velocity: First argument ("+y+") was not a property map, a known action, or a registered redirect. Aborting.";return A.promise?A.rejecter(new Error(D)):console.log(D),t()}T="start"}var L,O,P={lastParent:null,lastPosition:null,lastFontSize:null,lastPercentToPxWidth:null,lastPercentToPxHeight:null,lastEmToPx:null,remToPx:null,vwToPx:null,vhToPx:null},I=[];if(l.each(g,function(t,e){d.isNode(e)&&a.call(e)}),(O=l.extend({},v.defaults,x)).loop=parseInt(O.loop),L=2*O.loop-1,O.loop)for(var N=0;L>N;N++){var F={delay:O.delay,progress:O.progress};N===L-1&&(F.display=O.display,F.visibility=O.visibility,F.complete=O.complete),b(g,"reverse",F)}return t()}};(v=l.extend(b,v)).animate=b;var x=e.requestAnimationFrame||f;return v.State.isMobile||n.hidden===r||n.addEventListener("visibilitychange",function(){n.hidden?(x=function(t){return setTimeout(function(){t(!0)},16)},u()):x=e.requestAnimationFrame||f}),t.Velocity=v,t!==e&&(t.fn.velocity=b,t.fn.velocity.defaults=v.defaults),l.each(["Down","Up"],function(t,e){v.Redirects["slide"+e]=function(t,n,i,o,a,s){var u=l.extend({},n),c=u.begin,h=u.complete,f={height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:""},d={};u.display===r&&(u.display="Down"===e?"inline"===v.CSS.Values.getDisplayType(t)?"inline-block":"block":"none"),u.begin=function(){for(var n in c&&c.call(a,a),f){d[n]=t.style[n];var r=v.CSS.getPropertyValue(t,n);f[n]="Down"===e?[r,0]:[0,r]}d.overflow=t.style.overflow,t.style.overflow="hidden"},u.complete=function(){for(var e in d)t.style[e]=d[e];h&&h.call(a,a),s&&s.resolver(a)},v(t,f,u)}}),l.each(["In","Out"],function(t,e){v.Redirects["fade"+e]=function(t,n,i,o,a,s){var u=l.extend({},n),c={opacity:"In"===e?1:0},h=u.complete;u.complete=i!==o-1?u.begin=null:function(){h&&h.call(a,a),s&&s.resolver(a)},u.display===r&&(u.display="In"===e?"auto":"none"),v(this,c,u)}}),v}jQuery.fn.velocity=jQuery.fn.animate}(window.jQuery||window.Zepto||window,window,document)})),function(t,e,n,r){"use strict";function i(t,e,n){return setTimeout(l(t,n),e)}function o(t,e,n){return!!Array.isArray(t)&&(a(t,n[e],n),!0)}function a(t,e,n){var i;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==r)for(i=0;i<t.length;)e.call(n,t[i],i,t),i++;else for(i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i,t)}function s(t,e,n){for(var i=Object.keys(e),o=0;o<i.length;)(!n||n&&t[i[o]]===r)&&(t[i[o]]=e[i[o]]),o++;return t}function u(t,e){return s(t,e,!0)}function c(t,e,n){var r,i=e.prototype;(r=t.prototype=Object.create(i)).constructor=t,r._super=i,n&&s(r,n)}function l(t,e){return function(){return t.apply(e,arguments)}}function h(t,e){return typeof t==K?t.apply(e&&e[0]||r,e):t}function f(t,e){return t===r?e:t}function d(t,e,n){a(v(e),function(e){t.addEventListener(e,n,!1)})}function p(t,e,n){a(v(e),function(e){t.removeEventListener(e,n,!1)})}function m(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function g(t,e){return t.indexOf(e)>-1}function v(t){return t.trim().split(/\s+/g)}function y(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function w(t){return Array.prototype.slice.call(t,0)}function b(t,e,n){for(var r=[],i=[],o=0;o<t.length;){var a=e?t[o][e]:t[o];y(i,a)<0&&r.push(t[o]),i[o]=a,o++}return n&&(r=e?r.sort(function(t,n){return t[e]>n[e]}):r.sort()),r}function x(t,e){for(var n,i,o=e[0].toUpperCase()+e.slice(1),a=0;a<J.length;){if((i=(n=J[a])?n+o:e)in t)return i;a++}return r}function _(t){var e=t.ownerDocument;return e.defaultView||e.parentWindow}function M(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){h(t.options.enable,[t])&&n.handler(e)},this.init()}function E(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,o=e&lt&&0==r-i,a=e&(ht|ft)&&0==r-i;n.isFirst=!!o,n.isFinal=!!a,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=T(e)),i>1&&!n.firstMultiple?n.firstMultiple=T(e):1===i&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,s=a?a.center:o.center,u=e.center=A(r);e.timeStamp=nt(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=R(s,u),e.distance=C(s,u),function(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};(e.eventType===lt||o.eventType===ht)&&(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}(n,e),e.offsetDirection=k(e.deltaX,e.deltaY),e.scale=a?function(t,e){return C(r[0],r[1],_t)/C(t[0],t[1],_t)}(a.pointers):1,e.rotation=a?function(t,e){return R(r[1],r[0],_t)-R(t[1],t[0],_t)}(a.pointers):0,S(n,e);var c=t.element;m(e.srcEvent.target,c)&&(c=e.srcEvent.target),e.target=c}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function S(t,e){var n,i,o,a,s=t.lastInterval||e,u=e.timeStamp-s.timeStamp;if(e.eventType!=ft&&(u>ct||s.velocity===r)){var c=s.deltaX-e.deltaX,l=s.deltaY-e.deltaY,h={x:c/u||0,y:l/u||0};i=h.x,o=h.y,n=et(h.x)>et(h.y)?h.x:h.y,a=k(c,l),t.lastInterval=e}else n=s.velocity,i=s.velocityX,o=s.velocityY,a=s.direction;e.velocity=n,e.velocityX=i,e.velocityY=o,e.direction=a}function T(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:tt(t.pointers[n].clientX),clientY:tt(t.pointers[n].clientY)},n++;return{timeStamp:nt(),pointers:e,center:A(e),deltaX:t.deltaX,deltaY:t.deltaY}}function A(t){var e=t.length;if(1===e)return{x:tt(t[0].clientX),y:tt(t[0].clientY)};for(var n=0,r=0,i=0;e>i;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:tt(n/e),y:tt(r/e)}}function k(t,e){return t===e?dt:et(t)>=et(e)?t>0?pt:mt:e>0?gt:vt}function C(t,e,n){n||(n=xt);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function R(t,e,n){return n||(n=xt),180*Math.atan2(e[n[1]]-t[n[1]],e[n[0]]-t[n[0]])/Math.PI}function D(){this.evEl=Et,this.evWin=St,this.allow=!0,this.pressed=!1,M.apply(this,arguments)}function L(){this.evEl=kt,this.evWin=Ct,M.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function O(){this.evTarget=Dt,this.evWin=Lt,this.started=!1,M.apply(this,arguments)}function P(){this.evTarget=Pt,this.targetIds={},M.apply(this,arguments)}function I(){M.apply(this,arguments);var t=l(this.handler,this);this.touch=new P(this.manager,t),this.mouse=new D(this.manager,t)}function N(t,e){this.manager=t,this.set(e)}function F(t){this.id=rt++,this.manager=null,this.options=u(t||{},this.defaults),this.options.enable=f(this.options.enable,!0),this.state=Bt,this.simultaneous={},this.requireFail=[]}function j(t){return t==vt?"down":t==gt?"up":t==pt?"left":t==mt?"right":""}function z(t,e){var n=e.manager;return n?n.get(t):t}function U(){F.apply(this,arguments)}function V(){U.apply(this,arguments),this.pX=null,this.pY=null}function B(){U.apply(this,arguments)}function H(){F.apply(this,arguments),this._timer=null,this._input=null}function q(){U.apply(this,arguments)}function G(){U.apply(this,arguments)}function W(){F.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Y(t,e){return(e=e||{}).recognizers=f(e.recognizers,Y.defaults.preset),new X(t,e)}function X(t,e){this.options=u(e=e||{},Y.defaults),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.element=t,this.input=function(t){return new(t.options.inputClass||(ot?L:at?P:it?I:D))(t,E)}(this),this.touchAction=new N(this,this.options.touchAction),$(this,!0),a(e.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function $(t,e){var n=t.element;a(t.options.cssProps,function(t,r){n.style[x(n.style,r)]=e?t:""})}function Q(t,n){var r=e.createEvent("Event");r.initEvent(t,!0,!0),r.gesture=n,n.target.dispatchEvent(r)}var J=["","webkit","moz","MS","ms","o"],Z=e.createElement("div"),K="function",tt=Math.round,et=Math.abs,nt=Date.now,rt=1,it="ontouchstart"in t,ot=x(t,"PointerEvent")!==r,at=it&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),st="touch",ut="mouse",ct=25,lt=1,ht=4,ft=8,dt=1,pt=2,mt=4,gt=8,vt=16,yt=pt|mt,wt=gt|vt,bt=yt|wt,xt=["x","y"],_t=["clientX","clientY"];M.prototype={handler:function(){},init:function(){this.evEl&&d(this.element,this.evEl,this.domHandler),this.evTarget&&d(this.target,this.evTarget,this.domHandler),this.evWin&&d(_(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&p(this.element,this.evEl,this.domHandler),this.evTarget&&p(this.target,this.evTarget,this.domHandler),this.evWin&&p(_(this.element),this.evWin,this.domHandler)}};var Mt={mousedown:lt,mousemove:2,mouseup:ht},Et="mousedown",St="mousemove mouseup";c(D,M,{handler:function(t){var e=Mt[t.type];e&lt&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=ht),this.pressed&&this.allow&&(e&ht&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:ut,srcEvent:t}))}});var Tt={pointerdown:lt,pointermove:2,pointerup:ht,pointercancel:ft,pointerout:ft},At={2:st,3:"pen",4:ut,5:"kinect"},kt="pointerdown",Ct="pointermove pointerup pointercancel";t.MSPointerEvent&&(kt="MSPointerDown",Ct="MSPointerMove MSPointerUp MSPointerCancel"),c(L,M,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=Tt[r],o=At[t.pointerType]||t.pointerType,a=o==st,s=y(e,t.pointerId,"pointerId");i&lt&&(0===t.button||a)?0>s&&(e.push(t),s=e.length-1):i&(ht|ft)&&(n=!0),0>s||(e[s]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(s,1))}});var Rt={touchstart:lt,touchmove:2,touchend:ht,touchcancel:ft},Dt="touchstart",Lt="touchstart touchmove touchend touchcancel";c(O,M,{handler:function(t){var e=Rt[t.type];if(e===lt&&(this.started=!0),this.started){var n=(function(t,e){var n=w(t.touches),r=w(t.changedTouches);return e&(ht|ft)&&(n=b(n.concat(r),"identifier",!0)),[n,r]}).call(this,t,e);e&(ht|ft)&&0==n[0].length-n[1].length&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:st,srcEvent:t})}}});var Ot={touchstart:lt,touchmove:2,touchend:ht,touchcancel:ft},Pt="touchstart touchmove touchend touchcancel";c(P,M,{handler:function(t){var e=Ot[t.type],n=(function(t,e){var n=w(t.touches),r=this.targetIds;if(e&(2|lt)&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,a=w(t.changedTouches),s=[],u=this.target;if(o=n.filter(function(t){return m(t.target,u)}),e===lt)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<a.length;)r[a[i].identifier]&&s.push(a[i]),e&(ht|ft)&&delete r[a[i].identifier],i++;return s.length?[b(o.concat(s),"identifier",!0),s]:void 0}).call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:st,srcEvent:t})}}),c(I,M,{handler:function(t,e,n){var r=n.pointerType==ut;if(n.pointerType==st)this.mouse.allow=!1;else if(r&&!this.mouse.allow)return;e&(ht|ft)&&(this.mouse.allow=!0),this.callback(t,e,n)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var It=x(Z.style,"touchAction"),Nt=It!==r,Ft="compute",jt="manipulation",zt="none",Ut="pan-x",Vt="pan-y";N.prototype={set:function(t){t==Ft&&(t=this.compute()),Nt&&(this.manager.element.style[It]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return a(this.manager.recognizers,function(e){h(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),function(t){if(g(t,zt))return zt;var e=g(t,Ut),n=g(t,Vt);return e&&n?Ut+" "+Vt:e||n?e?Ut:Vt:g(t,jt)?jt:"auto"}(t.join(" "))},preventDefaults:function(t){if(!Nt){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)return void e.preventDefault();var r=this.actions,i=g(r,zt),o=g(r,Vt),a=g(r,Ut);return i||o&&n&yt||a&&n&wt?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Bt=1,Ht=2,qt=4,Gt=8,Wt=Gt,Yt=16;F.prototype={defaults:{},set:function(t){return s(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(o(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=z(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return o(t,"dropRecognizeWith",this)?this:(t=z(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(o(t,"requireFailure",this))return this;var e=this.requireFail;return-1===y(e,t=z(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(o(t,"dropRequireFailure",this))return this;t=z(t,this);var e=y(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){function e(e){n.manager.emit(n.options.event+(e?r&Yt?"cancel":r&Gt?"end":r&qt?"move":r&Ht?"start":"":""),t)}var n=this,r=this.state;Gt>r&&e(!0),e(),r>=Gt&&e(!0)},tryEmit:function(t){return this.canEmit()?this.emit(t):void(this.state=32)},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(32|Bt)))return!1;t++}return!0},recognize:function(t){var e=s({},t);return h(this.options.enable,[this,e])?(this.state&(Wt|Yt|32)&&(this.state=Bt),this.state=this.process(e),void(this.state&(Ht|qt|Gt|Yt)&&this.tryEmit(e))):(this.reset(),void(this.state=32))},process:function(){},getTouchAction:function(){},reset:function(){}},c(U,F,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=e&(Ht|qt),i=this.attrTest(t);return r&&(n&ft||!i)?e|Yt:r||i?n&ht?e|Gt:e&Ht?e|qt:Ht:32}}),c(V,U,{defaults:{event:"pan",threshold:10,pointers:1,direction:bt},getTouchAction:function(){var t=this.options.direction,e=[];return t&yt&&e.push(Vt),t&wt&&e.push(Ut),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,a=t.deltaY;return i&e.direction||(e.direction&yt?(i=0===o?dt:0>o?pt:mt,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===a?dt:0>a?gt:vt,n=a!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return U.prototype.attrTest.call(this,t)&&(this.state&Ht||!(this.state&Ht)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=j(t.direction);e&&this.manager.emit(this.options.event+e,t),this._super.emit.call(this,t)}}),c(B,U,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[zt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&Ht)},emit:function(t){this._super.emit.call(this,t),1!==t.scale&&this.manager.emit(this.options.event+(t.scale<1?"in":"out"),t)}}),c(H,F,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return["auto"]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,o=t.deltaTime>e.time;if(this._input=t,!r||!n||t.eventType&(ht|ft)&&!o)this.reset();else if(t.eventType&lt)this.reset(),this._timer=i(function(){this.state=Wt,this.tryEmit()},e.time,this);else if(t.eventType&ht)return Wt;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===Wt&&(t&&t.eventType&ht?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=nt(),this.manager.emit(this.options.event,this._input)))}}),c(q,U,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[zt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&Ht)}}),c(G,U,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:yt|wt,pointers:1},getTouchAction:function(){return V.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&(yt|wt)?e=t.velocity:n&yt?e=t.velocityX:n&wt&&(e=t.velocityY),this._super.attrTest.call(this,t)&&n&t.direction&&t.distance>this.options.threshold&&et(e)>this.options.velocity&&t.eventType&ht},emit:function(t){var e=j(t.direction);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),c(W,F,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[jt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,o=t.deltaTime<e.time;if(this.reset(),t.eventType&lt&&0===this.count)return this.failTimeout();if(r&&o&&n){if(t.eventType!=ht)return this.failTimeout();var a=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||C(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,s&&a?this.count+=1:this.count=1,this._input=t,0==this.count%e.taps)return this.hasRequireFailures()?(this._timer=i(function(){this.state=Wt,this.tryEmit()},e.interval,this),Ht):Wt}return 32},failTimeout:function(){return this._timer=i(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Wt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Y.VERSION="2.0.4",Y.defaults={domEvents:!1,touchAction:Ft,enable:!0,inputTarget:null,inputClass:null,preset:[[q,{enable:!1}],[B,{enable:!1},["rotate"]],[G,{direction:yt}],[V,{direction:yt},["swipe"]],[W],[W,{event:"doubletap",taps:2},["tap"]],[H]],cssProps:{userSelect:"default",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},X.prototype={set:function(t){return s(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var n,r=this.recognizers,i=e.curRecognizer;(!i||i&&i.state&Wt)&&(i=e.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===e.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&n.state&(Ht|qt|Gt)&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof F)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(o(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(o(t,"remove",this))return this;var e=this.recognizers;return t=this.get(t),e.splice(y(e,t),1),this.touchAction.update(),this},on:function(t,e){var n=this.handlers;return a(v(t),function(t){n[t]=n[t]||[],n[t].push(e)}),this},off:function(t,e){var n=this.handlers;return a(v(t),function(t){e?n[t].splice(y(n[t],e),1):delete n[t]}),this},emit:function(t,e){this.options.domEvents&&Q(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},destroy:function(){this.element&&$(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},s(Y,{INPUT_START:lt,INPUT_MOVE:2,INPUT_END:ht,INPUT_CANCEL:ft,STATE_POSSIBLE:Bt,STATE_BEGAN:Ht,STATE_CHANGED:qt,STATE_ENDED:Gt,STATE_RECOGNIZED:Wt,STATE_CANCELLED:Yt,STATE_FAILED:32,DIRECTION_NONE:dt,DIRECTION_LEFT:pt,DIRECTION_RIGHT:mt,DIRECTION_UP:gt,DIRECTION_DOWN:vt,DIRECTION_HORIZONTAL:yt,DIRECTION_VERTICAL:wt,DIRECTION_ALL:bt,Manager:X,Input:M,TouchAction:N,TouchInput:P,MouseInput:D,PointerEventInput:L,TouchMouseInput:I,SingleTouchInput:O,Recognizer:F,AttrRecognizer:U,Tap:W,Pan:V,Swipe:G,Pinch:B,Rotate:q,Press:H,on:d,off:p,each:a,merge:u,extend:s,inherit:c,bindFn:l,prefixed:x}),typeof define==K&&define.amd?define(function(){return Y}):"undefined"!=typeof module&&module.exports?module.exports=Y:t.Hammer=Y}(window,document),function(t){"function"==typeof define&&define.amd?define(["jquery","hammerjs"],t):"object"==typeof exports?t(require("jquery"),require("hammerjs")):t(jQuery,Hammer)}(function(t,e){var n;t.fn.hammer=function(n){return this.each(function(){!function(n,r){var i=t(n);i.data("hammer")||i.data("hammer",new e(i[0],r))}(this,n)})},e.Manager.prototype.emit=(n=e.Manager.prototype.emit,function(e,r){n.call(this,e,r),t(this.element).trigger({type:e,gesture:r})})}),function(t){t.Package?Materialize={}:t.Materialize={}}(window),"undefined"==typeof exports||exports.nodeType||("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=Materialize),exports.default=Materialize),function(t){for(var e=0,n=["webkit","moz"],r=t.requestAnimationFrame,i=t.cancelAnimationFrame,o=n.length;--o>=0&&!r;)r=t[n[o]+"RequestAnimationFrame"],i=t[n[o]+"CancelRequestAnimationFrame"];r&&i||(r=function(t){var n=+Date.now(),r=Math.max(e+16,n);return setTimeout(function(){t(e=r)},r-n)},i=clearTimeout),t.requestAnimationFrame=r,t.cancelAnimationFrame=i}(window),Materialize.objectSelectorString=function(t){return((t.prop("tagName")||"")+(t.attr("id")||"")+(t.attr("class")||"")).replace(/\s/g,"")},Materialize.guid=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return function(){return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}}(),Materialize.escapeHash=function(t){return t.replace(/(:|\.|\[|\]|,|=)/g,"\\$1")},Materialize.elementOrParentIsFixed=function(t){var e=$(t),n=!1;return e.add(e.parents()).each(function(){if("fixed"===$(this).css("position"))return n=!0,!1}),n};var getTime=Date.now||function(){return(new Date).getTime()},Vel;Materialize.throttle=function(t,e,n){var r,i,o,a=null,s=0;n||(n={});var u=function(){s=!1===n.leading?0:getTime(),a=null,o=t.apply(r,i),r=i=null};return function(){var c=getTime();s||!1!==n.leading||(s=c);var l=e-(c-s);return r=this,i=arguments,l<=0?(clearTimeout(a),a=null,s=c,o=t.apply(r,i),r=i=null):a||!1===n.trailing||(a=setTimeout(u,l)),o}},Vel=jQuery?jQuery.Velocity:$?$.Velocity:Velocity,Materialize.Vel=Vel||Velocity,function(t){t.fn.collapsible=function(e,n){var r=e;return e=t.extend({accordion:void 0,onOpen:void 0,onClose:void 0},e),this.each(function(){var i=t(this),o=t(this).find("> li > .collapsible-header"),a=i.data("collapsible");function s(n,r){r||n.toggleClass("active"),e.accordion||"accordion"===a||void 0===a?function(e){o=i.find("> li > .collapsible-header"),e.hasClass("active")?e.parent().addClass("active"):e.parent().removeClass("active"),e.parent().hasClass("active")?e.siblings(".collapsible-body").stop(!0,!1).slideDown({duration:350,easing:"easeOutQuart",queue:!1,complete:function(){t(this).css("height","")}}):e.siblings(".collapsible-body").stop(!0,!1).slideUp({duration:350,easing:"easeOutQuart",queue:!1,complete:function(){t(this).css("height","")}}),o.not(e).removeClass("active").parent().removeClass("active"),o.not(e).parent().children(".collapsible-body").stop(!0,!1).each(function(){t(this).is(":visible")&&t(this).slideUp({duration:350,easing:"easeOutQuart",queue:!1,complete:function(){t(this).css("height",""),u(t(this).siblings(".collapsible-header"))}})})}(n):function(e){e.hasClass("active")?e.parent().addClass("active"):e.parent().removeClass("active"),e.parent().hasClass("active")?e.siblings(".collapsible-body").stop(!0,!1).slideDown({duration:350,easing:"easeOutQuart",queue:!1,complete:function(){t(this).css("height","")}}):e.siblings(".collapsible-body").stop(!0,!1).slideUp({duration:350,easing:"easeOutQuart",queue:!1,complete:function(){t(this).css("height","")}})}(n),u(n)}function u(t){t.hasClass("active")?"function"==typeof e.onOpen&&e.onOpen.call(this,t.parent()):"function"==typeof e.onClose&&e.onClose.call(this,t.parent())}function c(t){return t.closest("li > .collapsible-header")}function l(){i.off("click.collapse","> li > .collapsible-header")}if("destroy"!==r)if(n>=0&&n<o.length){var h=o.eq(n);h.length&&("open"===r||"close"===r&&h.hasClass("active"))&&s(h)}else l(),i.on("click.collapse","> li > .collapsible-header",function(e){var n=t(e.target);c(n).length>0&&(n=c(n)),s(n)}),e.accordion||"accordion"===a||void 0===a?s(o.filter(".active").first(),!0):o.filter(".active").each(function(){s(t(this),!0)});else l()})},t(document).ready(function(){t(".collapsible").collapsible()})}(jQuery),function(t){t.fn.scrollTo=function(e){return t(this).scrollTop(t(this).scrollTop()-t(this).offset().top+t(e).offset().top),this},t.fn.dropdown=function(e){var n={inDuration:300,outDuration:225,constrainWidth:!0,hover:!1,gutter:0,belowOrigin:!1,alignment:"left",stopPropagation:!1};return"open"===e?(this.each(function(){t(this).trigger("open")}),!1):"close"===e?(this.each(function(){t(this).trigger("close")}),!1):void this.each(function(){var r=t(this),i=t.extend({},n,e),o=!1,a=t("#"+r.attr("data-activates"));function s(){void 0!==r.data("induration")&&(i.inDuration=r.data("induration")),void 0!==r.data("outduration")&&(i.outDuration=r.data("outduration")),void 0!==r.data("constrainwidth")&&(i.constrainWidth=r.data("constrainwidth")),void 0!==r.data("hover")&&(i.hover=r.data("hover")),void 0!==r.data("gutter")&&(i.gutter=r.data("gutter")),void 0!==r.data("beloworigin")&&(i.belowOrigin=r.data("beloworigin")),void 0!==r.data("alignment")&&(i.alignment=r.data("alignment")),void 0!==r.data("stoppropagation")&&(i.stopPropagation=r.data("stoppropagation"))}function u(e){"focus"===e&&(o=!0),s(),a.addClass("active"),r.addClass("active");var n=r[0].getBoundingClientRect().width;!0===i.constrainWidth?a.css("width",n):a.css("white-space","nowrap");var u=window.innerHeight,l=r.innerHeight(),h=r.offset().left,f=r.offset().top-t(window).scrollTop(),d=i.alignment,p=0,m=0,g=0;!0===i.belowOrigin&&(g=l);var v=0,y=0,w=r.parent();w.is("body")||(w[0].scrollHeight>w[0].clientHeight&&(v=w[0].scrollTop),w[0].scrollWidth>w[0].clientWidth&&(y=w[0].scrollLeft)),h+a.innerWidth()>t(window).width()?d="right":h-a.innerWidth()+r.innerWidth()<0&&(d="left"),f+a.innerHeight()>u&&(f+l-a.innerHeight()<0?a.css("max-height",u-f-g):(g||(g+=l),g-=a.innerHeight())),"left"===d?(p=i.gutter,m=r.position().left+p):"right"===d&&(a.stop(!0,!0).css({opacity:0,left:0}),m=r.position().left+n-a.width()+(p=-i.gutter)),a.css({position:"absolute",top:r.position().top+g+v,left:m+y}),a.slideDown({queue:!1,duration:i.inDuration,easing:"easeOutCubic",complete:function(){t(this).css("height","")}}).animate({opacity:1},{queue:!1,duration:i.inDuration,easing:"easeOutSine"}),setTimeout(function(){t(document).on("click."+a.attr("id"),function(e){c(),t(document).off("click."+a.attr("id"))})},0)}function c(){o=!1,a.fadeOut(i.outDuration),a.removeClass("active"),r.removeClass("active"),t(document).off("click."+a.attr("id")),setTimeout(function(){a.css("max-height","")},i.outDuration)}if(s(),r.after(a),i.hover){var l=!1;r.off("click."+r.attr("id")),r.on("mouseenter",function(t){!1===l&&(u(),l=!0)}),r.on("mouseleave",function(e){t(e.toElement||e.relatedTarget).closest(".dropdown-content").is(a)||(a.stop(!0,!0),c(),l=!1)}),a.on("mouseleave",function(e){t(e.toElement||e.relatedTarget).closest(".dropdown-button").is(r)||(a.stop(!0,!0),c(),l=!1)})}else r.off("click."+r.attr("id")),r.on("click."+r.attr("id"),function(e){o||(r[0]!=e.currentTarget||r.hasClass("active")||0!==t(e.target).closest(".dropdown-content").length?r.hasClass("active")&&(c(),t(document).off("click."+a.attr("id"))):(e.preventDefault(),i.stopPropagation&&e.stopPropagation(),u("click")))});r.on("open",function(t,e){u(e)}),r.on("close",c)})},t(document).ready(function(){t(".dropdown-button").dropdown()})}(jQuery),function(t,e){"use strict";var n={opacity:.5,inDuration:250,outDuration:250,ready:void 0,complete:void 0,dismissible:!0,startingTop:"4%",endingTop:"10%"},r=function(){function r(e,n){_classCallCheck(this,r),e[0].M_Modal&&e[0].M_Modal.destroy(),this.$el=e,this.options=t.extend({},r.defaults,n),this.isOpen=!1,this.$el[0].M_Modal=this,this.id=e.attr("id"),this.openingTrigger=void 0,this.$overlay=t('<div class="modal-overlay"></div>'),r._increment++,r._count++,this.$overlay[0].style.zIndex=1e3+2*r._increment,this.$el[0].style.zIndex=1e3+2*r._increment+1,this.setupEventHandlers()}return _createClass(r,[{key:"getInstance",value:function(){return this}},{key:"destroy",value:function(){this.removeEventHandlers(),this.$el[0].removeAttribute("style"),this.$overlay[0].parentNode&&this.$overlay[0].parentNode.removeChild(this.$overlay[0]),this.$el[0].M_Modal=void 0,r._count--}},{key:"setupEventHandlers",value:function(){this.handleOverlayClickBound=this.handleOverlayClick.bind(this),this.handleModalCloseClickBound=this.handleModalCloseClick.bind(this),1===r._count&&document.body.addEventListener("click",this.handleTriggerClick),this.$overlay[0].addEventListener("click",this.handleOverlayClickBound),this.$el[0].addEventListener("click",this.handleModalCloseClickBound)}},{key:"removeEventHandlers",value:function(){0===r._count&&document.body.removeEventListener("click",this.handleTriggerClick),this.$overlay[0].removeEventListener("click",this.handleOverlayClickBound),this.$el[0].removeEventListener("click",this.handleModalCloseClickBound)}},{key:"handleTriggerClick",value:function(e){var n=t(e.target).closest(".modal-trigger");if(e.target&&n.length){var r=n[0].getAttribute("href");r=r?r.slice(1):n[0].getAttribute("data-target");var i=document.getElementById(r).M_Modal;i&&i.open(n),e.preventDefault()}}},{key:"handleOverlayClick",value:function(){this.options.dismissible&&this.close()}},{key:"handleModalCloseClick",value:function(e){var n=t(e.target).closest(".modal-close");e.target&&n.length&&this.close()}},{key:"handleKeydown",value:function(t){27===t.keyCode&&this.options.dismissible&&this.close()}},{key:"animateIn",value:function(){var n=this;t.extend(this.$el[0].style,{display:"block",opacity:0}),t.extend(this.$overlay[0].style,{display:"block",opacity:0}),e(this.$overlay[0],{opacity:this.options.opacity},{duration:this.options.inDuration,queue:!1,ease:"easeOutCubic"});var r={duration:this.options.inDuration,queue:!1,ease:"easeOutCubic",complete:function(){"function"==typeof n.options.ready&&n.options.ready.call(n,n.$el,n.openingTrigger)}};this.$el[0].classList.contains("bottom-sheet")?e(this.$el[0],{bottom:0,opacity:1},r):(e.hook(this.$el[0],"scaleX",.7),this.$el[0].style.top=this.options.startingTop,e(this.$el[0],{top:this.options.endingTop,opacity:1,scaleX:1},r))}},{key:"animateOut",value:function(){var t=this;e(this.$overlay[0],{opacity:0},{duration:this.options.outDuration,queue:!1,ease:"easeOutQuart"});var n={duration:this.options.outDuration,queue:!1,ease:"easeOutCubic",complete:function(){t.$el[0].style.display="none","function"==typeof t.options.complete&&t.options.complete.call(t,t.$el),t.$overlay[0].parentNode.removeChild(t.$overlay[0])}};this.$el[0].classList.contains("bottom-sheet")?e(this.$el[0],{bottom:"-100%",opacity:0},n):e(this.$el[0],{top:this.options.startingTop,opacity:0,scaleX:.7},n)}},{key:"open",value:function(t){if(!this.isOpen){this.isOpen=!0;var e=document.body;return e.style.overflow="hidden",this.$el[0].classList.add("open"),e.appendChild(this.$overlay[0]),this.openingTrigger=t||void 0,this.options.dismissible&&(this.handleKeydownBound=this.handleKeydown.bind(this),document.addEventListener("keydown",this.handleKeydownBound)),this.animateIn(),this}}},{key:"close",value:function(){if(this.isOpen)return this.isOpen=!1,this.$el[0].classList.remove("open"),document.body.style.overflow="",this.options.dismissible&&document.removeEventListener("keydown",this.handleKeydownBound),this.animateOut(),this}}],[{key:"init",value:function(e,n){var i=[];return e.each(function(){i.push(new r(t(this),n))}),i}},{key:"defaults",get:function(){return n}}]),r}();r._increment=0,r._count=0,Materialize.Modal=r,t.fn.modal=function(e){return r.prototype[e]?"get"===e.slice(0,3)?this.first()[0].M_Modal[e]():this.each(function(){this.M_Modal[e]()}):"object"!=typeof e&&e?void t.error("Method "+e+" does not exist on jQuery.modal"):(r.init(this,arguments[0]),this)}}(jQuery,Materialize.Vel),function(t){t.fn.materialbox=function(){return this.each(function(){if(!t(this).hasClass("initialized")){t(this).addClass("initialized");var e,n,r=!1,i=!0,o=200,a=t(this),s=t("<div></div>").addClass("material-placeholder"),u=a.attr("style");a.wrap(s),a.on("click",function(){var o=a.parent(".material-placeholder"),s=window.innerWidth,u=window.innerHeight,l=a.width(),h=a.height();if(!1===i)return c(),!1;if(r&&!0===i)return c(),!1;for(i=!1,a.addClass("active"),r=!0,o.css({width:o[0].getBoundingClientRect().width,height:o[0].getBoundingClientRect().height,position:"relative",top:0,left:0}),e=void 0,n=o[0].parentNode;null!==n&&!t(n).is(document);){var f=t(n);"visible"!==f.css("overflow")&&(f.css("overflow","visible"),e=void 0===e?f:e.add(f)),n=n.parentNode}a.css({position:"absolute","z-index":1e3,"will-change":"left, top, width, height"}).data("width",l).data("height",h);var d=t('<div id="materialbox-overlay"></div>').css({opacity:0}).click(function(){!0===i&&c()});a.before(d);var p=d[0].getBoundingClientRect();if(d.css({width:s,height:u,left:-1*p.left,top:-1*p.top}),d.velocity({opacity:1},{duration:275,queue:!1,easing:"easeOutQuad"}),""!==a.data("caption")){var m=t('<div class="materialbox-caption"></div>');m.text(a.data("caption")),t("body").append(m),m.css({display:"inline"}),m.velocity({opacity:1},{duration:275,queue:!1,easing:"easeOutQuad"})}var g=0,v=0;l/s>h/u?(g=.9*s,v=.9*s*(h/l)):(g=.9*u*(l/h),v=.9*u),a.hasClass("responsive-img")?a.velocity({"max-width":g,width:l},{duration:0,queue:!1,complete:function(){a.css({left:0,top:0}).velocity({height:v,width:g,left:t(document).scrollLeft()+s/2-a.parent(".material-placeholder").offset().left-g/2,top:t(document).scrollTop()+u/2-a.parent(".material-placeholder").offset().top-v/2},{duration:275,queue:!1,easing:"easeOutQuad",complete:function(){i=!0}})}}):a.css("left",0).css("top",0).velocity({height:v,width:g,left:t(document).scrollLeft()+s/2-a.parent(".material-placeholder").offset().left-g/2,top:t(document).scrollTop()+u/2-a.parent(".material-placeholder").offset().top-v/2},{duration:275,queue:!1,easing:"easeOutQuad",complete:function(){i=!0}}),t(window).on("scroll.materialbox",function(){r&&c()}),t(window).on("resize.materialbox",function(){r&&c()}),t(document).on("keyup.materialbox",function(t){27===t.keyCode&&!0===i&&r&&c()})})}function c(){i=!1;var n=a.parent(".material-placeholder"),s=(window,window,a.data("width")),c=a.data("height");a.velocity("stop",!0),t("#materialbox-overlay").velocity("stop",!0),t(".materialbox-caption").velocity("stop",!0),t(window).off("scroll.materialbox"),t(document).off("keyup.materialbox"),t(window).off("resize.materialbox"),t("#materialbox-overlay").velocity({opacity:0},{duration:o,queue:!1,easing:"easeOutQuad",complete:function(){r=!1,t(this).remove()}}),a.velocity({width:s,height:c,left:0,top:0},{duration:o,queue:!1,easing:"easeOutQuad",complete:function(){n.css({height:"",width:"",position:"",top:"",left:""}),a.removeAttr("style"),a.attr("style",u),a.removeClass("active"),i=!0,e&&e.css("overflow","")}}),t(".materialbox-caption").velocity({opacity:0},{duration:o,queue:!1,easing:"easeOutQuad",complete:function(){t(this).remove()}})}})},t(document).ready(function(){t(".materialboxed").materialbox()})}(jQuery),function(t){t.fn.parallax=function(){var e=t(window).width();return this.each(function(n){var r=t(this);function i(n){var i;i=e<601?r.height()>0?r.height():r.children("img").height():r.height()>0?r.height():500;var o=r.children("img").first(),a=o.height()-i,s=r.offset().top+i,u=r.offset().top,c=t(window).scrollTop(),l=window.innerHeight,h=Math.round(a*((c+l-u)/(i+l)));n&&o.css("display","block"),s>c&&u<c+l&&o.css("transform","translate3D(-50%,"+h+"px, 0)")}r.addClass("parallax"),r.children("img").one("load",function(){i(!0)}).each(function(){this.complete&&t(this).trigger("load")}),t(window).scroll(function(){e=t(window).width(),i(!1)}),t(window).resize(function(){e=t(window).width(),i(!1)})})}}(jQuery),function(t){var e={init:function(e){e=t.extend({onShow:null,swipeable:!1,responsiveThreshold:1/0},e);var n=Materialize.objectSelectorString(t(this));return this.each(function(r){var i,o,a,s,u=n+r,c=t(this),l=t(window).width(),h=c.find("li.tab a"),f=c.width(),d=t(),p=Math.max(f,c[0].scrollWidth)/h.length,m=0,g=0,v=!1,y=function(t){return Math.ceil(f-t.position().left-t[0].getBoundingClientRect().width-c.scrollLeft())},w=function(t){return Math.floor(t.position().left+c.scrollLeft())},b=function(t){m-t>=0?(s.velocity({right:y(i)},{duration:300,queue:!1,easing:"easeOutQuad"}),s.velocity({left:w(i)},{duration:300,queue:!1,easing:"easeOutQuad",delay:90})):(s.velocity({left:w(i)},{duration:300,queue:!1,easing:"easeOutQuad"}),s.velocity({right:y(i)},{duration:300,queue:!1,easing:"easeOutQuad",delay:90}))};e.swipeable&&l>e.responsiveThreshold&&(e.swipeable=!1),0===(i=t(h.filter('[href="'+location.hash+'"]'))).length&&(i=t(this).find("li.tab a.active").first()),0===i.length&&(i=t(this).find("li.tab a").first()),i.addClass("active"),(m=h.index(i))<0&&(m=0),void 0!==i[0]&&(o=t(i[0].hash)).addClass("active"),c.find(".indicator").length||c.append('<li class="indicator"></li>'),s=c.find(".indicator"),c.append(s),c.is(":visible")&&setTimeout(function(){s.css({right:y(i)}),s.css({left:w(i)})},0),t(window).off("resize.tabs-"+u).on("resize.tabs-"+u,function(){f=c.width(),p=Math.max(f,c[0].scrollWidth)/h.length,m<0&&(m=0),0!==p&&0!==f&&(s.css({right:y(i)}),s.css({left:w(i)}))}),e.swipeable?(h.each(function(){var e=t(Materialize.escapeHash(this.hash));e.addClass("carousel-item"),d=d.add(e)}),a=d.wrapAll('<div class="tabs-content carousel"></div>'),d.css("display",""),t(".tabs-content.carousel").carousel({fullWidth:!0,noWrap:!0,onCycleTo:function(t){if(!v){var n=m;m=a.index(t),i.removeClass("active"),(i=h.eq(m)).addClass("active"),b(n),"function"==typeof e.onShow&&e.onShow.call(c[0],o)}}})):h.not(i).each(function(){t(Materialize.escapeHash(this.hash)).hide()}),c.off("click.tabs").on("click.tabs","a",function(n){if(t(this).parent().hasClass("disabled"))n.preventDefault();else if(!t(this).attr("target")){v=!0,f=c.width(),p=Math.max(f,c[0].scrollWidth)/h.length,i.removeClass("active");var r=o;i=t(this),o=t(Materialize.escapeHash(this.hash)),h=c.find("li.tab a"),i.position(),i.addClass("active"),g=m,(m=h.index(t(this)))<0&&(m=0),e.swipeable?d.length&&d.carousel("set",m,function(){"function"==typeof e.onShow&&e.onShow.call(c[0],o)}):(void 0!==o&&(o.show(),o.addClass("active"),"function"==typeof e.onShow&&e.onShow.call(this,o)),void 0===r||r.is(o)||(r.hide(),r.removeClass("active"))),setTimeout(function(){v=!1},300),b(g),n.preventDefault()}})})},select_tab:function(t){this.find('a[href="#'+t+'"]').trigger("click")}};t.fn.tabs=function(n){return e[n]?e[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?void t.error("Method "+n+" does not exist on jQuery.tabs"):e.init.apply(this,arguments)},t(document).ready(function(){t("ul.tabs").tabs()})}(jQuery),function(t){t.fn.tooltip=function(n){return"remove"===n?(this.each(function(){t("#"+t(this).attr("data-tooltip-id")).remove(),t(this).removeAttr("data-tooltip-id"),t(this).off("mouseenter.tooltip mouseleave.tooltip")}),!1):(n=t.extend({delay:350,tooltip:"",position:"bottom",html:!1},n),this.each(function(){var r,i,o,a,s,u,c=Materialize.guid(),l=t(this);l.attr("data-tooltip-id")&&t("#"+l.attr("data-tooltip-id")).remove(),l.attr("data-tooltip-id",c);var h,f=function(){r=l.attr("data-html")?"true"===l.attr("data-html"):n.html,i=void 0===(i=l.attr("data-delay"))||""===i?n.delay:i,o=void 0===(o=l.attr("data-position"))||""===o?n.position:o,a=void 0===(a=l.attr("data-tooltip"))||""===a?n.tooltip:a};f(),h=t('<div class="material-tooltip"></div>'),a=r?t("<span></span>").html(a):t("<span></span>").text(a),h.append(a).appendTo(t("body")).attr("id",c),(u=t('<div class="backdrop"></div>')).appendTo(h),s=h,l.off("mouseenter.tooltip mouseleave.tooltip");var d,p=!1;l.on({"mouseenter.tooltip":function(t){d=setTimeout(function(){f(),p=!0,s.velocity("stop"),u.velocity("stop"),s.css({visibility:"visible",left:"0px",top:"0px"});var t,n,r,i,a,c,h=l.outerWidth(),d=l.outerHeight(),m=s.outerHeight(),g=s.outerWidth(),v="0px",y="0px",w=u[0].offsetWidth,b=u[0].offsetHeight;"top"===o?(i=l.offset().top-m-5,a=l.offset().left+h/2-g/2,c=e(a,i,g,m),v="-10px",u.css({bottom:0,left:0,borderRadius:"14px 14px 0 0",transformOrigin:"50% 100%",marginTop:m,marginLeft:g/2-w/2})):"left"===o?(i=l.offset().top+d/2-m/2,a=l.offset().left-g-5,c=e(a,i,g,m),y="-10px",u.css({top:"-7px",right:0,width:"14px",height:"14px",borderRadius:"14px 0 0 14px",transformOrigin:"95% 50%",marginTop:m/2,marginLeft:g})):"right"===o?(i=l.offset().top+d/2-m/2,a=l.offset().left+h+5,c=e(a,i,g,m),y="+10px",u.css({top:"-7px",left:0,width:"14px",height:"14px",borderRadius:"0 14px 14px 0",transformOrigin:"5% 50%",marginTop:m/2,marginLeft:"0px"})):(i=l.offset().top+l.outerHeight()+5,a=l.offset().left+h/2-g/2,c=e(a,i,g,m),v="+10px",u.css({top:0,left:0,marginLeft:g/2-w/2})),s.css({top:c.y,left:c.x}),t=Math.SQRT2*g/parseInt(w),n=Math.SQRT2*m/parseInt(b),r=Math.max(t,n),s.velocity({translateY:v,translateX:y},{duration:350,queue:!1}).velocity({opacity:1},{duration:300,delay:50,queue:!1}),u.css({visibility:"visible"}).velocity({opacity:1},{duration:55,delay:0,queue:!1}).velocity({scaleX:r,scaleY:r},{duration:300,delay:0,queue:!1,easing:"easeInOutQuad"})},i)},"mouseleave.tooltip":function(){p=!1,clearTimeout(d),setTimeout(function(){!0!==p&&(s.velocity({opacity:0,translateY:0,translateX:0},{duration:225,queue:!1}),u.velocity({opacity:0,scaleX:1,scaleY:1},{duration:225,queue:!1,complete:function(){u.css({visibility:"hidden"}),s.css({visibility:"hidden"}),p=!1}}))},225)}})}))};var e=function(e,n,r,i){var o=e,a=n;return o<0?o=4:o+r>window.innerWidth&&(o-=o+r-window.innerWidth),a<0?a=4:a+i>window.innerHeight+t(window).scrollTop&&(a-=a+i-window.innerHeight),{x:o,y:a}};t(document).ready(function(){t(".tooltipped").tooltip()})}(jQuery),function(t){"use strict";var e=e||{},n=document.querySelectorAll.bind(document);function r(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e+=n+":"+t[n]+";");return e}var i={duration:750,show:function(t,e){if(2===t.button)return!1;var n=e||this,o=document.createElement("div");o.className="waves-ripple",n.appendChild(o);var a,s,u,c,l,h,f=(c={top:0,left:0},s=(l=(a=n)&&a.ownerDocument).documentElement,"undefined"!=typeof a.getBoundingClientRect&&(c=a.getBoundingClientRect()),u=null!==(h=l)&&h===h.window?l:9===l.nodeType&&l.defaultView,{top:c.top+u.pageYOffset-s.clientTop,left:c.left+u.pageXOffset-s.clientLeft}),d=t.pageY-f.top,p=t.pageX-f.left,m="scale("+n.clientWidth/100*10+")";"touches"in t&&(d=t.touches[0].pageY-f.top,p=t.touches[0].pageX-f.left),o.setAttribute("data-hold",Date.now()),o.setAttribute("data-scale",m),o.setAttribute("data-x",p),o.setAttribute("data-y",d);var g={top:d+"px",left:p+"px"};o.className=o.className+" waves-notransition",o.setAttribute("style",r(g)),o.className=o.className.replace("waves-notransition",""),g["-webkit-transform"]=m,g["-moz-transform"]=m,g["-ms-transform"]=m,g["-o-transform"]=m,g.transform=m,g.opacity="1",g["-webkit-transition-duration"]=i.duration+"ms",g["-moz-transition-duration"]=i.duration+"ms",g["-o-transition-duration"]=i.duration+"ms",g["transition-duration"]=i.duration+"ms",g["-webkit-transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",g["-moz-transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",g["-o-transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",g["transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",o.setAttribute("style",r(g))},hide:function(t){o.touchup(t);var e=this,n=null,a=e.getElementsByClassName("waves-ripple");if(!(a.length>0))return!1;var s=(n=a[a.length-1]).getAttribute("data-x"),u=n.getAttribute("data-y"),c=n.getAttribute("data-scale"),l=350-(Date.now()-Number(n.getAttribute("data-hold")));l<0&&(l=0),setTimeout(function(){n.setAttribute("style",r({top:u+"px",left:s+"px",opacity:"0","-webkit-transition-duration":i.duration+"ms","-moz-transition-duration":i.duration+"ms","-o-transition-duration":i.duration+"ms","transition-duration":i.duration+"ms","-webkit-transform":c,"-moz-transform":c,"-ms-transform":c,"-o-transform":c,transform:c})),setTimeout(function(){try{e.removeChild(n)}catch(t){return!1}},i.duration)},l)},wrapInput:function(t){for(var e=0;e<t.length;e++){var n=t[e];if("input"===n.tagName.toLowerCase()){var r=n.parentNode;if("i"===r.tagName.toLowerCase()&&-1!==r.className.indexOf("waves-effect"))continue;var i=document.createElement("i");i.className=n.className+" waves-input-wrapper";var o=n.getAttribute("style");o||(o=""),i.setAttribute("style",o),n.className="waves-button-input",n.removeAttribute("style"),r.replaceChild(i,n),i.appendChild(n)}}}},o={touches:0,allowEvent:function(t){var e=!0;return"touchstart"===t.type?o.touches+=1:"touchend"===t.type||"touchcancel"===t.type?setTimeout(function(){o.touches>0&&(o.touches-=1)},500):"mousedown"===t.type&&o.touches>0&&(e=!1),e},touchup:function(t){o.allowEvent(t)}};function a(e){var n=function(t){if(!1===o.allowEvent(t))return null;for(var e=null,n=t.target||t.srcElement;null!==n.parentNode;){if(!(n instanceof SVGElement)&&-1!==n.className.indexOf("waves-effect")){e=n;break}n=n.parentNode}return e}(e);null!==n&&(i.show(e,n),"ontouchstart"in t&&(n.addEventListener("touchend",i.hide,!1),n.addEventListener("touchcancel",i.hide,!1)),n.addEventListener("mouseup",i.hide,!1),n.addEventListener("mouseleave",i.hide,!1),n.addEventListener("dragend",i.hide,!1))}e.displayEffect=function(e){"duration"in(e=e||{})&&(i.duration=e.duration),i.wrapInput(n(".waves-effect")),"ontouchstart"in t&&document.body.addEventListener("touchstart",a,!1),document.body.addEventListener("mousedown",a,!1)},e.attach=function(e){"input"===e.tagName.toLowerCase()&&(i.wrapInput([e]),e=e.parentNode),"ontouchstart"in t&&e.addEventListener("touchstart",a,!1),e.addEventListener("mousedown",a,!1)},t.Waves=e,document.addEventListener("DOMContentLoaded",function(){e.displayEffect()},!1)}(window),function(t,e){"use strict";var n={displayLength:1/0,inDuration:300,outDuration:375,className:void 0,completeCallback:void 0,activationPercent:.8},r=function(){function r(e,n,i,o){if(_classCallCheck(this,r),e){this.options={displayLength:n,className:i,completeCallback:o},this.options=t.extend({},r.defaults,this.options),this.message=e,this.panning=!1,this.timeRemaining=this.options.displayLength,0===r._toasts.length&&r._createContainer(),r._toasts.push(this);var a=this.createToast();a.M_Toast=this,this.el=a,this._animateIn(),this.setTimer()}}return _createClass(r,[{key:"createToast",value:function(){var e=document.createElement("div");if(e.classList.add("toast"),this.options.className){var n,i=this.options.className.split(" "),o=void 0;for(o=0,n=i.length;o<n;o++)e.classList.add(i[o])}return("object"==typeof HTMLElement?this.message instanceof HTMLElement:this.message&&"object"==typeof this.message&&null!==this.message&&1===this.message.nodeType&&"string"==typeof this.message.nodeName)?e.appendChild(this.message):this.message instanceof jQuery?t(e).append(this.message):e.innerHTML=this.message,r._container.appendChild(e),e}},{key:"_animateIn",value:function(){e(this.el,{top:0,opacity:1},{duration:300,easing:"easeOutCubic",queue:!1})}},{key:"setTimer",value:function(){var t=this;this.timeRemaining!==1/0&&(this.counterInterval=setInterval(function(){t.panning||(t.timeRemaining-=20),t.timeRemaining<=0&&t.remove()},20))}},{key:"remove",value:function(){var t=this;window.clearInterval(this.counterInterval);var n=this.el.offsetWidth*this.options.activationPercent;this.wasSwiped&&(this.el.style.transition="transform .05s, opacity .05s",this.el.style.transform="translateX("+n+"px)",this.el.style.opacity=0),e(this.el,{opacity:0,marginTop:"-40px"},{duration:this.options.outDuration,easing:"easeOutExpo",queue:!1,complete:function(){"function"==typeof t.options.completeCallback&&t.options.completeCallback(),t.el.parentNode.removeChild(t.el),r._toasts.splice(r._toasts.indexOf(t),1),0===r._toasts.length&&r._removeContainer()}})}}],[{key:"_createContainer",value:function(){var t=document.createElement("div");t.setAttribute("id","toast-container"),t.addEventListener("touchstart",r._onDragStart),t.addEventListener("touchmove",r._onDragMove),t.addEventListener("touchend",r._onDragEnd),t.addEventListener("mousedown",r._onDragStart),document.addEventListener("mousemove",r._onDragMove),document.addEventListener("mouseup",r._onDragEnd),document.body.appendChild(t),r._container=t}},{key:"_removeContainer",value:function(){document.removeEventListener("mousemove",r._onDragMove),document.removeEventListener("mouseup",r._onDragEnd),r._container.parentNode.removeChild(r._container),r._container=null}},{key:"_onDragStart",value:function(e){if(e.target&&t(e.target).closest(".toast").length){var n=t(e.target).closest(".toast")[0].M_Toast;n.panning=!0,r._draggedToast=n,n.el.classList.add("panning"),n.el.style.transition="",n.startingXPos=r._xPos(e),n.time=Date.now(),n.xPos=r._xPos(e)}}},{key:"_onDragMove",value:function(t){if(r._draggedToast){t.preventDefault();var e=r._draggedToast;e.deltaX=Math.abs(e.xPos-r._xPos(t)),e.xPos=r._xPos(t),e.velocityX=e.deltaX/(Date.now()-e.time),e.time=Date.now();var n=e.xPos-e.startingXPos,i=e.el.offsetWidth*e.options.activationPercent;e.el.style.transform="translateX("+n+"px)",e.el.style.opacity=1-Math.abs(n/i)}}},{key:"_onDragEnd",value:function(t){if(r._draggedToast){var e=r._draggedToast;e.panning=!1,e.el.classList.remove("panning");var n=e.el.offsetWidth*e.options.activationPercent;Math.abs(e.xPos-e.startingXPos)>n||e.velocityX>1?(e.wasSwiped=!0,e.remove()):(e.el.style.transition="transform .2s, opacity .2s",e.el.style.transform="",e.el.style.opacity=""),r._draggedToast=null}}},{key:"_xPos",value:function(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientX:t.clientX}},{key:"removeAll",value:function(){for(var t in r._toasts)r._toasts[t].remove()}},{key:"defaults",get:function(){return n}}]),r}();r._toasts=[],r._container=null,r._draggedToast=null,Materialize.Toast=r,Materialize.toast=function(t,e,n,i){return new r(t,e,n,i)}}(jQuery,Materialize.Vel),function(t){var e={init:function(e){e=t.extend({menuWidth:300,edge:"left",closeOnClick:!1,draggable:!0,onOpen:null,onClose:null},e),t(this).each(function(){var n=t(this),r=n.attr("data-activates"),i=t("#"+r);300!=e.menuWidth&&i.css("width",e.menuWidth);var o=t('.drag-target[data-sidenav="'+r+'"]');e.draggable?(o.length&&o.remove(),o=t('<div class="drag-target"></div>').attr("data-sidenav",r),t("body").append(o)):o=t(),"left"==e.edge?(i.css("transform","translateX(-100%)"),o.css({left:0})):(i.addClass("right-aligned").css("transform","translateX(100%)"),o.css({right:0})),i.hasClass("fixed")&&window.innerWidth>992&&i.css("transform","translateX(0)"),i.hasClass("fixed")&&t(window).resize(function(){window.innerWidth>992?0!==t("#sidenav-overlay").length&&s?a(!0):i.css("transform","translateX(0%)"):!1===s&&i.css("transform","left"===e.edge?"translateX(-100%)":"translateX(100%)")}),!0===e.closeOnClick&&i.on("click.itemclick","a:not(.collapsible-header)",function(){window.innerWidth>992&&i.hasClass("fixed")||a()});var a=function(n){s=!1,t("body").css({overflow:"",width:""}),t("#sidenav-overlay").velocity({opacity:0},{duration:200,queue:!1,easing:"easeOutQuad",complete:function(){t(this).remove()}}),"left"===e.edge?(o.css({width:"",right:"",left:"0"}),i.velocity({translateX:"-100%"},{duration:200,queue:!1,easing:"easeOutCubic",complete:function(){!0===n&&(i.removeAttr("style"),i.css("width",e.menuWidth))}})):(o.css({width:"",right:"0",left:""}),i.velocity({translateX:"100%"},{duration:200,queue:!1,easing:"easeOutCubic",complete:function(){!0===n&&(i.removeAttr("style"),i.css("width",e.menuWidth))}})),"function"==typeof e.onClose&&e.onClose.call(this,i)},s=!1;e.draggable&&(o.on("click",function(){s&&a()}),o.hammer({prevent_default:!1}).on("pan",function(n){if("touch"==n.gesture.pointerType){var r=n.gesture.center.x;if(0===r&&0===n.gesture.center.y)return;var o,u=t("body"),c=t("#sidenav-overlay"),l=u.innerWidth();if(u.css("overflow","hidden"),u.width(l),0===c.length&&((c=t('<div id="sidenav-overlay"></div>')).css("opacity",0).click(function(){a()}),"function"==typeof e.onOpen&&e.onOpen.call(this,i),t("body").append(c)),"left"===e.edge&&(r>e.menuWidth?r=e.menuWidth:r<0&&(r=0)),"left"===e.edge)r<e.menuWidth/2?s=!1:r>=e.menuWidth/2&&(s=!0),i.css("transform","translateX("+(r-e.menuWidth)+"px)");else{r<window.innerWidth-e.menuWidth/2?s=!0:r>=window.innerWidth-e.menuWidth/2&&(s=!1);var h=r-e.menuWidth/2;h<0&&(h=0),i.css("transform","translateX("+h+"px)")}"left"===e.edge?c.velocity({opacity:o=r/e.menuWidth},{duration:10,queue:!1,easing:"easeOutQuad"}):(o=Math.abs((r-window.innerWidth)/e.menuWidth),c.velocity({opacity:o},{duration:10,queue:!1,easing:"easeOutQuad"}))}}).on("panend",function(n){if("touch"==n.gesture.pointerType){var r=t("#sidenav-overlay"),a=n.gesture.velocityX,u=n.gesture.center.x,c=u-e.menuWidth,l=u-e.menuWidth/2;c>0&&(c=0),l<0&&(l=0),"left"===e.edge?s&&a<=.3||a<-.5?(0!==c&&i.velocity({translateX:[0,c]},{duration:300,queue:!1,easing:"easeOutQuad"}),r.velocity({opacity:1},{duration:50,queue:!1,easing:"easeOutQuad"}),o.css({width:"50%",right:0,left:""}),s=!0):(!s||a>.3)&&(t("body").css({overflow:"",width:""}),i.velocity({translateX:[-1*e.menuWidth-10,c]},{duration:200,queue:!1,easing:"easeOutQuad"}),r.velocity({opacity:0},{duration:200,queue:!1,easing:"easeOutQuad",complete:function(){"function"==typeof e.onClose&&e.onClose.call(this,i),t(this).remove()}}),o.css({width:"10px",right:"",left:0})):s&&a>=-.3||a>.5?(0!==l&&i.velocity({translateX:[0,l]},{duration:300,queue:!1,easing:"easeOutQuad"}),r.velocity({opacity:1},{duration:50,queue:!1,easing:"easeOutQuad"}),o.css({width:"50%",right:"",left:0}),s=!0):(!s||a<-.3)&&(t("body").css({overflow:"",width:""}),i.velocity({translateX:[e.menuWidth+10,l]},{duration:200,queue:!1,easing:"easeOutQuad"}),r.velocity({opacity:0},{duration:200,queue:!1,easing:"easeOutQuad",complete:function(){"function"==typeof e.onClose&&e.onClose.call(this,i),t(this).remove()}}),o.css({width:"10px",right:0,left:""}))}})),n.off("click.sidenav").on("click.sidenav",function(){if(!0===s)s=!1,a();else{var n=t("body"),r=t('<div id="sidenav-overlay"></div>'),u=n.innerWidth();n.css("overflow","hidden"),n.width(u),t("body").append(o),"left"===e.edge?(o.css({width:"50%",right:0,left:""}),i.velocity({translateX:[0,-1*e.menuWidth]},{duration:300,queue:!1,easing:"easeOutQuad"})):(o.css({width:"50%",right:"",left:0}),i.velocity({translateX:[0,e.menuWidth]},{duration:300,queue:!1,easing:"easeOutQuad"})),r.css("opacity",0).click(function(){s=!1,a(),r.velocity({opacity:0},{duration:300,queue:!1,easing:"easeOutQuad",complete:function(){t(this).remove()}})}),t("body").append(r),r.velocity({opacity:1},{duration:300,queue:!1,easing:"easeOutQuad",complete:function(){s=!0}}),"function"==typeof e.onOpen&&e.onOpen.call(this,i)}return!1})})},destroy:function(){var e=t("#sidenav-overlay"),n=t('.drag-target[data-sidenav="'+t(this).attr("data-activates")+'"]');e.trigger("click"),n.remove(),t(this).off("click"),e.remove()},show:function(){this.trigger("click")},hide:function(){t("#sidenav-overlay").trigger("click")}};t.fn.sideNav=function(n){return e[n]?e[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?void t.error("Method "+n+" does not exist on jQuery.sideNav"):e.init.apply(this,arguments)}}(jQuery),function(t){var e=t(window),n=[],r=[],i=!1,o=0,a={top:0,right:0,bottom:0,left:0};function s(){e.trigger("scrollSpy:winSize")}t.scrollSpy=function(s,u){u=t.extend({throttle:100,scrollOffset:200,activeClass:"active",getActiveElement:function(t){return'a[href="#'+t+'"]'}},u);var c=[];(s=t(s)).each(function(e,r){n.push(t(r)),t(r).data("scrollSpy:id",e),t('a[href="#'+t(r).attr("id")+'"]').click(function(e){e.preventDefault();var n=t(Materialize.escapeHash(this.hash)).offset().top+1;t("html, body").animate({scrollTop:n-u.scrollOffset},{duration:400,queue:!1,easing:"easeOutCubic"})})}),a.top=u.offsetTop||0,a.right=u.offsetRight||0,a.bottom=u.offsetBottom||0,a.left=u.offsetLeft||0;var l=Materialize.throttle(function(){!function(i){++o;var s=e.scrollTop(),u=e.scrollLeft(),c=u+e.width(),l=s+e.height(),h=function(e,r,i,o){var a=t();return t.each(n,function(t,n){if(n.height()>0){var s=n.offset().top,u=n.offset().left,c=u+n.width(),l=s+n.height();!(u>r||c<o||s>i||l<e)&&a.push(n)}}),a}(s+a.top+i||200,c+a.right,l+a.bottom,u+a.left);t.each(h,function(t,e){"number"!=typeof e.data("scrollSpy:ticks")&&e.triggerHandler("scrollSpy:enter"),e.data("scrollSpy:ticks",o)}),t.each(r,function(t,e){var n=e.data("scrollSpy:ticks");"number"==typeof n&&n!==o&&(e.triggerHandler("scrollSpy:exit"),e.data("scrollSpy:ticks",null))}),r=h}(u.scrollOffset)},u.throttle||100),h=function(){t(document).ready(l)};return i||(e.on("scroll",h),e.on("resize",h),i=!0),setTimeout(h,0),s.on("scrollSpy:enter",function(){c=t.grep(c,function(t){return 0!=t.height()});var e=t(this);c[0]?(t(u.getActiveElement(c[0].attr("id"))).removeClass(u.activeClass),e.data("scrollSpy:id")<c[0].data("scrollSpy:id")?c.unshift(t(this)):c.push(t(this))):c.push(t(this)),t(u.getActiveElement(c[0].attr("id"))).addClass(u.activeClass)}),s.on("scrollSpy:exit",function(){if((c=t.grep(c,function(t){return 0!=t.height()}))[0]){t(u.getActiveElement(c[0].attr("id"))).removeClass(u.activeClass);var e=t(this);(c=t.grep(c,function(t){return t.attr("id")!=e.attr("id")}))[0]&&t(u.getActiveElement(c[0].attr("id"))).addClass(u.activeClass)}}),s},t.winSizeSpy=function(n){return t.winSizeSpy=function(){return e},n=n||{throttle:100},e.on("resize",Materialize.throttle(s,n.throttle||100))},t.fn.scrollSpy=function(e){return t.scrollSpy(t(this),e)}}(jQuery),function(t){t(document).ready(function(){Materialize.updateTextFields=function(){t("input[type=text], input[type=password], input[type=email], input[type=url], input[type=tel], input[type=number], input[type=search], textarea").each(function(e,n){var r=t(this);t(n).val().length>0||t(n).is(":focus")||n.autofocus||void 0!==r.attr("placeholder")?r.siblings("label").addClass("active"):t(n)[0].validity?r.siblings("label").toggleClass("active",!0===t(n)[0].validity.badInput):r.siblings("label").removeClass("active")})};var e="input[type=text], input[type=password], input[type=email], input[type=url], input[type=tel], input[type=number], input[type=search], textarea";t(document).on("change",e,function(){0===t(this).val().length&&void 0===t(this).attr("placeholder")||t(this).siblings("label").addClass("active"),validate_field(t(this))}),t(document).ready(function(){Materialize.updateTextFields()}),t(document).on("reset",function(n){var r=t(n.target);r.is("form")&&(r.find(e).removeClass("valid").removeClass("invalid"),r.find(e).each(function(){""===t(this).attr("value")&&t(this).siblings("label").removeClass("active")}),r.find("select.initialized").each(function(){var t=r.find("option[selected]").text();r.siblings("input.select-dropdown").val(t)}))}),t(document).on("focus",e,function(){t(this).siblings("label, .prefix").addClass("active")}),t(document).on("blur",e,function(){var e=t(this),n=".prefix";0===e.val().length&&!0!==e[0].validity.badInput&&void 0===e.attr("placeholder")&&(n+=", label"),e.siblings(n).removeClass("active"),validate_field(e)}),window.validate_field=function(t){var e=void 0!==t.attr("data-length"),n=parseInt(t.attr("data-length")),r=t.val().length;0!==t.val().length||!1!==t[0].validity.badInput||t.is(":required")?t.hasClass("validate")&&(t.is(":valid")&&e&&r<=n||t.is(":valid")&&!e?(t.removeClass("invalid"),t.addClass("valid")):(t.removeClass("valid"),t.addClass("invalid"))):t.hasClass("validate")&&(t.removeClass("valid"),t.removeClass("invalid"))},t(document).on("keyup.radio","input[type=radio], input[type=checkbox]",function(e){if(9===e.which)return t(this).addClass("tabbed"),void t(this).one("blur",function(e){t(this).removeClass("tabbed")})});var n=t(".hiddendiv").first();n.length||(n=t('<div class="hiddendiv common"></div>'),t("body").append(n)),t(".materialize-textarea").each(function(){var e=t(this);e.data("original-height",e.height()),e.data("previous-length",e.val().length)}),t("body").on("keyup keydown autoresize",".materialize-textarea",function(){!function(e){var r=e.css("font-family"),i=e.css("font-size"),o=e.css("line-height"),a=e.css("padding");i&&n.css("font-size",i),r&&n.css("font-family",r),o&&n.css("line-height",o),a&&n.css("padding",a),e.data("original-height")||e.data("original-height",e.height()),"off"===e.attr("wrap")&&n.css("overflow-wrap","normal").css("white-space","pre"),n.text(e.val()+"\n");var s=n.html().replace(/\n/g,"<br>");n.html(s),e.is(":visible")?n.css("width",e.width()):n.css("width",t(window).width()/2),e.data("original-height")<=n.height()?e.css("height",n.height()):e.val().length<e.data("previous-length")&&e.css("height",e.data("original-height")),e.data("previous-length",e.val().length)}(t(this))}),t(document).on("change",'.file-field input[type="file"]',function(){for(var e=t(this).closest(".file-field").find("input.file-path"),n=t(this)[0].files,r=[],i=0;i<n.length;i++)r.push(n[i].name);e.val(r.join(", ")),e.trigger("change")});var r="input[type=range]",i=!1;t(r).each(function(){var e=t('<span class="thumb"><span class="value"></span></span>');t(this).after(e)});var o=function(t){var e=parseInt(t.parent().css("padding-left"));t.velocity({height:"30px",width:"30px",top:"-30px",marginLeft:-7+e+"px"},{duration:300,easing:"easeOutExpo"})},a=function(t){var e=t.width()-15,n=parseFloat(t.attr("max")),r=parseFloat(t.attr("min"));return(parseFloat(t.val())-r)/(n-r)*e};t(document).on("change",r,function(e){var n=t(this).siblings(".thumb");n.find(".value").html(t(this).val()),n.hasClass("active")||o(n);var r=a(t(this));n.addClass("active").css("left",r)}),t(document).on("mousedown touchstart",r,function(e){var n=t(this).siblings(".thumb");if(n.length<=0&&(n=t('<span class="thumb"><span class="value"></span></span>'),t(this).after(n)),n.find(".value").html(t(this).val()),i=!0,t(this).addClass("active"),n.hasClass("active")||o(n),"input"!==e.type){var r=a(t(this));n.addClass("active").css("left",r)}}),t(document).on("mouseup touchend",".range-field",function(){i=!1,t(this).removeClass("active")}),t(document).on("input mousemove touchmove",".range-field",function(e){var n=t(this).children(".thumb"),s=t(this).find(r);if(i){n.hasClass("active")||o(n);var u=a(s);n.addClass("active").css("left",u),n.find(".value").html(n.siblings(r).val())}}),t(document).on("mouseout touchleave",".range-field",function(){if(!i){var e=t(this).children(".thumb"),n=7+parseInt(t(this).css("padding-left"))+"px";e.hasClass("active")&&e.velocity({height:"0",width:"0",top:"10px",marginLeft:n},{duration:100}),e.removeClass("active")}}),t.fn.autocomplete=function(e){return e=t.extend({data:{},limit:1/0,onAutocomplete:null,minLength:1},e),this.each(function(){var n,r=t(this),i=e.data,o=0,a=-1,s=r.closest(".input-field");if(t.isEmptyObject(i))r.off("keyup.autocomplete focus.autocomplete");else{var u,c=t('<ul class="autocomplete-content dropdown-content"></ul>');s.length?(u=s.children(".autocomplete-content.dropdown-content").first()).length||s.append(c):(u=r.next(".autocomplete-content.dropdown-content")).length||r.after(c),u.length&&(c=u);var l=function(){c.empty(),a=-1,c.find(".active").removeClass("active"),n=void 0};r.off("blur.autocomplete").on("blur.autocomplete",function(){l()}),r.off("keyup.autocomplete focus.autocomplete").on("keyup.autocomplete focus.autocomplete",function(a){o=0;var s=r.val().toLowerCase();if(13!==a.which&&38!==a.which&&40!==a.which){if(n!==s&&(l(),s.length>=e.minLength))for(var u in i)if(i.hasOwnProperty(u)&&-1!==u.toLowerCase().indexOf(s)){if(o>=e.limit)break;var h=t("<li></li>");h.append(i[u]?'<img src="'+i[u]+'" class="right circle"><span>'+u+"</span>":"<span>"+u+"</span>"),c.append(h),f=s,p=(d=h).find("img"),g=(m=d.text().toLowerCase().indexOf(""+f.toLowerCase()))+f.length-1,v=d.text().slice(0,m),y=d.text().slice(m,g+1),w=d.text().slice(g+1),d.html("<span>"+v+"<span class='highlight'>"+y+"</span>"+w+"</span>"),p.length&&d.prepend(p),o++}var f,d,p,m,g,v,y,w;n=s}}),r.off("keydown.autocomplete").on("keydown.autocomplete",function(t){var e,n=t.which,r=c.children("li").length,i=c.children(".active").first();13===n&&a>=0?(e=c.children("li").eq(a)).length&&(e.trigger("mousedown.autocomplete"),t.preventDefault()):38!==n&&40!==n||(t.preventDefault(),38===n&&a>0&&a--,40===n&&a<r-1&&a++,i.removeClass("active"),a>=0&&c.children("li").eq(a).addClass("active"))}),c.off("mousedown.autocomplete touchstart.autocomplete").on("mousedown.autocomplete touchstart.autocomplete","li",function(){var n=t(this).text().trim();r.val(n),r.trigger("change"),l(),"function"==typeof e.onAutocomplete&&e.onAutocomplete.call(this,n)})}})}}),t.fn.material_select=function(e){function n(t,e,n){var r=t.indexOf(e),i=-1===r;return i?t.push(e):t.splice(r,1),n.siblings("ul.dropdown-content").find("li:not(.optgroup)").eq(e).toggleClass("active"),n.find("option").eq(e).prop("selected",i),function(t,e){for(var n="",r=0,i=t.length;r<i;r++){var o=e.find("option").eq(t[r]).text();n+=0===r?o:", "+o}""===n&&(n=e.find("option:disabled").eq(0).text()),e.siblings("input.select-dropdown").val(n)}(t,n),i}t(this).each(function(){var r=t(this);if(!r.hasClass("browser-default")){var i=!!r.attr("multiple"),o=r.attr("data-select-id");if(o&&(r.parent().find("span.caret").remove(),r.parent().find("input").remove(),r.unwrap(),t("ul#select-options-"+o).remove()),"destroy"===e)return r.removeAttr("data-select-id").removeClass("initialized"),void t(window).off("click.select");var a=Materialize.guid();r.attr("data-select-id",a);var s=t('<div class="select-wrapper"></div>');s.addClass(r.attr("class")),r.is(":disabled")&&s.addClass("disabled");var u=t('<ul id="select-options-'+a+'" class="dropdown-content select-dropdown '+(i?"multiple-select-dropdown":"")+'"></ul>'),c=r.children("option, optgroup"),l=[],h=!1,f=r.find("option:selected").html()||r.find("option:first").html()||"",d=function(e,n,r){var o=n.is(":disabled")?"disabled ":"",a="optgroup-option"===r?"optgroup-option ":"",s=i?'<input type="checkbox"'+o+"/><label></label>":"",c=n.data("icon"),l=n.attr("class");if(c){var h="";return l&&(h=' class="'+l+'"'),u.append(t('<li class="'+o+a+'"><img alt="" src="'+c+'"'+h+"><span>"+s+n.html()+"</span></li>")),!0}u.append(t('<li class="'+o+a+'"><span>'+s+n.html()+"</span></li>"))};c.length&&c.each(function(){if(t(this).is("option"))i?d(0,t(this),"multiple"):d(0,t(this));else if(t(this).is("optgroup")){var e=t(this).children("option");u.append(t('<li class="optgroup"><span>'+t(this).attr("label")+"</span></li>")),e.each(function(){d(0,t(this),"optgroup-option")})}}),u.find("li:not(.optgroup)").each(function(o){t(this).click(function(a){if(!t(this).hasClass("disabled")&&!t(this).hasClass("optgroup")){var s=!0;i?(t('input[type="checkbox"]',this).prop("checked",function(t,e){return!e}),s=n(l,o,r),g.trigger("focus")):(u.find("li").removeClass("active"),t(this).toggleClass("active"),g.val(t(this).text())),v(u,t(this)),r.find("option").eq(o).prop("selected",s),r.trigger("change"),"undefined"!=typeof e&&e()}a.stopPropagation()})}),r.wrap(s);var p=t('<span class="caret">&#9660;</span>'),m=f.replace(/"/g,"&quot;"),g=t('<input type="text" class="select-dropdown" readonly="true" '+(r.is(":disabled")?"disabled":"")+' data-activates="select-options-'+a+'" value="'+m+'"/>');r.before(g),g.before(p),g.after(u),r.is(":disabled")||g.dropdown({hover:!1}),r.attr("tabindex")&&t(g[0]).attr("tabindex",r.attr("tabindex")),r.addClass("initialized"),g.on({focus:function(){if(t("ul.select-dropdown").not(u[0]).is(":visible")&&(t("input.select-dropdown").trigger("close"),t(window).off("click.select")),!u.is(":visible")){t(this).trigger("open",["focus"]);var e=t(this).val();i&&e.indexOf(",")>=0&&(e=e.split(",")[0]);var n=u.find("li").filter(function(){return t(this).text().toLowerCase()===e.toLowerCase()})[0];v(u,n,!0),t(window).off("click.select").on("click.select",function(){i&&(h||g.trigger("close")),t(window).off("click.select")})}},click:function(t){t.stopPropagation()}}),g.on("blur",function(){i||(t(this).trigger("close"),t(window).off("click.select")),u.find("li.selected").removeClass("selected")}),u.hover(function(){h=!0},function(){h=!1}),i&&r.find("option:selected:not(:disabled)").each(function(){var t=this.index;n(l,t,r),u.find("li:not(.optgroup)").eq(t).find(":checkbox").prop("checked",!0)});var v=function(e,n,r){if(n){e.find("li.selected").removeClass("selected");var o=t(n);o.addClass("selected"),i&&!r||u.scrollTo(o)}},y=[];g.on("keydown",function(e){if(9!=e.which)if(40!=e.which||u.is(":visible")){if(13!=e.which||u.is(":visible")){e.preventDefault();var n=String.fromCharCode(e.which).toLowerCase();if(n&&-1===[9,13,27,38,40].indexOf(e.which)){y.push(n);var r=y.join(""),o=u.find("li").filter(function(){return 0===t(this).text().toLowerCase().indexOf(r)})[0];o&&v(u,o)}if(13==e.which){var a=u.find("li.selected:not(.disabled)")[0];a&&(t(a).trigger("click"),i||g.trigger("close"))}40==e.which&&(o=u.find("li.selected").length?u.find("li.selected").next("li:not(.disabled)")[0]:u.find("li:not(.disabled)")[0],v(u,o)),27==e.which&&g.trigger("close"),38==e.which&&(o=u.find("li.selected").prev("li:not(.disabled)")[0])&&v(u,o),setTimeout(function(){y=[]},1e3)}}else g.trigger("open");else g.trigger("close")})}})}}(jQuery),function(t){var e={init:function(e){return e=t.extend({indicators:!0,height:400,transition:500,interval:6e3},e),this.each(function(){var n,r,i,o=t(this),a=o.find("ul.slides").first(),s=a.find("> li"),u=a.find(".active").index();function c(t,e){t.hasClass("center-align")?t.velocity({opacity:0,translateY:-100},{duration:e,queue:!1}):t.hasClass("right-align")?t.velocity({opacity:0,translateX:100},{duration:e,queue:!1}):t.hasClass("left-align")&&t.velocity({opacity:0,translateX:-100},{duration:e,queue:!1})}function l(t){t>=s.length?t=0:t<0&&(t=s.length-1),(u=a.find(".active").index())!=t&&(n=s.eq(u),$caption=n.find(".caption"),n.removeClass("active"),n.velocity({opacity:0},{duration:e.transition,queue:!1,easing:"easeOutQuad",complete:function(){s.not(".active").velocity({opacity:0,translateX:0,translateY:0},{duration:0,queue:!1})}}),c($caption,e.transition),e.indicators&&r.eq(u).removeClass("active"),s.eq(t).velocity({opacity:1},{duration:e.transition,queue:!1,easing:"easeOutQuad"}),s.eq(t).find(".caption").velocity({opacity:1,translateX:0,translateY:0},{duration:e.transition,delay:e.transition,queue:!1,easing:"easeOutQuad"}),s.eq(t).addClass("active"),e.indicators&&r.eq(t).addClass("active"))}-1!=u&&(n=s.eq(u)),o.hasClass("fullscreen")||(o.height(e.indicators?e.height+40:e.height),a.height(e.height)),s.find(".caption").each(function(){c(t(this),0)}),s.find("img").each(function(){var e="data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";t(this).attr("src")!==e&&(t(this).css("background-image",'url("'+t(this).attr("src")+'")'),t(this).attr("src",e))}),e.indicators&&(r=t('<ul class="indicators"></ul>'),s.each(function(n){var o=t('<li class="indicator-item"></li>');o.click(function(){l(a.parent().find(t(this)).index()),clearInterval(i),i=setInterval(function(){u=a.find(".active").index(),s.length==u+1?u=0:u+=1,l(u)},e.transition+e.interval)}),r.append(o)}),o.append(r),r=o.find("ul.indicators").find("li.indicator-item")),n?n.show():(s.first().addClass("active").velocity({opacity:1},{duration:e.transition,queue:!1,easing:"easeOutQuad"}),n=s.eq(u=0),e.indicators&&r.eq(u).addClass("active")),n.find("img").each(function(){n.find(".caption").velocity({opacity:1,translateX:0,translateY:0},{duration:e.transition,queue:!1,easing:"easeOutQuad"})}),i=setInterval(function(){l((u=a.find(".active").index())+1)},e.transition+e.interval);var h=!1,f=!1;o.hammer({prevent_default:!1}).on("pan",function(t){if("touch"===t.gesture.pointerType){clearInterval(i);var e,n=t.gesture.direction,r=t.gesture.deltaX,u=t.gesture.velocityX,c=t.gesture.velocityY;$curr_slide=a.find(".active"),Math.abs(u)>Math.abs(c)&&$curr_slide.velocity({translateX:r},{duration:50,queue:!1,easing:"easeOutQuad"}),4===n&&(r>o.innerWidth()/2||u<-.65)?f=!0:2===n&&(r<-1*o.innerWidth()/2||u>.65)&&(h=!0),h&&(0===(e=$curr_slide.next()).length&&(e=s.first()),e.velocity({opacity:1},{duration:300,queue:!1,easing:"easeOutQuad"})),f&&(0===(e=$curr_slide.prev()).length&&(e=s.last()),e.velocity({opacity:1},{duration:300,queue:!1,easing:"easeOutQuad"}))}}).on("panend",function(t){"touch"===t.gesture.pointerType&&($curr_slide=a.find(".active"),curr_index=a.find(".active").index(),!f&&!h||s.length<=1?$curr_slide.velocity({translateX:0},{duration:300,queue:!1,easing:"easeOutQuad"}):h?(l(curr_index+1),$curr_slide.velocity({translateX:-1*o.innerWidth()},{duration:300,queue:!1,easing:"easeOutQuad",complete:function(){$curr_slide.velocity({opacity:0,translateX:0},{duration:0,queue:!1})}})):f&&(l(curr_index-1),$curr_slide.velocity({translateX:o.innerWidth()},{duration:300,queue:!1,easing:"easeOutQuad",complete:function(){$curr_slide.velocity({opacity:0,translateX:0},{duration:0,queue:!1})}})),h=!1,f=!1,clearInterval(i),i=setInterval(function(){u=a.find(".active").index(),s.length==u+1?u=0:u+=1,l(u)},e.transition+e.interval))}),o.on("sliderPause",function(){clearInterval(i)}),o.on("sliderStart",function(){clearInterval(i),i=setInterval(function(){u=a.find(".active").index(),s.length==u+1?u=0:u+=1,l(u)},e.transition+e.interval)}),o.on("sliderNext",function(){l((u=a.find(".active").index())+1)}),o.on("sliderPrev",function(){l((u=a.find(".active").index())-1)})})},pause:function(){t(this).trigger("sliderPause")},start:function(){t(this).trigger("sliderStart")},next:function(){t(this).trigger("sliderNext")},prev:function(){t(this).trigger("sliderPrev")}};t.fn.slider=function(n){return e[n]?e[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?void t.error("Method "+n+" does not exist on jQuery.tooltip"):e.init.apply(this,arguments)}}(jQuery),function(t){t(document).ready(function(){t(document).on("click.card",".card",function(e){if(t(this).find("> .card-reveal").length){var n=t(e.target).closest(".card");void 0===n.data("initialOverflow")&&n.data("initialOverflow",void 0===n.css("overflow")?"":n.css("overflow")),t(e.target).is(t(".card-reveal .card-title"))||t(e.target).is(t(".card-reveal .card-title i"))?t(this).find(".card-reveal").velocity({translateY:0},{duration:225,queue:!1,easing:"easeInOutQuad",complete:function(){t(this).css({display:"none"}),n.css("overflow",n.data("initialOverflow"))}}):(t(e.target).is(t(".card .activator"))||t(e.target).is(t(".card .activator i")))&&(n.css("overflow","hidden"),t(this).find(".card-reveal").css({display:"block"}).velocity("stop",!1).velocity({translateY:"-100%"},{duration:300,queue:!1,easing:"easeInOutQuad"}))}})})}(jQuery),function(t){var e={data:[],placeholder:"",secondaryPlaceholder:"",autocompleteOptions:{}};t(document).ready(function(){t(document).on("click",".chip .close",function(e){t(this).closest(".chips").attr("data-initialized")||t(this).closest(".chip").remove()})}),t.fn.material_chip=function(n){var r=this;if(this.$el=t(this),this.$document=t(document),this.SELS={CHIPS:".chips",CHIP:".chip",INPUT:"input",DELETE:".material-icons",SELECTED_CHIP:".selected"},"data"===n)return this.$el.data("chips");var i=t.extend({},e,n);r.hasAutocomplete=!t.isEmptyObject(i.autocompleteOptions.data),this.init=function(){var e=0;r.$el.each(function(){var n=t(this),o=Materialize.guid();r.chipId=o,i.data&&i.data instanceof Array||(i.data=[]),n.data("chips",i.data),n.attr("data-index",e),n.attr("data-initialized",!0),n.hasClass(r.SELS.CHIPS)||n.addClass("chips"),r.chips(n,o),e++})},this.handleEvents=function(){var e=r.SELS;r.$document.off("click.chips-focus",e.CHIPS).on("click.chips-focus",e.CHIPS,function(n){t(n.target).find(e.INPUT).focus()}),r.$document.off("click.chips-select",e.CHIP).on("click.chips-select",e.CHIP,function(n){var i=t(n.target);if(i.length){var o=i.hasClass("selected"),a=i.closest(e.CHIPS);t(e.CHIP).removeClass("selected"),o||r.selectChip(i.index(),a)}}),r.$document.off("keydown.chips").on("keydown.chips",function(n){if(!t(n.target).is("input, textarea")){var i,o=r.$document.find(e.CHIP+e.SELECTED_CHIP),a=o.closest(e.CHIPS),s=o.siblings(e.CHIP).length;if(o.length)if(8===n.which||46===n.which){n.preventDefault(),i=o.index(),r.deleteChip(i,a);var u=null;i+1<s?u=i:i!==s&&i+1!==s||(u=s-1),u<0&&(u=null),null!==u&&r.selectChip(u,a),s||a.find("input").focus()}else if(37===n.which){if((i=o.index()-1)<0)return;t(e.CHIP).removeClass("selected"),r.selectChip(i,a)}else if(39===n.which){if(i=o.index()+1,t(e.CHIP).removeClass("selected"),i>s)return void a.find("input").focus();r.selectChip(i,a)}}}),r.$document.off("focusin.chips",e.CHIPS+" "+e.INPUT).on("focusin.chips",e.CHIPS+" "+e.INPUT,function(n){var r=t(n.target).closest(e.CHIPS);r.addClass("focus"),r.siblings("label, .prefix").addClass("active"),t(e.CHIP).removeClass("selected")}),r.$document.off("focusout.chips",e.CHIPS+" "+e.INPUT).on("focusout.chips",e.CHIPS+" "+e.INPUT,function(n){var r=t(n.target).closest(e.CHIPS);r.removeClass("focus"),void 0!==r.data("chips")&&r.data("chips").length||r.siblings("label").removeClass("active"),r.siblings(".prefix").removeClass("active")}),r.$document.off("keydown.chips-add",e.CHIPS+" "+e.INPUT).on("keydown.chips-add",e.CHIPS+" "+e.INPUT,function(n){var i=t(n.target),o=i.closest(e.CHIPS),a=o.children(e.CHIP).length;if(13===n.which){if(r.hasAutocomplete&&o.find(".autocomplete-content.dropdown-content").length&&o.find(".autocomplete-content.dropdown-content").children().length)return;return n.preventDefault(),r.addChip({tag:i.val()},o),void i.val("")}if((8===n.keyCode||37===n.keyCode)&&""===i.val()&&a)return n.preventDefault(),r.selectChip(a-1,o),void i.blur()}),r.$document.off("click.chips-delete",e.CHIPS+" "+e.DELETE).on("click.chips-delete",e.CHIPS+" "+e.DELETE,function(n){var i=t(n.target),o=i.closest(e.CHIPS),a=i.closest(e.CHIP);n.stopPropagation(),r.deleteChip(a.index(),o),o.find("input").focus()})},this.chips=function(e,n){e.empty(),e.data("chips").forEach(function(t){e.append(r.renderChip(t))}),e.append(t('<input id="'+n+'" class="input" placeholder="">')),r.setPlaceholder(e);var o=e.next("label");o.length&&(o.attr("for",n),void 0!==e.data("chips")&&e.data("chips").length&&o.addClass("active"));var a=t("#"+n);r.hasAutocomplete&&(i.autocompleteOptions.onAutocomplete=function(t){r.addChip({tag:t},e),a.val(""),a.focus()},a.autocomplete(i.autocompleteOptions))},this.renderChip=function(e){if(e.tag){var n=t('<div class="chip"></div>');return n.text(e.tag),e.image&&n.prepend(t("<img />").attr("src",e.image)),n.append(t('<i class="material-icons close">close</i>')),n}},this.setPlaceholder=function(t){void 0!==t.data("chips")&&!t.data("chips").length&&i.placeholder?t.find("input").prop("placeholder",i.placeholder):(void 0===t.data("chips")||t.data("chips").length)&&i.secondaryPlaceholder&&t.find("input").prop("placeholder",i.secondaryPlaceholder)},this.isValid=function(t,e){for(var n=t.data("chips"),r=!1,i=0;i<n.length;i++)if(n[i].tag===e.tag)return void(r=!0);return""!==e.tag&&!r},this.addChip=function(t,e){if(r.isValid(e,t)){for(var n=r.renderChip(t),i=[],o=e.data("chips"),a=0;a<o.length;a++)i.push(o[a]);i.push(t),e.data("chips",i),n.insertBefore(e.find("input")),e.trigger("chip.add",t),r.setPlaceholder(e)}},this.deleteChip=function(t,e){var n=e.data("chips")[t];e.find(".chip").eq(t).remove();for(var i=[],o=e.data("chips"),a=0;a<o.length;a++)a!==t&&i.push(o[a]);e.data("chips",i),e.trigger("chip.delete",n),r.setPlaceholder(e)},this.selectChip=function(t,e){var n=e.find(".chip").eq(t);n&&!1===n.hasClass("selected")&&(n.addClass("selected"),e.trigger("chip.select",e.data("chips")[t]))},this.getChipsElement=function(t,e){return e.eq(t)},this.init(),this.handleEvents()}}(jQuery),function(t){t.fn.pushpin=function(e){return"remove"===e?(this.each(function(){(id=t(this).data("pushpin-id"))&&(t(window).off("scroll."+id),t(this).removeData("pushpin-id").removeClass("pin-top pinned pin-bottom").removeAttr("style"))}),!1):(e=t.extend({top:0,bottom:1/0,offset:0},e),$index=0,this.each(function(){var n=Materialize.guid(),r=t(this),i=t(this).offset().top;function o(t){t.removeClass("pin-top"),t.removeClass("pinned"),t.removeClass("pin-bottom")}function a(n,r){n.each(function(){e.top<=r&&e.bottom>=r&&!t(this).hasClass("pinned")&&(o(t(this)),t(this).css("top",e.offset),t(this).addClass("pinned")),r<e.top&&!t(this).hasClass("pin-top")&&(o(t(this)),t(this).css("top",0),t(this).addClass("pin-top")),r>e.bottom&&!t(this).hasClass("pin-bottom")&&(o(t(this)),t(this).addClass("pin-bottom"),t(this).css("top",e.bottom-i))})}t(this).data("pushpin-id",n),a(r,t(window).scrollTop()),t(window).on("scroll."+n,function(){var n=t(window).scrollTop()+e.offset;a(r,n)})}))}}(jQuery),function(t){t(document).ready(function(){t.fn.reverse=[].reverse,t(document).on("mouseenter.fixedActionBtn",".fixed-action-btn:not(.click-to-toggle):not(.toolbar)",function(n){var r=t(this);e(r)}),t(document).on("mouseleave.fixedActionBtn",".fixed-action-btn:not(.click-to-toggle):not(.toolbar)",function(e){var r=t(this);n(r)}),t(document).on("click.fabClickToggle",".fixed-action-btn.click-to-toggle > a",function(r){var i=t(this).parent();i.hasClass("active")?n(i):e(i)}),t(document).on("click.fabToolbar",".fixed-action-btn.toolbar > a",function(e){var n=t(this).parent();r(n)})}),t.fn.extend({openFAB:function(){e(t(this))},closeFAB:function(){n(t(this))},openToolbar:function(){r(t(this))},closeToolbar:function(){i(t(this))}});var e=function(e){var n=e;if(!1===n.hasClass("active")){var r,i;!0===n.hasClass("horizontal")?i=40:r=40,n.addClass("active"),n.find("ul .btn-floating").velocity({scaleY:".4",scaleX:".4",translateY:r+"px",translateX:i+"px"},{duration:0});var o=0;n.find("ul .btn-floating").reverse().each(function(){t(this).velocity({opacity:"1",scaleX:"1",scaleY:"1",translateY:"0",translateX:"0"},{duration:80,delay:o}),o+=40})}},n=function(t){var e,n,r=t;!0===r.hasClass("horizontal")?n=40:e=40,r.removeClass("active"),r.find("ul .btn-floating").velocity("stop",!0),r.find("ul .btn-floating").velocity({opacity:"0",scaleX:".4",scaleY:".4",translateY:e+"px",translateX:n+"px"},{duration:80})},r=function(e){if("true"!==e.attr("data-open")){var n,r,o,a=window.innerWidth,s=window.innerHeight,u=e[0].getBoundingClientRect(),c=e.find("> a").first(),l=e.find("> ul").first(),h=t('<div class="fab-backdrop"></div>'),f=c.css("background-color");c.append(h),n=u.left-a/2+u.width/2,r=s-u.bottom,o=a/h.width(),e.attr("data-origin-bottom",u.bottom),e.attr("data-origin-left",u.left),e.attr("data-origin-width",u.width),e.addClass("active"),e.attr("data-open",!0),e.css({"text-align":"center",width:"100%",bottom:0,left:0,transform:"translateX("+n+"px)",transition:"none"}),c.css({transform:"translateY("+-r+"px)",transition:"none"}),h.css({"background-color":f}),setTimeout(function(){e.css({transform:"",transition:"transform .2s cubic-bezier(0.550, 0.085, 0.680, 0.530), background-color 0s linear .2s"}),c.css({overflow:"visible",transform:"",transition:"transform .2s"}),setTimeout(function(){e.css({overflow:"hidden","background-color":f}),h.css({transform:"scale("+o+")",transition:"transform .2s cubic-bezier(0.550, 0.055, 0.675, 0.190)"}),l.find("> li > a").css({opacity:1}),t(window).on("scroll.fabToolbarClose",function(){i(e),t(window).off("scroll.fabToolbarClose"),t(document).off("click.fabToolbarClose")}),t(document).on("click.fabToolbarClose",function(n){t(n.target).closest(l).length||(i(e),t(window).off("scroll.fabToolbarClose"),t(document).off("click.fabToolbarClose"))})},100)},0)}},i=function(t){if("true"===t.attr("data-open")){var e,n,r=window.innerWidth,i=window.innerHeight,o=t.attr("data-origin-width"),a=t.attr("data-origin-bottom"),s=t.attr("data-origin-left"),u=t.find("> .btn-floating").first(),c=t.find("> ul").first(),l=t.find(".fab-backdrop"),h=u.css("background-color");e=s-r/2+o/2,n=i-a,l.width(),t.removeClass("active"),t.attr("data-open",!1),t.css({"background-color":"transparent",transition:"none"}),u.css({transition:"none"}),l.css({transform:"scale(0)","background-color":h}),c.find("> li > a").css({opacity:""}),setTimeout(function(){l.remove(),t.css({"text-align":"",width:"",bottom:"",left:"",overflow:"","background-color":"",transform:"translate3d("+-e+"px,0,0)"}),u.css({overflow:"",transform:"translate3d(0,"+n+"px,0)"}),setTimeout(function(){t.css({transform:"translate3d(0,0,0)",transition:"transform .2s"}),u.css({transform:"translate3d(0,0,0)",transition:"transform .2s cubic-bezier(0.550, 0.055, 0.675, 0.190)"})},20)},200)}}}(jQuery),function(t){Materialize.fadeInImage=function(e){var n;if("string"==typeof e)n=t(e);else{if("object"!=typeof e)return;n=e}n.css({opacity:0}),t(n).velocity({opacity:1},{duration:650,queue:!1,easing:"easeOutSine"}),t(n).velocity({opacity:1},{duration:1300,queue:!1,easing:"swing",step:function(e,n){n.start=100;var r=e/100,i=150-(100-e)/1.75;i<100&&(i=100),e>=0&&t(this).css({"-webkit-filter":"grayscale("+r+")brightness("+i+"%)",filter:"grayscale("+r+")brightness("+i+"%)"})}})},Materialize.showStaggeredList=function(e){var n;if("string"==typeof e)n=t(e);else{if("object"!=typeof e)return;n=e}var r=0;n.find("li").velocity({translateX:"-100px"},{duration:0}),n.find("li").each(function(){t(this).velocity({opacity:"1",translateX:"0"},{duration:800,delay:r,easing:[60,10]}),r+=120})},t(document).ready(function(){var e=!1,n=!1;t(".dismissable").each(function(){t(this).hammer({prevent_default:!1}).on("pan",function(r){if("touch"===r.gesture.pointerType){var i=t(this),o=r.gesture.direction,a=r.gesture.deltaX,s=r.gesture.velocityX;i.velocity({translateX:a},{duration:50,queue:!1,easing:"easeOutQuad"}),4===o&&(a>i.innerWidth()/2||s<-.75)&&(e=!0),2===o&&(a<-1*i.innerWidth()/2||s>.75)&&(n=!0)}}).on("panend",function(r){if(Math.abs(r.gesture.deltaX)<t(this).innerWidth()/2&&(n=!1,e=!1),"touch"===r.gesture.pointerType){var i,o=t(this);e||n?(i=e?o.innerWidth():-1*o.innerWidth(),o.velocity({translateX:i},{duration:100,queue:!1,easing:"easeOutQuad",complete:function(){o.css("border","none"),o.velocity({height:0,padding:0},{duration:200,queue:!1,easing:"easeOutQuad",complete:function(){o.remove()}})}})):o.velocity({translateX:0},{duration:100,queue:!1,easing:"easeOutQuad"}),e=!1,n=!1}})})})}(jQuery),function(t){var e=!1;Materialize.scrollFire=function(t){var n=Materialize.throttle(function(){!function(){for(var e=window.pageYOffset+window.innerHeight,n=0;n<t.length;n++){var r=t[n],i=r.offset,o=r.callback,a=document.querySelector(r.selector);null!==a&&e>a.getBoundingClientRect().top+window.pageYOffset+i&&!0!==r.done&&("function"==typeof o?o.call(this,a):"string"==typeof o&&new Function(o)(a),r.done=!0)}}()},t.throttle||100);e||(window.addEventListener("scroll",n),window.addEventListener("resize",n),e=!0),setTimeout(n,0)}}(jQuery),Materialize.Picker=function(t){var e=t(window),n=t(document),r=t(document.documentElement);function i(e,s,c,l){if(!e)return i;var h=!1,f={id:e.id||"P"+Math.abs(~~(Math.random()*new Date))},d=c?t.extend(!0,{},c.defaults,l):l||{},p=t.extend({},i.klasses(),d.klass),m=t(e),g=function(){return this.start()},v=g.prototype={constructor:g,$node:m,start:function(){return f&&f.start?v:(f.methods={},f.start=!0,f.open=!1,f.type=e.type,e.autofocus=e==u(),e.readOnly=!d.editable,e.id=e.id||f.id,"text"!=e.type&&(e.type="text"),v.component=new c(v,d),v.$root=t(i._.node("div",y(),p.picker,'id="'+e.id+'_root" tabindex="0"')),v.$root.on({keydown:w,focusin:function(t){v.$root.removeClass(p.focused),t.stopPropagation()},"mousedown click":function(e){var n=e.target;n!=v.$root.children()[0]&&(e.stopPropagation(),"mousedown"!=e.type||t(n).is("input, select, textarea, button, option")||(e.preventDefault(),v.$root.eq(0).focus()))}}).on({focus:function(){m.addClass(p.target)},blur:function(){m.removeClass(p.target)}}).on("focus.toOpen",b).on("click","[data-pick], [data-nav], [data-clear], [data-close]",function(){var e=t(this),n=e.data(),r=e.hasClass(p.navDisabled)||e.hasClass(p.disabled),i=u();i=i&&(i.type||i.href)&&i,(r||i&&!t.contains(v.$root[0],i))&&v.$root.eq(0).focus(),!r&&n.nav?v.set("highlight",v.component.item.highlight,{nav:n.nav}):!r&&"pick"in n?(v.set("select",n.pick),d.closeOnSelect&&v.close(!0)):n.clear?(v.clear(),d.closeOnSelect&&v.close(!0)):n.close&&v.close(!0)}),a(v.$root[0],"hidden",!0),d.formatSubmit&&(!0===d.hiddenName?(o=e.name,e.name=""):o=(o=["string"==typeof d.hiddenPrefix?d.hiddenPrefix:"","string"==typeof d.hiddenSuffix?d.hiddenSuffix:"_submit"])[0]+e.name+o[1],v._hidden=t('<input type=hidden name="'+o+'"'+(m.data("value")||e.value?' value="'+v.get("select",d.formatSubmit)+'"':"")+">")[0],m.on("change."+f.id,function(){v._hidden.value=e.value?v.get("select",d.formatSubmit):""}),d.container?t(d.container).append(v._hidden):m.before(v._hidden)),m.data(s,v).addClass(p.input).attr("tabindex",-1).val(m.data("value")?v.get("select",d.format):e.value),d.editable||m.on("focus."+f.id+" click."+f.id,function(t){t.preventDefault(),v.$root.eq(0).focus()}).on("keydown."+f.id,w),a(e,{haspopup:!0,expanded:!1,readonly:!1,owns:e.id+"_root"}),d.container?t(d.container).append(v.$root):m.before(v.$root),v.on({start:v.component.onStart,render:v.component.onRender,stop:v.component.onStop,open:v.component.onOpen,close:v.component.onClose,set:v.component.onSet}).on({start:d.onStart,render:d.onRender,stop:d.onStop,open:d.onOpen,close:d.onClose,set:d.onSet}),(n=v.$root.children()[0]).currentStyle?r=n.currentStyle.position:window.getComputedStyle&&(r=getComputedStyle(n).position),h="fixed"==r,e.autofocus&&v.open(),v.trigger("start").trigger("render"));var n,r,o},render:function(t){return t?v.$root.html(y()):v.$root.find("."+p.box).html(v.component.nodes(f.open)),v.trigger("render")},stop:function(){return f.start?(v.close(),v._hidden&&v._hidden.parentNode.removeChild(v._hidden),v.$root.remove(),m.removeClass(p.input).removeData(s),setTimeout(function(){m.off("."+f.id)},0),e.type=f.type,e.readOnly=!1,v.trigger("stop"),f.methods={},f.start=!1,v):v},open:function(s){return f.open?v:(m.addClass(p.active),a(e,"expanded",!0),setTimeout(function(){v.$root.addClass(p.opened),a(v.$root[0],"hidden",!1)},0),!1!==s&&(f.open=!0,h&&r.css("overflow","hidden").css("padding-right","+="+o()),v.$root.eq(0).focus(),n.on("click."+f.id+" focusin."+f.id,function(t){var n=t.target;n!=e&&n!=document&&3!=t.which&&v.close(n===v.$root.children()[0])}).on("keydown."+f.id,function(e){var n=e.keyCode,r=v.component.key[n],o=e.target;27==n?v.close(!0):o!=v.$root[0]||!r&&13!=n?t.contains(v.$root[0],o)&&13==n&&(e.preventDefault(),o.click()):(e.preventDefault(),r?i._.trigger(v.component.key.go,v,[i._.trigger(r)]):v.$root.find("."+p.highlighted).hasClass(p.disabled)||(v.set("select",v.component.item.highlight),d.closeOnSelect&&v.close(!0)))})),v.trigger("open"))},close:function(t){return t&&(v.$root.off("focus.toOpen").eq(0).focus(),setTimeout(function(){v.$root.on("focus.toOpen",b)},0)),m.removeClass(p.active),a(e,"expanded",!1),setTimeout(function(){v.$root.removeClass(p.opened+" "+p.focused),a(v.$root[0],"hidden",!0)},0),f.open?(f.open=!1,h&&r.css("overflow","").css("padding-right","-="+o()),n.off("."+f.id),v.trigger("close")):v},clear:function(t){return v.set("clear",null,t)},set:function(e,n,r){var i,o,a=t.isPlainObject(e),s=a?e:{};if(r=a&&t.isPlainObject(n)?n:r||{},e){for(i in a||(s[e]=n),s)o=s[i],i in v.component.item&&(void 0===o&&(o=null),v.component.set(i,o,r)),"select"!=i&&"clear"!=i||m.val("clear"==i?"":v.get(i,d.format)).trigger("change");v.render()}return r.muted?v:v.trigger("set",s)},get:function(t,n){if(null!=f[t=t||"value"])return f[t];if("valueSubmit"==t){if(v._hidden)return v._hidden.value;t="value"}if("value"==t)return e.value;if(t in v.component.item){if("string"==typeof n){var r=v.component.get(t);return r?i._.trigger(v.component.formats.toString,v.component,[n,r]):""}return v.component.get(t)}},on:function(e,n,r){var i,o,a=t.isPlainObject(e),s=a?e:{};if(e)for(i in a||(s[e]=n),s)o=s[i],r&&(i="_"+i),f.methods[i]=f.methods[i]||[],f.methods[i].push(o);return v},off:function(){var t,e,n=arguments;for(t=0,namesCount=n.length;t<namesCount;t+=1)(e=n[t])in f.methods&&delete f.methods[e];return v},trigger:function(t,e){var n=function(t){var n=f.methods[t];n&&n.map(function(t){i._.trigger(t,v,[e])})};return n("_"+t),n(t),v}};function y(){return i._.node("div",i._.node("div",i._.node("div",i._.node("div",v.component.nodes(f.open),p.box),p.wrap),p.frame),p.holder)}function w(t){var e=t.keyCode,n=/^(8|46)$/.test(e);if(27==e)return v.close(),!1;(32==e||n||!f.open&&v.component.key[e])&&(t.preventDefault(),t.stopPropagation(),n?v.clear().close():v.open())}function b(t){t.stopPropagation(),"focus"==t.type&&v.$root.addClass(p.focused),v.open()}return new g}function o(){if(r.height()<=e.height())return 0;var n=t('<div style="visibility:hidden;width:100px" />').appendTo("body"),i=n[0].offsetWidth;n.css("overflow","scroll");var o=t('<div style="width:100%" />').appendTo(n)[0].offsetWidth;return n.remove(),i-o}function a(e,n,r){if(t.isPlainObject(n))for(var i in n)s(e,i,n[i]);else s(e,n,r)}function s(t,e,n){t.setAttribute(("role"==e?"":"aria-")+e,n)}function u(){try{return document.activeElement}catch(t){}}return i.klasses=function(t){return{picker:t=t||"picker",opened:t+"--opened",focused:t+"--focused",input:t+"__input",active:t+"__input--active",target:t+"__input--target",holder:t+"__holder",frame:t+"__frame",wrap:t+"__wrap",box:t+"__box"}},i._={group:function(t){for(var e,n="",r=i._.trigger(t.min,t);r<=i._.trigger(t.max,t,[r]);r+=t.i)e=i._.trigger(t.item,t,[r]),n+=i._.node(t.node,e[0],e[1],e[2]);return n},node:function(e,n,r,i){return n?(n=t.isArray(n)?n.join(""):n,"<"+e+(r=r?' class="'+r+'"':"")+(i=i?" "+i:"")+">"+n+"</"+e+">"):""},lead:function(t){return(t<10?"0":"")+t},trigger:function(t,e,n){return"function"==typeof t?t.apply(e,n||[]):t},digits:function(t){return/\d/.test(t[1])?2:1},isDate:function(t){return{}.toString.call(t).indexOf("Date")>-1&&this.isInteger(t.getDate())},isInteger:function(t){return{}.toString.call(t).indexOf("Number")>-1&&t%1==0},ariaAttr:function(e,n){for(var r in t.isPlainObject(e)||(e={attribute:n}),n="",e)n+=null==e[r]?"":("role"==r?"":"aria-")+r+'="'+e[r]+'"';return n}},i.extend=function(e,n){t.fn[e]=function(r,o){var a=this.data(e);return"picker"==r?a:a&&"string"==typeof r?i._.trigger(a[r],a,[o]):this.each(function(){t(this).data(e)||new i(this,e,n,r)})},t.fn[e].defaults=n.defaults},i}(jQuery),function(t,e){var n,r=t._;function i(t,e){var n,r=this,i=t.$node[0],o=i.value,a=t.$node.data("value"),s=a||o,u=a?e.formatSubmit:e.format,c=function(){return i.currentStyle?"rtl"==i.currentStyle.direction:"rtl"==getComputedStyle(t.$root[0]).direction};r.settings=e,r.$node=t.$node,r.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse navigate create validate",view:"parse create validate viewset",disable:"deactivate",enable:"activate"},r.item={},r.item.clear=null,r.item.disable=(e.disable||[]).slice(0),r.item.enable=-(!0===(n=r.item.disable)[0]?n.shift():-1),r.set("min",e.min).set("max",e.max).set("now"),s?r.set("select",s,{format:u}):r.set("select",null).set("highlight",r.item.now),r.key={40:7,38:-7,39:function(){return c()?-1:1},37:function(){return c()?1:-1},go:function(t){var e=r.item.highlight,n=new Date(e.year,e.month,e.date+t);r.set("highlight",n,{interval:t}),this.render()}},t.on("render",function(){t.$root.find("."+e.klass.selectMonth).on("change",function(){var n=this.value;n&&(t.set("highlight",[t.get("view").year,n,t.get("highlight").date]),t.$root.find("."+e.klass.selectMonth).trigger("focus"))}),t.$root.find("."+e.klass.selectYear).on("change",function(){var n=this.value;n&&(t.set("highlight",[n,t.get("view").month,t.get("highlight").date]),t.$root.find("."+e.klass.selectYear).trigger("focus"))})},1).on("open",function(){var n="";r.disabled(r.get("now"))&&(n=":not(."+e.klass.buttonToday+")"),t.$root.find("button"+n+", select").attr("disabled",!1)},1).on("close",function(){t.$root.find("button, select").attr("disabled",!0)},1)}i.prototype.set=function(t,e,n){var r=this,i=r.item;return null===e?("clear"==t&&(t="select"),i[t]=e,r):(i["enable"==t?"disable":"flip"==t?"enable":t]=r.queue[t].split(" ").map(function(i){return e=r[i](t,e,n)}).pop(),"select"==t?r.set("highlight",i.select,n):"highlight"==t?r.set("view",i.highlight,n):t.match(/^(flip|min|max|disable|enable)$/)&&(i.select&&r.disabled(i.select)&&r.set("select",i.select,n),i.highlight&&r.disabled(i.highlight)&&r.set("highlight",i.highlight,n)),r)},i.prototype.get=function(t){return this.item[t]},i.prototype.create=function(t,n,i){var o;return(n=void 0===n?t:n)==-1/0||n==1/0?o=n:e.isPlainObject(n)&&r.isInteger(n.pick)?n=n.obj:e.isArray(n)?(n=new Date(n[0],n[1],n[2]),n=r.isDate(n)?n:this.create().obj):n=r.isInteger(n)||r.isDate(n)?this.normalize(new Date(n),i):this.now(t,n,i),{year:o||n.getFullYear(),month:o||n.getMonth(),date:o||n.getDate(),day:o||n.getDay(),obj:o||n,pick:o||n.getTime()}},i.prototype.createRange=function(t,n){var i=this,o=function(t){return!0===t||e.isArray(t)||r.isDate(t)?i.create(t):t};return r.isInteger(t)||(t=o(t)),r.isInteger(n)||(n=o(n)),r.isInteger(t)&&e.isPlainObject(n)?t=[n.year,n.month,n.date+t]:r.isInteger(n)&&e.isPlainObject(t)&&(n=[t.year,t.month,t.date+n]),{from:o(t),to:o(n)}},i.prototype.withinRange=function(t,e){return t=this.createRange(t.from,t.to),e.pick>=t.from.pick&&e.pick<=t.to.pick},i.prototype.overlapRanges=function(t,e){return t=this.createRange(t.from,t.to),e=this.createRange(e.from,e.to),this.withinRange(t,e.from)||this.withinRange(t,e.to)||this.withinRange(e,t.from)||this.withinRange(e,t.to)},i.prototype.now=function(t,e,n){return e=new Date,n&&n.rel&&e.setDate(e.getDate()+n.rel),this.normalize(e,n)},i.prototype.navigate=function(t,n,r){var i,o,a,s,u=e.isArray(n),c=e.isPlainObject(n),l=this.item.view;if(u||c){for(c?(o=n.year,a=n.month,s=n.date):(o=+n[0],a=+n[1],s=+n[2]),r&&r.nav&&l&&l.month!==a&&(o=l.year,a=l.month),o=(i=new Date(o,a+(r&&r.nav?r.nav:0),1)).getFullYear(),a=i.getMonth();new Date(o,a,s).getMonth()!==a;)s-=1;n=[o,a,s]}return n},i.prototype.normalize=function(t){return t.setHours(0,0,0,0),t},i.prototype.measure=function(t,e){return e?"string"==typeof e?e=this.parse(t,e):r.isInteger(e)&&(e=this.now(t,e,{rel:e})):e="min"==t?-1/0:1/0,e},i.prototype.viewset=function(t,e){return this.create([e.year,e.month,1])},i.prototype.validate=function(t,n,i){var o,a,s,u,c=this,l=n,h=i&&i.interval?i.interval:1,f=-1===c.item.enable,d=c.item.min,p=c.item.max,m=f&&c.item.disable.filter(function(t){if(e.isArray(t)){var i=c.create(t).pick;i<n.pick?o=!0:i>n.pick&&(a=!0)}return r.isInteger(t)}).length;if((!i||!i.nav)&&(!f&&c.disabled(n)||f&&c.disabled(n)&&(m||o||a)||!f&&(n.pick<=d.pick||n.pick>=p.pick)))for(f&&!m&&(!a&&h>0||!o&&h<0)&&(h*=-1);c.disabled(n)&&(Math.abs(h)>1&&(n.month<l.month||n.month>l.month)&&(n=l,h=h>0?1:-1),n.pick<=d.pick?(s=!0,h=1,n=c.create([d.year,d.month,d.date+(n.pick===d.pick?0:-1)])):n.pick>=p.pick&&(u=!0,h=-1,n=c.create([p.year,p.month,p.date+(n.pick===p.pick?0:1)])),!s||!u);)n=c.create([n.year,n.month,n.date+h]);return n},i.prototype.disabled=function(t){var n=this,i=n.item.disable.filter(function(i){return r.isInteger(i)?t.day===(n.settings.firstDay?i:i-1)%7:e.isArray(i)||r.isDate(i)?t.pick===n.create(i).pick:e.isPlainObject(i)?n.withinRange(i,t):void 0});return i=i.length&&!i.filter(function(t){return e.isArray(t)&&"inverted"==t[3]||e.isPlainObject(t)&&t.inverted}).length,-1===n.item.enable?!i:i||t.pick<n.item.min.pick||t.pick>n.item.max.pick},i.prototype.parse=function(t,e,n){var i=this,o={};return e&&"string"==typeof e?(n&&n.format||((n=n||{}).format=i.settings.format),i.formats.toArray(n.format).map(function(t){var n=i.formats[t],a=n?r.trigger(n,i,[e,o]):t.replace(/^!/,"").length;n&&(o[t]=e.substr(0,a)),e=e.substr(a)}),[o.yyyy||o.yy,+(o.mm||o.m)-1,o.dd||o.d]):e},i.prototype.formats=function(){function t(t,e,n){var r=t.match(/\w+/)[0];return n.mm||n.m||(n.m=e.indexOf(r)+1),r.length}function e(t){return t.match(/\w+/)[0].length}return{d:function(t,e){return t?r.digits(t):e.date},dd:function(t,e){return t?2:r.lead(e.date)},ddd:function(t,n){return t?e(t):this.settings.weekdaysShort[n.day]},dddd:function(t,n){return t?e(t):this.settings.weekdaysFull[n.day]},m:function(t,e){return t?r.digits(t):e.month+1},mm:function(t,e){return t?2:r.lead(e.month+1)},mmm:function(e,n){var r=this.settings.monthsShort;return e?t(e,r,n):r[n.month]},mmmm:function(e,n){var r=this.settings.monthsFull;return e?t(e,r,n):r[n.month]},yy:function(t,e){return t?2:(""+e.year).slice(2)},yyyy:function(t,e){return t?4:e.year},toArray:function(t){return t.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(t,e){var n=this;return n.formats.toArray(t).map(function(t){return r.trigger(n.formats[t],n,[0,e])||t.replace(/^!/,"")}).join("")}}}(),i.prototype.isDateExact=function(t,n){return r.isInteger(t)&&r.isInteger(n)||"boolean"==typeof t&&"boolean"==typeof n?t===n:(r.isDate(t)||e.isArray(t))&&(r.isDate(n)||e.isArray(n))?this.create(t).pick===this.create(n).pick:!(!e.isPlainObject(t)||!e.isPlainObject(n))&&this.isDateExact(t.from,n.from)&&this.isDateExact(t.to,n.to)},i.prototype.isDateOverlap=function(t,n){var i=this.settings.firstDay?1:0;return r.isInteger(t)&&(r.isDate(n)||e.isArray(n))?(t=t%7+i)===this.create(n).day+1:r.isInteger(n)&&(r.isDate(t)||e.isArray(t))?(n=n%7+i)===this.create(t).day+1:!(!e.isPlainObject(t)||!e.isPlainObject(n))&&this.overlapRanges(t,n)},i.prototype.flipEnable=function(t){var e=this.item;e.enable=t||(-1==e.enable?1:-1)},i.prototype.deactivate=function(t,n){var i=this,o=i.item.disable.slice(0);return"flip"==n?i.flipEnable():!1===n?(i.flipEnable(1),o=[]):!0===n?(i.flipEnable(-1),o=[]):n.map(function(t){for(var n,a=0;a<o.length;a+=1)if(i.isDateExact(t,o[a])){n=!0;break}n||(r.isInteger(t)||r.isDate(t)||e.isArray(t)||e.isPlainObject(t)&&t.from&&t.to)&&o.push(t)}),o},i.prototype.activate=function(t,n){var i=this,o=i.item.disable,a=o.length;return"flip"==n?i.flipEnable():!0===n?(i.flipEnable(1),o=[]):!1===n?(i.flipEnable(-1),o=[]):n.map(function(t){var n,s,u,c;for(u=0;u<a;u+=1){if(i.isDateExact(s=o[u],t)){n=o[u]=null,c=!0;break}if(i.isDateOverlap(s,t)){e.isPlainObject(t)?(t.inverted=!0,n=t):e.isArray(t)?(n=t)[3]||n.push("inverted"):r.isDate(t)&&(n=[t.getFullYear(),t.getMonth(),t.getDate(),"inverted"]);break}}if(n)for(u=0;u<a;u+=1)if(i.isDateExact(o[u],t)){o[u]=null;break}if(c)for(u=0;u<a;u+=1)if(i.isDateOverlap(o[u],t)){o[u]=null;break}n&&o.push(n)}),o.filter(function(t){return null!=t})},i.prototype.nodes=function(t){var e,n,i=this,o=i.settings,a=i.item,s=a.now,u=a.select,c=a.highlight,l=a.view,h=a.disable,f=a.min,d=a.max,p=(e=(o.showWeekdaysFull?o.weekdaysFull:o.weekdaysLetter).slice(0),n=o.weekdaysFull.slice(0),o.firstDay&&(e.push(e.shift()),n.push(n.shift())),r.node("thead",r.node("tr",r.group({min:0,max:6,i:1,node:"th",item:function(t){return[e[t],o.klass.weekdays,'scope=col title="'+n[t]+'"']}})))),m=function(t){return r.node("div"," ",o.klass["nav"+(t?"Next":"Prev")]+(t&&l.year>=d.year&&l.month>=d.month||!t&&l.year<=f.year&&l.month<=f.month?" "+o.klass.navDisabled:""),"data-nav="+(t||-1)+" "+r.ariaAttr({role:"button",controls:i.$node[0].id+"_table"})+' title="'+(t?o.labelMonthNext:o.labelMonthPrev)+'"')},g=function(e){var n=o.showMonthsShort?o.monthsShort:o.monthsFull;return"short_months"==e&&(n=o.monthsShort),o.selectMonths&&void 0==e?r.node("select",r.group({min:0,max:11,i:1,node:"option",item:function(t){return[n[t],0,"value="+t+(l.month==t?" selected":"")+(l.year==f.year&&t<f.month||l.year==d.year&&t>d.month?" disabled":"")]}}),o.klass.selectMonth+" browser-default",(t?"":"disabled")+" "+r.ariaAttr({controls:i.$node[0].id+"_table"})+' title="'+o.labelMonthSelect+'"'):"short_months"==e?null!=u?n[u.month]:n[l.month]:r.node("div",n[l.month],o.klass.month)},v=function(e){var n=l.year,a=!0===o.selectYears?5:~~(o.selectYears/2);if(a){var s=f.year,c=d.year,h=n-a,p=n+a;if(s>h&&(p+=s-h,h=s),c<p){var m=h-s,g=p-c;h-=m>g?g:m,p=c}if(o.selectYears&&void 0==e)return r.node("select",r.group({min:h,max:p,i:1,node:"option",item:function(t){return[t,0,"value="+t+(n==t?" selected":"")]}}),o.klass.selectYear+" browser-default",(t?"":"disabled")+" "+r.ariaAttr({controls:i.$node[0].id+"_table"})+' title="'+o.labelYearSelect+'"')}return"raw"===e&&null!=u?r.node("div",u.year):r.node("div",n,o.klass.year)};return createDayLabel=function(){return null!=u?u.date:s.date},createWeekdayLabel=function(){return o.weekdaysShort[null!=u?u.day:s.day]},r.node("div",r.node("div",v("raw"),o.klass.year_display)+r.node("span",createWeekdayLabel()+", ","picker__weekday-display")+r.node("span",g("short_months")+" ",o.klass.month_display)+r.node("span",createDayLabel(),o.klass.day_display),o.klass.date_display)+r.node("div",r.node("div",r.node("div",g()+v()+m()+m(1),o.klass.header)+r.node("table",p+r.node("tbody",r.group({min:0,max:5,i:1,node:"tr",item:function(t){var e=o.firstDay&&0===i.create([l.year,l.month,1]).day?-7:0;return[r.group({min:7*t-l.day+e+1,max:function(){return this.min+7-1},i:1,node:"td",item:function(t){t=i.create([l.year,l.month,t+(o.firstDay?1:0)]);var e,n=u&&u.pick==t.pick,a=c&&c.pick==t.pick,p=h&&i.disabled(t)||t.pick<f.pick||t.pick>d.pick,m=r.trigger(i.formats.toString,i,[o.format,t]);return[r.node("div",t.date,(e=[o.klass.day],e.push(l.month==t.month?o.klass.infocus:o.klass.outfocus),s.pick==t.pick&&e.push(o.klass.now),n&&e.push(o.klass.selected),a&&e.push(o.klass.highlighted),p&&e.push(o.klass.disabled),e.join(" ")),"data-pick="+t.pick+" "+r.ariaAttr({role:"gridcell",label:m,selected:!(!n||i.$node.val()!==m)||null,activedescendant:!!a||null,disabled:!!p||null})+" "+(p?"":'tabindex="0"')),"",r.ariaAttr({role:"presentation"})]}})]}})),o.klass.table,'id="'+i.$node[0].id+'_table" '+r.ariaAttr({role:"grid",controls:i.$node[0].id,readonly:!0})),o.klass.calendar_container)+r.node("div",r.node("button",o.today,"btn-flat picker__today waves-effect","type=button data-pick="+s.pick+(t&&!i.disabled(s)?"":" disabled")+" "+r.ariaAttr({controls:i.$node[0].id}))+r.node("button",o.clear,"btn-flat picker__clear waves-effect","type=button data-clear=1"+(t?"":" disabled")+" "+r.ariaAttr({controls:i.$node[0].id}))+r.node("button",o.close,"btn-flat picker__close waves-effect","type=button data-close=true "+(t?"":" disabled")+" "+r.ariaAttr({controls:i.$node[0].id})),o.klass.footer),"picker__container__wrapper")},i.defaults={labelMonthNext:"Next month",labelMonthPrev:"Previous month",labelMonthSelect:"Select a month",labelYearSelect:"Select a year",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekdaysLetter:["S","M","T","W","T","F","S"],today:"Today",clear:"Clear",close:"Ok",closeOnSelect:!1,format:"d mmmm, yyyy",klass:{table:(n=t.klasses().picker+"__")+"table",header:n+"header",date_display:n+"date-display",day_display:n+"day-display",month_display:n+"month-display",year_display:n+"year-display",calendar_container:n+"calendar-container",navPrev:n+"nav--prev",navNext:n+"nav--next",navDisabled:n+"nav--disabled",month:n+"month",year:n+"year",selectMonth:n+"select--month",selectYear:n+"select--year",weekdays:n+"weekday",day:n+"day",disabled:n+"day--disabled",selected:n+"day--selected",highlighted:n+"day--highlighted",now:n+"day--today",infocus:n+"day--infocus",outfocus:n+"day--outfocus",footer:n+"footer",buttonClear:n+"button--clear",buttonToday:n+"button--today",buttonClose:n+"button--close"}},t.extend("pickadate",i)}(Materialize.Picker,jQuery),function(t){var e,n,r,i=t(window),o=t(document),a="http://www.w3.org/2000/svg",s="SVGAngle"in window&&((n=document.createElement("div")).innerHTML="<svg/>",e=(n.firstChild&&n.firstChild.namespaceURI)==a,n.innerHTML="",e),u="transition"in(r=document.createElement("div").style)||"WebkitTransition"in r||"MozTransition"in r||"msTransition"in r||"OTransition"in r,c="ontouchstart"in window,l="mousedown"+(c?" touchstart":""),h="mousemove.clockpicker"+(c?" touchmove.clockpicker":""),f="mouseup.clockpicker"+(c?" touchend.clockpicker":""),d=navigator.vibrate?"vibrate":navigator.webkitVibrate?"webkitVibrate":null;function p(t){return document.createElementNS(a,t)}function m(t){return(t<10?"0":"")+t}var g=0,v=135,y=105,w=70,b=20,x=2*v,_=u?350:1,M=['<div class="clockpicker picker">','<div class="picker__holder">','<div class="picker__frame">','<div class="picker__wrap">','<div class="picker__box">','<div class="picker__date-display">','<div class="clockpicker-display">','<div class="clockpicker-display-column">','<span class="clockpicker-span-hours text-primary"></span>',":",'<span class="clockpicker-span-minutes"></span>',"</div>",'<div class="clockpicker-display-column clockpicker-display-am-pm">','<div class="clockpicker-span-am-pm"></div>',"</div>","</div>","</div>",'<div class="picker__container__wrapper">','<div class="picker__calendar-container">','<div class="clockpicker-plate">','<div class="clockpicker-canvas"></div>','<div class="clockpicker-dial clockpicker-hours"></div>','<div class="clockpicker-dial clockpicker-minutes clockpicker-dial-out"></div>',"</div>",'<div class="clockpicker-am-pm-block">',"</div>","</div>",'<div class="picker__footer">',"</div>","</div>","</div>","</div>","</div>","</div>","</div>"].join("");function E(e,n){var r=t(M),i=r.find(".clockpicker-plate"),a=r.find(".picker__holder"),u=r.find(".clockpicker-hours"),c=r.find(".clockpicker-minutes"),d=r.find(".clockpicker-am-pm-block"),E="INPUT"===e.prop("tagName"),T=E?e:e.find("input"),A=t("label[for="+T.attr("id")+"]"),k=this;this.id="cp"+(++g+""),this.element=e,this.holder=a,this.options=n,this.isAppended=!1,this.isShown=!1,this.currentView="hours",this.isInput=E,this.input=T,this.label=A,this.popover=r,this.plate=i,this.hoursView=u,this.minutesView=c,this.amPmBlock=d,this.spanHours=r.find(".clockpicker-span-hours"),this.spanMinutes=r.find(".clockpicker-span-minutes"),this.spanAmPm=r.find(".clockpicker-span-am-pm"),this.footer=r.find(".picker__footer"),this.amOrPm="PM",n.twelvehour&&(n.ampmclickable?(this.spanAmPm.empty(),t('<div id="click-am">AM</div>').on("click",function(){k.spanAmPm.children("#click-am").addClass("text-primary"),k.spanAmPm.children("#click-pm").removeClass("text-primary"),k.amOrPm="AM"}).appendTo(this.spanAmPm),t('<div id="click-pm">PM</div>').on("click",function(){k.spanAmPm.children("#click-pm").addClass("text-primary"),k.spanAmPm.children("#click-am").removeClass("text-primary"),k.amOrPm="PM"}).appendTo(this.spanAmPm)):(this.spanAmPm.empty(),t('<div id="click-am">AM</div>').appendTo(this.spanAmPm),t('<div id="click-pm">PM</div>').appendTo(this.spanAmPm))),t('<button type="button" class="btn-flat picker__clear" tabindex="'+(n.twelvehour?"3":"1")+'">'+n.cleartext+"</button>").click(t.proxy(this.clear,this)).appendTo(this.footer),t('<button type="button" class="btn-flat picker__close" tabindex="'+(n.twelvehour?"3":"1")+'">'+n.canceltext+"</button>").click(t.proxy(this.hide,this)).appendTo(this.footer),t('<button type="button" class="btn-flat picker__close" tabindex="'+(n.twelvehour?"3":"1")+'">'+n.donetext+"</button>").click(t.proxy(this.done,this)).appendTo(this.footer),this.spanHours.click(t.proxy(this.toggleView,this,"hours")),this.spanMinutes.click(t.proxy(this.toggleView,this,"minutes")),T.on("focus.clockpicker click.clockpicker",t.proxy(this.show,this));var C,R,D,L,O=t('<div class="clockpicker-tick"></div>');if(n.twelvehour)for(C=1;C<13;C+=1)R=O.clone(),D=C/6*Math.PI,L=y,R.css({left:v+Math.sin(D)*L-b,top:v-Math.cos(D)*L-b}),R.html(0===C?"00":C),u.append(R),R.on(l,P);else for(C=0;C<24;C+=1)R=O.clone(),D=C/6*Math.PI,L=C>0&&C<13?w:y,R.css({left:v+Math.sin(D)*L-b,top:v-Math.cos(D)*L-b}),R.html(0===C?"00":C),u.append(R),R.on(l,P);for(C=0;C<60;C+=5)R=O.clone(),D=C/30*Math.PI,R.css({left:v+Math.sin(D)*y-b,top:v-Math.cos(D)*y-b}),R.html(m(C)),c.append(R),R.on(l,P);function P(t,e){var r=i.offset(),a=/^touch/.test(t.type),s=r.left+v,u=r.top+v,c=(a?t.originalEvent.touches[0]:t).pageX-s,l=(a?t.originalEvent.touches[0]:t).pageY-u,d=Math.sqrt(c*c+l*l),p=!1;if(!e||!(d<y-b||d>y+b)){t.preventDefault();var m=setTimeout(function(){k.popover.addClass("clockpicker-moving")},200);k.setHand(c,l,!e,!0),o.off(h).on(h,function(t){t.preventDefault();var e=/^touch/.test(t.type),n=(e?t.originalEvent.touches[0]:t).pageX-s,r=(e?t.originalEvent.touches[0]:t).pageY-u;(p||n!==c||r!==l)&&(p=!0,k.setHand(n,r,!1,!0))}),o.off(f).on(f,function(t){o.off(f),t.preventDefault();var r=/^touch/.test(t.type),a=(r?t.originalEvent.changedTouches[0]:t).pageX-s,d=(r?t.originalEvent.changedTouches[0]:t).pageY-u;(e||p)&&a===c&&d===l&&k.setHand(a,d),"hours"===k.currentView?k.toggleView("minutes",_/2):n.autoclose&&(k.minutesView.addClass("clockpicker-dial-out"),setTimeout(function(){k.done()},_/2)),i.prepend(I),clearTimeout(m),k.popover.removeClass("clockpicker-moving"),o.off(h)})}}if(i.on(l,function(e){0===t(e.target).closest(".clockpicker-tick").length&&P(e,!0)}),s){var I=r.find(".clockpicker-canvas"),N=p("svg");N.setAttribute("class","clockpicker-svg"),N.setAttribute("width",x),N.setAttribute("height",x);var F=p("g");F.setAttribute("transform","translate("+v+","+v+")");var j=p("circle");j.setAttribute("class","clockpicker-canvas-bearing"),j.setAttribute("cx",0),j.setAttribute("cy",0),j.setAttribute("r",4);var z=p("line");z.setAttribute("x1",0),z.setAttribute("y1",0);var U=p("circle");U.setAttribute("class","clockpicker-canvas-bg"),U.setAttribute("r",b),F.appendChild(z),F.appendChild(U),F.appendChild(j),N.appendChild(F),I.append(N),this.hand=z,this.bg=U,this.bearing=j,this.g=F,this.canvas=I}S(this.options.init)}function S(t){t&&"function"==typeof t&&t()}E.DEFAULTS={default:"",fromnow:0,donetext:"Ok",cleartext:"Clear",canceltext:"Cancel",autoclose:!1,ampmclickable:!0,darktheme:!1,twelvehour:!0,vibrate:!0},E.prototype.toggle=function(){this[this.isShown?"hide":"show"]()},E.prototype.locate=function(){var t=this.element,e=this.popover;t.offset(),t.outerWidth(),t.outerHeight(),e.show()},E.prototype.show=function(e){if(!this.isShown){S(this.options.beforeShow),t(":input").each(function(){t(this).attr("tabindex",-1)});var n=this;this.input.blur(),this.popover.addClass("picker--opened"),this.input.addClass("picker__input picker__input--active"),t(document.body).css("overflow","hidden");var r=((this.input.prop("value")||this.options.default||"")+"").split(":");if(this.options.twelvehour&&"undefined"!=typeof r[1]&&(this.amOrPm=r[1].indexOf("AM")>0?"AM":"PM",r[1]=r[1].replace("AM","").replace("PM","")),"now"===r[0]){var a=new Date(+new Date+this.options.fromnow);r=[a.getHours(),a.getMinutes()],this.options.twelvehour&&(this.amOrPm=r[0]>=12&&r[0]<24?"PM":"AM")}if(this.hours=+r[0]||0,this.minutes=+r[1]||0,this.spanHours.html(this.hours),this.spanMinutes.html(m(this.minutes)),!this.isAppended){var s=document.querySelector(this.options.container);this.options.container&&s?s.appendChild(this.popover[0]):this.popover.insertAfter(this.input),this.options.twelvehour&&("PM"===this.amOrPm?(this.spanAmPm.children("#click-pm").addClass("text-primary"),this.spanAmPm.children("#click-am").removeClass("text-primary")):(this.spanAmPm.children("#click-am").addClass("text-primary"),this.spanAmPm.children("#click-pm").removeClass("text-primary"))),i.on("resize.clockpicker"+this.id,function(){n.isShown&&n.locate()}),this.isAppended=!0}this.toggleView("hours"),this.locate(),this.isShown=!0,o.on("click.clockpicker."+this.id+" focusin.clockpicker."+this.id,function(e){var r=t(e.target);0===r.closest(n.popover.find(".picker__wrap")).length&&0===r.closest(n.input).length&&n.hide()}),o.on("keyup.clockpicker."+this.id,function(t){27===t.keyCode&&n.hide()}),S(this.options.afterShow)}},E.prototype.hide=function(){S(this.options.beforeHide),this.input.removeClass("picker__input picker__input--active"),this.popover.removeClass("picker--opened"),t(document.body).css("overflow","visible"),this.isShown=!1,t(":input").each(function(e){t(this).attr("tabindex",e+1)}),o.off("click.clockpicker."+this.id+" focusin.clockpicker."+this.id),o.off("keyup.clockpicker."+this.id),this.popover.hide(),S(this.options.afterHide)},E.prototype.toggleView=function(e,n){var r=!1;"minutes"===e&&"visible"===t(this.hoursView).css("visibility")&&(S(this.options.beforeHourSelect),r=!0);var i="hours"===e,o=i?this.hoursView:this.minutesView,a=i?this.minutesView:this.hoursView;this.currentView=e,this.spanHours.toggleClass("text-primary",i),this.spanMinutes.toggleClass("text-primary",!i),a.addClass("clockpicker-dial-out"),o.css("visibility","visible").removeClass("clockpicker-dial-out"),this.resetClock(n),clearTimeout(this.toggleViewTimer),this.toggleViewTimer=setTimeout(function(){a.css("visibility","hidden")},_),r&&S(this.options.afterHourSelect)},E.prototype.resetClock=function(t){var e=this.currentView,n=this[e],r="hours"===e,i=n*(Math.PI/(r?6:30)),o=r&&n>0&&n<13?w:y,a=Math.sin(i)*o,u=-Math.cos(i)*o,c=this;s&&t?(c.canvas.addClass("clockpicker-canvas-out"),setTimeout(function(){c.canvas.removeClass("clockpicker-canvas-out"),c.setHand(a,u)},t)):this.setHand(a,u)},E.prototype.setHand=function(e,n,r,i){var o,a=Math.atan2(e,-n),u="hours"===this.currentView,c=Math.PI/(u||r?6:30),l=Math.sqrt(e*e+n*n),h=this.options,f=u&&l<(y+w)/2,p=f?w:y;if(h.twelvehour&&(p=y),a<0&&(a=2*Math.PI+a),a=(o=Math.round(a/c))*c,h.twelvehour?u?0===o&&(o=12):(r&&(o*=5),60===o&&(o=0)):u?(12===o&&(o=0),o=f?0===o?12:o:0===o?0:o+12):(r&&(o*=5),60===o&&(o=0)),this[this.currentView]!==o&&d&&this.options.vibrate&&(this.vibrateTimer||(navigator[d](10),this.vibrateTimer=setTimeout(t.proxy(function(){this.vibrateTimer=null},this),100))),this[this.currentView]=o,u?this.spanHours.html(o):this.spanMinutes.html(m(o)),s){var g=Math.sin(a)*(p-b),v=-Math.cos(a)*(p-b),x=Math.sin(a)*p,_=-Math.cos(a)*p;this.hand.setAttribute("x2",g),this.hand.setAttribute("y2",v),this.bg.setAttribute("cx",x),this.bg.setAttribute("cy",_)}else this[u?"hoursView":"minutesView"].find(".clockpicker-tick").each(function(){var e=t(this);e.toggleClass("active",o===+e.html())})},E.prototype.done=function(){S(this.options.beforeDone),this.hide(),this.label.addClass("active");var t=this.input.prop("value"),e=m(this.hours)+":"+m(this.minutes);this.options.twelvehour&&(e+=this.amOrPm),this.input.prop("value",e),e!==t&&(this.input.triggerHandler("change"),this.isInput||this.element.trigger("change")),this.options.autoclose&&this.input.trigger("blur"),S(this.options.afterDone)},E.prototype.clear=function(){this.hide(),this.label.removeClass("active");var t=this.input.prop("value");this.input.prop("value",""),""!==t&&(this.input.triggerHandler("change"),this.isInput||this.element.trigger("change")),this.options.autoclose&&this.input.trigger("blur")},E.prototype.remove=function(){this.element.removeData("clockpicker"),this.input.off("focus.clockpicker click.clockpicker"),this.isShown&&this.hide(),this.isAppended&&(i.off("resize.clockpicker"+this.id),this.popover.remove())},t.fn.pickatime=function(e){var n=Array.prototype.slice.call(arguments,1);return this.each(function(){var r=t(this),i=r.data("clockpicker");if(i)"function"==typeof i[e]&&i[e].apply(i,n);else{var o=t.extend({},E.DEFAULTS,r.data(),"object"==typeof e&&e);r.data("clockpicker",new E(r,o))}})}}(jQuery),function(t){function e(){var e=+t(this).attr("data-length"),n=+t(this).val().length,r=n<=e;t(this).parent().find('span[class="character-counter"]').html(n+"/"+e),function(t,e){var n=e.hasClass("invalid");t&&n?e.removeClass("invalid"):t||n||(e.removeClass("valid"),e.addClass("invalid"))}(r,t(this))}function n(){t(this).parent().find('span[class="character-counter"]').html("")}t.fn.characterCounter=function(){return this.each(function(){var r=t(this);r.parent().find('span[class="character-counter"]').length||void 0!==r.attr("data-length")&&(r.on("input",e),r.on("focus",e),r.on("blur",n),function(e){var n=e.parent().find('span[class="character-counter"]');n.length||(n=t("<span/>").addClass("character-counter").css("float","right").css("font-size","12px").css("height",1),e.parent().append(n))}(r))})},t(document).ready(function(){t("input, textarea").characterCounter()})}(jQuery),function(t){var e={init:function(e){e=t.extend({duration:200,dist:-100,shift:0,padding:0,fullWidth:!1,indicators:!1,noWrap:!1,onCycleTo:null},e);var n=Materialize.objectSelectorString(t(this));return this.each(function(r){var i,o,a,s,u,c,l,h,f,d,p,m,g,v,w,b,x,_,M,E=t('<ul class="indicators"></ul>'),S=null,T=null,A=t(this),k=A.find(".carousel-item").length>1,C=(A.attr("data-indicators")||e.indicators)&&k,R=A.attr("data-no-wrap")||e.noWrap||!k,D=A.attr("data-namespace")||n+r;A.attr("data-namespace",D);var L=function(e){var n=A.find(".carousel-item.active").length?A.find(".carousel-item.active").first():A.find(".carousel-item").first(),r=n.find("img").first();if(r.length)if(r[0].complete)if(r.height()>0)A.css("height",r.height());else{var i=r[0].naturalWidth,o=r[0].naturalHeight,a=A.width()/i*o;A.css("height",a)}else r.on("load",function(){A.css("height",t(this).height())});else if(!e){var s=n.height();A.css("height",s)}};if(e.fullWidth&&(e.dist=0,L(),C&&A.find(".carousel-fixed-item").addClass("with-indicators")),A.hasClass("initialized"))return t(window).trigger("resize"),A.trigger("carouselNext",[1e-6]),!0;function O(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientX:t.clientX}function P(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientY:t.clientY}function I(t){return t>=h?t%h:t<0?I(h+t%h):t}function N(n){var r,c,f,d,p,m,g;A.hasClass("scrolling")||A.addClass("scrolling"),null!=S&&window.clearTimeout(S),S=window.setTimeout(function(){A.removeClass("scrolling")},e.duration);var y=u;if(s="number"==typeof n?n:s,u=Math.floor((s+l/2)/l),p=-(d=(f=s-u*l)<0?1:-1)*f*2/l,c=h>>1,e.fullWidth?g="translateX(0)":(g="translateX("+(A[0].clientWidth-o)/2+"px) ",g+="translateY("+(A[0].clientHeight-a)/2+"px)"),C){var w=u%h,b=E.find(".indicator-item.active");b.index()!==w&&(b.removeClass("active"),E.find(".indicator-item").eq(w).addClass("active"))}for((!R||u>=0&&u<h)&&(m=i[I(u)],t(m).hasClass("active")||(A.find(".carousel-item").removeClass("active"),t(m).addClass("active")),m.style[v]=g+" translateX("+-f/2+"px) translateX("+d*e.shift*p*r+"px) translateZ("+e.dist*p+"px)",m.style.zIndex=0,tweenedOpacity=e.fullWidth?1:1-.2*p,m.style.opacity=tweenedOpacity,m.style.display="block"),r=1;r<=c;++r)e.fullWidth?(zTranslation=e.dist,tweenedOpacity=r===c&&f<0?1-p:1):(zTranslation=e.dist*(2*r+p*d),tweenedOpacity=1-.2*(2*r+p*d)),(!R||u+r<h)&&((m=i[I(u+r)]).style[v]=g+" translateX("+(e.shift+(l*r-f)/2)+"px) translateZ("+zTranslation+"px)",m.style.zIndex=-r,m.style.opacity=tweenedOpacity,m.style.display="block"),e.fullWidth?(zTranslation=e.dist,tweenedOpacity=r===c&&f>0?1-p:1):(zTranslation=e.dist*(2*r-p*d),tweenedOpacity=1-.2*(2*r-p*d)),(!R||u-r>=0)&&((m=i[I(u-r)]).style[v]=g+" translateX("+((-l*r-f)/2-e.shift)+"px) translateZ("+zTranslation+"px)",m.style.zIndex=-r,m.style.opacity=tweenedOpacity,m.style.display="block");if((!R||u>=0&&u<h)&&((m=i[I(u)]).style[v]=g+" translateX("+-f/2+"px) translateX("+d*e.shift*p+"px) translateZ("+e.dist*p+"px)",m.style.zIndex=0,tweenedOpacity=e.fullWidth?1:1-.2*p,m.style.opacity=tweenedOpacity,m.style.display="block"),y!==u&&"function"==typeof e.onCycleTo){var x=A.find(".carousel-item").eq(I(u));e.onCycleTo.call(this,x,_)}"function"==typeof T&&(T.call(this,x,_),T=null)}function F(){var t,e,n;e=(t=Date.now())-b,b=t,n=s-w,w=s,g=1e3*n/(1+e)*.8+.2*g}function j(){var t,n;p&&(t=Date.now()-b,(n=p*Math.exp(-t/e.duration))>2||n<-2?(N(m-n),requestAnimationFrame(j)):N(m))}function z(t){var e=u%h-t;R||(e<0?Math.abs(e+h)<Math.abs(e)&&(e+=h):e>0&&Math.abs(e-h)<e&&(e-=h)),e<0?A.trigger("carouselNext",[Math.abs(e)]):e>0&&A.trigger("carouselPrev",[e])}function U(e){"mousedown"===e.type&&t(e.target).is("img")&&e.preventDefault(),c=!0,_=!1,M=!1,f=O(e),d=P(e),g=p=0,w=s,b=Date.now(),clearInterval(x),x=setInterval(F,100)}function V(t){var e,n;if(c)if(e=O(t),y=P(t),n=f-e,Math.abs(d-y)<30&&!M)(n>2||n<-2)&&(_=!0,f=e,N(s+n));else{if(_)return t.preventDefault(),t.stopPropagation(),!1;M=!0}if(_)return t.preventDefault(),t.stopPropagation(),!1}function B(t){if(c)return c=!1,clearInterval(x),m=s,(g>10||g<-10)&&(m=s+(p=.9*g)),m=Math.round(m/l)*l,R&&(m>=l*(h-1)?m=l*(h-1):m<0&&(m=0)),p=m-s,b=Date.now(),requestAnimationFrame(j),_&&(t.preventDefault(),t.stopPropagation()),!1}A.addClass("initialized"),c=!1,s=m=0,i=[],o=A.find(".carousel-item").first().innerWidth(),a=A.find(".carousel-item").first().innerHeight(),l=2*o+e.padding,A.find(".carousel-item").each(function(e){if(i.push(t(this)[0]),C){var n=t('<li class="indicator-item"></li>');0===e&&n.addClass("active"),n.click(function(e){e.stopPropagation(),z(t(this).index())}),E.append(n)}}),C&&A.append(E),h=i.length,v="transform",["webkit","Moz","O","ms"].every(function(t){var e=t+"Transform";return"undefined"==typeof document.body.style[e]||(v=e,!1)});var H=Materialize.throttle(function(){e.fullWidth?(o=A.find(".carousel-item").first().innerWidth(),A.find(".carousel-item.active").height(),l=2*o+e.padding,m=s=2*u*o,L(!0)):N()},200);t(window).off("resize.carousel-"+D).on("resize.carousel-"+D,H),"undefined"!=typeof window.ontouchstart&&(A.on("touchstart.carousel",U),A.on("touchmove.carousel",V),A.on("touchend.carousel",B)),A.on("mousedown.carousel",U),A.on("mousemove.carousel",V),A.on("mouseup.carousel",B),A.on("mouseleave.carousel",B),A.on("click.carousel",function(n){if(_)return n.preventDefault(),n.stopPropagation(),!1;if(!e.fullWidth){var r=t(n.target).closest(".carousel-item").index();0!=I(u)-r&&(n.preventDefault(),n.stopPropagation()),z(r)}}),N(s),t(this).on("carouselNext",function(t,e,n){void 0===e&&(e=1),"function"==typeof n&&(T=n),m=l*Math.round(s/l)+l*e,s!==m&&(p=m-s,b=Date.now(),requestAnimationFrame(j))}),t(this).on("carouselPrev",function(t,e,n){void 0===e&&(e=1),"function"==typeof n&&(T=n),m=l*Math.round(s/l)-l*e,s!==m&&(p=m-s,b=Date.now(),requestAnimationFrame(j))}),t(this).on("carouselSet",function(t,e,n){void 0===e&&(e=0),"function"==typeof n&&(T=n),z(e)})})},next:function(e,n){t(this).trigger("carouselNext",[e,n])},prev:function(e,n){t(this).trigger("carouselPrev",[e,n])},set:function(e,n){t(this).trigger("carouselSet",[e,n])},destroy:function(){var e=t(this).attr("data-namespace");t(this).removeAttr("data-namespace"),t(this).removeClass("initialized"),t(this).find(".indicators").remove(),t(this).off("carouselNext carouselPrev carouselSet"),t(window).off("resize.carousel-"+e),"undefined"!=typeof window.ontouchstart&&t(this).off("touchstart.carousel touchmove.carousel touchend.carousel"),t(this).off("mousedown.carousel mousemove.carousel mouseup.carousel mouseleave.carousel click.carousel")}};t.fn.carousel=function(n){return e[n]?e[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?void t.error("Method "+n+" does not exist on jQuery.carousel"):e.init.apply(this,arguments)}}(jQuery),function(t){var e={init:function(e){return this.each(function(){var n=t("#"+t(this).attr("data-activates")),r=(t("body"),t(this)),i=r.parent(".tap-target-wrapper"),o=i.find(".tap-target-wave"),a=i.find(".tap-target-origin"),s=r.find(".tap-target-content");i.length||(i=r.wrap(t('<div class="tap-target-wrapper"></div>')).parent()),s.length||(s=t('<div class="tap-target-content"></div>'),r.append(s)),o.length||(o=t('<div class="tap-target-wave"></div>'),a.length||((a=n.clone(!0,!0)).addClass("tap-target-origin"),a.removeAttr("id"),a.removeAttr("style"),o.append(a)),i.append(o));var u=function(){i.is(".open")&&(i.removeClass("open"),a.off("click.tapTarget"),t(document).off("click.tapTarget"),t(window).off("resize.tapTarget"))},c=function(){var e="fixed"===n.css("position");if(!e)for(var a=n.parents(),u=0;u<a.length&&!(e="fixed"==t(a[u]).css("position"));u++);var c=n.outerWidth(),l=n.outerHeight(),h=e?n.offset().top-t(document).scrollTop():n.offset().top,f=e?n.offset().left-t(document).scrollLeft():n.offset().left,d=t(window).width(),p=t(window).height(),m=d/2,g=p/2,v=f<=m,y=f>m,w=h<=g,b=h>g,x=f>=.25*d&&f<=.75*d,_=r.outerWidth(),M=r.outerHeight(),E=h+l/2-M/2,S=f+c/2-_/2,T=e?"fixed":"absolute",A=x?_:_/2+c,k=M/2,C=w?M/2:0,R=v&&!x?_/2-c:0,D=c,L=b?"bottom":"top",O=2*c,P=O,I=M/2-P/2,N=_/2-O/2,F={};F.top=w?E:"",F.right=y?d-S-_:"",F.bottom=b?p-E-M:"",F.left=v?S:"",F.position=T,i.css(F),s.css({width:A,height:k,top:C,right:0,bottom:0,left:R,padding:D,verticalAlign:L}),o.css({top:I,left:N,width:O,height:P})};"open"==e&&(c(),i.is(".open")||(i.addClass("open"),setTimeout(function(){a.off("click.tapTarget").on("click.tapTarget",function(t){u(),a.off("click.tapTarget")}),t(document).off("click.tapTarget").on("click.tapTarget",function(e){u(),t(document).off("click.tapTarget")});var e=Materialize.throttle(function(){c()},200);t(window).off("resize.tapTarget").on("resize.tapTarget",e)},0))),"close"==e&&u()})},open:function(){},close:function(){}};t.fn.tapTarget=function(n){if(e[n]||"object"==typeof n)return e.init.apply(this,arguments);t.error("Method "+n+" does not exist on jQuery.tap-target")}}(jQuery),function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).numbro=t()}(function(){return function t(e,n,r){function i(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[a]={exports:{}};e[a][0].call(l.exports,function(t){return i(e[a][1][t]||t)},l,l.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,e,n){!function(t){"use strict";function n(t){var e=0|t;return t>0||t===e?e:e-1}function r(t){for(var e,n,r=1,i=t.length,o=t[0]+"";r<i;){for(e=t[r++]+"",n=b-e.length;n--;e="0"+e);o+=e}for(i=o.length;48===o.charCodeAt(--i););return o.slice(0,i+1||1)}function i(t,e){var n,r,i=t.c,o=e.c,a=t.s,s=e.s,u=t.e,c=e.e;if(!a||!s)return null;if(n=i&&!i[0],r=o&&!o[0],n||r)return n?r?0:-s:a;if(a!=s)return a;if(n=a<0,r=u==c,!i||!o)return r?0:!i^n?1:-1;if(!r)return u>c^n?1:-1;for(s=(u=i.length)<(c=o.length)?u:c,a=0;a<s;a++)if(i[a]!=o[a])return i[a]>o[a]^n?1:-1;return u==c?0:u>c^n?1:-1}function o(t,e,n){return(t=l(t))>=e&&t<=n}function a(t){return"[object Array]"==Object.prototype.toString.call(t)}function s(t,e,n){for(var r,i,o=[0],a=0,s=t.length;a<s;){for(i=o.length;i--;o[i]*=e);for(o[r=0]+=y.indexOf(t.charAt(a++));r<o.length;r++)o[r]>n-1&&(null==o[r+1]&&(o[r+1]=0),o[r+1]+=o[r]/n|0,o[r]%=n)}return o.reverse()}function u(t,e){return(t.length>1?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function c(t,e){var n,r;if(e<0){for(r="0.";++e;r+="0");t=r+t}else if(++e>(n=t.length)){for(r="0",e-=n;--e;r+="0");t+=r}else e<n&&(t=t.slice(0,e)+"."+t.slice(e));return t}function l(t){return(t=parseFloat(t))<0?d(t):p(t)}var h,f=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,d=Math.ceil,p=Math.floor,m=" not a boolean or binary digit",g="rounding mode",v="number type has more than 15 significant digits",y="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_",w=1e14,b=14,x=9007199254740991,_=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],M=1e7,E=1e9;(h=function t(e){function h(t,e){var n,r,i,o,a,s,u=this;if(!(u instanceof h))return H&&R(26,"constructor call without new",t),new h(t,e);if(null!=e&&q(e,2,64,P,"base")){if(s=t+"",10==(e|=0))return D(u=new h(t instanceof h?t:s),F+u.e+1,j);if((o="number"==typeof t)&&0*t!=0||!new RegExp("^-?"+(n="["+y.slice(0,e)+"]+")+"(?:\\."+n+")?$",e<37?"i":"").test(s))return O(u,s,o,e);o?(u.s=1/t<0?(s=s.slice(1),-1):1,H&&s.replace(/^0\.0*|\./,"").length>15&&R(P,v,t),o=!1):u.s=45===s.charCodeAt(0)?(s=s.slice(1),-1):1,s=S(s,10,e,u.s)}else{if(t instanceof h)return u.s=t.s,u.e=t.e,u.c=(t=t.c)?t.slice():t,void(P=0);if((o="number"==typeof t)&&0*t==0){if(u.s=1/t<0?(t=-t,-1):1,t===~~t){for(r=0,i=t;i>=10;i/=10,r++);return u.e=r,u.c=[t],void(P=0)}s=t+""}else{if(!f.test(s=t+""))return O(u,s,o);u.s=45===s.charCodeAt(0)?(s=s.slice(1),-1):1}}for((r=s.indexOf("."))>-1&&(s=s.replace(".","")),(i=s.search(/e/i))>0?(r<0&&(r=i),r+=+s.slice(i+1),s=s.substring(0,i)):r<0&&(r=s.length),i=0;48===s.charCodeAt(i);i++);for(a=s.length;48===s.charCodeAt(--a););if(s=s.slice(i,a+1))if(a=s.length,o&&H&&a>15&&(t>x||t!==p(t))&&R(P,v,u.s*t),(r=r-i-1)>B)u.c=u.e=null;else if(r<V)u.c=[u.e=0];else{if(u.e=r,u.c=[],i=(r+1)%b,r<0&&(i+=b),i<a){for(i&&u.c.push(+s.slice(0,i)),a-=b;i<a;)u.c.push(+s.slice(i,i+=b));s=s.slice(i),i=b-s.length}else i-=a;for(;i--;s+="0");u.c.push(+s)}else u.c=[u.e=0];P=0}function S(t,e,n,i){var o,a,u,l,f,d,p,m=t.indexOf("."),g=F,v=j;for(n<37&&(t=t.toLowerCase()),m>=0&&(u=Y,Y=0,t=t.replace(".",""),f=(p=new h(n)).pow(t.length-m),Y=u,p.c=s(c(r(f.c),f.e),10,e),p.e=p.c.length),a=u=(d=s(t,n,e)).length;0==d[--u];d.pop());if(!d[0])return"0";if(m<0?--a:(f.c=d,f.e=a,f.s=i,d=(f=L(f,p,g,v,e)).c,l=f.r,a=f.e),m=d[o=a+g+1],u=e/2,l=l||o<0||null!=d[o+1],l=v<4?(null!=m||l)&&(0==v||v==(f.s<0?3:2)):m>u||m==u&&(4==v||l||6==v&&1&d[o-1]||v==(f.s<0?8:7)),o<1||!d[0])t=l?c("1",-g):"0";else{if(d.length=o,l)for(--e;++d[--o]>e;)d[o]=0,o||(++a,d=[1].concat(d));for(u=d.length;!d[--u];);for(m=0,t="";m<=u;t+=y.charAt(d[m++]));t=c(t,a)}return t}function T(t,e,n,i){var o,a,s,l,f;if(n=null!=n&&q(n,0,8,i,g)?0|n:j,!t.c)return t.toString();if(o=t.c[0],s=t.e,null==e)f=r(t.c),f=19==i||24==i&&s<=z?u(f,s):c(f,s);else if(a=(t=D(new h(t),e,n)).e,l=(f=r(t.c)).length,19==i||24==i&&(e<=a||a<=z)){for(;l<e;f+="0",l++);f=u(f,a)}else if(e-=s,f=c(f,a),a+1>l){if(--e>0)for(f+=".";e--;f+="0");}else if((e+=a-l)>0)for(a+1==l&&(f+=".");e--;f+="0");return t.s<0&&o?"-"+f:f}function A(t,e){var n,r,i=0;for(a(t[0])&&(t=t[0]),n=new h(t[0]);++i<t.length;){if(!(r=new h(t[i])).s){n=r;break}e.call(n,r)&&(n=r)}return n}function k(t,e,n,r,i){return(t<e||t>n||t!=l(t))&&R(r,(i||"decimal places")+(t<e||t>n?" out of range":" not an integer"),t),!0}function C(t,e,n){for(var r=1,i=e.length;!e[--i];e.pop());for(i=e[0];i>=10;i/=10,r++);return(n=r+n*b-1)>B?t.c=t.e=null:n<V?t.c=[t.e=0]:(t.e=n,t.c=e),t}function R(t,e,n){var r=new Error(["new BigNumber","cmp","config","div","divToInt","eq","gt","gte","lt","lte","minus","mod","plus","precision","random","round","shift","times","toDigits","toExponential","toFixed","toFormat","toFraction","pow","toPrecision","toString","BigNumber"][t]+"() "+e+": "+n);throw r.name="BigNumber Error",P=0,r}function D(t,e,n,r){var i,o,a,s,u,c,l,h=t.c,f=_;if(h){t:{for(i=1,s=h[0];s>=10;s/=10,i++);if((o=e-i)<0)o+=b,l=(u=h[c=0])/f[i-(a=e)-1]%10|0;else if((c=d((o+1)/b))>=h.length){if(!r)break t;for(;h.length<=c;h.push(0));u=l=0,i=1,a=(o%=b)-b+1}else{for(u=s=h[c],i=1;s>=10;s/=10,i++);l=(a=(o%=b)-b+i)<0?0:u/f[i-a-1]%10|0}if(r=r||e<0||null!=h[c+1]||(a<0?u:u%f[i-a-1]),r=n<4?(l||r)&&(0==n||n==(t.s<0?3:2)):l>5||5==l&&(4==n||r||6==n&&(o>0?a>0?u/f[i-a]:0:h[c-1])%10&1||n==(t.s<0?8:7)),e<1||!h[0])return h.length=0,r?(h[0]=f[(b-(e-=t.e+1)%b)%b],t.e=-e||0):h[0]=t.e=0,t;if(0==o?(h.length=c,s=1,c--):(h.length=c+1,s=f[b-o],h[c]=a>0?p(u/f[i-a]%f[a])*s:0),r)for(;;){if(0==c){for(o=1,a=h[0];a>=10;a/=10,o++);for(a=h[0]+=s,s=1;a>=10;a/=10,s++);o!=s&&(t.e++,h[0]==w&&(h[0]=1));break}if(h[c]+=s,h[c]!=w)break;h[c--]=0,s=1}for(o=h.length;0===h[--o];h.pop());}t.e>B?t.c=t.e=null:t.e<V&&(t.c=[t.e=0])}return t}var L,O,P=0,I=h.prototype,N=new h(1),F=20,j=4,z=-7,U=21,V=-1e7,B=1e7,H=!0,q=k,G=!1,W=1,Y=0,X={decimalSeparator:".",groupSeparator:",",groupSize:3,secondaryGroupSize:0,fractionGroupSeparator:"\xa0",fractionGroupSize:0};return h.another=t,h.ROUND_UP=0,h.ROUND_DOWN=1,h.ROUND_CEIL=2,h.ROUND_FLOOR=3,h.ROUND_HALF_UP=4,h.ROUND_HALF_DOWN=5,h.ROUND_HALF_EVEN=6,h.ROUND_HALF_CEIL=7,h.ROUND_HALF_FLOOR=8,h.EUCLID=9,h.config=h.set=function(){var t,e,n=0,r={},i=arguments,s=i[0],u=s&&"object"==typeof s?function(){if(s.hasOwnProperty(e))return null!=(t=s[e])}:function(){if(i.length>n)return null!=(t=i[n++])};return u(e="DECIMAL_PLACES")&&q(t,0,E,2,e)&&(F=0|t),r[e]=F,u(e="ROUNDING_MODE")&&q(t,0,8,2,e)&&(j=0|t),r[e]=j,u(e="EXPONENTIAL_AT")&&(a(t)?q(t[0],-E,0,2,e)&&q(t[1],0,E,2,e)&&(z=0|t[0],U=0|t[1]):q(t,-E,E,2,e)&&(z=-(U=0|(t<0?-t:t)))),r[e]=[z,U],u(e="RANGE")&&(a(t)?q(t[0],-E,-1,2,e)&&q(t[1],1,E,2,e)&&(V=0|t[0],B=0|t[1]):q(t,-E,E,2,e)&&(0|t?V=-(B=0|(t<0?-t:t)):H&&R(2,e+" cannot be zero",t))),r[e]=[V,B],u(e="ERRORS")&&(t===!!t||1===t||0===t?(P=0,q=(H=!!t)?k:o):H&&R(2,e+m,t)),r[e]=H,u(e="CRYPTO")&&(!0===t||!1===t||1===t||0===t?t?!(t="undefined"==typeof crypto)&&crypto&&(crypto.getRandomValues||crypto.randomBytes)?G=!0:H?R(2,"crypto unavailable",t?void 0:crypto):G=!1:G=!1:H&&R(2,e+m,t)),r[e]=G,u(e="MODULO_MODE")&&q(t,0,9,2,e)&&(W=0|t),r[e]=W,u(e="POW_PRECISION")&&q(t,0,E,2,e)&&(Y=0|t),r[e]=Y,u(e="FORMAT")&&("object"==typeof t?X=t:H&&R(2,e+" not an object",t)),r[e]=X,r},h.max=function(){return A(arguments,I.lt)},h.min=function(){return A(arguments,I.gt)},h.random=function(){var t=9007199254740992*Math.random()&2097151?function(){return p(9007199254740992*Math.random())}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)};return function(e){var n,r,i,o,a,s=0,u=[],c=new h(N);if(e=null!=e&&q(e,0,E,14)?0|e:F,o=d(e/b),G)if(crypto.getRandomValues){for(n=crypto.getRandomValues(new Uint32Array(o*=2));s<o;)(a=131072*n[s]+(n[s+1]>>>11))>=9e15?(r=crypto.getRandomValues(new Uint32Array(2)),n[s]=r[0],n[s+1]=r[1]):(u.push(a%1e14),s+=2);s=o/2}else if(crypto.randomBytes){for(n=crypto.randomBytes(o*=7);s<o;)(a=281474976710656*(31&n[s])+1099511627776*n[s+1]+4294967296*n[s+2]+16777216*n[s+3]+(n[s+4]<<16)+(n[s+5]<<8)+n[s+6])>=9e15?crypto.randomBytes(7).copy(n,s):(u.push(a%1e14),s+=7);s=o/7}else G=!1,H&&R(14,"crypto unavailable",crypto);if(!G)for(;s<o;)(a=t())<9e15&&(u[s++]=a%1e14);for(o=u[--s],e%=b,o&&e&&(u[s]=p(o/(a=_[b-e]))*a);0===u[s];u.pop(),s--);if(s<0)u=[i=0];else{for(i=-1;0===u[0];u.splice(0,1),i-=b);for(s=1,a=u[0];a>=10;a/=10,s++);s<b&&(i-=b-s)}return c.e=i,c.c=u,c}}(),L=function(){function t(t,e,n){var r,i,o,a,s=0,u=t.length,c=e%M,l=e/M|0;for(t=t.slice();u--;)s=((i=c*(o=t[u]%M)+(r=l*o+(a=t[u]/M|0)*c)%M*M+s)/n|0)+(r/M|0)+l*a,t[u]=i%n;return s&&(t=[s].concat(t)),t}function e(t,e,n,r){var i,o;if(n!=r)o=n>r?1:-1;else for(i=o=0;i<n;i++)if(t[i]!=e[i]){o=t[i]>e[i]?1:-1;break}return o}function r(t,e,n,r){for(var i=0;n--;)t[n]-=i,t[n]=(i=t[n]<e[n]?1:0)*r+t[n]-e[n];for(;!t[0]&&t.length>1;t.splice(0,1));}return function(i,o,a,s,u){var c,l,f,d,m,g,v,y,x,_,M,E,S,T,A,k,C,R=i.s==o.s?1:-1,L=i.c,O=o.c;if(!(L&&L[0]&&O&&O[0]))return new h(i.s&&o.s&&(L?!O||L[0]!=O[0]:O)?L&&0==L[0]||!O?0*R:R/0:NaN);for(x=(y=new h(R)).c=[],R=a+(l=i.e-o.e)+1,u||(u=w,l=n(i.e/b)-n(o.e/b),R=R/b|0),f=0;O[f]==(L[f]||0);f++);if(O[f]>(L[f]||0)&&l--,R<0)x.push(1),d=!0;else{for(T=L.length,k=O.length,f=0,R+=2,(m=p(u/(O[0]+1)))>1&&(O=t(O,m,u),L=t(L,m,u),k=O.length,T=L.length),S=k,M=(_=L.slice(0,k)).length;M<k;_[M++]=0);C=O.slice(),C=[0].concat(C),A=O[0],O[1]>=u/2&&A++;do{if(m=0,(c=e(O,_,k,M))<0){if(E=_[0],k!=M&&(E=E*u+(_[1]||0)),(m=p(E/A))>1)for(m>=u&&(m=u-1),v=(g=t(O,m,u)).length,M=_.length;1==e(g,_,v,M);)m--,r(g,k<v?C:O,v,u),v=g.length,c=1;else 0==m&&(c=m=1),v=(g=O.slice()).length;if(v<M&&(g=[0].concat(g)),r(_,g,M,u),M=_.length,-1==c)for(;e(O,_,k,M)<1;)m++,r(_,k<M?C:O,M,u),M=_.length}else 0===c&&(m++,_=[0]);x[f++]=m,_[0]?_[M++]=L[S]||0:(_=[L[S]],M=1)}while((S++<T||null!=_[0])&&R--);d=null!=_[0],x[0]||x.splice(0,1)}if(u==w){for(f=1,R=x[0];R>=10;R/=10,f++);D(y,a+(y.e=f+l*b-1)+1,s,d)}else y.e=l,y.r=+d;return y}}(),O=function(){var t=/^(-?)0([xbo])(?=\w[\w.]*$)/i,e=/^([^.]+)\.$/,n=/^\.([^.]+)$/,r=/^-?(Infinity|NaN)$/,i=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(o,a,s,u){var c,l=s?a:a.replace(i,"");if(r.test(l))o.s=isNaN(l)?null:l<0?-1:1;else{if(!s&&(l=l.replace(t,function(t,e,n){return c="x"==(n=n.toLowerCase())?16:"b"==n?2:8,u&&u!=c?t:e}),u&&(c=u,l=l.replace(e,"$1").replace(n,"0.$1")),a!=l))return new h(l,c);H&&R(P,"not a"+(u?" base "+u:"")+" number",a),o.s=null}o.c=o.e=null,P=0}}(),I.absoluteValue=I.abs=function(){var t=new h(this);return t.s<0&&(t.s=1),t},I.ceil=function(){return D(new h(this),this.e+1,2)},I.comparedTo=I.cmp=function(t,e){return P=1,i(this,new h(t,e))},I.decimalPlaces=I.dp=function(){var t,e,r=this.c;if(!r)return null;if(t=((e=r.length-1)-n(this.e/b))*b,e=r[e])for(;e%10==0;e/=10,t--);return t<0&&(t=0),t},I.dividedBy=I.div=function(t,e){return P=3,L(this,new h(t,e),F,j)},I.dividedToIntegerBy=I.divToInt=function(t,e){return P=4,L(this,new h(t,e),0,1)},I.equals=I.eq=function(t,e){return P=5,0===i(this,new h(t,e))},I.floor=function(){return D(new h(this),this.e+1,3)},I.greaterThan=I.gt=function(t,e){return P=6,i(this,new h(t,e))>0},I.greaterThanOrEqualTo=I.gte=function(t,e){return P=7,1===(e=i(this,new h(t,e)))||0===e},I.isFinite=function(){return!!this.c},I.isInteger=I.isInt=function(){return!!this.c&&n(this.e/b)>this.c.length-2},I.isNaN=function(){return!this.s},I.isNegative=I.isNeg=function(){return this.s<0},I.isZero=function(){return!!this.c&&0==this.c[0]},I.lessThan=I.lt=function(t,e){return P=8,i(this,new h(t,e))<0},I.lessThanOrEqualTo=I.lte=function(t,e){return P=9,-1===(e=i(this,new h(t,e)))||0===e},I.minus=I.sub=function(t,e){var r,i,o,a,s=this,u=s.s;if(P=10,e=(t=new h(t,e)).s,!u||!e)return new h(NaN);if(u!=e)return t.s=-e,s.plus(t);var c=s.e/b,l=t.e/b,f=s.c,d=t.c;if(!c||!l){if(!f||!d)return f?(t.s=-e,t):new h(d?s:NaN);if(!f[0]||!d[0])return d[0]?(t.s=-e,t):new h(f[0]?s:3==j?-0:0)}if(c=n(c),l=n(l),f=f.slice(),u=c-l){for((a=u<0)?(u=-u,o=f):(l=c,o=d),o.reverse(),e=u;e--;o.push(0));o.reverse()}else for(i=(a=(u=f.length)<(e=d.length))?u:e,u=e=0;e<i;e++)if(f[e]!=d[e]){a=f[e]<d[e];break}if(a&&(o=f,f=d,d=o,t.s=-t.s),(e=(i=d.length)-(r=f.length))>0)for(;e--;f[r++]=0);for(e=w-1;i>u;){if(f[--i]<d[i]){for(r=i;r&&!f[--r];f[r]=e);--f[r],f[i]+=w}f[i]-=d[i]}for(;0==f[0];f.splice(0,1),--l);return f[0]?C(t,f,l):(t.s=3==j?-1:1,t.c=[t.e=0],t)},I.modulo=I.mod=function(t,e){var n,r,i=this;return P=11,t=new h(t,e),!i.c||!t.s||t.c&&!t.c[0]?new h(NaN):!t.c||i.c&&!i.c[0]?new h(i):(9==W?(r=t.s,t.s=1,n=L(i,t,0,3),t.s=r,n.s*=r):n=L(i,t,0,W),i.minus(n.times(t)))},I.negated=I.neg=function(){var t=new h(this);return t.s=-t.s||null,t},I.plus=I.add=function(t,e){var r,i=this,o=i.s;if(P=12,e=(t=new h(t,e)).s,!o||!e)return new h(NaN);if(o!=e)return t.s=-e,i.minus(t);var a=i.e/b,s=t.e/b,u=i.c,c=t.c;if(!a||!s){if(!u||!c)return new h(o/0);if(!u[0]||!c[0])return c[0]?t:new h(u[0]?i:0*o)}if(a=n(a),s=n(s),u=u.slice(),o=a-s){for(o>0?(s=a,r=c):(o=-o,r=u),r.reverse();o--;r.push(0));r.reverse()}for((o=u.length)-(e=c.length)<0&&(r=c,c=u,u=r,e=o),o=0;e;)o=(u[--e]=u[e]+c[e]+o)/w|0,u[e]=w===u[e]?0:u[e]%w;return o&&(u=[o].concat(u),++s),C(t,u,s)},I.precision=I.sd=function(t){var e,n,r=this,i=r.c;if(null!=t&&t!==!!t&&1!==t&&0!==t&&(H&&R(13,"argument"+m,t),t!=!!t&&(t=null)),!i)return null;if(e=(n=i.length-1)*b+1,n=i[n]){for(;n%10==0;n/=10,e--);for(n=i[0];n>=10;n/=10,e++);}return t&&r.e+1>e&&(e=r.e+1),e},I.round=function(t,e){var n=new h(this);return(null==t||q(t,0,E,15))&&D(n,~~t+this.e+1,null!=e&&q(e,0,8,15,g)?0|e:j),n},I.shift=function(t){var e=this;return q(t,-x,x,16,"argument")?e.times("1e"+l(t)):new h(e.c&&e.c[0]&&(t<-x||t>x)?e.s*(t<0?0:1/0):e)},I.squareRoot=I.sqrt=function(){var t,e,i,o,a,s=this,u=s.c,c=s.s,l=s.e,f=F+4,d=new h("0.5");if(1!==c||!u||!u[0])return new h(!c||c<0&&(!u||u[0])?NaN:u?s:1/0);if(0==(c=Math.sqrt(+s))||c==1/0?(((e=r(u)).length+l)%2==0&&(e+="0"),c=Math.sqrt(e),l=n((l+1)/2)-(l<0||l%2),i=new h(e=c==1/0?"1e"+l:(e=c.toExponential()).slice(0,e.indexOf("e")+1)+l)):i=new h(c+""),i.c[0])for((c=(l=i.e)+f)<3&&(c=0);;)if(i=d.times((a=i).plus(L(s,a,f,1))),r(a.c).slice(0,c)===(e=r(i.c)).slice(0,c)){if(i.e<l&&--c,"9999"!=(e=e.slice(c-3,c+1))&&(o||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(D(i,i.e+F+2,1),t=!i.times(i).eq(s));break}if(!o&&(D(a,a.e+F+2,0),a.times(a).eq(s))){i=a;break}f+=4,c+=4,o=1}return D(i,i.e+F+1,j,t)},I.times=I.mul=function(t,e){var r,i,o,a,s,u,c,l,f,d,p,m,g,v,y,x=this,_=x.c,E=(P=17,t=new h(t,e)).c;if(!(_&&E&&_[0]&&E[0]))return!x.s||!t.s||_&&!_[0]&&!E||E&&!E[0]&&!_?t.c=t.e=t.s=null:(t.s*=x.s,_&&E?(t.c=[0],t.e=0):t.c=t.e=null),t;for(i=n(x.e/b)+n(t.e/b),t.s*=x.s,(c=_.length)<(d=E.length)&&(g=_,_=E,E=g,o=c,c=d,d=o),o=c+d,g=[];o--;g.push(0));for(v=w,y=M,o=d;--o>=0;){for(r=0,p=E[o]%y,m=E[o]/y|0,a=o+(s=c);a>o;)r=((l=p*(l=_[--s]%y)+(u=m*l+(f=_[s]/y|0)*p)%y*y+g[a]+r)/v|0)+(u/y|0)+m*f,g[a--]=l%v;g[a]=r}return r?++i:g.splice(0,1),C(t,g,i)},I.toDigits=function(t,e){var n=new h(this);return t=null!=t&&q(t,1,E,18,"precision")?0|t:null,e=null!=e&&q(e,0,8,18,g)?0|e:j,t?D(n,t,e):n},I.toExponential=function(t,e){return T(this,null!=t&&q(t,0,E,19)?1+~~t:null,e,19)},I.toFixed=function(t,e){return T(this,null!=t&&q(t,0,E,20)?~~t+this.e+1:null,e,20)},I.toFormat=function(t,e){var n=T(this,null!=t&&q(t,0,E,21)?~~t+this.e+1:null,e,21);if(this.c){var r,i=n.split("."),o=+X.groupSize,a=+X.secondaryGroupSize,s=X.groupSeparator,u=i[0],c=i[1],l=this.s<0,h=l?u.slice(1):u,f=h.length;if(a&&(r=o,o=a,a=r,f-=r),o>0&&f>0){for(u=h.substr(0,r=f%o||o);r<f;r+=o)u+=s+h.substr(r,o);a>0&&(u+=s+h.slice(r)),l&&(u="-"+u)}n=c?u+X.decimalSeparator+((a=+X.fractionGroupSize)?c.replace(new RegExp("\\d{"+a+"}\\B","g"),"$&"+X.fractionGroupSeparator):c):u}return n},I.toFraction=function(t){var e,n,i,o,a,s,u,c,l,f=H,d=this,p=d.c,m=new h(N),g=n=new h(N),v=u=new h(N);if(null!=t&&(H=!1,s=new h(t),H=f,(f=s.isInt())&&!s.lt(N)||(H&&R(22,"max denominator "+(f?"out of range":"not an integer"),t),t=!f&&s.c&&D(s,s.e+1,1).gte(N)?s:null)),!p)return d.toString();for(l=r(p),o=m.e=l.length-d.e-1,m.c[0]=_[(a=o%b)<0?b+a:a],t=!t||s.cmp(m)>0?o>0?m:g:s,a=B,B=1/0,s=new h(l),u.c[0]=0;c=L(s,m,0,1),1!=(i=n.plus(c.times(v))).cmp(t);)n=v,v=i,g=u.plus(c.times(i=g)),u=i,m=s.minus(c.times(i=m)),s=i;return i=L(t.minus(n),v,0,1),u=u.plus(i.times(g)),n=n.plus(i.times(v)),u.s=g.s=d.s,e=L(g,v,o*=2,j).minus(d).abs().cmp(L(u,n,o,j).minus(d).abs())<1?[g.toString(),v.toString()]:[u.toString(),n.toString()],B=a,e},I.toNumber=function(){return+this},I.toPower=I.pow=function(t,e){var n,r,i,o=p(t<0?-t:+t),a=this;if(null!=e&&(P=23,e=new h(e)),!q(t,-x,x,23,"exponent")&&(!isFinite(t)||o>x&&(t/=0)||parseFloat(t)!=t&&!(t=NaN))||0==t)return n=Math.pow(+a,t),new h(e?n%e:n);for(e?t>1&&a.gt(N)&&a.isInt()&&e.gt(N)&&e.isInt()?a=a.mod(e):(i=e,e=null):Y&&(n=d(Y/b+2)),r=new h(N);;){if(o%2){if(!(r=r.times(a)).c)break;n?r.c.length>n&&(r.c.length=n):e&&(r=r.mod(e))}if(!(o=p(o/2)))break;a=a.times(a),n?a.c&&a.c.length>n&&(a.c.length=n):e&&(a=a.mod(e))}return e?r:(t<0&&(r=N.div(r)),i?r.mod(i):n?D(r,Y,j):r)},I.toPrecision=function(t,e){return T(this,null!=t&&q(t,1,E,24,"precision")?0|t:null,e,24)},I.toString=function(t){var e,n=this,i=n.s,o=n.e;return null===o?i?(e="Infinity",i<0&&(e="-"+e)):e="NaN":(e=r(n.c),e=null!=t&&q(t,2,64,25,"base")?S(c(e,o),0|t,10,i):o<=z||o>=U?u(e,o):c(e,o),i<0&&n.c[0]&&(e="-"+e)),e},I.truncated=I.trunc=function(){return D(new h(this),this.e+1,1)},I.valueOf=I.toJSON=function(){var t,e=this,n=e.e;return null===n?e.toString():(t=r(e.c),t=n<=z||n>=U?u(t,n):c(t,n),e.s<0?"-"+t:t)},I.isBigNumber=!0,null!=e&&h.config(e),h}()).default=h.BigNumber=h,void 0!==e&&e.exports?e.exports=h:(t||(t="undefined"!=typeof self?self:Function("return this")()),t.BigNumber=h)}(this)},{}],2:[function(t,e,n){"use strict";e.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){var e=t%10;return 1==~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,e,n){"use strict";function r(t,e,n){var r=e[0],i=Math.abs(t);if(i>=n){for(var o=1;o<e.length;++o){var a=Math.pow(n,o),s=Math.pow(n,o+1);if(i>=a&&i<s){r=e[o],t/=a;break}}r===e[0]&&(t/=Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function i(t){var e=t.characteristicPrecision,n=void 0===e?0:e,r=t.value.toExponential().split("e"),i=l(r,2),o=i[1],a=+i[0];return n?(1<n&&(a*=Math.pow(10,n-1),o=(o=+o-(n-1))>=0?"+"+o:o),{value:a,abbreviation:"e"+o}):{value:a,abbreviation:"e"+o}}function o(t){for(var e="",n=0;n<t;n++)e+="0";return e}function a(t,e,n,r){if(-1===r)return t;var i=function(t,e){return-1!==t.toString().indexOf("e")?function(t,e){var n=t.toString(),r=n.split("e"),i=l(r,2),a=i[1],s=i[0].split("."),u=l(s,2),c=u[0],h=u[1],f=void 0===h?"":h;if(+a>0)n=c+f+o(a-f.length);else{var d=".";d=+c<0?"-0"+d:"0"+d;var p=(o(-a-1)+Math.abs(c)+f).substr(0,e);p.length<e&&(p+=o(e-p.length)),n=d+p}return+a>0&&e>0&&(n+="."+o(e)),n}(t,e):(Math.round(+(t+"e+"+e))/Math.pow(10,e)).toFixed(e)}(e,r),a=i.toString().split("."),s=l(a,2),u=s[0],c=s[1];return(void 0===c?"":c).match(/^0+$/)&&n?u:i.toString()}function s(t,e,n,r){var i=t,o=i.toString().split("."),a=l(o,2),s=a[0],u=a[1];if(s.match(/^-?0$/)&&n)return u?s.replace("0","")+"."+u:s.replace("0","");if(s.length<r)for(var c=r-s.length,h=0;h<c;h++)i="0"+i;return i.toString()}function u(t){var e=t.instance,n=t.providedFormat,r=t.state,o=void 0===r?h:r,u=t.decimalSeparator,c=t.defaults,l=void 0===c?o.currentDefaults():c,f=e._value;if(0===f&&o.hasZeroFormat())return o.getZeroFormat();if(!isFinite(f))return f.toString();var d=Object.assign({},g,l,n),p=d.totalLength,m=p?0:d.characteristic,v=d.optionalCharacteristic,y=d.forceAverage,w=!!p||!!y||d.average,b=p?-1:w&&void 0===n.mantissa?0:d.mantissa,x=!p&&d.optionalMantissa,_=d.thousandSeparated,M=d.spaceSeparated,E=d.negative,S=d.forceSign,T=d.exponential,A="";if(w){var k=function(t){var e=t.value,n=t.forceAverage,r=t.abbreviations,i=t.spaceSeparated,o=void 0!==i&&i,a=t.totalLength,s=void 0===a?0:a,u="",c=Math.abs(e),l=-1;if(c>=Math.pow(10,12)&&!n||"trillion"===n?(u=r.trillion,e/=Math.pow(10,12)):c<Math.pow(10,12)&&c>=Math.pow(10,9)&&!n||"billion"===n?(u=r.billion,e/=Math.pow(10,9)):c<Math.pow(10,9)&&c>=Math.pow(10,6)&&!n||"million"===n?(u=r.million,e/=Math.pow(10,6)):(c<Math.pow(10,6)&&c>=Math.pow(10,3)&&!n||"thousand"===n)&&(u=r.thousand,e/=Math.pow(10,3)),u&&(u=(o?" ":"")+u),s){var h=e.toString().split(".")[0];l=Math.max(s-h.length,0)}return{value:e,abbreviation:u,mantissaPrecision:l}}({value:f,forceAverage:y,abbreviations:o.currentAbbreviations(),spaceSeparated:M,totalLength:p});f=k.value,A+=k.abbreviation,p&&(b=k.mantissaPrecision)}if(T){var C=i({value:f,characteristicPrecision:m});f=C.value,A=C.abbreviation+A}var R=a(f.toString(),f,x,b);return R=function(t,e,n,r,i){var o=r.currentDelimiters(),a=o.thousands;i=i||o.decimal;var s=o.thousandsSize||3,u=t.toString(),c=u.split(".")[0],l=u.split(".")[1];return n&&(e<0&&(c=c.slice(1)),function(t,e){for(var n=[],r=0,i=c.length;i>0;i--)r===e&&(n.unshift(i),r=0),r++;return n}(0,s).forEach(function(t,e){c=c.slice(0,t+e)+a+c.slice(t+e)}),e<0&&(c="-"+c)),l?c+i+l:c}(R=s(R,0,v,m),f,_,o,u),(w||T)&&(R+=A),(S||f<0)&&(R=function(t,e,n){return 0===e?t:0==+t?t.replace("-",""):e>0?"+"+t:"sign"===n?t:"("+t.replace("-","")+")"}(R,f,E)),R}function c(t,e){if(!t)return e;var n=Object.keys(t);return 1===n.length&&"output"===n[0]?e:t}var l=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},h=t("./globalState"),f=t("./validating"),d=t("./parsing"),p=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],m={general:{scale:1024,suffixes:p,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:p,marker:"d"}},g={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};e.exports=function(t){return{format:function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2];if("string"==typeof e&&(e=d.parseFormat(e)),!f.validateFormat(e))return"ERROR: invalid format";var i=e.prefix||"",o=e.postfix||"",a=function(t,e,n){switch(e.output){case"currency":return function(t,e,n){var r=n.currentCurrency(),i=Object.assign({},g,e),o=void 0,a="",s=!!i.totalLength||!!i.forceAverage||i.average;i.spaceSeparated&&(a=" "),"infix"===r.position&&(o=a+r.symbol+a);var c=u({instance:t,providedFormat:e,state:n,decimalSeparator:o});return"prefix"===r.position&&(c=t._value<0&&"sign"===i.negative?"-"+a+r.symbol+c.slice(1):r.symbol+a+c),r.position&&"postfix"!==r.position||(c=c+(a=s?"":a)+r.symbol),c}(t,e=c(e,h.currentCurrencyDefaultFormat()),h);case"percent":return function(t,e,n,r){var i=e.prefixSymbol,o=u({instance:r(100*t._value),providedFormat:e,state:n}),a=Object.assign({},g,e);return i?"%"+(a.spaceSeparated?" ":"")+o:o+(a.spaceSeparated?" ":"")+"%"}(t,e=c(e,h.currentPercentageDefaultFormat()),h,n);case"byte":return function(t,e,n,i){var o=m[e.base||"binary"],a=r(t._value,o.suffixes,o.scale),s=a.suffix;return u({instance:i(a.value),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})+(n.currentAbbreviations().spaced?" ":"")+s}(t,e=c(e,h.currentByteDefaultFormat()),h,n);case"time":return e=c(e,h.currentTimeDefaultFormat()),function(t){var e=Math.floor(t._value/60/60),n=Math.floor((t._value-60*e*60)/60),r=Math.round(t._value-60*e*60-60*n);return e+":"+(n<10?"0":"")+n+":"+(r<10?"0":"")+r}(t);case"ordinal":return function(t,e,n){var r=n.currentOrdinal(),i=Object.assign({},g,e),o=u({instance:t,providedFormat:e,state:n}),a=r(t._value);return o+(i.spaceSeparated?" ":"")+a}(t,e=c(e,h.currentOrdinalDefaultFormat()),h);case"number":default:return u({instance:t,providedFormat:e,numbro:n})}}(t,e,n);return(a=i+a)+o}).apply(void 0,n.concat([t]))},getByteUnit:function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return(function(t){var e=m.general;return r(t._value,e.suffixes,e.scale).suffix}).apply(void 0,n.concat([t]))},getBinaryByteUnit:function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return(function(t){var e=m.binary;return r(t._value,e.suffixes,e.scale).suffix}).apply(void 0,n.concat([t]))},getDecimalByteUnit:function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return(function(t){var e=m.decimal;return r(t._value,e.suffixes,e.scale).suffix}).apply(void 0,n.concat([t]))},formatOrDefault:c}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,e,n){"use strict";function r(t){c=t}function i(){return l[c]}var o=t("./en-US"),a=t("./validating"),s=t("./parsing"),u={},c=void 0,l={},h=null,f={};u.languages=function(){return Object.assign({},l)},u.currentLanguage=function(){return c},u.currentCurrency=function(){return i().currency},u.currentAbbreviations=function(){return i().abbreviations},u.currentDelimiters=function(){return i().delimiters},u.currentOrdinal=function(){return i().ordinal},u.currentDefaults=function(){return Object.assign({},i().defaults,f)},u.currentOrdinalDefaultFormat=function(){return Object.assign({},u.currentDefaults(),i().ordinalFormat)},u.currentByteDefaultFormat=function(){return Object.assign({},u.currentDefaults(),i().byteFormat)},u.currentPercentageDefaultFormat=function(){return Object.assign({},u.currentDefaults(),i().percentageFormat)},u.currentCurrencyDefaultFormat=function(){return Object.assign({},u.currentDefaults(),i().currencyFormat)},u.currentTimeDefaultFormat=function(){return Object.assign({},u.currentDefaults(),i().timeFormat)},u.setDefaults=function(t){t=s.parseFormat(t),a.validateFormat(t)&&(f=t)},u.getZeroFormat=function(){return h},u.setZeroFormat=function(t){return h="string"==typeof t?t:null},u.hasZeroFormat=function(){return null!==h},u.languageData=function(t){if(t){if(l[t])return l[t];throw new Error('Unknown tag "'+t+'"')}return i()},u.registerLanguage=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!a.validateLanguage(t))throw new Error("Invalid language data");l[t.languageTag]=t,e&&r(t.languageTag)},u.setLanguage=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.languageTag;if(!l[t]){var n=t.split("-")[0],i=Object.keys(l).find(function(t){return t.split("-")[0]===n});if(!l[i])return void r(e);r(i)}r(t)},u.registerLanguage(o),c=o.languageTag,e.exports=u},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(t,e,n){"use strict";function r(e,n){e.forEach(function(e){var r=void 0;try{r=t("../languages/"+e)}catch(t){console.error('Unable to load "'+e+'". No matching language file found.')}r&&n.registerLanguage(r)})}e.exports=function(t){return{loadLanguagesInNode:function(e){return r(e,t)}}}},{}],6:[function(t,e,n){"use strict";function r(t,e,n){var r=new i(t._value),o=e;return n.isNumbro(e)&&(o=e._value),o=new i(o),t._value=r.minus(o).toNumber(),t}var i=t("bignumber.js");e.exports=function(t){return{add:function(e,n){return function(t,e,n){var r=new i(t._value),o=e;return n.isNumbro(e)&&(o=e._value),o=new i(o),t._value=r.add(o).toNumber(),t}(e,n,t)},subtract:function(e,n){return r(e,n,t)},multiply:function(e,n){return function(t,e,n){var r=new i(t._value),o=e;return n.isNumbro(e)&&(o=e._value),o=new i(o),t._value=r.times(o).toNumber(),t}(e,n,t)},divide:function(e,n){return function(t,e,n){var r=new i(t._value),o=e;return n.isNumbro(e)&&(o=e._value),o=new i(o),t._value=r.dividedBy(o).toNumber(),t}(e,n,t)},set:function(e,n){return function(t,e,n){var r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}(e,n,t)},difference:function(e,n){return function(t,e,n){var i=n(t._value);return r(i,e,n),Math.abs(i._value)}(e,n,t)}}}},{"bignumber.js":1}],7:[function(t,e,n){"use strict";function r(t){var e=t;return i.isNumbro(t)?e=t._value:"string"==typeof t?e=i.unformat(t):isNaN(t)&&(e=NaN),e}function i(t){return new d(r(t))}var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=t("./globalState"),s=t("./validating"),u=t("./loading")(i),c=t("./unformatting"),l=t("./formatting")(i),h=t("./manipulating")(i),f=t("./parsing"),d=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this._value=e}return o(t,[{key:"clone",value:function(){return i(this._value)}},{key:"format",value:function(){return l.format(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}},{key:"formatCurrency",value:function(t){return"string"==typeof t&&(t=f.parseFormat(t)),(t=l.formatOrDefault(t,a.currentCurrencyDefaultFormat())).output="currency",l.format(this,t)}},{key:"formatTime",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.output="time",l.format(this,t)}},{key:"binaryByteUnits",value:function(){return l.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return l.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return l.getByteUnit(this)}},{key:"difference",value:function(t){return h.difference(this,t)}},{key:"add",value:function(t){return h.add(this,t)}},{key:"subtract",value:function(t){return h.subtract(this,t)}},{key:"multiply",value:function(t){return h.multiply(this,t)}},{key:"divide",value:function(t){return h.divide(this,t)}},{key:"set",value:function(t){return h.set(this,r(t))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}]),t}();i.version="2.0.5",i.isNumbro=function(t){return t instanceof d},i.language=a.currentLanguage,i.registerLanguage=a.registerLanguage,i.setLanguage=a.setLanguage,i.languages=a.languages,i.languageData=a.languageData,i.zeroFormat=a.setZeroFormat,i.defaultFormat=a.currentDefaults,i.setDefaults=a.setDefaults,i.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,i.validate=s.validate,i.loadLanguagesInNode=u.loadLanguagesInNode,i.unformat=c.unformat,e.exports=i},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,e,n){"use strict";e.exports={parseFormat:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof t?t:(function(t,e){if(-1===t.indexOf("$")){if(-1===t.indexOf("%"))return-1!==t.indexOf("bd")?(e.output="byte",void(e.base="general")):-1!==t.indexOf("b")?(e.output="byte",void(e.base="binary")):-1!==t.indexOf("d")?(e.output="byte",void(e.base="decimal")):void(-1===t.indexOf(":")?-1!==t.indexOf("o")&&(e.output="ordinal"):e.output="time");e.output="percent"}else e.output="currency"}(t=function(t,e){var n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}(t=function(t,e){var n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}(t,e),e),e),function(t,e){var n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}(t,e),function(t,e){var n=t.split(".")[0].match(/0+/);n&&(e.characteristic=n[0].length)}(t,e),function(t,e){if(-1!==t.indexOf(".")){var n=t.split(".")[0];e.optionalCharacteristic=-1===n.indexOf("0")}}(t,e),function(t,e){-1!==t.indexOf("a")&&(e.average=!0)}(t,e),function(t,e){-1!==t.indexOf("K")?e.forceAverage="thousand":-1!==t.indexOf("M")?e.forceAverage="million":-1!==t.indexOf("B")?e.forceAverage="billion":-1!==t.indexOf("T")&&(e.forceAverage="trillion")}(t,e),function(t,e){var n=t.split(".")[1];if(n){var r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}(t,e),function(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}(t,e),function(t,e){-1!==t.indexOf(",")&&(e.thousandSeparated=!0)}(t,e),function(t,e){-1!==t.indexOf(" ")&&(e.spaceSeparated=!0)}(t,e),function(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}(t,e),function(t,e){t.match(/^\+/)&&(e.forceSign=!0)}(t,e),e)}}},{}],9:[function(t,e,n){"use strict";function r(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function i(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments[3],a=arguments[4],u=arguments[5],c=arguments[6];if(!isNaN(+t))return+t;var l="",h=t.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(h!==t)return-1*i(h,e,n,o,a,u,c);for(var f=0;f<s.length;f++){var d=s[f];if((l=t.replace(d.key,""))!==t)return i(l,e,n,o,a,u,c)*d.factor}if((l=t.replace("%",""))!==t)return i(l,e,n,o,a,u,c)/100;var p=parseFloat(t);if(!isNaN(p)){var m=o(p);if(m&&"."!==m&&(l=t.replace(new RegExp(r(m)+"$"),""))!==t)return i(l,e,n,o,a,u,c);var g={};Object.keys(u).forEach(function(t){g[u[t]]=t});for(var v=Object.keys(g).sort().reverse(),y=v.length,w=0;w<y;w++){var b=v[w],x=g[b];if((l=t.replace(b,""))!==t){var _=void 0;switch(x){case"thousand":_=Math.pow(10,3);break;case"million":_=Math.pow(10,6);break;case"billion":_=Math.pow(10,9);break;case"trillion":_=Math.pow(10,12)}return i(l,e,n,o,a,u,c)*_}}}}function o(t,e){var n=t.replace(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"","");return(n=n.replace(new RegExp("([0-9])"+r(e.thousands)+"([0-9])","g"),"$1$2")).replace(e.decimal,".")}function a(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments[3],a=arguments[4],s=arguments[5],u=arguments[6];if(""!==t)return isNaN(+t)?t===a?0:i(o(t,e,n),e,n,r,a,s,u):+t}var s=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];e.exports={unformat:function(e,n){var r=t("./globalState"),i=r.currentDelimiters(),o=r.currentCurrency().symbol,s=r.currentOrdinal(),u=r.getZeroFormat(),c=r.currentAbbreviations(),l=void 0;if("string"==typeof e)l=function(t,e){if(!t.indexOf(":")||":"===e.thousands)return!1;var n=t.split(":");if(3!==n.length)return!1;var r=+n[1],i=+n[2];return!isNaN(+n[0])&&!isNaN(r)&&!isNaN(i)}(e,i)?function(t){var e=t.split(":");return+e[2]+60*+e[1]+3600*+e[0]}(e):a(e,i,o,s,u,c,n);else{if("number"!=typeof e)return;l=e}if(void 0!==l)return l}}},{"./globalState":4}],10:[function(t,e,n){"use strict";function r(t){return!!s.unformat(t)}function i(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=Object.keys(t).map(function(r){if(!e[r])return console.error(n+" Invalid key: "+r),!1;var o=t[r],s=e[r];if("string"==typeof s&&(s={type:s}),"format"===s.type){if(!i(o,c,"[Validate "+r+"]",!0))return!1}else if((void 0===o?"undefined":a(o))!==s.type)return console.error(n+" "+r+' type mismatched: "'+s.type+'" expected, "'+(void 0===o?"undefined":a(o))+'" provided'),!1;if(s.restrictions&&s.restrictions.length)for(var u=s.restrictions.length,l=0;l<u;l++){var h=s.restrictions[l],f=h.message;if(!(0,h.restriction)(o,t))return console.error(n+" "+r+" invalid value: "+f),!1}return s.restriction&&!s.restriction(o,t)?(console.error(n+" "+r+" invalid value: "+s.message),!1):s.validValues&&-1===s.validValues.indexOf(o)?(console.error(n+" "+r+" invalid value: must be among "+JSON.stringify(s.validValues)+', "'+o+'" provided'),!1):!(s.children&&!i(o,s.children,"[Validate "+r+"]"))});return r||o.push.apply(o,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(Object.keys(e).map(function(r){var i=e[r];if("string"==typeof i&&(i={type:i}),i.mandatory){var o=i.mandatory;if("function"==typeof o&&(o=o(t)),o&&void 0===t[r])return console.error(n+' Missing mandatory key "'+r+'"'),!1}return!0}))),o.reduce(function(t,e){return t&&e},!0)}function o(t){return i(t,c,"[Validate format]")}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=t("./unformatting"),u=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,c={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(t,e){return"byte"===e.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(t){return"byte"===t.output}},characteristic:{type:"number",restriction:function(t){return t>=0},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",totalLength:{type:"number",restrictions:[{restriction:function(t){return t>=0},message:"value must be positive"},{restriction:function(t,e){return!e.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(t){return t>=0},message:"value must be positive"},optionalMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(t,e){return"percent"===e.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},l={languageTag:{type:"string",mandatory:!0,restriction:function(t){return t.match(u)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};e.exports={validate:function(t,e){var n=r(t),i=o(e);return n&&i},validateFormat:o,validateInput:r,validateLanguage:function(t){return i(t,l,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.moment=e()}(this,function(){"use strict";function t(){return Qt.apply(null,arguments)}function e(t){return t instanceof Array||"[object Array]"===Object.prototype.toString.call(t)}function n(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)}function r(t){return void 0===t}function i(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)}function o(t){return t instanceof Date||"[object Date]"===Object.prototype.toString.call(t)}function a(t,e){var n,r=[];for(n=0;n<t.length;++n)r.push(e(t[n],n));return r}function s(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function u(t,e){for(var n in e)s(e,n)&&(t[n]=e[n]);return s(e,"toString")&&(t.toString=e.toString),s(e,"valueOf")&&(t.valueOf=e.valueOf),t}function c(t,e,n,r){return gt(t,e,n,r,!0).utc()}function l(t){return null==t._pf&&(t._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),t._pf}function h(t){if(null==t._isValid){var e=l(t),n=Jt.call(e.parsedDateParts,function(t){return null!=t}),r=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n);if(t._strict&&(r=r&&0===e.charsLeftOver&&0===e.unusedTokens.length&&void 0===e.bigHour),null!=Object.isFrozen&&Object.isFrozen(t))return r;t._isValid=r}return t._isValid}function f(t){var e=c(NaN);return null!=t?u(l(e),t):l(e).userInvalidated=!0,e}function d(t,e){var n,i,o;if(r(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),r(e._i)||(t._i=e._i),r(e._f)||(t._f=e._f),r(e._l)||(t._l=e._l),r(e._strict)||(t._strict=e._strict),r(e._tzm)||(t._tzm=e._tzm),r(e._isUTC)||(t._isUTC=e._isUTC),r(e._offset)||(t._offset=e._offset),r(e._pf)||(t._pf=l(e)),r(e._locale)||(t._locale=e._locale),Kt.length>0)for(n=0;n<Kt.length;n++)r(o=e[i=Kt[n]])||(t[i]=o);return t}function p(e){d(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===te&&(te=!0,t.updateOffset(this),te=!1)}function m(t){return t instanceof p||null!=t&&null!=t._isAMomentObject}function g(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function v(t){var e=+t,n=0;return 0!==e&&isFinite(e)&&(n=g(e)),n}function y(t,e,n){var r,i=Math.min(t.length,e.length),o=Math.abs(t.length-e.length),a=0;for(r=0;r<i;r++)(n&&t[r]!==e[r]||!n&&v(t[r])!==v(e[r]))&&a++;return a+o}function w(e){!1===t.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function b(e,n){var r=!0;return u(function(){if(null!=t.deprecationHandler&&t.deprecationHandler(null,e),r){for(var i,o=[],a=0;a<arguments.length;a++){if(i="","object"==typeof arguments[a]){for(var s in i+="\n["+a+"] ",arguments[0])i+=s+": "+arguments[0][s]+", ";i=i.slice(0,-2)}else i=arguments[a];o.push(i)}w(e+"\nArguments: "+Array.prototype.slice.call(o).join("")+"\n"+(new Error).stack),r=!1}return n.apply(this,arguments)},n)}function x(e,n){null!=t.deprecationHandler&&t.deprecationHandler(e,n),ee[e]||(w(n),ee[e]=!0)}function _(t){return t instanceof Function||"[object Function]"===Object.prototype.toString.call(t)}function M(t,e){var r,i=u({},t);for(r in e)s(e,r)&&(n(t[r])&&n(e[r])?(i[r]={},u(i[r],t[r]),u(i[r],e[r])):null!=e[r]?i[r]=e[r]:delete i[r]);for(r in t)s(t,r)&&!s(e,r)&&n(t[r])&&(i[r]=u({},i[r]));return i}function E(t){null!=t&&this.set(t)}function S(t,e){var n=t.toLowerCase();ne[n]=ne[n+"s"]=ne[e]=t}function T(t){return"string"==typeof t?ne[t]||ne[t.toLowerCase()]:void 0}function A(t){var e,n,r={};for(n in t)s(t,n)&&(e=T(n))&&(r[e]=t[n]);return r}function k(t,e){re[t]=e}function C(t,e,n){var r=""+Math.abs(t);return(t>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,e-r.length)).toString().substr(1)+r}function R(t,e,n,r){var i=r;"string"==typeof r&&(i=function(){return this[r]()}),t&&(se[t]=i),e&&(se[e[0]]=function(){return C(i.apply(this,arguments),e[1],e[2])}),n&&(se[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function D(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function L(t,e){return t.isValid()?(e=O(e,t.localeData()),ae[e]=ae[e]||function(t){var e,n,r=t.match(ie);for(e=0,n=r.length;e<n;e++)r[e]=se[r[e]]?se[r[e]]:D(r[e]);return function(e){var i,o="";for(i=0;i<n;i++)o+=_(r[i])?r[i].call(e,t):r[i];return o}}(e),ae[e](t)):t.localeData().invalidDate()}function O(t,e){function n(t){return e.longDateFormat(t)||t}var r=5;for(oe.lastIndex=0;r>=0&&oe.test(t);)t=t.replace(oe,n),oe.lastIndex=0,r-=1;return t}function P(t,e,n){Ee[t]=_(e)?e:function(t,r){return t&&n?n:e}}function I(t,e){return s(Ee,t)?Ee[t](e._strict,e._locale):new RegExp(function(t){return N(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,e,n,r,i){return e||n||r||i}))}(t))}function N(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function F(t,e){var n,r=e;for("string"==typeof t&&(t=[t]),i(e)&&(r=function(t,n){n[e]=v(t)}),n=0;n<t.length;n++)Se[t[n]]=r}function j(t,e){F(t,function(t,n,r,i){r._w=r._w||{},e(t,r._w,r,i)})}function z(t,e,n){null!=e&&s(Se,t)&&Se[t](e,n._a,n,t)}function U(t){return V(t)?366:365}function V(t){return t%4==0&&t%100!=0||t%400==0}function B(e,n){return function(r){return null!=r?(q(this,e,r),t.updateOffset(this,n),this):H(this,e)}}function H(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function q(t,e,n){t.isValid()&&!isNaN(n)&&("FullYear"===e&&V(t.year())&&1===t.month()&&29===t.date()?t._d["set"+(t._isUTC?"UTC":"")+e](n,t.month(),G(n,t.month())):t._d["set"+(t._isUTC?"UTC":"")+e](n))}function G(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=function(t,e){return(t%12+12)%12}(e);return t+=(e-n)/12,1===n?V(t)?29:28:31-n%7%2}function W(t,e){var n;if(!t.isValid())return t;if("string"==typeof e)if(/^\d+$/.test(e))e=v(e);else if(!i(e=t.localeData().monthsParse(e)))return t;return n=Math.min(t.date(),G(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t}function Y(e){return null!=e?(W(this,e),t.updateOffset(this,!0),this):H(this,"Month")}function X(){function t(t,e){return e.length-t.length}var e,n,r=[],i=[],o=[];for(e=0;e<12;e++)n=c([2e3,e]),r.push(this.monthsShort(n,"")),i.push(this.months(n,"")),o.push(this.months(n,"")),o.push(this.monthsShort(n,""));for(r.sort(t),i.sort(t),o.sort(t),e=0;e<12;e++)r[e]=N(r[e]),i[e]=N(i[e]);for(e=0;e<24;e++)o[e]=N(o[e]);this._monthsRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function $(t){var e=new Date(Date.UTC.apply(null,arguments));return t<100&&t>=0&&isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t),e}function Q(t,e,n){var r=7+e-n;return-(7+$(t,0,r).getUTCDay()-e)%7+r-1}function J(t,e,n,r,i){var o,a,s=1+7*(e-1)+(7+n-r)%7+Q(t,r,i);return s<=0?a=U(o=t-1)+s:s>U(t)?(o=t+1,a=s-U(t)):(o=t,a=s),{year:o,dayOfYear:a}}function Z(t,e,n){var r,i,o=Q(t.year(),e,n),a=Math.floor((t.dayOfYear()-o-1)/7)+1;return a<1?r=a+K(i=t.year()-1,e,n):a>K(t.year(),e,n)?(r=a-K(t.year(),e,n),i=t.year()+1):(i=t.year(),r=a),{week:r,year:i}}function K(t,e,n){var r=Q(t,e,n),i=Q(t+1,e,n);return(U(t)-r+i)/7}function tt(){function t(t,e){return e.length-t.length}var e,n,r,i,o,a=[],s=[],u=[],l=[];for(e=0;e<7;e++)n=c([2e3,1]).day(e),r=this.weekdaysMin(n,""),i=this.weekdaysShort(n,""),o=this.weekdays(n,""),a.push(r),s.push(i),u.push(o),l.push(r),l.push(i),l.push(o);for(a.sort(t),s.sort(t),u.sort(t),l.sort(t),e=0;e<7;e++)s[e]=N(s[e]),u[e]=N(u[e]),l[e]=N(l[e]);this._weekdaysRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function et(){return this.hours()%12||12}function nt(t,e){R(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}function rt(t,e){return e._meridiemParse}function it(t){return t?t.toLowerCase().replace("_","-"):t}function ot(t){var e=null;if(!Je[t]&&"undefined"!=typeof module&&module&&module.exports)try{e=Xe._abbr,require("./locale/"+t),at(e)}catch(t){}return Je[t]}function at(t,e){var n;return t&&(n=r(e)?ut(t):st(t,e))&&(Xe=n),Xe._abbr}function st(t,e){if(null!==e){var n=Qe;if(e.abbr=t,null!=Je[t])x("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Je[t]._config;else if(null!=e.parentLocale){if(null==Je[e.parentLocale])return Ze[e.parentLocale]||(Ze[e.parentLocale]=[]),Ze[e.parentLocale].push({name:t,config:e}),null;n=Je[e.parentLocale]._config}return Je[t]=new E(M(n,e)),Ze[t]&&Ze[t].forEach(function(t){st(t.name,t.config)}),at(t),Je[t]}return delete Je[t],null}function ut(t){var n;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Xe;if(!e(t)){if(n=ot(t))return n;t=[t]}return function(t){for(var e,n,r,i,o=0;o<t.length;){for(e=(i=it(t[o]).split("-")).length,n=(n=it(t[o+1]))?n.split("-"):null;e>0;){if(r=ot(i.slice(0,e).join("-")))return r;if(n&&n.length>=e&&y(i,n,!0)>=e-1)break;e--}o++}return null}(t)}function ct(t){var e,n=t._a;return n&&-2===l(t).overflow&&(e=n[Ae]<0||n[Ae]>11?Ae:n[ke]<1||n[ke]>G(n[Te],n[Ae])?ke:n[Ce]<0||n[Ce]>24||24===n[Ce]&&(0!==n[Re]||0!==n[De]||0!==n[Le])?Ce:n[Re]<0||n[Re]>59?Re:n[De]<0||n[De]>59?De:n[Le]<0||n[Le]>999?Le:-1,l(t)._overflowDayOfYear&&(e<Te||e>ke)&&(e=ke),l(t)._overflowWeeks&&-1===e&&(e=Oe),l(t)._overflowWeekday&&-1===e&&(e=Pe),l(t).overflow=e),t}function lt(t,e,n){return null!=t?t:null!=e?e:n}function ht(e){var n,r,i,o,a,s=[];if(!e._d){for(i=function(e){var n=new Date(t.now());return e._useUTC?[n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()]:[n.getFullYear(),n.getMonth(),n.getDate()]}(e),e._w&&null==e._a[ke]&&null==e._a[Ae]&&function(t){var e,n,r,i,o,a,s,u;if(null!=(e=t._w).GG||null!=e.W||null!=e.E)o=1,a=4,n=lt(e.GG,t._a[Te],Z(vt(),1,4).year),r=lt(e.W,1),((i=lt(e.E,1))<1||i>7)&&(u=!0);else{o=t._locale._week.dow,a=t._locale._week.doy;var c=Z(vt(),o,a);n=lt(e.gg,t._a[Te],c.year),r=lt(e.w,c.week),null!=e.d?((i=e.d)<0||i>6)&&(u=!0):null!=e.e?(i=e.e+o,(e.e<0||e.e>6)&&(u=!0)):i=o}r<1||r>K(n,o,a)?l(t)._overflowWeeks=!0:null!=u?l(t)._overflowWeekday=!0:(s=J(n,r,i,o,a),t._a[Te]=s.year,t._dayOfYear=s.dayOfYear)}(e),null!=e._dayOfYear&&(a=lt(e._a[Te],i[Te]),(e._dayOfYear>U(a)||0===e._dayOfYear)&&(l(e)._overflowDayOfYear=!0),r=$(a,0,e._dayOfYear),e._a[Ae]=r.getUTCMonth(),e._a[ke]=r.getUTCDate()),n=0;n<3&&null==e._a[n];++n)e._a[n]=s[n]=i[n];for(;n<7;n++)e._a[n]=s[n]=null==e._a[n]?2===n?1:0:e._a[n];24===e._a[Ce]&&0===e._a[Re]&&0===e._a[De]&&0===e._a[Le]&&(e._nextDay=!0,e._a[Ce]=0),e._d=(e._useUTC?$:function(t,e,n,r,i,o,a){var s=new Date(t,e,n,r,i,o,a);return t<100&&t>=0&&isFinite(s.getFullYear())&&s.setFullYear(t),s}).apply(null,s),o=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Ce]=24),e._w&&void 0!==e._w.d&&e._w.d!==o&&(l(e).weekdayMismatch=!0)}}function ft(t){var e,n,r,i,o,a,s=t._i,u=Ke.exec(s)||tn.exec(s);if(u){for(l(t).iso=!0,e=0,n=nn.length;e<n;e++)if(nn[e][1].exec(u[1])){i=nn[e][0],r=!1!==nn[e][2];break}if(null==i)return void(t._isValid=!1);if(u[3]){for(e=0,n=rn.length;e<n;e++)if(rn[e][1].exec(u[3])){o=(u[2]||" ")+rn[e][0];break}if(null==o)return void(t._isValid=!1)}if(!r&&null!=o)return void(t._isValid=!1);if(u[4]){if(!en.exec(u[4]))return void(t._isValid=!1);a="Z"}t._f=i+(o||"")+(a||""),pt(t)}else t._isValid=!1}function dt(t){var e=an.exec(function(t){return t.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}(t._i));if(e){var n=function(t,e,n,r,i,o){var a=[function(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}(t),ze.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&a.push(parseInt(o,10)),a}(e[4],e[3],e[2],e[5],e[6],e[7]);if(!function(t,e,n){return!t||He.indexOf(t)===new Date(e[0],e[1],e[2]).getDay()||(l(n).weekdayMismatch=!0,n._isValid=!1,!1)}(e[1],n,t))return;t._a=n,t._tzm=function(t,e,n){if(t)return sn[t];if(e)return 0;var r=parseInt(n,10),i=r%100;return(r-i)/100*60+i}(e[8],e[9],e[10]),t._d=$.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),l(t).rfc2822=!0}else t._isValid=!1}function pt(e){if(e._f!==t.ISO_8601)if(e._f!==t.RFC_2822){e._a=[],l(e).empty=!0;var n,r,i,o,a,s=""+e._i,u=s.length,c=0;for(i=O(e._f,e._locale).match(ie)||[],n=0;n<i.length;n++)(r=(s.match(I(o=i[n],e))||[])[0])&&((a=s.substr(0,s.indexOf(r))).length>0&&l(e).unusedInput.push(a),s=s.slice(s.indexOf(r)+r.length),c+=r.length),se[o]?(r?l(e).empty=!1:l(e).unusedTokens.push(o),z(o,r,e)):e._strict&&!r&&l(e).unusedTokens.push(o);l(e).charsLeftOver=u-c,s.length>0&&l(e).unusedInput.push(s),e._a[Ce]<=12&&!0===l(e).bigHour&&e._a[Ce]>0&&(l(e).bigHour=void 0),l(e).parsedDateParts=e._a.slice(0),l(e).meridiem=e._meridiem,e._a[Ce]=function(t,e,n){var r;return null==n?e:null!=t.meridiemHour?t.meridiemHour(e,n):null!=t.isPM?((r=t.isPM(n))&&e<12&&(e+=12),r||12!==e||(e=0),e):e}(e._locale,e._a[Ce],e._meridiem),ht(e),ct(e)}else dt(e);else ft(e)}function mt(s){var c=s._i,g=s._f;return s._locale=s._locale||ut(s._l),null===c||void 0===g&&""===c?f({nullInput:!0}):("string"==typeof c&&(s._i=c=s._locale.preparse(c)),m(c)?new p(ct(c)):(o(c)?s._d=c:e(g)?function(t){var e,n,r,i,o;if(0===t._f.length)return l(t).invalidFormat=!0,void(t._d=new Date(NaN));for(i=0;i<t._f.length;i++)o=0,e=d({},t),null!=t._useUTC&&(e._useUTC=t._useUTC),e._f=t._f[i],pt(e),h(e)&&(o+=l(e).charsLeftOver,o+=10*l(e).unusedTokens.length,l(e).score=o,(null==r||o<r)&&(r=o,n=e));u(t,n||e)}(s):g?pt(s):function(s){var u=s._i;r(u)?s._d=new Date(t.now()):o(u)?s._d=new Date(u.valueOf()):"string"==typeof u?function(e){var n=on.exec(e._i);null===n?(ft(e),!1===e._isValid&&(delete e._isValid,dt(e),!1===e._isValid&&(delete e._isValid,t.createFromInputFallback(e)))):e._d=new Date(+n[1])}(s):e(u)?(s._a=a(u.slice(0),function(t){return parseInt(t,10)}),ht(s)):n(u)?function(t){if(!t._d){var e=A(t._i);t._a=a([e.year,e.month,e.day||e.date,e.hour,e.minute,e.second,e.millisecond],function(t){return t&&parseInt(t,10)}),ht(t)}}(s):i(u)?s._d=new Date(u):t.createFromInputFallback(s)}(s),h(s)||(s._d=null),s))}function gt(t,r,i,o,a){var s={};return!0!==i&&!1!==i||(o=i,i=void 0),(n(t)&&function(t){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(t).length;var e;for(e in t)if(t.hasOwnProperty(e))return!1;return!0}(t)||e(t)&&0===t.length)&&(t=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=a,s._l=i,s._i=t,s._f=r,s._strict=o,function(t){var e=new p(ct(mt(s)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}()}function vt(t,e,n,r){return gt(t,e,n,r,!1)}function yt(t,n){var r,i;if(1===n.length&&e(n[0])&&(n=n[0]),!n.length)return vt();for(r=n[0],i=1;i<n.length;++i)n[i].isValid()&&!n[i][t](r)||(r=n[i]);return r}function wt(t){var e=A(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||0,a=e.day||0,s=e.hour||0,u=e.minute||0,c=e.second||0,l=e.millisecond||0;this._isValid=function(t){for(var e in t)if(-1===Ie.call(ln,e)||null!=t[e]&&isNaN(t[e]))return!1;for(var n=!1,r=0;r<ln.length;++r)if(t[ln[r]]){if(n)return!1;parseFloat(t[ln[r]])!==v(t[ln[r]])&&(n=!0)}return!0}(e),this._milliseconds=+l+1e3*c+6e4*u+1e3*s*60*60,this._days=+a+7*o,this._months=+i+3*r+12*n,this._data={},this._locale=ut(),this._bubble()}function bt(t){return t instanceof wt}function xt(t){return t<0?-1*Math.round(-1*t):Math.round(t)}function _t(t,e){R(t,0,0,function(){var t=this.utcOffset(),n="+";return t<0&&(t=-t,n="-"),n+C(~~(t/60),2)+e+C(~~t%60,2)})}function Mt(t,e){var n=(e||"").match(t);if(null===n)return null;var r=((n[n.length-1]||[])+"").match(hn)||["-",0,0],i=60*r[1]+v(r[2]);return 0===i?0:"+"===r[0]?i:-i}function Et(e,n){var r,i;return n._isUTC?(r=n.clone(),i=(m(e)||o(e)?e.valueOf():vt(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+i),t.updateOffset(r,!1),r):vt(e).local()}function St(t){return 15*-Math.round(t._d.getTimezoneOffset()/15)}function Tt(){return!!this.isValid()&&this._isUTC&&0===this._offset}function At(t,e){var n,r,o,a=t,u=null;return bt(t)?a={ms:t._milliseconds,d:t._days,M:t._months}:i(t)?(a={},e?a[e]=t:a.milliseconds=t):(u=fn.exec(t))?(n="-"===u[1]?-1:1,a={y:0,d:v(u[ke])*n,h:v(u[Ce])*n,m:v(u[Re])*n,s:v(u[De])*n,ms:v(xt(1e3*u[Le]))*n}):(u=dn.exec(t))?a={y:kt(u[2],n="-"===u[1]?-1:1),M:kt(u[3],n),w:kt(u[4],n),d:kt(u[5],n),h:kt(u[6],n),m:kt(u[7],n),s:kt(u[8],n)}:null==a?a={}:"object"==typeof a&&("from"in a||"to"in a)&&(o=function(t,e){var n;return t.isValid()&&e.isValid()?(e=Et(e,t),t.isBefore(e)?n=Ct(t,e):((n=Ct(e,t)).milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}(vt(a.from),vt(a.to)),(a={}).ms=o.milliseconds,a.M=o.months),r=new wt(a),bt(t)&&s(t,"_locale")&&(r._locale=t._locale),r}function kt(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function Ct(t,e){var n={milliseconds:0,months:0};return n.months=e.month()-t.month()+12*(e.year()-t.year()),t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function Rt(t,e){return function(n,r){var i;return null===r||isNaN(+r)||(x(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=n,n=r,r=i),Dt(this,At(n="string"==typeof n?+n:n,r),t),this}}function Dt(e,n,r,i){var o=n._milliseconds,a=xt(n._days),s=xt(n._months);e.isValid()&&(i=null==i||i,s&&W(e,H(e,"Month")+s*r),a&&q(e,"Date",H(e,"Date")+a*r),o&&e._d.setTime(e._d.valueOf()+o*r),i&&t.updateOffset(e,a||s))}function Lt(t,e){var n=12*(e.year()-t.year())+(e.month()-t.month()),r=t.clone().add(n,"months");return-(n+(e-r<0?(e-r)/(r-t.clone().add(n-1,"months")):(e-r)/(t.clone().add(n+1,"months")-r)))||0}function Ot(t){var e;return void 0===t?this._locale._abbr:(null!=(e=ut(t))&&(this._locale=e),this)}function Pt(){return this._locale}function It(t,e){R(0,[t,t.length],0,e)}function Nt(t,e,n,r,i){var o;return null==t?Z(this,r,i).year:(e>(o=K(t,r,i))&&(e=o),(function(t,e,n,r,i){var o=J(t,e,n,r,i),a=$(o.year,0,o.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}).call(this,t,e,n,r,i))}function Ft(t,e){e[Le]=v(1e3*("0."+t))}function jt(t){return t}function zt(t,e,n,r){var i=ut(),o=c().set(r,e);return i[n](o,t)}function Ut(t,e,n){if(i(t)&&(e=t,t=void 0),t=t||"",null!=e)return zt(t,e,n,"month");var r,o=[];for(r=0;r<12;r++)o[r]=zt(t,r,n,"month");return o}function Vt(t,e,n,r){"boolean"==typeof t?(i(e)&&(n=e,e=void 0),e=e||""):(n=e=t,t=!1,i(e)&&(n=e,e=void 0),e=e||"");var o=ut(),a=t?o._week.dow:0;if(null!=n)return zt(e,(n+a)%7,r,"day");var s,u=[];for(s=0;s<7;s++)u[s]=zt(e,(s+a)%7,r,"day");return u}function Bt(t,e,n,r){var i=At(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function Ht(t){return t<0?Math.floor(t):Math.ceil(t)}function qt(t){return 4800*t/146097}function Gt(t){return 146097*t/4800}function Wt(t){return function(){return this.as(t)}}function Yt(t){return function(){return this.isValid()?this._data[t]:NaN}}function Xt(t){return(t>0)-(t<0)||+t}function $t(){if(!this.isValid())return this.localeData().invalidDate();var t,e,n=Bn(this._milliseconds)/1e3,r=Bn(this._days),i=Bn(this._months);e=g((t=g(n/60))/60),n%=60,t%=60;var o=g(i/12),a=i%=12,s=r,u=e,c=t,l=n?n.toFixed(3).replace(/\.?0+$/,""):"",h=this.asSeconds();if(!h)return"P0D";var f=h<0?"-":"",d=Xt(this._months)!==Xt(h)?"-":"",p=Xt(this._days)!==Xt(h)?"-":"",m=Xt(this._milliseconds)!==Xt(h)?"-":"";return f+"P"+(o?d+o+"Y":"")+(a?d+a+"M":"")+(s?p+s+"D":"")+(u||c||l?"T":"")+(u?m+u+"H":"")+(c?m+c+"M":"")+(l?m+l+"S":"")}var Qt,Jt;Jt=Array.prototype.some?Array.prototype.some:function(t){for(var e=Object(this),n=e.length>>>0,r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};var Zt,Kt=t.momentProperties=[],te=!1,ee={};t.suppressDeprecationWarnings=!1,t.deprecationHandler=null,Zt=Object.keys?Object.keys:function(t){var e,n=[];for(e in t)s(t,e)&&n.push(e);return n};var ne={},re={},ie=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,oe=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,ae={},se={},ue=/\d/,ce=/\d\d/,le=/\d{3}/,he=/\d{4}/,fe=/[+-]?\d{6}/,de=/\d\d?/,pe=/\d\d\d\d?/,me=/\d\d\d\d\d\d?/,ge=/\d{1,3}/,ve=/\d{1,4}/,ye=/[+-]?\d{1,6}/,we=/\d+/,be=/[+-]?\d+/,xe=/Z|[+-]\d\d:?\d\d/gi,_e=/Z|[+-]\d\d(?::?\d\d)?/gi,Me=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Ee={},Se={},Te=0,Ae=1,ke=2,Ce=3,Re=4,De=5,Le=6,Oe=7,Pe=8;R("Y",0,0,function(){var t=this.year();return t<=9999?""+t:"+"+t}),R(0,["YY",2],0,function(){return this.year()%100}),R(0,["YYYY",4],0,"year"),R(0,["YYYYY",5],0,"year"),R(0,["YYYYYY",6,!0],0,"year"),S("year","y"),k("year",1),P("Y",be),P("YY",de,ce),P("YYYY",ve,he),P("YYYYY",ye,fe),P("YYYYYY",ye,fe),F(["YYYYY","YYYYYY"],Te),F("YYYY",function(e,n){n[Te]=2===e.length?t.parseTwoDigitYear(e):v(e)}),F("YY",function(e,n){n[Te]=t.parseTwoDigitYear(e)}),F("Y",function(t,e){e[Te]=parseInt(t,10)}),t.parseTwoDigitYear=function(t){return v(t)+(v(t)>68?1900:2e3)};var Ie,Ne=B("FullYear",!0);Ie=Array.prototype.indexOf?Array.prototype.indexOf:function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1},R("M",["MM",2],"Mo",function(){return this.month()+1}),R("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)}),R("MMMM",0,0,function(t){return this.localeData().months(this,t)}),S("month","M"),k("month",8),P("M",de),P("MM",de,ce),P("MMM",function(t,e){return e.monthsShortRegex(t)}),P("MMMM",function(t,e){return e.monthsRegex(t)}),F(["M","MM"],function(t,e){e[Ae]=v(t)-1}),F(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);null!=i?e[Ae]=i:l(n).invalidMonth=t});var Fe=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,je="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ze="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Ue=Me,Ve=Me;R("w",["ww",2],"wo","week"),R("W",["WW",2],"Wo","isoWeek"),S("week","w"),S("isoWeek","W"),k("week",5),k("isoWeek",5),P("w",de),P("ww",de,ce),P("W",de),P("WW",de,ce),j(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=v(t)}),R("d",0,"do","day"),R("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)}),R("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)}),R("dddd",0,0,function(t){return this.localeData().weekdays(this,t)}),R("e",0,0,"weekday"),R("E",0,0,"isoWeekday"),S("day","d"),S("weekday","e"),S("isoWeekday","E"),k("day",11),k("weekday",11),k("isoWeekday",11),P("d",de),P("e",de),P("E",de),P("dd",function(t,e){return e.weekdaysMinRegex(t)}),P("ddd",function(t,e){return e.weekdaysShortRegex(t)}),P("dddd",function(t,e){return e.weekdaysRegex(t)}),j(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);null!=i?e.d=i:l(n).invalidWeekday=t}),j(["d","e","E"],function(t,e,n,r){e[r]=v(t)});var Be="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),He="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),qe="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Ge=Me,We=Me,Ye=Me;R("H",["HH",2],0,"hour"),R("h",["hh",2],0,et),R("k",["kk",2],0,function(){return this.hours()||24}),R("hmm",0,0,function(){return""+et.apply(this)+C(this.minutes(),2)}),R("hmmss",0,0,function(){return""+et.apply(this)+C(this.minutes(),2)+C(this.seconds(),2)}),R("Hmm",0,0,function(){return""+this.hours()+C(this.minutes(),2)}),R("Hmmss",0,0,function(){return""+this.hours()+C(this.minutes(),2)+C(this.seconds(),2)}),nt("a",!0),nt("A",!1),S("hour","h"),k("hour",13),P("a",rt),P("A",rt),P("H",de),P("h",de),P("k",de),P("HH",de,ce),P("hh",de,ce),P("kk",de,ce),P("hmm",pe),P("hmmss",me),P("Hmm",pe),P("Hmmss",me),F(["H","HH"],Ce),F(["k","kk"],function(t,e,n){var r=v(t);e[Ce]=24===r?0:r}),F(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t}),F(["h","hh"],function(t,e,n){e[Ce]=v(t),l(n).bigHour=!0}),F("hmm",function(t,e,n){var r=t.length-2;e[Ce]=v(t.substr(0,r)),e[Re]=v(t.substr(r)),l(n).bigHour=!0}),F("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Ce]=v(t.substr(0,r)),e[Re]=v(t.substr(r,2)),e[De]=v(t.substr(i)),l(n).bigHour=!0}),F("Hmm",function(t,e,n){var r=t.length-2;e[Ce]=v(t.substr(0,r)),e[Re]=v(t.substr(r))}),F("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Ce]=v(t.substr(0,r)),e[Re]=v(t.substr(r,2)),e[De]=v(t.substr(i))});var Xe,$e=B("Hours",!0),Qe={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:je,monthsShort:ze,week:{dow:0,doy:6},weekdays:Be,weekdaysMin:qe,weekdaysShort:He,meridiemParse:/[ap]\.?m?\.?/i},Je={},Ze={},Ke=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,tn=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,en=/Z|[+-]\d\d(?::?\d\d)?/,nn=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],rn=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],on=/^\/?Date\((\-?\d+)/i,an=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,sn={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};t.createFromInputFallback=b("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))}),t.ISO_8601=function(){},t.RFC_2822=function(){};var un=b("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=vt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:f()}),cn=b("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=vt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:f()}),ln=["year","quarter","month","week","day","hour","minute","second","millisecond"];_t("Z",":"),_t("ZZ",""),P("Z",_e),P("ZZ",_e),F(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=Mt(_e,t)});var hn=/([\+\-]|\d\d)/gi;t.updateOffset=function(){};var fn=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,dn=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;At.fn=wt.prototype,At.invalid=function(){return At(NaN)};var pn=Rt(1,"add"),mn=Rt(-1,"subtract");t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",t.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var gn=b("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return void 0===t?this.localeData():this.locale(t)});R(0,["gg",2],0,function(){return this.weekYear()%100}),R(0,["GG",2],0,function(){return this.isoWeekYear()%100}),It("gggg","weekYear"),It("ggggg","weekYear"),It("GGGG","isoWeekYear"),It("GGGGG","isoWeekYear"),S("weekYear","gg"),S("isoWeekYear","GG"),k("weekYear",1),k("isoWeekYear",1),P("G",be),P("g",be),P("GG",de,ce),P("gg",de,ce),P("GGGG",ve,he),P("gggg",ve,he),P("GGGGG",ye,fe),P("ggggg",ye,fe),j(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=v(t)}),j(["gg","GG"],function(e,n,r,i){n[i]=t.parseTwoDigitYear(e)}),R("Q",0,"Qo","quarter"),S("quarter","Q"),k("quarter",7),P("Q",ue),F("Q",function(t,e){e[Ae]=3*(v(t)-1)}),R("D",["DD",2],"Do","date"),S("date","D"),k("date",9),P("D",de),P("DD",de,ce),P("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient}),F(["D","DD"],ke),F("Do",function(t,e){e[ke]=v(t.match(de)[0])});var vn=B("Date",!0);R("DDD",["DDDD",3],"DDDo","dayOfYear"),S("dayOfYear","DDD"),k("dayOfYear",4),P("DDD",ge),P("DDDD",le),F(["DDD","DDDD"],function(t,e,n){n._dayOfYear=v(t)}),R("m",["mm",2],0,"minute"),S("minute","m"),k("minute",14),P("m",de),P("mm",de,ce),F(["m","mm"],Re);var yn=B("Minutes",!1);R("s",["ss",2],0,"second"),S("second","s"),k("second",15),P("s",de),P("ss",de,ce),F(["s","ss"],De);var wn,bn=B("Seconds",!1);for(R("S",0,0,function(){return~~(this.millisecond()/100)}),R(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),R(0,["SSS",3],0,"millisecond"),R(0,["SSSS",4],0,function(){return 10*this.millisecond()}),R(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),R(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),R(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),R(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),R(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),S("millisecond","ms"),k("millisecond",16),P("S",ge,ue),P("SS",ge,ce),P("SSS",ge,le),wn="SSSS";wn.length<=9;wn+="S")P(wn,we);for(wn="S";wn.length<=9;wn+="S")F(wn,Ft);var xn=B("Milliseconds",!1);R("z",0,0,"zoneAbbr"),R("zz",0,0,"zoneName");var _n=p.prototype;_n.add=pn,_n.calendar=function(e,n){var r=e||vt(),i=Et(r,this).startOf("day"),o=t.calendarFormat(this,i)||"sameElse",a=n&&(_(n[o])?n[o].call(this,r):n[o]);return this.format(a||this.localeData().calendar(o,this,vt(r)))},_n.clone=function(){return new p(this)},_n.diff=function(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(!(r=Et(t,this)).isValid())return NaN;switch(i=6e4*(r.utcOffset()-this.utcOffset()),e=T(e)){case"year":o=Lt(this,r)/12;break;case"month":o=Lt(this,r);break;case"quarter":o=Lt(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:g(o)},_n.endOf=function(t){return void 0===(t=T(t))||"millisecond"===t?this:("date"===t&&(t="day"),this.startOf(t).add(1,"isoWeek"===t?"week":t).subtract(1,"ms"))},_n.format=function(e){e||(e=this.isUtc()?t.defaultFormatUtc:t.defaultFormat);var n=L(this,e);return this.localeData().postformat(n)},_n.from=function(t,e){return this.isValid()&&(m(t)&&t.isValid()||vt(t).isValid())?At({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},_n.fromNow=function(t){return this.from(vt(),t)},_n.to=function(t,e){return this.isValid()&&(m(t)&&t.isValid()||vt(t).isValid())?At({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},_n.toNow=function(t){return this.to(vt(),t)},_n.get=function(t){return _(this[t=T(t)])?this[t]():this},_n.invalidAt=function(){return l(this).overflow},_n.isAfter=function(t,e){var n=m(t)?t:vt(t);return!(!this.isValid()||!n.isValid())&&("millisecond"===(e=T(r(e)?"millisecond":e))?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf())},_n.isBefore=function(t,e){var n=m(t)?t:vt(t);return!(!this.isValid()||!n.isValid())&&("millisecond"===(e=T(r(e)?"millisecond":e))?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf())},_n.isBetween=function(t,e,n,r){return("("===(r=r||"()")[0]?this.isAfter(t,n):!this.isBefore(t,n))&&(")"===r[1]?this.isBefore(e,n):!this.isAfter(e,n))},_n.isSame=function(t,e){var n,r=m(t)?t:vt(t);return!(!this.isValid()||!r.isValid())&&("millisecond"===(e=T(e||"millisecond"))?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf()))},_n.isSameOrAfter=function(t,e){return this.isSame(t,e)||this.isAfter(t,e)},_n.isSameOrBefore=function(t,e){return this.isSame(t,e)||this.isBefore(t,e)},_n.isValid=function(){return h(this)},_n.lang=gn,_n.locale=Ot,_n.localeData=Pt,_n.max=cn,_n.min=un,_n.parsingFlags=function(){return u({},l(this))},_n.set=function(t,e){if("object"==typeof t)for(var n=function(t){var e=[];for(var n in t)e.push({unit:n,priority:re[n]});return e.sort(function(t,e){return t.priority-e.priority}),e}(t=A(t)),r=0;r<n.length;r++)this[n[r].unit](t[n[r].unit]);else if(_(this[t=T(t)]))return this[t](e);return this},_n.startOf=function(t){switch(t=T(t)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===t&&this.weekday(0),"isoWeek"===t&&this.isoWeekday(1),"quarter"===t&&this.month(3*Math.floor(this.month()/3)),this},_n.subtract=mn,_n.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]},_n.toObject=function(){return{years:this.year(),months:this.month(),date:this.date(),hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()}},_n.toDate=function(){return new Date(this.valueOf())},_n.toISOString=function(t){if(!this.isValid())return null;var e=!0!==t,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?L(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):_(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this._d.valueOf()).toISOString().replace("Z",L(n,"Z")):L(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},_n.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="";this.isLocal()||(t=0===this.utcOffset()?"moment.utc":"moment.parseZone",e="Z");var n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY";return this.format(n+r+"-MM-DD[T]HH:mm:ss.SSS"+e+'[")]')},_n.toJSON=function(){return this.isValid()?this.toISOString():null},_n.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},_n.unix=function(){return Math.floor(this.valueOf()/1e3)},_n.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},_n.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},_n.year=Ne,_n.isLeapYear=function(){return V(this.year())},_n.weekYear=function(t){return Nt.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},_n.isoWeekYear=function(t){return Nt.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)},_n.quarter=_n.quarters=function(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)},_n.month=Y,_n.daysInMonth=function(){return G(this.year(),this.month())},_n.week=_n.weeks=function(t){var e=this.localeData().week(this);return null==t?e:this.add(7*(t-e),"d")},_n.isoWeek=_n.isoWeeks=function(t){var e=Z(this,1,4).week;return null==t?e:this.add(7*(t-e),"d")},_n.weeksInYear=function(){var t=this.localeData()._week;return K(this.year(),t.dow,t.doy)},_n.isoWeeksInYear=function(){return K(this.year(),1,4)},_n.date=vn,_n.day=_n.days=function(t){if(!this.isValid())return null!=t?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(t=function(t,e){return"string"!=typeof t?t:isNaN(t)?"number"==typeof(t=e.weekdaysParse(t))?t:null:parseInt(t,10)}(t,this.localeData()),this.add(t-e,"d")):e},_n.weekday=function(t){if(!this.isValid())return null!=t?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")},_n.isoWeekday=function(t){if(!this.isValid())return null!=t?this:NaN;if(null!=t){var e=function(t,e){return"string"==typeof t?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}(t,this.localeData());return this.day(this.day()%7?e:e-7)}return this.day()||7},_n.dayOfYear=function(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")},_n.hour=_n.hours=$e,_n.minute=_n.minutes=yn,_n.second=_n.seconds=bn,_n.millisecond=_n.milliseconds=xn,_n.utcOffset=function(e,n,r){var i,o=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=Mt(_e,e)))return this}else Math.abs(e)<16&&!r&&(e*=60);return!this._isUTC&&n&&(i=St(this)),this._offset=e,this._isUTC=!0,null!=i&&this.add(i,"m"),o!==e&&(!n||this._changeInProgress?Dt(this,At(e-o,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,t.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?o:St(this)},_n.utc=function(t){return this.utcOffset(0,t)},_n.local=function(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(St(this),"m")),this},_n.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var t=Mt(xe,this._i);null!=t?this.utcOffset(t):this.utcOffset(0,!0)}return this},_n.hasAlignedHourOffset=function(t){return!!this.isValid()&&(t=t?vt(t).utcOffset():0,(this.utcOffset()-t)%60==0)},_n.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},_n.isLocal=function(){return!!this.isValid()&&!this._isUTC},_n.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},_n.isUtc=Tt,_n.isUTC=Tt,_n.zoneAbbr=function(){return this._isUTC?"UTC":""},_n.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},_n.dates=b("dates accessor is deprecated. Use date instead.",vn),_n.months=b("months accessor is deprecated. Use month instead",Y),_n.years=b("years accessor is deprecated. Use year instead",Ne),_n.zone=b("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(t,e){return null!=t?("string"!=typeof t&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}),_n.isDSTShifted=b("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!r(this._isDSTShifted))return this._isDSTShifted;var t={};if(d(t,this),(t=mt(t))._a){var e=t._isUTC?c(t._a):vt(t._a);this._isDSTShifted=this.isValid()&&y(t._a,e.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted});var Mn=E.prototype;Mn.calendar=function(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return _(r)?r.call(e,n):r},Mn.longDateFormat=function(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.replace(/MMMM|MM|DD|dddd/g,function(t){return t.slice(1)}),this._longDateFormat[t])},Mn.invalidDate=function(){return this._invalidDate},Mn.ordinal=function(t){return this._ordinal.replace("%d",t)},Mn.preparse=jt,Mn.postformat=jt,Mn.relativeTime=function(t,e,n,r){var i=this._relativeTime[n];return _(i)?i(t,e,n,r):i.replace(/%d/i,t)},Mn.pastFuture=function(t,e){var n=this._relativeTime[t>0?"future":"past"];return _(n)?n(e):n.replace(/%s/i,e)},Mn.set=function(t){var e,n;for(n in t)_(e=t[n])?this[n]=e:this["_"+n]=e;this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},Mn.months=function(t,n){return t?e(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||Fe).test(n)?"format":"standalone"][t.month()]:e(this._months)?this._months:this._months.standalone},Mn.monthsShort=function(t,n){return t?e(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[Fe.test(n)?"format":"standalone"][t.month()]:e(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},Mn.monthsParse=function(t,e,n){var r,i,o;if(this._monthsParseExact)return(function(t,e,n){var r,i,o,a=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=c([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?"MMM"===e?-1!==(i=Ie.call(this._shortMonthsParse,a))?i:null:-1!==(i=Ie.call(this._longMonthsParse,a))?i:null:"MMM"===e?-1!==(i=Ie.call(this._shortMonthsParse,a))?i:-1!==(i=Ie.call(this._longMonthsParse,a))?i:null:-1!==(i=Ie.call(this._longMonthsParse,a))?i:-1!==(i=Ie.call(this._shortMonthsParse,a))?i:null}).call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=c([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[r]||(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&"MMMM"===e&&this._longMonthsParse[r].test(t))return r;if(n&&"MMM"===e&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}},Mn.monthsRegex=function(t){return this._monthsParseExact?(s(this,"_monthsRegex")||X.call(this),t?this._monthsStrictRegex:this._monthsRegex):(s(this,"_monthsRegex")||(this._monthsRegex=Ve),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)},Mn.monthsShortRegex=function(t){return this._monthsParseExact?(s(this,"_monthsRegex")||X.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(s(this,"_monthsShortRegex")||(this._monthsShortRegex=Ue),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)},Mn.week=function(t){return Z(t,this._week.dow,this._week.doy).week},Mn.firstDayOfYear=function(){return this._week.doy},Mn.firstDayOfWeek=function(){return this._week.dow},Mn.weekdays=function(t,n){return t?e(this._weekdays)?this._weekdays[t.day()]:this._weekdays[this._weekdays.isFormat.test(n)?"format":"standalone"][t.day()]:e(this._weekdays)?this._weekdays:this._weekdays.standalone},Mn.weekdaysMin=function(t){return t?this._weekdaysMin[t.day()]:this._weekdaysMin},Mn.weekdaysShort=function(t){return t?this._weekdaysShort[t.day()]:this._weekdaysShort},Mn.weekdaysParse=function(t,e,n){var r,i,o;if(this._weekdaysParseExact)return(function(t,e,n){var r,i,o,a=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=c([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?"dddd"===e?-1!==(i=Ie.call(this._weekdaysParse,a))?i:null:"ddd"===e?-1!==(i=Ie.call(this._shortWeekdaysParse,a))?i:null:-1!==(i=Ie.call(this._minWeekdaysParse,a))?i:null:"dddd"===e?-1!==(i=Ie.call(this._weekdaysParse,a))?i:-1!==(i=Ie.call(this._shortWeekdaysParse,a))?i:-1!==(i=Ie.call(this._minWeekdaysParse,a))?i:null:"ddd"===e?-1!==(i=Ie.call(this._shortWeekdaysParse,a))?i:-1!==(i=Ie.call(this._weekdaysParse,a))?i:-1!==(i=Ie.call(this._minWeekdaysParse,a))?i:null:-1!==(i=Ie.call(this._minWeekdaysParse,a))?i:-1!==(i=Ie.call(this._weekdaysParse,a))?i:-1!==(i=Ie.call(this._shortWeekdaysParse,a))?i:null}).call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=c([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".",".?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&"dddd"===e&&this._fullWeekdaysParse[r].test(t))return r;if(n&&"ddd"===e&&this._shortWeekdaysParse[r].test(t))return r;if(n&&"dd"===e&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}},Mn.weekdaysRegex=function(t){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||tt.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(s(this,"_weekdaysRegex")||(this._weekdaysRegex=Ge),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)},Mn.weekdaysShortRegex=function(t){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||tt.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(s(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=We),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},Mn.weekdaysMinRegex=function(t){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||tt.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(s(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ye),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},Mn.isPM=function(t){return"p"===(t+"").toLowerCase().charAt(0)},Mn.meridiem=function(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"},at("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10;return t+(1===v(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th")}}),t.lang=b("moment.lang is deprecated. Use moment.locale instead.",at),t.langData=b("moment.langData is deprecated. Use moment.localeData instead.",ut);var En=Math.abs,Sn=Wt("ms"),Tn=Wt("s"),An=Wt("m"),kn=Wt("h"),Cn=Wt("d"),Rn=Wt("w"),Dn=Wt("M"),Ln=Wt("y"),On=Yt("milliseconds"),Pn=Yt("seconds"),In=Yt("minutes"),Nn=Yt("hours"),Fn=Yt("days"),jn=Yt("months"),zn=Yt("years"),Un=Math.round,Vn={ss:44,s:45,m:45,h:22,d:26,M:11},Bn=Math.abs,Hn=wt.prototype;return Hn.isValid=function(){return this._isValid},Hn.abs=function(){var t=this._data;return this._milliseconds=En(this._milliseconds),this._days=En(this._days),this._months=En(this._months),t.milliseconds=En(t.milliseconds),t.seconds=En(t.seconds),t.minutes=En(t.minutes),t.hours=En(t.hours),t.months=En(t.months),t.years=En(t.years),this},Hn.add=function(t,e){return Bt(this,t,e,1)},Hn.subtract=function(t,e){return Bt(this,t,e,-1)},Hn.as=function(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if("month"===(t=T(t))||"year"===t)return n=this._months+qt(e=this._days+r/864e5),"month"===t?n:n/12;switch(e=this._days+Math.round(Gt(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return 24*e+r/36e5;case"minute":return 1440*e+r/6e4;case"second":return 86400*e+r/1e3;case"millisecond":return Math.floor(864e5*e)+r;default:throw new Error("Unknown unit "+t)}},Hn.asMilliseconds=Sn,Hn.asSeconds=Tn,Hn.asMinutes=An,Hn.asHours=kn,Hn.asDays=Cn,Hn.asWeeks=Rn,Hn.asMonths=Dn,Hn.asYears=Ln,Hn.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*v(this._months/12):NaN},Hn._bubble=function(){var t,e,n,r,i,o=this._milliseconds,a=this._days,s=this._months,u=this._data;return o>=0&&a>=0&&s>=0||o<=0&&a<=0&&s<=0||(o+=864e5*Ht(Gt(s)+a),a=0,s=0),u.milliseconds=o%1e3,t=g(o/1e3),u.seconds=t%60,e=g(t/60),u.minutes=e%60,n=g(e/60),u.hours=n%24,s+=i=g(qt(a+=g(n/24))),a-=Ht(Gt(i)),r=g(s/12),s%=12,u.days=a,u.months=s,u.years=r,this},Hn.clone=function(){return At(this)},Hn.get=function(t){return t=T(t),this.isValid()?this[t+"s"]():NaN},Hn.milliseconds=On,Hn.seconds=Pn,Hn.minutes=In,Hn.hours=Nn,Hn.days=Fn,Hn.weeks=function(){return g(this.days()/7)},Hn.months=jn,Hn.years=zn,Hn.humanize=function(t){if(!this.isValid())return this.localeData().invalidDate();var e=this.localeData(),n=function(t,e,n){var r=At(t).abs(),i=Un(r.as("s")),o=Un(r.as("m")),a=Un(r.as("h")),s=Un(r.as("d")),u=Un(r.as("M")),c=Un(r.as("y")),l=i<=Vn.ss&&["s",i]||i<Vn.s&&["ss",i]||o<=1&&["m"]||o<Vn.m&&["mm",o]||a<=1&&["h"]||a<Vn.h&&["hh",a]||s<=1&&["d"]||s<Vn.d&&["dd",s]||u<=1&&["M"]||u<Vn.M&&["MM",u]||c<=1&&["y"]||["yy",c];return l[2]=e,l[3]=+t>0,l[4]=n,(function(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}).apply(null,l)}(this,!t,e);return t&&(n=e.pastFuture(+this,n)),e.postformat(n)},Hn.toISOString=$t,Hn.toString=$t,Hn.toJSON=$t,Hn.locale=Ot,Hn.localeData=Pt,Hn.toIsoString=b("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",$t),Hn.lang=gn,R("X",0,0,"unix"),R("x",0,0,"valueOf"),P("x",be),P("X",/[+-]?\d+(\.\d{1,3})?/),F("X",function(t,e,n){n._d=new Date(1e3*parseFloat(t,10))}),F("x",function(t,e,n){n._d=new Date(v(t))}),t.version="2.20.1",Qt=vt,t.fn=_n,t.min=function(){return yt("isBefore",[].slice.call(arguments,0))},t.max=function(){return yt("isAfter",[].slice.call(arguments,0))},t.now=function(){return Date.now?Date.now():+new Date},t.utc=c,t.unix=function(t){return vt(1e3*t)},t.months=function(t,e){return Ut(t,e,"months")},t.isDate=o,t.locale=at,t.invalid=f,t.duration=At,t.isMoment=m,t.weekdays=function(t,e,n){return Vt(t,e,n,"weekdays")},t.parseZone=function(){return vt.apply(null,arguments).parseZone()},t.localeData=ut,t.isDuration=bt,t.monthsShort=function(t,e){return Ut(t,e,"monthsShort")},t.weekdaysMin=function(t,e,n){return Vt(t,e,n,"weekdaysMin")},t.defineLocale=st,t.updateLocale=function(t,e){if(null!=e){var n,r,i=Qe;null!=(r=ot(t))&&(i=r._config),(n=new E(e=M(i,e))).parentLocale=Je[t],Je[t]=n,at(t)}else null!=Je[t]&&(null!=Je[t].parentLocale?Je[t]=Je[t].parentLocale:null!=Je[t]&&delete Je[t]);return Je[t]},t.locales=function(){return Zt(Je)},t.weekdaysShort=function(t,e,n){return Vt(t,e,n,"weekdaysShort")},t.normalizeUnits=T,t.relativeTimeRounding=function(t){return void 0===t?Un:"function"==typeof t&&(Un=t,!0)},t.relativeTimeThreshold=function(t,e){return void 0!==Vn[t]&&(void 0===e?Vn[t]:(Vn[t]=e,"s"===t&&(Vn.ss=e-1),!0))},t.calendarFormat=function(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},t.prototype=_n,t.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"YYYY-[W]WW",MONTH:"YYYY-MM"},t}),function(t,e){"use strict";var n;if("object"==typeof exports){try{n=require("moment")}catch(t){}module.exports=e(n)}else"function"==typeof define&&define.amd?define(function(t){try{n=t("moment")}catch(t){}return e(n)}):t.Pikaday=e(t.moment)}(this,function(t){"use strict";var e="function"==typeof t,n=!!window.addEventListener,r=window.document,i=window.setTimeout,o=function(t,e,r,i){n?t.addEventListener(e,r,!!i):t.attachEvent("on"+e,r)},a=function(t,e,r,i){n?t.removeEventListener(e,r,!!i):t.detachEvent("on"+e,r)},s=function(t,e){return-1!==(" "+t.className+" ").indexOf(" "+e+" ")},u=function(t){return/Array/.test(Object.prototype.toString.call(t))},c=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},l=function(t){var e=t.getDay();return 0===e||6===e},h=function(t,e){return[31,function(t){return t%4==0&&t%100!=0||t%400==0}(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},f=function(t){c(t)&&t.setHours(0,0,0,0)},d=function(t,e){return t.getTime()===e.getTime()},p=function(t,e,n){var r,i;for(r in e)(i=void 0!==t[r])&&"object"==typeof e[r]&&null!==e[r]&&void 0===e[r].nodeName?c(e[r])?n&&(t[r]=new Date(e[r].getTime())):u(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=p({},e[r],n):!n&&i||(t[r]=e[r]);return t},m=function(t,e,n){var i;r.createEvent?((i=r.createEvent("HTMLEvents")).initEvent(e,!0,!1),i=p(i,n),t.dispatchEvent(i)):r.createEventObject&&(i=r.createEventObject(),i=p(i,n),t.fireEvent("on"+e,i))},g=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},v={field:null,bound:void 0,position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},y=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},w=function(t){var e=[],n="false";if(t.isEmpty){if(!t.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled")}return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},b=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},x=function(t,e,n,r,i,o){var a,s,c,l,h,f=t._o,d=n===f.minYear,p=n===f.maxYear,m='<div id="'+o+'" class="pika-title" role="heading" aria-live="assertive">',g=!0,v=!0;for(c=[],a=0;a<12;a++)c.push('<option value="'+(n===i?a-e:12+a-e)+'"'+(a===r?' selected="selected"':"")+(d&&a<f.minMonth||p&&a>f.maxMonth?'disabled="disabled"':"")+">"+f.i18n.months[a]+"</option>");for(l='<div class="pika-label">'+f.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+c.join("")+"</select></div>",u(f.yearRange)?(a=f.yearRange[0],s=f.yearRange[1]+1):(a=n-f.yearRange,s=1+n+f.yearRange),c=[];a<s&&a<=f.maxYear;a++)a>=f.minYear&&c.push('<option value="'+a+'"'+(a===n?' selected="selected"':"")+">"+a+"</option>");return h='<div class="pika-label">'+n+f.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+c.join("")+"</select></div>",m+=f.showMonthAfterYear?h+l:l+h,d&&(0===r||f.minMonth>=r)&&(g=!1),p&&(11===r||f.maxMonth<=r)&&(v=!1),0===e&&(m+='<button class="pika-prev'+(g?"":" is-disabled")+'" type="button">'+f.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(m+='<button class="pika-next'+(v?"":" is-disabled")+'" type="button">'+f.i18n.nextMonth+"</button>"),m+"</div>"},_=function(a){var u=this,l=u.config(a);u._onMouseDown=function(t){if(u._v){var e=(t=t||window.event).target||t.srcElement;if(e)if(s(e,"is-disabled")||(!s(e,"pika-button")||s(e,"is-empty")||s(e.parentNode,"is-disabled")?s(e,"pika-prev")?u.prevMonth():s(e,"pika-next")&&u.nextMonth():(u.setDate(new Date(e.getAttribute("data-pika-year"),e.getAttribute("data-pika-month"),e.getAttribute("data-pika-day"))),l.bound&&i(function(){u.hide(),l.blurFieldOnSelect&&l.field&&l.field.blur()},100))),s(e,"pika-select"))u._c=!0;else{if(!t.preventDefault)return t.returnValue=!1,!1;t.preventDefault()}}},u._onChange=function(t){var e=(t=t||window.event).target||t.srcElement;e&&(s(e,"pika-select-month")?u.gotoMonth(e.value):s(e,"pika-select-year")&&u.gotoYear(e.value))},u._onKeyChange=function(t){if(t=t||window.event,u.isVisible())switch(t.keyCode){case 13:case 27:l.field&&l.field.blur();break;case 37:t.preventDefault(),u.adjustDate("subtract",1);break;case 38:u.adjustDate("subtract",7);break;case 39:u.adjustDate("add",1);break;case 40:u.adjustDate("add",7)}},u._onInputChange=function(n){var r;n.firedBy!==u&&(r=l.parse?l.parse(l.field.value,l.format):e?(r=t(l.field.value,l.format,l.formatStrict))&&r.isValid()?r.toDate():null:new Date(Date.parse(l.field.value)),c(r)&&u.setDate(r),u._v||u.show())},u._onInputFocus=function(){u.show()},u._onInputClick=function(){u.show()},u._onInputBlur=function(){var t=r.activeElement;do{if(s(t,"pika-single"))return}while(t=t.parentNode);u._c||(u._b=i(function(){u.hide()},50)),u._c=!1},u._onClick=function(t){var e=(t=t||window.event).target||t.srcElement,r=e;if(e){!n&&s(e,"pika-select")&&(e.onchange||(e.setAttribute("onchange","return;"),o(e,"change",u._onChange)));do{if(s(r,"pika-single")||r===l.trigger)return}while(r=r.parentNode);u._v&&e!==l.trigger&&r!==l.trigger&&u.hide()}},u.el=r.createElement("div"),u.el.className="pika-single"+(l.isRTL?" is-rtl":"")+(l.theme?" "+l.theme:""),o(u.el,"mousedown",u._onMouseDown,!0),o(u.el,"touchend",u._onMouseDown,!0),o(u.el,"change",u._onChange),l.keyboardInput&&o(r,"keydown",u._onKeyChange),l.field&&(l.container?l.container.appendChild(u.el):l.bound?r.body.appendChild(u.el):l.field.parentNode.insertBefore(u.el,l.field.nextSibling),o(l.field,"change",u._onInputChange),l.defaultDate||(l.defaultDate=e&&l.field.value?t(l.field.value,l.format).toDate():new Date(Date.parse(l.field.value)),l.setDefaultDate=!0));var h=l.defaultDate;c(h)?l.setDefaultDate?u.setDate(h,!0):u.gotoDate(h):u.gotoDate(new Date),l.bound?(this.hide(),u.el.className+=" is-bound",o(l.trigger,"click",u._onInputClick),o(l.trigger,"focus",u._onInputFocus),o(l.trigger,"blur",u._onInputBlur)):this.show()};return _.prototype={config:function(t){this._o||(this._o=p({},v,!0));var e=p(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme="string"==typeof e.theme&&e.theme?e.theme:null,e.bound=!!(void 0!==e.bound?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn="function"==typeof e.disableDayFn?e.disableDayFn:null;var n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,c(e.minDate)||(e.minDate=!1),c(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),u(e.yearRange)){var r=(new Date).getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||v.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(n){return n=n||this._o.format,c(this._d)?this._o.toString?this._o.toString(this._d,n):e?t(this._d).format(n):this._d.toDateString():""},getMoment:function(){return e?t(this._d):null},setMoment:function(n,r){e&&t.isMoment(n)&&this.setDate(n.toDate(),r)},getDate:function(){return c(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",m(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof t&&(t=new Date(Date.parse(t))),c(t)){var n=this._o.minDate,r=this._o.maxDate;c(n)&&t<n?t=n:c(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),f(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),m(this._o.field,"change",{firedBy:this})),e||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(t){var e=!0;if(c(t)){if(this.calendars){var n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){var n,r=this.getDate()||new Date,i=24*parseInt(e)*60*60*1e3;"add"===t?n=new Date(r.valueOf()+i):"subtract"===t&&(n=new Date(r.valueOf()-i)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=g(this.calendars[0]);for(var t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=g({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(f(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=v.minDate,this._o.minYear=v.minYear,this._o.minMonth=v.minMonth,this._o.startRange=v.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(f(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=v.maxDate,this._o.maxYear=v.maxYear,this._o.maxMonth=v.maxMonth,this._o.endRange=v.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(this._v||t){var e,n=this._o,r=n.minYear,o=n.maxYear,a=n.minMonth,s=n.maxMonth,u="";this._y<=r&&(this._y=r,!isNaN(a)&&this._m<a&&(this._m=a)),this._y>=o&&(this._y=o,!isNaN(s)&&this._m>s&&(this._m=s)),e="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);for(var c=0;c<n.numberOfMonths;c++)u+='<div class="pika-lendar">'+x(this,c,this.calendars[c].year,this.calendars[c].month,this.calendars[0].year,e)+this.render(this.calendars[c].year,this.calendars[c].month,e)+"</div>";this.el.innerHTML=u,n.bound&&"hidden"!==n.field.type&&i(function(){n.trigger.focus()},1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label","Use the arrow keys to pick a date")}},adjustPosition:function(){var t,e,n,i,o,a,s,u,c,l;if(!this._o.container){if(this.el.style.position="absolute",e=t=this._o.trigger,n=this.el.offsetWidth,i=this.el.offsetHeight,o=window.innerWidth||r.documentElement.clientWidth,a=window.innerHeight||r.documentElement.clientHeight,s=window.pageYOffset||r.body.scrollTop||r.documentElement.scrollTop,"function"==typeof t.getBoundingClientRect)u=(l=t.getBoundingClientRect()).left+window.pageXOffset,c=l.bottom+window.pageYOffset;else for(u=e.offsetLeft,c=e.offsetTop+e.offsetHeight;e=e.offsetParent;)u+=e.offsetLeft,c+=e.offsetTop;(this._o.reposition&&u+n>o||this._o.position.indexOf("right")>-1&&u-n+t.offsetWidth>0)&&(u=u-n+t.offsetWidth),(this._o.reposition&&c+i>a+s||this._o.position.indexOf("top")>-1&&c-i-t.offsetHeight>0)&&(c=c-i-t.offsetHeight),this.el.style.left=u+"px",this.el.style.top=c+"px"}},render:function(t,e,n){var r=this._o,i=new Date,o=h(t,e),a=new Date(t,e,1).getDay(),s=[],u=[];f(i),r.firstDay>0&&(a-=r.firstDay)<0&&(a+=7);for(var p=0===e?11:e-1,m=11===e?0:e+1,g=0===e?t-1:t,v=11===e?t+1:t,x=h(g,p),_=o+a,M=_;M>7;)M-=7;_+=7-M;for(var E,S,T,A,k=!1,C=0,R=0;C<_;C++){var D=new Date(t,e,C-a+1),L=!!c(this._d)&&d(D,this._d),O=d(D,i),P=-1!==r.events.indexOf(D.toDateString()),I=C<a||C>=o+a,N=C-a+1,F=e,j=t,z=r.startRange&&d(r.startRange,D),U=r.endRange&&d(r.endRange,D),V=r.startRange&&r.endRange&&r.startRange<D&&D<r.endRange,B=r.minDate&&D<r.minDate||r.maxDate&&D>r.maxDate||r.disableWeekends&&l(D)||r.disableDayFn&&r.disableDayFn(D);I&&(C<a?(N=x+N,F=p,j=g):(N-=o,F=m,j=v)),r.pickWholeWeek&&L&&(k=!0),u.push(w({day:N,month:F,year:j,hasEvent:P,isSelected:L,isToday:O,isDisabled:B,isEmpty:I,isStartRange:z,isEndRange:U,isInRange:V,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths})),7==++R&&(r.showWeekNumber&&u.unshift((E=C-a,S=e,T=t,A=void 0,A=new Date(T,0,1),'<td class="pika-week">'+Math.ceil(((new Date(T,S,E)-A)/864e5+A.getDay()+1)/7)+"</td>")),s.push(b(u,r.isRTL,r.pickWholeWeek,k)),u=[],R=0,k=!1)}return function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+function(t){var e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+y(t,e)+'">'+y(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"}(t)+"<tbody>"+e.join("")+"</tbody></table>"}(r,s,n)},isVisible:function(){return this._v},show:function(){var t,e;this.isVisible()||(this._v=!0,this.draw(),(t=this.el).className=(e=(" "+t.className+" ").replace(" is-hidden "," ")).trim?e.trim():e.replace(/^\s+|\s+$/g,""),this._o.bound&&(o(r,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var t,e,n=this._v;!1!==n&&(this._o.bound&&a(r,"click",this._onClick),this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto",s(t=this.el,e="is-hidden")||(t.className=""===t.className?e:t.className+" "+e),this._v=!1,void 0!==n&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){var t=this._o;this.hide(),a(this.el,"mousedown",this._onMouseDown,!0),a(this.el,"touchend",this._onMouseDown,!0),a(this.el,"change",this._onChange),t.keyboardInput&&a(r,"keydown",this._onKeyChange),t.field&&(a(t.field,"change",this._onInputChange),t.bound&&(a(t.trigger,"click",this._onInputClick),a(t.trigger,"focus",this._onInputFocus),a(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},_}),function(t,e){"use strict";var n,r,i,o=t,a=o.document,s=o.navigator,u=o.setTimeout,c=o.clearTimeout,l=o.setInterval,h=o.clearInterval,f=o.getComputedStyle,d=o.encodeURIComponent,p=o.ActiveXObject,m=o.Error,g=o.Number.parseInt||o.parseInt,v=o.Number.parseFloat||o.parseFloat,y=o.Number.isNaN||o.isNaN,w=o.Date.now,b=o.Object.keys,x=o.Object.prototype.hasOwnProperty,_=o.Array.prototype.slice,M=function(){var t=function(t){return t};if("function"==typeof o.wrap&&"function"==typeof o.unwrap)try{var e=a.createElement("div"),n=o.unwrap(e);1===e.nodeType&&n&&1===n.nodeType&&(t=o.unwrap)}catch(t){}return t}(),E=function(t){return _.call(t,0)},S=function(){var t,n,r,i,o,a=E(arguments),s=a[0]||{};for(t=1,n=a.length;n>t;t++)if(null!=(r=a[t]))for(i in r)x.call(r,i)&&s!==(o=r[i])&&o!==e&&(s[i]=o);return s},T=function(t){var e,n,r,i;if("object"!=typeof t||null==t||"number"==typeof t.nodeType)e=t;else if("number"==typeof t.length)for(e=[],n=0,r=t.length;r>n;n++)x.call(t,n)&&(e[n]=T(t[n]));else for(i in e={},t)x.call(t,i)&&(e[i]=T(t[i]));return e},A=function(t,e){if(t&&1===t.nodeType&&t.ownerDocument&&e&&(1===e.nodeType&&e.ownerDocument&&e.ownerDocument===t.ownerDocument||9===e.nodeType&&!e.ownerDocument&&e===t.ownerDocument))do{if(t===e)return!0;t=t.parentNode}while(t);return!1},k=function(t){var e;return"string"==typeof t&&t&&(e=t.split("#")[0].split("?")[0],e=t.slice(0,t.lastIndexOf("/")+1)),e},C=null==o.opener&&(!!o.top&&o!=o.top||!!o.parent&&o!=o.parent),R="html"===a.documentElement.nodeName,D={bridge:null,version:"0.0.0",pluginType:"unknown",sandboxed:null,disabled:null,outdated:null,insecure:null,unavailable:null,degraded:null,deactivated:null,overdue:null,ready:null},L="11.0.0",O={},P={},I=null,N=0,F=0,j={ready:"Flash communication is established",error:{"flash-sandboxed":"Attempting to run Flash in a sandboxed iframe, which is impossible","flash-disabled":"Flash is disabled or not installed. May also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-outdated":"Flash is too outdated to support ZeroClipboard","flash-insecure":"Flash will be unable to communicate due to a protocol mismatch between your `swfPath` configuration and the page","flash-unavailable":"Flash is unable to communicate bidirectionally with JavaScript","flash-degraded":"Flash is unable to preserve data fidelity when communicating with JavaScript","flash-deactivated":"Flash is too outdated for your browser and/or is configured as click-to-activate.\nThis may also mean that the ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity.\nMay also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-overdue":"Flash communication was established but NOT within the acceptable time limit","version-mismatch":"ZeroClipboard JS version number does not match ZeroClipboard SWF version number","clipboard-error":"At least one error was thrown while ZeroClipboard was attempting to inject your data into the clipboard","config-mismatch":"ZeroClipboard configuration does not match Flash's reality","swf-not-found":"The ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity","browser-unsupported":"The browser does not support the required HTML DOM and JavaScript features"}},z=["flash-unavailable","flash-degraded","flash-overdue","version-mismatch","config-mismatch","clipboard-error"],U=["flash-sandboxed","flash-disabled","flash-outdated","flash-insecure","flash-unavailable","flash-degraded","flash-deactivated","flash-overdue"],V=new RegExp("^flash-("+U.map(function(t){return t.replace(/^flash-/,"")}).join("|")+")$"),B=new RegExp("^flash-("+U.filter(function(t){return"flash-disabled"!==t}).map(function(t){return t.replace(/^flash-/,"")}).join("|")+")$"),H={swfPath:(k(function(){var t,n,r;if(a.currentScript&&(t=a.currentScript.src))return t;if(1===(n=a.getElementsByTagName("script")).length)return n[0].src||e;if("readyState"in(n[0]||document.createElement("script")))for(r=n.length;r--;)if("interactive"===n[r].readyState&&(t=n[r].src))return t;return"loading"===a.readyState&&(t=n[n.length-1].src)?t:(t=function(){var t,e;try{throw new m}catch(t){e=t}return e&&(t=e.sourceURL||e.fileName||function(t){var e,n;return"string"==typeof t&&t&&((n=t.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/))&&n[1]?e=n[1]:(n=t.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/))&&n[1]&&(e=n[1])),e}(e.stack)),t}())?t:e}())||function(){var t,n,r,i=a.getElementsByTagName("script");for(t=i.length;t--;){if(!(r=i[t].src)){n=null;break}if(r=k(r),null==n)n=r;else if(n!==r){n=null;break}}return n||e}()||"")+"ZeroClipboard.swf",trustedDomains:o.location.host?[o.location.host]:[],cacheBust:!0,forceEnhancedClipboard:!1,flashLoadTimeout:3e4,autoActivate:!0,bubbleEvents:!0,fixLineEndings:!0,containerId:"global-zeroclipboard-html-bridge",containerClass:"global-zeroclipboard-container",swfObjectId:"global-zeroclipboard-flash-bridge",hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",forceHandCursor:!1,title:null,zIndex:999999999},q=function(){return!!(a.addEventListener&&o.Object.keys&&o.Array.prototype.map)},G=function(){var t=H.swfPath||"",e=t.slice(0,2),n=t.slice(0,t.indexOf("://")+1);return"\\\\"===e?"file:":"//"===e||""===n?o.location.protocol:n},W=function(t){var e;if("string"==typeof t&&t?(e=t,t={}):"object"==typeof t&&t&&"string"==typeof t.type&&t.type&&(e=t.type),e){e=e.toLowerCase(),!t.target&&(/^(copy|aftercopy|_click)$/.test(e)||"error"===e&&"clipboard-error"===t.name)&&(t.target=i),S(t,{type:e,target:t.target||r||null,relatedTarget:t.relatedTarget||null,currentTarget:D&&D.bridge||null,timeStamp:t.timeStamp||w()||null});var n=j[t.type];return"error"===t.type&&t.name&&n&&(n=n[t.name]),n&&(t.message=n),"ready"===t.type&&S(t,{target:null,version:D.version}),"error"===t.type&&(V.test(t.name)&&S(t,{target:null,minimumVersion:L}),B.test(t.name)&&S(t,{version:D.version}),"flash-insecure"===t.name&&S(t,{pageProtocol:o.location.protocol,swfProtocol:G()})),"copy"===t.type&&(t.clipboardData={setData:mt.setData,clearData:mt.clearData}),"aftercopy"===t.type&&(t=nt(t,I)),t.target&&!t.relatedTarget&&(t.relatedTarget=Y(t.target)),X(t)}},Y=function(t){var e=t&&t.getAttribute&&t.getAttribute("data-clipboard-target");return e?a.getElementById(e):null},X=function(t){if(t&&/^_(?:click|mouse(?:over|out|down|up|move))$/.test(t.type)){var n=t.target,r="_mouseover"===t.type&&t.relatedTarget?t.relatedTarget:e,i="_mouseout"===t.type&&t.relatedTarget?t.relatedTarget:e,s=ut(n),u=s.left+("number"==typeof t._stageX?t._stageX:0),c=s.top+("number"==typeof t._stageY?t._stageY:0),l=u-(a.body.scrollLeft+a.documentElement.scrollLeft),h=c-(a.body.scrollTop+a.documentElement.scrollTop),f=(o.screenLeft||o.screenX||0)+l,d=(o.screenTop||o.screenY||0)+h,p="number"==typeof t.movementX?t.movementX:0,m="number"==typeof t.movementY?t.movementY:0;delete t._stageX,delete t._stageY,S(t,{srcElement:n,fromElement:r,toElement:i,screenX:f,screenY:d,pageX:u,pageY:c,clientX:l,clientY:h,x:l,y:h,movementX:p,movementY:m,offsetX:0,offsetY:0,layerX:0,layerY:0})}return t},$=function(t){return!/^(?:(?:before)?copy|destroy)$/.test(t&&"string"==typeof t.type&&t.type||"")},Q=function(t,e,n,r){r?u(function(){t.apply(e,n)},0):t.apply(e,n)},J=function(t){var e=t.target||r||null,o="swf"===t._source;switch(delete t._source,t.type){case"error":var a="flash-sandboxed"===t.name||function(t){var e=null;return(!1===C||t&&"error"===t.type&&t.name&&-1!==z.indexOf(t.name))&&(e=!1),e}(t);"boolean"==typeof a&&(D.sandboxed=a),"browser-unsupported"===t.name?S(D,{disabled:!1,outdated:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:!1,ready:!1}):-1!==U.indexOf(t.name)?S(D,{disabled:"flash-disabled"===t.name,outdated:"flash-outdated"===t.name,insecure:"flash-insecure"===t.name,unavailable:"flash-unavailable"===t.name,degraded:"flash-degraded"===t.name,deactivated:"flash-deactivated"===t.name,overdue:"flash-overdue"===t.name,ready:!1}):"version-mismatch"===t.name&&(n=t.swfVersion,S(D,{disabled:!1,outdated:!1,insecure:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:!1,ready:!1})),lt();break;case"ready":n=t.swfVersion;var s=!0===D.deactivated;S(D,{sandboxed:!1,disabled:!1,outdated:!1,insecure:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:s,ready:!s}),lt();break;case"beforecopy":i=e;break;case"copy":var u,c,l=t.relatedTarget;!P["text/html"]&&!P["text/plain"]&&l&&(c=l.value||l.outerHTML||l.innerHTML)&&(u=l.value||l.textContent||l.innerText)?(t.clipboardData.clearData(),t.clipboardData.setData("text/plain",u),c!==u&&t.clipboardData.setData("text/html",c)):!P["text/plain"]&&t.target&&(u=t.target.getAttribute("data-clipboard-text"))&&(t.clipboardData.clearData(),t.clipboardData.setData("text/plain",u));break;case"aftercopy":Z(t),mt.clearData(),e&&e!==it()&&e.focus&&e.focus();break;case"_mouseover":mt.focus(e),!0===H.bubbleEvents&&o&&(e&&e!==t.relatedTarget&&!A(t.relatedTarget,e)&&K(S({},t,{type:"mouseenter",bubbles:!1,cancelable:!1})),K(S({},t,{type:"mouseover"})));break;case"_mouseout":mt.blur(),!0===H.bubbleEvents&&o&&(e&&e!==t.relatedTarget&&!A(t.relatedTarget,e)&&K(S({},t,{type:"mouseleave",bubbles:!1,cancelable:!1})),K(S({},t,{type:"mouseout"})));break;case"_mousedown":ot(e,H.activeClass),!0===H.bubbleEvents&&o&&K(S({},t,{type:t.type.slice(1)}));break;case"_mouseup":at(e,H.activeClass),!0===H.bubbleEvents&&o&&K(S({},t,{type:t.type.slice(1)}));break;case"_click":i=null,!0===H.bubbleEvents&&o&&K(S({},t,{type:t.type.slice(1)}));break;case"_mousemove":!0===H.bubbleEvents&&o&&K(S({},t,{type:t.type.slice(1)}))}return!!/^_(?:click|mouse(?:over|out|down|up|move))$/.test(t.type)||void 0},Z=function(t){if(t.errors&&t.errors.length>0){var e=T(t);S(e,{type:"error",name:"clipboard-error"}),delete e.success,u(function(){mt.emit(e)},0)}},K=function(t){if(t&&"string"==typeof t.type&&t){var e,n=t.target||null,r=n&&n.ownerDocument||a,i=S({view:r.defaultView||o,canBubble:!0,cancelable:!0,detail:"click"===t.type?1:0,button:"number"==typeof t.which?t.which-1:"number"==typeof t.button?t.button:r.createEvent?0:1},t);n&&r.createEvent&&n.dispatchEvent&&(i=[i.type,i.canBubble,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget],(e=r.createEvent("MouseEvents")).initMouseEvent&&(e.initMouseEvent.apply(e,i),e._source="js",n.dispatchEvent(e)))}},tt=function(){var t=H.flashLoadTimeout;if("number"==typeof t&&t>=0){var e=Math.min(1e3,t/10),n=H.swfObjectId+"_fallbackContent";F=l(function(){var t=a.getElementById(n);ct(t)&&(lt(),D.deactivated=null,mt.emit({type:"error",name:"swf-not-found"}))},e)}},et=function(t){for(var e=t&&t.parentNode;e&&"OBJECT"===e.nodeName&&e.parentNode;)e=e.parentNode;return e||null},nt=function(t,e){if("object"!=typeof t||!t||"object"!=typeof e||!e)return t;var n={};for(var r in t)if(x.call(t,r))if("errors"===r){n[r]=t[r]?t[r].slice():[];for(var i=0,o=n[r].length;o>i;i++)n[r][i].format=e[n[r][i].format]}else if("success"!==r&&"data"!==r)n[r]=t[r];else{n[r]={};var a=t[r];for(var s in a)s&&x.call(a,s)&&x.call(e,s)&&(n[r][e[s]]=a[s])}return n},rt=function(t){if(null==t||""===t)return null;if(""===(t=t.replace(/^\s+|\s+$/g,"")))return null;var e=t.indexOf("//"),n=(t=-1===e?t:t.slice(e+2)).indexOf("/");return(t=-1===n?t:-1===e||0===n?null:t.slice(0,n))&&".swf"===t.slice(-4).toLowerCase()?null:t||null},it=function(){try{return a.activeElement}catch(t){return null}},ot=function(t,e){var n,r,i,o=[];if("string"==typeof e&&e&&(o=e.split(/\s+/)),t&&1===t.nodeType&&o.length>0){for(i=(" "+(t.className||"")+" ").replace(/[\t\r\n\f]/g," "),n=0,r=o.length;r>n;n++)-1===i.indexOf(" "+o[n]+" ")&&(i+=o[n]+" ");(i=i.replace(/^\s+|\s+$/g,""))!==t.className&&(t.className=i)}return t},at=function(t,e){var n,r,i,o=[];if("string"==typeof e&&e&&(o=e.split(/\s+/)),t&&1===t.nodeType&&o.length>0&&t.className){for(i=(" "+t.className+" ").replace(/[\t\r\n\f]/g," "),n=0,r=o.length;r>n;n++)i=i.replace(" "+o[n]+" "," ");(i=i.replace(/^\s+|\s+$/g,""))!==t.className&&(t.className=i)}return t},st=function(t,e){var n=f(t,null).getPropertyValue(e);return"cursor"!==e||n&&"auto"!==n||"A"!==t.nodeName?n:"pointer"},ut=function(t){var e={left:0,top:0,width:0,height:0};if(t.getBoundingClientRect){var n=t.getBoundingClientRect(),r=o.pageXOffset,i=o.pageYOffset,s=a.documentElement.clientLeft||0,u=a.documentElement.clientTop||0,c=0,l=0;if("relative"===st(a.body,"position")){var h=a.body.getBoundingClientRect(),f=a.documentElement.getBoundingClientRect();c=h.left-f.left||0,l=h.top-f.top||0}e.left=n.left+r-s-c,e.top=n.top+i-u-l,e.width="width"in n?n.width:n.right-n.left,e.height="height"in n?n.height:n.bottom-n.top}return e},ct=function(t){if(!t)return!1;var e=f(t,null);if(!e)return!1;var n=v(e.height)>0,r=v(e.width)>0,i=v(e.top)>=0,o=v(e.left)>=0,a=n&&r&&i&&o,s=a?null:ut(t);return"none"!==e.display&&"collapse"!==e.visibility&&(a||!!s&&(n||s.height>0)&&(r||s.width>0)&&(i||s.top>=0)&&(o||s.left>=0))},lt=function(){c(N),N=0,h(F),F=0},ht=function(t){return/^(?:auto|inherit)$/.test(t)?t:("number"!=typeof t||y(t)?"string"==typeof t&&(e=ht(g(t,10))):e=t,"number"==typeof e?e:"auto");var e},ft=function(t){var e=/(\r\n|\r|\n)/g;return"string"==typeof t&&!0===H.fixLineEndings&&(function(){var t=/win(dows|[\s]?(nt|me|ce|xp|vista|[\d]+))/i;return!!s&&(t.test(s.appVersion||"")||t.test(s.platform||"")||-1!==(s.userAgent||"").indexOf("Windows"))}()?/((^|[^\r])\n|\r([^\n]|$))/.test(t)&&(t=t.replace(e,"\r\n")):/\r/.test(t)&&(t=t.replace(e,"\n"))),t},dt=function(e){var n,r,i,o=D.sandboxed,a=null;if(e=!0===e,!1===C)a=!1;else{try{r=t.frameElement||null}catch(t){i={name:t.name,message:t.message}}if(r&&1===r.nodeType&&"IFRAME"===r.nodeName)try{a=r.hasAttribute("sandbox")}catch(t){a=null}else{try{n=document.domain||null}catch(t){n=null}(null===n||i&&"SecurityError"===i.name&&/(^|[\s\(\[@])sandbox(es|ed|ing|[\s\.,!\)\]@]|$)/.test(i.message.toLowerCase()))&&(a=!0)}}return D.sandboxed=a,o===a||e||pt(p),a},pt=function(t){function e(t){var e=t.match(/[\d]+/g);return e.length=3,e.join(".")}function n(t){t&&(o=!0,t.version&&(c=e(t.version)),!c&&t.description&&(c=e(t.description)),t.filename&&(u=function(t){return!!t&&(t=t.toLowerCase())&&(/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(t)||"chrome.plugin"===t.slice(-13))}(t.filename)))}var r,i,o=!1,a=!1,u=!1,c="";if(s.plugins&&s.plugins.length)n(s.plugins["Shockwave Flash"]),s.plugins["Shockwave Flash 2.0"]&&(o=!0,c="2.0.0.11");else if(s.mimeTypes&&s.mimeTypes.length)n((i=s.mimeTypes["application/x-shockwave-flash"])&&i.enabledPlugin);else if("undefined"!=typeof t){a=!0;try{r=new t("ShockwaveFlash.ShockwaveFlash.7"),o=!0,c=e(r.GetVariable("$version"))}catch(n){try{r=new t("ShockwaveFlash.ShockwaveFlash.6"),o=!0,c="6.0.21"}catch(n){try{r=new t("ShockwaveFlash.ShockwaveFlash"),o=!0,c=e(r.GetVariable("$version"))}catch(t){a=!1}}}}D.disabled=!0!==o,D.outdated=c&&v(c)<v(L),D.version=c||"0.0.0",D.pluginType=u?"pepper":a?"activex":o?"netscape":"unknown"};pt(p),dt(!0);var mt=function(){return this instanceof mt?void("function"==typeof mt._createClient&&mt._createClient.apply(this,E(arguments))):new mt};mt.version="2.3.0",mt.config=function(){return(function(t){return"object"!=typeof t||!t||"length"in t||b(t).forEach(function(e){if(/^(?:forceHandCursor|title|zIndex|bubbleEvents|fixLineEndings)$/.test(e))H[e]=t[e];else if(null==D.bridge)if("containerId"===e||"swfObjectId"===e){if(!function(t){return"string"==typeof t&&t&&/^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(t)}(t[e]))throw new Error("The specified `"+e+"` value is not valid as an HTML4 Element ID");H[e]=t[e]}else H[e]=t[e]}),"string"==typeof t&&t?x.call(H,t)?H[t]:void 0:T(H)}).apply(this,E(arguments))},mt.state=function(){return(function(){return dt(),{browser:S(function(t,e){for(var n={},r=0,i=e.length;i>r;r++)e[r]in t&&(n[e[r]]=t[e[r]]);return n}(s,["userAgent","platform","appName","appVersion"]),{isSupported:q()}),flash:function(t,e){var n={};for(var r in t)-1===e.indexOf(r)&&(n[r]=t[r]);return n}(D,["bridge"]),zeroclipboard:{version:mt.version,config:mt.config()}}}).apply(this,E(arguments))},mt.isFlashUnusable=function(){return(function(){return!!(D.sandboxed||D.disabled||D.outdated||D.unavailable||D.degraded||D.deactivated)}).apply(this,E(arguments))},mt.on=function(){return(function(t,r){var i,o,a,s={};if("string"==typeof t&&t?a=t.toLowerCase().split(/\s+/):"object"!=typeof t||!t||"length"in t||"undefined"!=typeof r||b(t).forEach(function(e){var n=t[e];"function"==typeof n&&mt.on(e,n)}),a&&a.length&&r){for(i=0,o=a.length;o>i;i++)s[t=a[i].replace(/^on/,"")]=!0,O[t]||(O[t]=[]),O[t].push(r);if(s.ready&&D.ready&&mt.emit({type:"ready"}),s.error){for(q()||mt.emit({type:"error",name:"browser-unsupported"}),i=0,o=U.length;o>i;i++)if(!0===D[U[i].replace(/^flash-/,"")]){mt.emit({type:"error",name:U[i]});break}n!==e&&mt.version!==n&&mt.emit({type:"error",name:"version-mismatch",jsVersion:mt.version,swfVersion:n})}}return mt}).apply(this,E(arguments))},mt.off=function(){return(function(t,e){var n,r,i,o,a;if(0===arguments.length?o=b(O):"string"==typeof t&&t?o=t.toLowerCase().split(/\s+/):"object"!=typeof t||!t||"length"in t||"undefined"!=typeof e||b(t).forEach(function(e){var n=t[e];"function"==typeof n&&mt.off(e,n)}),o&&o.length)for(n=0,r=o.length;r>n;n++)if(t=o[n].replace(/^on/,""),(a=O[t])&&a.length)if(e)for(i=a.indexOf(e);-1!==i;)a.splice(i,1),i=a.indexOf(e,i);else a.length=0;return mt}).apply(this,E(arguments))},mt.handlers=function(){return(function(t){return"string"==typeof t&&t?T(O[t])||null:T(O)}).apply(this,E(arguments))},mt.emit=function(){return(function(t){var e,n,r;return(t=W(t))&&!J(t)?"ready"===t.type&&!0===D.overdue?mt.emit({type:"error",name:"flash-overdue"}):(e=S({},t),(function(t){if("object"==typeof t&&t&&t.type){var e,n,r,i,a,s=$(t),u=(O["*"]||[]).concat(O[t.type]||[]);if(u&&u.length)for(e=0,n=u.length;n>e;e++)i=this,"string"==typeof(r=u[e])&&"function"==typeof o[r]&&(r=o[r]),"object"==typeof r&&r&&"function"==typeof r.handleEvent&&(i=r,r=r.handleEvent),"function"==typeof r&&(a=S({},t),Q(r,i,[a],s));return this}}).call(this,e),"copy"===t.type&&(n=(r=function(t){var e={},n={};if("object"==typeof t&&t){for(var r in t)if(r&&x.call(t,r)&&"string"==typeof t[r]&&t[r])switch(r.toLowerCase()){case"text/plain":case"text":case"air:text":case"flash:text":e.text=t[r],n.text=r;break;case"text/html":case"html":case"air:html":case"flash:html":e.html=t[r],n.html=r;break;case"application/rtf":case"text/rtf":case"rtf":case"richtext":case"air:rtf":case"flash:rtf":e.rtf=t[r],n.rtf=r}return{data:e,formatMap:n}}}(P)).data,I=r.formatMap),n):void 0}).apply(this,E(arguments))},mt.create=function(){return(function(){var t,e,n=D.sandboxed;return q()?(dt(),"boolean"!=typeof D.ready&&(D.ready=!1),void(D.sandboxed!==n&&!0===D.sandboxed?(D.ready=!1,mt.emit({type:"error",name:"flash-sandboxed"})):mt.isFlashUnusable()||null!==D.bridge||(e=G(),e&&e!==o.location.protocol?mt.emit({type:"error",name:"flash-insecure"}):(t=H.flashLoadTimeout,"number"==typeof t&&t>=0&&(N=u(function(){"boolean"!=typeof D.deactivated&&(D.deactivated=!0),!0===D.deactivated&&mt.emit({type:"error",name:"flash-deactivated"})},t)),D.overdue=!1,function(){var t,e=D.bridge,n=et(e);if(!e){var r=function(t,e){var n=rt(e.swfPath);null===n&&(n=t);var r=function(t){var e,n,r,i=[];if("string"==typeof t&&(t=[t]),"object"!=typeof t||!t||"number"!=typeof t.length)return i;for(e=0,n=t.length;n>e;e++)if(x.call(t,e)&&(r=rt(t[e]))){if("*"===r){i.length=0,i.push("*");break}-1===i.indexOf(r)&&i.push(r)}return i}(e.trustedDomains),i=r.length;if(i>0){if(1===i&&"*"===r[0])return"always";if(-1!==r.indexOf(t))return 1===i&&t===n?"sameDomain":"always"}return"never"}(o.location.host,H),i="never"===r?"none":"all",s=function(t){var e,n,r,i,a="",s=[];if(t.trustedDomains&&("string"==typeof t.trustedDomains?i=[t.trustedDomains]:"object"==typeof t.trustedDomains&&"length"in t.trustedDomains&&(i=t.trustedDomains)),i&&i.length)for(e=0,n=i.length;n>e;e++)if(x.call(i,e)&&i[e]&&"string"==typeof i[e]){if(!(r=rt(i[e])))continue;if("*"===r){s.length=0,s.push(r);break}s.push.apply(s,[r,"//"+r,o.location.protocol+"//"+r])}return s.length&&(a+="trustedOrigins="+d(s.join(","))),!0===t.forceEnhancedClipboard&&(a+=(a?"&":"")+"forceEnhancedClipboard=true"),"string"==typeof t.swfObjectId&&t.swfObjectId&&(a+=(a?"&":"")+"swfObjectId="+d(t.swfObjectId)),"string"==typeof t.jsVersion&&t.jsVersion&&(a+=(a?"&":"")+"jsVersion="+d(t.jsVersion)),a}(S({jsVersion:mt.version},H)),u=H.swfPath+function(t,e){return null==e||e&&!0===e.cacheBust?(-1===t.indexOf("?")?"?":"&")+"noCache="+w():""}(H.swfPath,H);R&&(u=function(t){return"string"==typeof t&&t?t.replace(/["&'<>]/g,function(t){switch(t){case'"':return"&quot;";case"&":return"&amp;";case"'":return"&apos;";case"<":return"&lt;";case">":return"&gt;";default:return t}}):t}(u)),n=function(){var t=a.createElement("div");return t.id=H.containerId,t.className=H.containerClass,t.style.position="absolute",t.style.left="0px",t.style.top="-9999px",t.style.width="1px",t.style.height="1px",t.style.zIndex=""+ht(H.zIndex),t}();var c=a.createElement("div");n.appendChild(c),a.body.appendChild(n);var l=a.createElement("div"),h="activex"===D.pluginType;l.innerHTML='<object id="'+H.swfObjectId+'" name="'+H.swfObjectId+'" width="100%" height="100%" '+(h?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"':'type="application/x-shockwave-flash" data="'+u+'"')+">"+(h?'<param name="movie" value="'+u+'"/>':"")+'<param name="allowScriptAccess" value="'+r+'"/><param name="allowNetworking" value="'+i+'"/><param name="menu" value="false"/><param name="wmode" value="transparent"/><param name="flashvars" value="'+s+'"/><div id="'+H.swfObjectId+'_fallbackContent">&nbsp;</div></object>',e=l.firstChild,l=null,M(e).ZeroClipboard=mt,n.replaceChild(e,c),tt()}e||((e=a[H.swfObjectId])&&(t=e.length)&&(e=e[t-1]),!e&&n&&(e=n.firstChild)),D.bridge=e||null}())))):(D.ready=!1,void mt.emit({type:"error",name:"browser-unsupported"}))}).apply(this,E(arguments))},mt.destroy=function(){return(function(){mt.clearData(),mt.blur(),mt.emit("destroy"),function(){var t=D.bridge;if(t){var r=et(t);r&&("activex"===D.pluginType&&"readyState"in t?(t.style.display="none",function e(){if(4===t.readyState){for(var n in t)"function"==typeof t[n]&&(t[n]=null);t.parentNode&&t.parentNode.removeChild(t),r.parentNode&&r.parentNode.removeChild(r)}else u(e,10)}()):(t.parentNode&&t.parentNode.removeChild(t),r.parentNode&&r.parentNode.removeChild(r))),lt(),D.ready=null,D.bridge=null,D.deactivated=null,D.insecure=null,n=e}}(),mt.off()}).apply(this,E(arguments))},mt.setData=function(){return(function(t,e){var n;if("object"==typeof t&&t&&"undefined"==typeof e)n=t,mt.clearData();else{if("string"!=typeof t||!t)return;(n={})[t]=e}for(var r in n)"string"==typeof r&&r&&x.call(n,r)&&"string"==typeof n[r]&&n[r]&&(P[r]=ft(n[r]))}).apply(this,E(arguments))},mt.clearData=function(){return(function(t){"undefined"==typeof t?(function(t){if(t)for(var e in t)x.call(t,e)&&delete t[e]}(P),I=null):"string"==typeof t&&x.call(P,t)&&delete P[t]}).apply(this,E(arguments))},mt.getData=function(){return(function(t){return"undefined"==typeof t?T(P):"string"==typeof t&&x.call(P,t)?P[t]:void 0}).apply(this,E(arguments))},mt.focus=mt.activate=function(){return(function(t){if(t&&1===t.nodeType){r&&(at(r,H.activeClass),r!==t&&at(r,H.hoverClass)),r=t,ot(t,H.hoverClass);var e=t.getAttribute("title")||H.title;if("string"==typeof e&&e){var n=et(D.bridge);n&&n.setAttribute("title",e)}(function(t){!0===D.ready&&(D.bridge&&"function"==typeof D.bridge.setHandCursor?D.bridge.setHandCursor(t):D.ready=!1)})(!0===H.forceHandCursor||"pointer"===st(t,"cursor")),function(){var t;if(r&&(t=et(D.bridge))){var e=ut(r);S(t.style,{width:e.width+"px",height:e.height+"px",top:e.top+"px",left:e.left+"px",zIndex:""+ht(H.zIndex)})}}()}}).apply(this,E(arguments))},mt.blur=mt.deactivate=function(){return(function(){var t=et(D.bridge);t&&(t.removeAttribute("title"),t.style.left="0px",t.style.top="-9999px",t.style.width="1px",t.style.height="1px"),r&&(at(r,H.hoverClass),at(r,H.activeClass),r=null)}).apply(this,E(arguments))},mt.activeElement=function(){return(function(){return r||null}).apply(this,E(arguments))};var gt=0,vt={},yt=0,wt={},bt={};S(H,{autoActivate:!0});var xt=function(t){return"string"==typeof t&&(t=[]),"number"!=typeof t.length?[t]:t},_t=function(t){if(t&&1===t.nodeType){var e=function(t){(t||(t=o.event))&&("js"!==t._source&&(t.stopImmediatePropagation(),t.preventDefault()),delete t._source)},n=function(n){(n||(n=o.event))&&(e(n),mt.focus(t))};t.addEventListener("mouseover",n,!1),t.addEventListener("mouseout",e,!1),t.addEventListener("mouseenter",e,!1),t.addEventListener("mouseleave",e,!1),t.addEventListener("mousemove",e,!1),bt[t.zcClippingId]={mouseover:n,mouseout:e,mouseenter:e,mouseleave:e,mousemove:e}}},Mt=function(t){if(t&&1===t.nodeType){var e=bt[t.zcClippingId];if("object"==typeof e&&e){for(var n,r,i=["move","leave","enter","out","over"],o=0,a=i.length;a>o;o++)"function"==typeof(r=e[n="mouse"+i[o]])&&t.removeEventListener(n,r,!1);delete bt[t.zcClippingId]}}};mt._createClient=function(){(function(t){var e,n=this;n.id=""+gt++,vt[n.id]=e={instance:n,elements:[],handlers:{},coreWildcardHandler:function(t){return n.emit(t)}},t&&n.clip(t),mt.on("*",e.coreWildcardHandler),mt.on("destroy",function(){n.destroy()}),mt.create()}).apply(this,E(arguments))},mt.prototype.on=function(){return(function(t,r){var i,o,a,s={},u=this,c=vt[u.id],l=c&&c.handlers;if(!c)throw new Error("Attempted to add new listener(s) to a destroyed ZeroClipboard client instance");if("string"==typeof t&&t?a=t.toLowerCase().split(/\s+/):"object"!=typeof t||!t||"length"in t||"undefined"!=typeof r||b(t).forEach(function(e){var n=t[e];"function"==typeof n&&u.on(e,n)}),a&&a.length&&r){for(i=0,o=a.length;o>i;i++)s[t=a[i].replace(/^on/,"")]=!0,l[t]||(l[t]=[]),l[t].push(r);if(s.ready&&D.ready&&this.emit({type:"ready",client:this}),s.error){for(i=0,o=U.length;o>i;i++)if(D[U[i].replace(/^flash-/,"")]){this.emit({type:"error",name:U[i],client:this});break}n!==e&&mt.version!==n&&this.emit({type:"error",name:"version-mismatch",jsVersion:mt.version,swfVersion:n})}}return u}).apply(this,E(arguments))},mt.prototype.off=function(){return(function(t,e){var n,r,i,o,a,s=this,u=vt[s.id],c=u&&u.handlers;if(!c)return s;if(0===arguments.length?o=b(c):"string"==typeof t&&t?o=t.split(/\s+/):"object"!=typeof t||!t||"length"in t||"undefined"!=typeof e||b(t).forEach(function(e){var n=t[e];"function"==typeof n&&s.off(e,n)}),o&&o.length)for(n=0,r=o.length;r>n;n++)if((a=c[t=o[n].toLowerCase().replace(/^on/,"")])&&a.length)if(e)for(i=a.indexOf(e);-1!==i;)a.splice(i,1),i=a.indexOf(e,i);else a.length=0;return s}).apply(this,E(arguments))},mt.prototype.handlers=function(){return(function(t){var e=null,n=vt[this.id]&&vt[this.id].handlers;return n&&(e="string"==typeof t&&t?n[t]?n[t].slice(0):[]:T(n)),e}).apply(this,E(arguments))},mt.prototype.emit=function(){return(function(t){var e,n=this;return(function(t){if(!t||!t.type)return!1;if(t.client&&t.client!==this)return!1;var e=vt[this.id],n=e&&e.elements,r=!!n&&n.length>0,i=!t.target||r&&-1!==n.indexOf(t.target),o=t.relatedTarget&&r&&-1!==n.indexOf(t.relatedTarget);return!(!e||!(i||o||t.client&&t.client===this))}).call(n,t)&&("object"==typeof t&&t&&"string"==typeof t.type&&t.type&&(t=S({},t)),e=S({},W(t),{client:n}),(function(t){var e=vt[this.id];if("object"==typeof t&&t&&t.type&&e){var n,r,i,a,s,u=$(t),c=(e&&e.handlers["*"]||[]).concat(e&&e.handlers[t.type]||[]);if(c&&c.length)for(n=0,r=c.length;r>n;n++)a=this,"string"==typeof(i=c[n])&&"function"==typeof o[i]&&(i=o[i]),"object"==typeof i&&i&&"function"==typeof i.handleEvent&&(a=i,i=i.handleEvent),"function"==typeof i&&(s=S({},t),Q(i,a,[s],u))}}).call(n,e)),n}).apply(this,E(arguments))},mt.prototype.clip=function(){return(function(t){if(!vt[this.id])throw new Error("Attempted to clip element(s) to a destroyed ZeroClipboard client instance");t=xt(t);for(var e=0;e<t.length;e++)if(x.call(t,e)&&t[e]&&1===t[e].nodeType){t[e].zcClippingId?-1===wt[t[e].zcClippingId].indexOf(this.id)&&wt[t[e].zcClippingId].push(this.id):(t[e].zcClippingId="zcClippingId_"+yt++,wt[t[e].zcClippingId]=[this.id],!0===H.autoActivate&&_t(t[e]));var n=vt[this.id]&&vt[this.id].elements;-1===n.indexOf(t[e])&&n.push(t[e])}return this}).apply(this,E(arguments))},mt.prototype.unclip=function(){return(function(t){var e=vt[this.id];if(!e)return this;for(var n,r=e.elements,i=(t="undefined"==typeof t?r.slice(0):xt(t)).length;i--;)if(x.call(t,i)&&t[i]&&1===t[i].nodeType){for(n=0;-1!==(n=r.indexOf(t[i],n));)r.splice(n,1);var o=wt[t[i].zcClippingId];if(o){for(n=0;-1!==(n=o.indexOf(this.id,n));)o.splice(n,1);0===o.length&&(!0===H.autoActivate&&Mt(t[i]),delete t[i].zcClippingId)}}return this}).apply(this,E(arguments))},mt.prototype.elements=function(){return(function(){var t=vt[this.id];return t&&t.elements?t.elements.slice(0):[]}).apply(this,E(arguments))},mt.prototype.destroy=function(){return(function(){var t=vt[this.id];t&&(this.unclip(),this.off(),mt.off("*",t.coreWildcardHandler),delete vt[this.id])}).apply(this,E(arguments))},mt.prototype.setText=function(t){if(!vt[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return mt.setData("text/plain",t),this},mt.prototype.setHtml=function(t){if(!vt[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return mt.setData("text/html",t),this},mt.prototype.setRichText=function(t){if(!vt[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return mt.setData("application/rtf",t),this},mt.prototype.setData=function(){if(!vt[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return mt.setData.apply(this,E(arguments)),this},mt.prototype.clearData=function(){if(!vt[this.id])throw new Error("Attempted to clear pending clipboard data from a destroyed ZeroClipboard client instance");return mt.clearData.apply(this,E(arguments)),this},mt.prototype.getData=function(){if(!vt[this.id])throw new Error("Attempted to get pending clipboard data from a destroyed ZeroClipboard client instance");return mt.getData.apply(this,E(arguments))},"function"==typeof define&&define.amd?define(function(){return mt}):"object"==typeof module&&module&&"object"==typeof module.exports&&module.exports?module.exports=mt:t.ZeroClipboard=mt}(function(){return this||window}()),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.THREE=t.THREE||{})}(this,function(t){function e(){}function n(t,e){this.x=t||0,this.y=e||0}function r(t,e,i,o,a,s,u,c,l,h){Object.defineProperty(this,"id",{value:oi++}),this.uuid=ii.generateUUID(),this.name="",this.image=void 0!==t?t:r.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:r.DEFAULT_MAPPING,this.wrapS=void 0!==i?i:1001,this.wrapT=void 0!==o?o:1001,this.magFilter=void 0!==a?a:1006,this.minFilter=void 0!==s?s:1008,this.anisotropy=void 0!==l?l:1,this.format=void 0!==u?u:1023,this.type=void 0!==c?c:1009,this.offset=new n(0,0),this.repeat=new n(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==h?h:3e3,this.version=0,this.onUpdate=null}function i(t,e,n,r){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==r?r:1}function o(t,e,n){this.uuid=ii.generateUUID(),this.width=t,this.height=e,this.scissor=new i(0,0,t,e),this.scissorTest=!1,this.viewport=new i(0,0,t,e),void 0===(n=n||{}).minFilter&&(n.minFilter=1006),this.texture=new r(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function a(t,e,n){o.call(this,t,e,n),this.activeMipMapLevel=this.activeCubeFace=0}function s(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==r?r:1}function u(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}function c(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function l(t,e,n,i,o,a,s,u,c,l,h,f){r.call(this,null,a,s,u,c,l,i,o,h,f),this.image={data:t,width:e,height:n},this.magFilter=void 0!==c?c:1003,this.minFilter=void 0!==l?l:1003,this.flipY=this.generateMipmaps=!1,this.unpackAlignment=1}function h(t,e,n,i,o,a,s,u,c,l){r.call(this,t=void 0!==t?t:[],void 0!==e?e:301,n,i,o,a,s,u,c,l),this.flipY=!1}function f(t,e,n){var r=t[0];if(0>=r||0<r)return t;var i=e*n,o=ui[i];if(void 0===o&&(o=new Float32Array(i),ui[i]=o),0!==e)for(r.toArray(o,0),r=1,i=0;r!==e;++r)t[r].toArray(o,i+=n);return o}function d(t,e){var n=ci[e];void 0===n&&(n=new Int32Array(e),ci[e]=n);for(var r=0;r!==e;++r)n[r]=t.allocTextureUnit();return n}function p(t,e){t.uniform1f(this.addr,e)}function m(t,e){t.uniform1i(this.addr,e)}function g(t,e){void 0===e.x?t.uniform2fv(this.addr,e):t.uniform2f(this.addr,e.x,e.y)}function v(t,e){void 0!==e.x?t.uniform3f(this.addr,e.x,e.y,e.z):void 0!==e.r?t.uniform3f(this.addr,e.r,e.g,e.b):t.uniform3fv(this.addr,e)}function y(t,e){void 0===e.x?t.uniform4fv(this.addr,e):t.uniform4f(this.addr,e.x,e.y,e.z,e.w)}function w(t,e){t.uniformMatrix2fv(this.addr,!1,e.elements||e)}function b(t,e){void 0===e.elements?t.uniformMatrix3fv(this.addr,!1,e):(hi.set(e.elements),t.uniformMatrix3fv(this.addr,!1,hi))}function x(t,e){void 0===e.elements?t.uniformMatrix4fv(this.addr,!1,e):(li.set(e.elements),t.uniformMatrix4fv(this.addr,!1,li))}function _(t,e,n){var r=n.allocTextureUnit();t.uniform1i(this.addr,r),n.setTexture2D(e||ai,r)}function M(t,e,n){var r=n.allocTextureUnit();t.uniform1i(this.addr,r),n.setTextureCube(e||si,r)}function E(t,e){t.uniform2iv(this.addr,e)}function S(t,e){t.uniform3iv(this.addr,e)}function T(t,e){t.uniform4iv(this.addr,e)}function A(t,e){t.uniform1fv(this.addr,e)}function k(t,e){t.uniform1iv(this.addr,e)}function C(t,e){t.uniform2fv(this.addr,f(e,this.size,2))}function R(t,e){t.uniform3fv(this.addr,f(e,this.size,3))}function D(t,e){t.uniform4fv(this.addr,f(e,this.size,4))}function L(t,e){t.uniformMatrix2fv(this.addr,!1,f(e,this.size,4))}function O(t,e){t.uniformMatrix3fv(this.addr,!1,f(e,this.size,9))}function P(t,e){t.uniformMatrix4fv(this.addr,!1,f(e,this.size,16))}function I(t,e,n){var r=e.length,i=d(n,r);for(t.uniform1iv(this.addr,i),t=0;t!==r;++t)n.setTexture2D(e[t]||ai,i[t])}function N(t,e,n){var r=e.length,i=d(n,r);for(t.uniform1iv(this.addr,i),t=0;t!==r;++t)n.setTextureCube(e[t]||si,i[t])}function F(t,e,n){this.id=t,this.addr=n,this.setValue=function(t){switch(e.type){case 5126:return p;case 35664:return g;case 35665:return v;case 35666:return y;case 35674:return w;case 35675:return b;case 35676:return x;case 35678:case 36198:return _;case 35680:return M;case 5124:case 35670:return m;case 35667:case 35671:return E;case 35668:case 35672:return S;case 35669:case 35673:return T}}()}function j(t,e,n){this.id=t,this.addr=n,this.size=e.size,this.setValue=function(t){switch(e.type){case 5126:return A;case 35664:return C;case 35665:return R;case 35666:return D;case 35674:return L;case 35675:return O;case 35676:return P;case 35678:return I;case 35680:return N;case 5124:case 35670:return k;case 35667:case 35671:return E;case 35668:case 35672:return S;case 35669:case 35673:return T}}()}function z(t){this.id=t,this.seq=[],this.map={}}function U(t,e,n){this.seq=[],this.map={},this.renderer=n,n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(var r=0;r<n;++r){var i=t.getActiveUniform(e,r),o=t.getUniformLocation(e,i.name),a=this,s=i.name,u=s.length;for(fi.lastIndex=0;;){var c=fi.exec(s),l=c[1],h=c[3];if("]"===c[2]&&(l|=0),void 0===h||"["===h&&fi.lastIndex+2===u){s=a,i=void 0===h?new F(l,i,o):new j(l,i,o),s.seq.push(i),s.map[i.id]=i;break}void 0===(h=a.map[l])&&(h=new z(l),(l=a).seq.push(a=h),l.map[a.id]=a),a=h}}}function V(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}function B(t,e){this.min=void 0!==t?t:new n(1/0,1/0),this.max=void 0!==e?e:new n(-1/0,-1/0)}function H(t,e){var r,i,o,a,s,c,l,h,f,d,p,m,g,v,y,w=t.context,b=t.state;this.render=function(x,_,M){if(0!==e.length){x=new u;var E=M.w/M.z,S=.5*M.z,T=.5*M.w,A=new n((D=16/M.w)*E,D),k=new u(1,1,0),C=new n(1,1),R=new B;if(R.min.set(M.x,M.y),R.max.set(M.x+(M.z-16),M.y+(M.w-16)),void 0===g){var D=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),L=new Uint16Array([0,1,2,0,2,3]);p=w.createBuffer(),m=w.createBuffer(),w.bindBuffer(w.ARRAY_BUFFER,p),w.bufferData(w.ARRAY_BUFFER,D,w.STATIC_DRAW),w.bindBuffer(w.ELEMENT_ARRAY_BUFFER,m),w.bufferData(w.ELEMENT_ARRAY_BUFFER,L,w.STATIC_DRAW),v=w.createTexture(),y=w.createTexture(),b.bindTexture(w.TEXTURE_2D,v),w.texImage2D(w.TEXTURE_2D,0,w.RGB,16,16,0,w.RGB,w.UNSIGNED_BYTE,null),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,w.NEAREST),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,w.NEAREST),b.bindTexture(w.TEXTURE_2D,y),w.texImage2D(w.TEXTURE_2D,0,w.RGBA,16,16,0,w.RGBA,w.UNSIGNED_BYTE,null),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,w.NEAREST),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,w.NEAREST),D={vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif ( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility =        visibility.r / 9.0;\nvVisibility *= 1.0 - visibility.g / 9.0;\nvVisibility *=       visibility.b / 9.0;\nvVisibility *= 1.0 - visibility.a / 9.0;\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif ( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if ( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},L=w.createProgram();var O=w.createShader(w.FRAGMENT_SHADER),P=w.createShader(w.VERTEX_SHADER),I="precision "+t.getPrecision()+" float;\n";w.shaderSource(O,I+D.fragmentShader),w.shaderSource(P,I+D.vertexShader),w.compileShader(O),w.compileShader(P),w.attachShader(L,O),w.attachShader(L,P),w.linkProgram(L),f=w.getAttribLocation(g=L,"position"),d=w.getAttribLocation(g,"uv"),r=w.getUniformLocation(g,"renderType"),i=w.getUniformLocation(g,"map"),o=w.getUniformLocation(g,"occlusionMap"),a=w.getUniformLocation(g,"opacity"),s=w.getUniformLocation(g,"color"),c=w.getUniformLocation(g,"scale"),l=w.getUniformLocation(g,"rotation"),h=w.getUniformLocation(g,"screenPosition")}for(w.useProgram(g),b.initAttributes(),b.enableAttribute(f),b.enableAttribute(d),b.disableUnusedAttributes(),w.uniform1i(o,0),w.uniform1i(i,1),w.bindBuffer(w.ARRAY_BUFFER,p),w.vertexAttribPointer(f,2,w.FLOAT,!1,16,0),w.vertexAttribPointer(d,2,w.FLOAT,!1,16,8),w.bindBuffer(w.ELEMENT_ARRAY_BUFFER,m),b.disable(w.CULL_FACE),b.buffers.depth.setMask(!1),L=0,O=e.length;L<O;L++)if(A.set((D=16/M.w)*E,D),x.set((P=e[L]).matrixWorld.elements[12],P.matrixWorld.elements[13],P.matrixWorld.elements[14]),x.applyMatrix4(_.matrixWorldInverse),x.applyMatrix4(_.projectionMatrix),k.copy(x),C.x=M.x+k.x*S+S-8,C.y=M.y+k.y*T+T-8,!0===R.containsPoint(C)){b.activeTexture(w.TEXTURE0),b.bindTexture(w.TEXTURE_2D,null),b.activeTexture(w.TEXTURE1),b.bindTexture(w.TEXTURE_2D,v),w.copyTexImage2D(w.TEXTURE_2D,0,w.RGB,C.x,C.y,16,16,0),w.uniform1i(r,0),w.uniform2f(c,A.x,A.y),w.uniform3f(h,k.x,k.y,k.z),b.disable(w.BLEND),b.enable(w.DEPTH_TEST),w.drawElements(w.TRIANGLES,6,w.UNSIGNED_SHORT,0),b.activeTexture(w.TEXTURE0),b.bindTexture(w.TEXTURE_2D,y),w.copyTexImage2D(w.TEXTURE_2D,0,w.RGBA,C.x,C.y,16,16,0),w.uniform1i(r,1),b.disable(w.DEPTH_TEST),b.activeTexture(w.TEXTURE1),b.bindTexture(w.TEXTURE_2D,v),w.drawElements(w.TRIANGLES,6,w.UNSIGNED_SHORT,0),P.positionScreen.copy(k),P.customUpdateCallback?P.customUpdateCallback(P):P.updateLensFlares(),w.uniform1i(r,2),b.enable(w.BLEND),I=0;for(var N=P.lensFlares.length;I<N;I++){var F=P.lensFlares[I];.001<F.opacity&&.001<F.scale&&(k.x=F.x,k.y=F.y,k.z=F.z,A.x=(D=F.size*F.scale/M.w)*E,A.y=D,w.uniform3f(h,k.x,k.y,k.z),w.uniform2f(c,A.x,A.y),w.uniform1f(l,F.rotation),w.uniform1f(a,F.opacity),w.uniform3f(s,F.color.r,F.color.g,F.color.b),b.setBlending(F.blending,F.blendEquation,F.blendSrc,F.blendDst),t.setTexture2D(F.texture,1),w.drawElements(w.TRIANGLES,6,w.UNSIGNED_SHORT,0))}}b.enable(w.CULL_FACE),b.enable(w.DEPTH_TEST),b.buffers.depth.setMask(!0),t.resetGLState()}}}function q(t,e){var n,i,o,a,c,l,h,f,d,p,m,g,v,y,w,b,x;function _(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}var M,E,S,T,A=t.context,k=t.state,C=new u,R=new s,D=new u;this.render=function(s,u){if(0!==e.length){if(void 0===S){var L=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),O=new Uint16Array([0,1,2,0,2,3]);M=A.createBuffer(),E=A.createBuffer(),A.bindBuffer(A.ARRAY_BUFFER,M),A.bufferData(A.ARRAY_BUFFER,L,A.STATIC_DRAW),A.bindBuffer(A.ELEMENT_ARRAY_BUFFER,E),A.bufferData(A.ELEMENT_ARRAY_BUFFER,O,A.STATIC_DRAW),L=A.createProgram(),O=A.createShader(A.VERTEX_SHADER);var P=A.createShader(A.FRAGMENT_SHADER);A.shaderSource(O,["precision "+t.getPrecision()+" float;","#define SHADER_NAME SpriteMaterial\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position * scale;\nvec2 rotatedPosition;\nrotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\nrotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\nvec4 finalPosition;\nfinalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition;\nfinalPosition = projectionMatrix * finalPosition;\ngl_Position = finalPosition;\n}"].join("\n")),A.shaderSource(P,["precision "+t.getPrecision()+" float;","#define SHADER_NAME SpriteMaterial\nuniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"].join("\n")),A.compileShader(O),A.compileShader(P),A.attachShader(L,O),A.attachShader(L,P),A.linkProgram(L),b=A.getAttribLocation(S=L,"position"),x=A.getAttribLocation(S,"uv"),n=A.getUniformLocation(S,"uvOffset"),i=A.getUniformLocation(S,"uvScale"),o=A.getUniformLocation(S,"rotation"),a=A.getUniformLocation(S,"scale"),c=A.getUniformLocation(S,"color"),l=A.getUniformLocation(S,"map"),h=A.getUniformLocation(S,"opacity"),f=A.getUniformLocation(S,"modelViewMatrix"),d=A.getUniformLocation(S,"projectionMatrix"),p=A.getUniformLocation(S,"fogType"),m=A.getUniformLocation(S,"fogDensity"),g=A.getUniformLocation(S,"fogNear"),v=A.getUniformLocation(S,"fogFar"),y=A.getUniformLocation(S,"fogColor"),w=A.getUniformLocation(S,"alphaTest"),(L=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=8,L.height=8,(O=L.getContext("2d")).fillStyle="white",O.fillRect(0,0,8,8),(T=new r(L)).needsUpdate=!0}A.useProgram(S),k.initAttributes(),k.enableAttribute(b),k.enableAttribute(x),k.disableUnusedAttributes(),k.disable(A.CULL_FACE),k.enable(A.BLEND),A.bindBuffer(A.ARRAY_BUFFER,M),A.vertexAttribPointer(b,2,A.FLOAT,!1,16,0),A.vertexAttribPointer(x,2,A.FLOAT,!1,16,8),A.bindBuffer(A.ELEMENT_ARRAY_BUFFER,E),A.uniformMatrix4fv(d,!1,u.projectionMatrix.elements),k.activeTexture(A.TEXTURE0),A.uniform1i(l,0),O=L=0,(P=s.fog)?(A.uniform3f(y,P.color.r,P.color.g,P.color.b),P.isFog?(A.uniform1f(g,P.near),A.uniform1f(v,P.far),A.uniform1i(p,1),O=L=1):P.isFogExp2&&(A.uniform1f(m,P.density),A.uniform1i(p,2),O=L=2)):(A.uniform1i(p,0),O=L=0),P=0;for(var I=e.length;P<I;P++)(F=e[P]).modelViewMatrix.multiplyMatrices(u.matrixWorldInverse,F.matrixWorld),F.z=-F.modelViewMatrix.elements[14];e.sort(_);var N=[];for(P=0,I=e.length;P<I;P++){var F,j=(F=e[P]).material;if(!1!==j.visible){F.onBeforeRender(t,s,u,void 0,j,void 0),A.uniform1f(w,j.alphaTest),A.uniformMatrix4fv(f,!1,F.modelViewMatrix.elements),F.matrixWorld.decompose(C,R,D),N[0]=D.x,N[1]=D.y;var z=0;s.fog&&j.fog&&(z=O),L!==z&&(A.uniform1i(p,z),L=z),null!==j.map?(A.uniform2f(n,j.map.offset.x,j.map.offset.y),A.uniform2f(i,j.map.repeat.x,j.map.repeat.y)):(A.uniform2f(n,0,0),A.uniform2f(i,1,1)),A.uniform1f(h,j.opacity),A.uniform3f(c,j.color.r,j.color.g,j.color.b),A.uniform1f(o,j.rotation),A.uniform2fv(a,N),k.setBlending(j.blending,j.blendEquation,j.blendSrc,j.blendDst,j.blendEquationAlpha,j.blendSrcAlpha,j.blendDstAlpha,j.premultipliedAlpha),k.buffers.depth.setTest(j.depthTest),k.buffers.depth.setMask(j.depthWrite),t.setTexture2D(j.map?j.map:T,0),A.drawElements(A.TRIANGLES,6,A.UNSIGNED_SHORT,0),F.onAfterRender(t,s,u,void 0,j,void 0)}}k.enable(A.CULL_FACE),t.resetGLState()}}}function G(){Object.defineProperty(this,"id",{value:yi++}),this.uuid=ii.generateUUID(),this.name="",this.type="Material",this.lights=this.fog=!0,this.blending=1,this.side=0,this.shading=2,this.vertexColors=0,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=3,this.depthWrite=this.depthTest=!0,this.clippingPlanes=null,this.clipShadows=this.clipIntersection=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.needsUpdate=this.visible=!0}function W(t){G.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function Y(t){G.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.lights=this.fog=!1,this.setValues(t)}function X(t,e){this.min=void 0!==t?t:new u(1/0,1/0,1/0),this.max=void 0!==e?e:new u(-1/0,-1/0,-1/0)}function $(t,e){this.center=void 0!==t?t:new u,this.radius=void 0!==e?e:0}function Q(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function J(t,e){this.normal=void 0!==t?t:new u(1,0,0),this.constant=void 0!==e?e:0}function Z(t,e,n,r,i,o){this.planes=[void 0!==t?t:new J,void 0!==e?e:new J,void 0!==n?n:new J,void 0!==r?r:new J,void 0!==i?i:new J,void 0!==o?o:new J]}function K(t,e,r,a){function s(e,n,r,i){var o,a=e.geometry;o=b;var s=e.customDepthMaterial;return r&&(o=x,s=e.customDistanceMaterial),s?o=s:(s=!1,n.morphTargets&&(a&&a.isBufferGeometry?s=a.morphAttributes&&a.morphAttributes.position&&0<a.morphAttributes.position.length:a&&a.isGeometry&&(s=a.morphTargets&&0<a.morphTargets.length)),e.isSkinnedMesh&&!1===n.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e),e=e.isSkinnedMesh&&n.skinning,a=0,s&&(a|=1),e&&(a|=2),o=o[a]),t.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length&&(s=n.uuid,void 0===(e=_[a=o.uuid])&&(_[a]=e={}),void 0===(a=e[s])&&(a=o.clone(),e[s]=a),o=a),o.visible=n.visible,o.wireframe=n.wireframe,s=n.side,D.renderSingleSided&&2==s&&(s=0),D.renderReverseSided&&(0===s?s=1:1===s&&(s=0)),o.side=s,o.clipShadows=n.clipShadows,o.clippingPlanes=n.clippingPlanes,o.wireframeLinewidth=n.wireframeLinewidth,o.linewidth=n.linewidth,r&&void 0!==o.uniforms.lightPos&&o.uniforms.lightPos.value.copy(i),o}function l(e,n,i,o){if(!1!==e.visible){if(e.layers.test(n.layers)&&(e.isMesh||e.isLine||e.isPoints)&&e.castShadow&&(!e.frustumCulled||d.intersectsObject(e))){e.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,e.matrixWorld);var a=r.update(e),u=e.material;if(Array.isArray(u))for(var c=a.groups,h=0,f=c.length;h<f;h++){var p=c[h],m=u[p.materialIndex];m&&m.visible&&(m=s(e,m,o,w),t.renderBufferDirect(i,null,a,m,e,p))}else u.visible&&(m=s(e,u,o,w),t.renderBufferDirect(i,null,a,m,e,null))}for(a=0,u=(e=e.children).length;a<u;a++)l(e[a],n,i,o)}}var h=t.context,f=t.state,d=new Z,p=new c,m=e.shadows,g=new n,v=new n(a.maxTextureSize,a.maxTextureSize),y=new u,w=new u,b=Array(4),x=Array(4),_={},M=[new u(1,0,0),new u(-1,0,0),new u(0,0,1),new u(0,0,-1),new u(0,1,0),new u(0,-1,0)],E=[new u(0,1,0),new u(0,1,0),new u(0,1,0),new u(0,1,0),new u(0,0,1),new u(0,0,-1)],S=[new i,new i,new i,new i,new i,new i];(e=new Y).depthPacking=3201,e.clipping=!0;for(var T=mi.clone((a=vi.distanceRGBA).uniforms),A=0;4!==A;++A){var k=0!=(1&A),C=0!=(2&A),R=e.clone();R.morphTargets=k,R.skinning=C,b[A]=R,k=new W({defines:{USE_SHADOWMAP:""},uniforms:T,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,morphTargets:k,skinning:C,clipping:!0}),x[A]=k}var D=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.renderSingleSided=this.renderReverseSided=!0,this.render=function(e,n){if(!1!==D.enabled&&(!1!==D.autoUpdate||!1!==D.needsUpdate)&&0!==m.length){f.disable(h.BLEND),f.buffers.color.setClear(1,1,1,1),f.buffers.depth.setTest(!0),f.setScissorTest(!1);for(var r,i=0,a=m.length;i<a;i++){var s=m[i];r=s.shadow;var u=s&&s.isPointLight;if(void 0===r)console.warn("THREE.WebGLShadowMap:",s,"has no shadow.");else{var c=r.camera;if(g.copy(r.mapSize),g.min(v),u){var b=g.x,x=g.y;S[0].set(2*b,x,b,x),S[1].set(0,x,b,x),S[2].set(3*b,x,b,x),S[3].set(b,x,b,x),S[4].set(3*b,0,b,x),S[5].set(b,0,b,x),g.x*=4,g.y*=2}for(null===r.map&&(r.map=new o(g.x,g.y,{minFilter:1003,magFilter:1003,format:1023}),r.map.texture.name=s.name+".shadowMap",c.updateProjectionMatrix()),r.isSpotLightShadow&&r.update(s),b=r.map,x=r.matrix,w.setFromMatrixPosition(s.matrixWorld),c.position.copy(w),u?(r=6,x.makeTranslation(-w.x,-w.y,-w.z)):(r=1,y.setFromMatrixPosition(s.target.matrixWorld),c.lookAt(y),c.updateMatrixWorld(),x.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),x.multiply(c.projectionMatrix),x.multiply(c.matrixWorldInverse)),t.setRenderTarget(b),t.clear(),s=0;s<r;s++)u&&(y.copy(c.position),y.add(M[s]),c.up.copy(E[s]),c.lookAt(y),c.updateMatrixWorld(),f.viewport(S[s])),p.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse),d.setFromMatrix(p),l(e,n,c,u)}}i=t.getClearColor(),a=t.getClearAlpha(),t.setClearColor(i,a),D.needsUpdate=!1}}}function tt(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._order=r||tt.DefaultOrder}function et(){this.mask=1}function nt(){Object.defineProperty(this,"id",{value:wi++}),this.uuid=ii.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=nt.DefaultUp.clone();var t=new u,e=new tt,n=new s,r=new u(1,1,1);e.onChange(function(){n.setFromEuler(e,!1)}),n.onChange(function(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:t},rotation:{enumerable:!0,value:e},quaternion:{enumerable:!0,value:n},scale:{enumerable:!0,value:r},modelViewMatrix:{value:new c},normalMatrix:{value:new Q}}),this.matrix=new c,this.matrixWorld=new c,this.matrixAutoUpdate=nt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new et,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function rt(){nt.call(this),this.type="Camera",this.matrixWorldInverse=new c,this.projectionMatrix=new c}function it(t,e,n,r,i,o){rt.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=r,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function ot(t,e,n,r){rt.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function at(t,e,n,r,i,o){this.a=t,this.b=e,this.c=n,this.normal=r&&r.isVector3?r:new u,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new V,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==o?o:0}function st(){Object.defineProperty(this,"id",{value:bi++}),this.uuid=ii.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function ut(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=ii.generateUUID(),this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function ct(t,e){ut.call(this,new Int8Array(t),e)}function lt(t,e){ut.call(this,new Uint8Array(t),e)}function ht(t,e){ut.call(this,new Uint8ClampedArray(t),e)}function ft(t,e){ut.call(this,new Int16Array(t),e)}function dt(t,e){ut.call(this,new Uint16Array(t),e)}function pt(t,e){ut.call(this,new Int32Array(t),e)}function mt(t,e){ut.call(this,new Uint32Array(t),e)}function gt(t,e){ut.call(this,new Float32Array(t),e)}function vt(t,e){ut.call(this,new Float64Array(t),e)}function yt(){this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function wt(t){if(0===t.length)return-1/0;for(var e=t[0],n=1,r=t.length;n<r;++n)t[n]>e&&(e=t[n]);return e}function bt(){Object.defineProperty(this,"id",{value:bi++}),this.uuid=ii.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:1/0}}function xt(t,e,n,r,i,o){st.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o},this.fromBufferGeometry(new _t(t,e,n,r,i,o)),this.mergeVertices()}function _t(t,e,n,r,i,o){function a(t,e,n,r,i,o,a,m,g,v,y){var w=o/g,b=a/v,x=o/2,_=a/2,M=m/2;a=g+1;var E,S,T=v+1,A=o=0,k=new u;for(S=0;S<T;S++){var C=S*b-_;for(E=0;E<a;E++)k[t]=(E*w-x)*r,k[e]=C*i,k[n]=M,l.push(k.x,k.y,k.z),k[t]=0,k[e]=0,k[n]=0<m?1:-1,h.push(k.x,k.y,k.z),f.push(E/g),f.push(1-S/v),o+=1}for(S=0;S<v;S++)for(E=0;E<g;E++)e=d+(E+1)+a*(S+1),c.push(d+E+a*S,t=d+E+a*(S+1),n=d+(E+1)+a*S),c.push(t,e,n),A+=6;s.addGroup(p,A,y),p+=A,d+=o}bt.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};var s=this;r=Math.floor(r)||1,i=Math.floor(i)||1;var c=[],l=[],h=[],f=[],d=0,p=0;a("z","y","x",-1,-1,n,e,t,o=Math.floor(o)||1,i,0),a("z","y","x",1,-1,n,e,-t,o,i,1),a("x","z","y",1,1,t,n,e,r,o,2),a("x","z","y",1,-1,t,n,-e,r,o,3),a("x","y","z",1,-1,t,e,n,r,i,4),a("x","y","z",-1,-1,t,e,-n,r,i,5),this.setIndex(c),this.addAttribute("position",new gt(l,3)),this.addAttribute("normal",new gt(h,3)),this.addAttribute("uv",new gt(f,2))}function Mt(t,e,n,r){st.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new Et(t,e,n,r)),this.mergeVertices()}function Et(t,e,n,r){bt.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};var i=t/2,o=e/2,a=(n=Math.floor(n)||1)+1,s=(r=Math.floor(r)||1)+1,u=t/n,c=e/r,l=[],h=[],f=[],d=[];for(t=0;t<s;t++){var p=t*c-o;for(e=0;e<a;e++)h.push(e*u-i,-p,0),f.push(0,0,1),d.push(e/n),d.push(1-t/r)}for(t=0;t<r;t++)for(e=0;e<n;e++)o=e+1+a*(t+1),l.push(e+a*t,i=e+a*(t+1),s=e+1+a*t),l.push(i,o,s);this.setIndex(l),this.addAttribute("position",new gt(h,3)),this.addAttribute("normal",new gt(f,3)),this.addAttribute("uv",new gt(d,2))}function St(t){G.call(this),this.type="MeshBasicMaterial",this.color=new V(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.lights=this.morphTargets=this.skinning=!1,this.setValues(t)}function Tt(t,e){this.origin=void 0!==t?t:new u,this.direction=void 0!==e?e:new u}function At(t,e){this.start=void 0!==t?t:new u,this.end=void 0!==e?e:new u}function kt(t,e,n){this.a=void 0!==t?t:new u,this.b=void 0!==e?e:new u,this.c=void 0!==n?n:new u}function Ct(t,e){nt.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new bt,this.material=void 0!==e?e:new St({color:16777215*Math.random()}),this.drawMode=0,this.updateMorphTargets()}function Rt(t,e,n,r){function i(t,n){e.buffers.color.setClear(t.r,t.g,t.b,n,r)}var o,a,s,u,c=new V(0),l=0;return{getClearColor:function(){return c},setClearColor:function(t,e){c.set(t),i(c,l=void 0!==e?e:1)},getClearAlpha:function(){return l},setClearAlpha:function(t){i(c,l=t)},render:function(e,r,h){null===(e=e.background)?i(c,l):e&&e.isColor&&(i(e,1),h=!0),(t.autoClear||h)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),e&&e.isCubeTexture?(void 0===s&&(s=new ot,u=new Ct(new _t(5,5,5),new W({uniforms:vi.cube.uniforms,vertexShader:vi.cube.vertexShader,fragmentShader:vi.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))),s.projectionMatrix.copy(r.projectionMatrix),s.matrixWorld.extractRotation(r.matrixWorld),s.matrixWorldInverse.getInverse(s.matrixWorld),u.material.uniforms.tCube.value=e,u.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,u.matrixWorld),n.update(u),t.renderBufferDirect(s,null,u.geometry,u.material,u,null)):e&&e.isTexture&&(void 0===o&&(o=new it(-1,1,1,-1,0,1),a=new Ct(new Et(2,2),new St({depthTest:!1,depthWrite:!1,fog:!1}))),a.material.map=e,n.update(a),t.renderBufferDirect(o,null,a.geometry,a.material,a,null))}}}function Dt(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program&&e.program&&t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Lt(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Ot(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var r;switch(e.type){case"DirectionalLight":r={direction:new u,color:new V,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new n};break;case"SpotLight":r={position:new u,direction:new u,color:new V,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new n};break;case"PointLight":r={position:new u,color:new V,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new n};break;case"HemisphereLight":r={direction:new u,skyColor:new V,groundColor:new V};break;case"RectAreaLight":r={color:new V,position:new u,halfWidth:new u,halfHeight:new u}}return t[e.id]=r}}}function Pt(t,e,n){var r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),!1===t.getShaderParameter(r,t.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(r)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(r),function(t){t=t.split("\n");for(var e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return t.join("\n")}(n)),r}function It(t){switch(t){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw Error("unsupported encoding: "+t)}}function Nt(t,e){var n=It(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Ft(t){return""!==t}function jt(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function zt(t){return t.replace(/^[ \t]*#include +<([\w\d.]+)>/gm,function(t,e){var n=gi[e];if(void 0===n)throw Error("Can not resolve #include <"+e+">");return zt(n)})}function Ut(t){return t.replace(/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(t,e,n,r){for(t="",e=parseInt(e);e<parseInt(n);e++)t+=r.replace(/\[ i \]/g,"[ "+e+" ]");return t})}function Vt(t,e,n,r,i){var o=t.context,a=n.extensions,s=n.defines,u=r.vertexShader,c=r.fragmentShader,l="SHADOWMAP_TYPE_BASIC";1===i.shadowMapType?l="SHADOWMAP_TYPE_PCF":2===i.shadowMapType&&(l="SHADOWMAP_TYPE_PCF_SOFT");var h="ENVMAP_TYPE_CUBE",f="ENVMAP_MODE_REFLECTION",d="ENVMAP_BLENDING_MULTIPLY";if(i.envMap){switch(n.envMap.mapping){case 301:case 302:h="ENVMAP_TYPE_CUBE";break;case 306:case 307:h="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:h="ENVMAP_TYPE_EQUIREC";break;case 305:h="ENVMAP_TYPE_SPHERE"}switch(n.envMap.mapping){case 302:case 304:f="ENVMAP_MODE_REFRACTION"}switch(n.combine){case 0:d="ENVMAP_BLENDING_MULTIPLY";break;case 1:d="ENVMAP_BLENDING_MIX";break;case 2:d="ENVMAP_BLENDING_ADD"}}var p,m,g=0<t.gammaFactor?t.gammaFactor:1,v=(a=function(t,e,n){return[(t=t||{}).derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ft).join("\n")}(a,i,t.extensions),function(t){var e,n=[];for(e in t){var r=t[e];!1!==r&&n.push("#define "+e+" "+r)}return n.join("\n")}(s)),y=o.createProgram();return n.isRawShaderMaterial?(s=[v,"\n"].filter(Ft).join("\n"),r=[a,v,"\n"].filter(Ft).join("\n")):(s=["precision "+i.precision+" float;","precision "+i.precision+" int;","#define SHADER_NAME "+r.name,v,i.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+g,"#define MAX_BONES "+i.maxBones,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+f:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.vertexColors?"#define USE_COLOR":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.useVertexTexture?"#define BONE_TEXTURE":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&!1===i.flatShading?"#define USE_MORPHNORMALS":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+i.numClippingPlanes,i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&t.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Ft).join("\n"),r=[a,"precision "+i.precision+" float;","precision "+i.precision+" int;","#define SHADER_NAME "+r.name,v,i.alphaTest?"#define ALPHATEST "+i.alphaTest:"","#define GAMMA_FACTOR "+g,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+h:"",i.envMap?"#define "+f:"",i.envMap?"#define "+d:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.vertexColors?"#define USE_COLOR":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+i.numClippingPlanes,"#define UNION_CLIPPING_PLANES "+(i.numClippingPlanes-i.numClipIntersection),i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&t.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",i.envMap&&t.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",0!==i.toneMapping?"#define TONE_MAPPING":"",0!==i.toneMapping?gi.tonemapping_pars_fragment:"",0!==i.toneMapping?function(t,e){var n;switch(e){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="Uncharted2";break;case 4:n="OptimizedCineon";break;default:throw Error("unsupported toneMapping: "+e)}return"vec3 toneMapping( vec3 color ) { return "+n+"ToneMapping( color ); }"}(0,i.toneMapping):"",i.dithering?"#define DITHERING":"",i.outputEncoding||i.mapEncoding||i.envMapEncoding||i.emissiveMapEncoding?gi.encodings_pars_fragment:"",i.mapEncoding?Nt("mapTexelToLinear",i.mapEncoding):"",i.envMapEncoding?Nt("envMapTexelToLinear",i.envMapEncoding):"",i.emissiveMapEncoding?Nt("emissiveMapTexelToLinear",i.emissiveMapEncoding):"",i.outputEncoding?function(t,e){var n=It(i.outputEncoding);return"vec4 linearToOutputTexel( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}():"",i.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Ft).join("\n")),u=jt(u=zt(u),i),c=jt(c=zt(c),i),n.isShaderMaterial||(u=Ut(u),c=Ut(c)),c=r+c,u=Pt(o,o.VERTEX_SHADER,s+u),c=Pt(o,o.FRAGMENT_SHADER,c),o.attachShader(y,u),o.attachShader(y,c),void 0!==n.index0AttributeName?o.bindAttribLocation(y,0,n.index0AttributeName):!0===i.morphTargets&&o.bindAttribLocation(y,0,"position"),o.linkProgram(y),i=o.getProgramInfoLog(y),l=o.getShaderInfoLog(u),h=o.getShaderInfoLog(c),d=f=!0,!1===o.getProgramParameter(y,o.LINK_STATUS)?(f=!1,console.error("THREE.WebGLProgram: shader error: ",o.getError(),"gl.VALIDATE_STATUS",o.getProgramParameter(y,o.VALIDATE_STATUS),"gl.getProgramInfoLog",i,l,h)):""!==i?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",i):""!==l&&""!==h||(d=!1),d&&(this.diagnostics={runnable:f,material:n,programLog:i,vertexShader:{log:l,prefix:s},fragmentShader:{log:h,prefix:r}}),o.deleteShader(u),o.deleteShader(c),this.getUniforms=function(){return void 0===p&&(p=new U(o,y,t)),p},this.getAttributes=function(){if(void 0===m){for(var t={},e=o.getProgramParameter(y,o.ACTIVE_ATTRIBUTES),n=0;n<e;n++){var r=o.getActiveAttrib(y,n).name;t[r]=o.getAttribLocation(y,r)}m=t}return m},this.destroy=function(){o.deleteProgram(y),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=xi++,this.code=e,this.usedTimes=1,this.program=y,this.vertexShader=u,this.fragmentShader=c,this}function Bt(t){ot.call(this),this.cameras=t||[]}function Ht(t){var e=this,n=null,r=null;"VRFrameData"in window&&(r=new window.VRFrameData);var o=new c,a=new c,s=new c,u=new ot;u.bounds=new i(0,0,.5,1),u.layers.enable(1);var l=new ot;l.bounds=new i(.5,0,.5,1),l.layers.enable(2);var h,f,d=new Bt([u,l]);d.layers.enable(1),d.layers.enable(2),window.addEventListener("vrdisplaypresentchange",function(){if(n.isPresenting){var r=(i=n.getEyeParameters("left")).renderWidth,i=i.renderHeight;f=t.getPixelRatio(),h=t.getSize(),t.setDrawingBufferSize(2*r,i,1)}else e.enabled&&t.setDrawingBufferSize(h.width,h.height,f)},!1),this.standing=this.enabled=!1,this.getDevice=function(){return n},this.setDevice=function(t){void 0!==t&&(n=t)},this.getCamera=function(t){if(null===n)return t;n.depthNear=t.near,n.depthFar=t.far,n.getFrameData(r);var e=r.pose;return null!==e.position?t.position.fromArray(e.position):t.position.set(0,0,0),null!==e.orientation&&t.quaternion.fromArray(e.orientation),t.updateMatrixWorld(),e=n.stageParameters,this.standing&&e&&(a.fromArray(e.sittingToStandingTransform),s.getInverse(a),t.matrixWorld.multiply(a),t.matrixWorldInverse.multiply(s)),!1===n.isPresenting?t:(d.matrixWorld.copy(t.matrixWorld),d.matrixWorldInverse.copy(t.matrixWorldInverse),u.matrixWorldInverse.fromArray(r.leftViewMatrix),l.matrixWorldInverse.fromArray(r.rightViewMatrix),this.standing&&e&&(u.matrixWorldInverse.multiply(s),l.matrixWorldInverse.multiply(s)),null!==(t=t.parent)&&(o.getInverse(t.matrixWorld),u.matrixWorldInverse.multiply(o),l.matrixWorldInverse.multiply(o)),u.matrixWorld.getInverse(u.matrixWorldInverse),l.matrixWorld.getInverse(l.matrixWorldInverse),u.projectionMatrix.fromArray(r.leftProjectionMatrix),l.projectionMatrix.fromArray(r.rightProjectionMatrix),d.projectionMatrix.copy(u.projectionMatrix),(t=n.getLayers()).length&&(null!==(t=t[0]).leftBounds&&4===t.leftBounds.length&&u.bounds.fromArray(t.leftBounds),null!==t.rightBounds&&4===t.rightBounds.length&&l.bounds.fromArray(t.rightBounds)),d)},this.getStandingMatrix=function(){return a},this.submitFrame=function(){n&&n.isPresenting&&n.submitFrame()}}function qt(){function t(){c.value!==r&&(c.value=r,c.needsUpdate=0<i),n.numPlanes=i,n.numIntersection=0}function e(t,e,r,i){var o=null!==t?t.length:0,a=null;if(0!==o){if(a=c.value,!0!==i||null===a)for(i=r+4*o,u.getNormalMatrix(e=e.matrixWorldInverse),(null===a||a.length<i)&&(a=new Float32Array(i)),i=0;i!==o;++i,r+=4)s.copy(t[i]).applyMatrix4(e,u),s.normal.toArray(a,r),a[r+3]=s.constant;c.value=a,c.needsUpdate=!0}return n.numPlanes=o,a}var n=this,r=null,i=0,o=!1,a=!1,s=new J,u=new Q,c={value:null,needsUpdate:!1};this.uniform=c,this.numIntersection=this.numPlanes=0,this.init=function(t,n,a){var s=0!==t.length||n||0!==i||o;return o=n,r=e(t,a,0),i=t.length,s},this.beginShadows=function(){a=!0,e(null)},this.endShadows=function(){a=!1,t()},this.setState=function(n,s,u,l,h,f){if(!o||null===n||0===n.length||a&&!u)a?e(null):t();else{var d=4*(u=a?0:i),p=h.clippingState||null;for(c.value=p,p=e(n,l,d,f),n=0;n!==d;++n)p[n]=r[n];h.clippingState=p,this.numIntersection=s?this.numPlanes:0,this.numPlanes+=u}}}function Gt(t){function e(){vt.init(),vt.scissor(B.copy(J).multiplyScalar(Q)),vt.viewport(W.copy(et).multiplyScalar(Q))}function n(){z=P=null,j="",F=-1,vt.reset()}function r(t){t.preventDefault(),n(),e(),yt.clear(),Et.clear()}function o(t){(t=t.target).removeEventListener("dispose",o),a(t),yt.remove(t)}function a(t){var e=yt.get(t).program;t.program=void 0,void 0!==e&&St.releaseProgram(e)}function s(t,e){return Math.abs(e[0])-Math.abs(t[0])}function h(t,e,n,r){for(var i=0,o=t.length;i<o;i++){var a=(c=t[i]).object,s=c.geometry,u=void 0===r?c.material:r,c=c.group;if(n.isArrayCamera){V=n;for(var l=n.cameras,h=0,d=l.length;h<d;h++){var p=l[h];if(a.layers.test(p.layers)){var m,g=(m=p.bounds).x*X,v=m.y*$,y=m.z*X;O.setViewport(g,v,y,m=m.w*$),O.setScissor(g,v,y,m),O.setScissorTest(!0),f(a,e,p,s,u,c)}}}else V=null,f(a,e,n,s,u,c)}}function f(t,e,n,r,i,o){if(t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.onBeforeRender(O,e,n,r,i,o),t.isImmediateRenderObject){vt.setMaterial(i);var a=p(n,e.fog,i,t);j="",function(t,e,n){t.render(function(t){O.renderBufferImmediate(t,e,n)})}(t,a,i)}else O.renderBufferDirect(n,e.fog,r,i,t,o);t.onAfterRender(O,e,n,r,i,o)}function d(t,e,n){var r=yt.get(t);n=St.getParameters(t,lt,e,rt.numPlanes,rt.numIntersection,n);var i=St.getProgramCode(t,n),s=r.program,u=!0;if(void 0===s)t.addEventListener("dispose",o);else if(s.code!==i)a(t);else{if(void 0!==n.shaderID)return;u=!1}if(u&&(r.shader=n.shaderID?{name:t.type,uniforms:mi.clone((s=vi[n.shaderID]).uniforms),vertexShader:s.vertexShader,fragmentShader:s.fragmentShader}:{name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader},t.onBeforeCompile(r.shader),s=St.acquireProgram(t,r.shader,n,i),r.program=s,t.program=s),n=s.getAttributes(),t.morphTargets)for(i=t.numSupportedMorphTargets=0;i<O.maxMorphTargets;i++)0<=n["morphTarget"+i]&&t.numSupportedMorphTargets++;if(t.morphNormals)for(i=t.numSupportedMorphNormals=0;i<O.maxMorphNormals;i++)0<=n["morphNormal"+i]&&t.numSupportedMorphNormals++;n=r.shader.uniforms,(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(r.numClippingPlanes=rt.numPlanes,r.numIntersection=rt.numIntersection,n.clippingPlanes=rt.uniform),r.fog=e,r.lightsHash=lt.hash,t.lights&&(n.ambientLightColor.value=lt.ambient,n.directionalLights.value=lt.directional,n.spotLights.value=lt.spot,n.rectAreaLights.value=lt.rectArea,n.pointLights.value=lt.point,n.hemisphereLights.value=lt.hemi,n.directionalShadowMap.value=lt.directionalShadowMap,n.directionalShadowMatrix.value=lt.directionalShadowMatrix,n.spotShadowMap.value=lt.spotShadowMap,n.spotShadowMatrix.value=lt.spotShadowMatrix,n.pointShadowMap.value=lt.pointShadowMap,n.pointShadowMatrix.value=lt.pointShadowMatrix),t=r.program.getUniforms(),t=U.seqWithValue(t.seq,n),r.uniformsList=t}function p(t,e,n,r){Y=0;var i=yt.get(n);it&&(ot||t!==z)&&rt.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,t,i,t===z&&n.id===F),!1===n.needsUpdate&&(void 0===i.program?n.needsUpdate=!0:n.fog&&i.fog!==e?n.needsUpdate=!0:n.lights&&i.lightsHash!==lt.hash?n.needsUpdate=!0:void 0===i.numClippingPlanes||i.numClippingPlanes===rt.numPlanes&&i.numIntersection===rt.numIntersection||(n.needsUpdate=!0)),n.needsUpdate&&(d(n,e,r),n.needsUpdate=!1);var o,a=!1,s=!1,u=!1,c=i.program,h=c.getUniforms(),f=i.shader.uniforms;if(c.id!==P&&(L.useProgram(c.program),P=c.id,u=s=a=!0),n.id!==F&&(F=n.id,s=!0),(a||t!==z)&&(h.setValue(L,"projectionMatrix",t.projectionMatrix),gt.logarithmicDepthBuffer&&h.setValue(L,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),z!==(V||t)&&(z=V||t,u=s=!0),(n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.envMap)&&void 0!==(a=h.map.cameraPosition)&&a.setValue(L,st.setFromMatrixPosition(t.matrixWorld)),(n.isMeshPhongMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&h.setValue(L,"viewMatrix",t.matrixWorldInverse)),n.skinning&&(h.setOptional(L,r,"bindMatrix"),h.setOptional(L,r,"bindMatrixInverse"),t=r.skeleton))if(a=t.bones,gt.floatVertexTextures){if(void 0===t.boneTexture){a=Math.sqrt(4*a.length),a=ii.nextPowerOfTwo(Math.ceil(a)),a=Math.max(a,4);var p=new Float32Array(a*a*4);p.set(t.boneMatrices);var v=new l(p,a,a,1023,1015);t.boneMatrices=p,t.boneTexture=v,t.boneTextureSize=a}h.setValue(L,"boneTexture",t.boneTexture),h.setValue(L,"boneTextureSize",t.boneTextureSize)}else h.setOptional(L,t,"boneMatrices");return s&&(h.setValue(L,"toneMappingExposure",O.toneMappingExposure),h.setValue(L,"toneMappingWhitePoint",O.toneMappingWhitePoint),n.lights&&(f.ambientLightColor.needsUpdate=s=u,f.directionalLights.needsUpdate=s,f.pointLights.needsUpdate=s,f.spotLights.needsUpdate=s,f.rectAreaLights.needsUpdate=s,f.hemisphereLights.needsUpdate=s),e&&n.fog&&(f.fogColor.value=e.color,e.isFog?(f.fogNear.value=e.near,f.fogFar.value=e.far):e.isFogExp2&&(f.fogDensity.value=e.density)),(n.isMeshBasicMaterial||n.isMeshLambertMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.isMeshNormalMaterial||n.isMeshDepthMaterial)&&(f.opacity.value=n.opacity,f.diffuse.value=n.color,n.emissive&&f.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),f.map.value=n.map,f.specularMap.value=n.specularMap,f.alphaMap.value=n.alphaMap,n.lightMap&&(f.lightMap.value=n.lightMap,f.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(f.aoMap.value=n.aoMap,f.aoMapIntensity.value=n.aoMapIntensity),n.map?o=n.map:n.specularMap?o=n.specularMap:n.displacementMap?o=n.displacementMap:n.normalMap?o=n.normalMap:n.bumpMap?o=n.bumpMap:n.roughnessMap?o=n.roughnessMap:n.metalnessMap?o=n.metalnessMap:n.alphaMap?o=n.alphaMap:n.emissiveMap&&(o=n.emissiveMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),f.offsetRepeat.value.set((e=o.offset).x,e.y,(o=o.repeat).x,o.y)),f.envMap.value=n.envMap,f.flipEnvMap.value=n.envMap&&n.envMap.isCubeTexture?-1:1,f.reflectivity.value=n.reflectivity,f.refractionRatio.value=n.refractionRatio),n.isLineBasicMaterial?(f.diffuse.value=n.color,f.opacity.value=n.opacity):n.isLineDashedMaterial?(f.diffuse.value=n.color,f.opacity.value=n.opacity,f.dashSize.value=n.dashSize,f.totalSize.value=n.dashSize+n.gapSize,f.scale.value=n.scale):n.isPointsMaterial?(f.diffuse.value=n.color,f.opacity.value=n.opacity,f.size.value=n.size*Q,f.scale.value=.5*$,f.map.value=n.map,null!==n.map&&f.offsetRepeat.value.set((o=n.map.offset).x,o.y,(n=n.map.repeat).x,n.y)):n.isMeshLambertMaterial?n.emissiveMap&&(f.emissiveMap.value=n.emissiveMap):n.isMeshToonMaterial?(m(f,n),n.gradientMap&&(f.gradientMap.value=n.gradientMap)):n.isMeshPhongMaterial?m(f,n):n.isMeshPhysicalMaterial?(f.clearCoat.value=n.clearCoat,f.clearCoatRoughness.value=n.clearCoatRoughness,g(f,n)):n.isMeshStandardMaterial?g(f,n):n.isMeshDepthMaterial?n.displacementMap&&(f.displacementMap.value=n.displacementMap,f.displacementScale.value=n.displacementScale,f.displacementBias.value=n.displacementBias):n.isMeshNormalMaterial&&(n.bumpMap&&(f.bumpMap.value=n.bumpMap,f.bumpScale.value=n.bumpScale),n.normalMap&&(f.normalMap.value=n.normalMap,f.normalScale.value.copy(n.normalScale)),n.displacementMap&&(f.displacementMap.value=n.displacementMap,f.displacementScale.value=n.displacementScale,f.displacementBias.value=n.displacementBias)),void 0!==f.ltcMat&&(f.ltcMat.value=pi.LTC_MAT_TEXTURE),void 0!==f.ltcMag&&(f.ltcMag.value=pi.LTC_MAG_TEXTURE),U.upload(L,i.uniformsList,f,O)),h.setValue(L,"modelViewMatrix",r.modelViewMatrix),h.setValue(L,"normalMatrix",r.normalMatrix),h.setValue(L,"modelMatrix",r.matrixWorld),c}function m(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function g(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}function v(t,e){var n,r,i,o,a,s,u,c=0,l=0,h=0,f=e.matrixWorldInverse,d=0,p=0,m=0,g=0,v=0;for(n=0,r=t.length;n<r;n++)if(o=(i=t[n]).color,a=i.intensity,s=i.distance,u=i.shadow&&i.shadow.map?i.shadow.map.texture:null,i.isAmbientLight)c+=o.r*a,l+=o.g*a,h+=o.b*a;else if(i.isDirectionalLight){var y=Tt.get(i);y.color.copy(i.color).multiplyScalar(i.intensity),y.direction.setFromMatrixPosition(i.matrixWorld),st.setFromMatrixPosition(i.target.matrixWorld),y.direction.sub(st),y.direction.transformDirection(f),(y.shadow=i.castShadow)&&(y.shadowBias=(o=i.shadow).bias,y.shadowRadius=o.radius,y.shadowMapSize=o.mapSize),lt.directionalShadowMap[d]=u,lt.directionalShadowMatrix[d]=i.shadow.matrix,lt.directional[d]=y,d++}else i.isSpotLight?((y=Tt.get(i)).position.setFromMatrixPosition(i.matrixWorld),y.position.applyMatrix4(f),y.color.copy(o).multiplyScalar(a),y.distance=s,y.direction.setFromMatrixPosition(i.matrixWorld),st.setFromMatrixPosition(i.target.matrixWorld),y.direction.sub(st),y.direction.transformDirection(f),y.coneCos=Math.cos(i.angle),y.penumbraCos=Math.cos(i.angle*(1-i.penumbra)),y.decay=0===i.distance?0:i.decay,(y.shadow=i.castShadow)&&(y.shadowBias=(o=i.shadow).bias,y.shadowRadius=o.radius,y.shadowMapSize=o.mapSize),lt.spotShadowMap[m]=u,lt.spotShadowMatrix[m]=i.shadow.matrix,lt.spot[m]=y,m++):i.isRectAreaLight?((y=Tt.get(i)).color.copy(o).multiplyScalar(a/(i.width*i.height)),y.position.setFromMatrixPosition(i.matrixWorld),y.position.applyMatrix4(f),ct.identity(),ut.copy(i.matrixWorld),ut.premultiply(f),ct.extractRotation(ut),y.halfWidth.set(.5*i.width,0,0),y.halfHeight.set(0,.5*i.height,0),y.halfWidth.applyMatrix4(ct),y.halfHeight.applyMatrix4(ct),lt.rectArea[g]=y,g++):i.isPointLight?((y=Tt.get(i)).position.setFromMatrixPosition(i.matrixWorld),y.position.applyMatrix4(f),y.color.copy(i.color).multiplyScalar(i.intensity),y.distance=i.distance,y.decay=0===i.distance?0:i.decay,(y.shadow=i.castShadow)&&(y.shadowBias=(o=i.shadow).bias,y.shadowRadius=o.radius,y.shadowMapSize=o.mapSize),lt.pointShadowMap[p]=u,lt.pointShadowMatrix[p]=i.shadow.matrix,lt.point[p]=y,p++):i.isHemisphereLight&&((y=Tt.get(i)).direction.setFromMatrixPosition(i.matrixWorld),y.direction.transformDirection(f),y.direction.normalize(),y.skyColor.copy(i.color).multiplyScalar(a),y.groundColor.copy(i.groundColor).multiplyScalar(a),lt.hemi[v]=y,v++);lt.ambient[0]=c,lt.ambient[1]=l,lt.ambient[2]=h,lt.directional.length=d,lt.spot.length=m,lt.rectArea.length=g,lt.point.length=p,lt.hemi.length=v,lt.hash=d+","+p+","+m+","+g+","+v+","+lt.shadows.length}function y(t){var e;if(1e3===t)return L.REPEAT;if(1001===t)return L.CLAMP_TO_EDGE;if(1002===t)return L.MIRRORED_REPEAT;if(1003===t)return L.NEAREST;if(1004===t)return L.NEAREST_MIPMAP_NEAREST;if(1005===t)return L.NEAREST_MIPMAP_LINEAR;if(1006===t)return L.LINEAR;if(1007===t)return L.LINEAR_MIPMAP_NEAREST;if(1008===t)return L.LINEAR_MIPMAP_LINEAR;if(1009===t)return L.UNSIGNED_BYTE;if(1017===t)return L.UNSIGNED_SHORT_4_4_4_4;if(1018===t)return L.UNSIGNED_SHORT_5_5_5_1;if(1019===t)return L.UNSIGNED_SHORT_5_6_5;if(1010===t)return L.BYTE;if(1011===t)return L.SHORT;if(1012===t)return L.UNSIGNED_SHORT;if(1013===t)return L.INT;if(1014===t)return L.UNSIGNED_INT;if(1015===t)return L.FLOAT;if(1016===t&&null!==(e=pt.get("OES_texture_half_float")))return e.HALF_FLOAT_OES;if(1021===t)return L.ALPHA;if(1022===t)return L.RGB;if(1023===t)return L.RGBA;if(1024===t)return L.LUMINANCE;if(1025===t)return L.LUMINANCE_ALPHA;if(1026===t)return L.DEPTH_COMPONENT;if(1027===t)return L.DEPTH_STENCIL;if(100===t)return L.FUNC_ADD;if(101===t)return L.FUNC_SUBTRACT;if(102===t)return L.FUNC_REVERSE_SUBTRACT;if(200===t)return L.ZERO;if(201===t)return L.ONE;if(202===t)return L.SRC_COLOR;if(203===t)return L.ONE_MINUS_SRC_COLOR;if(204===t)return L.SRC_ALPHA;if(205===t)return L.ONE_MINUS_SRC_ALPHA;if(206===t)return L.DST_ALPHA;if(207===t)return L.ONE_MINUS_DST_ALPHA;if(208===t)return L.DST_COLOR;if(209===t)return L.ONE_MINUS_DST_COLOR;if(210===t)return L.SRC_ALPHA_SATURATE;if((2001===t||2002===t||2003===t||2004===t)&&null!==(e=pt.get("WEBGL_compressed_texture_s3tc"))){if(2001===t)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(2002===t)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(2003===t)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(2004===t)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((2100===t||2101===t||2102===t||2103===t)&&null!==(e=pt.get("WEBGL_compressed_texture_pvrtc"))){if(2100===t)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(2101===t)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(2102===t)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(2103===t)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(2151===t&&null!==(e=pt.get("WEBGL_compressed_texture_etc1")))return e.COMPRESSED_RGB_ETC1_WEBGL;if((103===t||104===t)&&null!==(e=pt.get("EXT_blend_minmax"))){if(103===t)return e.MIN_EXT;if(104===t)return e.MAX_EXT}return 1020===t&&null!==(e=pt.get("WEBGL_depth_texture"))?e.UNSIGNED_INT_24_8_WEBGL:0}console.log("THREE.WebGLRenderer","86");var w=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),b=void 0!==t.context?t.context:null,x=void 0!==t.alpha&&t.alpha,_=void 0===t.depth||t.depth,M=void 0===t.stencil||t.stencil,E=void 0!==t.antialias&&t.antialias,S=void 0===t.premultipliedAlpha||t.premultipliedAlpha,T=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,A=[],k=null,C=new Float32Array(8),R=[],D=[];this.domElement=w,this.context=null,this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.physicallyCorrectLights=this.gammaOutput=this.gammaInput=!1,this.toneMappingWhitePoint=this.toneMappingExposure=this.toneMapping=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var L,O=this,P=null,I=null,N=null,F=-1,j="",z=null,V=null,B=new i,G=null,W=new i,Y=0,X=w.width,$=w.height,Q=1,J=new i(0,0,X,$),tt=!1,et=new i(0,0,X,$),nt=new Z,rt=new qt,it=!1,ot=!1,at=new c,st=new u,ut=new c,ct=new c,lt={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[]},ht={geometries:0,textures:0},ft={frame:0,calls:0,vertices:0,faces:0,points:0};this.info={render:ft,memory:ht,programs:null};try{if(x={alpha:x,depth:_,stencil:M,antialias:E,premultipliedAlpha:S,preserveDrawingBuffer:T},null===(L=b||w.getContext("webgl",x)||w.getContext("experimental-webgl",x))){if(null!==w.getContext("webgl"))throw"Error creating WebGL context with your selected attributes.";throw"Error creating WebGL context."}void 0===L.getShaderPrecisionFormat&&(L.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),w.addEventListener("webglcontextlost",r,!1)}catch(t){console.error("THREE.WebGLRenderer: "+t)}var pt=new function(t){var e={};return{get:function(n){if(void 0!==e[n])return e[n];var r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":r=t.getExtension("WEBGL_compressed_texture_etc1");break;default:r=t.getExtension(n)}return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),e[n]=r}}}(L);pt.get("WEBGL_depth_texture"),pt.get("OES_texture_float"),pt.get("OES_texture_float_linear"),pt.get("OES_texture_half_float"),pt.get("OES_texture_half_float_linear"),pt.get("OES_standard_derivatives"),pt.get("ANGLE_instanced_arrays"),pt.get("OES_element_index_uint")&&(bt.MaxIndex=4294967296);var gt=new function(t,e,n){function r(e){if("highp"===e){if(0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision)return"highp";e="mediump"}return"mediump"===e&&0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision?"mediump":"lowp"}var i,o=void 0!==n.precision?n.precision:"highp";(a=r(o))!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",a,"instead."),o=a),n=!0===n.logarithmicDepthBuffer&&!!e.get("EXT_frag_depth");var a=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),s=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),u=t.getParameter(t.MAX_TEXTURE_SIZE),c=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),l=t.getParameter(t.MAX_VERTEX_ATTRIBS),h=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),f=t.getParameter(t.MAX_VARYING_VECTORS),d=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),p=0<s,m=!!e.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!==i)return i;var n=e.get("EXT_texture_filter_anisotropic");return i=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:r,precision:o,logarithmicDepthBuffer:n,maxTextures:a,maxVertexTextures:s,maxTextureSize:u,maxCubemapSize:c,maxAttributes:l,maxVertexUniforms:h,maxVaryings:f,maxFragmentUniforms:d,vertexTextures:p,floatFragmentTextures:m,floatVertexTextures:p&&m}}(L,pt,t),vt=new function(t,e,n){function r(e,n,r){var i=new Uint8Array(4),o=t.createTexture();for(t.bindTexture(e,o),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST),e=0;e<r;e++)t.texImage2D(n+e,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,i);return o}function o(e){!0!==w[e]&&(t.enable(e),w[e]=!0)}function a(e){!1!==w[e]&&(t.disable(e),w[e]=!1)}function s(e,r,i,s,u,c,l,h){0!==e?o(t.BLEND):a(t.BLEND),5===e||e===x&&h===k||(2===e?h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE)):3===e?h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR)):4===e?h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR)):h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)),x=e,k=h),5===e?(u=u||r,c=c||i,l=l||s,r===_&&u===S||(t.blendEquationSeparate(n(r),n(u)),_=r,S=u),i===M&&s===E&&c===T&&l===A||(t.blendFuncSeparate(n(i),n(s),n(c),n(l)),M=i,E=s,T=c,A=l)):A=T=S=E=M=_=null}function u(e){C!==e&&(t.frontFace(e?t.CW:t.CCW),C=e)}function c(e){0!==e?(o(t.CULL_FACE),e!==R&&t.cullFace(1===e?t.BACK:2===e?t.FRONT:t.FRONT_AND_BACK)):a(t.CULL_FACE),R=e}function l(e,n,r){e?(o(t.POLYGON_OFFSET_FILL),(L!==n||O!==r)&&(t.polygonOffset(n,r),L=n,O=r)):a(t.POLYGON_OFFSET_FILL)}function h(e){void 0===e&&(e=t.TEXTURE0+I-1),F!==e&&(t.activeTexture(e),F=e)}var f=new function(){var e=!1,n=new i,r=null,o=new i;return{setMask:function(n){r===n||e||(t.colorMask(n,n,n,n),r=n)},setLocked:function(t){e=t},setClear:function(e,r,i,a,s){!0===s&&(e*=a,r*=a,i*=a),n.set(e,r,i,a),!1===o.equals(n)&&(t.clearColor(e,r,i,a),o.copy(n))},reset:function(){e=!1,r=null,o.set(0,0,0,1)}}},d=new function(){var e=!1,n=null,r=null,i=null;return{setTest:function(e){e?o(t.DEPTH_TEST):a(t.DEPTH_TEST)},setMask:function(r){n===r||e||(t.depthMask(r),n=r)},setFunc:function(e){if(r!==e){if(e)switch(e){case 0:t.depthFunc(t.NEVER);break;case 1:t.depthFunc(t.ALWAYS);break;case 2:t.depthFunc(t.LESS);break;case 3:t.depthFunc(t.LEQUAL);break;case 4:t.depthFunc(t.EQUAL);break;case 5:t.depthFunc(t.GEQUAL);break;case 6:t.depthFunc(t.GREATER);break;case 7:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);r=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,i=r=n=null}}},p=new function(){var e=!1,n=null,r=null,i=null,s=null,u=null,c=null,l=null,h=null;return{setTest:function(e){e?o(t.STENCIL_TEST):a(t.STENCIL_TEST)},setMask:function(r){n===r||e||(t.stencilMask(r),n=r)},setFunc:function(e,n,o){r===e&&i===n&&s===o||(t.stencilFunc(e,n,o),r=e,i=n,s=o)},setOp:function(e,n,r){u===e&&c===n&&l===r||(t.stencilOp(e,n,r),u=e,c=n,l=r)},setLocked:function(t){e=t},setClear:function(e){h!==e&&(t.clearStencil(e),h=e)},reset:function(){e=!1,h=l=c=u=s=i=r=n=null}}},m=t.getParameter(t.MAX_VERTEX_ATTRIBS),g=new Uint8Array(m),v=new Uint8Array(m),y=new Uint8Array(m),w={},b=null,x=null,_=null,M=null,E=null,S=null,T=null,A=null,k=!1,C=null,R=null,D=null,L=null,O=null,P=null,I=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),N=(m=parseFloat(/^WebGL\ ([0-9])/.exec(t.getParameter(t.VERSION))[1]),1<=parseFloat(m)),F=null,j={},z=new i,U=new i,V={};return V[t.TEXTURE_2D]=r(t.TEXTURE_2D,t.TEXTURE_2D,1),V[t.TEXTURE_CUBE_MAP]=r(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),{buffers:{color:f,depth:d,stencil:p},init:function(){f.setClear(0,0,0,1),d.setClear(1),p.setClear(0),o(t.DEPTH_TEST),d.setFunc(3),u(!1),c(1),o(t.CULL_FACE),o(t.BLEND),s(1)},initAttributes:function(){for(var t=0,e=g.length;t<e;t++)g[t]=0},enableAttribute:function(n){g[n]=1,0===v[n]&&(t.enableVertexAttribArray(n),v[n]=1),0!==y[n]&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,0),y[n]=0)},enableAttributeAndDivisor:function(n,r){g[n]=1,0===v[n]&&(t.enableVertexAttribArray(n),v[n]=1),y[n]!==r&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,r),y[n]=r)},disableUnusedAttributes:function(){for(var e=0,n=v.length;e!==n;++e)v[e]!==g[e]&&(t.disableVertexAttribArray(e),v[e]=0)},enable:o,disable:a,getCompressedTextureFormats:function(){if(null===b&&(b=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")))for(var n=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),r=0;r<n.length;r++)b.push(n[r]);return b},setBlending:s,setMaterial:function(e){2===e.side?a(t.CULL_FACE):o(t.CULL_FACE),u(1===e.side),!0===e.transparent?s(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha):s(0),d.setFunc(e.depthFunc),d.setTest(e.depthTest),d.setMask(e.depthWrite),f.setMask(e.colorWrite),l(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:u,setCullFace:c,setLineWidth:function(e){e!==D&&(N&&t.lineWidth(e),D=e)},setPolygonOffset:l,getScissorTest:function(){return P},setScissorTest:function(e){(P=e)?o(t.SCISSOR_TEST):a(t.SCISSOR_TEST)},activeTexture:h,bindTexture:function(e,n){null===F&&h();var r=j[F];void 0===r&&(j[F]=r={type:void 0,texture:void 0}),r.type===e&&r.texture===n||(t.bindTexture(e,n||V[e]),r.type=e,r.texture=n)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===z.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),z.copy(e))},viewport:function(e){!1===U.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),U.copy(e))},reset:function(){for(var e=0;e<v.length;e++)1===v[e]&&(t.disableVertexAttribArray(e),v[e]=0);w={},F=b=null,j={},R=C=x=null,f.reset(),d.reset(),p.reset()}}}(L,pt,y),yt=new function(){var t={};return{get:function(e){var n=t[e=e.uuid];return void 0===n&&(t[e]=n={}),n},remove:function(e){delete t[e.uuid]},clear:function(){t={}}}},xt=new function(t,e,n,r,i,o,a){function s(t,e){if(t.width>e||t.height>e){var n=e/Math.max(t.width,t.height),r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return r.width=Math.floor(t.width*n),r.height=Math.floor(t.height*n),r.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,r.width,r.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+r.width+"x"+r.height,t),r}return t}function u(t){return ii.isPowerOfTwo(t.width)&&ii.isPowerOfTwo(t.height)}function c(t,e){return t.generateMipmaps&&e&&1003!==t.minFilter&&1006!==t.minFilter}function l(e){return 1003===e||1004===e||1005===e?t.NEAREST:t.LINEAR}function h(e){(e=e.target).removeEventListener("dispose",h);t:{var n=r.get(e);if(e.image&&n.__image__webglTextureCube)t.deleteTexture(n.__image__webglTextureCube);else{if(void 0===n.__webglInit)break t;t.deleteTexture(n.__webglTexture)}r.remove(e)}a.textures--}function f(e){(e=e.target).removeEventListener("dispose",f);var n=r.get(e),i=r.get(e.texture);if(e){if(void 0!==i.__webglTexture&&t.deleteTexture(i.__webglTexture),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLRenderTargetCube)for(i=0;6>i;i++)t.deleteFramebuffer(n.__webglFramebuffer[i]),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[i]);else t.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer);r.remove(e.texture),r.remove(e)}a.textures--}function d(e,l){var f=r.get(e);if(0<e.version&&f.__version!==e.version)if(void 0===(m=e.image))console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",e);else{if(!1!==m.complete){void 0===f.__webglInit&&(f.__webglInit=!0,e.addEventListener("dispose",h),f.__webglTexture=t.createTexture(),a.textures++),n.activeTexture(t.TEXTURE0+l),n.bindTexture(t.TEXTURE_2D,f.__webglTexture),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,e.unpackAlignment);var d=s(e.image,i.maxTextureSize);(1001!==e.wrapS||1001!==e.wrapT||1003!==e.minFilter&&1006!==e.minFilter)&&!1===u(d)&&((m=d)instanceof HTMLImageElement||m instanceof HTMLCanvasElement?((g=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=ii.nearestPowerOfTwo(m.width),g.height=ii.nearestPowerOfTwo(m.height),g.getContext("2d").drawImage(m,0,0,g.width,g.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+m.width+"x"+m.height+"). Resized to "+g.width+"x"+g.height,m),d=g):d=m);var m=u(d),g=o(e.format),y=o(e.type);p(t.TEXTURE_2D,e,m);var w=e.mipmaps;if(e.isDepthTexture){if(w=t.DEPTH_COMPONENT,1015===e.type){if(!v)throw Error("Float Depth Texture only supported in WebGL2.0");w=t.DEPTH_COMPONENT32F}else v&&(w=t.DEPTH_COMPONENT16);1026===e.format&&w===t.DEPTH_COMPONENT&&1012!==e.type&&1014!==e.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),e.type=1012,y=o(e.type)),1027===e.format&&(w=t.DEPTH_STENCIL,1020!==e.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),e.type=1020,y=o(e.type))),n.texImage2D(t.TEXTURE_2D,0,w,d.width,d.height,0,g,y,null)}else if(e.isDataTexture)if(0<w.length&&m){for(var b=0,x=w.length;b<x;b++)n.texImage2D(t.TEXTURE_2D,b,g,(d=w[b]).width,d.height,0,g,y,d.data);e.generateMipmaps=!1}else n.texImage2D(t.TEXTURE_2D,0,g,d.width,d.height,0,g,y,d.data);else if(e.isCompressedTexture)for(b=0,x=w.length;b<x;b++)d=w[b],1023!==e.format&&1022!==e.format?-1<n.getCompressedTextureFormats().indexOf(g)?n.compressedTexImage2D(t.TEXTURE_2D,b,g,d.width,d.height,0,d.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(t.TEXTURE_2D,b,g,d.width,d.height,0,g,y,d.data);else if(0<w.length&&m){for(b=0,x=w.length;b<x;b++)n.texImage2D(t.TEXTURE_2D,b,g,g,y,d=w[b]);e.generateMipmaps=!1}else n.texImage2D(t.TEXTURE_2D,0,g,g,y,d);return c(e,m)&&t.generateMipmap(t.TEXTURE_2D),f.__version=e.version,void(e.onUpdate&&e.onUpdate(e))}console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",e)}n.activeTexture(t.TEXTURE0+l),n.bindTexture(t.TEXTURE_2D,f.__webglTexture)}function p(n,a,s){s?(t.texParameteri(n,t.TEXTURE_WRAP_S,o(a.wrapS)),t.texParameteri(n,t.TEXTURE_WRAP_T,o(a.wrapT)),t.texParameteri(n,t.TEXTURE_MAG_FILTER,o(a.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,o(a.minFilter))):(t.texParameteri(n,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(n,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),1001===a.wrapS&&1001===a.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",a),t.texParameteri(n,t.TEXTURE_MAG_FILTER,l(a.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,l(a.minFilter)),1003!==a.minFilter&&1006!==a.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",a)),!(s=e.get("EXT_texture_filter_anisotropic"))||1015===a.type&&null===e.get("OES_texture_float_linear")||1016===a.type&&null===e.get("OES_texture_half_float_linear")||!(1<a.anisotropy||r.get(a).__currentAnisotropy)||(t.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}function m(e,i,a,s){var u=o(i.texture.format),c=o(i.texture.type);n.texImage2D(s,0,u,i.width,i.height,0,u,c,null),t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,a,s,r.get(i.texture).__webglTexture,0),t.bindFramebuffer(t.FRAMEBUFFER,null)}function g(e,n){t.bindRenderbuffer(t.RENDERBUFFER,e),n.depthBuffer&&!n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)):n.depthBuffer&&n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e)):t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,n.width,n.height),t.bindRenderbuffer(t.RENDERBUFFER,null)}var v="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext;this.setTexture2D=d,this.setTextureCube=function(e,l){var f=r.get(e);if(6===e.image.length)if(0<e.version&&f.__version!==e.version){f.__image__webglTextureCube||(e.addEventListener("dispose",h),f.__image__webglTextureCube=t.createTexture(),a.textures++),n.activeTexture(t.TEXTURE0+l),n.bindTexture(t.TEXTURE_CUBE_MAP,f.__image__webglTextureCube),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var d=e&&e.isCompressedTexture,m=e.image[0]&&e.image[0].isDataTexture,g=[],v=0;6>v;v++)g[v]=d||m?m?e.image[v].image:e.image[v]:s(e.image[v],i.maxCubemapSize);var y=u(g[0]),w=o(e.format),b=o(e.type);for(p(t.TEXTURE_CUBE_MAP,e,y),v=0;6>v;v++)if(d)for(var x,_=g[v].mipmaps,M=0,E=_.length;M<E;M++)x=_[M],1023!==e.format&&1022!==e.format?-1<n.getCompressedTextureFormats().indexOf(w)?n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,M,w,x.width,x.height,0,x.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,M,w,x.width,x.height,0,w,b,x.data);else m?n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,w,g[v].width,g[v].height,0,w,b,g[v].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,w,w,b,g[v]);c(e,y)&&t.generateMipmap(t.TEXTURE_CUBE_MAP),f.__version=e.version,e.onUpdate&&e.onUpdate(e)}else n.activeTexture(t.TEXTURE0+l),n.bindTexture(t.TEXTURE_CUBE_MAP,f.__image__webglTextureCube)},this.setTextureCubeDynamic=function(e,i){n.activeTexture(t.TEXTURE0+i),n.bindTexture(t.TEXTURE_CUBE_MAP,r.get(e).__webglTexture)},this.setupRenderTarget=function(e){var i=r.get(e),o=r.get(e.texture);e.addEventListener("dispose",f),o.__webglTexture=t.createTexture(),a.textures++;var s=!0===e.isWebGLRenderTargetCube,l=u(e);if(s){i.__webglFramebuffer=[];for(var h=0;6>h;h++)i.__webglFramebuffer[h]=t.createFramebuffer()}else i.__webglFramebuffer=t.createFramebuffer();if(s){for(n.bindTexture(t.TEXTURE_CUBE_MAP,o.__webglTexture),p(t.TEXTURE_CUBE_MAP,e.texture,l),h=0;6>h;h++)m(i.__webglFramebuffer[h],e,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+h);c(e.texture,l)&&t.generateMipmap(t.TEXTURE_CUBE_MAP),n.bindTexture(t.TEXTURE_CUBE_MAP,null)}else n.bindTexture(t.TEXTURE_2D,o.__webglTexture),p(t.TEXTURE_2D,e.texture,l),m(i.__webglFramebuffer,e,t.COLOR_ATTACHMENT0,t.TEXTURE_2D),c(e.texture,l)&&t.generateMipmap(t.TEXTURE_2D),n.bindTexture(t.TEXTURE_2D,null);if(e.depthBuffer){if(i=r.get(e),o=!0===e.isWebGLRenderTargetCube,e.depthTexture){if(o)throw Error("target.depthTexture not supported in Cube render targets");if(e&&e.isWebGLRenderTargetCube)throw Error("Depth Texture with cube render targets is not supported!");if(t.bindFramebuffer(t.FRAMEBUFFER,i.__webglFramebuffer),!e.depthTexture||!e.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(r.get(e.depthTexture).__webglTexture&&e.depthTexture.image.width===e.width&&e.depthTexture.image.height===e.height||(e.depthTexture.image.width=e.width,e.depthTexture.image.height=e.height,e.depthTexture.needsUpdate=!0),d(e.depthTexture,0),i=r.get(e.depthTexture).__webglTexture,1026===e.depthTexture.format)t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,i,0);else{if(1027!==e.depthTexture.format)throw Error("Unknown depthTexture format");t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,i,0)}}else if(o)for(i.__webglDepthbuffer=[],o=0;6>o;o++)t.bindFramebuffer(t.FRAMEBUFFER,i.__webglFramebuffer[o]),i.__webglDepthbuffer[o]=t.createRenderbuffer(),g(i.__webglDepthbuffer[o],e);else t.bindFramebuffer(t.FRAMEBUFFER,i.__webglFramebuffer),i.__webglDepthbuffer=t.createRenderbuffer(),g(i.__webglDepthbuffer,e);t.bindFramebuffer(t.FRAMEBUFFER,null)}},this.updateRenderTargetMipmap=function(e){var i=e.texture;c(i,u(e))&&(e=e.isWebGLRenderTargetCube?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,i=r.get(i).__webglTexture,n.bindTexture(e,i),t.generateMipmap(e),n.bindTexture(e,null))}}(L,pt,vt,yt,gt,y,ht),_t=new function(t){var e={};return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),e[t.uuid]},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);var r=e[n.uuid];r&&(t.deleteBuffer(r.buffer),delete e[n.uuid])},update:function(n,r){if(n.isInterleavedBufferAttribute&&(n=n.data),void 0===(i=e[n.uuid])){var i=n.uuid,o=n,a=o.array,s=o.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW,u=t.createBuffer();t.bindBuffer(r,u),t.bufferData(r,a,s),o.onUploadCallback(),s=t.FLOAT,a instanceof Float32Array?s=t.FLOAT:a instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):a instanceof Uint16Array?s=t.UNSIGNED_SHORT:a instanceof Int16Array?s=t.SHORT:a instanceof Uint32Array?s=t.UNSIGNED_INT:a instanceof Int32Array?s=t.INT:a instanceof Int8Array?s=t.BYTE:a instanceof Uint8Array&&(s=t.UNSIGNED_BYTE),e[i]={buffer:u,type:s,bytesPerElement:a.BYTES_PER_ELEMENT,version:o.version}}else i.version<n.version&&(a=(o=n).array,u=o.updateRange,t.bindBuffer(r,i.buffer),!1===o.dynamic?t.bufferData(r,a,t.STATIC_DRAW):-1===u.count?t.bufferSubData(r,0,a):0===u.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(r,u.offset*a.BYTES_PER_ELEMENT,a.subarray(u.offset,u.offset+u.count)),u.count=-1),i.version=n.version)}}}(L),Mt=new function(t,e,n){function r(t){var a=i[(t=t.target).id];for(var s in null!==a.index&&e.remove(a.index),a.attributes)e.remove(a.attributes[s]);t.removeEventListener("dispose",r),delete i[t.id],(s=o[t.id])&&(e.remove(s),delete o[t.id]),(s=o[a.id])&&(e.remove(s),delete o[a.id]),n.geometries--}var i={},o={};return{get:function(t,e){var o=i[e.id];return o||(e.addEventListener("dispose",r),e.isBufferGeometry?o=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new bt).setFromObject(t)),o=e._bufferGeometry),i[e.id]=o,n.geometries++,o)},update:function(n){var r=n.index,i=n.attributes;for(var o in null!==r&&e.update(r,t.ELEMENT_ARRAY_BUFFER),i)e.update(i[o],t.ARRAY_BUFFER);for(o in n=n.morphAttributes){i=0;for(var a=(r=n[o]).length;i<a;i++)e.update(r[i],t.ARRAY_BUFFER)}},getWireframeAttribute:function(n){if(r=o[n.id])return r;var r=[],i=n.attributes;if(null!==(a=n.index)){i=0;for(var a,s=(a=a.array).length;i<s;i+=3){var u=a[i+0],c=a[i+1],l=a[i+2];r.push(u,c,c,l,l,u)}}else for(a=i.position.array,i=0,s=a.length/3-1;i<s;i+=3)r.push(u=i+0,c=i+1,c,l=i+2,l,u);return r=new(65535<wt(r)?mt:dt)(r,1),e.update(r,t.ELEMENT_ARRAY_BUFFER),o[n.id]=r}}}(L,_t,ht),Et=new function(t,e,n){var r={};return{update:function(t){var i=n.frame,o=t.geometry,a=e.get(t,o);return r[a.id]!==i&&(o.isGeometry&&a.updateFromObject(t),e.update(a),r[a.id]=i),a},clear:function(){r={}}}}(L,Mt,ft),St=new function(t,e){function n(t,e){var n;return t?t.isTexture?n=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=t.texture.encoding):n=3e3,3e3===n&&e&&(n=3007),n}var r=[],i={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},o="precision supportsVertexTextures map mapEncoding envMap envMapMode envMapEncoding lightMap aoMap emissiveMap emissiveMapEncoding bumpMap normalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors fog useFog fogExp flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering".split(" ");this.getParameters=function(r,o,a,s,u,c){var l,h=i[r.type];if(c.isSkinnedMesh)if(l=c.skeleton.bones,e.floatVertexTextures)l=1024;else{var f=Math.min(Math.floor((e.maxVertexUniforms-20)/4),l.length);f<l.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+l.length+" bones. This GPU supports "+f+"."),l=0):l=f}else l=0;f=t.getPrecision(),null!==r.precision&&(f=e.getMaxPrecision(r.precision))!==r.precision&&console.warn("THREE.WebGLProgram.getParameters:",r.precision,"not supported, using",f,"instead.");var d=t.getRenderTarget();return{shaderID:h,precision:f,supportsVertexTextures:e.vertexTextures,outputEncoding:n(d?d.texture:null,t.gammaOutput),map:!!r.map,mapEncoding:n(r.map,t.gammaInput),envMap:!!r.envMap,envMapMode:r.envMap&&r.envMap.mapping,envMapEncoding:n(r.envMap,t.gammaInput),envMapCubeUV:!!r.envMap&&(306===r.envMap.mapping||307===r.envMap.mapping),lightMap:!!r.lightMap,aoMap:!!r.aoMap,emissiveMap:!!r.emissiveMap,emissiveMapEncoding:n(r.emissiveMap,t.gammaInput),bumpMap:!!r.bumpMap,normalMap:!!r.normalMap,displacementMap:!!r.displacementMap,roughnessMap:!!r.roughnessMap,metalnessMap:!!r.metalnessMap,specularMap:!!r.specularMap,alphaMap:!!r.alphaMap,gradientMap:!!r.gradientMap,combine:r.combine,vertexColors:r.vertexColors,fog:!!a,useFog:r.fog,fogExp:a&&a.isFogExp2,flatShading:1===r.shading,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:e.logarithmicDepthBuffer,skinning:r.skinning&&0<l,maxBones:l,useVertexTexture:e.floatVertexTextures,morphTargets:r.morphTargets,morphNormals:r.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numClippingPlanes:s,numClipIntersection:u,dithering:r.dithering,shadowMapEnabled:t.shadowMap.enabled&&c.receiveShadow&&0<o.shadows.length,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:r.premultipliedAlpha,alphaTest:r.alphaTest,doubleSided:2===r.side,flipSided:1===r.side,depthPacking:void 0!==r.depthPacking&&r.depthPacking}},this.getProgramCode=function(e,n){var r=[];if(n.shaderID?r.push(n.shaderID):(r.push(e.fragmentShader),r.push(e.vertexShader)),void 0!==e.defines)for(var i in e.defines)r.push(i),r.push(e.defines[i]);for(i=0;i<o.length;i++)r.push(n[o[i]]);return r.push(e.onBeforeCompile.toString()),r.push(t.gammaOutput),r.join()},this.acquireProgram=function(e,n,i,o){for(var a,s=0,u=r.length;s<u;s++){var c=r[s];if(c.code===o){++(a=c).usedTimes;break}}return void 0===a&&(a=new Vt(t,o,e,n,i),r.push(a)),a},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=r.indexOf(t);r[e]=r[r.length-1],r.pop(),t.destroy()}},this.programs=r}(this,gt),Tt=new Ot,At=new function(){var t={};return{get:function(e,n){var r=e.id+","+n.id,i=t[r];return void 0===i&&(i=new function(){var t=[],e=-1,n=[],r=-1;return{opaque:t,transparent:n,init:function(){r=e=-1},push:function(i,o,a,s,u){var c,l;a.transparent?(c=n,l=++r):(c=t,l=++e),(l=c[l])?(l.id=i.id,l.object=i,l.geometry=o,l.material=a,l.program=a.program,l.renderOrder=i.renderOrder,l.z=s,l.group=u):c.push(l={id:i.id,object:i,geometry:o,material:a,program:a.program,renderOrder:i.renderOrder,z:s,group:u})},finish:function(){t.length=e+1,n.length=r+1},sort:function(){t.sort(Dt),n.sort(Lt)}}},t[r]=i),i},dispose:function(){t={}}}},kt=new Rt(this,vt,Et,S),Ct=new Ht(this);this.info.programs=St.programs;var Pt=new function(t,e,n){var r;this.setMode=function(t){r=t},this.render=function(e,i){t.drawArrays(r,e,i),n.calls++,n.vertices+=i,r===t.TRIANGLES&&(n.faces+=i/3)},this.renderInstances=function(i,o,a){var s=e.get("ANGLE_instanced_arrays");if(null===s)console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{var u=i.attributes.position;u.isInterleavedBufferAttribute?s.drawArraysInstancedANGLE(r,0,a=u.data.count,i.maxInstancedCount):s.drawArraysInstancedANGLE(r,o,a,i.maxInstancedCount),n.calls++,n.vertices+=a*i.maxInstancedCount,r===t.TRIANGLES&&(n.faces+=i.maxInstancedCount*a/3)}}}(L,pt,ft),It=new function(t,e,n){var r,i,o;this.setMode=function(t){r=t},this.setIndex=function(t){i=t.type,o=t.bytesPerElement},this.render=function(e,a){t.drawElements(r,a,i,e*o),n.calls++,n.vertices+=a,r===t.TRIANGLES&&(n.faces+=a/3)},this.renderInstances=function(a,s,u){var c=e.get("ANGLE_instanced_arrays");null===c?console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):(c.drawElementsInstancedANGLE(r,u,i,s*o,a.maxInstancedCount),n.calls++,n.vertices+=u*a.maxInstancedCount,r===t.TRIANGLES&&(n.faces+=a.maxInstancedCount*u/3))}}(L,pt,ft);e(),this.context=L,this.capabilities=gt,this.extensions=pt,this.properties=yt,this.renderLists=At,this.state=vt,this.vr=Ct;var Nt=new K(this,lt,Et,gt);this.shadowMap=Nt;var Ft=new q(this,R),jt=new H(this,D);this.getContext=function(){return L},this.getContextAttributes=function(){return L.getContextAttributes()},this.forceContextLoss=function(){var t=pt.get("WEBGL_lose_context");t&&t.loseContext()},this.getMaxAnisotropy=function(){return gt.getMaxAnisotropy()},this.getPrecision=function(){return gt.precision},this.getPixelRatio=function(){return Q},this.setPixelRatio=function(t){void 0!==t&&(Q=t,this.setSize(X,$,!1))},this.getSize=function(){return{width:X,height:$}},this.setSize=function(t,e,n){var r=Ct.getDevice();r&&r.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(X=t,$=e,w.width=t*Q,w.height=e*Q,!1!==n&&(w.style.width=t+"px",w.style.height=e+"px"),this.setViewport(0,0,t,e))},this.getDrawingBufferSize=function(){return{width:X*Q,height:$*Q}},this.setDrawingBufferSize=function(t,e,n){X=t,$=e,Q=n,w.width=t*n,w.height=e*n,this.setViewport(0,0,t,e)},this.setViewport=function(t,e,n,r){et.set(t,$-e-r,n,r),vt.viewport(W.copy(et).multiplyScalar(Q))},this.setScissor=function(t,e,n,r){J.set(t,$-e-r,n,r),vt.scissor(B.copy(J).multiplyScalar(Q))},this.setScissorTest=function(t){vt.setScissorTest(tt=t)},this.getClearColor=kt.getClearColor,this.setClearColor=kt.setClearColor,this.getClearAlpha=kt.getClearAlpha,this.setClearAlpha=kt.setClearAlpha,this.clear=function(t,e,n){var r=0;(void 0===t||t)&&(r|=L.COLOR_BUFFER_BIT),(void 0===e||e)&&(r|=L.DEPTH_BUFFER_BIT),(void 0===n||n)&&(r|=L.STENCIL_BUFFER_BIT),L.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,n,r){this.setRenderTarget(t),this.clear(e,n,r)},this.resetGLState=n,this.dispose=function(){w.removeEventListener("webglcontextlost",r,!1),At.dispose()},this.renderBufferImmediate=function(t,e,n){vt.initAttributes();var r=yt.get(t);if(t.hasPositions&&!r.position&&(r.position=L.createBuffer()),t.hasNormals&&!r.normal&&(r.normal=L.createBuffer()),t.hasUvs&&!r.uv&&(r.uv=L.createBuffer()),t.hasColors&&!r.color&&(r.color=L.createBuffer()),e=e.getAttributes(),t.hasPositions&&(L.bindBuffer(L.ARRAY_BUFFER,r.position),L.bufferData(L.ARRAY_BUFFER,t.positionArray,L.DYNAMIC_DRAW),vt.enableAttribute(e.position),L.vertexAttribPointer(e.position,3,L.FLOAT,!1,0,0)),t.hasNormals){if(L.bindBuffer(L.ARRAY_BUFFER,r.normal),!n.isMeshPhongMaterial&&!n.isMeshStandardMaterial&&!n.isMeshNormalMaterial&&1===n.shading)for(var i=0,o=3*t.count;i<o;i+=9){var a=t.normalArray,s=(a[i+0]+a[i+3]+a[i+6])/3,u=(a[i+1]+a[i+4]+a[i+7])/3,c=(a[i+2]+a[i+5]+a[i+8])/3;a[i+0]=s,a[i+1]=u,a[i+2]=c,a[i+3]=s,a[i+4]=u,a[i+5]=c,a[i+6]=s,a[i+7]=u,a[i+8]=c}L.bufferData(L.ARRAY_BUFFER,t.normalArray,L.DYNAMIC_DRAW),vt.enableAttribute(e.normal),L.vertexAttribPointer(e.normal,3,L.FLOAT,!1,0,0)}t.hasUvs&&n.map&&(L.bindBuffer(L.ARRAY_BUFFER,r.uv),L.bufferData(L.ARRAY_BUFFER,t.uvArray,L.DYNAMIC_DRAW),vt.enableAttribute(e.uv),L.vertexAttribPointer(_t.uv,2,L.FLOAT,!1,0,0)),t.hasColors&&0!==n.vertexColors&&(L.bindBuffer(L.ARRAY_BUFFER,r.color),L.bufferData(L.ARRAY_BUFFER,t.colorArray,L.DYNAMIC_DRAW),vt.enableAttribute(e.color),L.vertexAttribPointer(e.color,3,L.FLOAT,!1,0,0)),vt.disableUnusedAttributes(),L.drawArrays(L.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,n,r,i,o){vt.setMaterial(r);var a,u=p(t,e,r,i),c=!1;if((t=n.id+"_"+u.id+"_"+(!0===r.wireframe))!==j&&(j=t,c=!0),void 0!==(e=i.morphTargetInfluences)){var l=[];t=0;for(var h=e.length;t<h;t++)l.push([c=e[t],t]);l.sort(s),8<l.length&&(l.length=8);var f=n.morphAttributes;for(t=0,h=l.length;t<h;t++)C[t]=(c=l[t])[0],0!==c[0]?(e=c[1],!0===r.morphTargets&&f.position&&n.addAttribute("morphTarget"+t,f.position[e]),!0===r.morphNormals&&f.normal&&n.addAttribute("morphNormal"+t,f.normal[e])):(!0===r.morphTargets&&n.removeAttribute("morphTarget"+t),!0===r.morphNormals&&n.removeAttribute("morphNormal"+t));for(t=l.length,e=C.length;t<e;t++)C[t]=0;u.getUniforms().setValue(L,"morphTargetInfluences",C),c=!0}if(e=n.index,h=n.attributes.position,l=1,!0===r.wireframe&&(e=Mt.getWireframeAttribute(n),l=2),t=Pt,null!==e&&(a=_t.get(e),(t=It).setIndex(a)),c){if(c=void 0,n&&n.isInstancedBufferGeometry&&null===pt.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{void 0===c&&(c=0),vt.initAttributes(),f=n.attributes,u=u.getAttributes();var d,m=r.defaultAttributeValues;for(d in u){var g=u[d];if(0<=g)if(void 0!==(E=f[d])){var v=E.normalized,y=E.itemSize,w=(x=_t.get(E)).buffer,b=x.type,x=x.bytesPerElement;if(E.isInterleavedBufferAttribute){var _=E.data,M=_.stride,E=E.offset;_&&_.isInstancedInterleavedBuffer?(vt.enableAttributeAndDivisor(g,_.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=_.meshPerAttribute*_.count)):vt.enableAttribute(g),L.bindBuffer(L.ARRAY_BUFFER,w),L.vertexAttribPointer(g,y,b,v,M*x,(c*M+E)*x)}else E.isInstancedBufferAttribute?(vt.enableAttributeAndDivisor(g,E.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=E.meshPerAttribute*E.count)):vt.enableAttribute(g),L.bindBuffer(L.ARRAY_BUFFER,w),L.vertexAttribPointer(g,y,b,v,0,c*y*x)}else if(void 0!==m&&void 0!==(v=m[d]))switch(v.length){case 2:L.vertexAttrib2fv(g,v);break;case 3:L.vertexAttrib3fv(g,v);break;case 4:L.vertexAttrib4fv(g,v);break;default:L.vertexAttrib1fv(g,v)}}vt.disableUnusedAttributes()}null!==e&&L.bindBuffer(L.ELEMENT_ARRAY_BUFFER,a.buffer)}if(a=0,null!==e?a=e.count:void 0!==h&&(a=h.count),e=n.drawRange.start*l,h=null!==o?o.start*l:0,d=Math.max(e,h),0!==(o=Math.max(0,Math.min(a,e+n.drawRange.count*l,h+(null!==o?o.count*l:1/0))-1-d+1))){if(i.isMesh)if(!0===r.wireframe)vt.setLineWidth(r.wireframeLinewidth*(null===I?Q:1)),t.setMode(L.LINES);else switch(i.drawMode){case 0:t.setMode(L.TRIANGLES);break;case 1:t.setMode(L.TRIANGLE_STRIP);break;case 2:t.setMode(L.TRIANGLE_FAN)}else i.isLine?(void 0===(r=r.linewidth)&&(r=1),vt.setLineWidth(r*(null===I?Q:1)),t.setMode(i.isLineSegments?L.LINES:i.isLineLoop?L.LINE_LOOP:L.LINE_STRIP)):i.isPoints&&t.setMode(L.POINTS);n&&n.isInstancedBufferGeometry?0<n.maxInstancedCount&&t.renderInstances(n,d,o):t.render(d,o)}},this.compile=function(t,e){A=[],t.traverse(function(t){t.isLight&&A.push(t)}),v(A,e),t.traverse(function(e){if(e.material)if(Array.isArray(e.material))for(var n=0;n<e.material.length;n++)d(e.material[n],t.fog,e);else d(e.material,t.fog,e)})},this.animate=function(t){(Ct.getDevice()||window).requestAnimationFrame(function e(){t(),(Ct.getDevice()||window).requestAnimationFrame(e)})},this.render=function(t,e,n,r){if(e&&e.isCamera){j="",F=-1,z=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),Ct.enabled&&(e=Ct.getCamera(e)),at.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),nt.setFromMatrix(at),A.length=0,R.length=0,D.length=0,it=rt.init(this.clippingPlanes,ot=this.localClippingEnabled,e),(k=At.get(t,e)).init(),function t(e,n,r){if(e.visible){if(e.layers.test(n.layers))if(e.isLight)A.push(e);else if(e.isSprite)e.frustumCulled&&!nt.intersectsSprite(e)||R.push(e);else if(e.isLensFlare)D.push(e);else if(e.isImmediateRenderObject)r&&st.setFromMatrixPosition(e.matrixWorld).applyMatrix4(at),k.push(e,null,e.material,st.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.update(),!e.frustumCulled||nt.intersectsObject(e))){r&&st.setFromMatrixPosition(e.matrixWorld).applyMatrix4(at);var i=Et.update(e),o=e.material;if(Array.isArray(o))for(var a=i.groups,s=0,u=a.length;s<u;s++){var c=a[s],l=o[c.materialIndex];l&&l.visible&&k.push(e,i,l,st.z,c)}else o.visible&&k.push(e,i,o,st.z,null)}for(s=0,u=(e=e.children).length;s<u;s++)t(e[s],n,r)}}(t,e,O.sortObjects),k.finish(),!0===O.sortObjects&&k.sort(),it&&rt.beginShadows();for(var i=A,o=0,a=0,s=i.length;a<s;a++){var u=i[a];u.castShadow&&(lt.shadows[o]=u,o++)}lt.shadows.length=o,Nt.render(t,e),v(A,e),it&&rt.endShadows(),ft.frame++,ft.calls=0,ft.vertices=0,ft.faces=0,ft.points=0,void 0===n&&(n=null),this.setRenderTarget(n),kt.render(t,e,r),r=k.opaque,i=k.transparent,t.overrideMaterial?(o=t.overrideMaterial,r.length&&h(r,t,e,o),i.length&&h(i,t,e,o)):(r.length&&h(r,t,e),i.length&&h(i,t,e)),Ft.render(t,e),jt.render(t,e,W),n&&xt.updateRenderTargetMipmap(n),vt.buffers.depth.setTest(!0),vt.buffers.depth.setMask(!0),vt.buffers.color.setMask(!0),e.isArrayCamera&&O.setScissorTest(!1),Ct.enabled&&Ct.submitFrame()}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFaceCulling=function(t,e){vt.setCullFace(t),vt.setFlipSided(0===e)},this.allocTextureUnit=function(){var t=Y;return t>=gt.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+t+" texture units while this GPU supports only "+gt.maxTextures),Y+=1,t},this.setTexture2D=function(){var t=!1;return function(e,n){e&&e.isWebGLRenderTarget&&(t||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),xt.setTexture2D(e,n)}}(),this.setTexture=function(){var t=!1;return function(e,n){t||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),t=!0),xt.setTexture2D(e,n)}}(),this.setTextureCube=function(){var t=!1;return function(e,n){e&&e.isWebGLRenderTargetCube&&(t||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?xt.setTextureCube(e,n):xt.setTextureCubeDynamic(e,n)}}(),this.getRenderTarget=function(){return I},this.setRenderTarget=function(t){(I=t)&&void 0===yt.get(t).__webglFramebuffer&&xt.setupRenderTarget(t);var e,n=t&&t.isWebGLRenderTargetCube;t?(e=yt.get(t),e=n?e.__webglFramebuffer[t.activeCubeFace]:e.__webglFramebuffer,B.copy(t.scissor),G=t.scissorTest,W.copy(t.viewport)):(e=null,B.copy(J).multiplyScalar(Q),G=tt,W.copy(et).multiplyScalar(Q)),N!==e&&(L.bindFramebuffer(L.FRAMEBUFFER,e),N=e),vt.scissor(B),vt.setScissorTest(G),vt.viewport(W),n&&(n=yt.get(t.texture),L.framebufferTexture2D(L.FRAMEBUFFER,L.COLOR_ATTACHMENT0,L.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,n.__webglTexture,t.activeMipMapLevel))},this.readRenderTargetPixels=function(t,e,n,r,i,o){if(t&&t.isWebGLRenderTarget){var a=yt.get(t).__webglFramebuffer;if(a){var s=!1;a!==N&&(L.bindFramebuffer(L.FRAMEBUFFER,a),s=!0);try{var u=t.texture,c=u.format,l=u.type;1023!==c&&y(c)!==L.getParameter(L.IMPLEMENTATION_COLOR_READ_FORMAT)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):1009===l||y(l)===L.getParameter(L.IMPLEMENTATION_COLOR_READ_TYPE)||1015===l&&(pt.get("OES_texture_float")||pt.get("WEBGL_color_buffer_float"))||1016===l&&pt.get("EXT_color_buffer_half_float")?L.checkFramebufferStatus(L.FRAMEBUFFER)===L.FRAMEBUFFER_COMPLETE?0<=e&&e<=t.width-r&&0<=n&&n<=t.height-i&&L.readPixels(e,n,r,i,y(c),y(l),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{s&&L.bindFramebuffer(L.FRAMEBUFFER,N)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")}}function Wt(t,e){this.name="",this.color=new V(t),this.density=void 0!==e?e:25e-5}function Yt(t,e,n){this.name="",this.color=new V(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}function Xt(){nt.call(this),this.type="Scene",this.overrideMaterial=this.fog=this.background=null,this.autoUpdate=!0}function $t(t,e,n,r,i){nt.call(this),this.lensFlares=[],this.positionScreen=new u,this.customUpdateCallback=void 0,void 0!==t&&this.add(t,e,n,r,i)}function Qt(t){G.call(this),this.type="SpriteMaterial",this.color=new V(16777215),this.map=null,this.rotation=0,this.lights=this.fog=!1,this.setValues(t)}function Jt(t){nt.call(this),this.type="Sprite",this.material=void 0!==t?t:new Qt}function Zt(){nt.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function Kt(t,e){if(this.bones=(t=t||[]).slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new c)}}function te(){nt.call(this),this.type="Bone"}function ee(t,e){Ct.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new c,this.bindMatrixInverse=new c;var n=new Kt(n=this.initBones());this.bind(n,this.matrixWorld),this.normalizeSkinWeights()}function ne(t){G.call(this),this.type="LineBasicMaterial",this.color=new V(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.lights=!1,this.setValues(t)}function re(t,e,n){if(1===n)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new ie(t,e);nt.call(this),this.type="Line",this.geometry=void 0!==t?t:new bt,this.material=void 0!==e?e:new ne({color:16777215*Math.random()})}function ie(t,e){re.call(this,t,e),this.type="LineSegments"}function oe(t,e){re.call(this,t,e),this.type="LineLoop"}function ae(t){G.call(this),this.type="PointsMaterial",this.color=new V(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(t)}function se(t,e){nt.call(this),this.type="Points",this.geometry=void 0!==t?t:new bt,this.material=void 0!==e?e:new ae({color:16777215*Math.random()})}function ue(){nt.call(this),this.type="Group"}function ce(t,e,n,i,o,a,s,u,c){r.call(this,t,e,n,i,o,a,s,u,c),this.generateMipmaps=!1;var l=this;!function e(){requestAnimationFrame(e),t.readyState>=t.HAVE_CURRENT_DATA&&(l.needsUpdate=!0)}()}function le(t,e,n,i,o,a,s,u,c,l,h,f){r.call(this,null,a,s,u,c,l,i,o,h,f),this.image={width:e,height:n},this.mipmaps=t,this.generateMipmaps=this.flipY=!1}function he(t,e,n,i,o,a,s,u,c){r.call(this,t,e,n,i,o,a,s,u,c),this.needsUpdate=!0}function fe(t,e,n,i,o,a,s,u,c,l){if(1026!==(l=void 0!==l?l:1026)&&1027!==l)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&1026===l&&(n=1012),void 0===n&&1027===l&&(n=1020),r.call(this,null,i,o,a,s,u,l,n,c),this.image={width:t,height:e},this.magFilter=void 0!==s?s:1003,this.minFilter=void 0!==u?u:1003,this.generateMipmaps=this.flipY=!1}function de(t){bt.call(this),this.type="WireframeGeometry";var e,n,r,i,o,a,s=[],c=[0,0],l={},h=["a","b","c"];if(t&&t.isGeometry){var f=t.faces;for(e=0,r=f.length;e<r;e++){var d=f[e];for(n=0;3>n;n++)o=d[h[n]],a=d[h[(n+1)%3]],c[0]=Math.min(o,a),c[1]=Math.max(o,a),void 0===l[o=c[0]+","+c[1]]&&(l[o]={index1:c[0],index2:c[1]})}for(o in l)s.push((h=t.vertices[(e=l[o]).index1]).x,h.y,h.z),s.push((h=t.vertices[e.index2]).x,h.y,h.z)}else if(t&&t.isBufferGeometry){var p;if(h=new u,null!==t.index){for(f=t.attributes.position,d=t.index,0===(p=t.groups).length&&(p=[{start:0,count:d.count,materialIndex:0}]),t=0,i=p.length;t<i;++t)for(r=(e=p[t]).count,e=n=e.start,r=n+r;e<r;e+=3)for(n=0;3>n;n++)o=d.getX(e+n),a=d.getX(e+(n+1)%3),c[0]=Math.min(o,a),c[1]=Math.max(o,a),void 0===l[o=c[0]+","+c[1]]&&(l[o]={index1:c[0],index2:c[1]});for(o in l)h.fromBufferAttribute(f,(e=l[o]).index1),s.push(h.x,h.y,h.z),h.fromBufferAttribute(f,e.index2),s.push(h.x,h.y,h.z)}else for(e=0,r=(f=t.attributes.position).count/3;e<r;e++)for(n=0;3>n;n++)h.fromBufferAttribute(f,l=3*e+n),s.push(h.x,h.y,h.z),h.fromBufferAttribute(f,l=3*e+(n+1)%3),s.push(h.x,h.y,h.z)}this.addAttribute("position",new gt(s,3))}function pe(t,e,n){st.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n},this.fromBufferGeometry(new me(t,e,n)),this.mergeVertices()}function me(t,e,n){bt.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:n};var r,i,o=[],a=[],s=[],c=[],l=new u,h=new u,f=new u,d=new u,p=new u,m=e+1;for(r=0;r<=n;r++){var g=r/n;for(i=0;i<=e;i++){var v=i/e;h=t(v,g,h),a.push(h.x,h.y,h.z),0<=v-1e-5?(f=t(v-1e-5,g,f),d.subVectors(h,f)):(f=t(v+1e-5,g,f),d.subVectors(f,h)),0<=g-1e-5?(f=t(v,g-1e-5,f),p.subVectors(h,f)):(f=t(v,g+1e-5,f),p.subVectors(f,h)),l.crossVectors(d,p).normalize(),s.push(l.x,l.y,l.z),c.push(v,g)}}for(r=0;r<n;r++)for(i=0;i<e;i++)l=(r+1)*m+i+1,o.push(r*m+i,t=r*m+i+1,h=(r+1)*m+i),o.push(t,l,h);this.setIndex(o),this.addAttribute("position",new gt(a,3)),this.addAttribute("normal",new gt(s,3)),this.addAttribute("uv",new gt(c,2))}function ge(t,e,n,r){st.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},this.fromBufferGeometry(new ve(t,e,n,r)),this.mergeVertices()}function ve(t,e,r,i){function o(t){c.push(t.x,t.y,t.z)}function a(e,n){var r=3*e;n.x=t[r+0],n.y=t[r+1],n.z=t[r+2]}function s(t,e,n,r){0>r&&1===t.x&&(l[e]=t.x-1),0===n.x&&0===n.z&&(l[e]=r/2/Math.PI+.5)}bt.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:r,detail:i},r=r||1;var c=[],l=[];!function(t){for(var n=new u,r=new u,i=new u,s=0;s<e.length;s+=3){a(e[s+0],n),a(e[s+1],r),a(e[s+2],i);var c,l,h=n,f=r,d=i,p=Math.pow(2,t),m=[];for(c=0;c<=p;c++){m[c]=[];var g=h.clone().lerp(d,c/p),v=f.clone().lerp(d,c/p),y=p-c;for(l=0;l<=y;l++)m[c][l]=0===l&&c===p?g:g.clone().lerp(v,l/y)}for(c=0;c<p;c++)for(l=0;l<2*(p-c)-1;l++)h=Math.floor(l/2),0==l%2?(o(m[c][h+1]),o(m[c+1][h]),o(m[c][h])):(o(m[c][h+1]),o(m[c+1][h+1]),o(m[c+1][h]))}}(i=i||0),function(t){for(var e=new u,n=0;n<c.length;n+=3)e.x=c[n+0],e.y=c[n+1],e.z=c[n+2],e.normalize().multiplyScalar(t),c[n+0]=e.x,c[n+1]=e.y,c[n+2]=e.z}(r),function(){for(var t=new u,e=0;e<c.length;e+=3)t.x=c[e+0],t.y=c[e+1],t.z=c[e+2],l.push(Math.atan2(t.z,-t.x)/2/Math.PI+.5,1-(Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5));t=new u,e=new u;for(var r=new u,i=new u,o=new n,a=new n,h=new n,f=0,d=0;f<c.length;f+=9,d+=6){t.set(c[f+0],c[f+1],c[f+2]),e.set(c[f+3],c[f+4],c[f+5]),r.set(c[f+6],c[f+7],c[f+8]),o.set(l[d+0],l[d+1]),a.set(l[d+2],l[d+3]),h.set(l[d+4],l[d+5]),i.copy(t).add(e).add(r).divideScalar(3);var p=Math.atan2(i.z,-i.x);s(o,d+0,t,p),s(a,d+2,e,p),s(h,d+4,r,p)}for(t=0;t<l.length;t+=6)e=l[t+0],r=l[t+2],i=l[t+4],o=Math.min(e,r,i),.9<Math.max(e,r,i)&&.1>o&&(.2>e&&(l[t+0]+=1),.2>r&&(l[t+2]+=1),.2>i&&(l[t+4]+=1))}(),this.addAttribute("position",new gt(c,3)),this.addAttribute("normal",new gt(c.slice(),3)),this.addAttribute("uv",new gt(l,2)),0===i?this.computeVertexNormals():this.normalizeNormals()}function ye(t,e){st.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new we(t,e)),this.mergeVertices()}function we(t,e){ve.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function be(t,e){st.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new xe(t,e)),this.mergeVertices()}function xe(t,e){ve.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function _e(t,e){st.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Me(t,e)),this.mergeVertices()}function Me(t,e){var n=(1+Math.sqrt(5))/2;ve.call(this,[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Ee(t,e){st.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Se(t,e)),this.mergeVertices()}function Se(t,e){var n=(1+Math.sqrt(5))/2,r=1/n;ve.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Te(t,e,n,r,i,o){st.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed."),t=new Ae(t,e,n,r,i),this.tangents=t.tangents,this.normals=t.normals,this.binormals=t.binormals,this.fromBufferGeometry(t),this.mergeVertices()}function Ae(t,e,r,i,o){function a(n){var o=t.getPointAt(n/e),a=s.normals[n];for(n=s.binormals[n],l=0;l<=i;l++){var u=l/i*Math.PI*2,c=Math.sin(u);u=-Math.cos(u),f.x=u*a.x+c*n.x,f.y=u*a.y+c*n.y,f.z=u*a.z+c*n.z,f.normalize(),m.push(f.x,f.y,f.z),h.x=o.x+r*f.x,h.y=o.y+r*f.y,h.z=o.z+r*f.z,p.push(h.x,h.y,h.z)}}bt.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:r,radialSegments:i,closed:o},e=e||64,r=r||1,i=i||8;var s=t.computeFrenetFrames(e,o=o||!1);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;var c,l,h=new u,f=new u,d=new n,p=[],m=[],g=[],v=[];for(c=0;c<e;c++)a(c);for(a(!1===o?e:0),c=0;c<=e;c++)for(l=0;l<=i;l++)d.x=c/e,d.y=l/i,g.push(d.x,d.y);!function(){for(l=1;l<=e;l++)for(c=1;c<=i;c++){var t=(i+1)*l+(c-1),n=(i+1)*l+c,r=(i+1)*(l-1)+c;v.push((i+1)*(l-1)+(c-1),t,r),v.push(t,n,r)}}(),this.setIndex(v),this.addAttribute("position",new gt(p,3)),this.addAttribute("normal",new gt(m,3)),this.addAttribute("uv",new gt(g,2))}function ke(t,e,n,r,i,o,a){st.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Ce(t,e,n,r,i,o)),this.mergeVertices()}function Ce(t,e,n,r,i,o){function a(t,e,n,r,i){var o=Math.sin(t);e=n/e*t,n=Math.cos(e),i.x=r*(2+n)*.5*Math.cos(t),i.y=r*(2+n)*o*.5,i.z=r*Math.sin(e)*.5}bt.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},t=t||100,e=e||40,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,o=o||3;var s,c,l=[],h=[],f=[],d=[],p=new u,m=new u,g=new u,v=new u,y=new u,w=new u,b=new u;for(s=0;s<=n;++s)for(a(c=s/n*i*Math.PI*2,i,o,t,g),a(c+.01,i,o,t,v),w.subVectors(v,g),b.addVectors(v,g),y.crossVectors(w,b),b.crossVectors(y,w),y.normalize(),b.normalize(),c=0;c<=r;++c){var x=c/r*Math.PI*2,_=-e*Math.cos(x);x=e*Math.sin(x),p.x=g.x+(_*b.x+x*y.x),p.y=g.y+(_*b.y+x*y.y),p.z=g.z+(_*b.z+x*y.z),h.push(p.x,p.y,p.z),m.subVectors(p,g).normalize(),f.push(m.x,m.y,m.z),d.push(s/n),d.push(c/r)}for(c=1;c<=n;c++)for(s=1;s<=r;s++)e=(r+1)*c+s,l.push((r+1)*(c-1)+(s-1),t=(r+1)*c+(s-1),i=(r+1)*(c-1)+s),l.push(t,e,i);this.setIndex(l),this.addAttribute("position",new gt(h,3)),this.addAttribute("normal",new gt(f,3)),this.addAttribute("uv",new gt(d,2))}function Re(t,e,n,r,i){st.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new De(t,e,n,r,i)),this.mergeVertices()}function De(t,e,n,r,i){bt.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},t=t||100,e=e||40,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;var o,a,s=[],c=[],l=[],h=[],f=new u,d=new u,p=new u;for(o=0;o<=n;o++)for(a=0;a<=r;a++){var m=a/r*i,g=o/n*Math.PI*2;d.x=(t+e*Math.cos(g))*Math.cos(m),d.y=(t+e*Math.cos(g))*Math.sin(m),d.z=e*Math.sin(g),c.push(d.x,d.y,d.z),f.x=t*Math.cos(m),f.y=t*Math.sin(m),p.subVectors(d,f).normalize(),l.push(p.x,p.y,p.z),h.push(a/r),h.push(o/n)}for(o=1;o<=n;o++)for(a=1;a<=r;a++)e=(r+1)*(o-1)+a,s.push((r+1)*o+a-1,t=(r+1)*(o-1)+a-1,i=(r+1)*o+a),s.push(t,e,i);this.setIndex(s),this.addAttribute("position",new gt(c,3)),this.addAttribute("normal",new gt(l,3)),this.addAttribute("uv",new gt(h,2))}function Le(t,e){st.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new Oe(t,e)),this.mergeVertices()}function Oe(t,e){"undefined"!=typeof t&&(bt.call(this),this.type="ExtrudeBufferGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,e),this.computeVertexNormals())}function Pe(t,e){st.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new Ie(t,e)),this.mergeVertices()}function Ie(t,e){var n=(e=e||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new st;n=n.generateShapes(t,e.size,e.curveSegments),e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),Oe.call(this,n,e),this.type="TextBufferGeometry"}function Ne(t,e,n,r,i,o,a){st.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new Fe(t,e,n,r,i,o,a)),this.mergeVertices()}function Fe(t,e,n,r,i,o,a){bt.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},t=t||50,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI;var s,c,l=(o=void 0!==o?o:0)+(a=void 0!==a?a:Math.PI),h=0,f=[],d=new u,p=new u,m=[],g=[],v=[],y=[];for(c=0;c<=n;c++){var w=[],b=c/n;for(s=0;s<=e;s++){var x=s/e;d.x=-t*Math.cos(r+x*i)*Math.sin(o+b*a),d.y=t*Math.cos(o+b*a),d.z=t*Math.sin(r+x*i)*Math.sin(o+b*a),g.push(d.x,d.y,d.z),p.set(d.x,d.y,d.z).normalize(),v.push(p.x,p.y,p.z),y.push(x,1-b),w.push(h++)}f.push(w)}for(c=0;c<n;c++)for(s=0;s<e;s++)t=f[c][s+1],r=f[c][s],i=f[c+1][s],a=f[c+1][s+1],(0!==c||0<o)&&m.push(t,r,a),(c!==n-1||l<Math.PI)&&m.push(r,i,a);this.setIndex(m),this.addAttribute("position",new gt(g,3)),this.addAttribute("normal",new gt(v,3)),this.addAttribute("uv",new gt(y,2))}function je(t,e,n,r,i,o){st.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new ze(t,e,n,r,i,o)),this.mergeVertices()}function ze(t,e,r,i,o,a){bt.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:r,phiSegments:i,thetaStart:o,thetaLength:a},t=t||20,e=e||50,o=void 0!==o?o:0,a=void 0!==a?a:2*Math.PI,r=void 0!==r?Math.max(3,r):8;var s,c,l=[],h=[],f=[],d=[],p=t,m=(e-t)/(i=void 0!==i?Math.max(1,i):1),g=new u,v=new n;for(s=0;s<=i;s++){for(c=0;c<=r;c++)t=o+c/r*a,g.x=p*Math.cos(t),g.y=p*Math.sin(t),h.push(g.x,g.y,g.z),f.push(0,0,1),v.x=(g.x/e+1)/2,v.y=(g.y/e+1)/2,d.push(v.x,v.y);p+=m}for(s=0;s<i;s++)for(e=s*(r+1),c=0;c<r;c++)a=(t=c+e)+r+2,l.push(t,o=t+r+1,p=t+1),l.push(o,a,p);this.setIndex(l),this.addAttribute("position",new gt(h,3)),this.addAttribute("normal",new gt(f,3)),this.addAttribute("uv",new gt(d,2))}function Ue(t,e,n,r){st.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},this.fromBufferGeometry(new Ve(t,e,n,r)),this.mergeVertices()}function Ve(t,e,r,i){bt.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:r,phiLength:i},e=Math.floor(e)||12,r=r||0,i=i||2*Math.PI,i=ii.clamp(i,0,2*Math.PI);var o,a,s=[],c=[],l=[],h=1/e,f=new u,d=new n;for(o=0;o<=e;o++){a=r+o*h*i;var p=Math.sin(a),m=Math.cos(a);for(a=0;a<=t.length-1;a++)f.x=t[a].x*p,f.y=t[a].y,f.z=t[a].x*m,c.push(f.x,f.y,f.z),d.x=o/e,d.y=a/(t.length-1),l.push(d.x,d.y)}for(o=0;o<e;o++)for(a=0;a<t.length-1;a++)f=(r=a+o*t.length)+t.length+1,s.push(r,h=r+t.length,d=r+1),s.push(h,f,d);if(this.setIndex(s),this.addAttribute("position",new gt(c,3)),this.addAttribute("uv",new gt(l,2)),this.computeVertexNormals(),i===2*Math.PI)for(i=this.attributes.normal.array,s=new u,c=new u,l=new u,r=e*t.length*3,a=o=0;o<t.length;o++,a+=3)s.x=i[a+0],s.y=i[a+1],s.z=i[a+2],c.x=i[r+a+0],c.y=i[r+a+1],c.z=i[r+a+2],l.addVectors(s,c).normalize(),i[a+0]=i[r+a+0]=l.x,i[a+1]=i[r+a+1]=l.y,i[a+2]=i[r+a+2]=l.z}function Be(t,e){st.call(this),this.type="ShapeGeometry","object"==typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new He(t,e)),this.mergeVertices()}function He(t,e){function n(t){var n,s,c=i.length/3,l=(t=t.extractPoints(e)).shape,h=t.holes;if(!1===_i.isClockWise(l))for(l=l.reverse(),t=0,n=h.length;t<n;t++)!0===_i.isClockWise(s=h[t])&&(h[t]=s.reverse());var f=_i.triangulateShape(l,h);for(t=0,n=h.length;t<n;t++)l=l.concat(s=h[t]);for(t=0,n=l.length;t<n;t++)i.push((s=l[t]).x,s.y,0),o.push(0,0,1),a.push(s.x,s.y);for(t=0,n=f.length;t<n;t++)r.push((l=f[t])[0]+c,l[1]+c,l[2]+c),u+=3}bt.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var r=[],i=[],o=[],a=[],s=0,u=0;if(!1===Array.isArray(t))n(t);else for(var c=0;c<t.length;c++)n(t[c]),this.addGroup(s,u,c),s+=u,u=0;this.setIndex(r),this.addAttribute("position",new gt(i,3)),this.addAttribute("normal",new gt(o,3)),this.addAttribute("uv",new gt(a,2))}function qe(t,e){bt.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e};var n,r,i,o=[],a=Math.cos(ii.DEG2RAD*(void 0!==e?e:1)),s=[0,0],u={},c=["a","b","c"];t.isBufferGeometry?(i=new st).fromBufferGeometry(t):i=t.clone(),i.mergeVertices(),i.computeFaceNormals();for(var l=i.vertices,h=0,f=(i=i.faces).length;h<f;h++)for(var d=i[h],p=0;3>p;p++)n=d[c[p]],r=d[c[(p+1)%3]],s[0]=Math.min(n,r),s[1]=Math.max(n,r),void 0===u[n=s[0]+","+s[1]]?u[n]={index1:s[0],index2:s[1],face1:h,face2:void 0}:u[n].face2=h;for(n in u)(void 0===(s=u[n]).face2||i[s.face1].normal.dot(i[s.face2].normal)<=a)&&(o.push((c=l[s.index1]).x,c.y,c.z),o.push((c=l[s.index2]).x,c.y,c.z));this.addAttribute("position",new gt(o,3))}function Ge(t,e,n,r,i,o,a,s){st.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new We(t,e,n,r,i,o,a,s)),this.mergeVertices()}function We(t,e,r,i,o,a,s,c){function l(r){var o,a,l,v=new n,b=new u,x=0,_=!0===r?t:e,M=!0===r?1:-1;for(a=g,o=1;o<=i;o++)d.push(0,y*M,0),p.push(0,M,0),m.push(.5,.5),g++;for(l=g,o=0;o<=i;o++){var E=o/i*c+s,S=Math.cos(E);E=Math.sin(E),b.x=_*E,b.y=y*M,b.z=_*S,d.push(b.x,b.y,b.z),p.push(0,M,0),v.x=.5*S+.5,v.y=.5*E*M+.5,m.push(v.x,v.y),g++}for(o=0;o<i;o++)v=a+o,b=l+o,!0===r?f.push(b,b+1,v):f.push(b+1,b,v),x+=3;h.addGroup(w,x,!0===r?1:2),w+=x}bt.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:r,radialSegments:i,heightSegments:o,openEnded:a,thetaStart:s,thetaLength:c};var h=this;t=void 0!==t?t:20,e=void 0!==e?e:20,r=void 0!==r?r:100,i=Math.floor(i)||8,o=Math.floor(o)||1,a=void 0!==a&&a,s=void 0!==s?s:0,c=void 0!==c?c:2*Math.PI;var f=[],d=[],p=[],m=[],g=0,v=[],y=r/2,w=0;!function(){var n,a,l=new u,b=new u,x=0,_=(e-t)/r;for(a=0;a<=o;a++){var M=[],E=a/o,S=E*(e-t)+t;for(n=0;n<=i;n++){var T=n/i,A=T*c+s,k=Math.sin(A);A=Math.cos(A),b.x=S*k,b.y=-E*r+y,b.z=S*A,d.push(b.x,b.y,b.z),l.set(k,_,A).normalize(),p.push(l.x,l.y,l.z),m.push(T,1-E),M.push(g++)}v.push(M)}for(n=0;n<i;n++)for(a=0;a<o;a++)b=v[a+1][n+1],f.push(v[a][n],l=v[a+1][n],_=v[a][n+1]),f.push(l,b,_),x+=6;h.addGroup(w,x,0),w+=x}(),!1===a&&(0<t&&l(!0),0<e&&l(!1)),this.setIndex(f),this.addAttribute("position",new gt(d,3)),this.addAttribute("normal",new gt(p,3)),this.addAttribute("uv",new gt(m,2))}function Ye(t,e,n,r,i,o,a){Ge.call(this,0,t,e,n,r,i,o,a),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function Xe(t,e,n,r,i,o,a){We.call(this,0,t,e,n,r,i,o,a),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function $e(t,e,n,r){st.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new Qe(t,e,n,r)),this.mergeVertices()}function Qe(t,e,r,i){bt.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:r,thetaLength:i},t=t||50,e=void 0!==e?Math.max(3,e):8,r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI;var o,a,s=[],c=[],l=[],h=[],f=new u,d=new n;for(c.push(0,0,0),l.push(0,0,1),h.push(.5,.5),a=0,o=3;a<=e;a++,o+=3){var p=r+a/e*i;f.x=t*Math.cos(p),f.y=t*Math.sin(p),c.push(f.x,f.y,f.z),l.push(0,0,1),d.x=(c[o]/t+1)/2,d.y=(c[o+1]/t+1)/2,h.push(d.x,d.y)}for(o=1;o<=e;o++)s.push(o,o+1,0);this.setIndex(s),this.addAttribute("position",new gt(c,3)),this.addAttribute("normal",new gt(l,3)),this.addAttribute("uv",new gt(h,2))}function Je(t){W.call(this,{uniforms:mi.merge([pi.lights,{opacity:{value:1}}]),vertexShader:gi.shadow_vert,fragmentShader:gi.shadow_frag}),this.transparent=this.lights=!0,Object.defineProperties(this,{opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}}}),this.setValues(t)}function Ze(t){W.call(this,t),this.type="RawShaderMaterial"}function Ke(t){G.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new V(16777215),this.metalness=this.roughness=.5,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new V(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new n(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function tn(t){Ke.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoatRoughness=this.clearCoat=0,this.setValues(t)}function en(t){G.call(this),this.type="MeshPhongMaterial",this.color=new V(16777215),this.specular=new V(1118481),this.shininess=30,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new V(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new n(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function nn(t){en.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(t)}function rn(t){G.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new n(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.lights=this.fog=!1,this.setValues(t)}function on(t){G.call(this),this.type="MeshLambertMaterial",this.color=new V(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new V(0),this.emissiveIntensity=1,this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function an(t){G.call(this),this.type="LineDashedMaterial",this.color=new V(16777215),this.scale=this.linewidth=1,this.dashSize=3,this.gapSize=1,this.lights=!1,this.setValues(t)}function sn(t,e,n){var r=this,i=!1,o=0,a=0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===i&&void 0!==r.onStart&&r.onStart(t,o,a),i=!0},this.itemEnd=function(t){o++,void 0!==r.onProgress&&r.onProgress(t,o,a),o===a&&(i=!1,void 0!==r.onLoad)&&r.onLoad()},this.itemError=function(t){void 0!==r.onError&&r.onError(t)}}function un(t){this.manager=void 0!==t?t:Ti}function cn(t){this.manager=void 0!==t?t:Ti,this._parser=null}function ln(t){this.manager=void 0!==t?t:Ti,this._parser=null}function hn(t){this.manager=void 0!==t?t:Ti}function fn(t){this.manager=void 0!==t?t:Ti}function dn(t){this.manager=void 0!==t?t:Ti}function pn(t,e){nt.call(this),this.type="Light",this.color=new V(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function mn(t,e,n){pn.call(this,t,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(nt.DefaultUp),this.updateMatrix(),this.groundColor=new V(e)}function gn(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new n(512,512),this.map=null,this.matrix=new c}function vn(){gn.call(this,new ot(50,1,.5,500))}function yn(t,e,n,r,i,o){pn.call(this,t,e),this.type="SpotLight",this.position.copy(nt.DefaultUp),this.updateMatrix(),this.target=new nt,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new vn}function wn(t,e,n,r){pn.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new gn(new ot(90,1,.5,500))}function bn(){gn.call(this,new it(-5,5,5,-5,.5,500))}function xn(t,e){pn.call(this,t,e),this.type="DirectionalLight",this.position.copy(nt.DefaultUp),this.updateMatrix(),this.target=new nt,this.shadow=new bn}function _n(t,e){pn.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function Mn(t,e,n,r){pn.call(this,t,e),this.type="RectAreaLight",this.position.set(0,1,0),this.updateMatrix(),this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}function En(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function Sn(t,e,n,r){En.call(this,t,e,n,r),this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function Tn(t,e,n,r){En.call(this,t,e,n,r)}function An(t,e,n,r){En.call(this,t,e,n,r)}function kn(t,e,n,r){if(void 0===t)throw Error("track name is undefined");if(void 0===e||0===e.length)throw Error("no keyframes in track named "+t);this.name=t,this.times=ki.convertArray(e,this.TimeBufferType),this.values=ki.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation),this.validate(),this.optimize()}function Cn(t,e,n,r){kn.call(this,t,e,n,r)}function Rn(t,e,n,r){En.call(this,t,e,n,r)}function Dn(t,e,n,r){kn.call(this,t,e,n,r)}function Ln(t,e,n,r){kn.call(this,t,e,n,r)}function On(t,e,n,r){kn.call(this,t,e,n,r)}function Pn(t,e,n){kn.call(this,t,e,n)}function In(t,e,n,r){kn.call(this,t,e,n,r)}function Nn(t,e,n,r){kn.apply(this,arguments)}function Fn(t,e,n){this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,this.uuid=ii.generateUUID(),0>this.duration&&this.resetDuration(),this.optimize()}function jn(t){this.manager=void 0!==t?t:Ti,this.textures={}}function zn(t){this.manager=void 0!==t?t:Ti}function Un(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}function Vn(t){"boolean"==typeof t&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),t=void 0),this.manager=void 0!==t?t:Ti,this.withCredentials=!1}function Bn(t){this.manager=void 0!==t?t:Ti,this.texturePath=""}function Hn(t,e,n,r,i){var o=t*t;return(2*n-2*r+(e=.5*(r-e))+(i=.5*(i-n)))*t*o+(-3*n+3*r-2*e-i)*o+e*t+n}function qn(t,e,n,r){var i=1-t;return i*i*e+2*(1-t)*t*n+t*t*r}function Gn(t,e,n,r,i){var o=1-t,a=1-t;return o*o*o*e+3*a*a*t*n+3*(1-t)*t*t*r+t*t*t*i}function Wn(){this.arcLengthDivisions=200}function Yn(t,e){this.arcLengthDivisions=200,this.v1=t,this.v2=e}function Xn(){this.arcLengthDivisions=200,this.curves=[],this.autoClose=!1}function $n(t,e,n,r,i,o,a,s){this.arcLengthDivisions=200,this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=r,this.aStartAngle=i,this.aEndAngle=o,this.aClockwise=a,this.aRotation=s||0}function Qn(t){this.arcLengthDivisions=200,this.points=void 0===t?[]:t}function Jn(t,e,n,r){this.arcLengthDivisions=200,this.v0=t,this.v1=e,this.v2=n,this.v3=r}function Zn(t,e,n){this.arcLengthDivisions=200,this.v0=t,this.v1=e,this.v2=n}function Kn(t){Xn.call(this),this.currentPoint=new n,t&&this.fromPoints(t)}function tr(){Kn.apply(this,arguments),this.holes=[]}function er(){this.subPaths=[],this.currentPath=null}function nr(t){this.data=t}function rr(t){this.manager=void 0!==t?t:Ti}function ir(t){this.manager=void 0!==t?t:Ti}function or(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ot,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ot,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function ar(t,e,n){nt.call(this),this.type="CubeCamera";var r=new ot(90,1,t,e);r.up.set(0,-1,0),r.lookAt(new u(1,0,0)),this.add(r);var i=new ot(90,1,t,e);i.up.set(0,-1,0),i.lookAt(new u(-1,0,0)),this.add(i);var o=new ot(90,1,t,e);o.up.set(0,0,1),o.lookAt(new u(0,1,0)),this.add(o);var s=new ot(90,1,t,e);s.up.set(0,0,-1),s.lookAt(new u(0,-1,0)),this.add(s);var c=new ot(90,1,t,e);c.up.set(0,-1,0),c.lookAt(new u(0,0,1)),this.add(c);var l=new ot(90,1,t,e);l.up.set(0,-1,0),l.lookAt(new u(0,0,-1)),this.add(l),this.renderTarget=new a(n,n,{format:1022,magFilter:1006,minFilter:1006}),this.renderTarget.texture.name="CubeCamera",this.updateCubeMap=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,a=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,n.activeCubeFace=0,t.render(e,r,n),n.activeCubeFace=1,t.render(e,i,n),n.activeCubeFace=2,t.render(e,o,n),n.activeCubeFace=3,t.render(e,s,n),n.activeCubeFace=4,t.render(e,c,n),n.texture.generateMipmaps=a,n.activeCubeFace=5,t.render(e,l,n),t.setRenderTarget(null)}}function sr(){nt.call(this),this.type="AudioListener",this.context=Fi.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function ur(t){nt.call(this),this.type="Audio",this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function cr(t){ur.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function lr(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function hr(t,e,n){switch(this.binding=t,this.valueSize=n,t=Float64Array,e){case"quaternion":e=this._slerp;break;case"string":case"bool":t=Array,e=this._select;break;default:e=this._lerp}this.buffer=new t(4*n),this._mixBufferRegion=e,this.referenceCount=this.useCount=this.cumulativeWeight=0}function fr(t,e,n){n=n||dr.parseTrackName(e),this._targetGroup=t,this._bindings=t.subscribe_(e,n)}function dr(t,e,n){this.path=e,this.parsedPath=n||dr.parseTrackName(e),this.node=dr.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function pr(t){this.uuid=ii.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}function mr(t,e,n){this._mixer=t,this._clip=e,this._localRoot=n||null,e=(t=e.tracks).length,n=Array(e);for(var r={endingStart:2400,endingEnd:2400},i=0;i!==e;++i){var o=t[i].createInterpolant(null);n[i]=o,o.settings=r}this._interpolantSettings=r,this._interpolants=n,this._propertyBindings=Array(e),this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function gr(t){this._root=t,this._initMemoryManager(),this.time=this._accuIndex=0,this.timeScale=1}function vr(t,e){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=e),this.value=t}function yr(){bt.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function wr(t,e,n,r){this.uuid=ii.generateUUID(),this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===r}function br(t,e){this.uuid=ii.generateUUID(),this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function xr(t,e,n){br.call(this,t,e),this.meshPerAttribute=n||1}function _r(t,e,n){ut.call(this,t,e),this.meshPerAttribute=n||1}function Mr(t,e,n,r){this.ray=new Tt(t,e),this.near=n||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Er(t,e){return t.distance-e.distance}function Sr(t,e,n,r){if(!1!==t.visible&&(t.raycast(e,n),!0===r)){r=0;for(var i=(t=t.children).length;r<i;r++)Sr(t[r],e,n,!0)}}function Tr(t){this.autoStart=void 0===t||t,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1}function Ar(t,e,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==n?n:0,this}function kr(t,e,n){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==n?n:0,this}function Cr(t,e){Ct.call(this,t,e),this.animationsMap={},this.animationsList=[];var n=this.geometry.morphTargets.length;this.createAnimation("__default",0,n-1,n/1),this.setAnimationWeight("__default",1)}function Rr(t){nt.call(this),this.material=t,this.render=function(t){}}function Dr(t,e,n,r){this.object=t,this.size=void 0!==e?e:1,t=void 0!==n?n:16711680,r=void 0!==r?r:1,e=0,(n=this.object.geometry)&&n.isGeometry?e=3*n.faces.length:n&&n.isBufferGeometry&&(e=n.attributes.normal.count),n=new bt,e=new gt(6*e,3),n.addAttribute("position",e),ie.call(this,n,new ne({color:t,linewidth:r})),this.matrixAutoUpdate=!1,this.update()}function Lr(t){nt.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,t=new bt;for(var e=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],n=0,r=1;32>n;n++,r++){var i=n/32*Math.PI*2,o=r/32*Math.PI*2;e.push(Math.cos(i),Math.sin(i),1,Math.cos(o),Math.sin(o),1)}t.addAttribute("position",new gt(e,3)),e=new ne({fog:!1}),this.cone=new ie(t,e),this.add(this.cone),this.update()}function Or(t){for(var e=function t(e){var n=[];e&&e.isBone&&n.push(e);for(var r=0;r<e.children.length;r++)n.push.apply(n,t(e.children[r]));return n}(t),n=new bt,r=[],i=[],o=new V(0,0,1),a=new V(0,1,0),s=0;s<e.length;s++){var u=e[s];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}n.addAttribute("position",new gt(r,3)),n.addAttribute("color",new gt(i,3)),r=new ne({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0}),ie.call(this,n,r),this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.onBeforeRender()}function Pr(t,e){this.light=t,this.light.updateMatrixWorld();var n=new Fe(e,4,2),r=new St({wireframe:!0,fog:!1});r.color.copy(this.light.color),Ct.call(this,n,r),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1}function Ir(t){nt.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,t=new ne({color:t.color});var e=new bt;e.addAttribute("position",new ut(new Float32Array(15),3)),this.add(new re(e,t)),this.update()}function Nr(t,e){nt.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1;var n=new xe(e);n.rotateY(.5*Math.PI);var r=new St({vertexColors:2,wireframe:!0}),i=n.getAttribute("position");i=new Float32Array(3*i.count),n.addAttribute("color",new ut(i,3)),this.add(new Ct(n,r)),this.update()}function Fr(t,e,n,r){t=t||10,e=e||10,n=new V(void 0!==n?n:4473924),r=new V(void 0!==r?r:8947848);var i=e/2,o=t/e,a=t/2;t=[];for(var s=[],u=0,c=0,l=-a;u<=e;u++,l+=o){t.push(-a,0,l,a,0,l),t.push(l,0,-a,l,0,a);var h=u===i?n:r;h.toArray(s,c),h.toArray(s,c+=3),h.toArray(s,c+=3),h.toArray(s,c+=3),c+=3}(e=new bt).addAttribute("position",new gt(t,3)),e.addAttribute("color",new gt(s,3)),n=new ne({vertexColors:2}),ie.call(this,e,n)}function jr(t,e,n,r,i,o){t=t||10,e=e||16,n=n||8,r=r||64,i=new V(void 0!==i?i:4473924),o=new V(void 0!==o?o:8947848);var a,s,u,c,l,h=[],f=[];for(u=0;u<=e;u++)s=u/e*2*Math.PI,a=Math.sin(s)*t,s=Math.cos(s)*t,h.push(0,0,0),h.push(a,0,s),f.push((l=1&u?i:o).r,l.g,l.b),f.push(l.r,l.g,l.b);for(u=0;u<=n;u++)for(l=1&u?i:o,c=t-t/n*u,e=0;e<r;e++)s=e/r*2*Math.PI,a=Math.sin(s)*c,s=Math.cos(s)*c,h.push(a,0,s),f.push(l.r,l.g,l.b),s=(e+1)/r*2*Math.PI,a=Math.sin(s)*c,s=Math.cos(s)*c,h.push(a,0,s),f.push(l.r,l.g,l.b);(t=new bt).addAttribute("position",new gt(h,3)),t.addAttribute("color",new gt(f,3)),h=new ne({vertexColors:2}),ie.call(this,t,h)}function zr(t,e,n,r){this.object=t,this.size=void 0!==e?e:1,t=void 0!==n?n:16776960,r=void 0!==r?r:1,e=0,(n=this.object.geometry)&&n.isGeometry?e=n.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead."),n=new bt,e=new gt(6*e,3),n.addAttribute("position",e),ie.call(this,n,new ne({color:t,linewidth:r})),this.matrixAutoUpdate=!1,this.update()}function Ur(t,e){nt.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,void 0===e&&(e=1);var n=new bt;n.addAttribute("position",new gt([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var r=new ne({fog:!1});this.add(new re(n,r)),(n=new bt).addAttribute("position",new gt([0,0,0,0,0,1],3)),this.add(new re(n,r)),this.update()}function Vr(t){function e(t,e,r){n(t,r),n(e,r)}function n(t,e){o.push(0,0,0),a.push(e.r,e.g,e.b),void 0===s[t]&&(s[t]=[]),s[t].push(o.length/3-1)}var r=new bt,i=new ne({color:16777215,vertexColors:1}),o=[],a=[],s={},u=new V(16755200),c=new V(16711680),l=new V(43775),h=new V(16777215),f=new V(3355443);e("n1","n2",u),e("n2","n4",u),e("n4","n3",u),e("n3","n1",u),e("f1","f2",u),e("f2","f4",u),e("f4","f3",u),e("f3","f1",u),e("n1","f1",u),e("n2","f2",u),e("n3","f3",u),e("n4","f4",u),e("p","n1",c),e("p","n2",c),e("p","n3",c),e("p","n4",c),e("u1","u2",l),e("u2","u3",l),e("u3","u1",l),e("c","t",h),e("p","c",f),e("cn1","cn2",f),e("cn3","cn4",f),e("cf1","cf2",f),e("cf3","cf4",f),r.addAttribute("position",new gt(o,3)),r.addAttribute("color",new gt(a,3)),ie.call(this,r,i),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}function Br(t,e){this.object=t,void 0===e&&(e=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new bt;i.setIndex(new ut(n,1)),i.addAttribute("position",new ut(r,3)),ie.call(this,i,new ne({color:e})),this.matrixAutoUpdate=!1,this.update()}function Hr(t,e,n,r,i,o){nt.call(this),void 0===r&&(r=16776960),void 0===n&&(n=1),void 0===i&&(i=.2*n),void 0===o&&(o=.2*i),void 0===Ii&&((Ii=new bt).addAttribute("position",new gt([0,0,0,0,1,0],3)),(Ni=new We(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new re(Ii,new ne({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ct(Ni,new St({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,i,o)}function qr(t){var e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t];(t=new bt).addAttribute("position",new gt(e,3)),t.addAttribute("color",new gt([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),e=new ne({vertexColors:2}),ie.call(this,t,e)}function Gr(){var t=0,e=0,n=0,r=0;return{initCatmullRom:function(i,o,a,s,u){t=o,e=i=u*(a-i),n=-3*o+3*a-2*i-(s=u*(s-o)),r=2*o-2*a+i+s},initNonuniformCatmullRom:function(i,o,a,s,u,c,l){t=o,e=i=((o-i)/u-(a-i)/(u+c)+(a-o)/c)*c,n=-3*o+3*a-2*i-(s=((a-o)/c-(s-o)/(c+l)+(s-a)/l)*c),r=2*o-2*a+i+s},calc:function(i){var o=i*i;return t+e*i+n*o+r*o*i}}}function Wr(t){this.arcLengthDivisions=200,2>t.length&&console.warn("THREE.CatmullRomCurve3: Points array needs at least two entries."),this.points=t||[],this.closed=!1}function Yr(t,e,n,r){this.arcLengthDivisions=200,this.v0=t,this.v1=e,this.v2=n,this.v3=r}function Xr(t,e,n){this.arcLengthDivisions=200,this.v0=t,this.v1=e,this.v2=n}function $r(t,e){this.arcLengthDivisions=200,this.v1=t,this.v2=e}function Qr(t,e,n,r,i,o){$n.call(this,t,e,n,n,r,i,o)}function Jr(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Wr.call(this,t),this.type="catmullrom",this.closed=!0}function Zr(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Wr.call(this,t),this.type="catmullrom"}function Kr(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Wr.call(this,t),this.type="catmullrom"}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return 0>t?-1:0<t?1:+t}),void 0===Function.prototype.name&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(void 0!==r&&null!==r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}),Object.assign(e.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners&&void 0!==(e=this._listeners[t.type])){t.target=this;for(var e,n=0,r=(e=e.slice(0)).length;n<r;n++)e[n].call(this,t)}}});var ti,ei,ni,ri,ii={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:(ei="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),ni=Array(36),ri=0,function(){for(var t=0;36>t;t++)8===t||13===t||18===t||23===t?ni[t]="-":14===t?ni[t]="4":(2>=ri&&(ri=33554432+16777216*Math.random()|0),ti=15&ri,ri>>=4,ni[t]=ei[19===t?3&ti|8:ti]);return ni.join("")}),clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*ii.DEG2RAD},radToDeg:function(t){return t*ii.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},nearestPowerOfTwo:function(t){return Math.pow(2,Math.round(Math.log(t)/Math.LN2))},nextPowerOfTwo:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}};Object.defineProperties(n.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(n.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(){var t=new n,e=new n;return function(n,r){return t.set(n,n),e.set(r,r),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(this.y,this.x);return 0>t&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x;return e*e+(t=this.y-t.y)*t},distanceToManhattan:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,o=this.y-t.y;return this.x=i*n-o*r+t.x,this.y=i*r+o*n+t.y,this}});var oi=0;r.DEFAULT_IMAGE=void 0,r.DEFAULT_MAPPING=300,Object.defineProperty(r.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(r.prototype,e.prototype,{constructor:r,isTexture:!0,clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){if(void 0!==t.textures[this.uuid])return t.textures[this.uuid];var e={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var n=this.image;if(void 0===n.uuid&&(n.uuid=ii.generateUUID()),void 0===t.images[n.uuid]){var r,i=t.images,o=n.uuid,a=n.uuid;void 0!==n.toDataURL?r=n:((r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=n.width,r.height=n.height,r.getContext("2d").drawImage(n,0,0,n.width,n.height)),r=2048<r.width||2048<r.height?r.toDataURL("image/jpeg",.6):r.toDataURL("image/png"),i[o]={uuid:a,url:r}}e.image=n.uuid}return t.textures[this.uuid]=e},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300===this.mapping){if(t.multiply(this.repeat),t.add(this.offset),0>t.x||1<t.x)switch(this.wrapS){case 1e3:t.x-=Math.floor(t.x);break;case 1001:t.x=0>t.x?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(0>t.y||1<t.y)switch(this.wrapT){case 1e3:t.y-=Math.floor(t.y);break;case 1001:t.y=0>t.y?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}}),Object.assign(i.prototype,{isVector4:!0,set:function(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this},setScalar:function(t){return this.w=this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=this.w;return this.x=(t=t.elements)[0]*e+t[4]*n+t[8]*r+t[12]*i,this.y=t[1]*e+t[5]*n+t[9]*r+t[13]*i,this.z=t[2]*e+t[6]*n+t[10]*r+t[14]*i,this.w=t[3]*e+t[7]*n+t[11]*r+t[15]*i,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return 1e-4>e?(this.x=1,this.z=this.y=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,r,i=(t=t.elements)[0];r=t[4];var o=t[8],a=t[1],s=t[5],u=t[9];n=t[2],e=t[6];var c=t[10];return.01>Math.abs(r-a)&&.01>Math.abs(o-n)&&.01>Math.abs(u-e)?.1>Math.abs(r+a)&&.1>Math.abs(o+n)&&.1>Math.abs(u+e)&&.1>Math.abs(i+s+c-3)?(this.set(1,0,0,0),this):(t=Math.PI,c=(c+1)/2,r=(r+a)/4,o=(o+n)/4,u=(u+e)/4,(i=(i+1)/2)>(s=(s+1)/2)&&i>c?.01>i?(e=0,r=n=.707106781):(n=r/(e=Math.sqrt(i)),r=o/e):s>c?.01>s?(e=.707106781,n=0,r=.707106781):(e=r/(n=Math.sqrt(s)),r=u/n):.01>c?(n=e=.707106781,r=0):(e=o/(r=Math.sqrt(c)),n=u/r),this.set(e,n,r,t),this):(t=Math.sqrt((e-u)*(e-u)+(o-n)*(o-n)+(a-r)*(a-r)),.001>Math.abs(t)&&(t=1),this.x=(e-u)/t,this.y=(o-n)/t,this.z=(a-r)/t,this.w=Math.acos((i+s+c-1)/2),this)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(){var t,e;return function(n,r){return void 0===t&&(t=new i,e=new i),t.set(n,n,n,n),e.set(r,r,r,r),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}}),Object.assign(o.prototype,e.prototype,{isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(a.prototype=Object.create(o.prototype)).constructor=a,a.prototype.isWebGLRenderTargetCube=!0,Object.assign(s,{slerp:function(t,e,n,r){return n.copy(t).slerp(e,r)},slerpFlat:function(t,e,n,r,i,o,a){var s=n[r+0],u=n[r+1],c=n[r+2];n=n[r+3],r=i[o+0];var l=i[o+1],h=i[o+2];if(n!==(i=i[o+3])||s!==r||u!==l||c!==h){o=1-a;var f=s*r+u*l+c*h+n*i,d=0<=f?1:-1,p=1-f*f;p>Number.EPSILON&&(p=Math.sqrt(p),f=Math.atan2(p,f*d),o=Math.sin(o*f)/p,a=Math.sin(a*f)/p),s=s*o+r*(d*=a),u=u*o+l*d,c=c*o+h*d,n=n*o+i*d,o===1-a&&(s*=a=1/Math.sqrt(s*s+u*u+c*c+n*n),u*=a,c*=a,n*=a)}t[e]=s,t[e+1]=u,t[e+2]=c,t[e+3]=n}}),Object.defineProperties(s.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback()}}}),Object.assign(s.prototype,{set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,r=t._y,i=t._z,o=t.order,a=Math.cos,s=Math.sin,u=a(n/2),c=a(r/2);return a=a(i/2),n=s(n/2),r=s(r/2),i=s(i/2),"XYZ"===o?(this._x=n*c*a+u*r*i,this._y=u*r*a-n*c*i,this._z=u*c*i+n*r*a,this._w=u*c*a-n*r*i):"YXZ"===o?(this._x=n*c*a+u*r*i,this._y=u*r*a-n*c*i,this._z=u*c*i-n*r*a,this._w=u*c*a+n*r*i):"ZXY"===o?(this._x=n*c*a-u*r*i,this._y=u*r*a+n*c*i,this._z=u*c*i+n*r*a,this._w=u*c*a-n*r*i):"ZYX"===o?(this._x=n*c*a-u*r*i,this._y=u*r*a+n*c*i,this._z=u*c*i-n*r*a,this._w=u*c*a+n*r*i):"YZX"===o?(this._x=n*c*a+u*r*i,this._y=u*r*a+n*c*i,this._z=u*c*i-n*r*a,this._w=u*c*a-n*r*i):"XZY"===o&&(this._x=n*c*a-u*r*i,this._y=u*r*a-n*c*i,this._z=u*c*i+n*r*a,this._w=u*c*a+n*r*i),!1!==e&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e=(n=t.elements)[0];t=n[4];var n,r=n[8],i=n[1],o=n[5],a=n[9],s=n[2],u=n[6],c=e+o+(n=n[10]);return 0<c?(e=.5/Math.sqrt(c+1),this._w=.25/e,this._x=(u-a)*e,this._y=(r-s)*e,this._z=(i-t)*e):e>o&&e>n?(e=2*Math.sqrt(1+e-o-n),this._w=(u-a)/e,this._x=.25*e,this._y=(t+i)/e,this._z=(r+s)/e):o>n?(e=2*Math.sqrt(1+o-e-n),this._w=(r-s)/e,this._x=(t+i)/e,this._y=.25*e,this._z=(a+u)/e):(e=2*Math.sqrt(1+n-e-o),this._w=(i-t)/e,this._x=(r+s)/e,this._y=(a+u)/e,this._z=.25*e),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,e=new u;return function(n,r){return void 0===e&&(e=new u),1e-6>(t=n.dot(r)+1)?(t=0,Math.abs(n.x)>Math.abs(n.z)?e.set(-n.y,n.x,0):e.set(0,-n.z,n.y)):e.crossVectors(n,r),this._x=e.x,this._y=e.y,this._z=e.z,this._w=t,this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._z=this._y=this._x=0,this._w=1):(this._x*=t=1/t,this._y*=t,this._z*=t,this._w*=t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,r=t._y,i=t._z,o=t._w,a=e._x,s=e._y,u=e._z,c=e._w;return this._x=n*c+o*a+r*u-i*s,this._y=r*c+o*s+i*a-n*u,this._z=i*c+o*u+n*s-r*a,this._w=o*c-n*a-r*s-i*u,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,r=this._y,i=this._z,o=this._w;if(0>(u=o*t._w+n*t._x+r*t._y+i*t._z)?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,u=-u):this.copy(t),1<=u)return this._w=o,this._x=n,this._y=r,this._z=i,this;var a=Math.sqrt(1-u*u);if(.001>Math.abs(a))return this._w=.5*(o+this._w),this._x=.5*(n+this._x),this._y=.5*(r+this._y),this._z=.5*(i+this._z),this;var s=Math.atan2(a,u),u=Math.sin((1-e)*s)/a;return a=Math.sin(e*s)/a,this._w=o*u+this._w*a,this._x=n*u+this._x*a,this._y=r*u+this._y*a,this._z=i*u+this._z*a,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(u.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(){var t=new s;return function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(t.setFromEuler(e))}}(),applyAxisAngle:function(){var t=new s;return function(e,n){return this.applyQuaternion(t.setFromAxisAngle(e,n))}}(),applyMatrix3:function(t){var e=this.x,n=this.y,r=this.z;return this.x=(t=t.elements)[0]*e+t[3]*n+t[6]*r,this.y=t[1]*e+t[4]*n+t[7]*r,this.z=t[2]*e+t[5]*n+t[8]*r,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=1/((t=t.elements)[3]*e+t[7]*n+t[11]*r+t[15]);return this.x=(t[0]*e+t[4]*n+t[8]*r+t[12])*i,this.y=(t[1]*e+t[5]*n+t[9]*r+t[13])*i,this.z=(t[2]*e+t[6]*n+t[10]*r+t[14])*i,this},applyQuaternion:function(t){var e,n=this.y,r=this.z,i=t.x,o=t.y,a=t.z,s=(t=t.w)*(e=this.x)+o*r-a*n,u=t*n+a*e-i*r,c=t*r+i*n-o*e;return this.x=s*t+(e=-i*e-o*n-a*r)*-i+u*-a-c*-o,this.y=u*t+e*-o+c*-i-s*-a,this.z=c*t+e*-a+s*-o-u*-i,this},project:function(){var t=new c;return function(e){return t.multiplyMatrices(e.projectionMatrix,t.getInverse(e.matrixWorld)),this.applyMatrix4(t)}}(),unproject:function(){var t=new c;return function(e){return t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyMatrix4(t)}}(),transformDirection:function(t){var e=this.x,n=this.y,r=this.z;return this.x=(t=t.elements)[0]*e+t[4]*n+t[8]*r,this.y=t[1]*e+t[5]*n+t[9]*r,this.z=t[2]*e+t[6]*n+t[10]*r,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(){var t=new u,e=new u;return function(n,r){return t.set(n,n,n),e.set(r,r,r),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){if(void 0!==e)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e);var n=this.x,r=this.y,i=this.z;return this.x=r*t.z-i*t.y,this.y=i*t.x-n*t.z,this.z=n*t.y-r*t.x,this},crossVectors:function(t,e){var n=t.x,r=t.y,i=t.z,o=e.x,a=e.y,s=e.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:function(){var t=new u;return function(e){return t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t=new u;return function(e){return this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(t){return t=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq()),Math.acos(ii.clamp(t,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n+(t=this.z-t.z)*t},distanceToManhattan:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){var e=Math.sin(t.phi)*t.radius;return this.x=e*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=e*Math.cos(t.theta),this},setFromCylindrical:function(t){return this.x=t.radius*Math.sin(t.theta),this.y=t.y,this.z=t.radius*Math.cos(t.theta),this},setFromMatrixPosition:function(t){return this.x=(t=t.elements)[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length();return t=this.setFromMatrixColumn(t,2).length(),this.x=e,this.y=n,this.z=t,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}}),Object.assign(c.prototype,{isMatrix4:!0,set:function(t,e,n,r,i,o,a,s,u,c,l,h,f,d,p,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=r,g[1]=i,g[5]=o,g[9]=a,g[13]=s,g[2]=u,g[6]=c,g[10]=l,g[14]=h,g[3]=f,g[7]=d,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new c).fromArray(this.elements)},copy:function(t){var e=this.elements;return e[0]=(t=t.elements)[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],this},copyPosition:function(t){var e=this.elements;return e[12]=(t=t.elements)[12],e[13]=t[13],e[14]=t[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(){var t=new u;return function(e){var n=this.elements,r=e.elements,i=1/t.setFromMatrixColumn(e,0).length(),o=1/t.setFromMatrixColumn(e,1).length();return e=1/t.setFromMatrixColumn(e,2).length(),n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[4]=r[4]*o,n[5]=r[5]*o,n[6]=r[6]*o,n[8]=r[8]*e,n[9]=r[9]*e,n[10]=r[10]*e,this}}(),makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,r=t.y,i=t.z,o=Math.cos(n),a=(n=Math.sin(n),Math.cos(r)),s=(r=Math.sin(r),Math.cos(i));if(i=Math.sin(i),"XYZ"===t.order){t=o*s;var u=o*i,c=n*s,l=n*i;e[0]=a*s,e[4]=-a*i,e[8]=r,e[1]=u+c*r,e[5]=t-l*r,e[9]=-n*a,e[2]=l-t*r,e[6]=c+u*r,e[10]=o*a}else"YXZ"===t.order?(u=a*i,c=r*s,e[0]=(t=a*s)+(l=r*i)*n,e[4]=c*n-u,e[8]=o*r,e[1]=o*i,e[5]=o*s,e[9]=-n,e[2]=u*n-c,e[6]=l+t*n,e[10]=o*a):"ZXY"===t.order?(u=a*i,c=r*s,e[0]=(t=a*s)-(l=r*i)*n,e[4]=-o*i,e[8]=c+u*n,e[1]=u+c*n,e[5]=o*s,e[9]=l-t*n,e[2]=-o*r,e[6]=n,e[10]=o*a):"ZYX"===t.order?(t=o*s,u=o*i,c=n*s,l=n*i,e[0]=a*s,e[4]=c*r-u,e[8]=t*r+l,e[1]=a*i,e[5]=l*r+t,e[9]=u*r-c,e[2]=-r,e[6]=n*a,e[10]=o*a):"YZX"===t.order?(t=o*a,u=o*r,c=n*a,l=n*r,e[0]=a*s,e[4]=l-t*i,e[8]=c*i+u,e[1]=i,e[5]=o*s,e[9]=-n*s,e[2]=-r*s,e[6]=u*i+c,e[10]=t-l*i):"XZY"===t.order&&(t=o*a,u=o*r,c=n*a,l=n*r,e[0]=a*s,e[4]=-i,e[8]=r*s,e[1]=t*i+l,e[5]=o*s,e[9]=u*i-c,e[2]=c*i-u,e[6]=n*s,e[10]=l*i+t);return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,n=t._y,r=t._w,i=(o=t._z)+o;t=(s=t._x)*(c=s+s);var o,a=s*(l=n+n),s=s*i,u=n*l,c=(n*=i,r*c),l=r*l;return r*=i,e[0]=1-(u+(o*=i)),e[4]=a-r,e[8]=s+l,e[1]=a+r,e[5]=1-(t+o),e[9]=n-c,e[2]=s-l,e[6]=n+c,e[10]=1-(t+u),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t=new u,e=new u,n=new u;return function(r,i,o){var a=this.elements;return n.subVectors(r,i),0===n.lengthSq()&&(n.z=1),n.normalize(),t.crossVectors(o,n),0===t.lengthSq()&&(1===Math.abs(o.z)?n.x+=1e-4:n.z+=1e-4,n.normalize(),t.crossVectors(o,n)),t.normalize(),e.crossVectors(n,t),a[0]=t.x,a[4]=e.x,a[8]=n.x,a[1]=t.y,a[5]=e.y,a[9]=n.y,a[2]=t.z,a[6]=e.z,a[10]=n.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=this.elements,r=(y=t.elements)[0],i=y[4],o=y[8],a=y[12],s=y[1],u=y[5],c=y[9],l=y[13],h=y[2],f=y[6],d=y[10],p=y[14],m=y[3],g=y[7],v=y[11],y=y[15],w=(P=e.elements)[0],b=P[4],x=P[8],_=P[12],M=P[1],E=P[5],S=P[9],T=P[13],A=P[2],k=P[6],C=P[10],R=P[14],D=P[3],L=P[7],O=P[11],P=P[15];return n[0]=r*w+i*M+o*A+a*D,n[4]=r*b+i*E+o*k+a*L,n[8]=r*x+i*S+o*C+a*O,n[12]=r*_+i*T+o*R+a*P,n[1]=s*w+u*M+c*A+l*D,n[5]=s*b+u*E+c*k+l*L,n[9]=s*x+u*S+c*C+l*O,n[13]=s*_+u*T+c*R+l*P,n[2]=h*w+f*M+d*A+p*D,n[6]=h*b+f*E+d*k+p*L,n[10]=h*x+f*S+d*C+p*O,n[14]=h*_+f*T+d*R+p*P,n[3]=m*w+g*M+v*A+y*D,n[7]=m*b+g*E+v*k+y*L,n[11]=m*x+g*S+v*C+y*O,n[15]=m*_+g*T+v*R+y*P,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToBufferAttribute:function(){var t=new u;return function(e){for(var n=0,r=e.count;n<r;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix4(this),e.setXYZ(n,t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],o=t[1],a=t[5],s=t[9],u=t[13],c=t[2],l=t[6],h=t[10],f=t[14];return t[3]*(+i*s*l-r*u*l-i*a*h+n*u*h+r*a*f-n*s*f)+t[7]*(+e*s*f-e*u*h+i*o*h-r*o*f+r*u*c-i*s*c)+t[11]*(+e*u*l-e*a*f-i*o*l+n*o*f+i*a*c-n*u*c)+t[15]*(-r*a*c-e*s*l+e*a*h+r*o*l-n*o*h+n*s*c)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var n,r=this.elements,i=(n=t.elements)[0],o=n[1],a=n[2],s=n[3],u=n[4],c=n[5],l=n[6],h=n[7],f=n[8],d=n[9],p=n[10],m=n[11],g=n[12],v=n[13],y=n[14],w=d*y*h-v*p*h+v*l*m-c*y*m-d*l*(n=n[15])+c*p*n,b=g*p*h-f*y*h-g*l*m+u*y*m+f*l*n-u*p*n,x=f*v*h-g*d*h+g*c*m-u*v*m-f*c*n+u*d*n,_=g*d*l-f*v*l-g*c*p+u*v*p+f*c*y-u*d*y,M=i*w+o*b+a*x+s*_;if(0===M){if(!0===e)throw Error("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0");return console.warn("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0"),this.identity()}return r[0]=w*(M=1/M),r[1]=(v*p*s-d*y*s-v*a*m+o*y*m+d*a*n-o*p*n)*M,r[2]=(c*y*s-v*l*s+v*a*h-o*y*h-c*a*n+o*l*n)*M,r[3]=(d*l*s-c*p*s-d*a*h+o*p*h+c*a*m-o*l*m)*M,r[4]=b*M,r[5]=(f*y*s-g*p*s+g*a*m-i*y*m-f*a*n+i*p*n)*M,r[6]=(g*l*s-u*y*s-g*a*h+i*y*h+u*a*n-i*l*n)*M,r[7]=(u*p*s-f*l*s+f*a*h-i*p*h-u*a*m+i*l*m)*M,r[8]=x*M,r[9]=(g*d*s-f*v*s-g*o*m+i*v*m+f*o*n-i*d*n)*M,r[10]=(u*v*s-g*c*s+g*o*h-i*v*h-u*o*n+i*c*n)*M,r[11]=(f*c*s-u*d*s-f*o*h+i*d*h+u*o*m-i*c*m)*M,r[12]=_*M,r[13]=(f*v*a-g*d*a+g*o*p-i*v*p-f*o*y+i*d*y)*M,r[14]=(g*c*a-u*v*a-g*o*l+i*v*l+u*o*y-i*c*y)*M,r[15]=(u*d*a-f*c*a+f*o*l-i*d*l-u*o*p+i*c*p)*M,this},scale:function(t){var e=this.elements,n=t.x,r=t.y;return t=t.z,e[0]*=n,e[4]*=r,e[8]*=t,e[1]*=n,e[5]*=r,e[9]*=t,e[2]*=n,e[6]*=r,e[10]*=t,e[3]*=n,e[7]*=r,e[11]*=t,this},getMaxScaleOnAxis:function(){var t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(1,0,0,0,0,e,-t,0,0,t,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,0,t,0,0,1,0,0,-t,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t);return t=Math.sin(t),this.set(e,-t,0,0,t,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=1-n,o=t.x,a=t.y,s=t.z,u=i*o,c=i*a;return this.set(u*o+n,u*a-r*s,u*s+r*a,0,u*a+r*s,c*a+n,c*s-r*o,0,u*s-r*a,c*s+r*o,i*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){return this.makeRotationFromQuaternion(e),this.scale(n),this.setPosition(t),this},decompose:function(){var t=new u,e=new c;return function(n,r,i){var o=t.set((u=this.elements)[0],u[1],u[2]).length(),a=t.set(u[4],u[5],u[6]).length(),s=t.set(u[8],u[9],u[10]).length();0>this.determinant()&&(o=-o),n.x=u[12],n.y=u[13],n.z=u[14],e.copy(this);var u=1/a,c=1/s;return e.elements[0]*=n=1/o,e.elements[1]*=n,e.elements[2]*=n,e.elements[4]*=u,e.elements[5]*=u,e.elements[6]*=u,e.elements[8]*=c,e.elements[9]*=c,e.elements[10]*=c,r.setFromRotationMatrix(e),i.x=o,i.y=a,i.z=s,this}}(),makePerspective:function(t,e,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements;return a[0]=2*i/(e-t),a[4]=0,a[8]=(e+t)/(e-t),a[12]=0,a[1]=0,a[5]=2*i/(n-r),a[9]=(n+r)/(n-r),a[13]=0,a[2]=0,a[6]=0,a[10]=-(o+i)/(o-i),a[14]=-2*o*i/(o-i),a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(t,e,n,r,i,o){var a=this.elements,s=1/(e-t),u=1/(n-r),c=1/(o-i);return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-(e+t)*s,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-(n+r)*u,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-(o+i)*c,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){var e=this.elements;t=t.elements;for(var n=0;16>n;n++)if(e[n]!==t[n])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;16>n;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}),(l.prototype=Object.create(r.prototype)).constructor=l,l.prototype.isDataTexture=!0,(h.prototype=Object.create(r.prototype)).constructor=h,h.prototype.isCubeTexture=!0,Object.defineProperty(h.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});var ai=new r,si=new h,ui=[],ci=[],li=new Float32Array(16),hi=new Float32Array(9);z.prototype.setValue=function(t,e){for(var n=this.seq,r=0,i=n.length;r!==i;++r){var o=n[r];o.setValue(t,e[o.id])}};var fi=/([\w\d_]+)(\])?(\[|\.)?/g;U.prototype.setValue=function(t,e,n){void 0!==(e=this.map[e])&&e.setValue(t,n,this.renderer)},U.prototype.setOptional=function(t,e,n){void 0!==(e=e[n])&&this.setValue(t,n,e)},U.upload=function(t,e,n,r){for(var i=0,o=e.length;i!==o;++i){var a=e[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(t,s.value,r)}},U.seqWithValue=function(t,e){for(var n=[],r=0,i=t.length;r!==i;++r){var o=t[r];o.id in e&&n.push(o)}return n};var di={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Object.assign(V.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.b=this.g=this.r=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(){function t(t,e,n){return 0>n&&(n+=1),1<n&&--n,n<1/6?t+6*(e-t)*n:.5>n?e:n<2/3?t+6*(e-t)*(2/3-n):t}return function(e,n,r){return e=ii.euclideanModulo(e,1),n=ii.clamp(n,0,1),r=ii.clamp(r,0,1),0===n?this.r=this.g=this.b=r:(this.r=t(r=2*r-(n=.5>=r?r*(1+n):r+n-r*n),n,e+1/3),this.g=t(r,n,e),this.b=t(r,n,e-1/3)),this}}(),setStyle:function(t){function e(e){void 0!==e&&1>parseFloat(e)&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var r=n[2];switch(n[1]){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,e(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,e(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r)){r=parseFloat(n[1])/360;var i=parseInt(n[2],10)/100,o=parseInt(n[3],10)/100;return e(n[5]),this.setHSL(r,i,o)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){if(3===(r=(n=n[1]).length))return this.r=parseInt(n.charAt(0)+n.charAt(0),16)/255,this.g=parseInt(n.charAt(1)+n.charAt(1),16)/255,this.b=parseInt(n.charAt(2)+n.charAt(2),16)/255,this;if(6===r)return this.r=parseInt(n.charAt(0)+n.charAt(1),16)/255,this.g=parseInt(n.charAt(2)+n.charAt(3),16)/255,this.b=parseInt(n.charAt(4)+n.charAt(5),16)/255,this}return t&&0<t.length&&(void 0!==(n=di[t])?this.setHex(n):console.warn("THREE.Color: Unknown color "+t)),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var n=0<e?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(){var t=this.r,e=this.g,n=this.b;return this.r=t*t,this.g=e*e,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){t=t||{h:0,s:0,l:0};var e,n=this.r,r=this.g,i=this.b,o=Math.max(n,r,i),a=((u=Math.min(n,r,i))+o)/2;if(u===o)u=e=0;else{var s=o-u,u=.5>=a?s/(o+u):s/(2-o-u);switch(o){case n:e=(r-i)/s+(r<i?6:0);break;case r:e=(i-n)/s+2;break;case i:e=(n-r)/s+4}e/=6}return t.h=e,t.s=u,t.l=a,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){var r=this.getHSL();return r.h+=t,r.s+=e,r.l+=n,this.setHSL(r.h,r.s,r.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}});var pi={common:{diffuse:{value:new V(15658734)},opacity:{value:1},map:{value:null},offsetRepeat:{value:new i(0,0,1,1)},specularMap:{value:null},alphaMap:{value:null},envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new n(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new V(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new V(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},offsetRepeat:{value:new i(0,0,1,1)}}},mi={merge:function(t){for(var e={},n=0;n<t.length;n++){var r,i=this.clone(t[n]);for(r in i)e[r]=i[r]}return e},clone:function(t){var e,n={};for(e in t)for(var r in n[e]={},t[e]){var i=t[e][r];n[e][r]=i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?i.clone():Array.isArray(i)?i.slice():i}return n}},gi={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat theta = acos( dot( N, V ) );\n\tvec2 uv = vec2(\n\t\tsqrt( saturate( roughness ) ),\n\t\tsaturate( theta / ( 0.5 * PI ) ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.86267 + (0.49788 + 0.01436 * y ) * y;\n\tfloat b = 3.45068 + (4.18814 + y) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = (x > 0.0) ? v : 0.5 * inversesqrt( 1.0 - x * x ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transpose( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tvec3 result = vec3( LTC_ClippedSphereFormFactor( vectorFormFactor ) );\n\treturn result;\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t\t\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\t\tvec4 plane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transpose( const in mat3 v ) {\n\tmat3 tmp;\n\ttmp[0] = vec3(v[0].x, v[1].x, v[2].x);\n\ttmp[1] = vec3(v[0].y, v[1].y, v[2].y);\n\ttmp[2] = vec3(v[0].z, v[1].z, v[2].z);\n\treturn tmp;\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = asin( flipNormal * reflectVec.y ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltcMat;\tuniform sampler2D ltcMag;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = saturate( reflectVec.y * 0.5 + 0.5 );\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tfloat norm = texture2D( ltcMag, uv ).a;\n\t\tvec4 t = texture2D( ltcMat, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3(   1,   0, t.y ),\n\t\t\tvec3(   0, t.z,   0 ),\n\t\t\tvec3( t.w,   0, t.x )\n\t\t);\n\t\treflectedLight.directSpecular += lightColor * material.specularColor * norm * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_template:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_flip:"#ifdef DOUBLE_SIDED\n\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n#else\n\tfloat flipNormal = 1.0;\n#endif\n",normal_fragment:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal ) * flipNormal;\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 1.0 - 2.0 * rgb.xyz;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n#include <common>\n#include <packing>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\n}\n",distanceRGBA_vert:"varying vec4 vWorldPosition;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform float opacity;\n#include <common>\n#include <packing>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( 0.0, 0.0, 0.0, opacity * ( 1.0 - getShadowMask() ) );\n}\n",shadow_vert:"#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n"},vi={basic:{uniforms:mi.merge([pi.common,pi.aomap,pi.lightmap,pi.fog]),vertexShader:gi.meshbasic_vert,fragmentShader:gi.meshbasic_frag},lambert:{uniforms:mi.merge([pi.common,pi.aomap,pi.lightmap,pi.emissivemap,pi.fog,pi.lights,{emissive:{value:new V(0)}}]),vertexShader:gi.meshlambert_vert,fragmentShader:gi.meshlambert_frag},phong:{uniforms:mi.merge([pi.common,pi.aomap,pi.lightmap,pi.emissivemap,pi.bumpmap,pi.normalmap,pi.displacementmap,pi.gradientmap,pi.fog,pi.lights,{emissive:{value:new V(0)},specular:{value:new V(1118481)},shininess:{value:30}}]),vertexShader:gi.meshphong_vert,fragmentShader:gi.meshphong_frag},standard:{uniforms:mi.merge([pi.common,pi.aomap,pi.lightmap,pi.emissivemap,pi.bumpmap,pi.normalmap,pi.displacementmap,pi.roughnessmap,pi.metalnessmap,pi.fog,pi.lights,{emissive:{value:new V(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:gi.meshphysical_vert,fragmentShader:gi.meshphysical_frag},points:{uniforms:mi.merge([pi.points,pi.fog]),vertexShader:gi.points_vert,fragmentShader:gi.points_frag},dashed:{uniforms:mi.merge([pi.common,pi.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:gi.linedashed_vert,fragmentShader:gi.linedashed_frag},depth:{uniforms:mi.merge([pi.common,pi.displacementmap]),vertexShader:gi.depth_vert,fragmentShader:gi.depth_frag},normal:{uniforms:mi.merge([pi.common,pi.bumpmap,pi.normalmap,pi.displacementmap,{opacity:{value:1}}]),vertexShader:gi.normal_vert,fragmentShader:gi.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:gi.cube_vert,fragmentShader:gi.cube_frag},equirect:{uniforms:{tEquirect:{value:null},tFlip:{value:-1}},vertexShader:gi.equirect_vert,fragmentShader:gi.equirect_frag},distanceRGBA:{uniforms:{lightPos:{value:new u}},vertexShader:gi.distanceRGBA_vert,fragmentShader:gi.distanceRGBA_frag}};vi.physical={uniforms:mi.merge([vi.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:gi.meshphysical_vert,fragmentShader:gi.meshphysical_frag},Object.assign(B.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new n;return function(e,n){var r=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return t=t||new n,this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return t=t||new n,this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return(e||new n).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return(e||new n).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new n;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var yi=0;Object.assign(G.prototype,e.prototype,{isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0===n)console.warn("THREE.Material: '"+e+"' parameter is undefined.");else{var r=this[e];void 0===r?console.warn("THREE."+this.type+": '"+e+"' is not a property of this material."):r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]="overdraw"===e?Number(n):n}}},toJSON:function(t){function e(t){var e,n=[];for(e in t){var r=t[e];delete r.metadata,n.push(r)}return n}var n=void 0===t;n&&(t={textures:{},images:{}});var r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};return r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearCoat&&(r.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(r.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(t).uuid,r.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(r.size=this.size),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(r.blending=this.blending),2!==this.shading&&(r.shading=this.shading),0!==this.side&&(r.side=this.side),0!==this.vertexColors&&(r.vertexColors=this.vertexColors),1>this.opacity&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,0<this.alphaTest&&(r.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),1<this.wireframeLinewidth&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),r.skinning=this.skinning,r.morphTargets=this.morphTargets,r.dithering=this.dithering,n&&(n=e(t.textures),t=e(t.images),0<n.length&&(r.textures=n),0<t.length&&(r.images=t)),r},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.shading=t.shading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.overdraw=t.overdraw,this.visible=t.visible,this.clipShadows=t.clipShadows,this.clipIntersection=t.clipIntersection;var e=null;if(null!==(t=t.clippingPlanes))for(var n=t.length,r=(e=Array(n),0);r!==n;++r)e[r]=t[r].clone();return this.clippingPlanes=e,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(W.prototype=Object.create(G.prototype)).constructor=W,W.prototype.isShaderMaterial=!0,W.prototype.copy=function(t){return G.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=mi.clone(t.uniforms),this.defines=t.defines,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},W.prototype.toJSON=function(t){return(t=G.prototype.toJSON.call(this,t)).uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t},(Y.prototype=Object.create(G.prototype)).constructor=Y,Y.prototype.isMeshDepthMaterial=!0,Y.prototype.copy=function(t){return G.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},Object.assign(X.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,u=t.length;s<u;s+=3){var c=t[s],l=t[s+1],h=t[s+2];c<e&&(e=c),l<n&&(n=l),h<r&&(r=h),c>i&&(i=c),l>o&&(o=l),h>a&&(a=h)}return this.min.set(e,n,r),this.max.set(i,o,a),this},setFromBufferAttribute:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,u=t.count;s<u;s++){var c=t.getX(s),l=t.getY(s),h=t.getZ(s);c<e&&(e=c),l<n&&(n=l),h<r&&(r=h),c>i&&(i=c),l>o&&(o=l),h>a&&(a=h)}return this.min.set(e,n,r),this.max.set(i,o,a),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new u;return function(e,n){var r=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}}(),setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return t=t||new u,this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return t=t||new u,this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(){var t=new u;return function(e){var n=this;return e.updateMatrixWorld(!0),e.traverse(function(e){var r,i;if(void 0!==(r=e.geometry))if(r.isGeometry){var o=r.vertices;for(r=0,i=o.length;r<i;r++)t.copy(o[r]),t.applyMatrix4(e.matrixWorld),n.expandByPoint(t)}else if(r.isBufferGeometry&&void 0!==(o=r.attributes.position))for(r=0,i=o.count;r<i;r++)t.fromBufferAttribute(o,r).applyMatrix4(e.matrixWorld),n.expandByPoint(t)}),this}}(),containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return(e||new u).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(){var t=new u;return function(e){return this.clampPoint(e.center,t),t.distanceToSquared(e.center)<=e.radius*e.radius}}(),intersectsPlane:function(t){var e,n;return 0<t.normal.x?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),0<t.normal.y?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),0<t.normal.z?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=t.constant&&n>=t.constant},clampPoint:function(t,e){return(e||new u).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new u;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),getBoundingSphere:function(){var t=new u;return function(e){return e=e||new $,this.getCenter(e.center),e.radius=.5*this.getSize(t).length(),e}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new u,new u,new u,new u,new u,new u,new u,new u];return function(e){return this.isEmpty()?this:(t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(t),this)}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Object.assign($.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new X;return function(e,n){var r=this.center;void 0!==n?r.copy(n):t.setFromPoints(e).getCenter(r);for(var i=0,o=0,a=e.length;o<a;o++)i=Math.max(i,r.distanceToSquared(e[o]));return this.radius=Math.sqrt(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(this.center.dot(t.normal)-t.constant)<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t),r=e||new u;return r.copy(t),n>this.radius*this.radius&&(r.sub(this.center).normalize(),r.multiplyScalar(this.radius).add(this.center)),r},getBoundingBox:function(t){return(t=t||new X).set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius*=t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}}),Object.assign(Q.prototype,{isMatrix3:!0,set:function(t,e,n,r,i,o,a,s,u){var c=this.elements;return c[0]=t,c[1]=r,c[2]=a,c[3]=e,c[4]=i,c[5]=s,c[6]=n,c[7]=o,c[8]=u,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements;return e[0]=(t=t.elements)[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this},setFromMatrix4:function(t){return this.set((t=t.elements)[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:function(){var t=new u;return function(e){for(var n=0,r=e.count;n<r;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix3(this),e.setXYZ(n,t.x,t.y,t.z);return e}}(),multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=this.elements,r=(h=t.elements)[0],i=h[3],o=h[6],a=h[1],s=h[4],u=h[7],c=h[2],l=h[5],h=h[8],f=(b=e.elements)[0],d=b[3],p=b[6],m=b[1],g=b[4],v=b[7],y=b[2],w=b[5],b=b[8];return n[0]=r*f+i*m+o*y,n[3]=r*d+i*g+o*w,n[6]=r*p+i*v+o*b,n[1]=a*f+s*m+u*y,n[4]=a*d+s*g+u*w,n[7]=a*p+s*v+u*b,n[2]=c*f+l*m+h*y,n[5]=c*d+l*g+h*w,n[8]=c*p+l*v+h*b,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t,e=(t=this.elements)[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7];return e*o*(t=t[8])-e*a*u-n*i*t+n*a*s+r*i*u-r*o*s},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3.getInverse no longer takes a Matrix4 argument.");var n,r=this.elements,i=(n=t.elements)[0],o=n[1],a=n[2],s=n[3],u=n[4],c=n[5],l=n[6],h=n[7],f=(n=n[8])*u-c*h,d=c*l-n*s,p=h*s-u*l,m=i*f+o*d+a*p;if(0===m){if(!0===e)throw Error("THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0");return console.warn("THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0"),this.identity()}return r[0]=f*(m=1/m),r[1]=(a*h-n*o)*m,r[2]=(c*o-a*u)*m,r[3]=d*m,r[4]=(n*i-a*l)*m,r[5]=(a*s-c*i)*m,r[6]=p*m,r[7]=(o*l-h*i)*m,r[8]=(u*i-o*s)*m,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},equals:function(t){var e=this.elements;t=t.elements;for(var n=0;9>n;n++)if(e[n]!==t[n])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;9>n;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}}),Object.assign(J.prototype,{set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new u,e=new u;return function(n,r,i){return r=t.subVectors(i,r).cross(e.subVectors(n,r)).normalize(),this.setFromNormalAndCoplanarPoint(r,n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return this.orthoPoint(t,e).sub(t).negate()},orthoPoint:function(t,e){var n=this.distanceToPoint(t);return(e||new u).copy(this.normal).multiplyScalar(n)},intersectLine:function(){var t=new u;return function(e,n){var r=n||new u,i=e.delta(t),o=this.normal.dot(i);return 0!==o?0>(o=-(e.start.dot(this.normal)+this.constant)/o)||1<o?void 0:r.copy(i).multiplyScalar(o).add(e.start):0===this.distanceToPoint(e.start)?r.copy(e.start):void 0}}(),intersectsLine:function(t){var e=this.distanceToPoint(t.start);return t=this.distanceToPoint(t.end),0>e&&0<t||0>t&&0<e},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return(t||new u).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new u,e=new Q;return function(n,r){var i=this.coplanarPoint(t).applyMatrix4(n),o=r||e.getNormalMatrix(n);return o=this.normal.applyMatrix3(o).normalize(),this.constant=-i.dot(o),this}}(),translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}}),Object.assign(Z.prototype,{set:function(t,e,n,r,i,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,n=0;6>n;n++)e[n].copy(t.planes[n]);return this},setFromMatrix:function(t){var e,n=this.planes,r=(e=t.elements)[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],h=e[9],f=e[10],d=e[11],p=e[12],m=e[13],g=e[14];return n[0].setComponents(o-(t=e[0]),c-a,d-l,(e=e[15])-p).normalize(),n[1].setComponents(o+t,c+a,d+l,e+p).normalize(),n[2].setComponents(o+r,c+s,d+h,e+m).normalize(),n[3].setComponents(o-r,c-s,d-h,e-m).normalize(),n[4].setComponents(o-i,c-u,d-f,e-g).normalize(),n[5].setComponents(o+i,c+u,d+f,e+g).normalize(),this},intersectsObject:function(){var t=new $;return function(e){var n=e.geometry;return null===n.boundingSphere&&n.computeBoundingSphere(),t.copy(n.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSprite:function(){var t=new $;return function(e){return t.center.set(0,0,0),t.radius=.7071067811865476,t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){var e=this.planes,n=t.center;t=-t.radius;for(var r=0;6>r;r++)if(e[r].distanceToPoint(n)<t)return!1;return!0},intersectsBox:function(){var t=new u,e=new u;return function(n){for(var r=this.planes,i=0;6>i;i++){t.x=0<(a=r[i]).normal.x?n.min.x:n.max.x,e.x=0<a.normal.x?n.max.x:n.min.x,t.y=0<a.normal.y?n.min.y:n.max.y,e.y=0<a.normal.y?n.max.y:n.min.y,t.z=0<a.normal.z?n.min.z:n.max.z,e.z=0<a.normal.z?n.max.z:n.min.z;var o=a.distanceToPoint(t),a=a.distanceToPoint(e);if(0>o&&0>a)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,n=0;6>n;n++)if(0>e[n].distanceToPoint(t))return!1;return!0}}),tt.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" "),tt.DefaultOrder="XYZ",Object.defineProperties(tt.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback()}}}),Object.assign(tt.prototype,{isEuler:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._order=r||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var r=ii.clamp;t=(h=t.elements)[0];var i=h[4],o=h[8],a=h[1],s=h[5],u=h[9],c=h[2],l=h[6],h=h[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(r(o,-1,1)),.99999>Math.abs(o)?(this._x=Math.atan2(-u,h),this._z=Math.atan2(-i,t)):(this._x=Math.atan2(l,s),this._z=0)):"YXZ"===e?(this._x=Math.asin(-r(u,-1,1)),.99999>Math.abs(u)?(this._y=Math.atan2(o,h),this._z=Math.atan2(a,s)):(this._y=Math.atan2(-c,t),this._z=0)):"ZXY"===e?(this._x=Math.asin(r(l,-1,1)),.99999>Math.abs(l)?(this._y=Math.atan2(-c,h),this._z=Math.atan2(-i,s)):(this._y=0,this._z=Math.atan2(a,t))):"ZYX"===e?(this._y=Math.asin(-r(c,-1,1)),.99999>Math.abs(c)?(this._x=Math.atan2(l,h),this._z=Math.atan2(a,t)):(this._x=0,this._z=Math.atan2(-i,s))):"YZX"===e?(this._z=Math.asin(r(a,-1,1)),.99999>Math.abs(a)?(this._x=Math.atan2(-u,s),this._y=Math.atan2(-c,t)):(this._x=0,this._y=Math.atan2(o,h))):"XZY"===e?(this._z=Math.asin(-r(i,-1,1)),.99999>Math.abs(i)?(this._x=Math.atan2(l,s),this._y=Math.atan2(o,t)):(this._x=Math.atan2(-u,h),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:function(){var t=new c;return function(e,n,r){return t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,n,r)}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(){var t=new s;return function(e){return t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new u(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(et.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask=this.mask|1<<t|0},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},test:function(t){return 0!=(this.mask&t.mask)}});var wi=0;nt.DefaultUp=new u(0,1,0),nt.DefaultMatrixAutoUpdate=!0,Object.assign(nt.prototype,e.prototype,{isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new s;return function(e,n){return t.setFromAxisAngle(e,n),this.quaternion.multiply(t),this}}(),rotateX:function(){var t=new u(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new u(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new u(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new u;return function(e,n){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(n)),this}}(),translateX:function(){var t=new u(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new u(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new u(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new c;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new c;return function(e){this.isCamera?t.lookAt(this.position,e,this.up):t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}return-1!==(e=this.children.indexOf(t))&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(e,1)),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){return t=t||new u,this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new u,e=new u;return function(n){return n=n||new s,this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,n,e),n}}(),getWorldRotation:function(){var t=new s;return function(e){return e=e||new tt,this.getWorldQuaternion(t),e.setFromQuaternion(t,this.rotation.order,!1)}}(),getWorldScale:function(){var t=new u,e=new s;return function(n){return n=n||new u,this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,n),n}}(),getWorldDirection:function(){var t=new s;return function(e){return e=e||new u,this.getWorldQuaternion(t),e.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)},toJSON:function(t){function e(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}function n(t){var e,n=[];for(e in t){var r=t[e];delete r.metadata,n.push(r)}return n}var r=void 0===t||""===t,i={};r&&(t={geometries:{},materials:{},textures:{},images:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var o={};if(o.uuid=this.uuid,o.type=this.type,""!==this.name&&(o.name=this.name),"{}"!==JSON.stringify(this.userData)&&(o.userData=this.userData),!0===this.castShadow&&(o.castShadow=!0),!0===this.receiveShadow&&(o.receiveShadow=!0),!1===this.visible&&(o.visible=!1),o.matrix=this.matrix.toArray(),void 0!==this.geometry&&(o.geometry=e(t.geometries,this.geometry)),void 0!==this.material)if(Array.isArray(this.material)){for(var a=[],s=0,u=this.material.length;s<u;s++)a.push(e(t.materials,this.material[s]));o.material=a}else o.material=e(t.materials,this.material);if(0<this.children.length)for(o.children=[],s=0;s<this.children.length;s++)o.children.push(this.children[s].toJSON(t).object);return r&&(r=n(t.geometries),a=n(t.materials),s=n(t.textures),u=n(t.images),0<r.length&&(i.geometries=r),0<a.length&&(i.materials=a),0<s.length&&(i.textures=s),0<u.length&&(i.images=u)),i.object=o,i},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++)this.add(t.children[n].clone());return this}}),rt.prototype=Object.assign(Object.create(nt.prototype),{constructor:rt,isCamera:!0,copy:function(t,e){return nt.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},getWorldDirection:function(){var t=new s;return function(e){return e=e||new u,this.getWorldQuaternion(t),e.set(0,0,-1).applyQuaternion(t)}}(),updateMatrixWorld:function(t){nt.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),it.prototype=Object.assign(Object.create(rt.prototype),{constructor:it,isOrthographicCamera:!0,copy:function(t,e){return rt.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,r,i,o){this.view={fullWidth:t,fullHeight:e,offsetX:n,offsetY:r,width:i,height:o},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(e=(this.right+this.left)/2)-(n=(this.right-this.left)/(2*this.zoom)),e=e+n,n=(i=(this.top+this.bottom)/2)+(r=(this.top-this.bottom)/(2*this.zoom)),r=i-r;if(null!==this.view){var i,o=(this.right-this.left)/this.view.width;e=(t+=this.view.offsetX/(e=this.zoom/(this.view.width/this.view.fullWidth))*o)+this.view.width/e*o,r=(n-=this.view.offsetY/(r=this.zoom/(this.view.height/this.view.fullHeight))*(i=(this.top-this.bottom)/this.view.height))-this.view.height/r*i}this.projectionMatrix.makeOrthographic(t,e,n,r,this.near,this.far)},toJSON:function(t){return(t=nt.prototype.toJSON.call(this,t)).object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),ot.prototype=Object.assign(Object.create(rt.prototype),{constructor:ot,isPerspectiveCamera:!0,copy:function(t,e){return rt.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){t=.5*this.getFilmHeight()/t,this.fov=2*ii.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*ii.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*ii.RAD2DEG*Math.atan(Math.tan(.5*ii.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,r,i,o){this.aspect=t/e,this.view={fullWidth:t,fullHeight:e,offsetX:n,offsetY:r,width:i,height:o},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*ii.DEG2RAD*this.fov)/this.zoom,n=-.5*(a=this.aspect*(s=2*e)),r=this.view;if(null!==r)var i=r.fullWidth,o=r.fullHeight,a=(n+=r.offsetX*a/i,e-=r.offsetY*s/o,r.width/i*a),s=r.height/o*s;0!==(r=this.filmOffset)&&(n+=t*r/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+a,e,e-s,t,this.far)},toJSON:function(t){return(t=nt.prototype.toJSON.call(this,t)).object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),Object.assign(at.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var bi=0;Object.assign(st.prototype,e.prototype,{isGeometry:!0,applyMatrix:function(t){for(var e=(new Q).getNormalMatrix(t),n=0,r=this.vertices.length;n<r;n++)this.vertices[n].applyMatrix4(t);for(n=0,r=this.faces.length;n<r;n++){(t=this.faces[n]).normal.applyMatrix3(e).normalize();for(var i=0,o=t.vertexNormals.length;i<o;i++)t.vertexNormals[i].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.normalsNeedUpdate=this.verticesNeedUpdate=!0,this},rotateX:function(){var t=new c;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new c;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new c;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new c;return function(e,n,r){return t.makeTranslation(e,n,r),this.applyMatrix(t),this}}(),scale:function(){var t=new c;return function(e,n,r){return t.makeScale(e,n,r),this.applyMatrix(t),this}}(),lookAt:function(){var t=new nt;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),fromBufferGeometry:function(t){function e(t,e,n,i){i=new at(t,e,n,void 0!==s?[f[t].clone(),f[e].clone(),f[n].clone()]:[],void 0!==c?[r.colors[t].clone(),r.colors[e].clone(),r.colors[n].clone()]:[],i),r.faces.push(i),void 0!==l&&r.faceVertexUvs[0].push([d[t].clone(),d[e].clone(),d[n].clone()]),void 0!==h&&r.faceVertexUvs[1].push([p[t].clone(),p[e].clone(),p[n].clone()])}var r=this,i=null!==t.index?t.index.array:void 0,o=t.attributes,a=o.position.array,s=void 0!==o.normal?o.normal.array:void 0,c=void 0!==o.color?o.color.array:void 0,l=void 0!==o.uv?o.uv.array:void 0,h=void 0!==o.uv2?o.uv2.array:void 0;void 0!==h&&(this.faceVertexUvs[1]=[]);for(var f=[],d=[],p=[],m=o=0;o<a.length;o+=3,m+=2)r.vertices.push(new u(a[o],a[o+1],a[o+2])),void 0!==s&&f.push(new u(s[o],s[o+1],s[o+2])),void 0!==c&&r.colors.push(new V(c[o],c[o+1],c[o+2])),void 0!==l&&d.push(new n(l[m],l[m+1])),void 0!==h&&p.push(new n(h[m],h[m+1]));var g=t.groups;if(0<g.length)for(o=0;o<g.length;o++){m=v=(a=g[o]).start;for(var v=v+a.count;m<v;m+=3)void 0!==i?e(i[m],i[m+1],i[m+2],a.materialIndex):e(m,m+1,m+2,a.materialIndex)}else if(void 0!==i)for(o=0;o<i.length;o+=3)e(i[o],i[o+1],i[o+2]);else for(o=0;o<a.length/3;o+=3)e(o,o+1,o+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=0===(e=this.boundingSphere.radius)?1:1/e,n=new c;return n.set(e,0,0,-e*t.x,0,e,0,-e*t.y,0,0,e,-e*t.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var t=new u,e=new u,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],o=this.vertices[i.a],a=this.vertices[i.b];t.subVectors(this.vertices[i.c],a),e.subVectors(o,a),t.cross(e),t.normalize(),i.normal.copy(t)}},computeVertexNormals:function(t){var e,n,r;for(void 0===t&&(t=!0),r=Array(this.vertices.length),e=0,n=this.vertices.length;e<n;e++)r[e]=new u;if(t){var i,o,a=new u,s=new u;for(t=0,e=this.faces.length;t<e;t++)i=this.vertices[(n=this.faces[t]).a],a.subVectors(this.vertices[n.c],o=this.vertices[n.b]),s.subVectors(i,o),a.cross(s),r[n.a].add(a),r[n.b].add(a),r[n.c].add(a)}else for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++)r[(n=this.faces[t]).a].add(n.normal),r[n.b].add(n.normal),r[n.c].add(n.normal);for(e=0,n=this.vertices.length;e<n;e++)r[e].normalize();for(t=0,e=this.faces.length;t<e;t++)3===(i=(n=this.faces[t]).vertexNormals).length?(i[0].copy(r[n.a]),i[1].copy(r[n.b]),i[2].copy(r[n.c])):(i[0]=r[n.a].clone(),i[1]=r[n.b].clone(),i[2]=r[n.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,n;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){var r=(n=this.faces[t]).vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,n,r,i;for(n=0,r=this.faces.length;n<r;n++)for((i=this.faces[n]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),t=0,e=i.vertexNormals.length;t<e;t++)i.__originalVertexNormals[t]?i.__originalVertexNormals[t].copy(i.vertexNormals[t]):i.__originalVertexNormals[t]=i.vertexNormals[t].clone();var o=new st;for(o.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[],i=this.morphNormals[t].faceNormals;var a,s,c=this.morphNormals[t].vertexNormals;for(n=0,r=this.faces.length;n<r;n++)a=new u,s={a:new u,b:new u,c:new u},i.push(a),c.push(s)}for(c=this.morphNormals[t],o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals(),n=0,r=this.faces.length;n<r;n++)s=c.vertexNormals[n],(a=c.faceNormals[n]).copy((i=this.faces[n]).normal),s.a.copy(i.vertexNormals[0]),s.b.copy(i.vertexNormals[1]),s.c.copy(i.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)(i=this.faces[n]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeLineDistances:function(){for(var t=0,e=this.vertices,n=0,r=e.length;n<r;n++)0<n&&(t+=e[n].distanceTo(e[n-1])),this.lineDistances[n]=t},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new X),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new $),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(t&&t.isGeometry){var r,i=this.vertices.length,o=this.vertices,a=t.vertices,s=this.faces,u=t.faces,c=this.faceVertexUvs[0],l=t.faceVertexUvs[0],h=this.colors,f=t.colors;void 0===n&&(n=0),void 0!==e&&(r=(new Q).getNormalMatrix(e)),t=0;for(var d=a.length;t<d;t++){var p=a[t].clone();void 0!==e&&p.applyMatrix4(e),o.push(p)}for(t=0,d=f.length;t<d;t++)h.push(f[t].clone());for(t=0,d=u.length;t<d;t++){var m=(a=u[t]).vertexNormals;for(f=a.vertexColors,(h=new at(a.a+i,a.b+i,a.c+i)).normal.copy(a.normal),void 0!==r&&h.normal.applyMatrix3(r).normalize(),e=0,o=m.length;e<o;e++)p=m[e].clone(),void 0!==r&&p.applyMatrix3(r).normalize(),h.vertexNormals.push(p);for(h.color.copy(a.color),e=0,o=f.length;e<o;e++)h.vertexColors.push((p=f[e]).clone());h.materialIndex=a.materialIndex+n,s.push(h)}for(t=0,d=l.length;t<d;t++)if(r=[],void 0!==(n=l[t])){for(e=0,o=n.length;e<o;e++)r.push(n[e].clone());c.push(r)}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){var t,e,n,r={},i=[],o=[],a=Math.pow(10,4);for(e=0,n=this.vertices.length;e<n;e++)t=this.vertices[e],void 0===r[t=Math.round(t.x*a)+"_"+Math.round(t.y*a)+"_"+Math.round(t.z*a)]?(r[t]=e,i.push(this.vertices[e]),o[e]=i.length-1):o[e]=o[r[t]];for(r=[],e=0,n=this.faces.length;e<n;e++)for((a=this.faces[e]).a=o[a.a],a.b=o[a.b],a.c=o[a.c],a=[a.a,a.b,a.c],t=0;3>t;t++)if(a[t]===a[(t+1)%3]){r.push(e);break}for(e=r.length-1;0<=e;e--)for(this.faces.splice(a=r[e],1),o=0,n=this.faceVertexUvs.length;o<n;o++)this.faceVertexUvs[o].splice(a,1);return e=this.vertices.length-i.length,this.vertices=i,e},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,n=0;n<e;n++)t[n]._id=n;t.sort(function(t,e){return t.materialIndex-e.materialIndex});var r,i,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];for(o&&o.length===e&&(r=[]),a&&a.length===e&&(i=[]),n=0;n<e;n++){var s=t[n]._id;r&&r.push(o[s]),i&&i.push(a[s])}r&&(this.faceVertexUvs[0]=r),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){function t(t,e,n){return n?t|1<<e:t&~(1<<e)}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==c[e]?c[e]:(c[e]=u.length/3,u.push(t.x,t.y,t.z),c[e])}function n(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==h[e]?h[e]:(h[e]=l.length,l.push(t.getHex()),h[e])}function r(t){var e=t.x.toString()+t.y.toString();return void 0!==d[e]?d[e]:(d[e]=f.length/2,f.push(t.x,t.y),d[e])}var i={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),void 0!==this.parameters){var o,a=this.parameters;for(o in a)void 0!==a[o]&&(i[o]=a[o]);return i}for(a=[],o=0;o<this.vertices.length;o++)a.push((s=this.vertices[o]).x,s.y,s.z);var s=[],u=[],c={},l=[],h={},f=[],d={};for(o=0;o<this.faces.length;o++){var p=this.faces[o],m=void 0!==this.faceVertexUvs[0][o],g=0<p.normal.length(),v=0<p.vertexNormals.length,y=1!==p.color.r||1!==p.color.g||1!==p.color.b,w=0<p.vertexColors.length,b=t(b=t(b=t(b=t(b=t(b=t(b=t(b=t(b=0,0,0),1,!0),2,!1),3,m),4,g),5,v),6,y),7,w);s.push(b),s.push(p.a,p.b,p.c),s.push(p.materialIndex),m&&s.push(r((m=this.faceVertexUvs[0][o])[0]),r(m[1]),r(m[2])),g&&s.push(e(p.normal)),v&&s.push(e((g=p.vertexNormals)[0]),e(g[1]),e(g[2])),y&&s.push(n(p.color)),w&&s.push(n((p=p.vertexColors)[0]),n(p[1]),n(p[2]))}return i.data={},i.data.vertices=a,i.data.normals=u,0<l.length&&(i.data.colors=l),0<f.length&&(i.data.uvs=[f]),i.data.faces=s,i},clone:function(){return(new st).copy(this)},copy:function(t){var e,n,r,i,o,a;for(this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.name=t.name,e=0,n=(r=t.vertices).length;e<n;e++)this.vertices.push(r[e].clone());for(e=0,n=(r=t.colors).length;e<n;e++)this.colors.push(r[e].clone());for(e=0,n=(r=t.faces).length;e<n;e++)this.faces.push(r[e].clone());for(e=0,n=t.faceVertexUvs.length;e<n;e++){var s=t.faceVertexUvs[e];for(void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]),r=0,i=s.length;r<i;r++){var u=s[r],c=[];for(o=0,a=u.length;o<a;o++)c.push(u[o].clone());this.faceVertexUvs[e].push(c)}}for(e=0,n=(o=t.morphTargets).length;e<n;e++){if((a={}).name=o[e].name,void 0!==o[e].vertices)for(a.vertices=[],r=0,i=o[e].vertices.length;r<i;r++)a.vertices.push(o[e].vertices[r].clone());if(void 0!==o[e].normals)for(a.normals=[],r=0,i=o[e].normals.length;r<i;r++)a.normals.push(o[e].normals[r].clone());this.morphTargets.push(a)}for(e=0,n=(o=t.morphNormals).length;e<n;e++){if(a={},void 0!==o[e].vertexNormals)for(a.vertexNormals=[],r=0,i=o[e].vertexNormals.length;r<i;r++)(u={}).a=(s=o[e].vertexNormals[r]).a.clone(),u.b=s.b.clone(),u.c=s.c.clone(),a.vertexNormals.push(u);if(void 0!==o[e].faceNormals)for(a.faceNormals=[],r=0,i=o[e].faceNormals.length;r<i;r++)a.faceNormals.push(o[e].faceNormals[r].clone());this.morphNormals.push(a)}for(e=0,n=(r=t.skinWeights).length;e<n;e++)this.skinWeights.push(r[e].clone());for(e=0,n=(r=t.skinIndices).length;e<n;e++)this.skinIndices.push(r[e].clone());for(e=0,n=(r=t.lineDistances).length;e<n;e++)this.lineDistances.push(r[e]);return null!==(e=t.boundingBox)&&(this.boundingBox=e.clone()),null!==(e=t.boundingSphere)&&(this.boundingSphere=e.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(ut.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(ut.prototype,{isBufferAttribute:!0,setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.itemSize:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new V),e[n++]=o.r,e[n++]=o.g,e[n++]=o.b}return this},copyIndicesArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];e[n++]=o.a,e[n++]=o.b,e[n++]=o.c}return this},copyVector2sArray:function(t){for(var e=this.array,r=0,i=0,o=t.length;i<o;i++){var a=t[i];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),a=new n),e[r++]=a.x,e[r++]=a.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new u),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,r=0,o=t.length;r<o;r++){var a=t[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),a=new i),e[n++]=a.x,e[n++]=a.y,e[n++]=a.z,e[n++]=a.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return this.array[0+(t*=this.itemSize)]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,r){return this.array[0+(t*=this.itemSize)]=e,this.array[t+1]=n,this.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return this.array[0+(t*=this.itemSize)]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),(ct.prototype=Object.create(ut.prototype)).constructor=ct,(lt.prototype=Object.create(ut.prototype)).constructor=lt,(ht.prototype=Object.create(ut.prototype)).constructor=ht,(ft.prototype=Object.create(ut.prototype)).constructor=ft,(dt.prototype=Object.create(ut.prototype)).constructor=dt,(pt.prototype=Object.create(ut.prototype)).constructor=pt,(mt.prototype=Object.create(ut.prototype)).constructor=mt,(gt.prototype=Object.create(ut.prototype)).constructor=gt,(vt.prototype=Object.create(ut.prototype)).constructor=vt,Object.assign(yt.prototype,{computeGroups:function(t){var e,n=[],r=void 0;t=t.faces;for(var i=0;i<t.length;i++){var o=t[i];o.materialIndex!==r&&(r=o.materialIndex,void 0!==e&&(e.count=3*i-e.start,n.push(e)),e={start:3*i,materialIndex:r})}void 0!==e&&(e.count=3*i-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var e,r=t.faces,i=t.vertices,o=t.faceVertexUvs,a=o[0]&&0<o[0].length,s=o[1]&&0<o[1].length,u=t.morphTargets,c=u.length;if(0<c){e=[];for(var l=0;l<c;l++)e[l]=[];this.morphTargets.position=e}var h,f=t.morphNormals,d=f.length;if(0<d){for(h=[],l=0;l<d;l++)h[l]=[];this.morphTargets.normal=h}var p=t.skinIndices,m=t.skinWeights,g=p.length===i.length,v=m.length===i.length;for(l=0;l<r.length;l++){var y=r[l];this.vertices.push(i[y.a],i[y.b],i[y.c]);var w=y.vertexNormals;for(3===w.length?this.normals.push(w[0],w[1],w[2]):this.normals.push(w=y.normal,w,w),3===(w=y.vertexColors).length?this.colors.push(w[0],w[1],w[2]):this.colors.push(w=y.color,w,w),!0===a&&(void 0!==(w=o[0][l])?this.uvs.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new n,new n,new n))),!0===s&&(void 0!==(w=o[1][l])?this.uvs2.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new n,new n,new n))),w=0;w<c;w++){var b=u[w].vertices;e[w].push(b[y.a],b[y.b],b[y.c])}for(w=0;w<d;w++)h[w].push((b=f[w].vertexNormals[l]).a,b.b,b.c);g&&this.skinIndices.push(p[y.a],p[y.b],p[y.c]),v&&this.skinWeights.push(m[y.a],m[y.b],m[y.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}}),bt.MaxIndex=65535,Object.assign(bt.prototype,e.prototype,{isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){this.index=Array.isArray(t)?new(65535<wt(t)?mt:dt)(t,1):t},addAttribute:function(t,e,n){if(e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute){if("index"!==t)return this.attributes[t]=e,this;console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e)}else console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(t,new ut(e,n))},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;return void 0!==e&&(t.applyToBufferAttribute(e),e.needsUpdate=!0),void 0!==(e=this.attributes.normal)&&((new Q).getNormalMatrix(t).applyToBufferAttribute(e),e.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var t=new c;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new c;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new c;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new c;return function(e,n,r){return t.makeTranslation(e,n,r),this.applyMatrix(t),this}}(),scale:function(){var t=new c;return function(e,n,r){return t.makeScale(e,n,r),this.applyMatrix(t),this}}(),lookAt:function(){var t=new nt;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){t=new gt(3*e.vertices.length,3);var n=new gt(3*e.colors.length,3);this.addAttribute("position",t.copyVector3sArray(e.vertices)),this.addAttribute("color",n.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length&&(t=new gt(e.lineDistances.length,1),this.addAttribute("lineDistance",t.copyArray(e.lineDistances))),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},updateFromObject:function(t){var e=t.geometry;if(t.isMesh){var n=e.__directGeometry;if(!0===e.elementsNeedUpdate&&(n=void 0,e.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(e);n.verticesNeedUpdate=e.verticesNeedUpdate,n.normalsNeedUpdate=e.normalsNeedUpdate,n.colorsNeedUpdate=e.colorsNeedUpdate,n.uvsNeedUpdate=e.uvsNeedUpdate,n.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=n}return!0===e.verticesNeedUpdate&&(void 0!==(n=this.attributes.position)&&(n.copyVector3sArray(e.vertices),n.needsUpdate=!0),e.verticesNeedUpdate=!1),!0===e.normalsNeedUpdate&&(void 0!==(n=this.attributes.normal)&&(n.copyVector3sArray(e.normals),n.needsUpdate=!0),e.normalsNeedUpdate=!1),!0===e.colorsNeedUpdate&&(void 0!==(n=this.attributes.color)&&(n.copyColorsArray(e.colors),n.needsUpdate=!0),e.colorsNeedUpdate=!1),e.uvsNeedUpdate&&(void 0!==(n=this.attributes.uv)&&(n.copyVector2sArray(e.uvs),n.needsUpdate=!0),e.uvsNeedUpdate=!1),e.lineDistancesNeedUpdate&&(void 0!==(n=this.attributes.lineDistance)&&(n.copyArray(e.lineDistances),n.needsUpdate=!0),e.lineDistancesNeedUpdate=!1),e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new yt).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);for(var n in this.addAttribute("position",new ut(e,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(e=new Float32Array(3*t.normals.length),this.addAttribute("normal",new ut(e,3).copyVector3sArray(t.normals))),0<t.colors.length&&(e=new Float32Array(3*t.colors.length),this.addAttribute("color",new ut(e,3).copyColorsArray(t.colors))),0<t.uvs.length&&(e=new Float32Array(2*t.uvs.length),this.addAttribute("uv",new ut(e,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(e=new Float32Array(2*t.uvs2.length),this.addAttribute("uv2",new ut(e,2).copyVector2sArray(t.uvs2))),0<t.indices.length&&(e=new(65535<wt(t.indices)?Uint32Array:Uint16Array)(3*t.indices.length),this.setIndex(new ut(e,1).copyIndicesArray(t.indices))),this.groups=t.groups,t.morphTargets){e=[];for(var r=t.morphTargets[n],i=0,o=r.length;i<o;i++){var a=r[i],s=new gt(3*a.length,3);e.push(s.copyVector3sArray(a))}this.morphAttributes[n]=e}return 0<t.skinIndices.length&&(n=new gt(4*t.skinIndices.length,4),this.addAttribute("skinIndex",n.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(n=new gt(4*t.skinWeights.length,4),this.addAttribute("skinWeight",n.copyVector4sArray(t.skinWeights))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new X);var t=this.attributes.position;void 0!==t?this.boundingBox.setFromBufferAttribute(t):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var t=new X,e=new u;return function(){null===this.boundingSphere&&(this.boundingSphere=new $);var n=this.attributes.position;if(n){var r=this.boundingSphere.center;t.setFromBufferAttribute(n),t.getCenter(r);for(var i=0,o=0,a=n.count;o<a;o++)e.x=n.getX(o),e.y=n.getY(o),e.z=n.getZ(o),i=Math.max(i,r.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,n=this.groups;if(e.position){var r=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new ut(new Float32Array(r.length),3));else for(var i=0,o=(l=e.normal.array).length;i<o;i++)l[i]=0;var a,s,c,l=e.normal.array,h=new u,f=new u,d=new u,p=new u,m=new u;if(t){t=t.array,0===n.length&&this.addGroup(0,t.length);for(var g=0,v=n.length;g<v;++g)for(a=(i=n[g]).count,i=o=i.start,o+=a;i<o;i+=3)s=3*t[i+1],c=3*t[i+2],h.fromArray(r,a=3*t[i+0]),f.fromArray(r,s),d.fromArray(r,c),p.subVectors(d,f),m.subVectors(h,f),p.cross(m),l[a]+=p.x,l[a+1]+=p.y,l[a+2]+=p.z,l[s]+=p.x,l[s+1]+=p.y,l[s+2]+=p.z,l[c]+=p.x,l[c+1]+=p.y,l[c+2]+=p.z}else for(i=0,o=r.length;i<o;i+=9)h.fromArray(r,i),f.fromArray(r,i+3),d.fromArray(r,i+6),p.subVectors(d,f),m.subVectors(h,f),p.cross(m),l[i]=p.x,l[i+1]=p.y,l[i+2]=p.z,l[i+3]=p.x,l[i+4]=p.y,l[i+5]=p.z,l[i+6]=p.x,l[i+7]=p.y,l[i+8]=p.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0);var n,r=this.attributes;for(n in r)if(void 0!==t.attributes[n])for(var i=r[n].array,o=(s=t.attributes[n]).array,a=0,s=s.itemSize*e;a<o.length;a++,s++)i[s]=o[a];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t,e,n,r,i=this.attributes.normal,o=0,a=i.count;o<a;o++)t=i.getX(o),e=i.getY(o),n=i.getZ(o),r=1/Math.sqrt(t*t+e*e+n*n),i.setXYZ(o,t*r,e*r,n*r)},toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t,e=new bt,n=this.index.array,r=this.attributes;for(t in r){for(var i,o,a=(i=r[t]).array,s=new a.constructor(n.length*(i=i.itemSize)),u=0,c=0,l=n.length;c<l;c++){o=n[c]*i;for(var h=0;h<i;h++)s[u++]=a[o++]}e.addAttribute(t,new ut(s,i))}return e},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e,n=this.parameters;for(e in n)void 0!==n[e]&&(t[e]=n[e]);return t}t.data={attributes:{}};var r=this.index;for(e in null!==r&&(n=Array.prototype.slice.call(r.array),t.data.index={type:r.array.constructor.name,array:n}),r=this.attributes){var i=r[e];n=Array.prototype.slice.call(i.array),t.data.attributes[e]={itemSize:i.itemSize,type:i.array.constructor.name,array:n,normalized:i.normalized}}return 0<(e=this.groups).length&&(t.data.groups=JSON.parse(JSON.stringify(e))),null!==(e=this.boundingSphere)&&(t.data.boundingSphere={center:e.center.toArray(),radius:e.radius}),t},clone:function(){return(new bt).copy(this)},copy:function(t){var e,n,r;for(e in this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.name=t.name,null!==(n=t.index)&&this.setIndex(n.clone()),n=t.attributes)this.addAttribute(e,n[e].clone());var i=t.morphAttributes;for(e in i){var o=[],a=i[e];for(n=0,r=a.length;n<r;n++)o.push(a[n].clone());this.morphAttributes[e]=o}for(n=0,r=(e=t.groups).length;n<r;n++)this.addGroup((i=e[n]).start,i.count,i.materialIndex);return null!==(e=t.boundingBox)&&(this.boundingBox=e.clone()),null!==(e=t.boundingSphere)&&(this.boundingSphere=e.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(xt.prototype=Object.create(st.prototype)).constructor=xt,(_t.prototype=Object.create(bt.prototype)).constructor=_t,(Mt.prototype=Object.create(st.prototype)).constructor=Mt,(Et.prototype=Object.create(bt.prototype)).constructor=Et,(St.prototype=Object.create(G.prototype)).constructor=St,St.prototype.isMeshBasicMaterial=!0,St.prototype.copy=function(t){return G.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},Object.assign(Tt.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return(e||new u).copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(){var t=new u;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){var n=e||new u;n.subVectors(t,this.origin);var r=n.dot(this.direction);return 0>r?n.copy(this.origin):n.copy(this.direction).multiplyScalar(r).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new u;return function(e){var n=t.subVectors(e,this.origin).dot(this.direction);return 0>n?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(n).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:function(){var t=new u,e=new u,n=new u;return function(r,i,o,a){t.copy(r).add(i).multiplyScalar(.5),e.copy(i).sub(r).normalize(),n.copy(this.origin).sub(t);var s,u=.5*r.distanceTo(i),c=-this.direction.dot(e),l=n.dot(this.direction),h=-n.dot(e),f=n.lengthSq(),d=Math.abs(1-c*c);return 0<d?(i=c*l-h,s=u*d,0<=(r=c*h-l)?i>=-s?i<=s?c=(r*=u=1/d)*(r+c*(i*=u)+2*l)+i*(c*r+i+2*h)+f:(i=u,c=-(r=Math.max(0,-(c*i+l)))*r+i*(i+2*h)+f):(i=-u,c=-(r=Math.max(0,-(c*i+l)))*r+i*(i+2*h)+f):i<=-s?c=-(r=Math.max(0,-(-c*u+l)))*r+(i=0<r?-u:Math.min(Math.max(-u,-h),u))*(i+2*h)+f:i<=s?(r=0,c=(i=Math.min(Math.max(-u,-h),u))*(i+2*h)+f):c=-(r=Math.max(0,-(c*u+l)))*r+(i=0<r?u:Math.min(Math.max(-u,-h),u))*(i+2*h)+f):(i=0<c?-u:u,c=-(r=Math.max(0,-(c*i+l)))*r+i*(i+2*h)+f),o&&o.copy(this.direction).multiplyScalar(r).add(this.origin),a&&a.copy(e).multiplyScalar(i).add(t),c}}(),intersectSphere:function(){var t=new u;return function(e,n){t.subVectors(e.center,this.origin);var r=t.dot(this.direction),i=t.dot(t)-r*r,o=e.radius*e.radius;return i>o?null:(i=r-(o=Math.sqrt(o-i)),r+=o,0>i&&0>r?null:this.at(0>i?r:i,n))}}(),intersectsSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);return 0===e?0===t.distanceToPoint(this.origin)?0:null:0<=(t=-(this.origin.dot(t.normal)+t.constant)/e)?t:null},intersectPlane:function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||0>t.normal.dot(this.direction)*e},intersectBox:function(t,e){var n,r,i,o,a;o=1/this.direction.y,a=1/this.direction.z;var s=this.origin;return 0<=(r=1/this.direction.x)?(n=(t.min.x-s.x)*r,r*=t.max.x-s.x):(n=(t.max.x-s.x)*r,r*=t.min.x-s.x),0<=o?(i=(t.min.y-s.y)*o,o*=t.max.y-s.y):(i=(t.max.y-s.y)*o,o*=t.min.y-s.y),n>o||i>r?null:((i>n||n!=n)&&(n=i),(o<r||r!=r)&&(r=o),0<=a?(i=(t.min.z-s.z)*a,a*=t.max.z-s.z):(i=(t.max.z-s.z)*a,a*=t.min.z-s.z),n>a||i>r?null:((i>n||n!=n)&&(n=i),(a<r||r!=r)&&(r=a),0>r?null:this.at(0<=n?n:r,e)))},intersectsBox:function(){var t=new u;return function(e){return null!==this.intersectBox(e,t)}}(),intersectTriangle:function(){var t=new u,e=new u,n=new u,r=new u;return function(i,o,a,s,u){if(e.subVectors(o,i),n.subVectors(a,i),r.crossVectors(e,n),0<(o=this.direction.dot(r))){if(s)return null;s=1}else{if(!(0>o))return null;s=-1,o=-o}return t.subVectors(this.origin,i),0>(i=s*this.direction.dot(n.crossVectors(t,n)))?null:0>(a=s*this.direction.dot(e.cross(t)))||i+a>o?null:0>(i=-s*t.dot(r))?null:this.at(i/o,u)}}(),applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}}),Object.assign(At.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return(t||new u).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return(t||new u).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){var n=e||new u;return this.delta(n).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var t=new u,e=new u;return function(n,r){t.subVectors(n,this.start),e.subVectors(this.end,this.start);var i=e.dot(e);return i=e.dot(t)/i,r&&(i=ii.clamp(i,0,1)),i}}(),closestPointToPoint:function(t,e,n){return t=this.closestPointToPointParameter(t,e),n=n||new u,this.delta(n).multiplyScalar(t).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),Object.assign(kt,{normal:function(){var t=new u;return function(e,n,r,i){return(i=i||new u).subVectors(r,n),t.subVectors(e,n),i.cross(t),0<(e=i.lengthSq())?i.multiplyScalar(1/Math.sqrt(e)):i.set(0,0,0)}}(),barycoordFromPoint:function(){var t=new u,e=new u,n=new u;return function(r,i,o,a,s){t.subVectors(a,i),e.subVectors(o,i),n.subVectors(r,i),r=t.dot(t),i=t.dot(e),o=t.dot(n);var c=e.dot(e);a=e.dot(n);var l=r*c-i*i;return s=s||new u,0===l?s.set(-2,-1,-1):s.set(1-(c=(c*o-i*a)*(l=1/l))-(r=(r*a-i*o)*l),r,c)}}(),containsPoint:function(){var t=new u;return function(e,n,r,i){return 0<=(e=kt.barycoordFromPoint(e,n,r,i,t)).x&&0<=e.y&&1>=e.x+e.y}}()}),Object.assign(kt.prototype,{set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:function(){var t=new u,e=new u;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),midpoint:function(t){return(t||new u).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return kt.normal(this.a,this.b,this.c,t)},plane:function(t){return(t||new J).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return kt.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return kt.containsPoint(t,this.a,this.b,this.c)},closestPointToPoint:function(){var t=new J,e=[new At,new At,new At],n=new u,r=new u;return function(i,o){var a=o||new u,s=1/0;if(t.setFromCoplanarPoints(this.a,this.b,this.c),t.projectPoint(i,n),!0===this.containsPoint(n))a.copy(n);else{e[0].set(this.a,this.b),e[1].set(this.b,this.c),e[2].set(this.c,this.a);for(var c=0;c<e.length;c++){e[c].closestPointToPoint(n,!0,r);var l=n.distanceToSquared(r);l<s&&(s=l,a.copy(r))}}return a}}(),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}),Ct.prototype=Object.assign(Object.create(nt.prototype),{constructor:Ct,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return nt.prototype.copy.call(this,t),this.drawMode=t.drawMode,this},updateMorphTargets:function(){var t,e,n=this.geometry;if(n.isBufferGeometry){if(n=n.morphAttributes,0<(t=Object.keys(n)).length){var r=n[t[0]];if(void 0!==r)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},n=0,t=r.length;n<t;n++)e=r[n].name||String(n),this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=n}}else if(void 0!==(r=n.morphTargets)&&0<r.length)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},n=0,t=r.length;n<t;n++)e=r[n].name||String(n),this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=n},raycast:function(){function t(t,e,n,r,i,o,a){return kt.barycoordFromPoint(t,e,n,r,y),i.multiplyScalar(y.x),o.multiplyScalar(y.y),a.multiplyScalar(y.z),i.add(o).add(a),i.clone()}function e(t,e,n,r,i,o,a){var s=t.material;return null===(1===s.side?n.intersectTriangle(o,i,r,!0,a):n.intersectTriangle(r,i,o,2!==s.side,a))?null:(b.copy(a),b.applyMatrix4(t.matrixWorld),(n=e.ray.origin.distanceTo(b))<e.near||n>e.far?null:{distance:n,point:b.clone(),object:t})}function r(n,r,i,o,a,u,c,f){return s.fromBufferAttribute(o,u),l.fromBufferAttribute(o,c),h.fromBufferAttribute(o,f),(n=e(n,r,i,s,l,h,w))&&(a&&(m.fromBufferAttribute(a,u),g.fromBufferAttribute(a,c),v.fromBufferAttribute(a,f),n.uv=t(w,s,l,h,m,g,v)),n.face=new at(u,c,f,kt.normal(s,l,h)),n.faceIndex=u),n}var i=new c,o=new Tt,a=new $,s=new u,l=new u,h=new u,f=new u,d=new u,p=new u,m=new n,g=new n,v=new n,y=new u,w=new u,b=new u;return function(n,u){var c,y=this.geometry,b=this.matrixWorld;if(void 0!==(M=this.material)&&(null===y.boundingSphere&&y.computeBoundingSphere(),a.copy(y.boundingSphere),a.applyMatrix4(b),!1!==n.ray.intersectsSphere(a)&&(i.getInverse(b),o.copy(n.ray).applyMatrix4(i),null===y.boundingBox||!1!==o.intersectsBox(y.boundingBox))))if(y.isBufferGeometry){var x,_,M,E,S,T=y.attributes.position;if(b=y.attributes.uv,null!==(M=y.index))for(E=0,S=M.count;E<S;E+=3)y=M.getX(E),x=M.getX(E+1),_=M.getX(E+2),(c=r(this,n,o,T,b,y,x,_))&&(c.faceIndex=Math.floor(E/3),u.push(c));else for(E=0,S=T.count;E<S;E+=3)(c=r(this,n,o,T,b,y=E,x=E+1,_=E+2))&&(c.index=y,u.push(c))}else if(y.isGeometry){var A;b=Array.isArray(M),E=y.vertices,S=y.faces,0<(x=y.faceVertexUvs[0]).length&&(T=x);for(var k=0,C=S.length;k<C;k++){var R=S[k];if(void 0!==(c=b?M[R.materialIndex]:M)){if(x=E[R.a],_=E[R.b],A=E[R.c],!0===c.morphTargets){c=y.morphTargets;var D=this.morphTargetInfluences;s.set(0,0,0),l.set(0,0,0),h.set(0,0,0);for(var L=0,O=c.length;L<O;L++){var P=D[L];if(0!==P){var I=c[L].vertices;s.addScaledVector(f.subVectors(I[R.a],x),P),l.addScaledVector(d.subVectors(I[R.b],_),P),h.addScaledVector(p.subVectors(I[R.c],A),P)}}s.add(x),l.add(_),h.add(A),x=s,_=l,A=h}(c=e(this,n,o,x,_,A,w))&&(T&&T[k]&&(m.copy((D=T[k])[0]),g.copy(D[1]),v.copy(D[2]),c.uv=t(w,x,_,A,m,g,v)),c.face=R,c.faceIndex=k,u.push(c))}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var xi=0;Bt.prototype=Object.assign(Object.create(ot.prototype),{constructor:Bt,isArrayCamera:!0}),Wt.prototype.isFogExp2=!0,Wt.prototype.clone=function(){return new Wt(this.color.getHex(),this.density)},Wt.prototype.toJSON=function(t){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},Yt.prototype.isFog=!0,Yt.prototype.clone=function(){return new Yt(this.color.getHex(),this.near,this.far)},Yt.prototype.toJSON=function(t){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},Xt.prototype=Object.assign(Object.create(nt.prototype),{constructor:Xt,copy:function(t,e){return nt.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=nt.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}),$t.prototype=Object.assign(Object.create(nt.prototype),{constructor:$t,isLensFlare:!0,copy:function(t){nt.prototype.copy.call(this,t),this.positionScreen.copy(t.positionScreen),this.customUpdateCallback=t.customUpdateCallback;for(var e=0,n=t.lensFlares.length;e<n;e++)this.lensFlares.push(t.lensFlares[e]);return this},add:function(t,e,n,r,i,o){void 0===e&&(e=-1),void 0===n&&(n=0),void 0===o&&(o=1),void 0===i&&(i=new V(16777215)),void 0===r&&(r=1),n=Math.min(n,Math.max(0,n)),this.lensFlares.push({texture:t,size:e,distance:n,x:0,y:0,z:0,scale:1,rotation:0,opacity:o,color:i,blending:r})},updateLensFlares:function(){var t,e,n=this.lensFlares.length,r=2*-this.positionScreen.x,i=2*-this.positionScreen.y;for(t=0;t<n;t++)(e=this.lensFlares[t]).x=this.positionScreen.x+r*e.distance,e.y=this.positionScreen.y+i*e.distance,e.wantedRotation=e.x*Math.PI*.25,e.rotation+=.25*(e.wantedRotation-e.rotation)}}),(Qt.prototype=Object.create(G.prototype)).constructor=Qt,Qt.prototype.isSpriteMaterial=!0,Qt.prototype.copy=function(t){return G.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this},Jt.prototype=Object.assign(Object.create(nt.prototype),{constructor:Jt,isSprite:!0,raycast:function(){var t=new u,e=new u,n=new u;return function(r,i){e.setFromMatrixPosition(this.matrixWorld),r.ray.closestPointToPoint(e,t),n.setFromMatrixScale(this.matrixWorld);var o=n.x*n.y/4;e.distanceToSquared(t)>o||(o=r.ray.origin.distanceTo(t))<r.near||o>r.far||i.push({distance:o,point:t.clone(),face:null,object:this})}}(),clone:function(){return new this.constructor(this.material).copy(this)}}),Zt.prototype=Object.assign(Object.create(nt.prototype),{constructor:Zt,copy:function(t){nt.prototype.copy.call(this,t,!1);for(var e=0,n=(t=t.levels).length;e<n;e++){var r=t[e];this.addLevel(r.object.clone(),r.distance)}return this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var n=this.levels,r=0;r<n.length&&!(e<n[r].distance);r++);n.splice(r,0,{distance:e,object:t}),this.add(t)},getObjectForDistance:function(t){for(var e=this.levels,n=1,r=e.length;n<r&&!(t<e[n].distance);n++);return e[n-1].object},raycast:function(){var t=new u;return function(e,n){t.setFromMatrixPosition(this.matrixWorld);var r=e.ray.origin.distanceTo(t);this.getObjectForDistance(r).raycast(e,n)}}(),update:function(){var t=new u,e=new u;return function(n){var r=this.levels;if(1<r.length){t.setFromMatrixPosition(n.matrixWorld),e.setFromMatrixPosition(this.matrixWorld),n=t.distanceTo(e),r[0].object.visible=!0;for(var i=1,o=r.length;i<o&&n>=r[i].distance;i++)r[i-1].object.visible=!1,r[i].object.visible=!0;for(;i<o;i++)r[i].object.visible=!1}}}(),toJSON:function(t){(t=nt.prototype.toJSON.call(this,t)).object.levels=[];for(var e=this.levels,n=0,r=e.length;n<r;n++){var i=e[n];t.object.levels.push({object:i.object.uuid,distance:i.distance})}return t}}),Object.assign(Kt.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var n=new c;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},pose:function(){var t,e,n;for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){var t=new c,e=new c;return function(){for(var n=this.bones,r=this.boneInverses,i=this.boneMatrices,o=this.boneTexture,a=0,s=n.length;a<s;a++)t.multiplyMatrices(n[a]?n[a].matrixWorld:e,r[a]),t.toArray(i,16*a);void 0!==o&&(o.needsUpdate=!0)}}(),clone:function(){return new Kt(this.bones,this.boneInverses)}}),te.prototype=Object.assign(Object.create(nt.prototype),{constructor:te,isBone:!0}),ee.prototype=Object.assign(Object.create(Ct.prototype),{constructor:ee,isSkinnedMesh:!0,initBones:function(){var t,e,n,r,i=[];if(this.geometry&&void 0!==this.geometry.bones){for(n=0,r=this.geometry.bones.length;n<r;n++)e=this.geometry.bones[n],t=new te,i.push(t),t.name=e.name,t.position.fromArray(e.pos),t.quaternion.fromArray(e.rotq),void 0!==e.scl&&t.scale.fromArray(e.scl);for(n=0,r=this.geometry.bones.length;n<r;n++)-1!==(e=this.geometry.bones[n]).parent&&null!==e.parent&&void 0!==i[e.parent]?i[e.parent].add(i[n]):this.add(i[n])}return this.updateMatrixWorld(!0),i},bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var t,e;if(this.geometry&&this.geometry.isGeometry)for(e=0;e<this.geometry.skinWeights.length;e++)1/0!=(t=1/(n=this.geometry.skinWeights[e]).lengthManhattan())?n.multiplyScalar(t):n.set(1,0,0,0);else if(this.geometry&&this.geometry.isBufferGeometry){var n=new i,r=this.geometry.attributes.skinWeight;for(e=0;e<r.count;e++)n.x=r.getX(e),n.y=r.getY(e),n.z=r.getZ(e),n.w=r.getW(e),1/0!=(t=1/n.lengthManhattan())?n.multiplyScalar(t):n.set(1,0,0,0),r.setXYZW(e,n.x,n.y,n.z,n.w)}},updateMatrixWorld:function(t){Ct.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),(ne.prototype=Object.create(G.prototype)).constructor=ne,ne.prototype.isLineBasicMaterial=!0,ne.prototype.copy=function(t){return G.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},re.prototype=Object.assign(Object.create(nt.prototype),{constructor:re,isLine:!0,raycast:function(){var t=new c,e=new Tt,n=new $;return function(r,i){var o=(o=r.linePrecision)*o,a=this.matrixWorld;if(null===(p=this.geometry).boundingSphere&&p.computeBoundingSphere(),n.copy(p.boundingSphere),n.applyMatrix4(a),!1!==r.ray.intersectsSphere(n)){t.getInverse(a),e.copy(r.ray).applyMatrix4(t);var s=new u,c=new u,l=(a=new u,new u),h=this&&this.isLineSegments?2:1;if(p.isBufferGeometry){var f=p.attributes.position.array;if(null!==(d=p.index))for(var d,p=0,m=(d=d.array).length-1;p<m;p+=h){var g=d[p+1];s.fromArray(f,3*d[p]),c.fromArray(f,3*g),(g=e.distanceSqToSegment(s,c,l,a))>o||(l.applyMatrix4(this.matrixWorld),(g=r.ray.origin.distanceTo(l))<r.near||g>r.far||i.push({distance:g,point:a.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this}))}else for(p=0,m=f.length/3-1;p<m;p+=h)s.fromArray(f,3*p),c.fromArray(f,3*p+3),(g=e.distanceSqToSegment(s,c,l,a))>o||(l.applyMatrix4(this.matrixWorld),(g=r.ray.origin.distanceTo(l))<r.near||g>r.far||i.push({distance:g,point:a.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this}))}else if(p.isGeometry)for(c=(s=p.vertices).length,p=0;p<c-1;p+=h)(g=e.distanceSqToSegment(s[p],s[p+1],l,a))>o||(l.applyMatrix4(this.matrixWorld),(g=r.ray.origin.distanceTo(l))<r.near||g>r.far||i.push({distance:g,point:a.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this}))}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),ie.prototype=Object.assign(Object.create(re.prototype),{constructor:ie,isLineSegments:!0}),oe.prototype=Object.assign(Object.create(re.prototype),{constructor:oe,isLineLoop:!0}),(ae.prototype=Object.create(G.prototype)).constructor=ae,ae.prototype.isPointsMaterial=!0,ae.prototype.copy=function(t){return G.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this},se.prototype=Object.assign(Object.create(nt.prototype),{constructor:se,isPoints:!0,raycast:function(){var t=new c,e=new Tt,n=new $;return function(r,i){function o(t,n){var o=e.distanceSqToPoint(t);if(o<l){var u=e.closestPointToPoint(t);u.applyMatrix4(s);var c=r.ray.origin.distanceTo(u);c<r.near||c>r.far||i.push({distance:c,distanceToRay:Math.sqrt(o),point:u.clone(),index:n,face:null,object:a})}}var a=this,s=this.matrixWorld,c=r.params.Points.threshold;if(null===(f=this.geometry).boundingSphere&&f.computeBoundingSphere(),n.copy(f.boundingSphere),n.applyMatrix4(s),n.radius+=c,!1!==r.ray.intersectsSphere(n)){t.getInverse(s),e.copy(r.ray).applyMatrix4(t);var l=(c/=(this.scale.x+this.scale.y+this.scale.z)/3)*c;if(c=new u,f.isBufferGeometry){var h=f.index,f=f.attributes.position.array;if(null!==h)for(var d=h.array,p=(h=0,d.length);h<p;h++){var m=d[h];c.fromArray(f,3*m),o(c,m)}else for(h=0,d=f.length/3;h<d;h++)c.fromArray(f,3*h),o(c,h)}else for(h=0,d=(c=f.vertices).length;h<d;h++)o(c[h],h)}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),ue.prototype=Object.assign(Object.create(nt.prototype),{constructor:ue}),(ce.prototype=Object.create(r.prototype)).constructor=ce,(le.prototype=Object.create(r.prototype)).constructor=le,le.prototype.isCompressedTexture=!0,(he.prototype=Object.create(r.prototype)).constructor=he,(fe.prototype=Object.create(r.prototype)).constructor=fe,fe.prototype.isDepthTexture=!0,(de.prototype=Object.create(bt.prototype)).constructor=de,(pe.prototype=Object.create(st.prototype)).constructor=pe,(me.prototype=Object.create(bt.prototype)).constructor=me,(ge.prototype=Object.create(st.prototype)).constructor=ge,(ve.prototype=Object.create(bt.prototype)).constructor=ve,(ye.prototype=Object.create(st.prototype)).constructor=ye,(we.prototype=Object.create(ve.prototype)).constructor=we,(be.prototype=Object.create(st.prototype)).constructor=be,(xe.prototype=Object.create(ve.prototype)).constructor=xe,(_e.prototype=Object.create(st.prototype)).constructor=_e,(Me.prototype=Object.create(ve.prototype)).constructor=Me,(Ee.prototype=Object.create(st.prototype)).constructor=Ee,(Se.prototype=Object.create(ve.prototype)).constructor=Se,(Te.prototype=Object.create(st.prototype)).constructor=Te,(Ae.prototype=Object.create(bt.prototype)).constructor=Ae,(ke.prototype=Object.create(st.prototype)).constructor=ke,(Ce.prototype=Object.create(bt.prototype)).constructor=Ce,(Re.prototype=Object.create(st.prototype)).constructor=Re,(De.prototype=Object.create(bt.prototype)).constructor=De;var _i={area:function(t){for(var e=t.length,n=0,r=e-1,i=0;i<e;r=i++)n+=t[r].x*t[i].y-t[i].x*t[r].y;return.5*n},triangulate:function(t,e){var n=t.length;if(3>n)return null;var r,i,o,a=[],s=[],u=[];if(0<_i.area(t))for(i=0;i<n;i++)s[i]=i;else for(i=0;i<n;i++)s[i]=n-1-i;var c=2*n;for(i=n-1;2<n;){if(0>=c--){console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()");break}var l;n<=(r=i)&&(r=0),n<=(i=r+1)&&(i=0),n<=(o=i+1)&&(o=0);t:{var h,f,d,p,m,g,v,y;if(0>=((d=t[s[i]].x)-(h=t[s[r]].x))*((g=t[s[o]].y)-(f=t[s[r]].y))-((p=t[s[i]].y)-f)*((m=t[s[o]].x)-h))l=!1;else{var w,b,x,_,M,E,S,T,A,k;for(w=m-d,b=g-p,x=h-m,_=f-g,M=d-h,E=p-f,l=0;l<n;l++)if(y=t[s[l]].y,!((v=t[s[l]].x)===h&&y===f||v===d&&y===p||v===m&&y===g)&&(A=v-d,k=y-p,S=M*(T=y-f)-E*(S=v-h),T=x*(y-=g)-_*(v-=m),(A=w*k-b*A)>=-Number.EPSILON&&T>=-Number.EPSILON&&S>=-Number.EPSILON)){l=!1;break t}l=!0}}if(l){for(a.push([t[s[r]],t[s[i]],t[s[o]]]),u.push([s[r],s[i],s[o]]),r=i,o=i+1;o<n;r++,o++)s[r]=s[o];c=2*--n}}return e?u:a},triangulateShape:function(t,e){function n(t){var e=t.length;2<e&&t[e-1].equals(t[0])&&t.pop()}function r(t,e,n){return t.x!==e.x?t.x<e.x?t.x<=n.x&&n.x<=e.x:e.x<=n.x&&n.x<=t.x:t.y<e.y?t.y<=n.y&&n.y<=e.y:e.y<=n.y&&n.y<=t.y}function i(t,e,n,i,o){var a=e.x-t.x,s=e.y-t.y,u=i.x-n.x,c=i.y-n.y,l=t.x-n.x,h=t.y-n.y,f=s*u-a*c,d=s*l-a*h;if(Math.abs(f)>Number.EPSILON){if(0<f){if(0>d||d>f)return[];if(0>(u=c*l-u*h)||u>f)return[]}else{if(0<d||d<f)return[];if(0<(u=c*l-u*h)||u<f)return[]}return 0===u?!o||0!==d&&d!==f?[t]:[]:u===f?!o||0!==d&&d!==f?[e]:[]:0===d?[n]:d===f?[i]:[{x:t.x+(o=u/f)*a,y:t.y+o*s}]}return 0!==d||c*l!=u*h?[]:(s=0===a&&0===s,u=0===u&&0===c,s&&u?t.x!==n.x||t.y!==n.y?[]:[t]:s?r(n,i,t)?[t]:[]:u?r(t,e,n)?[n]:[]:(0!==a?(t.x<e.x?(a=t,u=t.x,s=e,t=e.x):(a=e,u=e.x,s=t,t=t.x),n.x<i.x?(e=n,f=n.x,c=i,n=i.x):(e=i,f=i.x,c=n,n=n.x)):(t.y<e.y?(a=t,u=t.y,s=e,t=e.y):(a=e,u=e.y,s=t,t=t.y),n.y<i.y?(e=n,f=n.y,c=i,n=i.y):(e=i,f=i.y,c=n,n=n.y)),u<=f?t<f?[]:t===f?o?[]:[e]:t<=n?[e,s]:[e,c]:u>n?[]:u===n?o?[]:[a]:t<=n?[a,s]:[a,c]))}function o(t,e,n,r){var i=e.x-t.x,o=e.y-t.y;e=n.x-t.x;var a=r.x-t.x;return r=r.y-t.y,t=i*(n=n.y-t.y)-o*e,i=i*r-o*a,Math.abs(t)>Number.EPSILON?(e=a*n-r*e,0<t?0<=i&&0<=e:0<=i||0<=e):0<i}n(t),e.forEach(n);var a,s,u,c,l,h={};for(u=t.concat(),a=0,s=e.length;a<s;a++)Array.prototype.push.apply(u,e[a]);for(a=0,s=u.length;a<s;a++)void 0!==h[l=u[a].x+":"+u[a].y]&&console.warn("THREE.ShapeUtils: Duplicate point",l,a),h[l]=a;a=function(t,e){function n(t,e){var n=g.length-1,r=t-1;0>r&&(r=n);var i=t+1;return i>n&&(i=0),!!(n=o(g[t],g[r],g[i],s[e]))&&(n=s.length-1,0>(r=e-1)&&(r=n),(i=e+1)>n&&(i=0),!!(n=o(s[e],s[r],s[i],g[t])))}function r(t,e){var n,r;for(n=0;n<g.length;n++)if(r=n+1,0<(r=i(t,e,g[n],g[r%=g.length],!0)).length)return!0;return!1}function a(t,n){var r,o,a,s;for(r=0;r<v.length;r++)for(o=e[v[r]],a=0;a<o.length;a++)if(s=a+1,0<(s=i(t,n,o[a],o[s%=o.length],!0)).length)return!0;return!1}var s,u,c,l,h,f,d,p,m,g=t.concat(),v=[],y=[],w=0;for(u=e.length;w<u;w++)v.push(w);d=0;for(var b=2*v.length;0<v.length;){if(0>--b){console.log("Infinite Loop! Holes left:"+v.length+", Probably Hole outside Shape!");break}for(c=d;c<g.length;c++){for(l=g[c],u=-1,w=0;w<v.length;w++)if(void 0===y[f=l.x+":"+l.y+":"+(h=v[w])]){for(s=e[h],p=0;p<s.length;p++)if(h=s[p],n(c,p)&&!r(l,h)&&!a(l,h)){u=p,v.splice(w,1),d=g.slice(0,c+1),h=g.slice(c),p=s.slice(u),m=s.slice(0,u+1),g=d.concat(p).concat(m).concat(h),d=c;break}if(0<=u)break;y[f]=!0}if(0<=u)break}}return g}(t,e);var f=_i.triangulate(a,!1);for(a=0,s=f.length;a<s;a++)for(c=f[a],u=0;3>u;u++)void 0!==(l=h[l=c[u].x+":"+c[u].y])&&(c[u]=l);return f.concat()},isClockWise:function(t){return 0>_i.area(t)}};(Le.prototype=Object.create(st.prototype)).constructor=Le,(Oe.prototype=Object.create(bt.prototype)).constructor=Oe,Oe.prototype.getArrays=function(){var t,e,n;return{position:t=(t=this.getAttribute("position"))?Array.prototype.slice.call(t.array):[],uv:e=(e=this.getAttribute("uv"))?Array.prototype.slice.call(e.array):[],index:n=(n=this.index)?Array.prototype.slice.call(n.array):[]}},Oe.prototype.addShapeList=function(t,e){var n=t.length;e.arrays=this.getArrays();for(var r=0;r<n;r++)this.addShape(t[r],e);this.setIndex(e.arrays.index),this.addAttribute("position",new gt(e.arrays.position,3)),this.addAttribute("uv",new gt(e.arrays.uv,2))},Oe.prototype.addShape=function(t,e){function r(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}function i(t,e,r){var i,o,a;i=r.x-t.x;var s=r.y-t.y,u=(o=t.x-e.x)*o+(a=t.y-e.y)*a;if(Math.abs(o*s-a*i)>Number.EPSILON){var c=Math.sqrt(u),l=Math.sqrt(i*i+s*s);if(2>=(a=(i=(u=e.x-a/c)+o*(s=((r.x-s/l-u)*s-(r.y+i/l-(e=e.y+o/c))*i)/(o*s-a*i))-t.x)*i+(o=e+a*s-t.y)*o))return new n(i,o);a=Math.sqrt(a/2)}else t=!1,o>Number.EPSILON?i>Number.EPSILON&&(t=!0):o<-Number.EPSILON?i<-Number.EPSILON&&(t=!0):Math.sign(a)===Math.sign(s)&&(t=!0),t?(i=-a,a=Math.sqrt(u)):(i=o,o=a,a=Math.sqrt(u/2));return new n(i/a,o/a)}function o(t,e){var n,r;for(G=t.length;0<=--G;){n=G,0>(r=G-1)&&(r=t.length-1);var i,o=T+2*M;for(i=0;i<o;i++){var a=H*i,s=e+r+a,u=e+r+(h=H*(i+1)),h=e+n+h;c(e+n+a),c(s),c(h),c(s),c(u),c(h),l((a=C.generateSideWallUV(O,g,(a=g.length/3)-6,a-3,a-2,a-1))[0]),l(a[1]),l(a[3]),l(a[1]),l(a[2]),l(a[3])}}}function a(t,e,n){w.push(t),w.push(e),w.push(n)}function s(t,e,n){c(t),c(e),c(n),l((t=C.generateTopUV(O,g,(t=g.length/3)-3,t-2,t-1))[0]),l(t[1]),l(t[2])}function c(t){v.push(g.length/3),g.push(w[3*t+0]),g.push(w[3*t+1]),g.push(w[3*t+2])}function l(t){y.push(t.x),y.push(t.y)}var h,f,d,p,m,g=(b=e.arrays?e.arrays:this.getArrays()).position,v=b.index,y=b.uv,w=[],b=void 0!==e.amount?e.amount:100,x=void 0!==e.bevelThickness?e.bevelThickness:6,_=void 0!==e.bevelSize?e.bevelSize:x-2,M=void 0!==e.bevelSegments?e.bevelSegments:3,E=void 0===e.bevelEnabled||e.bevelEnabled,S=void 0!==e.curveSegments?e.curveSegments:12,T=void 0!==e.steps?e.steps:1,A=e.extrudePath,k=!1,C=void 0!==e.UVGenerator?e.UVGenerator:Le.WorldUVGenerator;A&&(h=A.getSpacedPoints(T),k=!0,E=!1,f=void 0!==e.frames?e.frames:A.computeFrenetFrames(T,!1),d=new u,p=new u,m=new u),E||(_=x=M=0);var R,D,L,O=this,P=(A=t.extractPoints(S)).holes;if(!_i.isClockWise(S=A.shape))for(S=S.reverse(),D=0,L=P.length;D<L;D++)_i.isClockWise(R=P[D])&&(P[D]=R.reverse());var I=_i.triangulateShape(S,P),N=S;for(D=0,L=P.length;D<L;D++)S=S.concat(R=P[D]);var F,j,z,U,V,B,H=S.length,q=I.length,G=(A=[],0);for(F=(z=N.length)-1,j=G+1;G<z;G++,F++,j++)F===z&&(F=0),j===z&&(j=0),A[G]=i(N[G],N[F],N[j]);var W,Y=[],X=A.concat();for(D=0,L=P.length;D<L;D++){for(W=[],F=(z=(R=P[D]).length)-1,j=1+(G=0);G<z;G++,F++,j++)F===z&&(F=0),j===z&&(j=0),W[G]=i(R[G],R[F],R[j]);Y.push(W),X=X.concat(W)}for(F=0;F<M;F++){for(z=F/M,U=x*Math.cos(z*Math.PI/2),j=_*Math.sin(z*Math.PI/2),G=0,z=N.length;G<z;G++)a((V=r(N[G],A[G],j)).x,V.y,-U);for(D=0,L=P.length;D<L;D++)for(W=Y[D],G=0,z=(R=P[D]).length;G<z;G++)a((V=r(R[G],W[G],j)).x,V.y,-U)}for(j=_,G=0;G<H;G++)V=E?r(S[G],X[G],j):S[G],k?(p.copy(f.normals[0]).multiplyScalar(V.x),d.copy(f.binormals[0]).multiplyScalar(V.y),m.copy(h[0]).add(p).add(d),a(m.x,m.y,m.z)):a(V.x,V.y,0);for(z=1;z<=T;z++)for(G=0;G<H;G++)V=E?r(S[G],X[G],j):S[G],k?(p.copy(f.normals[z]).multiplyScalar(V.x),d.copy(f.binormals[z]).multiplyScalar(V.y),m.copy(h[z]).add(p).add(d),a(m.x,m.y,m.z)):a(V.x,V.y,b/T*z);for(F=M-1;0<=F;F--){for(z=F/M,U=x*Math.cos(z*Math.PI/2),j=_*Math.sin(z*Math.PI/2),G=0,z=N.length;G<z;G++)a((V=r(N[G],A[G],j)).x,V.y,b+U);for(D=0,L=P.length;D<L;D++)for(W=Y[D],G=0,z=(R=P[D]).length;G<z;G++)V=r(R[G],W[G],j),k?a(V.x,V.y+h[T-1].y,h[T-1].x+U):a(V.x,V.y,b+U)}!function(){var t=g.length/3;if(E){var n=0*H;for(G=0;G<q;G++)s((B=I[G])[2]+n,B[1]+n,B[0]+n);for(n=H*(T+2*M),G=0;G<q;G++)s((B=I[G])[0]+n,B[1]+n,B[2]+n)}else{for(G=0;G<q;G++)s((B=I[G])[2],B[1],B[0]);for(G=0;G<q;G++)s((B=I[G])[0]+H*T,B[1]+H*T,B[2]+H*T)}O.addGroup(t,g.length/3-t,void 0!==e.material?e.material:0)}(),function(){var t=g.length/3,n=0;for(o(N,n),n+=N.length,D=0,L=P.length;D<L;D++)o(R=P[D],n),n+=R.length;O.addGroup(t,g.length/3-t,void 0!==e.extrudeMaterial?e.extrudeMaterial:1)}(),e.arrays||(this.setIndex(v),this.addAttribute("position",new gt(g,3)),this.addAttribute("uv",new gt(e.arrays.uv,2)))},Le.WorldUVGenerator={generateTopUV:function(t,e,r,i,o){t=e[3*i],i=e[3*i+1];var a=e[3*o];return o=e[3*o+1],[new n(e[3*r],e[3*r+1]),new n(t,i),new n(a,o)]},generateSideWallUV:function(t,e,r,i,o,a){t=e[3*r];var s=e[3*r+1];r=e[3*r+2];var u=e[3*i],c=e[3*i+1];i=e[3*i+2];var l=e[3*o],h=e[3*o+1];o=e[3*o+2];var f=e[3*a],d=e[3*a+1];return e=e[3*a+2],.01>Math.abs(s-c)?[new n(t,1-r),new n(u,1-i),new n(l,1-o),new n(f,1-e)]:[new n(s,1-r),new n(c,1-i),new n(h,1-o),new n(d,1-e)]}},(Pe.prototype=Object.create(st.prototype)).constructor=Pe,(Ie.prototype=Object.create(Oe.prototype)).constructor=Ie,(Ne.prototype=Object.create(st.prototype)).constructor=Ne,(Fe.prototype=Object.create(bt.prototype)).constructor=Fe,(je.prototype=Object.create(st.prototype)).constructor=je,(ze.prototype=Object.create(bt.prototype)).constructor=ze,(Ue.prototype=Object.create(st.prototype)).constructor=Ue,(Ve.prototype=Object.create(bt.prototype)).constructor=Ve,(Be.prototype=Object.create(st.prototype)).constructor=Be,(He.prototype=Object.create(bt.prototype)).constructor=He,(qe.prototype=Object.create(bt.prototype)).constructor=qe,(Ge.prototype=Object.create(st.prototype)).constructor=Ge,(We.prototype=Object.create(bt.prototype)).constructor=We,(Ye.prototype=Object.create(Ge.prototype)).constructor=Ye,(Xe.prototype=Object.create(We.prototype)).constructor=Xe,($e.prototype=Object.create(st.prototype)).constructor=$e,(Qe.prototype=Object.create(bt.prototype)).constructor=Qe;var Mi=Object.freeze({WireframeGeometry:de,ParametricGeometry:pe,ParametricBufferGeometry:me,TetrahedronGeometry:ye,TetrahedronBufferGeometry:we,OctahedronGeometry:be,OctahedronBufferGeometry:xe,IcosahedronGeometry:_e,IcosahedronBufferGeometry:Me,DodecahedronGeometry:Ee,DodecahedronBufferGeometry:Se,PolyhedronGeometry:ge,PolyhedronBufferGeometry:ve,TubeGeometry:Te,TubeBufferGeometry:Ae,TorusKnotGeometry:ke,TorusKnotBufferGeometry:Ce,TorusGeometry:Re,TorusBufferGeometry:De,TextGeometry:Pe,TextBufferGeometry:Ie,SphereGeometry:Ne,SphereBufferGeometry:Fe,RingGeometry:je,RingBufferGeometry:ze,PlaneGeometry:Mt,PlaneBufferGeometry:Et,LatheGeometry:Ue,LatheBufferGeometry:Ve,ShapeGeometry:Be,ShapeBufferGeometry:He,ExtrudeGeometry:Le,ExtrudeBufferGeometry:Oe,EdgesGeometry:qe,ConeGeometry:Ye,ConeBufferGeometry:Xe,CylinderGeometry:Ge,CylinderBufferGeometry:We,CircleGeometry:$e,CircleBufferGeometry:Qe,BoxGeometry:xt,BoxBufferGeometry:_t});(Je.prototype=Object.create(W.prototype)).constructor=Je,Je.prototype.isShadowMaterial=!0,(Ze.prototype=Object.create(W.prototype)).constructor=Ze,Ze.prototype.isRawShaderMaterial=!0,(Ke.prototype=Object.create(G.prototype)).constructor=Ke,Ke.prototype.isMeshStandardMaterial=!0,Ke.prototype.copy=function(t){return G.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(tn.prototype=Object.create(Ke.prototype)).constructor=tn,tn.prototype.isMeshPhysicalMaterial=!0,tn.prototype.copy=function(t){return Ke.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearCoat=t.clearCoat,this.clearCoatRoughness=t.clearCoatRoughness,this},(en.prototype=Object.create(G.prototype)).constructor=en,en.prototype.isMeshPhongMaterial=!0,en.prototype.copy=function(t){return G.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(nn.prototype=Object.create(en.prototype)).constructor=nn,nn.prototype.isMeshToonMaterial=!0,nn.prototype.copy=function(t){return en.prototype.copy.call(this,t),this.gradientMap=t.gradientMap,this},(rn.prototype=Object.create(G.prototype)).constructor=rn,rn.prototype.isMeshNormalMaterial=!0,rn.prototype.copy=function(t){return G.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(on.prototype=Object.create(G.prototype)).constructor=on,on.prototype.isMeshLambertMaterial=!0,on.prototype.copy=function(t){return G.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(an.prototype=Object.create(G.prototype)).constructor=an,an.prototype.isLineDashedMaterial=!0,an.prototype.copy=function(t){return G.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Ei=Object.freeze({ShadowMaterial:Je,SpriteMaterial:Qt,RawShaderMaterial:Ze,ShaderMaterial:W,PointsMaterial:ae,MeshPhysicalMaterial:tn,MeshStandardMaterial:Ke,MeshPhongMaterial:en,MeshToonMaterial:nn,MeshNormalMaterial:rn,MeshLambertMaterial:on,MeshDepthMaterial:Y,MeshBasicMaterial:St,LineDashedMaterial:an,LineBasicMaterial:ne,Material:G}),Si={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},Ti=new sn;Object.assign(un.prototype,{load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t);var i=this,o=Si.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout(function(){e&&e(o),i.manager.itemEnd(t)},0),o;if(u=t.match(/^data:(.*?)(;base64)?,(.*)$/)){var a=u[1],s=!!u[2],u=u[3];u=window.decodeURIComponent(u),s&&(u=window.atob(u));try{var c,l=(this.responseType||"").toLowerCase();switch(l){case"arraybuffer":case"blob":c=new ArrayBuffer(u.length);var h=new Uint8Array(c);for(s=0;s<u.length;s++)h[s]=u.charCodeAt(s);"blob"===l&&(c=new Blob([c],{type:a}));break;case"document":c=(new DOMParser).parseFromString(u,a);break;case"json":c=JSON.parse(u);break;default:c=u}window.setTimeout(function(){e&&e(c),i.manager.itemEnd(t)},0)}catch(e){window.setTimeout(function(){r&&r(e),i.manager.itemEnd(t),i.manager.itemError(t)},0)}}else{var f=new XMLHttpRequest;for(a in f.open("GET",t,!0),f.addEventListener("load",function(n){var o=n.target.response;Si.add(t,o),200===this.status?(e&&e(o),i.manager.itemEnd(t)):0===this.status?(console.warn("THREE.FileLoader: HTTP Status 0 received."),e&&e(o),i.manager.itemEnd(t)):(r&&r(n),i.manager.itemEnd(t),i.manager.itemError(t))},!1),void 0!==n&&f.addEventListener("progress",function(t){n(t)},!1),f.addEventListener("error",function(e){r&&r(e),i.manager.itemEnd(t),i.manager.itemError(t)},!1),void 0!==this.responseType&&(f.responseType=this.responseType),void 0!==this.withCredentials&&(f.withCredentials=this.withCredentials),f.overrideMimeType&&f.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)f.setRequestHeader(a,this.requestHeader[a]);f.send(null)}return i.manager.itemStart(t),f},setPath:function(t){return this.path=t,this},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),Object.assign(cn.prototype,{load:function(t,e,n,r){function i(i){u.load(t[i],function(t){t=o._parser(t,!0),a[i]={width:t.width,height:t.height,format:t.format,mipmaps:t.mipmaps},6===(c+=1)&&(1===t.mipmapCount&&(s.minFilter=1006),s.format=t.format,s.needsUpdate=!0,e&&e(s))},n,r)}var o=this,a=[],s=new le;s.image=a;var u=new un(this.manager);if(u.setPath(this.path),u.setResponseType("arraybuffer"),Array.isArray(t))for(var c=0,l=0,h=t.length;l<h;++l)i(l);else u.load(t,function(t){if((t=o._parser(t,!0)).isCubemap)for(var n=t.mipmaps.length/t.mipmapCount,r=0;r<n;r++){a[r]={mipmaps:[]};for(var i=0;i<t.mipmapCount;i++)a[r].mipmaps.push(t.mipmaps[r*t.mipmapCount+i]),a[r].format=t.format,a[r].width=t.width,a[r].height=t.height}else s.image.width=t.width,s.image.height=t.height,s.mipmaps=t.mipmaps;1===t.mipmapCount&&(s.minFilter=1006),s.format=t.format,s.needsUpdate=!0,e&&e(s)},n,r);return s},setPath:function(t){return this.path=t,this}}),Object.assign(ln.prototype,{load:function(t,e,n,r){var i=this,o=new l,a=new un(this.manager);return a.setResponseType("arraybuffer"),a.load(t,function(t){(t=i._parser(t))&&(void 0!==t.image?o.image=t.image:void 0!==t.data&&(o.image.width=t.width,o.image.height=t.height,o.image.data=t.data),o.wrapS=void 0!==t.wrapS?t.wrapS:1001,o.wrapT=void 0!==t.wrapT?t.wrapT:1001,o.magFilter=void 0!==t.magFilter?t.magFilter:1006,o.minFilter=void 0!==t.minFilter?t.minFilter:1008,o.anisotropy=void 0!==t.anisotropy?t.anisotropy:1,void 0!==t.format&&(o.format=t.format),void 0!==t.type&&(o.type=t.type),void 0!==t.mipmaps&&(o.mipmaps=t.mipmaps),1===t.mipmapCount&&(o.minFilter=1006),o.needsUpdate=!0,e&&e(o,t))},n,r),o}}),Object.assign(hn.prototype,{load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t);var i=this,o=Si.get(t);return void 0!==o?(i.manager.itemStart(t),setTimeout(function(){e&&e(o),i.manager.itemEnd(t)},0),o):((n=document.createElementNS("http://www.w3.org/1999/xhtml","img")).addEventListener("load",function(){Si.add(t,this),e&&e(this),i.manager.itemEnd(t)},!1),n.addEventListener("error",function(e){r&&r(e),i.manager.itemEnd(t),i.manager.itemError(t)},!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(n.crossOrigin=this.crossOrigin),i.manager.itemStart(t),n.src=t,n)},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(fn.prototype,{load:function(t,e,n,r){function i(n){a.load(t[n],function(t){o.images[n]=t,6==++s&&(o.needsUpdate=!0,e&&e(o))},void 0,r)}var o=new h,a=new hn(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var s=0;for(n=0;n<t.length;++n)i(n);return o},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(dn.prototype,{load:function(t,e,n,i){var o=new hn(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=new r;return a.image=o.load(t,function(){var n=0<t.search(/\.(jpg|jpeg)$/)||0===t.search(/^data\:image\/jpeg/);a.format=n?1022:1023,a.needsUpdate=!0,void 0!==e&&e(a)},n,i),a},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),pn.prototype=Object.assign(Object.create(nt.prototype),{constructor:pn,isLight:!0,copy:function(t){return nt.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){return(t=nt.prototype.toJSON.call(this,t)).object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),mn.prototype=Object.assign(Object.create(pn.prototype),{constructor:mn,isHemisphereLight:!0,copy:function(t){return pn.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(gn.prototype,{copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),vn.prototype=Object.assign(Object.create(gn.prototype),{constructor:vn,isSpotLightShadow:!0,update:function(t){var e=this.camera,n=2*ii.RAD2DEG*t.angle,r=this.mapSize.width/this.mapSize.height;t=t.distance||e.far,n===e.fov&&r===e.aspect&&t===e.far||(e.fov=n,e.aspect=r,e.far=t,e.updateProjectionMatrix())}}),yn.prototype=Object.assign(Object.create(pn.prototype),{constructor:yn,isSpotLight:!0,copy:function(t){return pn.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),wn.prototype=Object.assign(Object.create(pn.prototype),{constructor:wn,isPointLight:!0,copy:function(t){return pn.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),bn.prototype=Object.assign(Object.create(gn.prototype),{constructor:bn}),xn.prototype=Object.assign(Object.create(pn.prototype),{constructor:xn,isDirectionalLight:!0,copy:function(t){return pn.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),_n.prototype=Object.assign(Object.create(pn.prototype),{constructor:_n,isAmbientLight:!0}),Mn.prototype=Object.assign(Object.create(pn.prototype),{constructor:Mn,isRectAreaLight:!0,copy:function(t){return pn.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){return(t=pn.prototype.toJSON.call(this,t)).object.width=this.width,t.object.height=this.height,t}});var Ai,ki={arraySlice:function(t,e,n){return ki.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,n=Array(e),r=0;r!==e;++r)n[r]=r;return n.sort(function(e,n){return t[e]-t[n]}),n},sortedArray:function(t,e,n){for(var r=t.length,i=new t.constructor(r),o=0,a=0;a!==r;++o)for(var s=n[o]*e,u=0;u!==e;++u)i[a++]=t[s+u];return i},flattenJSON:function(t,e,n,r){for(var i=1,o=t[0];void 0!==o&&void 0===o[r];)o=t[i++];if(void 0!==o){var a=o[r];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[r])&&(e.push(o.time),n.push.apply(n,a)),o=t[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[r])&&(e.push(o.time),a.toArray(n,n.length)),o=t[i++]}while(void 0!==o);else do{void 0!==(a=o[r])&&(e.push(o.time),n.push(a)),o=t[i++]}while(void 0!==o)}}};Object.assign(En.prototype,{evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{n:{r:if(!(t<r)){for(var o=n+2;;){if(void 0===r){if(t<i)break r;return this._cachedIndex=n=e.length,this.afterEnd_(n-1,t,i)}if(n===o)break;if(i=r,t<(r=e[++n]))break e}r=e.length;break n}if(t>=i)break t;for(t<(o=e[1])&&(n=2,i=o),o=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===o)break;if(r=i,t>=(i=e[--n-1]))break e}r=n,n=0}for(;n<r;)t<e[i=n+r>>>1]?r=i:n=i+1;if(r=e[n],void 0===(i=e[n-1]))return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return this._cachedIndex=n=e.length,this.afterEnd_(n-1,i,t)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize;t*=r;for(var i=0;i!==r;++i)e[i]=n[t+i];return e},interpolate_:function(t,e,n,r){throw Error("call to abstract method")},intervalChanged_:function(t,e,n){}}),Object.assign(En.prototype,{beforeStart_:En.prototype.copySampleValue_,afterEnd_:En.prototype.copySampleValue_}),Sn.prototype=Object.assign(Object.create(En.prototype),{constructor:Sn,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,e,n){var r=this.parameterPositions,i=t-2,o=t+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:i=t,a=2*e-n;break;case 2402:a=e+r[i=r.length-2]-r[i+1];break;default:i=t,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:o=t,s=2*n-e;break;case 2402:o=1,s=n+r[1]-r[0];break;default:o=t-1,s=e}r=this.valueSize,this._weightPrev=(t=.5*(n-e))/(e-a),this._weightNext=t/(s-n),this._offsetPrev=i*r,this._offsetNext=o*r},interpolate_:function(t,e,n,r){var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=(t*=a)-a,u=this._offsetPrev,c=this._offsetNext,l=this._weightPrev,h=this._weightNext,f=(n-e)/(r-e);for(e=-l*(r=(n=f*f)*f)+2*l*n-l*f,l=(1+l)*r+(-1.5-2*l)*n+(-.5+l)*f+1,f=(-1-h)*r+(1.5+h)*n+.5*f,h=h*r-h*n,n=0;n!==a;++n)i[n]=e*o[u+n]+l*o[s+n]+f*o[t+n]+h*o[c+n];return i}}),Tn.prototype=Object.assign(Object.create(En.prototype),{constructor:Tn,interpolate_:function(t,e,n,r){var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=(t*=a)-a;for(n=1-(e=(n-e)/(r-e)),r=0;r!==a;++r)i[r]=o[s+r]*n+o[t+r]*e;return i}}),An.prototype=Object.assign(Object.create(En.prototype),{constructor:An,interpolate_:function(t,e,n,r){return this.copySampleValue_(t-1)}}),Ai={TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(t){return new An(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new Tn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new Sn(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case 2300:e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){if(e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name,void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw Error(e);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrackPrototype:",e)}else this.createInterpolant=e},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]*=t;return this},trim:function(t,e){for(var n=this.times,r=n.length,i=0,o=r-1;i!==r&&n[i]<t;)++i;for(;-1!==o&&n[o]>e;)--o;return++o,0===i&&o===r||(i>=o&&(i=(o=Math.max(o,1))-1),r=this.getValueSize(),this.times=ki.arraySlice(n,i,o),this.values=ki.arraySlice(this.values,i*r,o*r)),this},validate:function(){var t=!0;0!=(n=this.getValueSize())-Math.floor(n)&&(console.error("THREE.KeyframeTrackPrototype: Invalid value size in track.",this),t=!1);var e=this.times,n=this.values,r=e.length;0===r&&(console.error("THREE.KeyframeTrackPrototype: Track is empty.",this),t=!1);for(var i=null,o=0;o!==r;o++){var a=e[o];if("number"==typeof a&&isNaN(a)){console.error("THREE.KeyframeTrackPrototype: Time is not a valid number.",this,o,a),t=!1;break}if(null!==i&&i>a){console.error("THREE.KeyframeTrackPrototype: Out of order keys.",this,o,a,i),t=!1;break}i=a}if(void 0!==n&&ki.isTypedArray(n))for(o=0,e=n.length;o!==e;++o)if(r=n[o],isNaN(r)){console.error("THREE.KeyframeTrackPrototype: Value is not a valid number.",this,o,r),t=!1;break}return t},optimize:function(){for(var t=this.times,e=this.values,n=this.getValueSize(),r=2302===this.getInterpolation(),i=1,o=t.length-1,a=1;a<o;++a){var s=!1;if((h=t[a])!==t[a+1]&&(1!==a||h!==h[0]))if(r)s=!0;else for(var u=a*n,c=u-n,l=u+n,h=0;h!==n;++h){var f=e[u+h];if(f!==e[c+h]||f!==e[l+h]){s=!0;break}}if(s){if(a!==i)for(t[i]=t[a],s=a*n,u=i*n,h=0;h!==n;++h)e[u+h]=e[s+h];++i}}if(0<o){for(t[i]=t[o],s=o*n,u=i*n,h=0;h!==n;++h)e[u+h]=e[s+h];++i}return i!==t.length&&(this.times=ki.arraySlice(t,0,i),this.values=ki.arraySlice(e,0,i*n)),this}},Cn.prototype=Object.assign(Object.create(Ai),{constructor:Cn,ValueTypeName:"vector"}),Rn.prototype=Object.assign(Object.create(En.prototype),{constructor:Rn,interpolate_:function(t,e,n,r){var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize;for(e=(n-e)/(r-e),n=(t*=a)+a;t!==n;t+=4)s.slerpFlat(i,0,o,t-a,o,t,e);return i}}),Dn.prototype=Object.assign(Object.create(Ai),{constructor:Dn,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(t){return new Rn(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),Ln.prototype=Object.assign(Object.create(Ai),{constructor:Ln,ValueTypeName:"number"}),On.prototype=Object.assign(Object.create(Ai),{constructor:On,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Pn.prototype=Object.assign(Object.create(Ai),{constructor:Pn,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),In.prototype=Object.assign(Object.create(Ai),{constructor:In,ValueTypeName:"color"}),Nn.prototype=Ai,Ai.constructor=Nn,Object.assign(Nn,{parse:function(t){if(void 0===t.type)throw Error("track type undefined, can not parse");var e=Nn._getTrackTypeForValueTypeName(t.type);if(void 0===t.times){var n=[],r=[];ki.flattenJSON(t.keys,n,r,"value"),t.times=n,t.values=r}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)},toJSON:function(t){if(void 0!==(e=t.constructor).toJSON)e=e.toJSON(t);else{var e={name:t.name,times:ki.convertArray(t.times,Array),values:ki.convertArray(t.values,Array)},n=t.getInterpolation();n!==t.DefaultInterpolation&&(e.interpolation=n)}return e.type=t.ValueTypeName,e},_getTrackTypeForValueTypeName:function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ln;case"vector":case"vector2":case"vector3":case"vector4":return Cn;case"color":return In;case"quaternion":return Dn;case"bool":case"boolean":return Pn;case"string":return On}throw Error("Unsupported typeName: "+t)}}),Object.assign(Fn,{parse:function(t){for(var e=[],n=t.tracks,r=1/(t.fps||1),i=0,o=n.length;i!==o;++i)e.push(Nn.parse(n[i]).scale(r));return new Fn(t.name,t.duration,e)},toJSON:function(t){var e=[],n=t.tracks;t={name:t.name,duration:t.duration,tracks:e};for(var r=0,i=n.length;r!==i;++r)e.push(Nn.toJSON(n[r]));return t},CreateFromMorphTargetSequence:function(t,e,n,r){for(var i=e.length,o=[],a=0;a<i;a++){var s=[];(c=[]).push((a+i-1)%i,a,(a+1)%i),s.push(0,1,0);var u=ki.getKeyframeOrder(c),c=ki.sortedArray(c,1,u);s=ki.sortedArray(s,1,u),r||0!==c[0]||(c.push(i),s.push(s[0])),o.push(new Ln(".morphTargetInfluences["+e[a].name+"]",c,s).scale(1/n))}return new Fn(t,-1,o)},findByName:function(t,e){var n=t;Array.isArray(t)||(n=t.geometry&&t.geometry.animations||t.animations);for(var r=0;r<n.length;r++)if(n[r].name===e)return n[r];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,o=0,a=t.length;o<a;o++){var s=t[o],u=s.name.match(i);if(u&&1<u.length){var c=u[1];(u=r[c])||(r[c]=u=[]),u.push(s)}}for(c in t=[],r)t.push(Fn.CreateFromMorphTargetSequence(c,r[c],e,n));return t},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(t,e,n,r,i){if(0!==n.length){var o=[],a=[];ki.flattenJSON(n,o,a,r),0!==o.length&&i.push(new t(e,o,a))}},r=[],i=t.name||"default",o=t.length||-1,a=t.fps||30,s=t.hierarchy||[],u=0;u<s.length;u++){var c=s[u].keys;if(c&&0!==c.length)if(c[0].morphTargets){o={};for(var l=0;l<c.length;l++)if(c[l].morphTargets)for(var h=0;h<c[l].morphTargets.length;h++)o[c[l].morphTargets[h]]=-1;for(var f in o){var d=[],p=[];for(h=0;h!==c[l].morphTargets.length;++h){var m=c[l];d.push(m.time),p.push(m.morphTarget===f?1:0)}r.push(new Ln(".morphTargetInfluence["+f+"]",d,p))}o=o.length*(a||1)}else n(Cn,(l=".bones["+e[u].name+"]")+".position",c,"pos",r),n(Dn,l+".quaternion",c,"rot",r),n(Cn,l+".scale",c,"scl",r)}return 0===r.length?null:new Fn(i,o,r)}}),Object.assign(Fn.prototype,{resetDuration:function(){for(var t=0,e=0,n=this.tracks.length;e!==n;++e){var r=this.tracks[e];t=Math.max(t,r.times[r.times.length-1])}this.duration=t},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}}),Object.assign(jn.prototype,{load:function(t,e,n,r){var i=this;new un(i.manager).load(t,function(t){e(i.parse(JSON.parse(t)))},n,r)},setTextures:function(t){this.textures=t},parse:function(t){function e(t){return void 0===r[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),r[t]}var r=this.textures,i=new Ei[t.type];if(void 0!==t.uuid&&(i.uuid=t.uuid),void 0!==t.name&&(i.name=t.name),void 0!==t.color&&i.color.setHex(t.color),void 0!==t.roughness&&(i.roughness=t.roughness),void 0!==t.metalness&&(i.metalness=t.metalness),void 0!==t.emissive&&i.emissive.setHex(t.emissive),void 0!==t.specular&&i.specular.setHex(t.specular),void 0!==t.shininess&&(i.shininess=t.shininess),void 0!==t.clearCoat&&(i.clearCoat=t.clearCoat),void 0!==t.clearCoatRoughness&&(i.clearCoatRoughness=t.clearCoatRoughness),void 0!==t.uniforms&&(i.uniforms=t.uniforms),void 0!==t.vertexShader&&(i.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(i.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(i.vertexColors=t.vertexColors),void 0!==t.fog&&(i.fog=t.fog),void 0!==t.shading&&(i.shading=t.shading),void 0!==t.blending&&(i.blending=t.blending),void 0!==t.side&&(i.side=t.side),void 0!==t.opacity&&(i.opacity=t.opacity),void 0!==t.transparent&&(i.transparent=t.transparent),void 0!==t.alphaTest&&(i.alphaTest=t.alphaTest),void 0!==t.depthTest&&(i.depthTest=t.depthTest),void 0!==t.depthWrite&&(i.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(i.colorWrite=t.colorWrite),void 0!==t.wireframe&&(i.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(i.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(i.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(i.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.skinning&&(i.skinning=t.skinning),void 0!==t.morphTargets&&(i.morphTargets=t.morphTargets),void 0!==t.size&&(i.size=t.size),void 0!==t.sizeAttenuation&&(i.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(i.map=e(t.map)),void 0!==t.alphaMap&&(i.alphaMap=e(t.alphaMap),i.transparent=!0),void 0!==t.bumpMap&&(i.bumpMap=e(t.bumpMap)),void 0!==t.bumpScale&&(i.bumpScale=t.bumpScale),void 0!==t.normalMap&&(i.normalMap=e(t.normalMap)),void 0!==t.normalScale){var o=t.normalScale;!1===Array.isArray(o)&&(o=[o,o]),i.normalScale=(new n).fromArray(o)}return void 0!==t.displacementMap&&(i.displacementMap=e(t.displacementMap)),void 0!==t.displacementScale&&(i.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(i.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(i.roughnessMap=e(t.roughnessMap)),void 0!==t.metalnessMap&&(i.metalnessMap=e(t.metalnessMap)),void 0!==t.emissiveMap&&(i.emissiveMap=e(t.emissiveMap)),void 0!==t.emissiveIntensity&&(i.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(i.specularMap=e(t.specularMap)),void 0!==t.envMap&&(i.envMap=e(t.envMap)),void 0!==t.reflectivity&&(i.reflectivity=t.reflectivity),void 0!==t.lightMap&&(i.lightMap=e(t.lightMap)),void 0!==t.lightMapIntensity&&(i.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(i.aoMap=e(t.aoMap)),void 0!==t.aoMapIntensity&&(i.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(i.gradientMap=e(t.gradientMap)),i}}),Object.assign(zn.prototype,{load:function(t,e,n,r){var i=this;new un(i.manager).load(t,function(t){e(i.parse(JSON.parse(t)))},n,r)},parse:function(t){var e=new bt;void 0!==(o=t.data.index)&&(o=new Ci[o.type](o.array),e.setIndex(new ut(o,1)));var n,r=t.data.attributes;for(n in r){var i=r[n],o=new Ci[i.type](i.array);e.addAttribute(n,new ut(o,i.itemSize,i.normalized))}if(void 0!==(n=t.data.groups||t.data.drawcalls||t.data.offsets))for(o=0,r=n.length;o!==r;++o)e.addGroup((i=n[o]).start,i.count,i.materialIndex);return void 0!==(t=t.data.boundingSphere)&&(n=new u,void 0!==t.center&&n.fromArray(t.center),e.boundingSphere=new $(n,t.radius)),e}});var Ci={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};Un.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,n=0,r=e.length;n<r;n+=2){var i=e[n+1];if(e[n].test(t))return i}return null}},Object.assign(Un.prototype,{crossOrigin:void 0,extractUrlBase:function(t){return 1===(t=t.split("/")).length?"./":(t.pop(),t.join("/")+"/")},initMaterials:function(t,e,n){for(var r=[],i=0;i<t.length;++i)r[i]=this.createMaterial(t[i],e,n);return r},createMaterial:function(){var t={NoBlending:0,NormalBlending:1,AdditiveBlending:2,SubtractiveBlending:3,MultiplyBlending:4,CustomBlending:5},e=new V,n=new dn,r=new jn;return function(i,o,a){function s(t,e,r,i,s){var u=Un.Handlers.get(t=o+t);return null!==u?t=u.load(t):(n.setCrossOrigin(a),t=n.load(t)),void 0!==e&&(t.repeat.fromArray(e),1!==e[0]&&(t.wrapS=1e3),1!==e[1]&&(t.wrapT=1e3)),void 0!==r&&t.offset.fromArray(r),void 0!==i&&("repeat"===i[0]&&(t.wrapS=1e3),"mirror"===i[0]&&(t.wrapS=1002),"repeat"===i[1]&&(t.wrapT=1e3),"mirror"===i[1]&&(t.wrapT=1002)),void 0!==s&&(t.anisotropy=s),e=ii.generateUUID(),c[e]=t,e}var u,c={},l={uuid:ii.generateUUID(),type:"MeshLambertMaterial"};for(u in i){var h=i[u];switch(u){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":l.name=h;break;case"blending":l.blending=t[h];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",u,"is no longer supported.");break;case"colorDiffuse":l.color=e.fromArray(h).getHex();break;case"colorSpecular":l.specular=e.fromArray(h).getHex();break;case"colorEmissive":l.emissive=e.fromArray(h).getHex();break;case"specularCoef":l.shininess=h;break;case"shading":"basic"===h.toLowerCase()&&(l.type="MeshBasicMaterial"),"phong"===h.toLowerCase()&&(l.type="MeshPhongMaterial"),"standard"===h.toLowerCase()&&(l.type="MeshStandardMaterial");break;case"mapDiffuse":l.map=s(h,i.mapDiffuseRepeat,i.mapDiffuseOffset,i.mapDiffuseWrap,i.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":l.emissiveMap=s(h,i.mapEmissiveRepeat,i.mapEmissiveOffset,i.mapEmissiveWrap,i.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":l.lightMap=s(h,i.mapLightRepeat,i.mapLightOffset,i.mapLightWrap,i.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":l.aoMap=s(h,i.mapAORepeat,i.mapAOOffset,i.mapAOWrap,i.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":l.bumpMap=s(h,i.mapBumpRepeat,i.mapBumpOffset,i.mapBumpWrap,i.mapBumpAnisotropy);break;case"mapBumpScale":l.bumpScale=h;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":l.normalMap=s(h,i.mapNormalRepeat,i.mapNormalOffset,i.mapNormalWrap,i.mapNormalAnisotropy);break;case"mapNormalFactor":l.normalScale=[h,h];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":l.specularMap=s(h,i.mapSpecularRepeat,i.mapSpecularOffset,i.mapSpecularWrap,i.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":l.metalnessMap=s(h,i.mapMetalnessRepeat,i.mapMetalnessOffset,i.mapMetalnessWrap,i.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":l.roughnessMap=s(h,i.mapRoughnessRepeat,i.mapRoughnessOffset,i.mapRoughnessWrap,i.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":l.alphaMap=s(h,i.mapAlphaRepeat,i.mapAlphaOffset,i.mapAlphaWrap,i.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":l.side=1;break;case"doubleSided":l.side=2;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),l.opacity=h;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":l[u]=h;break;case"vertexColors":!0===h&&(l.vertexColors=2),"face"===h&&(l.vertexColors=1);break;default:console.error("THREE.Loader.createMaterial: Unsupported",u,h)}}return"MeshBasicMaterial"===l.type&&delete l.emissive,"MeshPhongMaterial"!==l.type&&delete l.specular,1>l.opacity&&(l.transparent=!0),r.setTextures(c),r.parse(l)}}()}),Object.assign(Vn.prototype,{load:function(t,e,n,r){var i=this,o=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:Un.prototype.extractUrlBase(t),a=new un(this.manager);a.setWithCredentials(this.withCredentials),a.load(t,function(n){var r=(n=JSON.parse(n)).metadata;if(void 0!==r&&void 0!==(r=r.type)){if("object"===r.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.");if("scene"===r.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.SceneLoader instead.")}n=i.parse(n,o),e(n.geometry,n.materials)},n,r)},setTexturePath:function(t){this.texturePath=t},parse:function(t,e){void 0!==t.data&&(t=t.data),t.scale=void 0!==t.scale?1/t.scale:1;var r,o,a,s,c,l,h,f,d,p,m,g,v,y,w=new st,b=t,x=b.faces;d=b.vertices;var _=b.normals,M=b.colors;l=b.scale;var E=0;if(void 0!==b.uvs){for(r=0;r<b.uvs.length;r++)b.uvs[r].length&&E++;for(r=0;r<E;r++)w.faceVertexUvs[r]=[]}for(s=0,c=d.length;s<c;)(r=new u).x=d[s++]*l,r.y=d[s++]*l,r.z=d[s++]*l,w.vertices.push(r);for(s=0,c=x.length;s<c;)if(p=1&(d=x[s++]),a=2&d,r=8&d,h=16&d,m=32&d,l=64&d,d&=128,p){if((p=new at).a=x[s],p.b=x[s+1],p.c=x[s+3],(g=new at).a=x[s+1],g.b=x[s+2],g.c=x[s+3],s+=4,a&&(a=x[s++],p.materialIndex=a,g.materialIndex=a),a=w.faces.length,r)for(r=0;r<E;r++)for(v=b.uvs[r],w.faceVertexUvs[r][a]=[],w.faceVertexUvs[r][a+1]=[],o=0;4>o;o++)y=new n(y=v[2*(f=x[s++])],f=v[2*f+1]),2!==o&&w.faceVertexUvs[r][a].push(y),0!==o&&w.faceVertexUvs[r][a+1].push(y);if(h&&(h=3*x[s++],p.normal.set(_[h++],_[h++],_[h]),g.normal.copy(p.normal)),m)for(r=0;4>r;r++)h=3*x[s++],m=new u(_[h++],_[h++],_[h]),2!==r&&p.vertexNormals.push(m),0!==r&&g.vertexNormals.push(m);if(l&&(l=x[s++],p.color.setHex(l=M[l]),g.color.setHex(l)),d)for(r=0;4>r;r++)l=M[l=x[s++]],2!==r&&p.vertexColors.push(new V(l)),0!==r&&g.vertexColors.push(new V(l));w.faces.push(p),w.faces.push(g)}else{if((p=new at).a=x[s++],p.b=x[s++],p.c=x[s++],a&&(a=x[s++],p.materialIndex=a),a=w.faces.length,r)for(r=0;r<E;r++)for(v=b.uvs[r],w.faceVertexUvs[r][a]=[],o=0;3>o;o++)y=new n(y=v[2*(f=x[s++])],f=v[2*f+1]),w.faceVertexUvs[r][a].push(y);if(h&&(h=3*x[s++],p.normal.set(_[h++],_[h++],_[h])),m)for(r=0;3>r;r++)h=3*x[s++],m=new u(_[h++],_[h++],_[h]),p.vertexNormals.push(m);if(l&&(l=x[s++],p.color.setHex(M[l])),d)for(r=0;3>r;r++)l=x[s++],p.vertexColors.push(new V(M[l]));w.faces.push(p)}if(s=void 0!==(b=t).influencesPerVertex?b.influencesPerVertex:2,b.skinWeights)for(c=0,x=b.skinWeights.length;c<x;c+=s)w.skinWeights.push(new i(b.skinWeights[c],1<s?b.skinWeights[c+1]:0,2<s?b.skinWeights[c+2]:0,3<s?b.skinWeights[c+3]:0));if(b.skinIndices)for(c=0,x=b.skinIndices.length;c<x;c+=s)w.skinIndices.push(new i(b.skinIndices[c],1<s?b.skinIndices[c+1]:0,2<s?b.skinIndices[c+2]:0,3<s?b.skinIndices[c+3]:0));if(w.bones=b.bones,w.bones&&0<w.bones.length&&(w.skinWeights.length!==w.skinIndices.length||w.skinIndices.length!==w.vertices.length)&&console.warn("When skinning, number of vertices ("+w.vertices.length+"), skinIndices ("+w.skinIndices.length+"), and skinWeights ("+w.skinWeights.length+") should match."),x=(c=t).scale,void 0!==c.morphTargets)for(b=0,s=c.morphTargets.length;b<s;b++)for(w.morphTargets[b]={},w.morphTargets[b].name=c.morphTargets[b].name,w.morphTargets[b].vertices=[],_=w.morphTargets[b].vertices,E=0,d=(M=c.morphTargets[b].vertices).length;E<d;E+=3)(l=new u).x=M[E]*x,l.y=M[E+1]*x,l.z=M[E+2]*x,_.push(l);if(void 0!==c.morphColors&&0<c.morphColors.length)for(console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.'),c=c.morphColors[0].colors,b=0,s=(x=w.faces).length;b<s;b++)x[b].color.fromArray(c,3*b);for(b=[],s=[],void 0!==(c=t).animation&&s.push(c.animation),void 0!==c.animations&&(c.animations.length?s=s.concat(c.animations):s.push(c.animations)),c=0;c<s.length;c++)(x=Fn.parseAnimation(s[c],w.bones))&&b.push(x);return w.morphTargets&&(s=Fn.CreateClipsFromMorphTargetSequences(w.morphTargets,10),b=b.concat(s)),0<b.length&&(w.animations=b),w.computeFaceNormals(),w.computeBoundingSphere(),void 0===t.materials||0===t.materials.length?{geometry:w}:{geometry:w,materials:b=Un.prototype.initMaterials(t.materials,e,this.crossOrigin)}}}),Object.assign(Bn.prototype,{load:function(t,e,n,r){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var i=this;new un(i.manager).load(t,function(n){var o=null;try{o=JSON.parse(n)}catch(e){return void 0!==r&&r(e),void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}void 0===(n=o.metadata)||void 0===n.type||"geometry"===n.type.toLowerCase()?console.error("THREE.ObjectLoader: Can't load "+t+". Use THREE.JSONLoader instead."):i.parse(o,e)},n,r)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var n=this.parseGeometries(t.geometries),r=this.parseImages(t.images,function(){void 0!==e&&e(i)}),i=(r=this.parseTextures(t.textures,r),r=this.parseMaterials(t.materials,r),this.parseObject(t.object,n,r));return t.animations&&(i.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0===e||e(i),i},parseGeometries:function(t){var e={};if(void 0!==t)for(var n=new Vn,r=new zn,i=0,o=t.length;i<o;i++){var a,s=t[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new Mi[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new Mi[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new Mi[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new Mi[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new Mi[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new Mi[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"IcosahedronGeometry":case"OctahedronGeometry":case"TetrahedronGeometry":a=new Mi[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new Mi[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new Mi[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new Mi[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"LatheGeometry":case"LatheBufferGeometry":a=new Mi[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"BufferGeometry":a=r.parse(s);break;case"Geometry":a=n.parse(s,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),e[s.uuid]=a}return e},parseMaterials:function(t,e){var n={};if(void 0!==t){var r=new jn;r.setTextures(e);for(var i=0,o=t.length;i<o;i++){var a=t[i];if("MultiMaterial"===a.type){for(var s=[],u=0;u<a.materials.length;u++)s.push(r.parse(a.materials[u]));n[a.uuid]=s}else n[a.uuid]=r.parse(a)}}return n},parseAnimations:function(t){for(var e=[],n=0;n<t.length;n++){var r=Fn.parse(t[n]);e.push(r)}return e},parseImages:function(t,e){function n(t){return r.manager.itemStart(t),o.load(t,function(){r.manager.itemEnd(t)},void 0,function(){r.manager.itemEnd(t),r.manager.itemError(t)})}var r=this,i={};if(void 0!==t&&0<t.length){var o=new hn(a=new sn(e));o.setCrossOrigin(this.crossOrigin);for(var a=0,s=t.length;a<s;a++){var u=t[a],c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u.url)?u.url:r.texturePath+u.url;i[u.uuid]=n(c)}}return i},parseTextures:function(t,e){function n(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var i={};if(void 0!==t)for(var o=0,a=t.length;o<a;o++){var s=t[o];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===e[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image);var u=new r(e[s.image]);u.needsUpdate=!0,u.uuid=s.uuid,void 0!==s.name&&(u.name=s.name),void 0!==s.mapping&&(u.mapping=n(s.mapping,Ri)),void 0!==s.offset&&u.offset.fromArray(s.offset),void 0!==s.repeat&&u.repeat.fromArray(s.repeat),void 0!==s.wrap&&(u.wrapS=n(s.wrap[0],Di),u.wrapT=n(s.wrap[1],Di)),void 0!==s.minFilter&&(u.minFilter=n(s.minFilter,Li)),void 0!==s.magFilter&&(u.magFilter=n(s.magFilter,Li)),void 0!==s.anisotropy&&(u.anisotropy=s.anisotropy),void 0!==s.flipY&&(u.flipY=s.flipY),i[s.uuid]=u}return i},parseObject:function(){var t=new c;return function(e,n,r){function i(t){return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),n[t]}function o(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],n=0,i=t.length;n<i;n++){var o=t[n];void 0===r[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),e.push(r[o])}return e}return void 0===r[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),r[t]}}var a;switch(e.type){case"Scene":a=new Xt,void 0!==e.background&&Number.isInteger(e.background)&&(a.background=new V(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?a.fog=new Yt(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(a.fog=new Wt(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":a=new ot(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(a.focus=e.focus),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.filmGauge&&(a.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(a.filmOffset=e.filmOffset),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new it(e.left,e.right,e.top,e.bottom,e.near,e.far);break;case"AmbientLight":a=new _n(e.color,e.intensity);break;case"DirectionalLight":a=new xn(e.color,e.intensity);break;case"PointLight":a=new wn(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new Mn(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new yn(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new mn(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":a=i(e.geometry);var s=o(e.material);a=a.bones&&0<a.bones.length?new ee(a,s):new Ct(a,s);break;case"LOD":a=new Zt;break;case"Line":a=new re(i(e.geometry),o(e.material),e.mode);break;case"LineLoop":a=new oe(i(e.geometry),o(e.material));break;case"LineSegments":a=new ie(i(e.geometry),o(e.material));break;case"PointCloud":case"Points":a=new se(i(e.geometry),o(e.material));break;case"Sprite":a=new Jt(o(e.material));break;case"Group":a=new ue;break;default:a=new nt}if(a.uuid=e.uuid,void 0!==e.name&&(a.name=e.name),void 0!==e.matrix?(t.fromArray(e.matrix),t.decompose(a.position,a.quaternion,a.scale)):(void 0!==e.position&&a.position.fromArray(e.position),void 0!==e.rotation&&a.rotation.fromArray(e.rotation),void 0!==e.quaternion&&a.quaternion.fromArray(e.quaternion),void 0!==e.scale&&a.scale.fromArray(e.scale)),void 0!==e.castShadow&&(a.castShadow=e.castShadow),void 0!==e.receiveShadow&&(a.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(a.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(a.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&a.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(a.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.userData&&(a.userData=e.userData),void 0!==e.children)for(var u in e.children)a.add(this.parseObject(e.children[u],n,r));if("LOD"===e.type)for(e=e.levels,s=0;s<e.length;s++){var c=e[s];void 0!==(u=a.getObjectByProperty("uuid",c.object))&&a.addLevel(u,c.distance)}return a}}()});var Ri={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},Di={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},Li={NearestFilter:1003,NearestMipMapNearestFilter:1004,NearestMipMapLinearFilter:1005,LinearFilter:1006,LinearMipMapNearestFilter:1007,LinearMipMapLinearFilter:1008};Object.assign(Wn.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t){return t=this.getUtoTmapping(t),this.getPoint(t)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n,r=[],i=this.getPoint(0),o=0;for(r.push(0),n=1;n<=t;n++)o+=(e=this.getPoint(n/t)).distanceTo(i),r.push(o),i=e;return this.cacheArcLengths=r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var n,r,i=this.getLengths(),o=i.length;r=e||t*i[o-1];for(var a,s=0,u=o-1;s<=u;)if(0>(a=i[n=Math.floor(s+(u-s)/2)]-r))s=n+1;else{if(!(0<a)){u=n;break}u=n-1}return i[n=u]===r?n/(o-1):(n+(r-(s=i[n]))/(i[n+1]-s))/(o-1)},getTangent:function(t){var e=t-1e-4;return t+=1e-4,0>e&&(e=0),1<t&&(t=1),e=this.getPoint(e),this.getPoint(t).clone().sub(e).normalize()},getTangentAt:function(t){return t=this.getUtoTmapping(t),this.getTangent(t)},computeFrenetFrames:function(t,e){var n,r,i=new u,o=[],a=[],s=[],l=new u,h=new c;for(n=0;n<=t;n++)o[n]=this.getTangentAt(r=n/t),o[n].normalize();a[0]=new u,s[0]=new u,n=Number.MAX_VALUE,r=Math.abs(o[0].x);var f=Math.abs(o[0].y),d=Math.abs(o[0].z);for(r<=n&&(n=r,i.set(1,0,0)),f<=n&&(n=f,i.set(0,1,0)),d<=n&&i.set(0,0,1),l.crossVectors(o[0],i).normalize(),a[0].crossVectors(o[0],l),s[0].crossVectors(o[0],a[0]),n=1;n<=t;n++)a[n]=a[n-1].clone(),s[n]=s[n-1].clone(),l.crossVectors(o[n-1],o[n]),l.length()>Number.EPSILON&&(l.normalize(),i=Math.acos(ii.clamp(o[n-1].dot(o[n]),-1,1)),a[n].applyMatrix4(h.makeRotationAxis(l,i))),s[n].crossVectors(o[n],a[n]);if(!0===e)for(i=Math.acos(ii.clamp(a[0].dot(a[t]),-1,1)),i/=t,0<o[0].dot(l.crossVectors(a[0],a[t]))&&(i=-i),n=1;n<=t;n++)a[n].applyMatrix4(h.makeRotationAxis(o[n],i*n)),s[n].crossVectors(o[n],a[n]);return{tangents:o,normals:a,binormals:s}}}),(Yn.prototype=Object.create(Wn.prototype)).constructor=Yn,Yn.prototype.isLineCurve=!0,Yn.prototype.getPoint=function(t){if(1===t)return this.v2.clone();var e=this.v2.clone().sub(this.v1);return e.multiplyScalar(t).add(this.v1),e},Yn.prototype.getPointAt=function(t){return this.getPoint(t)},Yn.prototype.getTangent=function(t){return this.v2.clone().sub(this.v1).normalize()},Xn.prototype=Object.assign(Object.create(Wn.prototype),{constructor:Xn,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Yn(e,t))},getPoint:function(t){var e=t*this.getLength(),n=this.getCurveLengths();for(t=0;t<n.length;){if(n[t]>=e)return e=n[t]-e,n=(t=this.curves[t]).getLength(),t.getPointAt(0===n?0:1-e/n);t++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,n=[],r=0,i=this.curves;r<i.length;r++)for(var o=(o=i[r]).getPoints(o&&o.isEllipseCurve?2*t:o&&o.isLineCurve?1:o&&o.isSplineCurve?t*o.points.length:t),a=0;a<o.length;a++){var s=o[a];e&&e.equals(s)||(n.push(s),e=s)}return this.autoClose&&1<n.length&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},createPointsGeometry:function(t){return t=this.getPoints(t),this.createGeometry(t)},createSpacedPointsGeometry:function(t){return t=this.getSpacedPoints(t),this.createGeometry(t)},createGeometry:function(t){for(var e=new st,n=0,r=t.length;n<r;n++){var i=t[n];e.vertices.push(new u(i.x,i.y,i.z||0))}return e}}),($n.prototype=Object.create(Wn.prototype)).constructor=$n,$n.prototype.isEllipseCurve=!0,$n.prototype.getPoint=function(t){for(var e=2*Math.PI,r=this.aEndAngle-this.aStartAngle,i=Math.abs(r)<Number.EPSILON;0>r;)r+=e;for(;r>e;)r-=e;r<Number.EPSILON&&(r=i?0:e),!0!==this.aClockwise||i||(r=r===e?-e:r-e),e=this.aStartAngle+t*r,t=this.aX+this.xRadius*Math.cos(e);var o=this.aY+this.yRadius*Math.sin(e);return 0!==this.aRotation&&(e=Math.cos(this.aRotation),r=Math.sin(this.aRotation),t=(i=t-this.aX)*e-(o-=this.aY)*r+this.aX,o=i*r+o*e+this.aY),new n(t,o)},(Qn.prototype=Object.create(Wn.prototype)).constructor=Qn,Qn.prototype.isSplineCurve=!0,Qn.prototype.getPoint=function(t){var e,r=(r=((e=this.points).length-1)*t)-(t=Math.floor(r)),i=e[0===t?t:t-1],o=e[t],a=e[t>e.length-2?e.length-1:t+1];return new n(Hn(r,i.x,o.x,a.x,(e=e[t>e.length-3?e.length-1:t+2]).x),Hn(r,i.y,o.y,a.y,e.y))},(Jn.prototype=Object.create(Wn.prototype)).constructor=Jn,Jn.prototype.getPoint=function(t){var e=this.v0,r=this.v1,i=this.v2,o=this.v3;return new n(Gn(t,e.x,r.x,i.x,o.x),Gn(t,e.y,r.y,i.y,o.y))},(Zn.prototype=Object.create(Wn.prototype)).constructor=Zn,Zn.prototype.getPoint=function(t){var e=this.v0,r=this.v1,i=this.v2;return new n(qn(t,e.x,r.x,i.x),qn(t,e.y,r.y,i.y))};var Oi=Object.assign(Object.create(Xn.prototype),{fromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y)},moveTo:function(t,e){this.currentPoint.set(t,e)},lineTo:function(t,e){var r=new Yn(this.currentPoint.clone(),new n(t,e));this.curves.push(r),this.currentPoint.set(t,e)},quadraticCurveTo:function(t,e,r,i){t=new Zn(this.currentPoint.clone(),new n(t,e),new n(r,i)),this.curves.push(t),this.currentPoint.set(r,i)},bezierCurveTo:function(t,e,r,i,o,a){t=new Jn(this.currentPoint.clone(),new n(t,e),new n(r,i),new n(o,a)),this.curves.push(t),this.currentPoint.set(o,a)},splineThru:function(t){var e=new Qn(e=[this.currentPoint.clone()].concat(t));this.curves.push(e),this.currentPoint.copy(t[t.length-1])},arc:function(t,e,n,r,i,o){this.absarc(t+this.currentPoint.x,e+this.currentPoint.y,n,r,i,o)},absarc:function(t,e,n,r,i,o){this.absellipse(t,e,n,n,r,i,o)},ellipse:function(t,e,n,r,i,o,a,s){this.absellipse(t+this.currentPoint.x,e+this.currentPoint.y,n,r,i,o,a,s)},absellipse:function(t,e,n,r,i,o,a,s){t=new $n(t,e,n,r,i,o,a,s),0<this.curves.length&&((e=t.getPoint(0)).equals(this.currentPoint)||this.lineTo(e.x,e.y)),this.curves.push(t),t=t.getPoint(1),this.currentPoint.copy(t)}});Kn.prototype=Oi,Oi.constructor=Kn,tr.prototype=Object.assign(Object.create(Oi),{constructor:tr,getPointsHoles:function(t){for(var e=[],n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e},extractAllPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},extractPoints:function(t){return this.extractAllPoints(t)}}),Object.assign(er.prototype,{moveTo:function(t,e){this.currentPath=new Kn,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e)},lineTo:function(t,e){this.currentPath.lineTo(t,e)},quadraticCurveTo:function(t,e,n,r){this.currentPath.quadraticCurveTo(t,e,n,r)},bezierCurveTo:function(t,e,n,r,i,o){this.currentPath.bezierCurveTo(t,e,n,r,i,o)},splineThru:function(t){this.currentPath.splineThru(t)},toShapes:function(t,e){function n(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n],o=new tr;o.curves=i.curves,e.push(o)}return e}function r(t,e){for(var n=e.length,r=!1,i=n-1,o=0;o<n;i=o++){var a=e[i],s=e[o],u=s.x-a.x,c=s.y-a.y;if(Math.abs(c)>Number.EPSILON){if(0>c&&(a=e[o],u=-u,s=e[i],c=-c),!(t.y<a.y||t.y>s.y))if(t.y===a.y){if(t.x===a.x)return!0}else{if(0==(i=c*(t.x-a.x)-u*(t.y-a.y)))return!0;0>i||(r=!r)}}else if(t.y===a.y&&(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x))return!0}return r}var i=_i.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===e)return n(o);var a,s,u,c=[];if(1===o.length)return s=o[0],(u=new tr).curves=s.curves,c.push(u),c;var l=!i(o[0].getPoints());l=t?!l:l,u=[];var h,f=[],d=[],p=0;f[p]=void 0,d[p]=[];for(var m=0,g=o.length;m<g;m++)a=i(h=(s=o[m]).getPoints()),(a=t?!a:a)?(!l&&f[p]&&p++,f[p]={s:new tr,p:h},f[p].s.curves=s.curves,l&&p++,d[p]=[]):d[p].push({h:s,p:h[0]});if(!f[0])return n(o);if(1<f.length){for(m=!1,s=[],i=0,o=f.length;i<o;i++)u[i]=[];for(i=0,o=f.length;i<o;i++)for(a=d[i],l=0;l<a.length;l++){for(p=a[l],h=!0,g=0;g<f.length;g++)r(p.p,f[g].p)&&(i!==g&&s.push({froms:i,tos:g,hole:l}),h?(h=!1,u[g].push(p)):m=!0);h&&u[i].push(p)}0<s.length&&(m||(d=u))}for(m=0,i=f.length;m<i;m++)for(c.push(u=f[m].s),o=0,a=(s=d[m]).length;o<a;o++)u.holes.push(s[o].h);return c}}),Object.assign(nr.prototype,{isFont:!0,generateShapes:function(t,e,n){void 0===e&&(e=100),void 0===n&&(n=4);var r=this.data;t=String(t).split("");var i=e/r.resolution,o=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*i,a=0,s=0;e=[];for(var u=0;u<t.length;u++){var c=t[u];if("\n"===c)a=0,s-=o;else{var l;l=i;var h=a,f=s;if(c=r.glyphs[c]||r.glyphs["?"]){var d,p,m,g,v,y,w,b,x=new er,_=[];if(c.o)for(var M=c._cachedOutline||(c._cachedOutline=c.o.split(" ")),E=0,S=M.length;E<S;)switch(M[E++]){case"m":d=M[E++]*l+h,p=M[E++]*l+f,x.moveTo(d,p);break;case"l":d=M[E++]*l+h,p=M[E++]*l+f,x.lineTo(d,p);break;case"q":if(d=M[E++]*l+h,p=M[E++]*l+f,v=M[E++]*l+h,y=M[E++]*l+f,x.quadraticCurveTo(v,y,d,p),g=_[_.length-1]){m=g.x,g=g.y;for(var T=1;T<=n;T++){var A=T/n;qn(A,m,v,d),qn(A,g,y,p)}}break;case"b":if(d=M[E++]*l+h,p=M[E++]*l+f,v=M[E++]*l+h,y=M[E++]*l+f,w=M[E++]*l+h,b=M[E++]*l+f,x.bezierCurveTo(v,y,w,b,d,p),g=_[_.length-1])for(m=g.x,g=g.y,T=1;T<=n;T++)Gn(A=T/n,m,v,w,d),Gn(A,g,y,b,p)}l={offsetX:c.ha*l,path:x}}else l=void 0;a+=l.offsetX,e.push(l.path)}}for(n=[],r=0,t=e.length;r<t;r++)Array.prototype.push.apply(n,e[r].toShapes());return n}}),Object.assign(rr.prototype,{load:function(t,e,n,r){var i=this;new un(this.manager).load(t,function(t){var n;try{n=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}t=i.parse(n),e&&e(t)},n,r)},parse:function(t){return new nr(t)}});var Pi,Ii,Ni,Fi={getContext:function(){return void 0===Pi&&(Pi=new(window.AudioContext||window.webkitAudioContext)),Pi},setContext:function(t){Pi=t}};Object.assign(ir.prototype,{load:function(t,e,n,r){var i=new un(this.manager);i.setResponseType("arraybuffer"),i.load(t,function(t){Fi.getContext().decodeAudioData(t,function(t){e(t)})},n,r)}}),Object.assign(or.prototype,{update:function(){var t,e,n,r,i,o,a,s,u=new c,l=new c;return function(c){if(t!==this||e!==c.focus||n!==c.fov||r!==c.aspect*this.aspect||i!==c.near||o!==c.far||a!==c.zoom||s!==this.eyeSep){t=this,e=c.focus,n=c.fov,r=c.aspect*this.aspect,i=c.near,o=c.far,a=c.zoom;var h,f,d=c.projectionMatrix.clone(),p=(s=this.eyeSep/2)*i/e,m=i*Math.tan(ii.DEG2RAD*n*.5)/a;l.elements[12]=-s,u.elements[12]=s,d.elements[0]=2*i/((f=m*r+p)-(h=-m*r+p)),d.elements[8]=(f+h)/(f-h),this.cameraL.projectionMatrix.copy(d),d.elements[0]=2*i/((f=m*r-p)-(h=-m*r-p)),d.elements[8]=(f+h)/(f-h),this.cameraR.projectionMatrix.copy(d)}this.cameraL.matrixWorld.copy(c.matrixWorld).multiply(l),this.cameraR.matrixWorld.copy(c.matrixWorld).multiply(u)}}()}),(ar.prototype=Object.create(nt.prototype)).constructor=ar,sr.prototype=Object.assign(Object.create(nt.prototype),{constructor:sr,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(t){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){this.gain.gain.value=t},updateMatrixWorld:function(){var t=new u,e=new s,n=new u,r=new u;return function(i){nt.prototype.updateMatrixWorld.call(this,i),i=this.context.listener;var o=this.up;this.matrixWorld.decompose(t,e,n),r.set(0,0,-1).applyQuaternion(e),i.positionX?(i.positionX.setValueAtTime(t.x,this.context.currentTime),i.positionY.setValueAtTime(t.y,this.context.currentTime),i.positionZ.setValueAtTime(t.z,this.context.currentTime),i.forwardX.setValueAtTime(r.x,this.context.currentTime),i.forwardY.setValueAtTime(r.y,this.context.currentTime),i.forwardZ.setValueAtTime(r.z,this.context.currentTime),i.upX.setValueAtTime(o.x,this.context.currentTime),i.upY.setValueAtTime(o.y,this.context.currentTime),i.upZ.setValueAtTime(o.z,this.context.currentTime)):(i.setPosition(t.x,t.y,t.z),i.setOrientation(r.x,r.y,r.z,o.x,o.y,o.z))}}()}),ur.prototype=Object.assign(Object.create(nt.prototype),{constructor:ur,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else{if(!1!==this.hasPlaybackControl){var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.onended=this.onEnded.bind(this),t.playbackRate.setValueAtTime(this.playbackRate,this.startTime),t.start(0,this.startTime),this.isPlaying=!0,this.source=t,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}},pause:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.startTime=this.context.currentTime,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.startTime=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.value=t,this}}),cr.prototype=Object.assign(Object.create(ur.prototype),{constructor:cr,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){this.panner.refDistance=t},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){this.panner.rolloffFactor=t},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){this.panner.distanceModel=t},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){this.panner.maxDistance=t},updateMatrixWorld:function(){var t=new u;return function(e){nt.prototype.updateMatrixWorld.call(this,e),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}()}),Object.assign(lr.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),n=0;n<e.length;n++)t+=e[n];return t/e.length}}),Object.assign(hr.prototype,{accumulate:function(t,e){var n=this.buffer,r=this.valueSize,i=t*r+r,o=this.cumulativeWeight;if(0===o){for(o=0;o!==r;++o)n[i+o]=n[o];o=e}else this._mixBufferRegion(n,i,0,e/(o+=e),r);this.cumulativeWeight=o},apply:function(t){var e=this.valueSize,n=this.buffer;t=t*e+e;var r=this.cumulativeWeight,i=this.binding;this.cumulativeWeight=0,1>r&&this._mixBufferRegion(n,t,3*e,1-r,e),r=e;for(var o=e+e;r!==o;++r)if(n[r]!==n[r+e]){i.setValue(n,t);break}},saveOriginalState:function(){var t=this.buffer,e=this.valueSize,n=3*e;this.binding.getValue(t,n);for(var r=e;r!==n;++r)t[r]=t[n+r%e];this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_select:function(t,e,n,r,i){if(.5<=r)for(r=0;r!==i;++r)t[e+r]=t[n+r]},_slerp:function(t,e,n,r){s.slerpFlat(t,e,t,e,t,n,r)},_lerp:function(t,e,n,r,i){for(var o=1-r,a=0;a!==i;++a){var s=e+a;t[s]=t[s]*o+t[n+a]*r}}}),Object.assign(fr.prototype,{getValue:function(t,e){this.bind();var n=this._bindings[this._targetGroup.nCachedObjects_];void 0!==n&&n.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),Object.assign(dr,{Composite:fr,create:function(t,e,n){return t&&t.isAnimationObjectGroup?new dr.Composite(t,e,n):new dr(t,e,n)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(/[^\w-]/g,"")},parseTrackName:function(){var t=new RegExp("^"+/((?:[\w-]+[\/:])*)/.source+/([\w-\.]+)?/.source+/(?:\.([\w-]+)(?:\[(.+)\])?)?/.source+/\.([\w-]+)(?:\[(.+)\])?/.source+"$"),e=["material","materials","bones"];return function(n){if(!(r=t.exec(n)))throw Error("PropertyBinding: Cannot parse trackName: "+n);var r,i=(r={nodeName:r[2],objectName:r[3],objectIndex:r[4],propertyName:r[5],propertyIndex:r[6]}).nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){var o=r.nodeName.substring(i+1);-1!==e.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+n);return r}}(),findNode:function(t,e){if(!e||""===e||"root"===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=function(t){for(var n=0;n<t.bones.length;n++){var r=t.bones[n];if(r.name===e)return r}return null}(t.skeleton);if(n)return n}if(t.children){var r=function(t){for(var n=0;n<t.length;n++){var i=t[n];if(i.name===e||i.uuid===e||(i=r(i.children)))return i}return null};if(n=r(t.children))return n}return null}}),Object.assign(dr.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)t[e++]=n[r]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.node[this.propertyName]=t[e]},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,r=e.propertyName,i=e.propertyIndex;if(t||(this.node=t=dr.findNode(this.rootNode,e.nodeName)||this.rootNode),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(n){var o=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);for(t=t.skeleton.bones,n=0;n<t.length;n++)if(t[n].name===o){o=n;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==o){if(void 0===t[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[o]}}if(void 0===(o=t[r]))console.error("THREE.PropertyBinding: Trying to update property for track: "+e.nodeName+"."+r+" but it wasn't found.",t);else{if(e=this.Versioning.None,void 0!==t.needsUpdate?(e=this.Versioning.NeedsUpdate,this.targetObject=t):void 0!==t.matrixWorldNeedsUpdate&&(e=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t),n=this.BindingType.Direct,void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(n=0;n<this.node.geometry.morphAttributes.position.length;n++)if(t.geometry.morphAttributes.position[n].name===i){i=n;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(n=0;n<this.node.geometry.morphTargets.length;n++)if(t.geometry.morphTargets[n].name===i){i=n;break}}}n=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=i}else void 0!==o.fromArray&&void 0!==o.toArray?(n=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(n=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[n],this.setValue=this.SetterByBindingTypeAndVersioning[n][e]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(dr.prototype,{_getValue_unbound:dr.prototype.getValue,_setValue_unbound:dr.prototype.setValue}),Object.assign(pr.prototype,{isAnimationObjectGroup:!0,add:function(t){for(var e=this._objects,n=e.length,r=this.nCachedObjects_,i=this._indicesByUUID,o=this._paths,a=this._parsedPaths,s=this._bindings,u=s.length,c=0,l=arguments.length;c!==l;++c){var h=arguments[c],f=i[d=h.uuid];if(void 0===f){f=n++,i[d]=f,e.push(h);for(var d=0,p=u;d!==p;++d)s[d].push(new dr(h,o[d],a[d]))}else if(f<r){var m=--r;for(i[(p=e[m]).uuid]=f,e[f]=p,i[d]=m,e[m]=h,d=0,p=u;d!==p;++d){var g=s[d],v=g[f];g[f]=g[m],void 0===v&&(v=new dr(h,o[d],a[d])),g[m]=v}}else void 0!==e[f]&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=r},remove:function(t){for(var e=this._objects,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,o=i.length,a=0,s=arguments.length;a!==s;++a){var u=arguments[a],c=u.uuid,l=r[c];if(void 0!==l&&l>=n){var h=n++;for(r[(f=e[h]).uuid]=l,e[l]=f,r[c]=h,e[h]=u,u=0,c=o;u!==c;++u){var f,d=(f=i[u])[l];f[l]=f[h],f[h]=d}}}this.nCachedObjects_=n},uncache:function(t){for(var e=this._objects,n=e.length,r=this.nCachedObjects_,i=this._indicesByUUID,o=this._bindings,a=o.length,s=0,u=arguments.length;s!==u;++s){var c=i[l=arguments[s].uuid];if(void 0!==c)if(delete i[l],c<r){var l,h=e[l=--r],f=--n,d=e[f];for(i[h.uuid]=c,e[c]=h,i[d.uuid]=l,e[l]=d,e.pop(),h=0,d=a;h!==d;++h){var p=o[h],m=p[f];p[c]=p[l],p[l]=m,p.pop()}}else for(i[(d=e[f=--n]).uuid]=c,e[c]=d,e.pop(),h=0,d=a;h!==d;++h)(p=o[h])[c]=p[f],p.pop()}this.nCachedObjects_=r},subscribe_:function(t,e){var n=this._bindingsIndicesByPath,r=this._bindings;if(void 0!==(i=n[t]))return r[i];var i,o=this._paths,a=this._parsedPaths,s=this._objects,u=this.nCachedObjects_,c=Array(s.length);for(n[t]=i=r.length,o.push(t),a.push(e),r.push(c),n=u,i=s.length;n!==i;++n)c[n]=new dr(s[n],t,e);return c},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){var r=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];e[t[a]]=n,o[n]=s,o.pop(),i[n]=i[a],i.pop(),r[n]=r[a],r.pop()}}}),Object.assign(mr.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){var r=t._clip.duration,i=(n=this._clip.duration)/r;t.warp(1,r/n,e),this.warp(i,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,n){var r=this._mixer,i=r.time,o=this._timeScaleInterpolant,a=this.timeScale;return null===o&&(this._timeScaleInterpolant=o=r._lendControlInterpolant()),r=o.parameterPositions,o=o.sampleValues,r[0]=i,r[1]=i+n,o[0]=t/a,o[1]=e/a,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,r){if(this.enabled){if(null!==(i=this._startTime)){if(0>(e=(t-i)*n)||0===n)return;this._startTime=null,e*=n}if(e*=this._updateTimeScale(t),n=this._updateTime(e),0<(t=this._updateWeight(t)))for(var i=this._propertyBindings,o=0,a=(e=this._interpolants).length;o!==a;++o)e[o].evaluate(n),i[o].accumulate(r,t)}else this._updateWeight(t)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var n=this._timeScaleInterpolant;null!==n&&(e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e))}return this._effectiveTimeScale=e},_updateTime:function(t){var e=this.time+t;if(0===t)return e;var n=this._clip.duration,r=this.loop,i=this._loopCount;if(2200===r)t:{if(-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1)),e>=n)e=n;else{if(!(0>e))break t;e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>t?-1:1})}else{if(r=2202===r,-1===i&&(0<=t?(i=0,this._setEndings(!0,0===this.repetitions,r)):this._setEndings(0===this.repetitions,!0,r)),e>=n||0>e){var o=Math.floor(e/n),a=(e-=n*o,i+=Math.abs(o),this.repetitions-i);0>a?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=0<t?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<t?1:-1})):(0===a?this._setEndings(t=0>t,!t,r):this._setEndings(!1,!1,r),this._loopCount=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o}))}if(r&&1==(1&i))return this.time=e,n-e}return this.time=e},_setEndings:function(t,e,n){var r=this._interpolantSettings;n?(r.endingStart=2401,r.endingEnd=2401):(r.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,r.endingEnd=e?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(t,e,n){var r=this._mixer,i=r.time,o=this._weightInterpolant;return null===o&&(this._weightInterpolant=o=r._lendControlInterpolant()),r=o.parameterPositions,o=o.sampleValues,r[0]=i,o[0]=e,r[1]=i+t,o[1]=n,this}}),Object.assign(gr.prototype,e.prototype,{_bindAction:function(t,e){var n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,o=t._propertyBindings,a=t._interpolants,s=n.uuid,u=this._bindingsByRootAndName,c=u[s];for(void 0===c&&(u[s]=c={}),u=0;u!==i;++u){var l=r[u],h=l.name,f=c[h];if(void 0===f){if(void 0!==(f=o[u])){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,s,h));continue}++(f=new hr(dr.create(n,h,e&&e._propertyBindings[u].binding.parsedPath),l.ValueTypeName,l.getValueSize())).referenceCount,this._addInactiveBinding(f,s,h)}o[u]=f,a[u].resultBuffer=f.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}for(n=0,r=(e=t._propertyBindings).length;n!==r;++n){var i=e[n];0==i.useCount++&&(this._lendBinding(i),i.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){return null!==(t=t._cacheIndex)&&t<this._nActiveActions},_addInactiveAction:function(t,e,n){var r=this._actions,i=this._actionsByClip,o=i[e];void 0===o?(o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=o):(t._byClipCacheIndex=(e=o.knownActions).length,e.push(t)),t._cacheIndex=r.length,r.push(t),o.actionByRoot[n]=t},_removeInactiveAction:function(t){(n=(e=this._actions)[e.length-1])._cacheIndex=r=t._cacheIndex,e[r]=n,e.pop(),t._cacheIndex=null;var e,n,r,i=(r=(n=this._actionsByClip)[e=t._clip.uuid]).knownActions,o=i[i.length-1],a=t._byClipCacheIndex;o._byClipCacheIndex=a,i[a]=o,i.pop(),t._byClipCacheIndex=null,delete r.actionByRoot[(t._localRoot||this._root).uuid],0===i.length&&delete n[e],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=0,n=(t=t._propertyBindings).length;e!==n;++e){var r=t[e];0==--r.referenceCount&&this._removeInactiveBinding(r)}},_lendAction:function(t){var e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackAction:function(t){var e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_addInactiveBinding:function(t,e,n){var r=this._bindingsByRootAndName,i=r[e],o=this._bindings;void 0===i&&(r[e]=i={}),i[n]=t,t._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,n=(r=t.binding).rootNode.uuid,r=r.path,i=this._bindingsByRootAndName,o=i[n],a=e[e.length-1];a._cacheIndex=t=t._cacheIndex,e[t]=a,e.pop(),delete o[r];t:{for(var s in o)break t;delete i[n]}},_lendBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&((n=new Tn(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var n,r=(n=e||this._root).uuid,i="string"==typeof t?Fn.findByName(n,t):t,o=this._actionsByClip[n=null!==i?i.uuid:t],a=null;if(void 0!==o){if(void 0!==(a=o.actionByRoot[r]))return a;a=o.knownActions[0],null===i&&(i=a._clip)}return null===i?null:(i=new mr(this,i,e),this._bindAction(i,a),this._addInactiveAction(i,n,r),i)},existingAction:function(t,e){var n=(r=e||this._root).uuid,r="string"==typeof t?Fn.findByName(r,t):t;return void 0!==(r=this._actionsByClip[r?r.uuid:t])&&r.actionByRoot[n]||null},stopAllAction:function(){for(var t=this._actions,e=this._nActiveActions,n=this._bindings,r=this._nActiveBindings,i=this._nActiveBindings=this._nActiveActions=0;i!==e;++i)t[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(t){for(var e=this._actions,n=this._nActiveActions,r=this.time+=t*=this.timeScale,i=Math.sign(t),o=this._accuIndex^=1,a=0;a!==n;++a)e[a]._update(r,t,i,o);for(t=this._bindings,e=this._nActiveBindings,a=0;a!==e;++a)t[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,n=this._actionsByClip;if(void 0!==(r=n[t=t.uuid])){for(var r,i=0,o=(r=r.knownActions).length;i!==o;++i){var a=r[i];this._deactivateAction(a);var s=a._cacheIndex,u=e[e.length-1];a._cacheIndex=null,a._byClipCacheIndex=null,u._cacheIndex=s,e[s]=u,e.pop(),this._removeInactiveBindingsForAction(a)}delete n[t]}},uncacheRoot:function(t){t=t.uuid;var e,n=this._actionsByClip;for(e in n){var r=n[e].actionByRoot[t];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}if(void 0!==(e=this._bindingsByRootAndName[t]))for(var i in e)(t=e[i]).restoreOriginalState(),this._removeInactiveBinding(t)},uncacheAction:function(t,e){var n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),vr.prototype.clone=function(){return new vr(void 0===this.value.clone?this.value:this.value.clone())},yr.prototype=Object.assign(Object.create(bt.prototype),{constructor:yr,isInstancedBufferGeometry:!0,addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:n})},copy:function(t){null!==(n=t.index)&&this.setIndex(n.clone());var e,n=t.attributes;for(e in n)this.addAttribute(e,n[e].clone());for(e=0,n=(t=t.groups).length;e<n;e++){var r=t[e];this.addGroup(r.start,r.count,r.materialIndex)}return this}}),Object.defineProperties(wr.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(wr.prototype,{isInterleavedBufferAttribute:!0,setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return this.data.array[(t=t*this.data.stride+this.offset)+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,r){return this.data.array[(t=t*this.data.stride+this.offset)+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return this.data.array[(t=t*this.data.stride+this.offset)+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=i,this}}),Object.defineProperty(br.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(br.prototype,{isInterleavedBuffer:!0,setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.stride:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(var r=0,i=this.stride;r<i;r++)this.array[t+r]=e.array[n+r];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}}),xr.prototype=Object.assign(Object.create(br.prototype),{constructor:xr,isInstancedInterleavedBuffer:!0,copy:function(t){return br.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),_r.prototype=Object.assign(Object.create(ut.prototype),{constructor:_r,isInstancedBufferAttribute:!0,copy:function(t){return ut.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Object.assign(Mr.prototype,{linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize()):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e){var n=[];return Sr(t,this,n,e),n.sort(Er),n},intersectObjects:function(t,e){var n=[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),n;for(var r=0,i=t.length;r<i;r++)Sr(t[r],this,n,e);return n.sort(Er),n}}),Object.assign(Tr.prototype,{start:function(){this.oldTime=this.startTime=("undefined"==typeof performance?Date:performance).now(),this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.autoStart=this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"==typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}),Object.assign(Ar.prototype,{set:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.radius=t.length(),0===this.radius?this.phi=this.theta=0:(this.theta=Math.atan2(t.x,t.z),this.phi=Math.acos(ii.clamp(t.y/this.radius,-1,1))),this}}),Object.assign(kr.prototype,{set:function(t,e,n){return this.radius=t,this.theta=e,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.radius=Math.sqrt(t.x*t.x+t.z*t.z),this.theta=Math.atan2(t.x,t.z),this.y=t.y,this}}),(Cr.prototype=Object.create(Ct.prototype)).constructor=Cr,Cr.prototype.createAnimation=function(t,e,n,r){this.animationsMap[t]=e={start:e,end:n,length:n-e+1,fps:r,duration:(n-e)/r,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1},this.animationsList.push(e)},Cr.prototype.autoCreateAnimations=function(t){for(var e,n=/([a-z]+)_?(\d+)/i,r={},i=this.geometry,o=0,a=i.morphTargets.length;o<a;o++){var s=i.morphTargets[o].name.match(n);if(s&&1<s.length){var u=s[1];r[u]||(r[u]={start:1/0,end:-1/0}),o<(s=r[u]).start&&(s.start=o),o>s.end&&(s.end=o),e||(e=u)}}for(u in r)this.createAnimation(u,(s=r[u]).start,s.end,t);this.firstAnimation=e},Cr.prototype.setAnimationDirectionForward=function(t){(t=this.animationsMap[t])&&(t.direction=1,t.directionBackwards=!1)},Cr.prototype.setAnimationDirectionBackward=function(t){(t=this.animationsMap[t])&&(t.direction=-1,t.directionBackwards=!0)},Cr.prototype.setAnimationFPS=function(t,e){var n=this.animationsMap[t];n&&(n.fps=e,n.duration=(n.end-n.start)/n.fps)},Cr.prototype.setAnimationDuration=function(t,e){var n=this.animationsMap[t];n&&(n.duration=e,n.fps=(n.end-n.start)/n.duration)},Cr.prototype.setAnimationWeight=function(t,e){var n=this.animationsMap[t];n&&(n.weight=e)},Cr.prototype.setAnimationTime=function(t,e){var n=this.animationsMap[t];n&&(n.time=e)},Cr.prototype.getAnimationTime=function(t){var e=0;return(t=this.animationsMap[t])&&(e=t.time),e},Cr.prototype.getAnimationDuration=function(t){var e=-1;return(t=this.animationsMap[t])&&(e=t.duration),e},Cr.prototype.playAnimation=function(t){var e=this.animationsMap[t];e?(e.time=0,e.active=!0):console.warn("THREE.MorphBlendMesh: animation["+t+"] undefined in .playAnimation()")},Cr.prototype.stopAnimation=function(t){(t=this.animationsMap[t])&&(t.active=!1)},Cr.prototype.update=function(t){for(var e=0,n=this.animationsList.length;e<n;e++){var r=this.animationsList[e];if(r.active){var i=r.duration/r.length;r.time+=r.direction*t,r.mirroredLoop?(r.time>r.duration||0>r.time)&&(r.direction*=-1,r.time>r.duration&&(r.time=r.duration,r.directionBackwards=!0),0>r.time&&(r.time=0,r.directionBackwards=!1)):(r.time%=r.duration,0>r.time&&(r.time+=r.duration));var o=r.start+ii.clamp(Math.floor(r.time/i),0,r.length-1),a=r.weight;o!==r.currentFrame&&(this.morphTargetInfluences[r.lastFrame]=0,this.morphTargetInfluences[r.currentFrame]=1*a,this.morphTargetInfluences[o]=0,r.lastFrame=r.currentFrame,r.currentFrame=o),i=r.time%i/i,r.directionBackwards&&(i=1-i),r.currentFrame!==r.lastFrame?(this.morphTargetInfluences[r.currentFrame]=i*a,this.morphTargetInfluences[r.lastFrame]=(1-i)*a):this.morphTargetInfluences[r.currentFrame]=a}}},(Rr.prototype=Object.create(nt.prototype)).constructor=Rr,Rr.prototype.isImmediateRenderObject=!0,(Dr.prototype=Object.create(ie.prototype)).constructor=Dr,Dr.prototype.update=function(){var t=new u,e=new u,n=new Q;return function(){var r=["a","b","c"];this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);var i=this.object.matrixWorld,o=this.geometry.attributes.position,a=this.object.geometry;if(a&&a.isGeometry)for(var s=a.vertices,u=a.faces,c=a=0,l=u.length;c<l;c++)for(var h=u[c],f=0,d=h.vertexNormals.length;f<d;f++){var p=h.vertexNormals[f];t.copy(s[h[r[f]]]).applyMatrix4(i),e.copy(p).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),o.setXYZ(a,t.x,t.y,t.z),o.setXYZ(a+=1,e.x,e.y,e.z),a+=1}else if(a&&a.isBufferGeometry)for(r=a.attributes.position,s=a.attributes.normal,f=a=0,d=r.count;f<d;f++)t.set(r.getX(f),r.getY(f),r.getZ(f)).applyMatrix4(i),e.set(s.getX(f),s.getY(f),s.getZ(f)),e.applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),o.setXYZ(a,t.x,t.y,t.z),o.setXYZ(a+=1,e.x,e.y,e.z),a+=1;o.needsUpdate=!0}}(),(Lr.prototype=Object.create(nt.prototype)).constructor=Lr,Lr.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Lr.prototype.update=function(){var t=new u,e=new u;return function(){this.light.updateMatrixWorld();var n=this.light.distance?this.light.distance:1e3,r=n*Math.tan(this.light.angle);this.cone.scale.set(r,r,n),t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),this.cone.material.color.copy(this.light.color)}}(),(Or.prototype=Object.create(ie.prototype)).constructor=Or,Or.prototype.onBeforeRender=function(){var t=new u,e=new c,n=new c;return function(){var r=this.bones,i=this.geometry,o=i.getAttribute("position");n.getInverse(this.root.matrixWorld);for(var a=0,s=0;a<r.length;a++){var u=r[a];u.parent&&u.parent.isBone&&(e.multiplyMatrices(n,u.matrixWorld),t.setFromMatrixPosition(e),o.setXYZ(s,t.x,t.y,t.z),e.multiplyMatrices(n,u.parent.matrixWorld),t.setFromMatrixPosition(e),o.setXYZ(s+1,t.x,t.y,t.z),s+=2)}i.getAttribute("position").needsUpdate=!0}}(),(Pr.prototype=Object.create(Ct.prototype)).constructor=Pr,Pr.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Pr.prototype.update=function(){this.material.color.copy(this.light.color)},(Ir.prototype=Object.create(nt.prototype)).constructor=Ir,Ir.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Ir.prototype.update=function(){(t=this.children[0]).material.color.copy(this.light.color);var t,e=.5*this.light.width,n=.5*this.light.height,r=(t=t.geometry.attributes.position).array;r[0]=e,r[1]=-n,r[2]=0,r[3]=e,r[4]=n,r[5]=0,r[6]=-e,r[7]=n,r[8]=0,r[9]=-e,r[10]=-n,r[11]=0,r[12]=e,r[13]=-n,r[14]=0,t.needsUpdate=!0},(Nr.prototype=Object.create(nt.prototype)).constructor=Nr,Nr.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Nr.prototype.update=function(){var t=new u,e=new V,n=new V;return function(){var r=this.children[0],i=r.geometry.getAttribute("color");e.copy(this.light.color),n.copy(this.light.groundColor);for(var o=0,a=i.count;o<a;o++){var s=o<a/2?e:n;i.setXYZ(o,s.r,s.g,s.b)}r.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate()),i.needsUpdate=!0}}(),(Fr.prototype=Object.create(ie.prototype)).constructor=Fr,(jr.prototype=Object.create(ie.prototype)).constructor=jr,(zr.prototype=Object.create(ie.prototype)).constructor=zr,zr.prototype.update=function(){var t=new u,e=new u,n=new Q;return function(){this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);for(var r,i=this.object.matrixWorld,o=this.geometry.attributes.position,a=(r=this.object.geometry).vertices,s=0,u=0,c=(r=r.faces).length;u<c;u++){var l=r[u],h=l.normal;t.copy(a[l.a]).add(a[l.b]).add(a[l.c]).divideScalar(3).applyMatrix4(i),e.copy(h).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),o.setXYZ(s,t.x,t.y,t.z),o.setXYZ(s+=1,e.x,e.y,e.z),s+=1}o.needsUpdate=!0}}(),(Ur.prototype=Object.create(nt.prototype)).constructor=Ur,Ur.prototype.dispose=function(){var t=this.children[0],e=this.children[1];t.geometry.dispose(),t.material.dispose(),e.geometry.dispose(),e.material.dispose()},Ur.prototype.update=function(){var t=new u,e=new u,n=new u;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(e,t);var r=this.children[0],i=this.children[1];r.lookAt(n),r.material.color.copy(this.light.color),i.lookAt(n),i.scale.z=n.length()}}(),(Vr.prototype=Object.create(ie.prototype)).constructor=Vr,Vr.prototype.update=function(){function t(t,o,a,s){if(r.set(o,a,s).unproject(i),void 0!==(t=n[t]))for(o=e.getAttribute("position"),a=0,s=t.length;a<s;a++)o.setXYZ(t[a],r.x,r.y,r.z)}var e,n,r=new u,i=new rt;return function(){e=this.geometry,n=this.pointMap,i.projectionMatrix.copy(this.camera.projectionMatrix),t("c",0,0,-1),t("t",0,0,1),t("n1",-1,-1,-1),t("n2",1,-1,-1),t("n3",-1,1,-1),t("n4",1,1,-1),t("f1",-1,-1,1),t("f2",1,-1,1),t("f3",-1,1,1),t("f4",1,1,1),t("u1",.7,1.1,-1),t("u2",-.7,1.1,-1),t("u3",0,2,-1),t("cf1",-1,0,1),t("cf2",1,0,1),t("cf3",0,-1,1),t("cf4",0,1,1),t("cn1",-1,0,-1),t("cn2",1,0,-1),t("cn3",0,-1,-1),t("cn4",0,1,-1),e.getAttribute("position").needsUpdate=!0}}(),(Br.prototype=Object.create(ie.prototype)).constructor=Br,Br.prototype.update=function(){var t=new X;return function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&t.setFromObject(this.object),!t.isEmpty()){e=t.min;var n=t.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=e.x,i[4]=n.y,i[5]=n.z,i[6]=e.x,i[7]=e.y,i[8]=n.z,i[9]=n.x,i[10]=e.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=e.z,i[15]=e.x,i[16]=n.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=n.x,i[22]=e.y,i[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),Br.prototype.setFromObject=function(t){return this.object=t,this.update(),this},(Hr.prototype=Object.create(nt.prototype)).constructor=Hr,Hr.prototype.setDirection=function(){var t,e=new u;return function(n){.99999<n.y?this.quaternion.set(0,0,0,1):-.99999>n.y?this.quaternion.set(1,0,0,0):(e.set(n.z,0,-n.x).normalize(),t=Math.acos(n.y),this.quaternion.setFromAxisAngle(e,t))}}(),Hr.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},Hr.prototype.setColor=function(t){this.line.material.color.copy(t),this.cone.material.color.copy(t)},(qr.prototype=Object.create(ie.prototype)).constructor=qr;var ji=new u,zi=new Gr,Ui=new Gr,Vi=new Gr;(Wr.prototype=Object.create(Wn.prototype)).constructor=Wr,Wr.prototype.getPoint=function(t){var e,n,r,i=this.points;if(t*=(a=i.length)-(this.closed?0:1),t-=s=Math.floor(t),this.closed?s+=0<s?0:(Math.floor(Math.abs(s)/i.length)+1)*i.length:0===t&&s===a-1&&(s=a-2,t=1),this.closed||0<s?e=i[(s-1)%a]:(ji.subVectors(i[0],i[1]).add(i[0]),e=ji),n=i[s%a],r=i[(s+1)%a],this.closed||s+2<a?i=i[(s+2)%a]:(ji.subVectors(i[a-1],i[a-2]).add(i[a-1]),i=ji),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var o="chordal"===this.type?.5:.25,a=Math.pow(e.distanceToSquared(n),o),s=Math.pow(n.distanceToSquared(r),o);o=Math.pow(r.distanceToSquared(i),o),1e-4>s&&(s=1),1e-4>a&&(a=s),1e-4>o&&(o=s),zi.initNonuniformCatmullRom(e.x,n.x,r.x,i.x,a,s,o),Ui.initNonuniformCatmullRom(e.y,n.y,r.y,i.y,a,s,o),Vi.initNonuniformCatmullRom(e.z,n.z,r.z,i.z,a,s,o)}else"catmullrom"===this.type&&(zi.initCatmullRom(e.x,n.x,r.x,i.x,a=void 0!==this.tension?this.tension:.5),Ui.initCatmullRom(e.y,n.y,r.y,i.y,a),Vi.initCatmullRom(e.z,n.z,r.z,i.z,a));return new u(zi.calc(t),Ui.calc(t),Vi.calc(t))},(Yr.prototype=Object.create(Wn.prototype)).constructor=Yr,Yr.prototype.getPoint=function(t){var e=this.v0,n=this.v1,r=this.v2,i=this.v3;return new u(Gn(t,e.x,n.x,r.x,i.x),Gn(t,e.y,n.y,r.y,i.y),Gn(t,e.z,n.z,r.z,i.z))},(Xr.prototype=Object.create(Wn.prototype)).constructor=Xr,Xr.prototype.getPoint=function(t){var e=this.v0,n=this.v1,r=this.v2;return new u(qn(t,e.x,n.x,r.x),qn(t,e.y,n.y,r.y),qn(t,e.z,n.z,r.z))},($r.prototype=Object.create(Wn.prototype)).constructor=$r,$r.prototype.getPoint=function(t){if(1===t)return this.v2.clone();var e=new u;return e.subVectors(this.v2,this.v1),e.multiplyScalar(t),e.add(this.v1),e},(Qr.prototype=Object.create($n.prototype)).constructor=Qr,Wn.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(Wn.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Jr.prototype=Object.create(Wr.prototype),Zr.prototype=Object.create(Wr.prototype),Kr.prototype=Object.create(Wr.prototype),Object.assign(Kr.prototype,{initFromArray:function(t){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(t){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(t){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Fr.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Or.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(B.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(X.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),At.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},ii.random16=function(){return console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead."),Math.random()},Object.assign(Q.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(t){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(t,e,n){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(t,e,n){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(c.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){var t;return function(){return void 0===t&&(t=new u),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),t.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(t){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(t,e,n){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(t,e,n){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,n,r,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,r,n,i,o)}}),J.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},s.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(Tt.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(tr.prototype,{extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Le(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Be(this,t)}}),Object.assign(n.prototype,{fromAttribute:function(t,e,n){return console.error("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)}}),Object.assign(u.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,n){return console.error("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)}}),Object.assign(i.prototype,{fromAttribute:function(t,e,n){return console.error("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)}}),st.prototype.computeTangents=function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},Object.assign(nt.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)}}),Object.defineProperties(nt.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(Zt.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Kt.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(Wn.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),ot.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(pn.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(ut.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}}}),Object.assign(bt.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addDrawCall:function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(bt.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(vr.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(G.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new V}}}),Object.defineProperties(en.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(W.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(Gt.prototype,{getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}}),Object.defineProperties(Gt.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=t}}}),Object.defineProperties(K.prototype,{cullFace:{get:function(){return this.renderReverseSided?2:1},set:function(t){t=1!==t,console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to "+t+"."),this.renderReverseSided=t}}}),Object.defineProperties(o.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),ur.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new ir).load(t,function(t){e.setBuffer(t)}),this},lr.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},t.WebGLRenderTargetCube=a,t.WebGLRenderTarget=o,t.WebGLRenderer=Gt,t.ShaderLib=vi,t.UniformsLib=pi,t.UniformsUtils=mi,t.ShaderChunk=gi,t.FogExp2=Wt,t.Fog=Yt,t.Scene=Xt,t.LensFlare=$t,t.Sprite=Jt,t.LOD=Zt,t.SkinnedMesh=ee,t.Skeleton=Kt,t.Bone=te,t.Mesh=Ct,t.LineSegments=ie,t.LineLoop=oe,t.Line=re,t.Points=se,t.Group=ue,t.VideoTexture=ce,t.DataTexture=l,t.CompressedTexture=le,t.CubeTexture=h,t.CanvasTexture=he,t.DepthTexture=fe,t.Texture=r,t.CompressedTextureLoader=cn,t.DataTextureLoader=ln,t.CubeTextureLoader=fn,t.TextureLoader=dn,t.ObjectLoader=Bn,t.MaterialLoader=jn,t.BufferGeometryLoader=zn,t.DefaultLoadingManager=Ti,t.LoadingManager=sn,t.JSONLoader=Vn,t.ImageLoader=hn,t.FontLoader=rr,t.FileLoader=un,t.Loader=Un,t.Cache=Si,t.AudioLoader=ir,t.SpotLightShadow=vn,t.SpotLight=yn,t.PointLight=wn,t.RectAreaLight=Mn,t.HemisphereLight=mn,t.DirectionalLightShadow=bn,t.DirectionalLight=xn,t.AmbientLight=_n,t.LightShadow=gn,t.Light=pn,t.StereoCamera=or,t.PerspectiveCamera=ot,t.OrthographicCamera=it,t.CubeCamera=ar,t.ArrayCamera=Bt,t.Camera=rt,t.AudioListener=sr,t.PositionalAudio=cr,t.AudioContext=Fi,t.AudioAnalyser=lr,t.Audio=ur,t.VectorKeyframeTrack=Cn,t.StringKeyframeTrack=On,t.QuaternionKeyframeTrack=Dn,t.NumberKeyframeTrack=Ln,t.ColorKeyframeTrack=In,t.BooleanKeyframeTrack=Pn,t.PropertyMixer=hr,t.PropertyBinding=dr,t.KeyframeTrack=Nn,t.AnimationUtils=ki,t.AnimationObjectGroup=pr,t.AnimationMixer=gr,t.AnimationClip=Fn,t.Uniform=vr,t.InstancedBufferGeometry=yr,t.BufferGeometry=bt,t.GeometryIdCount=function(){return bi++},t.Geometry=st,t.InterleavedBufferAttribute=wr,t.InstancedInterleavedBuffer=xr,t.InterleavedBuffer=br,t.InstancedBufferAttribute=_r,t.Face3=at,t.Object3D=nt,t.Raycaster=Mr,t.Layers=et,t.EventDispatcher=e,t.Clock=Tr,t.QuaternionLinearInterpolant=Rn,t.LinearInterpolant=Tn,t.DiscreteInterpolant=An,t.CubicInterpolant=Sn,t.Interpolant=En,t.Triangle=kt,t.Math=ii,t.Spherical=Ar,t.Cylindrical=kr,t.Plane=J,t.Frustum=Z,t.Sphere=$,t.Ray=Tt,t.Matrix4=c,t.Matrix3=Q,t.Box3=X,t.Box2=B,t.Line3=At,t.Euler=tt,t.Vector4=i,t.Vector3=u,t.Vector2=n,t.Quaternion=s,t.Color=V,t.MorphBlendMesh=Cr,t.ImmediateRenderObject=Rr,t.VertexNormalsHelper=Dr,t.SpotLightHelper=Lr,t.SkeletonHelper=Or,t.PointLightHelper=Pr,t.RectAreaLightHelper=Ir,t.HemisphereLightHelper=Nr,t.GridHelper=Fr,t.PolarGridHelper=jr,t.FaceNormalsHelper=zr,t.DirectionalLightHelper=Ur,t.CameraHelper=Vr,t.BoxHelper=Br,t.ArrowHelper=Hr,t.AxisHelper=qr,t.CatmullRomCurve3=Wr,t.CubicBezierCurve3=Yr,t.QuadraticBezierCurve3=Xr,t.LineCurve3=$r,t.ArcCurve=Qr,t.EllipseCurve=$n,t.SplineCurve=Qn,t.CubicBezierCurve=Jn,t.QuadraticBezierCurve=Zn,t.LineCurve=Yn,t.Shape=tr,t.Path=Kn,t.ShapePath=er,t.Font=nr,t.CurvePath=Xn,t.Curve=Wn,t.ShapeUtils=_i,t.SceneUtils={createMultiMaterialObject:function(t,e){for(var n=new ue,r=0,i=e.length;r<i;r++)n.add(new Ct(t,e[r]));return n},detach:function(t,e,n){t.applyMatrix(e.matrixWorld),e.remove(t),n.add(t)},attach:function(t,e,n){t.applyMatrix((new c).getInverse(n.matrixWorld)),e.remove(t),n.add(t)}},t.WireframeGeometry=de,t.ParametricGeometry=pe,t.ParametricBufferGeometry=me,t.TetrahedronGeometry=ye,t.TetrahedronBufferGeometry=we,t.OctahedronGeometry=be,t.OctahedronBufferGeometry=xe,t.IcosahedronGeometry=_e,t.IcosahedronBufferGeometry=Me,t.DodecahedronGeometry=Ee,t.DodecahedronBufferGeometry=Se,t.PolyhedronGeometry=ge,t.PolyhedronBufferGeometry=ve,t.TubeGeometry=Te,t.TubeBufferGeometry=Ae,t.TorusKnotGeometry=ke,t.TorusKnotBufferGeometry=Ce,t.TorusGeometry=Re,t.TorusBufferGeometry=De,t.TextGeometry=Pe,t.TextBufferGeometry=Ie,t.SphereGeometry=Ne,t.SphereBufferGeometry=Fe,t.RingGeometry=je,t.RingBufferGeometry=ze,t.PlaneGeometry=Mt,t.PlaneBufferGeometry=Et,t.LatheGeometry=Ue,t.LatheBufferGeometry=Ve,t.ShapeGeometry=Be,t.ShapeBufferGeometry=He,t.ExtrudeGeometry=Le,t.ExtrudeBufferGeometry=Oe,t.EdgesGeometry=qe,t.ConeGeometry=Ye,t.ConeBufferGeometry=Xe,t.CylinderGeometry=Ge,t.CylinderBufferGeometry=We,t.CircleGeometry=$e,t.CircleBufferGeometry=Qe,t.BoxGeometry=xt,t.BoxBufferGeometry=_t,t.ShadowMaterial=Je,t.SpriteMaterial=Qt,t.RawShaderMaterial=Ze,t.ShaderMaterial=W,t.PointsMaterial=ae,t.MeshPhysicalMaterial=tn,t.MeshStandardMaterial=Ke,t.MeshPhongMaterial=en,t.MeshToonMaterial=nn,t.MeshNormalMaterial=rn,t.MeshLambertMaterial=on,t.MeshDepthMaterial=Y,t.MeshBasicMaterial=St,t.LineDashedMaterial=an,t.LineBasicMaterial=ne,t.Material=G,t.Float64BufferAttribute=vt,t.Float32BufferAttribute=gt,t.Uint32BufferAttribute=mt,t.Int32BufferAttribute=pt,t.Uint16BufferAttribute=dt,t.Int16BufferAttribute=ft,t.Uint8ClampedBufferAttribute=ht,t.Uint8BufferAttribute=lt,t.Int8BufferAttribute=ct,t.BufferAttribute=ut,t.REVISION="86",t.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},t.CullFaceNone=0,t.CullFaceBack=1,t.CullFaceFront=2,t.CullFaceFrontBack=3,t.FrontFaceDirectionCW=0,t.FrontFaceDirectionCCW=1,t.BasicShadowMap=0,t.PCFShadowMap=1,t.PCFSoftShadowMap=2,t.FrontSide=0,t.BackSide=1,t.DoubleSide=2,t.FlatShading=1,t.SmoothShading=2,t.NoColors=0,t.FaceColors=1,t.VertexColors=2,t.NoBlending=0,t.NormalBlending=1,t.AdditiveBlending=2,t.SubtractiveBlending=3,t.MultiplyBlending=4,t.CustomBlending=5,t.AddEquation=100,t.SubtractEquation=101,t.ReverseSubtractEquation=102,t.MinEquation=103,t.MaxEquation=104,t.ZeroFactor=200,t.OneFactor=201,t.SrcColorFactor=202,t.OneMinusSrcColorFactor=203,t.SrcAlphaFactor=204,t.OneMinusSrcAlphaFactor=205,t.DstAlphaFactor=206,t.OneMinusDstAlphaFactor=207,t.DstColorFactor=208,t.OneMinusDstColorFactor=209,t.SrcAlphaSaturateFactor=210,t.NeverDepth=0,t.AlwaysDepth=1,t.LessDepth=2,t.LessEqualDepth=3,t.EqualDepth=4,t.GreaterEqualDepth=5,t.GreaterDepth=6,t.NotEqualDepth=7,t.MultiplyOperation=0,t.MixOperation=1,t.AddOperation=2,t.NoToneMapping=0,t.LinearToneMapping=1,t.ReinhardToneMapping=2,t.Uncharted2ToneMapping=3,t.CineonToneMapping=4,t.UVMapping=300,t.CubeReflectionMapping=301,t.CubeRefractionMapping=302,t.EquirectangularReflectionMapping=303,t.EquirectangularRefractionMapping=304,t.SphericalReflectionMapping=305,t.CubeUVReflectionMapping=306,t.CubeUVRefractionMapping=307,t.RepeatWrapping=1e3,t.ClampToEdgeWrapping=1001,t.MirroredRepeatWrapping=1002,t.NearestFilter=1003,t.NearestMipMapNearestFilter=1004,t.NearestMipMapLinearFilter=1005,t.LinearFilter=1006,t.LinearMipMapNearestFilter=1007,t.LinearMipMapLinearFilter=1008,t.UnsignedByteType=1009,t.ByteType=1010,t.ShortType=1011,t.UnsignedShortType=1012,t.IntType=1013,t.UnsignedIntType=1014,t.FloatType=1015,t.HalfFloatType=1016,t.UnsignedShort4444Type=1017,t.UnsignedShort5551Type=1018,t.UnsignedShort565Type=1019,t.UnsignedInt248Type=1020,t.AlphaFormat=1021,t.RGBFormat=1022,t.RGBAFormat=1023,t.LuminanceFormat=1024,t.LuminanceAlphaFormat=1025,t.RGBEFormat=1023,t.DepthFormat=1026,t.DepthStencilFormat=1027,t.RGB_S3TC_DXT1_Format=2001,t.RGBA_S3TC_DXT1_Format=2002,t.RGBA_S3TC_DXT3_Format=2003,t.RGBA_S3TC_DXT5_Format=2004,t.RGB_PVRTC_4BPPV1_Format=2100,t.RGB_PVRTC_2BPPV1_Format=2101,t.RGBA_PVRTC_4BPPV1_Format=2102,t.RGBA_PVRTC_2BPPV1_Format=2103,t.RGB_ETC1_Format=2151,t.LoopOnce=2200,t.LoopRepeat=2201,t.LoopPingPong=2202,t.InterpolateDiscrete=2300,t.InterpolateLinear=2301,t.InterpolateSmooth=2302,t.ZeroCurvatureEnding=2400,t.ZeroSlopeEnding=2401,t.WrapAroundEnding=2402,t.TrianglesDrawMode=0,t.TriangleStripDrawMode=1,t.TriangleFanDrawMode=2,t.LinearEncoding=3e3,t.sRGBEncoding=3001,t.GammaEncoding=3007,t.RGBEEncoding=3002,t.LogLuvEncoding=3003,t.RGBM7Encoding=3004,t.RGBM16Encoding=3005,t.RGBDEncoding=3006,t.BasicDepthPacking=3200,t.RGBADepthPacking=3201,t.CubeGeometry=xt,t.Face4=function(t,e,n,r,i,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new at(t,e,n,i,o,a)},t.LineStrip=0,t.LinePieces=1,t.MeshFaceMaterial=function(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t},t.MultiMaterial=function(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t},t.PointCloud=function(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new se(t,e)},t.Particle=function(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Jt(t)},t.ParticleSystem=function(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new se(t,e)},t.PointCloudMaterial=function(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new ae(t)},t.ParticleBasicMaterial=function(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new ae(t)},t.ParticleSystemMaterial=function(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new ae(t)},t.Vertex=function(t,e,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new u(t,e,n)},t.DynamicBufferAttribute=function(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new ut(t,e).setDynamic(!0)},t.Int8Attribute=function(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new ct(t,e)},t.Uint8Attribute=function(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new lt(t,e)},t.Uint8ClampedAttribute=function(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new ht(t,e)},t.Int16Attribute=function(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new ft(t,e)},t.Uint16Attribute=function(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new dt(t,e)},t.Int32Attribute=function(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new pt(t,e)},t.Uint32Attribute=function(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new mt(t,e)},t.Float32Attribute=function(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new gt(t,e)},t.Float64Attribute=function(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new vt(t,e)},t.ClosedSplineCurve3=Jr,t.SplineCurve3=Zr,t.Spline=Kr,t.BoundingBoxHelper=function(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Br(t,e)},t.EdgesHelper=function(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new ie(new qe(t.geometry),new ne({color:void 0!==e?e:16777215}))},t.WireframeHelper=function(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new ie(new de(t.geometry),new ne({color:void 0!==e?e:16777215}))},t.XHRLoader=function(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new un(t)},t.BinaryTextureLoader=function(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new ln(t)},t.GeometryUtils={merge:function(t,e,n){var r;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),r=e.matrix,e=e.geometry),t.merge(e,r,n)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},t.ImageUtils={crossOrigin:void 0,loadTexture:function(t,e,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new dn;return i.setCrossOrigin(this.crossOrigin),t=i.load(t,n,void 0,r),e&&(t.mapping=e),t},loadTextureCube:function(t,e,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new fn;return i.setCrossOrigin(this.crossOrigin),t=i.load(t,n,void 0,r),e&&(t.mapping=e),t},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}},t.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},t.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},Object.defineProperty(t,"__esModule",{value:!0})}),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.dat=e():t.dat=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";e.__esModule=!0;var r=function(t){return t&&t.__esModule?t:{default:t}}(n(1));e.default=r.default,t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(n(2)),o=r(n(6)),a=r(n(3)),s=r(n(7)),u=r(n(8)),c=r(n(10)),l=r(n(11)),h=r(n(12)),f=r(n(13)),d=r(n(14)),p=r(n(15)),m=r(n(16)),g=r(n(9)),v=r(n(17));e.default={color:{Color:i.default,math:o.default,interpret:a.default},controllers:{Controller:s.default,BooleanController:u.default,OptionController:c.default,StringController:l.default,NumberController:h.default,NumberControllerBox:f.default,NumberControllerSlider:d.default,FunctionController:p.default,ColorController:m.default},dom:{dom:g.default},gui:{GUI:v.default},GUI:v.default},t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e,n){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space?this.__state[e]:(l.recalculateRGB(this,e,n),this.__state[e])},set:function(t){"RGB"!==this.__state.space&&(l.recalculateRGB(this,e,n),this.__state.space="RGB"),this.__state[e]=t}})}function o(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space?this.__state[e]:(l.recalculateHSV(this),this.__state[e])},set:function(t){"HSV"!==this.__state.space&&(l.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=t}})}e.__esModule=!0;var a=r(n(3)),s=r(n(6)),u=r(n(4)),c=r(n(5)),l=function(){function t(){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.__state=a.default.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return t.prototype.toString=function(){return(0,u.default)(this)},t.prototype.toHexString=function(){return(0,u.default)(this,!0)},t.prototype.toOriginal=function(){return this.__state.conversion.write(this)},t}();l.recalculateRGB=function(t,e,n){if("HEX"===t.__state.space)t.__state[e]=s.default.component_from_hex(t.__state.hex,n);else{if("HSV"!==t.__state.space)throw new Error("Corrupted color state");c.default.extend(t.__state,s.default.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}},l.recalculateHSV=function(t){var e=s.default.rgb_to_hsv(t.r,t.g,t.b);c.default.extend(t.__state,{s:e.s,v:e.v}),c.default.isNaN(e.h)?c.default.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=e.h},l.COMPONENTS=["r","g","b","h","s","v","hex","a"],i(l.prototype,"r",2),i(l.prototype,"g",1),i(l.prototype,"b",0),o(l.prototype,"h"),o(l.prototype,"s"),o(l.prototype,"v"),Object.defineProperty(l.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(l.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=s.default.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}}),e.default=l,t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(n(4)),o=r(n(5)),a=[{litmus:o.default.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString(),0)}},write:i.default},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString(),0)}},write:i.default},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:i.default},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:i.default}}},{litmus:o.default.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:o.default.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3===t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4===t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:o.default.isObject,conversions:{RGBA_OBJ:{read:function(t){return!!(o.default.isNumber(t.r)&&o.default.isNumber(t.g)&&o.default.isNumber(t.b)&&o.default.isNumber(t.a))&&{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return!!(o.default.isNumber(t.r)&&o.default.isNumber(t.g)&&o.default.isNumber(t.b))&&{space:"RGB",r:t.r,g:t.g,b:t.b}},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return!!(o.default.isNumber(t.h)&&o.default.isNumber(t.s)&&o.default.isNumber(t.v)&&o.default.isNumber(t.a))&&{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return!!(o.default.isNumber(t.h)&&o.default.isNumber(t.s)&&o.default.isNumber(t.v))&&{space:"HSV",h:t.h,s:t.s,v:t.v}},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}],s=void 0,u=void 0;e.default=function(){u=!1;var t=arguments.length>1?o.default.toArray(arguments):arguments[0];return o.default.each(a,function(e){if(e.litmus(t))return o.default.each(e.conversions,function(e,n){if(s=e.read(t),!1===u&&!1!==s)return u=s,s.conversionName=n,s.conversion=e,o.default.BREAK}),o.default.BREAK}),u},t.exports=e.default},function(t,e){"use strict";e.__esModule=!0,e.default=function(t,e){var n=t.__state.conversionName.toString(),r=Math.round(t.r),i=Math.round(t.g),o=Math.round(t.b),a=t.a,s=Math.round(t.h),u=t.s.toFixed(1),c=t.v.toFixed(1);if(e||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){for(var l=t.hex.toString(16);l.length<6;)l="0"+l;return"#"+l}return"CSS_RGB"===n?"rgb("+r+","+i+","+o+")":"CSS_RGBA"===n?"rgba("+r+","+i+","+o+","+a+")":"HEX"===n?"0x"+t.hex.toString(16):"RGB_ARRAY"===n?"["+r+","+i+","+o+"]":"RGBA_ARRAY"===n?"["+r+","+i+","+o+","+a+"]":"RGB_OBJ"===n?"{r:"+r+",g:"+i+",b:"+o+"}":"RGBA_OBJ"===n?"{r:"+r+",g:"+i+",b:"+o+",a:"+a+"}":"HSV_OBJ"===n?"{h:"+s+",s:"+u+",v:"+c+"}":"HSVA_OBJ"===n?"{h:"+s+",s:"+u+",v:"+c+",a:"+a+"}":"unknown format"},t.exports=e.default},function(t,e){"use strict";e.__esModule=!0;var n=Array.prototype.forEach,r=Array.prototype.slice,i={BREAK:{},extend:function(t){return this.each(r.call(arguments,1),function(e){(this.isObject(e)?Object.keys(e):[]).forEach((function(n){this.isUndefined(e[n])||(t[n]=e[n])}).bind(this))},this),t},defaults:function(t){return this.each(r.call(arguments,1),function(e){(this.isObject(e)?Object.keys(e):[]).forEach((function(n){this.isUndefined(t[n])&&(t[n]=e[n])}).bind(this))},this),t},compose:function(){var t=r.call(arguments);return function(){for(var e=r.call(arguments),n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},each:function(t,e,r){if(t)if(n&&t.forEach&&t.forEach===n)t.forEach(e,r);else if(t.length===t.length+0){var i,o=void 0;for(o=0,i=t.length;o<i;o++)if(o in t&&e.call(r,t[o],o)===this.BREAK)return}else for(var a in t)if(e.call(r,t[a],a)===this.BREAK)return},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var r=void 0;return function(){var i=this,o=arguments,a=n||!r;clearTimeout(r),r=setTimeout(function(){r=null,n||t.apply(i,o)},e),a&&t.apply(i,o)}},toArray:function(t){return t.toArray?t.toArray():r.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){return isNaN(t)}),isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return!1===t||!0===t},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)}};e.default=i,t.exports=e.default},function(t,e){"use strict";e.__esModule=!0;var n=void 0;e.default={hsv_to_rgb:function(t,e,n){var r=Math.floor(t/60)%6,i=t/60-Math.floor(t/60),o=n*(1-e),a=n*(1-i*e),s=n*(1-(1-i)*e),u=[[n,s,o],[a,n,o],[o,n,s],[o,a,n],[s,o,n],[n,o,a]][r];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(t,e,n){var r=Math.min(t,e,n),i=Math.max(t,e,n),o=i-r,a=void 0;return 0===i?{h:NaN,s:0,v:0}:(a=t===i?(e-n)/o:e===i?2+(n-t)/o:4+(t-e)/o,(a/=6)<0&&(a+=1),{h:360*a,s:o/i,v:i/255})},rgb_to_hex:function(t,e,n){var r=this.hex_with_component(0,2,t);return r=this.hex_with_component(r,1,e),this.hex_with_component(r,0,n)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(t,e,r){return r<<(n=8*e)|t&~(255<<n)}},t.exports=e.default},function(t,e){"use strict";e.__esModule=!0;var n=function(){function t(e,n){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.initialValue=e[n],this.domElement=document.createElement("div"),this.object=e,this.property=n,this.__onChange=void 0,this.__onFinishChange=void 0}return t.prototype.onChange=function(t){return this.__onChange=t,this},t.prototype.onFinishChange=function(t){return this.__onFinishChange=t,this},t.prototype.setValue=function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this},t.prototype.getValue=function(){return this.object[this.property]},t.prototype.updateDisplay=function(){return this},t.prototype.isModified=function(){return this.initialValue!==this.getValue()},t}();e.default=n,t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(n(7)),o=r(n(9)),a=function(t){function e(n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,n,r)),a=i;return i.__prev=i.getValue(),i.__checkbox=document.createElement("input"),i.__checkbox.setAttribute("type","checkbox"),o.default.bind(i.__checkbox,"change",function(){a.setValue(!a.__prev)},!1),i.domElement.appendChild(i.__checkbox),i.updateDisplay(),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.setValue=function(e){var n=t.prototype.setValue.call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n},e.prototype.updateDisplay=function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),t.prototype.updateDisplay.call(this)},e}(i.default);e.default=a,t.exports=e.default},function(t,e,n){"use strict";function r(t){if("0"===t||i.default.isUndefined(t))return 0;var e=t.match(a);return i.default.isNull(e)?0:parseFloat(e[1])}e.__esModule=!0;var i=function(t){return t&&t.__esModule?t:{default:t}}(n(5)),o={};i.default.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(t,e){i.default.each(t,function(t){o[t]=e})});var a=/(\d+(\.\d+)?)px/,s={makeSelectable:function(t,e){void 0!==t&&void 0!==t.style&&(t.onselectstart=e?function(){return!1}:function(){},t.style.MozUserSelect=e?"auto":"none",t.style.KhtmlUserSelect=e?"auto":"none",t.unselectable=e?"on":"off")},makeFullscreen:function(t,e,n){var r=n,o=e;i.default.isUndefined(o)&&(o=!0),i.default.isUndefined(r)&&(r=!0),t.style.position="absolute",o&&(t.style.left=0,t.style.right=0),r&&(t.style.top=0,t.style.bottom=0)},fakeEvent:function(t,e,n,r){var a=n||{},s=o[e];if(!s)throw new Error("Event type "+e+" not supported.");var u=document.createEvent(s);switch(s){case"MouseEvents":u.initMouseEvent(e,a.bubbles||!1,a.cancelable||!0,window,a.clickCount||1,0,0,a.x||a.clientX||0,a.y||a.clientY||0,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var c=u.initKeyboardEvent||u.initKeyEvent;i.default.defaults(a,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(e,a.bubbles||!1,a.cancelable,window,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.keyCode,a.charCode);break;default:u.initEvent(e,a.bubbles||!1,a.cancelable||!0)}i.default.defaults(u,r),t.dispatchEvent(u)},bind:function(t,e,n,r){return t.addEventListener?t.addEventListener(e,n,r||!1):t.attachEvent&&t.attachEvent("on"+e,n),s},unbind:function(t,e,n,r){return t.removeEventListener?t.removeEventListener(e,n,r||!1):t.detachEvent&&t.detachEvent("on"+e,n),s},addClass:function(t,e){if(void 0===t.className)t.className=e;else if(t.className!==e){var n=t.className.split(/ +/);-1===n.indexOf(e)&&(n.push(e),t.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return s},removeClass:function(t,e){if(e)if(t.className===e)t.removeAttribute("class");else{var n=t.className.split(/ +/),r=n.indexOf(e);-1!==r&&(n.splice(r,1),t.className=n.join(" "))}else t.className=void 0;return s},hasClass:function(t,e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(t.className)||!1},getWidth:function(t){var e=getComputedStyle(t);return r(e["border-left-width"])+r(e["border-right-width"])+r(e["padding-left"])+r(e["padding-right"])+r(e.width)},getHeight:function(t){var e=getComputedStyle(t);return r(e["border-top-width"])+r(e["border-bottom-width"])+r(e["padding-top"])+r(e["padding-bottom"])+r(e.height)},getOffset:function(t){var e=t,n={left:0,top:0};if(e.offsetParent)do{n.left+=e.offsetLeft,n.top+=e.offsetTop,e=e.offsetParent}while(e);return n},isActive:function(t){return t===document.activeElement&&(t.type||t.href)}};e.default=s,t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(n(7)),o=r(n(9)),a=r(n(5)),s=function(t){function e(n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,n,r)),u=i,c=s;if(s.__select=document.createElement("select"),a.default.isArray(u)){var l={};a.default.each(u,function(t){l[t]=t}),u=l}return a.default.each(u,function(t,e){var n=document.createElement("option");n.innerHTML=e,n.setAttribute("value",t),c.__select.appendChild(n)}),s.updateDisplay(),o.default.bind(s.__select,"change",function(){c.setValue(this.options[this.selectedIndex].value)}),s.domElement.appendChild(s.__select),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.setValue=function(e){var n=t.prototype.setValue.call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n},e.prototype.updateDisplay=function(){return o.default.isActive(this.__select)?this:(this.__select.value=this.getValue(),t.prototype.updateDisplay.call(this))},e}(i.default);e.default=s,t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(n(7)),o=r(n(9)),a=function(t){function e(n,r){function i(){s.setValue(s.__input.value)}!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,n,r)),s=a;return a.__input=document.createElement("input"),a.__input.setAttribute("type","text"),o.default.bind(a.__input,"keyup",i),o.default.bind(a.__input,"change",i),o.default.bind(a.__input,"blur",function(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}),o.default.bind(a.__input,"keydown",function(t){13===t.keyCode&&this.blur()}),a.updateDisplay(),a.domElement.appendChild(a.__input),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateDisplay=function(){return o.default.isActive(this.__input)||(this.__input.value=this.getValue()),t.prototype.updateDisplay.call(this)},e}(i.default);e.default=a,t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){var e=t.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}e.__esModule=!0;var o=r(n(7)),a=r(n(5)),s=function(t){function e(n,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,n,r)),u=o||{};return s.__min=u.min,s.__max=u.max,s.__step=u.step,s.__impliedStep=a.default.isUndefined(s.__step)?0===s.initialValue?1:Math.pow(10,Math.floor(Math.log(Math.abs(s.initialValue))/Math.LN10))/10:s.__step,s.__precision=i(s.__impliedStep),s}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.setValue=function(e){var n=e;return void 0!==this.__min&&n<this.__min?n=this.__min:void 0!==this.__max&&n>this.__max&&(n=this.__max),void 0!==this.__step&&n%this.__step!=0&&(n=Math.round(n/this.__step)*this.__step),t.prototype.setValue.call(this,n)},e.prototype.min=function(t){return this.__min=t,this},e.prototype.max=function(t){return this.__max=t,this},e.prototype.step=function(t){return this.__step=t,this.__impliedStep=t,this.__precision=i(t),this},e}(o.default);e.default=s,t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(n(12)),o=r(n(9)),a=r(n(5)),s=function(t){function e(n,r,i){function s(){h.__onFinishChange&&h.__onFinishChange.call(h,h.getValue())}function u(t){var e=f-t.clientY;h.setValue(h.getValue()+e*h.__impliedStep),f=t.clientY}function c(){o.default.unbind(window,"mousemove",u),o.default.unbind(window,"mouseup",c),s()}!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var l=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,n,r,i));l.__truncationSuspended=!1;var h=l,f=void 0;return l.__input=document.createElement("input"),l.__input.setAttribute("type","text"),o.default.bind(l.__input,"change",function(){var t=parseFloat(h.__input.value);a.default.isNaN(t)||h.setValue(t)}),o.default.bind(l.__input,"blur",function(){s()}),o.default.bind(l.__input,"mousedown",function(t){o.default.bind(window,"mousemove",u),o.default.bind(window,"mouseup",c),f=t.clientY}),o.default.bind(l.__input,"keydown",function(t){13===t.keyCode&&(h.__truncationSuspended=!0,this.blur(),h.__truncationSuspended=!1,s())}),l.updateDisplay(),l.domElement.appendChild(l.__input),l}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateDisplay=function(){return this.__input.value=this.__truncationSuspended?this.getValue():function(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}(this.getValue(),this.__precision),t.prototype.updateDisplay.call(this)},e}(i.default);e.default=s,t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(n(12)),o=r(n(9)),a=function(t){function e(n,r,i,a,s){function u(t){t.preventDefault();var e=h.__background.getBoundingClientRect();return h.setValue(function(t,e,n,r,i){return r+(t-e)/(n-e)*(h.__max-r)}(t.clientX,e.left,e.right,h.__min)),!1}function c(){o.default.unbind(window,"mousemove",u),o.default.unbind(window,"mouseup",c),h.__onFinishChange&&h.__onFinishChange.call(h,h.getValue())}!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var l=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,n,r,{min:i,max:a,step:s})),h=l;return l.__background=document.createElement("div"),l.__foreground=document.createElement("div"),o.default.bind(l.__background,"mousedown",function(t){document.activeElement.blur(),o.default.bind(window,"mousemove",u),o.default.bind(window,"mouseup",c),u(t)}),o.default.addClass(l.__background,"slider"),o.default.addClass(l.__foreground,"slider-fg"),l.updateDisplay(),l.__background.appendChild(l.__foreground),l.domElement.appendChild(l.__background),l}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateDisplay=function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",t.prototype.updateDisplay.call(this)},e}(i.default);e.default=a,t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(n(7)),o=r(n(9)),a=function(t){function e(n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,n,r)),s=a;return a.__button=document.createElement("div"),a.__button.innerHTML=void 0===i?"Fire":i,o.default.bind(a.__button,"click",function(t){return t.preventDefault(),s.fire(),!1}),o.default.addClass(a.__button,"button"),a.domElement.appendChild(a.__button),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.fire=function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())},e}(i.default);e.default=a,t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e,n,r){t.style.background="",c.default.each(h,function(i){t.style.cssText+="background: "+i+"linear-gradient("+e+", "+n+" 0%, "+r+" 100%); "})}e.__esModule=!0;var o=r(n(7)),a=r(n(9)),s=r(n(2)),u=r(n(3)),c=r(n(5)),l=function(t){function e(n,r){function o(t){p(t),a.default.bind(window,"mousemove",p),a.default.bind(window,"mouseup",l)}function l(){a.default.unbind(window,"mousemove",p),a.default.unbind(window,"mouseup",l),d()}function h(){var t=(0,u.default)(this.value);!1!==t?(v.__color.__state=t,v.setValue(v.__color.toOriginal())):this.value=v.__color.toString()}function f(){a.default.unbind(window,"mousemove",m),a.default.unbind(window,"mouseup",f),d()}function d(){v.__onFinishChange&&v.__onFinishChange.call(v,v.__color.toOriginal())}function p(t){t.preventDefault();var e=v.__saturation_field.getBoundingClientRect(),n=(t.clientX-e.left)/(e.right-e.left),r=1-(t.clientY-e.top)/(e.bottom-e.top);return r>1?r=1:r<0&&(r=0),n>1?n=1:n<0&&(n=0),v.__color.v=r,v.__color.s=n,v.setValue(v.__color.toOriginal()),!1}function m(t){t.preventDefault();var e=v.__hue_field.getBoundingClientRect(),n=1-(t.clientY-e.top)/(e.bottom-e.top);return n>1?n=1:n<0&&(n=0),v.__color.h=360*n,v.setValue(v.__color.toOriginal()),!1}!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var g=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this,n,r));g.__color=new s.default(g.getValue()),g.__temp=new s.default(0);var v=g;g.domElement=document.createElement("div"),a.default.makeSelectable(g.domElement,!1),g.__selector=document.createElement("div"),g.__selector.className="selector",g.__saturation_field=document.createElement("div"),g.__saturation_field.className="saturation-field",g.__field_knob=document.createElement("div"),g.__field_knob.className="field-knob",g.__field_knob_border="2px solid ",g.__hue_knob=document.createElement("div"),g.__hue_knob.className="hue-knob",g.__hue_field=document.createElement("div"),g.__hue_field.className="hue-field",g.__input=document.createElement("input"),g.__input.type="text",g.__input_textShadow="0 1px 1px ",a.default.bind(g.__input,"keydown",function(t){13===t.keyCode&&h.call(this)}),a.default.bind(g.__input,"blur",h),a.default.bind(g.__selector,"mousedown",function(){a.default.addClass(this,"drag").bind(window,"mouseup",function(){a.default.removeClass(v.__selector,"drag")})});var y=document.createElement("div");return c.default.extend(g.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),c.default.extend(g.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:g.__field_knob_border+(g.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),c.default.extend(g.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),c.default.extend(g.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),c.default.extend(y.style,{width:"100%",height:"100%",background:"none"}),i(y,"top","rgba(0,0,0,0)","#000"),c.default.extend(g.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),function(t){t.style.background="",t.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",t.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}(g.__hue_field),c.default.extend(g.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:g.__input_textShadow+"rgba(0,0,0,0.7)"}),a.default.bind(g.__saturation_field,"mousedown",o),a.default.bind(g.__field_knob,"mousedown",o),a.default.bind(g.__hue_field,"mousedown",function(t){m(t),a.default.bind(window,"mousemove",m),a.default.bind(window,"mouseup",f)}),g.__saturation_field.appendChild(y),g.__selector.appendChild(g.__field_knob),g.__selector.appendChild(g.__saturation_field),g.__selector.appendChild(g.__hue_field),g.__hue_field.appendChild(g.__hue_knob),g.domElement.appendChild(g.__input),g.domElement.appendChild(g.__selector),g.updateDisplay(),g}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.updateDisplay=function(){var t=(0,u.default)(this.getValue());if(!1!==t){var e=!1;c.default.each(s.default.COMPONENTS,function(n){if(!c.default.isUndefined(t[n])&&!c.default.isUndefined(this.__color.__state[n])&&t[n]!==this.__color.__state[n])return e=!0,{}},this),e&&c.default.extend(this.__color.__state,t)}c.default.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var n=this.__color.v<.5||this.__color.s>.5?255:0,r=255-n;c.default.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+n+","+n+","+n+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,i(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),c.default.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+n+","+n+","+n+")",textShadow:this.__input_textShadow+"rgba("+r+","+r+","+r+",.7)"})},e}(o.default),h=["-moz-","-o-","-webkit-","-ms-",""];e.default=l,t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e,n){var r=document.createElement("li");return e&&r.appendChild(e),n?t.__ul.insertBefore(r,n):t.__ul.appendChild(r),t.onResize(),r}function o(t,e){var n=t.__preset_select[t.__preset_select.selectedIndex];n.innerHTML=e?n.value+"*":n.value}function a(t,e,n){if(n.__li=e,n.__gui=t,A.default.extend(n,{options:function(e){if(arguments.length>1){var r=n.__li.nextElementSibling;return n.remove(),u(t,n.object,n.property,{before:r,factoryArgs:[A.default.toArray(arguments)]})}if(A.default.isArray(e)||A.default.isObject(e)){var i=n.__li.nextElementSibling;return n.remove(),u(t,n.object,n.property,{before:i,factoryArgs:[e]})}},name:function(t){return n.__li.firstElementChild.firstElementChild.innerHTML=t,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof _.default){var r=new x.default(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});A.default.each(["updateDisplay","onChange","onFinishChange","step"],function(t){var e=n[t],i=r[t];n[t]=r[t]=function(){var t=Array.prototype.slice.call(arguments);return i.apply(r,t),e.apply(n,t)}}),T.default.addClass(e,"has-slider"),n.domElement.insertBefore(r.domElement,n.domElement.firstElementChild)}else if(n instanceof x.default){var i=function(e){if(A.default.isNumber(n.__min)&&A.default.isNumber(n.__max)){var r=n.__li.firstElementChild.firstElementChild.innerHTML,i=n.__gui.__listening.indexOf(n)>-1;n.remove();var o=u(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]});return o.name(r),i&&o.listen(),o}return e};n.min=A.default.compose(i,n.min),n.max=A.default.compose(i,n.max)}else n instanceof w.default?(T.default.bind(e,"click",function(){T.default.fakeEvent(n.__checkbox,"click")}),T.default.bind(n.__checkbox,"click",function(t){t.stopPropagation()})):n instanceof b.default?(T.default.bind(e,"click",function(){T.default.fakeEvent(n.__button,"click")}),T.default.bind(e,"mouseover",function(){T.default.addClass(n.__button,"hover")}),T.default.bind(e,"mouseout",function(){T.default.removeClass(n.__button,"hover")})):n instanceof M.default&&(T.default.addClass(e,"color"),n.updateDisplay=A.default.compose(function(t){return e.style.borderLeftColor=n.__color.toString(),t},n.updateDisplay),n.updateDisplay());n.setValue=A.default.compose(function(e){return t.getRoot().__preset_select&&n.isModified()&&o(t.getRoot(),!0),e},n.setValue)}function s(t,e){var n=t.getRoot(),r=n.__rememberedObjects.indexOf(e.object);if(-1!==r){var i=n.__rememberedObjectIndecesToControllers[r];if(void 0===i&&(n.__rememberedObjectIndecesToControllers[r]=i={}),i[e.property]=e,n.load&&n.load.remembered){var o=n.load.remembered,a=void 0;if(o[t.preset])a=o[t.preset];else{if(!o[C])return;a=o[C]}if(a[r]&&void 0!==a[r][e.property]){var s=a[r][e.property];e.initialValue=s,e.setValue(s)}}}}function u(t,e,n,r){if(void 0===e[n])throw new Error('Object "'+e+'" has no property "'+n+'"');var o=void 0;if(r.color)o=new M.default(e,n);else{var u=[e,n].concat(r.factoryArgs);o=v.default.apply(t,u)}r.before instanceof y.default&&(r.before=r.before.__li),s(t,o),T.default.addClass(o.domElement,"c");var c=document.createElement("span");T.default.addClass(c,"property-name"),c.innerHTML=o.property;var l=document.createElement("div");l.appendChild(c),l.appendChild(o.domElement);var h=i(t,l,r.before);return T.default.addClass(h,N.CLASS_CONTROLLER_ROW),T.default.addClass(h,o instanceof M.default?"color":p(o.getValue())),a(t,h,o),t.__controllers.push(o),o}function c(t,e){return document.location.href+"."+e}function l(t,e,n){var r=document.createElement("option");r.innerHTML=e,r.value=e,t.__preset_select.appendChild(r),n&&(t.__preset_select.selectedIndex=t.__preset_select.length-1)}function h(t,e){e.style.display=t.useLocalStorage?"block":"none"}function f(t,e){t.domElement.style.width=e+"px",t.__save_row&&t.autoPlace&&(t.__save_row.style.width=e+"px"),t.__closeButton&&(t.__closeButton.style.width=e+"px")}function d(t,e){var n={};return A.default.each(t.__rememberedObjects,function(r,i){var o={};A.default.each(t.__rememberedObjectIndecesToControllers[i],function(t,n){o[n]=e?t.initialValue:t.getValue()}),n[i]=o}),n}e.__esModule=!0;var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m=r(n(18)),g=r(n(19)),v=r(n(20)),y=r(n(7)),w=r(n(8)),b=r(n(15)),x=r(n(13)),_=r(n(14)),M=r(n(16)),E=r(n(21)),S=r(n(22)),T=r(n(9)),A=r(n(5)),k=r(n(23));m.default.inject(k.default);var C="Default",R=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}}(),D=void 0,L=!0,O=void 0,P=!1,I=[],N=function t(e){var n=this,r=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),T.default.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],r=A.default.defaults(r,{closeOnTop:!1,autoPlace:!0,width:t.DEFAULT_WIDTH}),r=A.default.defaults(r,{resizable:r.autoPlace,hideable:r.autoPlace}),A.default.isUndefined(r.load)?r.load={preset:C}:r.preset&&(r.load.preset=r.preset),A.default.isUndefined(r.parent)&&r.hideable&&I.push(this),r.resizable=A.default.isUndefined(r.parent)&&r.resizable,r.autoPlace&&A.default.isUndefined(r.scrollable)&&(r.scrollable=!0);var o=R&&"true"===localStorage.getItem(c(0,"isLocal")),a=void 0;if(Object.defineProperties(this,{parent:{get:function(){return r.parent}},scrollable:{get:function(){return r.scrollable}},autoPlace:{get:function(){return r.autoPlace}},closeOnTop:{get:function(){return r.closeOnTop}},preset:{get:function(){return n.parent?n.getRoot().preset:r.load.preset},set:function(t){n.parent?n.getRoot().preset=t:r.load.preset=t,function(t){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].value===t.preset&&(t.__preset_select.selectedIndex=e)}(this),n.revert()}},width:{get:function(){return r.width},set:function(t){r.width=t,f(n,t)}},name:{get:function(){return r.name},set:function(t){r.name=t,titleRowName&&(titleRowName.innerHTML=r.name)}},closed:{get:function(){return r.closed},set:function(e){r.closed=e,r.closed?T.default.addClass(n.__ul,t.CLASS_CLOSED):T.default.removeClass(n.__ul,t.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=e?t.TEXT_OPEN:t.TEXT_CLOSED)}},load:{get:function(){return r.load}},useLocalStorage:{get:function(){return o},set:function(t){R&&(o=t,t?T.default.bind(window,"unload",a):T.default.unbind(window,"unload",a),localStorage.setItem(c(0,"isLocal"),t))}}}),A.default.isUndefined(r.parent)){if(r.closed=!1,T.default.addClass(this.domElement,t.CLASS_MAIN),T.default.makeSelectable(this.domElement,!1),R&&o){n.useLocalStorage=!0;var s=localStorage.getItem(c(0,"gui"));s&&(r.load=JSON.parse(s))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=t.TEXT_CLOSED,T.default.addClass(this.__closeButton,t.CLASS_CLOSE_BUTTON),r.closeOnTop?(T.default.addClass(this.__closeButton,t.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(T.default.addClass(this.__closeButton,t.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),T.default.bind(this.__closeButton,"click",function(){n.closed=!n.closed})}else{void 0===r.closed&&(r.closed=!0);var u=document.createTextNode(r.name);T.default.addClass(u,"controller-name");var l=i(n,u);T.default.addClass(this.__ul,t.CLASS_CLOSED),T.default.addClass(l,"title"),T.default.bind(l,"click",function(t){return t.preventDefault(),n.closed=!n.closed,!1}),r.closed||(this.closed=!1)}r.autoPlace&&(A.default.isUndefined(r.parent)&&(L&&(O=document.createElement("div"),T.default.addClass(O,"dg"),T.default.addClass(O,t.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(O),L=!1),O.appendChild(this.domElement),T.default.addClass(this.domElement,t.CLASS_AUTO_PLACE)),this.parent||f(n,r.width)),this.__resizeHandler=function(){n.onResizeDebounced()},T.default.bind(window,"resize",this.__resizeHandler),T.default.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),T.default.bind(this.__ul,"transitionend",this.__resizeHandler),T.default.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),r.resizable&&function(t){function e(e){return e.preventDefault(),t.width+=i-e.clientX,t.onResize(),i=e.clientX,!1}function n(){T.default.removeClass(t.__closeButton,N.CLASS_DRAG),T.default.unbind(window,"mousemove",e),T.default.unbind(window,"mouseup",n)}function r(r){return r.preventDefault(),i=r.clientX,T.default.addClass(t.__closeButton,N.CLASS_DRAG),T.default.bind(window,"mousemove",e),T.default.bind(window,"mouseup",n),!1}var i=void 0;t.__resize_handle=document.createElement("div"),A.default.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),T.default.bind(t.__resize_handle,"mousedown",r),T.default.bind(t.__closeButton,"mousedown",r),t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild)}(this),this.saveToLocalStorageIfPossible=a=function(){R&&"true"===localStorage.getItem(c(0,"isLocal"))&&localStorage.setItem(c(0,"gui"),JSON.stringify(n.getSaveObject()))},r.parent||function(){var t=n.getRoot();t.width+=1,A.default.defer(function(){t.width-=1})}()};N.toggleHide=function(){P=!P,A.default.each(I,function(t){t.domElement.style.display=P?"none":""})},N.CLASS_AUTO_PLACE="a",N.CLASS_AUTO_PLACE_CONTAINER="ac",N.CLASS_MAIN="main",N.CLASS_CONTROLLER_ROW="cr",N.CLASS_TOO_TALL="taller-than-window",N.CLASS_CLOSED="closed",N.CLASS_CLOSE_BUTTON="close-button",N.CLASS_CLOSE_TOP="close-top",N.CLASS_CLOSE_BOTTOM="close-bottom",N.CLASS_DRAG="drag",N.DEFAULT_WIDTH=245,N.TEXT_CLOSED="Close Controls",N.TEXT_OPEN="Open Controls",N._keydownHandler=function(t){"text"===document.activeElement.type||72!==t.which&&72!==t.keyCode||N.toggleHide()},T.default.bind(window,"keydown",N._keydownHandler,!1),A.default.extend(N.prototype,{add:function(t,e){return u(this,t,e,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(t,e){return u(this,t,e,{color:!0})},remove:function(t){this.__ul.removeChild(t.__li),this.__controllers.splice(this.__controllers.indexOf(t),1);var e=this;A.default.defer(function(){e.onResize()})},destroy:function(){this.autoPlace&&O.removeChild(this.domElement),T.default.unbind(window,"keydown",N._keydownHandler,!1),T.default.unbind(window,"resize",this.__resizeHandler),this.saveToLocalStorageIfPossible&&T.default.unbind(window,"unload",this.saveToLocalStorageIfPossible)},addFolder:function(t){if(void 0!==this.__folders[t])throw new Error('You already have a folder in this GUI by the name "'+t+'"');var e={name:t,parent:this};e.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[t]&&(e.closed=this.load.folders[t].closed,e.load=this.load.folders[t]);var n=new N(e);this.__folders[t]=n;var r=i(this,n.domElement);return T.default.addClass(r,"folder"),n},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var t=this.getRoot();if(t.scrollable){var e=T.default.getOffset(t.__ul).top,n=0;A.default.each(t.__ul.childNodes,function(e){t.autoPlace&&e===t.__save_row||(n+=T.default.getHeight(e))}),window.innerHeight-e-20<n?(T.default.addClass(t.domElement,N.CLASS_TOO_TALL),t.__ul.style.height=window.innerHeight-e-20+"px"):(T.default.removeClass(t.domElement,N.CLASS_TOO_TALL),t.__ul.style.height="auto")}t.__resize_handle&&A.default.defer(function(){t.__resize_handle.style.height=t.__ul.offsetHeight+"px"}),t.__closeButton&&(t.__closeButton.style.width=t.width+"px")},onResizeDebounced:A.default.debounce(function(){this.onResize()},50),remember:function(){if(A.default.isUndefined(D)&&((D=new S.default).domElement.innerHTML=g.default),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;A.default.each(Array.prototype.slice.call(arguments),function(e){0===t.__rememberedObjects.length&&function(t){var e=t.__save_row=document.createElement("li");T.default.addClass(t.domElement,"has-save"),t.__ul.insertBefore(e,t.__ul.firstChild),T.default.addClass(e,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",T.default.addClass(n,"button gears");var r=document.createElement("span");r.innerHTML="Save",T.default.addClass(r,"button"),T.default.addClass(r,"save");var i=document.createElement("span");i.innerHTML="New",T.default.addClass(i,"button"),T.default.addClass(i,"save-as");var o=document.createElement("span");o.innerHTML="Revert",T.default.addClass(o,"button"),T.default.addClass(o,"revert");var a=t.__preset_select=document.createElement("select");if(t.load&&t.load.remembered?A.default.each(t.load.remembered,function(e,n){l(t,n,n===t.preset)}):l(t,C,!1),T.default.bind(a,"change",function(){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].innerHTML=t.__preset_select[e].value;t.preset=this.value}),e.appendChild(a),e.appendChild(n),e.appendChild(r),e.appendChild(i),e.appendChild(o),R){var s=document.getElementById("dg-local-explain"),u=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(c(0,"isLocal"))&&u.setAttribute("checked","checked"),h(t,s),T.default.bind(u,"change",function(){t.useLocalStorage=!t.useLocalStorage,h(t,s)})}var f=document.getElementById("dg-new-constructor");T.default.bind(f,"keydown",function(t){!t.metaKey||67!==t.which&&67!==t.keyCode||D.hide()}),T.default.bind(n,"click",function(){f.innerHTML=JSON.stringify(t.getSaveObject(),void 0,2),D.show(),f.focus(),f.select()}),T.default.bind(r,"click",function(){t.save()}),T.default.bind(i,"click",function(){var e=prompt("Enter a new preset name.");e&&t.saveAs(e)}),T.default.bind(o,"click",function(){t.revert()})}(t),-1===t.__rememberedObjects.indexOf(e)&&t.__rememberedObjects.push(e)}),this.autoPlace&&f(this,this.width)},getRoot:function(){for(var t=this;t.parent;)t=t.parent;return t},getSaveObject:function(){var t=this.load;return t.closed=this.closed,this.__rememberedObjects.length>0&&(t.preset=this.preset,t.remembered||(t.remembered={}),t.remembered[this.preset]=d(this)),t.folders={},A.default.each(this.__folders,function(e,n){t.folders[n]=e.getSaveObject()}),t},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=d(this),o(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(t){this.load.remembered||(this.load.remembered={},this.load.remembered[C]=d(this,!0)),this.load.remembered[t]=d(this),this.preset=t,l(this,t,!0),this.saveToLocalStorageIfPossible()},revert:function(t){A.default.each(this.__controllers,function(e){this.getRoot().load.remembered?s(t||this.getRoot(),e):e.setValue(e.initialValue),e.__onFinishChange&&e.__onFinishChange.call(e,e.getValue())},this),A.default.each(this.__folders,function(t){t.revert(t)}),t||o(this.getRoot(),!1)},listen:function(t){var e=0===this.__listening.length;this.__listening.push(t),e&&function t(e){0!==e.length&&E.default.call(window,function(){t(e)}),A.default.each(e,function(t){t.updateDisplay()})}(this.__listening)},updateDisplay:function(){A.default.each(this.__controllers,function(t){t.updateDisplay()}),A.default.each(this.__folders,function(t){t.updateDisplay()})}}),e.default=N,t.exports=e.default},function(t,e){"use strict";t.exports={load:function(t,e){var n=e||document,r=n.createElement("link");r.type="text/css",r.rel="stylesheet",r.href=t,n.getElementsByTagName("head")[0].appendChild(r)},inject:function(t,e){var n=e||document,r=document.createElement("style");r.type="text/css",r.innerHTML=t;var i=n.getElementsByTagName("head")[0];try{i.appendChild(r)}catch(t){}}}},function(t,e){t.exports="<div id=dg-save class=\"dg dialogue\"> Here's the new load parameter for your <code>GUI</code>'s constructor: <textarea id=dg-new-constructor></textarea> <div id=dg-save-locally> <input id=dg-local-storage type=checkbox /> Automatically save values to <code>localStorage</code> on exit. <div id=dg-local-explain>The values saved to <code>localStorage</code> will override those passed to <code>dat.GUI</code>'s constructor. This makes it easier to work incrementally, but <code>localStorage</code> is fragile, and your friends may not see the same values you do. </div> </div> </div>"},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(n(10)),o=r(n(13)),a=r(n(14)),s=r(n(11)),u=r(n(15)),c=r(n(8)),l=r(n(5));e.default=function(t,e){var n=t[e];return l.default.isArray(arguments[2])||l.default.isObject(arguments[2])?new i.default(t,e,arguments[2]):l.default.isNumber(n)?l.default.isNumber(arguments[2])&&l.default.isNumber(arguments[3])?l.default.isNumber(arguments[4])?new a.default(t,e,arguments[2],arguments[3],arguments[4]):new a.default(t,e,arguments[2],arguments[3]):l.default.isNumber(arguments[4])?new o.default(t,e,{min:arguments[2],max:arguments[3],step:arguments[4]}):new o.default(t,e,{min:arguments[2],max:arguments[3]}):l.default.isString(n)?new s.default(t,e):l.default.isFunction(n)?new u.default(t,e,""):l.default.isBoolean(n)?new c.default(t,e):null},t.exports=e.default},function(t,e){"use strict";e.__esModule=!0,e.default=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,1e3/60)},t.exports=e.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=r(n(9)),o=r(n(5)),a=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.backgroundElement=document.createElement("div"),o.default.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),i.default.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),o.default.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;i.default.bind(this.backgroundElement,"click",function(){e.hide()})}return t.prototype.show=function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),o.default.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})},t.prototype.hide=function(){var t=this,e=function e(){t.domElement.style.display="none",t.backgroundElement.style.display="none",i.default.unbind(t.domElement,"webkitTransitionEnd",e),i.default.unbind(t.domElement,"transitionend",e),i.default.unbind(t.domElement,"oTransitionEnd",e)};i.default.bind(this.domElement,"webkitTransitionEnd",e),i.default.bind(this.domElement,"transitionend",e),i.default.bind(this.domElement,"oTransitionEnd",e),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},t.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-i.default.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-i.default.getHeight(this.domElement)/2+"px"},t}();e.default=a,t.exports=e.default},function(t,e,n){(t.exports=n(24)()).push([t.id,".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1!important}.dg.main .close-button.drag,.dg.main:hover .close-button{opacity:1}.dg.main .close-button{transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{transition:height .1s ease-out;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid transparent}.dg li.title{margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.boolean,.dg .cr.boolean *,.dg .cr.function,.dg .cr.function *,.dg .cr.function .property-name{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco,monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px Lucida Grande,sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid hsla(0,0%,100%,.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.boolean:hover,.dg .cr.function:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}",""])},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];t.push(n[2]?"@media "+n[2]+"{"+n[1]+"}":n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(r[o]=!0)}for(i=0;i<e.length;i++){var a=e[i];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}}])}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.vega=t.vega||{})}(this,function(t){"use strict";var e=function(t,e,n){return t.fields=e||[],t.fname=n,t};function n(t){return null==t?null:t.fname}function r(t){return null==t?null:t.fields}var i=function(t){throw Error(t)},o=function(t){var e,n,r,o=[],a=null,s=0,u=t.length,c="";function l(){o.push(c+t.substring(e,n)),c="",e=n+1}for(t+="",e=n=0;n<u;++n)if("\\"===(r=t[n]))c+=t.substring(e,n),e=++n;else if(r===a)l(),a=null,s=-1;else{if(a)continue;e===s&&'"'===r?(e=n+1,a=r):e===s&&"'"===r?(e=n+1,a=r):"."!==r||s?"["===r?(n>e&&l(),s=e=n+1):"]"===r&&(s||i("Access path missing open bracket: "+t),s>0&&l(),s=0,e=n+1):n>e?l():e=n+1}return s&&i("Access path missing closing bracket: "+t),a&&i("Access path missing closing quote: "+t),n>e&&(n++,l()),o},a=Array.isArray,s=function(t){return t===Object(t)},u=function(t){return"string"==typeof t};function c(t){return a(t)?"["+t.map(c)+"]":s(t)||u(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}var l=function(t,n){var r=o(t),i="return _["+r.map(c).join("][")+"];";return e(Function("_",i),[t=1===r.length?r[0]:t],n||t)},h=[],f=l("id"),d=e(function(t){return t},h,"identity"),p=e(function(){return 0},h,"zero"),m=e(function(){return 1},h,"one"),g=e(function(){return!0},h,"true"),v=e(function(){return!1},h,"false");function y(t,e,n){var r=[e].concat([].slice.call(n));console[t].apply(console,r)}var w=1,b=function(t){var e=t||0;return{level:function(t){return arguments.length?(e=+t,this):e},error:function(){return e>=w&&y("error","ERROR",arguments),this},warn:function(){return e>=2&&y("warn","WARN",arguments),this},info:function(){return e>=3&&y("log","INFO",arguments),this},debug:function(){return e>=4&&y("log","DEBUG",arguments),this}}},x=function(t){return t[t.length-1]},_=function(t){return null==t||""===t?null:+t};function M(t){return function(e){return t*Math.exp(e)}}function E(t){return function(e){return Math.log(t*e)}}function S(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function T(t,e,n,r){var i=n(t[0]),o=n(x(t)),a=(o-i)*e;return[r(i-a),r(o-a)]}function A(t,e){return T(t,e,_,d)}function k(t,e){var n=Math.sign(t[0]);return T(t,e,E(n),M(n))}function C(t,e,n){return T(t,e,S(n),S(1/n))}function R(t,e,n,r,i){var o=r(t[0]),a=r(x(t)),s=null!=e?r(e):(o+a)/2;return[i(s+(o-s)*n),i(s+(a-s)*n)]}function D(t,e,n){return R(t,e,n,_,d)}function L(t,e,n){var r=Math.sign(t[0]);return R(t,e,n,E(r),M(r))}function O(t,e,n,r){return R(t,e,n,S(r),S(1/r))}var P=function(t){return null!=t?a(t)?t:[t]:[]},I=function(t){return"function"==typeof t},N=function(t,n){var i,a,s,u,l,h,f,d,p,m=[],g=(t=P(t)).map(function(t,e){return null==t?null:(m.push(e),I(t)?t:o(t).map(c).join("]["))}),v=m.length-1,y=P(n),w="var u,v;return ";if(v<0)return null;for(a=0;a<=v;++a)s=g[i=m[a]],I(s)?(u="(u=this."+(h="f"+i)+"(a))",l="(v=this."+h+"(b))",(f=f||{})[h]=s):(u="(u=a["+s+"])",l="(v=b["+s+"])"),h="((v=v instanceof Date?+v:v),(u=u instanceof Date?+u:u))","descending"!==y[i]?(p=1,d=-1):(p=-1,d=1),w+="("+u+"<"+l+"||u==null)&&v!=null?"+d+":(u>v||v==null)&&u!=null?"+p+":"+h+"!==u&&v===v?"+d+":v!==v&&u===u?"+p+(i<v?":":":0");return s=Function("a","b",w+";"),f&&(s=s.bind(f)),t=t.reduce(function(t,e){return I(e)?(r(e)||[]).forEach(function(e){t[e]=1}):null!=e&&(t[e+""]=1),t},{}),e(s,Object.keys(t))},F=function(t){return I(t)?t:function(){return t}},j=function(t,e){var n,r;function i(){e(r),n=r=null}return function(e){r=e,n&&clearTimeout(n),n=setTimeout(i,t)}},z=function(t){for(var e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r])t[n]=e[n];return t},U=function(t,e){var n,r,i,o,a,s=-1,u=t.length;if(null==e){for(;++s<u;)if(null!=(r=t[s])&&r>=r){n=i=r;break}for(o=a=s;++s<u;)null!=(r=t[s])&&(n>r&&(n=r,o=s),i<r&&(i=r,a=s))}else{for(;++s<u;)if(null!=(r=e(t[s],s,t))&&r>=r){n=i=r;break}for(o=a=s;++s<u;)null!=(r=e(t[s],s,t))&&(n>r&&(n=r,o=s),i<r&&(i=r,a=s))}return[o,a]},V={},B=function(t){var e,n,r={};function i(t){return r.hasOwnProperty(t)&&r[t]!==V}return e={size:0,empty:0,object:r,has:i,get:function(t){return i(t)?r[t]:void 0},set:function(t,n){return i(t)||(++e.size,r[t]===V&&--e.empty),r[t]=n,this},delete:function(t){return i(t)&&(--e.size,++e.empty,r[t]=V),this},clear:function(){e.size=e.empty=0,e.object=r={}},test:function(t){return arguments.length?(n=t,e):n},clean:function(){var t,i,o={},a=0;for(t in r)(i=r[t])===V||n&&n(i)||(o[t]=i,++a);e.size=a,e.empty=0,e.object=r=o}},t&&Object.keys(t).forEach(function(n){e.set(n,t[n])}),e},H=function(t,e){var n=t.prototype=Object.create(e.prototype);return n.constructor=t,n},q=function(t){return"boolean"==typeof t},G=function(t){return"[object Date]"===Object.prototype.toString.call(t)},W=function(t){return"number"==typeof t},Y=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},X=function(t,n){t&&(t=n?P(t).map(function(t){return t.replace(/\\(.)/g,"$1")}):P(t));var r=t&&t.length?Function("_","return ''+"+t.map(function(t){return"_["+(n?c(t):o(t).map(c).join("]["))+"]"}).join("+'|'+")+";"):function(){return""};return e(r,t,"key")},$=function(t,e,n,r){var i=e.length,o=n.length;if(!o)return e;if(!i)return n;for(var a=r||new e.constructor(i+o),s=0,u=0,c=0;s<i&&u<o;++c)a[c]=t(e[s],n[u])>0?n[u++]:e[s++];for(;s<i;++s,++c)a[c]=e[s];for(;u<o;++u,++c)a[c]=n[u];return a},Q=function(t,e){for(var n="";--e>=0;)n+=t;return n},J=function(t,e,n,r){var i=n||" ",o=t+"",a=e-o.length;return a<=0?o:"left"===r?Q(i,a)+o:"center"===r?Q(i,~~(a/2))+o+Q(i,Math.ceil(a/2)):o+Q(i,a)},Z=function(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t||!t)};function K(t){return W(t)?t:G(t)?t:Date.parse(t)}var tt=function(t,e){return e=e||K,null==t||""===t?null:e(t)},et=function(t){return null==t||""===t?null:t+""},nt=function(t){for(var e={},n=0,r=t.length;n<r;++n)e[t[n]]=1;return e},rt=function(t,e,n,r){var i=null!=r?r:"\u2026",o=t+"",a=o.length,s=Math.max(0,e-i.length);return a<=e?o:"left"===n?i+o.slice(a-s):"center"===n?o.slice(0,Math.ceil(s/2))+i+o.slice(a-~~(s/2)):o.slice(0,s)+i},it=function(t,e,n){if(t){var r,i=0,o=t.length;if(e)for(;i<o;++i)(r=e(t[i]))&&n(r,i,t);else t.forEach(n)}};function ot(t){var e=t||d,n=[],r={};return n.add=function(t){var i=e(t);return r[i]||(r[i]=1,n.push(t)),n},n.remove=function(t){var i,o=e(t);return r[o]&&(r[o]=0,(i=n.indexOf(t))>=0&&n.splice(i,1)),n},n}var at=Symbol("vega_id"),st=1;function ut(t){return!(!t||!ct(t))}function ct(t){return t[at]}function lt(t,e){return t[at]=e,t}function ht(t){var e=t===Object(t)?t:{data:t};return ct(e)?e:lt(e,st++)}function ft(t){return dt(t,ht({}))}function dt(t,e){for(var n in t)e[n]=t[n];return e}function pt(t,e){return lt(e,ct(t))}function mt(t){return t&&t.constructor===gt}function gt(){var t=[],e=[],n=[],r=[],i=[],o=!1;return{constructor:gt,insert:function(e){for(var n=P(e),r=0,i=n.length;r<i;++r)t.push(n[r]);return this},remove:function(t){for(var n=I(t)?r:e,i=P(t),o=0,a=i.length;o<a;++o)n.push(i[o]);return this},modify:function(t,e,r){var o={field:e,value:F(r)};return I(t)?(o.filter=t,i.push(o)):(o.tuple=t,n.push(o)),this},encode:function(t,e){return I(t)?i.push({filter:t,field:e}):n.push({tuple:t,field:e}),this},reflow:function(){return o=!0,this},pulse:function(a,s){var u,c,l,h,f,d,p;for(c=0,l=t.length;c<l;++c)a.add.push(ht(t[c]));for(u={},c=0,l=e.length;c<l;++c)u[ct(d=e[c])]=d;for(c=0,l=r.length;c<l;++c)f=r[c],s.forEach(function(t){f(t)&&(u[ct(t)]=t)});for(p in u)a.rem.push(u[p]);function m(t,e,n){n?t[e]=n(t):a.encode=e,o||(u[ct(t)]=t)}for(u={},c=0,l=n.length;c<l;++c)m((h=n[c]).tuple,h.field,h.value),a.modifies(h.field);for(c=0,l=i.length;c<l;++c)f=(h=i[c]).filter,s.forEach(function(t){f(t)&&m(t,h.field,h.value)}),a.modifies(h.field);if(o)a.mod=e.length||r.length?s.filter(function(t){return u.hasOwnProperty(ct(t))}):s.slice();else for(p in u)a.mod.push(u[p]);return a}}}var vt="_:mod:_";function yt(){Object.defineProperty(this,vt,{writable:!0,value:{}})}var wt=yt.prototype;wt.set=function(t,e,n,r){var i=this[t],o=this[vt];return null!=e&&e>=0?(i[e]!==n||r)&&(i[e]=n,o[e+":"+t]=-1,o[t]=-1):(i!==n||r)&&(this[t]=n,o[t]=a(n)?1+n.length:-1),this},wt.modified=function(t,e){var n,r=this[vt];if(!arguments.length){for(n in r)if(r[n])return!0;return!1}if(a(t)){for(n=0;n<t.length;++n)if(r[t[n]])return!0;return!1}return null!=e&&e>=0?e+1<r[t]||!!r[e+":"+t]:!!r[t]},wt.clear=function(){return this[vt]={},this};var bt=0,xt=new yt;function _t(t,e,n,r){this.id=++bt,this.value=t,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,e&&(this._update=e),n&&this.parameters(n,r)}var Mt=_t.prototype;function Et(t){return function(e){var n=this.flags;return 0===arguments.length?!!(n&t):(this.flags=e?n|t:n&~t,this)}}Mt.targets=function(){return this._targets||(this._targets=ot(f))},Mt.set=function(t){return this.value!==t?(this.value=t,1):0},Mt.skip=Et(1),Mt.modified=Et(2),Mt.parameters=function(t,e){e=!1!==e;var n,r,o,s,u=this,c=u._argval=u._argval||new yt,l=u._argops=u._argops||[],h=[];function f(t,n,r){r instanceof _t?(r!==u&&(e&&r.targets().add(u),h.push(r)),l.push({op:r,name:t,index:n})):c.set(t,n,r)}for(n in t)if(r=t[n],"pulse"===n)P(r).forEach(function(t){t instanceof _t?t!==u&&(t.targets().add(u),h.push(t)):i("Pulse parameters must be operator instances.")}),u.source=r;else if(a(r))for(c.set(n,-1,Array(o=r.length)),s=0;s<o;++s)f(n,s,r[s]);else f(n,-1,r);return this.marshall().clear(),h},Mt.marshall=function(t){var e,n,r,i,o,a=this._argval||xt,s=this._argops;if(s&&(r=s.length))for(n=0;n<r;++n)o=(i=(e=s[n]).op).modified()&&i.stamp===t,a.set(e.name,e.index,i.value,o);return a},Mt.evaluate=function(t){if(this._update){var e=this.marshall(t.stamp),n=this._update(e,t);if(e.clear(),n!==this.value)this.value=n;else if(!this.modified())return t.StopPropagation}},Mt.run=function(t){return t.stamp<=this.stamp?t.StopPropagation:(this.skip()?(this.skip(!1),e=0):e=this.evaluate(t),this.stamp=t.stamp,this.pulse=e,e||t);var e};var St=0;function Tt(t,e,n){this.id=++St,this.value=null,n&&(this.receive=n),t&&(this._filter=t),e&&(this._apply=e)}function At(t,e,n){return new Tt(t,e,n)}var kt=Tt.prototype;kt._filter=g,kt._apply=d,kt.targets=function(){return this._targets||(this._targets=ot(f))},kt.consume=function(t){return arguments.length?(this._consume=!!t,this):!!this._consume},kt.receive=function(t){if(this._filter(t)){for(var e=this.value=this._apply(t),n=this._targets,r=n?n.length:0,i=0;i<r;++i)n[i].receive(e);this._consume&&(t.preventDefault(),t.stopPropagation())}},kt.filter=function(t){var e=At(t);return this.targets().add(e),e},kt.apply=function(t){var e=At(null,t);return this.targets().add(e),e},kt.merge=function(){var t=At();this.targets().add(t);for(var e=0,n=arguments.length;e<n;++e)arguments[e].targets().add(t);return t},kt.throttle=function(t){var e=-1;return this.filter(function(){var n=Date.now();return n-e>t?(e=n,1):0})},kt.debounce=function(t){var e=At();return this.targets().add(At(null,null,j(t,function(t){var n=t.dataflow;e.receive(t),n&&n.run&&n.run()}))),e},kt.between=function(t,e){var n=!1;return t.targets().add(At(null,null,function(){n=!0})),e.targets().add(At(null,null,function(){n=!1})),this.filter(function(){return n})};var Ct="$";function Rt(){}function Dt(t,e){var n=new Rt;if(t instanceof Rt)t.each(function(t,e){n.set(e,t)});else if(Array.isArray(t)){var r,i=-1,o=t.length;if(null==e)for(;++i<o;)n.set(i,t[i]);else for(;++i<o;)n.set(e(r=t[i],i,t),r)}else if(t)for(var a in t)n.set(a,t[a]);return n}function Lt(){return{}}function Ot(t,e,n){t[e]=n}function Pt(){return Dt()}function It(t,e,n){t.set(e,n)}function Nt(){}Rt.prototype=Dt.prototype={constructor:Rt,has:function(t){return Ct+t in this},get:function(t){return this[Ct+t]},set:function(t,e){return this[Ct+t]=e,this},remove:function(t){var e=Ct+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===Ct&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===Ct&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===Ct&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===Ct&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===Ct&&++t;return t},empty:function(){for(var t in this)if(t[0]===Ct)return!1;return!0},each:function(t){for(var e in this)e[0]===Ct&&t(this[e],e.slice(1),this)}};var Ft=Dt.prototype;Nt.prototype=(function(t,e){var n=new Nt;if(t instanceof Nt)t.each(function(t){n.add(t)});else if(t){var r=-1,i=t.length;if(null==e)for(;++r<i;)n.add(t[r]);else for(;++r<i;)n.add(e(t[r],r,t))}return n}).prototype={constructor:Nt,has:Ft.has,add:function(t){return this[Ct+(t+="")]=t,this},remove:Ft.remove,clear:Ft.clear,values:Ft.keys,size:Ft.size,empty:Ft.empty,each:Ft.each};var jt={value:function(){}};function zt(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r)throw new Error("illegal type: "+t);r[t]=[]}return new Ut(r)}function Ut(t){this._=t}function Vt(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function Bt(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=jt,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}Ut.prototype=zt.prototype={constructor:Ut,on:function(t,e){var n,r,i=this._,o=(r=i,(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})),a=-1,s=o.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<s;)if(n=(t=o[a]).type)i[n]=Bt(i[n],t.name,e);else if(null==e)for(n in i)i[n]=Bt(i[n],t.name,null);return this}for(;++a<s;)if((n=(t=o[a]).type)&&(n=Vt(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ut(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var Ht=function(t,e){var n,r,i,o,a=zt("beforesend","progress","load","error"),s=Dt(),u=new XMLHttpRequest,c=null,l=null,h=0;function f(t){var e,r,o,s=u.status;if(!s&&((o=(r=u).responseType)&&"text"!==o?r.response:r.responseText)||s>=200&&s<300||304===s){if(i)try{e=i.call(n,u)}catch(t){return void a.call("error",n,t)}else e=u;a.call("load",n,e)}else a.call("error",n,t)}if("undefined"==typeof XDomainRequest||"withCredentials"in u||!/^(http(s)?:)?\/\//.test(t)||(u=new XDomainRequest),"onload"in u?u.onload=u.onerror=u.ontimeout=f:u.onreadystatechange=function(t){u.readyState>3&&f(t)},u.onprogress=function(t){a.call("progress",n,t)},n={header:function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?s.get(t):(null==e?s.remove(t):s.set(t,e+""),n)},mimeType:function(t){return arguments.length?(r=null==t?null:t+"",n):r},responseType:function(t){return arguments.length?(o=t,n):o},timeout:function(t){return arguments.length?(h=+t,n):h},user:function(t){return arguments.length<1?c:(c=null==t?null:t+"",n)},password:function(t){return arguments.length<1?l:(l=null==t?null:t+"",n)},response:function(t){return i=t,n},get:function(t,e){return n.send("GET",t,e)},post:function(t,e){return n.send("POST",t,e)},send:function(e,i,f){var d;return u.open(e,t,!0,c,l),null==r||s.has("accept")||s.set("accept",r+",*/*"),u.setRequestHeader&&s.each(function(t,e){u.setRequestHeader(e,t)}),null!=r&&u.overrideMimeType&&u.overrideMimeType(r),null!=o&&(u.responseType=o),h>0&&(u.timeout=h),null==f&&"function"==typeof i&&(f=i,i=null),null!=f&&1===f.length&&(d=f,f=function(t,e){d(null==t?e:null)}),null!=f&&n.on("error",f).on("load",function(t){f(null,t)}),a.call("beforesend",n,u),u.send(null==i?null:i),n},abort:function(){return u.abort(),n},on:function(){var t=a.on.apply(a,arguments);return t===a?n:t}},null!=e){if("function"!=typeof e)throw new Error("invalid callback: "+e);return n.get(e)}return n},qt={},Gt={},Wt=34,Yt=10,Xt=13;function $t(t){return new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}")}var Qt=function(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],o=t.length,a=0,s=0,u=o<=0,c=!1;function l(){if(u)return Gt;if(c)return c=!1,qt;var e,r,i=a;if(t.charCodeAt(i)===Wt){for(;a++<o&&t.charCodeAt(a)!==Wt||t.charCodeAt(++a)===Wt;);return(e=a)>=o?u=!0:(r=t.charCodeAt(a++))===Yt?c=!0:r===Xt&&(c=!0,t.charCodeAt(a)===Yt&&++a),t.slice(i+1,e-1).replace(/""/g,'"')}for(;a<o;){if((r=t.charCodeAt(e=a++))===Yt)c=!0;else if(r===Xt)c=!0,t.charCodeAt(a)===Yt&&++a;else if(r!==n)continue;return t.slice(i,e)}return u=!0,t.slice(i,o)}for(t.charCodeAt(o-1)===Yt&&--o,t.charCodeAt(o-1)===Xt&&--o;(r=l())!==Gt;){for(var h=[];r!==qt&&r!==Gt;)h.push(r),r=l();e&&null==(h=e(h,s++))||i.push(h)}return i}function i(e){return e.map(o).join(t)}function o(t){return null==t?"":e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,i,o=r(t,function(t,r){if(n)return n(t,r-1);var o,a,s;i=t,n=e?(a=e,s=$t(o=t),function(t,e){return a(s(t),e,o)}):$t(t)});return o.columns=i||[],o},parseRows:r,format:function(e,n){var r,i,a;return null==n&&(r=e,i=Object.create(null),a=[],r.forEach(function(t){for(var e in t)e in i||a.push(i[e]=e)}),n=a),[n.map(o).join(t)].concat(e.map(function(e){return n.map(function(t){return o(e[t])}).join(t)})).join("\n")},formatRows:function(t){return t.map(i).join("\n")}}},Jt=(Qt(","),Qt("\t"),/^([A-Za-z]+:)?\/\//),Zt="file://",Kt=["mimeType","responseType","user","password"],te=function(t){return{options:t||{},sanitize:re,load:ne,file:oe,http:ie}};function ee(t,e){return z({},t.options,e)}function ne(t,e){var n=this;return n.sanitize(t,e).then(function(t){var r=t.href;return t.localFile?n.file(r):n.http(r,e)})}function re(t,e){return e=ee(this,e),new Promise(function(n,r){var i,o,a,s,u={href:null};null!=t&&"string"==typeof t?(o=Jt.test(t),(s=e.baseURL)&&!o&&(se(t,"/")||"/"===s[s.length-1]||(t="/"+t),t=s+t),a=(i=se(t,Zt))||"file"===e.mode||"http"!==e.mode&&!o&&ae(),i?t=t.slice(Zt.length):se(t,"//")&&("file"===e.defaultProtocol?(t=t.slice(2),a=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(u,"localFile",{value:!!a}),u.href=t,n(u)):r("Sanitize failure, invalid URI: "+c(t))})}function ie(t,e){return e=ee(this,e),new Promise(function(n,r){var i,o=Ht(t);for(i in e.headers)o.header(i,e.headers[i]);Kt.forEach(function(t){e[t]&&o[t](e[t])}),o.on("error",function(e){r(e||"Error loading URL: "+t)}).on("load",function(t){var e=t&&t.responseText;t&&0!==t.status?n(e):r(e||"Error")}).get()})}function oe(t){return new Promise(function(e,n){var r=ae();r?r.readFile(t,function(t,r){t?n(t):e(r)}):n("No file system access for "+t)})}function ae(){var t="function"==typeof require&&require("fs");return t&&I(t.readFile)?t:null}function se(t,e){return null!=t&&0===t.lastIndexOf(e,0)}var ue={boolean:Z,integer:_,number:_,date:tt,string:et,unknown:d},ce=[function(t){return"true"===t||"false"===t||!0===t||!1===t},function(t){return de(t)&&(t=+t)==~~t},de,function(t){return!isNaN(Date.parse(t))}],le=["boolean","integer","number","date"];function he(t,e){if(!t||!t.length)return"unknown";var n,r,i,o,a,s=ce.slice();for(r=0,i=t.length;r<i;++r){for(n=e?t[r][e]:t[r],o=0;o<s.length;++o)null==(a=n)||a!=a||s[o](n)||(s.splice(o,1),--o);if(0===s.length)return"string"}return le[ce.indexOf(s[0])]}function fe(t,e){return e.reduce(function(e,n){return e[n]=he(t,n),e},{})}function de(t){return!(isNaN(+t)||t instanceof Date)}function pe(t){return function(e,n){var r={delimiter:t};return me(e,n?z(n,r):r)}}function me(t,e){return e.header&&(t=e.header.map(c).join(e.delimiter)+"\n"+t),Qt(e.delimiter).parse(t+"")}var ge=function(t,e){var n,r=e&&e.property?l(e.property):d;return!s(t)||(n=t,"function"==typeof Buffer&&I(Buffer.isBuffer)&&Buffer.isBuffer(n))?r(JSON.parse(t)):r(t)},ve=function(t){return t},ye=function(t){if(null==t)return ve;var e,n,r=t.scale[0],i=t.scale[1],o=t.translate[0],a=t.translate[1];return function(t,s){s||(e=n=0);var u=2,c=t.length,l=new Array(c);for(l[0]=(e+=t[0])*r+o,l[1]=(n+=t[1])*i+a;u<c;)l[u]=t[u],++u;return l}},we=function(t,e){for(var n,r=t.length,i=r-e;i<--r;)n=t[i],t[i++]=t[r],t[r]=n};function be(t,e){var n=e.id,r=e.bbox,i=null==e.properties?{}:e.properties,o=xe(t,e);return null==n&&null==r?{type:"Feature",properties:i,geometry:o}:null==r?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function xe(t,e){var n=ye(t.transform),r=t.arcs;function i(t,e){e.length&&e.pop();for(var i=r[t<0?~t:t],o=0,a=i.length;o<a;++o)e.push(n(i[o],o));t<0&&we(e,a)}function o(t){return n(t)}function a(t){for(var e=[],n=0,r=t.length;n<r;++n)i(t[n],e);return e.length<2&&e.push(e[0]),e}function s(t){for(var e=a(t);e.length<4;)e.push(e[0]);return e}function u(t){return t.map(s)}return function t(e){var n,r=e.type;switch(r){case"GeometryCollection":return{type:r,geometries:e.geometries.map(t)};case"Point":n=o(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(o);break;case"LineString":n=a(e.arcs);break;case"MultiLineString":n=e.arcs.map(a);break;case"Polygon":n=u(e.arcs);break;case"MultiPolygon":n=e.arcs.map(u);break;default:return null}return{type:r,coordinates:n}}(e)}var _e={dsv:me,csv:pe(","),tsv:pe("\t"),json:ge,topojson:function(t,e){var n,r,o,a;return t=ge(t,e),e&&(r=e.feature)?(n=t.objects[r])?(o=t,a=n,"GeometryCollection"===a.type?{type:"FeatureCollection",features:a.geometries.map(function(t){return be(o,t)})}:be(o,a)).features:i("Invalid TopoJSON object: "+r):e&&(r=e.mesh)?(n=t.objects[r])?[function(t){return xe(t,(function(t,e,n){var r,i,o;if(arguments.length>1)r=function(t,e,n){var r,i=[],o=[];function a(t){var e=t<0?~t:t;(o[e]||(o[e]=[])).push({i:t,g:r})}function s(t){t.forEach(a)}function u(t){t.forEach(s)}return function t(e){switch(r=e,e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"LineString":s(e.arcs);break;case"MultiLineString":case"Polygon":u(e.arcs);break;case"MultiPolygon":e.arcs.forEach(u)}}(e),o.forEach(null==n?function(t){i.push(t[0].i)}:function(t){n(t[0].g,t[t.length-1].g)&&i.push(t[0].i)}),i}(0,e,n);else for(i=0,r=new Array(o=t.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:function(t,e){var n={},r={},i={},o=[],a=-1;function s(t,e){for(var r in t){var i=t[r];delete e[i.start],delete i.start,delete i.end,i.forEach(function(t){n[t<0?~t:t]=1}),o.push(i)}}return e.forEach(function(n,r){var i,o=t.arcs[n<0?~n:n];o.length<3&&!o[1][0]&&!o[1][1]&&(i=e[++a],e[a]=n,e[r]=i)}),e.forEach(function(e){var n,o,a=function(e){var n,r=t.arcs[e<0?~e:e],i=r[0];return t.transform?(n=[0,0],r.forEach(function(t){n[0]+=t[0],n[1]+=t[1]})):n=r[r.length-1],e<0?[n,i]:[i,n]}(e),s=a[0],u=a[1];if(n=i[s])if(delete i[n.end],n.push(e),n.end=u,o=r[u]){delete r[o.start];var c=o===n?n:n.concat(o);r[c.start=n.start]=i[c.end=o.end]=c}else r[n.start]=i[n.end]=n;else if(n=r[u])if(delete r[n.start],n.unshift(e),n.start=s,o=i[s]){delete i[o.end];var l=o===n?n:o.concat(n);r[l.start=o.start]=i[l.end=n.end]=l}else r[n.start]=i[n.end]=n;else r[(n=[e]).start=s]=i[n.end=u]=n}),s(i,r),s(r,i),e.forEach(function(t){n[t<0?~t:t]||o.push([t])}),o}(t,r)}}).apply(this,arguments))}(t,n)]:i("Invalid TopoJSON object: "+r):void i("Missing TopoJSON feature or mesh parameter.")}},Me=function(t,e){return arguments.length>1?(_e[t]=e,this):_e.hasOwnProperty(t)?_e[t]:null},Ee=new Date,Se=new Date;function Te(t,e,n,r){function i(e){return t(e=new Date(+e)),e}return i.floor=i,i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,o){var a,s=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return s;do{s.push(a=new Date(+n)),e(n,o),t(n)}while(a<n&&n<r);return s},i.filter=function(n){return Te(function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)},function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););})},n&&(i.count=function(e,r){return Ee.setTime(+e),Se.setTime(+r),t(Ee),t(Se),Math.floor(n(Ee,Se))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t==0}:function(e){return i.count(0,e)%t==0}):i:null}),i}var Ae=Te(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});Ae.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Te(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):Ae:null};var ke=6e4,Ce=36e5,Re=6048e5,De=Te(function(t){t.setTime(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(+t+1e3*e)},function(t,e){return(e-t)/1e3},function(t){return t.getUTCSeconds()}),Le=Te(function(t){t.setTime(Math.floor(t/ke)*ke)},function(t,e){t.setTime(+t+e*ke)},function(t,e){return(e-t)/ke},function(t){return t.getMinutes()}),Oe=Te(function(t){var e=t.getTimezoneOffset()*ke%Ce;e<0&&(e+=Ce),t.setTime(Math.floor((+t-e)/Ce)*Ce+e)},function(t,e){t.setTime(+t+e*Ce)},function(t,e){return(e-t)/Ce},function(t){return t.getHours()}),Pe=Te(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*ke)/864e5},function(t){return t.getDate()-1});function Ie(t){return Te(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*ke)/Re})}var Ne=Ie(0),Fe=Ie(1),je=(Ie(2),Ie(3),Ie(4)),ze=(Ie(5),Ie(6),Te(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())},function(t){return t.getMonth()})),Ue=Te(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});Ue.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Te(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)}):null};var Ve=Te(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*ke)},function(t,e){return(e-t)/ke},function(t){return t.getUTCMinutes()}),Be=Te(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+e*Ce)},function(t,e){return(e-t)/Ce},function(t){return t.getUTCHours()}),He=Te(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/864e5},function(t){return t.getUTCDate()-1});function qe(t){return Te(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/Re})}var Ge=qe(0),We=qe(1),Ye=(qe(2),qe(3),qe(4)),Xe=(qe(5),qe(6),Te(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()})),$e=Te(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});function Qe(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Je(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Ze(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}$e.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Te(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null};var Ke,tn,en,nn,rn,on={"-":"",_:" ",0:"0"},an=/^\s*\d+/,sn=/^%/,un=/[\\^$*+?|[\]().{}]/g;function cn(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function ln(t){return t.replace(un,"\\$&")}function hn(t){return new RegExp("^(?:"+t.map(ln).join("|")+")","i")}function fn(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function dn(t,e,n){var r=an.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function pn(t,e,n){var r=an.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function mn(t,e,n){var r=an.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function gn(t,e,n){var r=an.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function vn(t,e,n){var r=an.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function yn(t,e,n){var r=an.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function wn(t,e,n){var r=an.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function bn(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function xn(t,e,n){var r=an.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function _n(t,e,n){var r=an.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Mn(t,e,n){var r=an.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function En(t,e,n){var r=an.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Sn(t,e,n){var r=an.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Tn(t,e,n){var r=an.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function An(t,e,n){var r=an.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function kn(t,e,n){var r=an.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Cn(t,e,n){var r=sn.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Rn(t,e,n){var r=an.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Dn(t,e,n){var r=an.exec(e.slice(n));return r?(t.Q=1e3*+r[0],n+r[0].length):-1}function Ln(t,e){return cn(t.getDate(),e,2)}function On(t,e){return cn(t.getHours(),e,2)}function Pn(t,e){return cn(t.getHours()%12||12,e,2)}function In(t,e){return cn(1+Pe.count(Ue(t),t),e,3)}function Nn(t,e){return cn(t.getMilliseconds(),e,3)}function Fn(t,e){return Nn(t,e)+"000"}function jn(t,e){return cn(t.getMonth()+1,e,2)}function zn(t,e){return cn(t.getMinutes(),e,2)}function Un(t,e){return cn(t.getSeconds(),e,2)}function Vn(t){var e=t.getDay();return 0===e?7:e}function Bn(t,e){return cn(Ne.count(Ue(t),t),e,2)}function Hn(t,e){var n=t.getDay();return t=n>=4||0===n?je(t):je.ceil(t),cn(je.count(Ue(t),t)+(4===Ue(t).getDay()),e,2)}function qn(t){return t.getDay()}function Gn(t,e){return cn(Fe.count(Ue(t),t),e,2)}function Wn(t,e){return cn(t.getFullYear()%100,e,2)}function Yn(t,e){return cn(t.getFullYear()%1e4,e,4)}function Xn(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+cn(e/60|0,"0",2)+cn(e%60,"0",2)}function $n(t,e){return cn(t.getUTCDate(),e,2)}function Qn(t,e){return cn(t.getUTCHours(),e,2)}function Jn(t,e){return cn(t.getUTCHours()%12||12,e,2)}function Zn(t,e){return cn(1+He.count($e(t),t),e,3)}function Kn(t,e){return cn(t.getUTCMilliseconds(),e,3)}function tr(t,e){return Kn(t,e)+"000"}function er(t,e){return cn(t.getUTCMonth()+1,e,2)}function nr(t,e){return cn(t.getUTCMinutes(),e,2)}function rr(t,e){return cn(t.getUTCSeconds(),e,2)}function ir(t){var e=t.getUTCDay();return 0===e?7:e}function or(t,e){return cn(Ge.count($e(t),t),e,2)}function ar(t,e){var n=t.getUTCDay();return t=n>=4||0===n?Ye(t):Ye.ceil(t),cn(Ye.count($e(t),t)+(4===$e(t).getUTCDay()),e,2)}function sr(t){return t.getUTCDay()}function ur(t,e){return cn(We.count($e(t),t),e,2)}function cr(t,e){return cn(t.getUTCFullYear()%100,e,2)}function lr(t,e){return cn(t.getUTCFullYear()%1e4,e,4)}function hr(){return"+0000"}function fr(){return"%"}function dr(t){return+t}function pr(t){return Math.floor(+t/1e3)}function mr(t){return Ke=function(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,s=t.months,u=t.shortMonths,c=hn(i),l=fn(i),h=hn(o),f=fn(o),d=hn(a),p=fn(a),m=hn(s),g=fn(s),v=hn(u),y=fn(u),w={a:function(t){return a[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return u[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:Ln,e:Ln,f:Fn,H:On,I:Pn,j:In,L:Nn,m:jn,M:zn,p:function(t){return i[+(t.getHours()>=12)]},Q:dr,s:pr,S:Un,u:Vn,U:Bn,V:Hn,w:qn,W:Gn,x:null,X:null,y:Wn,Y:Yn,Z:Xn,"%":fr},b={a:function(t){return a[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return u[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:$n,e:$n,f:tr,H:Qn,I:Jn,j:Zn,L:Kn,m:er,M:nr,p:function(t){return i[+(t.getUTCHours()>=12)]},Q:dr,s:pr,S:rr,u:ir,U:or,V:ar,w:sr,W:ur,x:null,X:null,y:cr,Y:lr,Z:hr,"%":fr},x={a:function(t,e,n){var r=d.exec(e.slice(n));return r?(t.w=p[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=f[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=v.exec(e.slice(n));return r?(t.m=y[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=m.exec(e.slice(n));return r?(t.m=g[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return E(t,e,n,r)},d:_n,e:_n,f:kn,H:En,I:En,j:Mn,L:An,m:xn,M:Sn,p:function(t,e,n){var r=c.exec(e.slice(n));return r?(t.p=l[r[0].toLowerCase()],n+r[0].length):-1},Q:Rn,s:Dn,S:Tn,u:pn,U:mn,V:gn,w:dn,W:vn,x:function(t,e,r){return E(t,n,e,r)},X:function(t,e,n){return E(t,r,e,n)},y:wn,Y:yn,Z:bn,"%":Cn};function _(t,e){return function(n){var r,i,o,a=[],s=-1,u=0,c=t.length;for(n instanceof Date||(n=new Date(+n));++s<c;)37===t.charCodeAt(s)&&(a.push(t.slice(u,s)),null!=(i=on[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),a.push(r),u=s+1);return a.push(t.slice(u,s)),a.join("")}}function M(t,e){return function(n){var r,i,o=Ze(1900);if(E(o,t,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("p"in o&&(o.H=o.H%12+12*o.p),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(r=(i=(r=Je(Ze(o.y))).getUTCDay())>4||0===i?We.ceil(r):We(r),r=He.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(r=(i=(r=e(Ze(o.y))).getDay())>4||0===i?Fe.ceil(r):Fe(r),r=Pe.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?Je(Ze(o.y)).getUTCDay():e(Ze(o.y)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,Je(o)):e(o)}}function E(t,e,n,r){for(var i,o,a=0,s=e.length,u=n.length;a<s;){if(r>=u)return-1;if(37===(i=e.charCodeAt(a++))){if(i=e.charAt(a++),!(o=x[i in on?e.charAt(a++):i])||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return w.x=_(n,w),w.X=_(r,w),w.c=_(e,w),b.x=_(n,b),b.X=_(r,b),b.c=_(e,b),{format:function(t){var e=_(t+="",w);return e.toString=function(){return t},e},parse:function(t){var e=M(t+="",Qe);return e.toString=function(){return t},e},utcFormat:function(t){var e=_(t+="",b);return e.toString=function(){return t},e},utcParse:function(t){var e=M(t,Je);return e.toString=function(){return t},e}}}(t),tn=Ke.format,en=Ke.parse,nn=Ke.utcFormat,rn=Ke.utcParse,Ke}mr({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var gr="%Y-%m-%dT%H:%M:%S.%LZ";Date.prototype.toISOString||nn(gr),+new Date("2000-01-01T00:00:00.000Z")||rn(gr);var vr=function(t,e,n){var r=Me((e=e||{}).type||"json");return r||i("Unknown data format type: "+e.type),t=r(t,e),e.parse&&function(t,e,n){if(t.length){n=n||en;var r,i,o,a,s,u,c,l=t.columns||Object.keys(t[0]);for("auto"===e&&(e=fe(t,l)),r=(l=Object.keys(e)).map(function(t){var r,i,o=e[t];if(o&&(0===o.indexOf("date:")||0===o.indexOf("utc:")))return("'"===(i=(r=o.split(/:(.+)?/,2))[1])[0]&&"'"===i[i.length-1]||'"'===i[0]&&'"'===i[i.length-1])&&(i=i.slice(1,-1)),"utc"===r[0]?rn(i):n(i);if(!ue[o])throw Error("Illegal format pattern: "+t+":"+o);return ue[o]}),a=0,u=t.length,c=l.length;a<u;++a)for(i=t[a],s=0;s<c;++s)i[o=l[s]]=r[s](i[o])}}(t,e.parse,n),t.hasOwnProperty("columns")&&delete t.columns,t},yr={skip:!0},wr={};function br(t,e,n){this.dataflow=t,this.stamp=null==e?-1:e,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}var xr=br.prototype;function _r(t,e){return t?function(n,r){return t(n,r)&&e(n,r)}:e}function Mr(t,e){var n=[];return it(t,e,function(t){n.push(t)}),n}function Er(t,e){var n={};return t.visit(e,function(t){n[ct(t)]=1}),function(t){return n[ct(t)]?null:t}}function Sr(t,e,n,r){var i,o,a,s,u,c=0;for(this.dataflow=t,this.stamp=e,this.fields=null,this.encode=r||null,this.pulses=n,a=0,s=n.length;a<s;++a)if((i=n[a]).stamp===e){if(i.fields)for(u in o=this.fields||(this.fields={}),i.fields)o[u]=1;i.changed(this.ADD)&&(c|=this.ADD),i.changed(this.REM)&&(c|=this.REM),i.changed(this.MOD)&&(c|=this.MOD)}this.changes=c}xr.StopPropagation=wr,xr.ADD=1,xr.REM=2,xr.MOD=4,xr.ADD_REM=3,xr.ADD_MOD=5,xr.ALL=7,xr.REFLOW=8,xr.SOURCE=16,xr.NO_SOURCE=32,xr.NO_FIELDS=64,xr.fork=function(t){return new br(this.dataflow).init(this,t)},xr.addAll=function(){var t=this;return this.source&&this.source.length!==this.add.length?((t=new br(this.dataflow).init(this)).add=t.source,t):t},xr.init=function(t,e){var n=this;return n.stamp=t.stamp,n.encode=t.encode,!t.fields||64&e||(n.fields=t.fields),1&e?(n.addF=t.addF,n.add=t.add):(n.addF=null,n.add=[]),2&e?(n.remF=t.remF,n.rem=t.rem):(n.remF=null,n.rem=[]),4&e?(n.modF=t.modF,n.mod=t.mod):(n.modF=null,n.mod=[]),32&e?(n.srcF=null,n.source=null):(n.srcF=t.srcF,n.source=t.source),n},xr.runAfter=function(t){this.dataflow.runAfter(t)},xr.changed=function(t){var e=t||7;return 1&e&&this.add.length||2&e&&this.rem.length||4&e&&this.mod.length},xr.reflow=function(t){if(t)return this.fork(7).reflow();var e=this.add.length,n=this.source&&this.source.length;return n&&n!==e&&(this.mod=this.source,e&&this.filter(4,Er(this,1))),this},xr.modifies=function(t){var e=P(t),n=this.fields||(this.fields={});return e.forEach(function(t){n[t]=!0}),this},xr.modified=function(t){var e=this.fields;return!(!this.mod.length||!e)&&(arguments.length?a(t)?t.some(function(t){return e[t]}):e[t]:!!e)},xr.filter=function(t,e){return 1&t&&(this.addF=_r(this.addF,e)),2&t&&(this.remF=_r(this.remF,e)),4&t&&(this.modF=_r(this.modF,e)),16&t&&(this.srcF=_r(this.srcF,e)),this},xr.materialize=function(t){var e=this;return 1&(t=t||7)&&e.addF&&(e.add=Mr(e.add,e.addF),e.addF=null),2&t&&e.remF&&(e.rem=Mr(e.rem,e.remF),e.remF=null),4&t&&e.modF&&(e.mod=Mr(e.mod,e.modF),e.modF=null),16&t&&e.srcF&&(e.source=e.source.filter(e.srcF),e.srcF=null),e},xr.visit=function(t,e){var n,r,i=this,o=e;return 16&t?(it(i.source,i.srcF,o),i):(1&t&&it(i.add,i.addF,o),2&t&&it(i.rem,i.remF,o),4&t&&it(i.mod,i.modF,o),8&t&&(n=i.source)&&((r=i.add.length+i.mod.length)===n.length||it(n,r?Er(i,5):i.srcF,o)),i)};var Tr=H(Sr,br);Tr.fork=function(t){var e=new br(this.dataflow).init(this,t&this.NO_FIELDS);return void 0!==t&&(t&e.ADD&&this.visit(e.ADD,function(t){return e.add.push(t)}),t&e.REM&&this.visit(e.REM,function(t){return e.rem.push(t)}),t&e.MOD&&this.visit(e.MOD,function(t){return e.mod.push(t)})),e},Tr.changed=function(t){return this.changes&t},Tr.modified=function(t){var e=this.fields;return e&&this.changes&this.MOD?a(t)?t.some(function(t){return e[t]}):e[t]:0},Tr.filter=function(){i("MultiPulse does not support filtering.")},Tr.materialize=function(){i("MultiPulse does not support materialization.")},Tr.visit=function(t,e){var n=this.pulses,r=n.length,i=0;if(t&this.SOURCE)for(;i<r;++i)n[i].visit(t,e);else for(;i<r;++i)n[i].stamp===this.stamp&&n[i].visit(t,e);return this};var Ar={skip:!1,force:!1};function kr(t){this.cmp=t,this.nodes=[]}var Cr=kr.prototype;function Rr(t,e,n,r){var i,o,a;for(i=t[n];n>e&&r(i,o=t[a=n-1>>1])<0;)t[n]=o,n=a;return t[n]=i}function Dr(t,e,n){for(var r,i=e,o=t.length,a=t[e],s=2*e+1;s<o;)(r=s+1)<o&&n(t[s],t[r])>=0&&(s=r),t[e]=t[s],s=2*(e=s)+1;return t[e]=a,Rr(t,i,e,n)}function Lr(){this._log=b(),this.logLevel(w),this._clock=0,this._rank=0;try{this._loader=te()}catch(t){}this._touched=ot(f),this._pulses={},this._pulse=null,this._heap=new kr(function(t,e){return t.qrank-e.qrank}),this._postrun=[]}Cr.size=function(){return this.nodes.length},Cr.clear=function(){return this.nodes=[],this},Cr.peek=function(){return this.nodes[0]},Cr.push=function(t){var e=this.nodes;return e.push(t),Rr(e,0,e.length-1,this.cmp)},Cr.pop=function(){var t,e=this.nodes,n=e.pop();return e.length?(t=e[0],e[0]=n,Dr(e,0,this.cmp)):t=n,t},Cr.replace=function(t){var e=this.nodes,n=e[0];return e[0]=t,Dr(e,0,this.cmp),n},Cr.pushpop=function(t){var e=this.nodes,n=e[0];return e.length&&this.cmp(n,t)<0&&(e[0]=t,t=n,Dr(e,0,this.cmp)),t};var Or=Lr.prototype;function Pr(t){return function(){return this._log[t].apply(this,arguments)}}function Ir(t,e){_t.call(this,t,null,e)}Or.stamp=function(){return this._clock},Or.loader=function(t){return arguments.length?(this._loader=t,this):this._loader},Or.cleanThreshold=1e4,Or.add=function(t,e,n,r){var i,o=1;return t instanceof _t?i=t:t&&t.prototype instanceof _t?i=new t:I(t)?i=new _t(null,t):(o=0,i=new _t(t,e)),this.rank(i),o&&(r=n,n=e),n&&this.connect(i,i.parameters(n,r)),this.touch(i),i},Or.connect=function(t,e){var n,r,i=t.rank;for(n=0,r=e.length;n<r;++n)if(i<e[n].rank)return void this.rerank(t)},Or.rank=function(t){t.rank=++this._rank},Or.rerank=function(t){for(var e,n,r,o=[t];o.length;)if(this.rank(e=o.pop()),n=e._targets)for(r=n.length;--r>=0;)o.push(e=n[r]),e===t&&i("Cycle detected in dataflow graph.")},Or.pulse=function(t,e,n){this.touch(t,n||Ar);var r=new br(this,this._clock+(this._pulse?0:1)),i=t.pulse&&t.pulse.source||[];return r.target=t,this._pulses[t.id]=e.pulse(r,i),this},Or.touch=function(t,e){var n=e||Ar;return this._pulse?this._enqueue(t):this._touched.add(t),n.skip&&t.skip(!0),this},Or.update=function(t,e,n){var r=n||Ar;return(t.set(e)||r.force)&&this.touch(t,r),this},Or.changeset=gt,Or.ingest=function(t,e,n){return this.pulse(t,this.changeset().insert(vr(e,n)))},Or.request=function(t,e,n){var r,i,o,a,s=this,u=s._pending||(r=s,(a=new Promise(function(t,e){i=t,o=e})).requests=0,a.done=function(){0==--a.requests&&r.runAfter(function(){r._pending=null;try{r.run(),i(r)}catch(t){o(t)}})},r._pending=a);u.requests+=1,s.loader().load(e,{context:"dataflow"}).then(function(e){s.ingest(t,e,n)},function(t){s.error("Loading failed",e,t)}).catch(function(t){s.error("Data ingestion failed",e,t)}).then(u.done,u.done)},Or.events=function(t,e,n,r){for(var i,o=this,a=At(n,r),s=function(t){t.dataflow=o;try{a.receive(t)}catch(t){o.error(t)}finally{o.run()}},u=0,c=(i="string"==typeof t&&"undefined"!=typeof document?document.querySelectorAll(t):P(t)).length;u<c;++u)i[u].addEventListener(e,s);return a},Or.on=function(t,e,n,r,i){return(t instanceof _t?function(t,e,n,r,i,o){var a,s;void 0===r?s=n:(a=I(r)?r:F(r),(s=new _t(null,r=n?function(t,e){var r=a(t,e);return n.skip()?r:n.skip(!0).value=r}:a,i,!1)).modified(o&&o.force),s.rank=0,n&&(s.skip(!0),s.value=n.value,s.targets().add(n))),e.targets().add(s)}:function(t,e,n,r,i,o){var a,s,u=z({},o,yr);I(n)||(n=F(n)),void 0===r?a=function(e){t.touch(n(e))}:I(r)?(s=new _t(null,r,i,!1),a=function(e){var r,i=n(e);s.evaluate(e),mt(r=s.value)?t.pulse(i,r,o):t.update(i,r,u)}):a=function(e){t.update(n(e),r,u)},e.apply(a)})(this,t,e,n,r,i),this},Or.run=function(t){var e,n,r,i,o=this,a=0,s=o.logLevel();if(o._pending)return o.info("Awaiting requests, delaying dataflow run."),0;if(o._pulse)return o.error("Dataflow invoked recursively. Use the runAfter method to queue invocation."),0;if(!o._touched.length)return o.info("Dataflow invoked, but nothing to do."),0;o._pulse=new br(o,++o._clock,t),s>=3&&(r=Date.now(),o.debug("-- START PROPAGATION ("+o._clock+") -----")),o._touched.forEach(function(t){o._enqueue(t,!0)}),o._touched=ot(f);try{for(;o._heap.size()>0;)(e=o._heap.pop()).rank===e.qrank?(n=e.run(o._getPulse(e,t)),s>=4&&o.debug(e.id,n===wr?"STOP":n,e),n!==wr&&(o._pulse=n,e._targets&&e._targets.forEach(function(t){o._enqueue(t)})),++a):o._enqueue(e,!0)}catch(t){i=t}if(o._pulses={},o._pulse=null,s>=3&&(r=Date.now()-r,o.info("> Pulse "+o._clock+": "+a+" operators; "+r+"ms")),i&&(o._postrun=[],o.error(i)),o._onrun)try{o._onrun(o,a,i)}catch(t){o.error(t)}if(o._postrun.length){var u=o._postrun;o._postrun=[],u.forEach(function(t){try{t(o)}catch(t){o.error(t)}})}return a},Or.runAsync=function(){return this._pending||Promise.resolve(this.run())},Or.runAfter=function(t,e){if(this._pulse||e)this._postrun.push(t);else try{t(this)}catch(t){this.error(t)}},Or._enqueue=function(t,e){var n=!this._pulses[t.id];n&&(this._pulses[t.id]=this._pulse),(n||e)&&(t.qrank=t.rank,this._heap.push(t))},Or._getPulse=function(t,e){var n,r=t.source,i=this._clock;return r&&a(r)?new Sr(this,i,n=r.map(function(t){return t.pulse}),e):(n=this._pulses[t.id],r&&((r=r.pulse)&&r!==wr?r.stamp===i&&n.target!==t?n=r:n.source=r.source:n.source=[]),n)},Or.error=Pr("error"),Or.warn=Pr("warn"),Or.info=Pr("info"),Or.debug=Pr("debug"),Or.logLevel=Pr("level");var Nr=H(Ir,_t);Nr.run=function(t){return t.stamp<=this.stamp?t.StopPropagation:(this.skip()?this.skip(!1):e=this.evaluate(t),(e=e||t)!==t.StopPropagation&&(this.pulse=e),this.stamp=t.stamp,e);var e},Nr.evaluate=function(t){var e=this.marshall(t.stamp),n=this.transform(e,t);return e.clear(),n},Nr.transform=function(){};var Fr={};function jr(t){var e=zr(t);return e&&e.Definition||null}function zr(t){return t=t&&t.toLowerCase(),Fr.hasOwnProperty(t)?Fr[t]:null}function Ur(t){return t&&t.length?1===t.length?t[0]:(e=t,function(t){for(var n=e.length,r=1,i=String(e[0](t));r<n;++r)i+="|"+e[r](t);return i}):function(){return""};var e}function Vr(t,e,n){return n||t+(e?"_"+e:"")}var Br={values:Gr({name:"values",init:"cell.store = true;",set:"cell.data.values()",idx:-1}),count:Gr({name:"count",set:"cell.num"}),missing:Gr({name:"missing",set:"this.missing"}),valid:Gr({name:"valid",set:"this.valid"}),sum:Gr({name:"sum",init:"this.sum = 0;",add:"this.sum += v;",rem:"this.sum -= v;",set:"this.sum"}),mean:Gr({name:"mean",init:"this.mean = 0;",add:"var d = v - this.mean; this.mean += d / this.valid;",rem:"var d = v - this.mean; this.mean -= this.valid ? d / this.valid : this.mean;",set:"this.mean"}),average:Gr({name:"average",set:"this.mean",req:["mean"],idx:1}),variance:Gr({name:"variance",init:"this.dev = 0;",add:"this.dev += d * (v - this.mean);",rem:"this.dev -= d * (v - this.mean);",set:"this.valid > 1 ? this.dev / (this.valid-1) : 0",req:["mean"],idx:1}),variancep:Gr({name:"variancep",set:"this.valid > 1 ? this.dev / this.valid : 0",req:["variance"],idx:2}),stdev:Gr({name:"stdev",set:"this.valid > 1 ? Math.sqrt(this.dev / (this.valid-1)) : 0",req:["variance"],idx:2}),stdevp:Gr({name:"stdevp",set:"this.valid > 1 ? Math.sqrt(this.dev / this.valid) : 0",req:["variance"],idx:2}),stderr:Gr({name:"stderr",set:"this.valid > 1 ? Math.sqrt(this.dev / (this.valid * (this.valid-1))) : 0",req:["variance"],idx:2}),distinct:Gr({name:"distinct",set:"cell.data.distinct(this.get)",req:["values"],idx:3}),ci0:Gr({name:"ci0",set:"cell.data.ci0(this.get)",req:["values"],idx:3}),ci1:Gr({name:"ci1",set:"cell.data.ci1(this.get)",req:["values"],idx:3}),median:Gr({name:"median",set:"cell.data.q2(this.get)",req:["values"],idx:3}),q1:Gr({name:"q1",set:"cell.data.q1(this.get)",req:["values"],idx:3}),q3:Gr({name:"q3",set:"cell.data.q3(this.get)",req:["values"],idx:3}),argmin:Gr({name:"argmin",init:"this.argmin = null;",add:"if (v < this.min) this.argmin = t;",rem:"if (v <= this.min) this.argmin = null;",set:"this.argmin || cell.data.argmin(this.get)",req:["min"],str:["values"],idx:3}),argmax:Gr({name:"argmax",init:"this.argmax = null;",add:"if (v > this.max) this.argmax = t;",rem:"if (v >= this.max) this.argmax = null;",set:"this.argmax || cell.data.argmax(this.get)",req:["max"],str:["values"],idx:3}),min:Gr({name:"min",init:"this.min = null;",add:"if (v < this.min || this.min === null) this.min = v;",rem:"if (v <= this.min) this.min = NaN;",set:"this.min = (isNaN(this.min) ? cell.data.min(this.get) : this.min)",str:["values"],idx:4}),max:Gr({name:"max",init:"this.max = null;",add:"if (v > this.max || this.max === null) this.max = v;",rem:"if (v >= this.max) this.max = NaN;",set:"this.max = (isNaN(this.max) ? cell.data.max(this.get) : this.max)",str:["values"],idx:4})},Hr=Object.keys(Br);function qr(t,e){return Br[t](e)}function Gr(t){return function(e){var n=z({init:"",add:"",rem:"",idx:0},t);return n.out=e||t.name,n}}function Wr(t,e){return t.idx-e.idx}function Yr(t,e){var n=e||d,r="var cell = this.cell; this.valid = 0; this.missing = 0;",i="this.cell = cell; this.init();",o="if(v==null){++this.missing; return;} if(v!==v) return; ++this.valid;",a="if(v==null){--this.missing; return;} if(v!==v) return; --this.valid;",s="var cell = this.cell;";return function(t,e){var n,r=t.reduce(function t(e,n){function r(n){e[n]||t(e,e[n]=Br[n]())}return n.req&&n.req.forEach(r),n.str&&n.str.forEach(r),e},t.reduce(function(t,e){return t[e.name]=e,t},{})),i=[];for(n in r)i.push(r[n]);return i.sort(Wr)}(t).forEach(function(t){r+=t.init,o+=t.add,a+=t.rem}),t.slice().sort(Wr).forEach(function(t){s+="t['"+t.out+"']="+t.set+";"}),s+="return t;",(i=Function("cell",i)).prototype.init=Function(r),i.prototype.add=Function("v","t",o),i.prototype.rem=Function("v","t",a),i.prototype.set=Function("t",s),i.prototype.get=n,i.fields=t.map(function(t){return t.out}),i}var Xr=function(t){var e,n,r,i,o,a,s,u,c=t.maxbins||20,l=t.base||10,h=Math.log(l),f=t.divide||[5,2],d=t.extent[0],p=t.extent[1],m=p-d;if(t.step)e=t.step;else if(t.steps){for(o=m/c,a=0,s=t.steps.length;a<s&&t.steps[a]<o;++a);e=t.steps[Math.max(0,a-1)]}else{for(n=Math.ceil(Math.log(c)/h),r=t.minstep||0,e=Math.max(r,Math.pow(l,Math.round(Math.log(m)/h)-n));Math.ceil(m/e)>c;)e*=l;for(a=0,s=f.length;a<s;++a)(o=e/f[a])>=r&&m/o<=c&&(e=o)}return i=(o=Math.log(e))>=0?0:1+~~(-o/h),u=Math.pow(l,-i-1),(t.nice||void 0===t.nice)&&(d=d<(o=Math.floor(d/e+u)*e)?o-e:o,p=Math.ceil(p/e)*e),{start:d,stop:p,step:e}},$r=function(t,e){var n,r=[],i=t.length,o=-1;if(null==e)for(;++o<i;)isNaN(n=Qr(t[o]))||r.push(n);else for(;++o<i;)isNaN(n=Qr(e(t[o],o,t)))||r.push(n);return r};function Qr(t){return null===t?NaN:+t}t.random=Math.random;var Jr=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},Zr=function(t){var e;return 1===t.length&&(e=t,t=function(t,n){return Jr(e(t),n)}),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}},Kr=Zr(Jr),ti=Kr.right,ei=Kr.left,ni=function(t){return null===t?NaN:+t},ri=function(t,e){var n,r,i,o=t.length,a=-1;if(null==e){for(;++a<o;)if(null!=(n=t[a])&&n>=n)for(r=i=n;++a<o;)null!=(n=t[a])&&(r>n&&(r=n),i<n&&(i=n))}else for(;++a<o;)if(null!=(n=e(t[a],a,t))&&n>=n)for(r=i=n;++a<o;)null!=(n=e(t[a],a,t))&&(r>n&&(r=n),i<n&&(i=n));return[r,i]},ii=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o},oi=Math.sqrt(50),ai=Math.sqrt(10),si=Math.sqrt(2),ui=function(t,e,n){var r,i,o,a,s=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(a=ci(t,e,n))||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),e=Math.floor(e/a),o=new Array(i=Math.ceil(e-t+1));++s<i;)o[s]=(t+s)*a;else for(t=Math.floor(t*a),e=Math.ceil(e*a),o=new Array(i=Math.ceil(t-e+1));++s<i;)o[s]=(t-s)/a;return r&&o.reverse(),o};function ci(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=oi?10:o>=ai?5:o>=si?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=oi?10:o>=ai?5:o>=si?2:1)}function li(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=oi?i*=10:o>=ai?i*=5:o>=si&&(i*=2),e<t?-i:i}var hi=function(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1},fi=function(t,e,n){if(null==n&&(n=ni),r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,o=Math.floor(i),a=+n(t[o],o,t);return a+(+n(t[o+1],o+1,t)-a)*(i-o)}},di=function(t,e){var n,r,i=t.length,o=-1;if(null==e){for(;++o<i;)if(null!=(n=t[o])&&n>=n)for(r=n;++o<i;)null!=(n=t[o])&&n>r&&(r=n)}else for(;++o<i;)if(null!=(n=e(t[o],o,t))&&n>=n)for(r=n;++o<i;)null!=(n=e(t[o],o,t))&&n>r&&(r=n);return r},pi=function(t){for(var e,n,r,i=t.length,o=-1,a=0;++o<i;)a+=t[o].length;for(n=new Array(a);--i>=0;)for(e=(r=t[i]).length;--e>=0;)n[--a]=r[e];return n},mi=function(t,e){for(var n=e.length,r=new Array(n);n--;)r[n]=t[e[n]];return r},gi=function(e,n,r,i){var o,a,s,u,c=$r(e,i),l=c.length,h=n;for(s=0,u=Array(h);s<h;++s){for(o=0,a=0;a<l;++a)o+=c[~~(t.random()*l)];u[s]=o/l}return[fi(u.sort(Jr),r/2),fi(u,1-r/2)]},vi=function(t,e){var n=$r(t,e);return[fi(n.sort(Jr),.25),fi(n,.5),fi(n,.75)]},yi=function(e,n){var r,i,o=NaN,a={mean:function(t){return arguments.length?(r=t||0,o=NaN,a):r},stdev:function(t){return arguments.length?(i=null==t?1:t,o=NaN,a):i},sample:function(){var e,n,a=0,s=0;if(o==o)return a=o,o=NaN,a;do{e=(a=2*t.random()-1)*a+(s=2*t.random()-1)*s}while(0===e||e>1);return n=Math.sqrt(-2*Math.log(e)/e),o=r+s*n*i,r+a*n*i},pdf:function(t){var e=Math.exp(Math.pow(t-r,2)/(-2*Math.pow(i,2)));return 1/(i*Math.sqrt(2*Math.PI))*e},cdf:function(t){var e,n=(t-r)/i,o=Math.abs(n);if(o>37)e=0;else{var a=Math.exp(-o*o/2);o<7.07106781186547?(e=a*((((((.0352624965998911*o+.700383064443688)*o+6.37396220353165)*o+33.912866078383)*o+112.079291497871)*o+221.213596169931)*o+220.206867912376),e/=((((((.0883883476483184*o+1.75566716318264)*o+16.064177579207)*o+86.7807322029461)*o+296.564248779674)*o+637.333633378831)*o+793.826512519948)*o+440.413735824752):e=a/(o+1/(o+2/(o+3/(o+4/(o+.65)))))/2.506628274631}return n>0?1-e:e},icdf:function(t){if(t<=0||t>=1)return NaN;var e=2*t-1,n=8*(Math.PI-3)/(3*Math.PI*(4-Math.PI)),o=2/(Math.PI*n)+Math.log(1-Math.pow(e,2))/2,a=Math.log(1-e*e)/n,s=(e>0?1:-1)*Math.sqrt(Math.sqrt(o*o-a)-o);return r+i*Math.SQRT2*s}};return a.mean(e).stdev(n)},wi=function(e,n){var r=yi(),i={},o=0;return i.data=function(t){return arguments.length?(e=t,o=t?t.length:0,i.bandwidth(n)):e},i.bandwidth=function(t){return arguments.length?(!(n=t)&&e&&(o=(r=e).length,s=((a=vi(r))[2]-a[0])/1.34,n=1.06*Math.min(Math.sqrt(function(t,e){for(var n,r,i=t.length,o=0,a=-1,s=0,u=0;++a<i;)isNaN(n=ni(t[a]))||(u+=(r=n-s)*(n-(s+=r/++o)));if(o>1)return u/(o-1)}(r)),s)*Math.pow(o,-.2)),i):n;var r,o,a,s},i.sample=function(){return e[~~(t.random()*o)]+n*r.sample()},i.pdf=function(t){for(var i=0,a=0;a<o;++a)i+=r.pdf((t-e[a])/n);return i/n/o},i.cdf=function(t){for(var i=0,a=0;a<o;++a)i+=r.cdf((t-e[a])/n);return i/o},i.icdf=function(){throw Error("KDE icdf not supported.")},i.data(e)},bi=function(e,n){var r,i={},o=0;return i.weights=function(t){return arguments.length?(r=function(t){var e,n=[],r=0;for(e=0;e<o;++e)r+=n[e]=null==t[e]?1:+t[e];for(e=0;e<o;++e)n[e]/=r;return n}(n=t||[]),i):n},i.distributions=function(t){return arguments.length?(t?(o=t.length,e=t):(o=0,e=[]),i.weights(n)):e},i.sample=function(){for(var n=t.random(),i=e[o-1],a=r[0],s=0;s<o-1;a+=r[++s])if(n<a){i=e[s];break}return i.sample()},i.pdf=function(t){for(var n=0,i=0;i<o;++i)n+=r[i]*e[i].pdf(t);return n},i.cdf=function(t){for(var n=0,i=0;i<o;++i)n+=r[i]*e[i].cdf(t);return n},i.icdf=function(){throw Error("Mixture icdf not supported.")},i.distributions(e).weights(n)},xi=function(e,n){null==n&&(n=null==e?1:e,e=0);var r,i,o,a={min:function(t){return arguments.length?(o=i-(r=t||0),a):r},max:function(t){return arguments.length?(o=(i=t||0)-r,a):i},sample:function(){return r+o*t.random()},pdf:function(t){return t>=r&&t<=i?1/o:0},cdf:function(t){return t<r?0:t>i?1:(t-r)/o},icdf:function(t){return t>=0&&t<=1?r+t*o:NaN}};return a.min(e).max(n)};function _i(t){this._key=t?l(t):ct,this.reset()}var Mi=_i.prototype;function Ei(t){Ir.call(this,null,t),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Mi.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},Mi.add=function(t){this._add.push(t)},Mi.rem=function(t){this._rem.push(t)},Mi.values=function(){if(this._get=null,0===this._rem.length)return this._add;var t,e,n,r=this._add,i=this._rem,o=this._key,a=r.length,s=i.length,u=Array(a-s),c={};for(t=0;t<s;++t)c[o(i[t])]=1;for(t=0,e=0;t<a;++t)c[o(n=r[t])]?c[o(n)]=0:u[e++]=n;return this._rem=[],this._add=u},Mi.distinct=function(t){for(var e,n=this.values(),r=n.length,i={},o=0;--r>=0;)e=t(n[r])+"",i.hasOwnProperty(e)||(i[e]=1,++o);return o},Mi.extent=function(t){if(this._get!==t||!this._ext){var e=this.values(),n=U(e,t);this._ext=[e[n[0]],e[n[1]]],this._get=t}return this._ext},Mi.argmin=function(t){return this.extent(t)[0]||{}},Mi.argmax=function(t){return this.extent(t)[1]||{}},Mi.min=function(t){var e=this.extent(t)[0];return null!=e?t(e):1/0},Mi.max=function(t){var e=this.extent(t)[1];return null!=e?t(e):-1/0},Mi.quartile=function(t){return this._get===t&&this._q||(this._q=vi(this.values(),t),this._get=t),this._q},Mi.q1=function(t){return this.quartile(t)[0]},Mi.q2=function(t){return this.quartile(t)[1]},Mi.q3=function(t){return this.quartile(t)[2]},Mi.ci=function(t){return this._get===t&&this._ci||(this._ci=gi(this.values(),1e3,.05,t),this._get=t),this._ci},Mi.ci0=function(t){return this.ci(t)[0]},Mi.ci1=function(t){return this.ci(t)[1]},Ei.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Hr},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};var Si=H(Ei,Ir);function Ti(t){Ir.call(this,null,t)}Si.transform=function(t,e){var n,r=this,i=e.fork(e.NO_SOURCE|e.NO_FIELDS);return this.stamp=i.stamp,this.value&&((n=t.modified())||e.modified(this._inputs))?(this._prev=this.value,this.value=n?this.init(t):{},e.visit(e.SOURCE,function(t){r.add(t)})):(this.value=this.value||this.init(t),e.visit(e.REM,function(t){r.rem(t)}),e.visit(e.ADD,function(t){r.add(t)})),i.modifies(this._outputs),r._drop=!1!==t.drop,t.cross&&r._dims.length>1&&(r._drop=!1,this.cross()),r.changes(i)},Si.cross=function(){var t=this,e=t.value,n=t._dnames,r=n.map(function(){return{}}),i=n.length;function o(t){var e,o,a,s;for(e in t)for(a=t[e].tuple,o=0;o<i;++o)r[o][s=a[n[o]]]=s}o(t._prev),o(e),function o(a,s,u){var c,l,h=n[u],f=r[u++];for(c in f)s[h]=f[c],l=a?a+"|"+c:c,u<i?o(l,s,u):e[l]||t.cell(l,s)}("",{},0)},Si.init=function(t){var e=this._inputs=[],o=this._outputs=[],a={};function s(t){for(var n,i=P(r(t)),o=0,s=i.length;o<s;++o)a[n=i[o]]||(a[n]=1,e.push(n))}this._dims=P(t.groupby),this._dnames=this._dims.map(function(t){var e=n(t);return s(t),o.push(e),e}),this.cellkey=t.key?t.key:Ur(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];var u,c,l,h,f,d,p=t.fields||[null],m=t.ops||["count"],g=t.as||[],v=p.length,y={};for(v!==m.length&&i("Unmatched number of fields and aggregate ops."),d=0;d<v;++d)c=m[d],null==(u=p[d])&&"count"!==c&&i("Null aggregate field specified."),f=Vr(c,h=n(u),g[d]),o.push(f),"count"!==c?((l=y[h])||(s(u),(l=y[h]=[]).field=u,this._measures.push(l)),"count"!==c&&(this._countOnly=!1),l.push(qr(c,f))):this._counts.push(f);return this._measures=this._measures.map(function(t){return Yr(t,t.field)}),{}},Si.cellkey=Ur(),Si.cell=function(t,e){var n=this.value[t];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[t]=this.newcell(t,e),this._adds[this._alen++]=n),n},Si.newcell=function(t,e){var n={key:t,num:0,agg:null,tuple:this.newtuple(e,this._prev&&this._prev[t]),stamp:this.stamp,store:!1};if(!this._countOnly){var r,i=this._measures,o=i.length;for(n.agg=Array(o),r=0;r<o;++r)n.agg[r]=new i[r](n)}return n.store&&(n.data=new _i),n},Si.newtuple=function(t,e){var n,r,i=this._dnames,o=this._dims,a={};for(n=0,r=o.length;n<r;++n)a[i[n]]=o[n](t);return e?pt(e.tuple,a):ht(a)},Si.add=function(t){var e,n,r,i=this.cellkey(t),o=this.cell(i,t);if(o.num+=1,!this._countOnly)for(o.store&&o.data.add(t),n=0,r=(e=o.agg).length;n<r;++n)e[n].add(e[n].get(t),t)},Si.rem=function(t){var e,n,r,i=this.cellkey(t),o=this.cell(i,t);if(o.num-=1,!this._countOnly)for(o.store&&o.data.rem(t),n=0,r=(e=o.agg).length;n<r;++n)e[n].rem(e[n].get(t),t)},Si.celltuple=function(t){var e,n,r,i=t.tuple,o=this._counts;for(t.store&&t.data.values(),n=0,r=o.length;n<r;++n)i[o[n]]=t.num;if(!this._countOnly)for(n=0,r=(e=t.agg).length;n<r;++n)e[n].set(i);return i},Si.changes=function(t){var e,n,r,i,o=this._adds,a=this._mods,s=this._prev,u=this._drop,c=t.add,l=t.rem,h=t.mod;if(s)for(n in s)e=s[n],u&&!e.num||l.push(e.tuple);for(r=0,i=this._alen;r<i;++r)c.push(this.celltuple(o[r])),o[r]=null;for(r=0,i=this._mlen;r<i;++r)(0===(e=a[r]).num&&u?l:h).push(this.celltuple(e)),a[r]=null;return this._alen=this._mlen=0,this._prev=null,t},Ti.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};var Ai=H(Ti,Ir);Ai.transform=function(t,e){var n,i=this._bins(t),o=i.start,a=i.step,s=t.as||["bin0","bin1"],u=s[0],c=s[1];return n=t.modified()?(e=e.reflow(!0)).SOURCE:e.modified(r(t.field))?e.ADD_MOD:e.ADD,e.visit(n,function(t){var e=i(t);t[u]=e,t[c]=null==e?null:o+a*(1+(e-o)/a)}),e.modifies(s)},Ai._bins=function(t){if(this.value&&!t.modified())return this.value;var i,o,a=t.field,s=Xr(t),u=s.start,c=s.stop,l=s.step;null!=(i=t.anchor)&&(o=i-(u+l*Math.floor((i-u)/l)),u+=o,c+=o);var h=function(t){var e=a(t);return null==e?null:(e=Math.max(u,Math.min(+e,c-l)),u+l*Math.floor((e-u)/l))};return h.start=u,h.stop=c,h.step=l,this.value=e(h,r(a),t.name||"bin_"+n(a))};var ki=function(t,e,n){var r=t,i=e||[],o=n||[],a={},s=0;return{add:function(t){o.push(t)},remove:function(t){a[r(t)]=++s},size:function(){return i.length},data:function(t,e){return s&&(i=i.filter(function(t){return!a[r(t)]}),a={},s=0),e&&t&&i.sort(t),o.length&&(i=t?$(t,i,o.sort(t)):i.concat(o),o=[]),i}}};function Ci(t){Ir.call(this,[],t)}function Ri(t){_t.call(this,null,Di,t)}function Di(t){return this.value&&!t.modified()?this.value:N(t.fields,t.orders)}function Li(t){Ir.call(this,null,t)}Ci.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},H(Ci,Ir).transform=function(t,e){var n=e.fork(e.ALL),r=ki(ct,this.value,n.materialize(n.ADD).add),i=t.sort,o=e.changed()||i&&(t.modified("sort")||e.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(i,o),n},H(Ri,_t),Li.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};var Oi=H(Li,Ir);function Pi(t){Ir.call(this,null,t)}Oi.transform=function(t,e){function n(e){return function(n){for(var r,i=function(t,e,n){switch(e){case"upper":t=t.toUpperCase();break;case"lower":t=t.toLowerCase()}return t.match(n)}(s(n),t.case,o)||[],u=0,c=i.length;u<c;++u)a.test(r=i[u])||e(r)}}var r=this._parameterCheck(t,e),i=this._counts,o=this._match,a=this._stop,s=t.field,u=t.as||["text","count"],c=n(function(t){i[t]=1+(i[t]||0)}),l=n(function(t){i[t]-=1});return r?e.visit(e.SOURCE,c):(e.visit(e.ADD,c),e.visit(e.REM,l)),this._finish(e,u)},Oi._parameterCheck=function(t,e){var n=!1;return!t.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(t.stopwords||"")+"$","i"),n=!0),!t.modified("pattern")&&this._match||(this._match=new RegExp(t.pattern||"[\\w']+","g"),n=!0),(t.modified("field")||e.modified(t.field.fields))&&(n=!0),n&&(this._counts={}),n},Oi._finish=function(t,e){var n,r,i,o=this._counts,a=this._tuples||(this._tuples={}),s=e[0],u=e[1],c=t.fork();for(n in o)r=a[n],i=o[n]||0,!r&&i?(a[n]=r=ht({}),r[s]=n,r[u]=i,c.add.push(r)):0===i?(r&&c.rem.push(r),o[n]=null,a[n]=null):r[u]!==i&&(r[u]=i,c.mod.push(r));return c.modifies(e)},Pi.Definition={type:"Cross",metadata:{source:!0,generates:!0,changes:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},H(Pi,Ir).transform=function(t,e){var n=e.fork(e.NO_SOURCE),r=this.value,i=t.as||["a","b"],o=i[0],a=i[1];return!r||e.changed(e.ADD_REM)||t.modified("as")||t.modified("filter")?(r&&(n.rem=r),n.add=this.value=function(t,e,n,r){for(var i,o,a=[],s={},u=t.length,c=0;c<u;++c)for(s[e]=o=t[c],i=0;i<u;++i)s[n]=t[i],r(s)&&(a.push(ht(s)),(s={})[e]=o);return a}(e.source,o,a,t.filter||g)):n.mod=r,n.source=this.value,n.modifies(i)};var Ii={kde:wi,mixture:bi,normal:yi,uniform:xi},Ni="function";function Fi(t){Ir.call(this,null,t)}var ji=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}];function zi(t){Ir.call(this,[1/0,-1/0],t)}function Ui(t,e){_t.call(this,t),this.parent=e}Fi.Definition={type:"Density",metadata:{generates:!0,source:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number",default:100},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:ji.concat({key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:ji},{name:"weights",type:"number",array:!0}]})},{name:"as",type:"string",array:!0,default:["value","density"]}]},H(Fi,Ir).transform=function(t,e){var n,r=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){var o=function t(e,n){var r=e[Ni];Ii.hasOwnProperty(r)||i("Unknown distribution function: "+r);var o=Ii[r]();for(var a in e)"field"===a?o.data((e.from||n()).map(e[a])):"distributions"===a?o[a](e[a].map(function(e){return t(e,n)})):typeof o[a]===Ni&&o[a](e[a]);return o}(t.distribution,(n=e,function(){return n.materialize(n.SOURCE).source})),a=t.method||"pdf";"pdf"!==a&&"cdf"!==a&&i("Invalid density method: "+a),t.extent||o.data||i("Missing density extent parameter."),a=o[a];var s=t.as||["value","density"],u=t.extent||ri(o.data()),c=(u[1]-u[0])/(t.steps||100),l=ii(u[0],u[1]+c/2,c).map(function(t){var e={};return e[s[0]]=t,e[s[1]]=a(t),ht(e)});this.value&&(r.rem=this.value),this.value=r.add=r.source=l}return r},zi.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},H(zi,Ir).transform=function(t,e){var n=this.value,r=t.field,i=n[0],o=n[1],a=e.ADD;(e.changed()||e.modified(r.fields)||t.modified("field"))&&(a=e.SOURCE,i=1/0,o=-1/0),e.visit(a,function(t){var e=r(t);null!=e&&(e<i&&(i=e),e>o&&(o=e))}),this.value=[i,o]};var Vi=H(Ui,_t);function Bi(t){Ir.call(this,{},t),this._keys=B();var e=this._targets=[];e.active=0,e.forEach=function(t){for(var n=0,r=e.active;n<r;++n)t(e[n],n,e)}}Vi.connect=function(t){return this.targets().add(t),t.source=this},Vi.add=function(t){this.value.add.push(t)},Vi.rem=function(t){this.value.rem.push(t)},Vi.mod=function(t){this.value.mod.push(t)},Vi.init=function(t){this.value.init(t,t.NO_SOURCE)},Vi.evaluate=function(){return this.value};var Hi=H(Bi,Ir);function qi(t){_t.call(this,null,Gi,t)}function Gi(t){return this.value&&!t.modified()?this.value:a(t.name)?P(t.name).map(function(t){return l(t)}):l(t.name,t.as)}function Wi(t){Ir.call(this,B(),t)}function Yi(t){Ir.call(this,{},t)}function Xi(t){return t.fields.join("|")}function $i(t){Ir.call(this,null,t)}function Qi(t){Ir.call(this,[],t)}Hi.activate=function(t){this._targets[this._targets.active++]=t},Hi.subflow=function(t,e,n,r){var i,o,a=this.value,s=a.hasOwnProperty(t)&&a[t];return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(o=r||(o=this._group[t])&&o.tuple,s=(i=n.dataflow).add(new Ui(n.fork(n.NO_SOURCE),this)).connect(e(i,t,o)),a[t]=s,this.activate(s)),s},Hi.transform=function(t,e){var n=e.dataflow,r=this,i=t.key,o=t.subflow,a=this._keys,s=t.modified("key");function u(t){return r.subflow(t,o,e)}return this._group=t.group||{},this._targets.active=0,e.visit(e.REM,function(t){var e=ct(t),n=a.get(e);void 0!==n&&(a.delete(e),u(n).rem(t))}),e.visit(e.ADD,function(t){var e=i(t);a.set(ct(t),e),u(e).add(t)}),s||e.modified(i.fields)?e.visit(e.MOD,function(t){var e=ct(t),n=a.get(e),r=i(t);n===r?u(r).mod(t):(a.set(e,r),u(n).rem(t),u(r).add(t))}):e.changed(e.MOD)&&e.visit(e.MOD,function(t){u(a.get(ct(t))).mod(t)}),s&&e.visit(e.REFLOW,function(t){var e=ct(t),n=a.get(e),r=i(t);n!==r&&(a.set(e,r),u(n).rem(t),u(r).add(t))}),a.empty>n.cleanThreshold&&n.runAfter(a.clean),e},H(qi,_t),Wi.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},H(Wi,Ir).transform=function(t,e){var n=e.dataflow,r=this.value,i=e.fork(),o=i.add,a=i.rem,s=i.mod,u=t.expr,c=!0;function l(e){var n=ct(e),i=u(e,t),l=r.get(n);i&&l?(r.delete(n),o.push(e)):i||l?c&&i&&!l&&s.push(e):(r.set(n,1),a.push(e))}return e.visit(e.REM,function(t){var e=ct(t);r.has(e)?r.delete(e):a.push(t)}),e.visit(e.ADD,function(e){u(e,t)?o.push(e):r.set(ct(e),1)}),e.visit(e.MOD,l),t.modified()&&(c=!1,e.visit(e.REFLOW,l)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i},Yi.Definition={type:"Fold",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},H(Yi,Ir).transform=function(t,e){var n,r=this.value,i=t.modified("fields"),o=t.fields,a=t.as||["key","value"],s=a[0],u=a[1],c=o.map(Xi),l=o.length,h=e.fork(e.NO_SOURCE),f=0,d=0;function p(t){for(var e,n=r[ct(t)]=Array(l),i=0;i<l;++i)(e=n[i]=ft(t))[s]=c[i],e[u]=o[i](t),h.add.push(e)}if(i){for(n in r)h.rem.push.apply(h.rem,r[n]);r=this.value={},e.visit(e.SOURCE,p)}else{for(e.visit(e.ADD,p);f<l;++f)e.modified(o[f].fields)&&(d|=1<<f);d&&e.visit(e.MOD,function(t){for(var e,n=r[ct(t)],i=0;i<l;++i)d&1<<i&&((e=dt(t,n[i]))[s]=c[i],e[u]=o[i](t),h.mod.push(e))}),e.visit(e.REM,function(t){var e=ct(t);h.rem.push.apply(h.rem,r[e]),r[e]=null})}return h.modifies(a)},$i.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},H($i,Ir).transform=function(t,e){var n=t.expr,r=t.as,i=t.modified(),o=t.initonly?e.ADD:i?e.SOURCE:e.modified(n.fields)?e.ADD_MOD:e.ADD;return i&&(e=e.materialize().reflow(!0)),t.initonly||e.modifies(r),e.visit(o,function(e){e[r]=n(e,t)})},H(Qi,Ir).transform=function(t,e){var n,r,i,o=this.value,a=e.fork(e.ALL),s=t.size-o.length,u=t.generator;if(s>0){for(n=[];--s>=0;)n.push(i=ht(u(t))),o.push(i);a.add=a.add.length?a.materialize(a.ADD).add.concat(n):n}else r=o.slice(0,-s),a.rem=a.rem.length?a.materialize(a.REM).rem.concat(r):r,o=o.slice(-s);return a.source=this.value=o,a};var Ji={value:"value",median:function(t,e){var n,r=t.length,i=-1,o=[];if(null==e)for(;++i<r;)isNaN(n=ni(t[i]))||o.push(n);else for(;++i<r;)isNaN(n=ni(e(t[i],i,t)))||o.push(n);return fi(o.sort(Jr),.5)},mean:function(t,e){var n,r=t.length,i=r,o=-1,a=0;if(null==e)for(;++o<r;)isNaN(n=ni(t[o]))?--i:a+=n;else for(;++o<r;)isNaN(n=ni(e(t[o],o,t)))?--i:a+=n;if(i)return a/i},min:function(t,e){var n,r,i=t.length,o=-1;if(null==e){for(;++o<i;)if(null!=(n=t[o])&&n>=n)for(r=n;++o<i;)null!=(n=t[o])&&r>n&&(r=n)}else for(;++o<i;)if(null!=(n=e(t[o],o,t))&&n>=n)for(r=n;++o<i;)null!=(n=e(t[o],o,t))&&r>n&&(r=n);return r},max:di},Zi=[];function Ki(t){Ir.call(this,[],t)}function to(t){Ei.call(this,t)}Ki.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},H(Ki,Ir).transform=function(t,e){var r,o,a,s,u,c,l,h,f,d,p,m=e.fork(e.ALL),g=function(t){var e,n=t.method||Ji.value;if(null!=Ji[n])return n===Ji.value?(e=void 0!==t.value?t.value:0,function(){return e}):Ji[n];i("Unrecognized imputation method: "+n)}(t),v=(p=t.field,function(t){return t?p(t):NaN}),y=n(t.field),w=n(t.key),b=(t.groupby||[]).map(n),x=function(t,e,n,r){var i,o,a,s,u,c,l,h,f=function(t){return t(h)},d=[],p=r?r.slice():[],m={},g={};for(p.forEach(function(t,e){m[t]=e+1}),s=0,l=t.length;s<l;++s)c=n(h=t[s]),u=m[c]||(m[c]=p.push(c)),(a=g[o=(i=e?e.map(f):Zi)+""])||(a=g[o]=[],d.push(a),a.values=i),a[u-1]=h;return d.domain=p,d}(e.source,t.groupby,t.key,t.keyvals),_=[],M=this.value,E=x.domain.length;for(u=0,h=x.length;u<h;++u)for(a=(r=x[u]).values,o=NaN,l=0;l<E;++l)if(null==r[l]){for(s=x.domain[l],d={_impute:!0},c=0,f=a.length;c<f;++c)d[b[c]]=a[c];d[w]=s,d[y]=isNaN(o)?o=g(r,v):o,_.push(ht(d))}return _.length&&(m.add=m.materialize(m.ADD).add.concat(_)),M.length&&(m.rem=m.materialize(m.REM).rem.concat(M)),this.value=_,m},to.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:Hr},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};var eo=H(to,Ei);function no(t){_t.call(this,null,ro,t)}function ro(t){return this.value&&!t.modified()?this.value:X(t.fields,t.flat)}function io(t){Ir.call(this,{},t)}function oo(t){_t.call(this,null,ao,t)}function ao(t){if(this.value&&!t.modified())return this.value;var e,n,r,i=1/0,o=-1/0,a=t.extents;for(e=0,n=a.length;e<n;++e)(r=a[e])[0]<i&&(i=r[0]),r[1]>o&&(o=r[1]);return[i,o]}function so(t){_t.call(this,null,uo,t)}function uo(t){return this.value&&!t.modified()?this.value:t.values.reduce(function(t,e){return t.concat(e)},[])}function co(t){Ir.call(this,null,t)}function lo(t){Bi.call(this,t)}function ho(t){Ir.call(this,null,t)}function fo(t){Ir.call(this,null,t)}function po(t){Ir.call(this,null,t)}function mo(t){Ir.call(this,[],t),this.count=0}function go(t){Ir.call(this,null,t)}function vo(t){Ir.call(this,null,t),this.modified(!0)}function yo(t){Ir.call(this,B(),t)}function wo(t){Ir.call(this,null,t)}eo.transform=function(t,e){var n,r=this,i=t.modified();return r.value&&(i||e.modified(r._inputs))?(n=r.value=i?r.init(t):{},e.visit(e.SOURCE,function(t){r.add(t)})):(n=r.value=r.value||this.init(t),e.visit(e.REM,function(t){r.rem(t)}),e.visit(e.ADD,function(t){r.add(t)})),r.changes(),e.visit(e.SOURCE,function(t){z(t,n[r.cellkey(t)].tuple)}),e.reflow(i).modifies(this._outputs)},eo.changes=function(){var t,e,n=this._adds,r=this._mods;for(t=0,e=this._alen;t<e;++t)this.celltuple(n[t]),n[t]=null;for(t=0,e=this._mlen;t<e;++t)this.celltuple(r[t]),r[t]=null;this._alen=this._mlen=0},H(no,_t),io.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},H(io,Ir).transform=function(t,e){var r,o,a=e,s=t.as,u=t.fields,c=t.index,l=t.values,h=null==t.default?null:t.default,f=t.modified(),d=f?e.SOURCE:e.ADD,p=u.length;return l?(o=l.length,p>1&&!s&&i('Multi-field lookup requires explicit "as" parameter.'),s&&s.length!==p*o&&i('The "as" parameter has too few output field names.'),s=s||l.map(n),r=function(t){for(var e,n,r=0,i=0;r<p;++r)if(null==(n=c.get(u[r](t))))for(e=0;e<o;++e,++i)t[s[i]]=h;else for(e=0;e<o;++e,++i)t[s[i]]=l[e](n)}):(s||i("Missing output field names."),r=function(t){for(var e,n=0;n<p;++n)e=c.get(u[n](t)),t[s[n]]=null==e?h:e}),f?a=e.reflow(!0):d|=u.some(function(t){return e.modified(t.fields)})?e.MOD:0,e.visit(d,r),a.modifies(s)},H(oo,_t),H(so,_t),H(co,Ir),co.prototype.transform=function(t,e){return this.modified(t.modified()),this.value=t,e.fork(e.NO_SOURCE|e.NO_FIELDS)},H(lo,Bi).transform=function(t,e){var n=this,o=t.subflow,a=t.field;return(t.modified("field")||a&&e.modified(r(a)))&&i("PreFacet does not support field modification."),this._targets.active=0,e.visit(e.MOD,function(t){var r=n.subflow(ct(t),o,e,t);a?a(t).forEach(function(t){r.mod(t)}):r.mod(t)}),e.visit(e.ADD,function(t){var r=n.subflow(ct(t),o,e,t);a?a(t).forEach(function(t){r.add(ht(t))}):r.add(t)}),e.visit(e.REM,function(t){var r=n.subflow(ct(t),o,e,t);a?a(t).forEach(function(t){r.rem(t)}):r.rem(t)}),e},ho.Definition={type:"Project",metadata:{generates:!0,changes:!0,modifies:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},H(ho,Ir).transform=function(t,e){var r,i,o,a,s=t.fields,u=(o=t.fields,a=t.as||[],o?o.map(function(t,e){return a[e]||n(t)}):null),c=s?function(t,e){return function(t,e,n,r){for(var i=0,o=n.length;i<o;++i)e[r[i]]=n[i](t);return e}(t,e,s,u)}:dt;return this.value?i=this.value:(e=e.addAll(),i=this.value={}),r=e.fork(),e.visit(e.REM,function(t){var e=ct(t);r.rem.push(i[e]),i[e]=null}),e.visit(e.ADD,function(t){var e=c(t,ht({}));i[ct(t)]=e,r.add.push(e)}),e.visit(e.MOD,function(t){r.mod.push(c(t,i[ct(t)]))}),r},H(fo,Ir).transform=function(t,e){return this.value=t.value,t.modified("value")?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation},H(po,Ir).transform=function(t,e){var n,r;return this.value?r=this.value:(n=e=e.addAll(),r=this.value={}),t.derive&&(n=e.fork(),e.visit(e.REM,function(t){var e=ct(t);n.rem.push(r[e]),r[e]=null}),e.visit(e.ADD,function(t){var e=ft(t);r[ct(t)]=e,n.add.push(e)}),e.visit(e.MOD,function(t){n.mod.push(dt(t,r[ct(t)]))})),n},mo.Definition={type:"Sample",metadata:{source:!0,changes:!0},params:[{name:"size",type:"number",default:1e3}]},H(mo,Ir).transform=function(e,n){var r=n.fork(),i=e.modified("size"),o=e.size,a=this.value,s=this.count,u=0,c=a.reduce(function(t,e){return t[ct(e)]=1,t},{});function l(e){var n,i;a.length<o?a.push(e):(i=~~((s+1)*t.random()))<a.length&&i>=u&&(c[ct(n=a[i])]&&r.rem.push(n),a[i]=e),++s}if(n.rem.length&&(n.visit(n.REM,function(t){var e=ct(t);c[e]&&(c[e]=-1,r.rem.push(t)),--s}),a=a.filter(function(t){return-1!==c[ct(t)]})),(n.rem.length||i)&&a.length<o&&n.source&&(u=s=a.length,n.visit(n.SOURCE,function(t){c[ct(t)]||l(t)}),u=-1),i&&a.length>o){for(var h=0,f=a.length-o;h<f;++h)c[ct(a[h])]=-1,r.rem.push(a[h]);a=a.slice(f)}return n.mod.length&&n.visit(n.MOD,function(t){c[ct(t)]&&r.mod.push(t)}),n.add.length&&n.visit(n.ADD,l),(n.add.length||u<0)&&(r.add=a.filter(function(t){return!c[ct(t)]})),this.count=s,this.value=r.source=a,r},go.Definition={type:"Sequence",metadata:{generates:!0,source:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1}],output:["value"]},H(go,Ir).transform=function(t,e){if(!this.value||t.modified()){var n=e.materialize().fork(e.MOD);return n.rem=this.value?e.rem.concat(this.value):e.rem,n.source=this.value=ii(t.start,t.stop,t.step||1).map(ht),n.add=e.add.concat(this.value),n}},H(vo,Ir).transform=function(t,e){return this.value=e.source,e.changed()?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation},H(yo,Ir).transform=function(t,e){var n=e.dataflow,r=t.field,i=this.value,o=!0;function a(t){i.set(r(t),t)}return t.modified("field")||e.modified(r.fields)?(i.clear(),e.visit(e.SOURCE,a)):e.changed()?(e.visit(e.REM,function(t){i.delete(r(t))}),e.visit(e.ADD,a)):o=!1,this.modified(o),i.empty>n.cleanThreshold&&n.runAfter(i.clean),e.fork()},H(wo,Ir).transform=function(t,e){(!this.value||t.modified("field")||t.modified("sort")||e.changed()||t.sort&&e.modified(t.sort.fields))&&(this.value=(t.sort?e.source.slice().sort(t.sort):e.source).map(t.field))};var bo={row_number:function(){return{next:function(t){return t.index+1}}},rank:function(){var t;return{init:function(){t=1},next:function(e){var n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?t=n+1:t}}},dense_rank:function(){var t;return{init:function(){t=1},next:function(e){var n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?++t:t}}},percent_rank:function(){var t=bo.rank(),e=t.next;return{init:t.init,next:function(t){return(e(t)-1)/(t.data.length-1)}}},cume_dist:function(){var t;return{init:function(){t=0},next:function(e){var n=e.index,r=e.data,i=e.compare;if(t<n){for(;n+1<r.length&&!i(r[n],r[n+1]);)++n;t=n}return(1+t)/r.length}}},ntile:function(t,e){(e=+e)>0||i("ntile num must be greater than zero.");var n=bo.cume_dist(),r=n.next;return{init:n.init,next:function(t){return Math.ceil(e*r(t))}}},lag:function(t,e){return e=+e||1,{next:function(n){var r=n.index-e;return r>=0?t(n.data[r]):null}}},lead:function(t,e){return e=+e||1,{next:function(n){var r=n.index+e,i=n.data;return r<i.length?t(i[r]):null}}},first_value:function(t){return{next:function(e){return t(e.data[e.i0])}}},last_value:function(t){return{next:function(e){return t(e.data[e.i1-1])}}},nth_value:function(t,e){return(e=+e)>0||i("nth_value nth must be greater than zero."),{next:function(n){var r=n.i0+(e-1);return r<n.i1?t(n.data[r]):null}}}},xo=Object.keys(bo);function _o(t){var e=P(t.ops),o=P(t.fields),a=P(t.params),s=P(t.as),u=this.outputs=[],c=this.windows=[],l={},h={},f=!0,d=[],m=[];function g(t){P(r(t)).forEach(function(t){l[t]=1})}g(t.sort),e.forEach(function(t,e){var r,l,v=o[e],y=n(v),w=Vr(t,y,s[e]);if(g(v),u.push(w),bo.hasOwnProperty(t))c.push((r=w,{init:(l=bo[t](o[e],a[e])).init||p,update:function(t,e){e[r]=l.next(t)}}));else{if(null==v&&"count"!==t&&i("Null aggregate field specified."),"count"===t)return void d.push(w);f=!1;var b=h[y];b||((b=h[y]=[]).field=v,m.push(b)),b.push(qr(t,w))}}),(d.length||m.length)&&(this.cell=function(t,e,n){t=t.map(function(t){return Yr(t,t.field)});var r={num:0,agg:null,store:!1,count:e};if(!n)for(var i=t.length,o=r.agg=Array(i),a=0;a<i;++a)o[a]=new t[a](r);if(r.store)var s=r.data=new _i;return r.add=function(t){if(r.num+=1,!n){s&&s.add(t);for(var e=0;e<i;++e)o[e].add(o[e].get(t),t)}},r.rem=function(t){if(r.num-=1,!n){s&&s.rem(t);for(var e=0;e<i;++e)o[e].rem(o[e].get(t),t)}},r.set=function(t){var i,a;for(s&&s.values(),i=0,a=e.length;i<a;++i)t[e[i]]=r.num;if(!n)for(i=0,a=o.length;i<a;++i)o[i].set(t)},r.init=function(){r.num=0,s&&s.reset();for(var t=0;t<i;++t)o[t].init()},r}(m,d,f)),this.inputs=Object.keys(l)}var Mo=_o.prototype;function Eo(t){Ir.call(this,{},t),this._mlen=0,this._mods=[]}Mo.init=function(){this.windows.forEach(function(t){t.init()}),this.cell&&this.cell.init()},Mo.update=function(t,e){var n,r=this.cell,i=this.windows,o=t.data,a=i&&i.length;if(r){for(n=t.p0;n<t.i0;++n)r.rem(o[n]);for(n=t.p1;n<t.i1;++n)r.add(o[n]);r.set(e)}for(n=0;n<a;++n)i[n].update(t,e)},Eo.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:xo.concat(Hr)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};var So=H(Eo,Ir);function To(t,e,n){var r=n.sort,i=r&&!n.ignorePeers,o=n.frame||[null,0],a=t.data(r),s=a.length,u=0,c=i?Zr(r):null,l={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:r||F(-1)};for(e.init();u<s;++u)Ao(l,o,u,s),i&&ko(l,c),e.update(l,a[u])}function Ao(t,e,n,r){t.p0=t.i0,t.p1=t.i1,t.i0=null==e[0]?0:Math.max(0,n-Math.abs(e[0])),t.i1=null==e[1]?r:Math.min(r,n+Math.abs(e[1])+1),t.index=n}function ko(t,e){var n=t.i0,r=t.i1-1,i=t.compare,o=t.data,a=o.length-1;n>0&&!i(o[n],o[n-1])&&(t.i0=e.left(o,o[n])),r<a&&!i(o[r],o[r+1])&&(t.i1=e.right(o,o[r]))}So.transform=function(t,e){var n,r,i=this,o=i.state,a=t.modified();this.stamp=e.stamp,o&&!a||(o=i.state=new _o(t));var s=Ur(t.groupby);function u(t){return i.group(s(t))}for(a||e.modified(o.inputs)?(i.value={},e.visit(e.SOURCE,function(t){u(t).add(t)})):(e.visit(e.REM,function(t){u(t).remove(t)}),e.visit(e.ADD,function(t){u(t).add(t)})),n=0,r=i._mlen;n<r;++n)To(i._mods[n],o,t);return i._mlen=0,i._mods=[],e.reflow(a).modifies(o.outputs)},So.group=function(t){var e=this.value[t];return e||((e=this.value[t]=ki(ct)).stamp=-1),e.stamp<this.stamp&&(e.stamp=this.stamp,this._mods[this._mlen++]=e),e};var Co=Object.freeze({aggregate:Ei,bin:Ti,collect:Ci,compare:Ri,countpattern:Li,cross:Pi,density:Fi,extent:zi,facet:Bi,field:qi,filter:Wi,fold:Yi,formula:$i,generate:Qi,impute:Ki,joinaggregate:to,key:no,lookup:io,multiextent:oo,multivalues:so,params:co,prefacet:lo,project:ho,proxy:fo,relay:po,sample:mo,sequence:go,sieve:vo,subflow:Ui,tupleindex:yo,values:wo,window:Eo});function Ro(t){this.clear(),t&&this.union(t)}var Do=Ro.prototype;Do.clone=function(){return new Ro(this)},Do.clear=function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},Do.empty=function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},Do.set=function(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},Do.add=function(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},Do.expand=function(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},Do.round=function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},Do.translate=function(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},Do.rotate=function(t,e,n){var r=Math.cos(t),i=Math.sin(t),o=e-e*r+n*i,a=n-e*i-n*r,s=this.x1,u=this.x2,c=this.y1,l=this.y2;return this.clear().add(r*s-i*c+o,i*s+r*c+a).add(r*s-i*l+o,i*s+r*l+a).add(r*u-i*c+o,i*u+r*c+a).add(r*u-i*l+o,i*u+r*l+a)},Do.union=function(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},Do.intersect=function(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},Do.encloses=function(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},Do.alignsWith=function(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},Do.intersects=function(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},Do.contains=function(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},Do.width=function(){return this.x2-this.x1},Do.height=function(){return this.y2-this.y1};var Lo,Oo=0,Po=function(t,e){var n,r=[];return n={id:"gradient_"+Oo++,x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:r,stop:function(t,e){return r.push({offset:t,color:e}),n}}};function Io(t){this.mark=t,this.bounds=this.bounds||new Ro}function No(t){Io.call(this,t),this.items=this.items||[]}H(No,Io);try{if(!(Lo=require("canvas")))throw 1}catch(t){try{Lo=require("canvas-prebuilt")}catch(t){Lo=null}}function Fo(t,e){return function(t,e){if("undefined"!=typeof document&&document.createElement){var n=document.createElement("canvas");if(n&&n.getContext)return n.width=t,n.height=e,n}return null}(t,e)||function(t,e){if(Lo)try{return new Lo(t,e)}catch(t){}return null}(t,e)||null}function jo(t){this._pending=0,this._loader=t||te()}var zo=jo.prototype;function Uo(t){t._pending+=1}function Vo(t){t._pending-=1}zo.pending=function(){return this._pending},zo.sanitizeURL=function(t){var e=this;return Uo(e),e._loader.sanitize(t,{context:"href"}).then(function(t){return Vo(e),t}).catch(function(){return Vo(e),null})},zo.loadImage=function(t){var e=this,n=("undefined"!=typeof Image?Image:null)||Lo&&Lo.Image||null;return Uo(e),e._loader.sanitize(t,{context:"image"}).then(function(t){var r=t.href;if(!r||!n)throw{url:r};var i=new n;return i.onload=function(){Vo(e),i.loaded=!0},i.onerror=function(){Vo(e),i.loaded=!1},i.src=r,i}).catch(function(t){return Vo(e),{loaded:!1,width:0,height:0,src:t&&t.url||""}})},zo.ready=function(){var t=this;return new Promise(function(e){!function n(r){t.pending()?setTimeout(function(){n(!0)},10):e(r)}(!1)})};var Bo=Math.PI,Ho=2*Bo,qo=1e-6,Go=Ho-qo;function Wo(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Yo(){return new Wo}Wo.prototype=Yo.prototype={constructor:Wo,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,e,n,r,i){var o=this._x1,a=this._y1,s=(n=+n)-(t=+t),u=(r=+r)-(e=+e),c=o-t,l=a-e,h=c*c+l*l;if((i=+i)<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>qo)if(Math.abs(l*s-u*c)>qo&&i){var f=n-o,d=r-a,p=s*s+u*u,m=f*f+d*d,g=Math.sqrt(p),v=Math.sqrt(h),y=i*Math.tan((Bo-Math.acos((p+h-m)/(2*g*v)))/2),w=y/v,b=y/g;Math.abs(w-1)>qo&&(this._+="L"+(t+w*c)+","+(e+w*l)),this._+="A"+i+","+i+",0,0,"+ +(l*f>c*d)+","+(this._x1=t+b*s)+","+(this._y1=e+b*u)}else this._+="L"+(this._x1=t)+","+(this._y1=e)},arc:function(t,e,n,r,i,o){t=+t,e=+e;var a=(n=+n)*Math.cos(r),s=n*Math.sin(r),u=t+a,c=e+s,l=1^o,h=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+c:(Math.abs(this._x1-u)>qo||Math.abs(this._y1-c)>qo)&&(this._+="L"+u+","+c),n&&(h<0&&(h=h%Ho+Ho),h>Go?this._+="A"+n+","+n+",0,1,"+l+","+(t-a)+","+(e-s)+"A"+n+","+n+",0,1,"+l+","+(this._x1=u)+","+(this._y1=c):h>qo&&(this._+="A"+n+","+n+",0,"+ +(h>=Bo)+","+l+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var Xo=function(t){return function(){return t}},$o=Math.abs,Qo=Math.atan2,Jo=Math.cos,Zo=Math.max,Ko=Math.min,ta=Math.sin,ea=Math.sqrt,na=1e-12,ra=Math.PI,ia=ra/2,oa=2*ra;function aa(t){return t>=1?ia:t<=-1?-ia:Math.asin(t)}function sa(t){return t.innerRadius}function ua(t){return t.outerRadius}function ca(t){return t.startAngle}function la(t){return t.endAngle}function ha(t){return t&&t.padAngle}function fa(t,e,n,r,i,o,a){var s=t-n,u=e-r,c=(a?o:-o)/ea(s*s+u*u),l=c*u,h=-c*s,f=t+l,d=e+h,p=n+l,m=r+h,g=(f+p)/2,v=(d+m)/2,y=p-f,w=m-d,b=y*y+w*w,x=i-o,_=f*m-p*d,M=(w<0?-1:1)*ea(Zo(0,x*x*b-_*_)),E=(_*w-y*M)/b,S=(-_*y-w*M)/b,T=(_*w+y*M)/b,A=(-_*y+w*M)/b,k=E-g,C=S-v,R=T-g,D=A-v;return k*k+C*C>R*R+D*D&&(E=T,S=A),{cx:E,cy:S,x01:-l,y01:-h,x11:E*(i/x-1),y11:S*(i/x-1)}}function da(t){this._context=t}da.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var pa=function(t){return new da(t)};function ma(t){return t[0]}function ga(t){return t[1]}var va=function(){var t=ma,e=ga,n=Xo(!0),r=null,i=pa,o=null;function a(a){var s,u,c,l=a.length,h=!1;for(null==r&&(o=i(c=Yo())),s=0;s<=l;++s)!(s<l&&n(u=a[s],s,a))===h&&((h=!h)?o.lineStart():o.lineEnd()),h&&o.point(+t(u,s,a),+e(u,s,a));if(c)return o=null,c+""||null}return a.x=function(e){return arguments.length?(t="function"==typeof e?e:Xo(+e),a):t},a.y=function(t){return arguments.length?(e="function"==typeof t?t:Xo(+t),a):e},a.defined=function(t){return arguments.length?(n="function"==typeof t?t:Xo(!!t),a):n},a.curve=function(t){return arguments.length?(i=t,null!=r&&(o=i(r)),a):i},a.context=function(t){return arguments.length?(null==t?r=o=null:o=i(r=t),a):r},a},ya=function(){var t=ma,e=null,n=Xo(0),r=ga,i=Xo(!0),o=null,a=pa,s=null;function u(u){var c,l,h,f,d,p=u.length,m=!1,g=new Array(p),v=new Array(p);for(null==o&&(s=a(d=Yo())),c=0;c<=p;++c){if(!(c<p&&i(f=u[c],c,u))===m)if(m=!m)l=c,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=c-1;h>=l;--h)s.point(g[h],v[h]);s.lineEnd(),s.areaEnd()}m&&(g[c]=+t(f,c,u),v[c]=+n(f,c,u),s.point(e?+e(f,c,u):g[c],r?+r(f,c,u):v[c]))}if(d)return s=null,d+""||null}function c(){return va().defined(i).curve(a).context(o)}return u.x=function(n){return arguments.length?(t="function"==typeof n?n:Xo(+n),e=null,u):t},u.x0=function(e){return arguments.length?(t="function"==typeof e?e:Xo(+e),u):t},u.x1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:Xo(+t),u):e},u.y=function(t){return arguments.length?(n="function"==typeof t?t:Xo(+t),r=null,u):n},u.y0=function(t){return arguments.length?(n="function"==typeof t?t:Xo(+t),u):n},u.y1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:Xo(+t),u):r},u.lineX0=u.lineY0=function(){return c().x(t).y(n)},u.lineY1=function(){return c().x(t).y(r)},u.lineX1=function(){return c().x(e).y(n)},u.defined=function(t){return arguments.length?(i="function"==typeof t?t:Xo(!!t),u):i},u.curve=function(t){return arguments.length?(a=t,null!=o&&(s=a(o)),u):a},u.context=function(t){return arguments.length?(null==t?o=s=null:s=a(o=t),u):o},u},wa={draw:function(t,e){var n=Math.sqrt(e/ra);t.moveTo(n,0),t.arc(0,0,n,0,oa)}},ba=function(){};function xa(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function _a(t){this._context=t}function Ma(t){this._context=t}function Ea(t){this._context=t}function Sa(t,e){this._basis=new _a(t),this._beta=e}_a.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:xa(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:xa(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Ma.prototype={areaStart:ba,areaEnd:ba,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:xa(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Ea.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:xa(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Sa.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],o=e[0],a=t[n]-i,s=e[n]-o,u=-1;++u<=n;)this._basis.point(this._beta*t[u]+(1-this._beta)*(i+(r=u/n)*a),this._beta*e[u]+(1-this._beta)*(o+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var Ta=function t(e){function n(t){return 1===e?new _a(t):new Sa(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function Aa(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function ka(t,e){this._context=t,this._k=(1-e)/6}ka.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Aa(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Aa(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Ca=function t(e){function n(t){return new ka(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Ra(t,e){this._context=t,this._k=(1-e)/6}Ra.prototype={areaStart:ba,areaEnd:ba,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Aa(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Da=function t(e){function n(t){return new Ra(t,e)}return n.tension=function(e){return t(+e)},n}(0);function La(t,e){this._context=t,this._k=(1-e)/6}La.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Aa(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Oa=function t(e){function n(t){return new La(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Pa(t,e,n){var r=t._x1,i=t._y1,o=t._x2,a=t._y2;if(t._l01_a>na){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,u=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/u,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/u}if(t._l23_a>na){var c=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,l=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*c+t._x1*t._l23_2a-e*t._l12_2a)/l,a=(a*c+t._y1*t._l23_2a-n*t._l12_2a)/l}t._context.bezierCurveTo(r,i,o,a,t._x2,t._y2)}function Ia(t,e){this._context=t,this._alpha=e}Ia.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:Pa(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Na=function t(e){function n(t){return e?new Ia(t,e):new ka(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Fa(t,e){this._context=t,this._alpha=e}Fa.prototype={areaStart:ba,areaEnd:ba,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Pa(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var ja=function t(e){function n(t){return e?new Fa(t,e):new Ra(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function za(t,e){this._context=t,this._alpha=e}za.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Pa(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Ua=function t(e){function n(t){return e?new za(t,e):new La(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Va(t){this._context=t}function Ba(t){return t<0?-1:1}function Ha(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),a=(n-t._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(Ba(o)+Ba(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function qa(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Ga(t,e,n){var r=t._x0,i=t._x1,o=t._y1,a=(i-r)/3;t._context.bezierCurveTo(r+a,t._y0+a*e,i-a,o-a*n,i,o)}function Wa(t){this._context=t}function Ya(t){this._context=new Xa(t)}function Xa(t){this._context=t}function $a(t){this._context=t}function Qa(t){var e,n,r=t.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,o[e]=4,a[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)o[e]-=n=i[e]/o[e-1],a[e]-=n*a[e-1];for(i[r-1]=a[r-1]/o[r-1],e=r-2;e>=0;--e)i[e]=(a[e]-i[e+1])/o[e];for(o[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)o[e]=2*t[e+1]-i[e+1];return[i,o]}function Ja(t,e){this._context=t,this._t=e}Va.prototype={areaStart:ba,areaEnd:ba,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},Wa.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Ga(this,this._t0,qa(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Ga(this,qa(this,n=Ha(this,t,e)),n);break;default:Ga(this,this._t0,n=Ha(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(Ya.prototype=Object.create(Wa.prototype)).point=function(t,e){Wa.prototype.point.call(this,e,t)},Xa.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,o){this._context.bezierCurveTo(e,t,r,n,o,i)}},$a.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=Qa(t),i=Qa(e),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],t[a],e[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},Ja.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var Za={basis:{curve:function(t){return new _a(t)}},"basis-closed":{curve:function(t){return new Ma(t)}},"basis-open":{curve:function(t){return new Ea(t)}},bundle:{curve:Ta,tension:"beta",value:.85},cardinal:{curve:Ca,tension:"tension",value:0},"cardinal-open":{curve:Oa,tension:"tension",value:0},"cardinal-closed":{curve:Da,tension:"tension",value:0},"catmull-rom":{curve:Na,tension:"alpha",value:.5},"catmull-rom-closed":{curve:ja,tension:"alpha",value:.5},"catmull-rom-open":{curve:Ua,tension:"alpha",value:.5},linear:{curve:pa},"linear-closed":{curve:function(t){return new Va(t)}},monotone:{horizontal:function(t){return new Ya(t)},vertical:function(t){return new Wa(t)}},natural:{curve:function(t){return new $a(t)}},step:{curve:function(t){return new Ja(t,.5)}},"step-after":{curve:function(t){return new Ja(t,1)}},"step-before":{curve:function(t){return new Ja(t,0)}}};function Ka(t,e,n){var r=Za.hasOwnProperty(t)&&Za[t],i=null;return r&&(i=r.curve||r[e||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}var ts={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},es=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\d)([-+])/g,/\s|,|###/],ns=function(t){var e,n,r,i,o,a,s,u,c,l,h,f=[];for(u=0,l=(e=t.slice().replace(es[0],"###$1").split(es[1]).slice(1)).length;u<l;++u){for(r=(n=e[u]).slice(1).trim().replace(es[2],"$1###$2").split(es[3]),i=[a=n.charAt(0)],c=0,h=r.length;c<h;++c)(o=+r[c])===o&&i.push(o);if(s=ts[a.toLowerCase()],i.length-1>s)for(c=1,h=i.length;c<h;c+=s)f.push([a].concat(i.slice(c,c+s)));else f.push(i)}return f},rs={},is={},os=[].join;function as(t){var e=os.call(t);if(is[e])return is[e];var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=c*a,h=-u*s,f=u*a,d=c*s,p=Math.cos(i),m=Math.sin(i),g=Math.cos(o),v=Math.sin(o),y=.5*(o-i),w=Math.sin(.5*y),b=8/3*w*w/Math.sin(y),x=n+p-b*m,_=r+m+b*p,M=n+g,E=r+v,S=M+b*v,T=E-b*g;return is[e]=[l*x+h*_,f*x+d*_,l*S+h*T,f*S+d*T,l*M+h*E,f*M+d*E]}var ss=["l",0,0,0,0,0,0,0];function us(t,e){var n=ss[0]=t[0];if("a"===n||"A"===n)ss[1]=e*t[1],ss[2]=e*t[2],ss[6]=e*t[6],ss[7]=e*t[7];else for(var r=1,i=t.length;r<i;++r)ss[r]=e*t[r];return ss}var cs=function(t,e,n,r,i){var o,a,s,u,c,l=null,h=0,f=0,d=0,p=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),t.beginPath&&t.beginPath();for(var m=0,g=e.length;m<g;++m){switch(o=e[m],1!==i&&(o=us(o,i)),o[0]){case"l":t.lineTo((h+=o[1])+n,(f+=o[2])+r);break;case"L":t.lineTo((h=o[1])+n,(f=o[2])+r);break;case"h":t.lineTo((h+=o[1])+n,f+r);break;case"H":t.lineTo((h=o[1])+n,f+r);break;case"v":t.lineTo(h+n,(f+=o[1])+r);break;case"V":t.lineTo(h+n,(f=o[1])+r);break;case"m":t.moveTo((h+=o[1])+n,(f+=o[2])+r);break;case"M":t.moveTo((h=o[1])+n,(f=o[2])+r);break;case"c":t.bezierCurveTo(h+o[1]+n,f+o[2]+r,(d=h+o[3])+n,(p=f+o[4])+r,(a=h+o[5])+n,(s=f+o[6])+r),h=a,f=s;break;case"C":t.bezierCurveTo(o[1]+n,o[2]+r,(d=o[3])+n,(p=o[4])+r,(h=o[5])+n,(f=o[6])+r);break;case"s":t.bezierCurveTo((d=2*h-d)+n,(p=2*f-p)+r,h+o[1]+n,f+o[2]+r,(a=h+o[3])+n,(s=f+o[4])+r),d=h+o[1],p=f+o[2],h=a,f=s;break;case"S":t.bezierCurveTo((d=2*h-d)+n,(p=2*f-p)+r,o[1]+n,o[2]+r,(a=o[3])+n,(s=o[4])+r),h=a,f=s,d=o[1],p=o[2];break;case"q":t.quadraticCurveTo((d=h+o[1])+n,(p=f+o[2])+r,(a=h+o[3])+n,(s=f+o[4])+r),h=a,f=s;break;case"Q":t.quadraticCurveTo(o[1]+n,o[2]+r,(a=o[3])+n,(s=o[4])+r),h=a,f=s,d=o[1],p=o[2];break;case"t":a=h+o[1],s=f+o[2],null===l[0].match(/[QqTt]/)?(d=h,p=f):"t"===l[0]?(d=2*h-u,p=2*f-c):"q"===l[0]&&(d=2*h-d,p=2*f-p),u=d,c=p,t.quadraticCurveTo(d+n,p+r,a+n,s+r),d=(h=a)+o[1],p=(f=s)+o[2];break;case"T":t.quadraticCurveTo((d=2*h-d)+n,(p=2*f-p)+r,(a=o[1])+n,(s=o[2])+r),h=a,f=s;break;case"a":ls(t,h+n,f+r,[o[1],o[2],o[3],o[4],o[5],o[6]+h+n,o[7]+f+r]),h+=o[6],f+=o[7];break;case"A":ls(t,h+n,f+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),h=o[6],f=o[7];break;case"z":case"Z":t.closePath()}l=o}};function ls(t,e,n,r){for(var i=function(t,e,n,r,i,o,a,s,u){var c=os.call(arguments);if(rs[c])return rs[c];var l=a*(Math.PI/180),h=Math.sin(l),f=Math.cos(l),d=f*(s-t)*.5+h*(u-e)*.5,p=f*(u-e)*.5-h*(s-t)*.5,m=d*d/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);m>1&&(n*=m=Math.sqrt(m),r*=m);var g=f/n,v=h/n,y=-h/r,w=f/r,b=g*s+v*u,x=y*s+w*u,_=g*t+v*e,M=y*t+w*e,E=1/((_-b)*(_-b)+(M-x)*(M-x))-.25;E<0&&(E=0);var S=Math.sqrt(E);o==i&&(S=-S);var T=.5*(b+_)-S*(M-x),A=.5*(x+M)+S*(_-b),k=Math.atan2(x-A,b-T),C=Math.atan2(M-A,_-T)-k;C<0&&1===o?C+=2*Math.PI:C>0&&0===o&&(C-=2*Math.PI);for(var R=Math.ceil(Math.abs(C/(.5*Math.PI+.001))),D=[],L=0;L<R;++L)D[L]=[T,A,k+L*C/R,k+(L+1)*C/R,n,r,h,f];return rs[c]=D}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n),o=0;o<i.length;++o){var a=as(i[o]);t.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5])}}var hs=2*Math.PI,fs=Math.sqrt(3)/2,ds={circle:{draw:function(t,e){var n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,hs)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){var n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=fs*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=fs*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=fs*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=fs*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}}};function ps(t){return ds.hasOwnProperty(t)?ds[t]:function(t){if(!ms.hasOwnProperty(t)){var e=ns(t);ms[t]={draw:function(t,n){cs(t,e,0,0,Math.sqrt(n)/2)}}}return ms[t]}(t)}var ms={};function gs(t){return t.x}function vs(t){return t.y}function ys(t){return t.width}function ws(t){return t.height}function bs(t){return function(){return t}}var xs=function(){var t=gs,e=vs,n=ys,r=ws,i=bs(0),o=null;function a(a,s,u){var c,l=null!=s?s:+t.call(this,a),h=null!=u?u:+e.call(this,a),f=+n.call(this,a),d=+r.call(this,a),p=+i.call(this,a);if(o||(o=c=Yo()),p<=0)o.rect(l,h,f,d);else{var m=l+f,g=h+d;o.moveTo(l+p,h),o.lineTo(m-p,h),o.quadraticCurveTo(m,h,m,h+p),o.lineTo(m,g-p),o.quadraticCurveTo(m,g,m-p,g),o.lineTo(l+p,g),o.quadraticCurveTo(l,g,l,g-p),o.lineTo(l,h+p),o.quadraticCurveTo(l,h,l+p,h),o.closePath()}if(c)return o=null,c+""||null}return a.x=function(e){return arguments.length?(t="function"==typeof e?e:bs(+e),a):t},a.y=function(t){return arguments.length?(e="function"==typeof t?t:bs(+t),a):e},a.width=function(t){return arguments.length?(n="function"==typeof t?t:bs(+t),a):n},a.height=function(t){return arguments.length?(r="function"==typeof t?t:bs(+t),a):r},a.cornerRadius=function(t){return arguments.length?(i="function"==typeof t?t:bs(+t),a):i},a.context=function(t){return arguments.length?(o=null==t?null:t,a):o},a},_s=Math.PI,Ms=function(){var t,e,n,r,i,o,a,s,u=null;function c(t,e,n){var r=n/2;if(i){var c=a-e,l=t-o;if(c||l){var h=Math.sqrt(c*c+l*l),f=(c/=h)*s,d=(l/=h)*s,p=Math.atan2(l,c);u.moveTo(o-f,a-d),u.lineTo(t-c*r,e-l*r),u.arc(t,e,r,p-_s,p),u.lineTo(o+f,a+d),u.arc(o,a,s,p,p+_s)}else u.arc(t,e,r,0,2*_s);u.closePath()}else i=1;o=t,a=e,s=r}function l(o){var a,s,l,h=o.length,f=!1;for(null==u&&(u=l=Yo()),a=0;a<=h;++a)!(a<h&&r(s=o[a],a,o))===f&&(f=!f)&&(i=0),f&&c(+t(s,a,o),+e(s,a,o),+n(s,a,o));if(l)return u=null,l+""||null}return l.x=function(e){return arguments.length?(t=e,l):t},l.y=function(t){return arguments.length?(e=t,l):e},l.size=function(t){return arguments.length?(n=t,l):n},l.defined=function(t){return arguments.length?(r=t,l):r},l.context=function(t){return arguments.length?(u=null==t?null:t,l):u},l};function Es(t){return t.x||0}function Ss(t){return t.y||0}function Ts(t){return t.cornerRadius||0}function As(t){return!(!1===t.defined)}var ks=function(){var t=sa,e=ua,n=Xo(0),r=null,i=ca,o=la,a=ha,s=null;function u(){var u,c,l,h,f,d,p,m,g,v,y,w,b=+t.apply(this,arguments),x=+e.apply(this,arguments),_=i.apply(this,arguments)-ia,M=o.apply(this,arguments)-ia,E=$o(M-_),S=M>_;if(s||(s=u=Yo()),x<b&&(c=x,x=b,b=c),x>na)if(E>oa-na)s.moveTo(x*Jo(_),x*ta(_)),s.arc(0,0,x,_,M,!S),b>na&&(s.moveTo(b*Jo(M),b*ta(M)),s.arc(0,0,b,M,_,S));else{var T,A,k=_,C=M,R=_,D=M,L=E,O=E,P=a.apply(this,arguments)/2,I=P>na&&(r?+r.apply(this,arguments):ea(b*b+x*x)),N=Ko($o(x-b)/2,+n.apply(this,arguments)),F=N,j=N;if(I>na){var z=aa(I/b*ta(P)),U=aa(I/x*ta(P));(L-=2*z)>na?(R+=z*=S?1:-1,D-=z):(L=0,R=D=(_+M)/2),(O-=2*U)>na?(k+=U*=S?1:-1,C-=U):(O=0,k=C=(_+M)/2)}var V=x*Jo(k),B=x*ta(k),H=b*Jo(D),q=b*ta(D);if(N>na){var G=x*Jo(C),W=x*ta(C),Y=b*Jo(R),X=b*ta(R);if(E<ra){var $=L>na?[(h=V)+(w=((v=H-(d=G))*((f=B)-(p=W))-(y=q-p)*(h-d))/(y*(m=Y-h)-v*(g=X-f)))*m,f+w*g]:[H,q],Q=V-$[0],J=B-$[1],Z=G-$[0],K=W-$[1],tt=1/ta(((l=(Q*Z+J*K)/(ea(Q*Q+J*J)*ea(Z*Z+K*K)))>1?0:l<-1?ra:Math.acos(l))/2),et=ea($[0]*$[0]+$[1]*$[1]);F=Ko(N,(b-et)/(tt-1)),j=Ko(N,(x-et)/(tt+1))}}O>na?j>na?(T=fa(Y,X,V,B,x,j,S),A=fa(G,W,H,q,x,j,S),s.moveTo(T.cx+T.x01,T.cy+T.y01),j<N?s.arc(T.cx,T.cy,j,Qo(T.y01,T.x01),Qo(A.y01,A.x01),!S):(s.arc(T.cx,T.cy,j,Qo(T.y01,T.x01),Qo(T.y11,T.x11),!S),s.arc(0,0,x,Qo(T.cy+T.y11,T.cx+T.x11),Qo(A.cy+A.y11,A.cx+A.x11),!S),s.arc(A.cx,A.cy,j,Qo(A.y11,A.x11),Qo(A.y01,A.x01),!S))):(s.moveTo(V,B),s.arc(0,0,x,k,C,!S)):s.moveTo(V,B),b>na&&L>na?F>na?(T=fa(H,q,G,W,b,-F,S),A=fa(V,B,Y,X,b,-F,S),s.lineTo(T.cx+T.x01,T.cy+T.y01),F<N?s.arc(T.cx,T.cy,F,Qo(T.y01,T.x01),Qo(A.y01,A.x01),!S):(s.arc(T.cx,T.cy,F,Qo(T.y01,T.x01),Qo(T.y11,T.x11),!S),s.arc(0,0,b,Qo(T.cy+T.y11,T.cx+T.x11),Qo(A.cy+A.y11,A.cx+A.x11),S),s.arc(A.cx,A.cy,F,Qo(A.y11,A.x11),Qo(A.y01,A.x01),!S))):s.arc(0,0,b,D,R,S):s.lineTo(H,q)}else s.moveTo(0,0);if(s.closePath(),u)return s=null,u+""||null}return u.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-ra/2;return[Jo(r)*n,ta(r)*n]},u.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:Xo(+e),u):t},u.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:Xo(+t),u):e},u.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:Xo(+t),u):n},u.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:Xo(+t),u):r},u.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:Xo(+t),u):i},u.endAngle=function(t){return arguments.length?(o="function"==typeof t?t:Xo(+t),u):o},u.padAngle=function(t){return arguments.length?(a="function"==typeof t?t:Xo(+t),u):a},u.context=function(t){return arguments.length?(s=null==t?null:t,u):s},u}().startAngle(function(t){return t.startAngle||0}).endAngle(function(t){return t.endAngle||0}).padAngle(function(t){return t.padAngle||0}).innerRadius(function(t){return t.innerRadius||0}).outerRadius(function(t){return t.outerRadius||0}).cornerRadius(Ts),Cs=ya().x(Es).y1(Ss).y0(function(t){return(t.y||0)+(t.height||0)}).defined(As),Rs=ya().y(Ss).x1(Es).x0(function(t){return(t.x||0)+(t.width||0)}).defined(As),Ds=va().x(Es).y(Ss).defined(As),Ls=xs().x(Es).y(Ss).width(function(t){return t.width||0}).height(function(t){return t.height||0}).cornerRadius(Ts),Os=function(){var t=Xo(wa),e=Xo(64),n=null;function r(){var r;if(n||(n=r=Yo()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),r)return n=null,r+""||null}return r.type=function(e){return arguments.length?(t="function"==typeof e?e:Xo(e),r):t},r.size=function(t){return arguments.length?(e="function"==typeof t?t:Xo(+t),r):e},r.context=function(t){return arguments.length?(n=null==t?null:t,r):n},r}().type(function(t){return ps(t.shape||"circle")}).size(function(t){return null==t.size?64:t.size}),Ps=Ms().x(Es).y(Ss).defined(As).size(function(t){return t.size||1});function Is(t,e,n,r){return Ls.context(t)(e,n,r)}var Ns,Fs=function(t,e){return e.stroke&&0!==e.opacity&&0!==e.strokeOpacity&&t.expand(null!=e.strokeWidth?+e.strokeWidth:1),t},js=2*Math.PI,zs=js/4,Us=js-1e-8;function Vs(t){return Ns=t,Vs}function Bs(){}function Hs(t,e){Ns.add(t,e)}Vs.beginPath=Bs,Vs.closePath=Bs,Vs.moveTo=Hs,Vs.lineTo=Hs,Vs.rect=function(t,e,n,r){Hs(t,e),Hs(t+n,e+r)},Vs.quadraticCurveTo=function(t,e,n,r){Hs(t,e),Hs(n,r)},Vs.bezierCurveTo=function(t,e,n,r,i,o){Hs(t,e),Hs(n,r),Hs(i,o)},Vs.arc=function(t,e,n,r,i,o){if(Math.abs(i-r)>Us)return Hs(t-n,e-n),void Hs(t+n,e+n);var a,s,u,c,l=1/0,h=-1/0,f=1/0,d=-1/0;function p(t){u=n*Math.cos(t),c=n*Math.sin(t),u<l&&(l=u),u>h&&(h=u),c<f&&(f=c),c>d&&(d=c)}if(p(r),p(i),i!==r)if((r%=js)<0&&(r+=js),(i%=js)<0&&(i+=js),i<r&&(o=!o,a=r,r=i,i=a),o)for(i-=js,a=r-r%zs,s=0;s<3&&a>i;++s,a-=zs)p(a);else for(a=r-r%zs+zs,s=0;s<3&&a<i;++s,a+=zs)p(a);Hs(t+l,e+f),Hs(t+h,e+d)};var qs=function(t,e,n){return n.id?function(t,e,n){for(var r=n.width(),i=n.height(),o=e.stops,a=0,s=o.length,u=t.createLinearGradient(n.x1+e.x1*r,n.y1+e.y1*i,n.x1+e.x2*r,n.y1+e.y2*i);a<s;++a)u.addColorStop(o[a].offset,o[a].color);return u}(t,n,e.bounds):n},Gs=function(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=qs(t,e,e.fill),!0)},Ws=[],Ys=function(t,e,n){var r=null!=(r=e.strokeWidth)?r:1;return!(r<=0)&&(n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=qs(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||Ws),t.lineDashOffset=e.strokeDashOffset||0),!0)};function Xs(t,e){return t.zindex-e.zindex||t.index-e.index}function $s(t){if(!t.zdirty)return t.zitems;var e,n,r,i=t.items,o=[];for(n=0,r=i.length;n<r;++n)(e=i[n]).index=n,e.zindex&&o.push(e);return t.zdirty=!1,t.zitems=o.sort(Xs)}function Qs(t,e){var n,r,i=t.items;if(i&&i.length){var o=$s(t);if(o&&o.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||e(i[n]);i=o}for(n=0,r=i.length;n<r;++n)e(i[n])}}function Js(t,e){var n,r,i=t.items;if(!i||!i.length)return null;var o=$s(t);for(o&&o.length&&(i=o),r=i.length;--r>=0;)if(n=e(i[r]))return n;if(i===o)for(r=(i=t.items).length;--r>=0;)if(!i[r].zindex&&(n=e(i[r])))return n;return null}function Zs(t){return function(e,n,r){Qs(n,function(n){r&&!r.intersects(n.bounds)||Ks(t,e,n,n)})}}function Ks(t,e,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(t(e,r)||(n.fill&&Gs(e,n,i)&&e.fill(),n.stroke&&Ys(e,n,i)&&e.stroke()))}var tu=function(){return!0};function eu(t){return t||(t=tu),function(e,n,r,i,o,a){return e.pixelRatio>1&&(r*=e.pixelRatio,i*=e.pixelRatio),Js(n,function(n){var s=n.bounds;if((!s||s.contains(o,a))&&s)return t(e,n,r,i,o,a)?n:void 0})}}function nu(t,e){return function(n,r,i,o){var a,s,u=Array.isArray(r)?r[0]:r,c=null==e?u.fill:e,l=u.stroke&&n.isPointInStroke;return l&&(s=u.strokeCap,n.lineWidth=null!=(a=u.strokeWidth)?a:1,n.lineCap=null!=s?s:"butt"),!t(n,r)&&(c&&n.isPointInPath(i,o)||l&&n.isPointInStroke(i,o))}}function ru(t){return eu(nu(t))}var iu=function(t,e){return"translate("+t+","+e+")"},ou=function(t){return iu(t.x||0,t.y||0)},au=function(t,e){function n(t,n){var r=n.x||0,i=n.y||0;t.translate(r,i),t.beginPath(),e(t,n),t.translate(-r,-i)}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",ou(n)),t("d",e(null,n))},bound:function(t,n){return e(Vs(t),n),Fs(t,n).translate(n.x||0,n.y||0)},draw:Zs(n),pick:ru(n)}},su=au("arc",function(t,e){return ks.context(t)(e)}),uu=function(t,e){function n(t,n){t.beginPath(),e(t,n)}var r,i=nu(n);return{type:t,tag:"path",nested:!0,attr:function(t,n){var r=n.mark.items;r.length&&t("d",e(null,r))},bound:function(t,n){var r=n.items;return 0===r.length?t:(e(Vs(t),r),Fs(t,r[0]))},draw:(r=n,function(t,e,n){!e.items.length||n&&!n.intersects(e.bounds)||Ks(r,t,e.items[0],e.items)}),pick:function(t,e,n,r,o,a){var s=e.items,u=e.bounds;return!s||!s.length||u&&!u.contains(o,a)?null:(t.pixelRatio>1&&(n*=t.pixelRatio,r*=t.pixelRatio),i(t,s,n,r)?s[0]:null)}}},cu=uu("area",function(t,e){var n=e[0];return("horizontal"===n.orient?Rs:Cs).curve(Ka(n.interpolate||"linear",n.orient,n.tension)).context(t)(e)}),lu=1,hu=function(t,e,n){var r=t._defs,i=e.clip_id||(e.clip_id="clip"+lu++),o=r.clipping[i]||(r.clipping[i]={id:i});return o.width=n.width||0,o.height=n.height||0,"url(#"+i+")"},fu={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",ou(e))},bound:function(t,e){if(!e.clip&&e.items)for(var n=e.items,r=0,i=n.length;r<i;++r)t.union(n[r].bounds);return(e.clip||e.width||e.height)&&Fs(t.add(0,0).add(e.width||0,e.height||0),e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n){var r=this;Qs(e,function(e){var i,o,a=e.x||0,s=e.y||0,u=e.width||0,c=e.height||0;t.save(),t.translate(a,s),(e.stroke||e.fill)&&(o=null==e.opacity?1:e.opacity)>0&&(t.beginPath(),Is(t,e,i=e.stroke?.5:0,i),e.fill&&Gs(t,e,o)&&t.fill(),e.stroke&&Ys(t,e,o)&&t.stroke()),e.clip&&(t.beginPath(),t.rect(0,0,u,c),t.clip()),n&&n.translate(-a,-s),Qs(e,function(e){r.draw(t,e,n)}),n&&n.translate(a,s),t.restore()})},pick:function(t,e,n,r,i,o){if(e.bounds&&!e.bounds.contains(i,o)||!e.items)return null;var a=this;return Js(e,function(s){var u,c,l,h;if(!(h=s.bounds)||h.contains(i,o))return c=s.x||0,l=s.y||0,t.save(),t.translate(c,l),c=i-c,l=o-l,u=Js(s,function(t){return(!1!==(e=t).interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(c,l)?a.pick(t,n,r,c,l):null;var e}),t.restore(),u||((u=!1!==e.interactive&&(s.fill||s.stroke)&&c>=0&&c<=s.width&&l>=0&&l<=s.height)?s:null)})},background:function(t,e){var n=e.stroke?.5:0;t("class","background"),t("d",Is(null,e,n,n))},foreground:function(t,e,n){t("clip-path",e.clip?hu(n,e,e):null)}};function du(t,e){var n=t.image;return n&&n.url===t.url||(n={loaded:!1,width:0,height:0},e.loadImage(t.url).then(function(e){t.image=e,t.image.url=t.url})),n}function pu(t,e){return"center"===t?e/2:"right"===t?e:0}function mu(t,e){return"middle"===t?e/2:"bottom"===t?e:0}var gu={type:"image",tag:"image",nested:!1,attr:function(t,e,n){var r=du(e,n),i=e.x||0,o=e.y||0,a=(null!=e.width?e.width:r.width)||0,s=(null!=e.height?e.height:r.height)||0,u=!1===e.aspect?"none":"xMidYMid";i-=pu(e.align,a),o-=mu(e.baseline,s),t("href",r.src||"","http://www.w3.org/1999/xlink","xlink:href"),t("transform",iu(i,o)),t("width",a),t("height",s),t("preserveAspectRatio",u)},bound:function(t,e){var n=e.image,r=e.x||0,i=e.y||0,o=(null!=e.width?e.width:n&&n.width)||0,a=(null!=e.height?e.height:n&&n.height)||0;return r-=pu(e.align,o),i-=mu(e.baseline,a),t.set(r,i,r+o,i+a)},draw:function(t,e,n){var r=this;Qs(e,function(e){if(!n||n.intersects(e.bounds)){var i,o,a,s,u=du(e,r),c=e.x||0,l=e.y||0,h=(null!=e.width?e.width:u.width)||0,f=(null!=e.height?e.height:u.height)||0;c-=pu(e.align,h),l-=mu(e.baseline,f),!1!==e.aspect&&(a=e.width/e.height,(o=u.width/u.height)==o&&a==a&&o!==a&&(a<o?(l+=(f-(s=h/o))/2,f=s):(c+=(h-(s=f*o))/2,h=s))),u.loaded&&(t.globalAlpha=null!=(i=e.opacity)?i:1,t.drawImage(u,c,l,h,f))}})},pick:eu(),get:du,xOffset:pu,yOffset:mu},vu=uu("line",function(t,e){var n=e[0];return Ds.curve(Ka(n.interpolate||"linear",n.orient,n.tension)).context(t)(e)});function yu(t,e){var n=e.path;if(null==n)return!0;var r=e.pathCache;r&&r.path===n||((e.pathCache=r=ns(n)).path=n),cs(t,r,e.x,e.y)}var wu={type:"path",tag:"path",nested:!1,attr:function(t,e){t("transform",ou(e)),t("d",e.path)},bound:function(t,e){return yu(Vs(t),e)?t.set(0,0,0,0):Fs(t,e)},draw:Zs(yu),pick:ru(yu)};function bu(t,e){t.beginPath(),Is(t,e)}var xu={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",Is(null,e))},bound:function(t,e){var n,r;return Fs(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:Zs(bu),pick:ru(bu)};function _u(t,e,n){var r,i,o,a;return!(!e.stroke||!Ys(t,e,n)||(r=e.x||0,i=e.y||0,o=null!=e.x2?e.x2:r,a=null!=e.y2?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(o,a),0))}var Mu,Eu,Su={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",ou(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return Fs(t.set(n=e.x||0,r=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r),e)},draw:function(t,e,n){Qs(e,function(e){if(!n||n.intersects(e.bounds)){var r=null==e.opacity?1:e.opacity;r&&_u(t,e,r)&&t.stroke()}})},pick:eu(function(t,e,n,r){return!!t.isPointInStroke&&_u(t,e,1)&&t.isPointInStroke(n,r)})},Tu=au("shape",function(t,e){return(e.mark.shape||e.shape).context(t)(e)}),Au=au("symbol",function(t,e){return Os.context(t)(e)}),ku={height:Ou,measureWidth:Du,estimateWidth:Cu,width:Cu,canvas:Pu};function Cu(t){return Eu=Ou(t),Ru(Iu(t))}function Ru(t){return~~(.8*t.length*Eu)}function Du(t){return Mu.font=Nu(t),Lu(Iu(t))}function Lu(t){return Mu.measureText(t).width}function Ou(t){return null!=t.fontSize?t.fontSize:11}function Pu(t){Mu=t&&(Mu=Fo(1,1))?Mu.getContext("2d"):null,ku.width=Mu?Du:Cu}function Iu(t){var e=t.text;return null==e?"":t.limit>0?function(t){var e,n=+t.limit,r=t.text+"";if(Mu?(Mu.font=Nu(t),e=Lu):(Eu=Ou(t),e=Ru),e(r)<n)return r;var i,o=t.ellipsis||"\u2026",a="rtl"===t.dir,s=0,u=r.length;if(n-=e(o),a){for(;s<u;)e(r.slice(i=s+u>>>1))>n?s=i+1:u=i;return o+r.slice(s)}for(;s<u;)e(r.slice(0,i=1+(s+u>>>1)))<n?s=i:u=i-1;return r.slice(0,s)+o}(t):e+""}function Nu(t,e){var n=t.font;return e&&n&&(n=String(n).replace(/"/g,"'")),(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+Ou(t)+"px "+(n||"sans-serif")}function Fu(t){var e=t.baseline,n=Ou(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:0)}Pu(!0);var ju={left:"start",center:"middle",right:"end"},zu=new Ro;function Uu(t,e,n){var r,i,o=ku.height(e),a=e.align,s=e.radius||0,u=e.x||0,c=e.y||0,l=e.dx||0,h=(e.dy||0)+Fu(e)-Math.round(.8*o);return s&&(i=(e.theta||0)-Math.PI/2,u+=s*Math.cos(i),c+=s*Math.sin(i)),r=ku.width(e),"center"===a?l-=r/2:"right"===a&&(l-=r),t.set(l+=u,h+=c,l+r,h+o),e.angle&&!n&&t.rotate(e.angle*Math.PI/180,u,c),t.expand(n||!r?0:1)}var Vu={arc:su,area:cu,group:fu,image:gu,line:vu,path:wu,rect:xu,rule:Su,shape:Tu,symbol:Au,text:{type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,i=(e.dy||0)+Fu(e),o=e.x||0,a=e.y||0,s=e.angle||0,u=e.radius||0;u&&(n=(e.theta||0)-Math.PI/2,o+=u*Math.cos(n),a+=u*Math.sin(n)),t("text-anchor",ju[e.align]||"start"),s?(n=iu(o,a)+" rotate("+s+")",(r||i)&&(n+=" "+iu(r,i))):n=iu(o+r,a+i),t("transform",n)},bound:Uu,draw:function(t,e,n){Qs(e,function(e){var r,i,o,a,s,u;n&&!n.intersects(e.bounds)||(u=Iu(e))&&0!==(r=null==e.opacity?1:e.opacity)&&(t.font=Nu(e),t.textAlign=e.align||"left",i=e.x||0,o=e.y||0,(a=e.radius)&&(s=(e.theta||0)-Math.PI/2,i+=a*Math.cos(s),o+=a*Math.sin(s)),e.angle&&(t.save(),t.translate(i,o),t.rotate(e.angle*Math.PI/180),i=o=0),i+=e.dx||0,o+=(e.dy||0)+Fu(e),e.fill&&Gs(t,e,r)&&t.fillText(u,i,o),e.stroke&&Ys(t,e,r)&&t.strokeText(u,i,o),e.angle&&t.restore())})},pick:eu(function(t,e,n,r,i,o){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var a=Uu(zu,e,!0),s=-e.angle*Math.PI/180,u=Math.cos(s),c=Math.sin(s),l=e.x,h=e.y;return a.contains(u*i-c*o+(l-l*u+h*c),c*i+u*o+(h-l*c-h*u))})},trail:uu("trail",function(t,e){return Ps.context(t)(e)})},Bu=function(t,e,n){var r=Vu[t.mark.marktype];return r.nested&&(t=t.mark),(e||r.bound)(t.bounds||(t.bounds=new Ro),t,n)},Hu={mark:null},qu=function(t,e,n){var r,i,o,a,s=Vu[t.marktype],u=s.bound,c=t.items,l=c&&c.length;if(s.nested)return l?o=c[0]:(Hu.mark=t,o=Hu),a=Bu(o,u,n),e&&e.union(a)||a;if(e=e||t.bounds&&t.bounds.clear()||new Ro,l)for(r=0,i=c.length;r<i;++r)e.union(Bu(c[r],u,n));return t.bounds=e},Gu=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","interpolate","tension","orient","defined","url","path","x2","y2","size","shape","text","angle","theta","radius","dx","dy","font","fontSize","fontWeight","fontStyle","fontVariant"];function Wu(t,e){return JSON.stringify(t,Gu,e)}function Yu(t){return function t(e){var n,r,i,o=e.marktype,a=e.items;if(a)for(r=0,i=a.length;r<i;++r)a[r][n=o?"mark":"group"]=e,a[r].zindex&&(a[r][n].zdirty=!0),"group"===(o||n)&&t(a[r]);return o&&qu(e),e}("string"==typeof t?JSON.parse(t):t)}function Xu(t){arguments.length?this.root=Yu(t):(this.root=Qu({marktype:"group",name:"root",role:"frame"}),this.root.items=[new No(this.root)])}var $u=Xu.prototype;function Qu(t,e){return{bounds:new Ro,clip:!!t.clip,group:e,interactive:!1!==t.interactive,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0}}function Ju(t,e,n){return!t&&"undefined"!=typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function Zu(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function Ku(t,e,n,r){var i,o=t.childNodes[e];return o&&o.tagName.toLowerCase()===n.toLowerCase()||(i=o||null,o=Ju(t.ownerDocument,n,r),t.insertBefore(o,i)),o}function tc(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function ec(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function nc(t){this._active=null,this._handlers={},this._loader=t||te()}$u.toJSON=function(t){return Wu(this.root,t||0)},$u.mark=function(t,e,n){var r=Qu(t,e=e||this.root.items[0]);return e.items[n]=r,r.zindex&&(r.group.zdirty=!0),r};var rc=nc.prototype;function ic(t){this._el=null,this._bgcolor=null,this._loader=new jo(t)}rc.initialize=function(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},rc.element=function(){return this._el},rc.origin=function(t){return this._origin=t||[0,0],this},rc.scene=function(t){return arguments.length?(this._scene=t,this):this._scene},rc.on=function(){},rc.off=function(){},rc.handlers=function(){var t,e=this._handlers,n=[];for(t in e)n.push.apply(n,e[t]);return n},rc.eventName=function(t){var e=t.indexOf(".");return e<0?t:t.slice(0,e)},rc.handleHref=function(t,e,n){this._loader.sanitize(n,{context:"href"}).then(function(e){var n=new MouseEvent(t.type,t),r=Ju(null,"a");for(var i in e)r.setAttribute(i,e[i]);r.dispatchEvent(n)}).catch(function(){})},rc.handleTooltip=function(t,e,n){this._el.setAttribute("title",n||"")};var oc=ic.prototype;oc.initialize=function(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)},oc.element=function(){return this._el},oc.scene=function(){return this._el&&this._el.firstChild},oc.background=function(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)},oc.resize=function(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},oc.dirty=function(){},oc.render=function(t){var e=this;return e._call=function(){e._render(t)},e._call(),e._call=null,e},oc._render=function(){},oc.renderAsync=function(t){var e=this.render(t);return this._ready?this._ready.then(function(){return e}):Promise.resolve(e)},oc._load=function(t,e){var n=this,r=n._loader[t](e);if(!n._ready){var i=n._call;n._ready=n._loader.ready().then(function(t){t&&i(),n._ready=null})}return r},oc.sanitizeURL=function(t){return this._load("sanitizeURL",t)},oc.loadImage=function(t){return this._load("loadImage",t)};var ac=function(t,e){var n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]};function sc(t){nc.call(this,t),this._down=null,this._touch=null,this._first=!0}var uc=H(sc,nc);function cc(t,e,n){return function(r){var i=this._active,o=this.pickEvent(r);o===i?this.fire(t,r):(i&&i.exit||this.fire(n,r),this._active=o,this.fire(e,r),this.fire(t,r))}}function lc(t){return function(e){this.fire(t,e),this._active=null}}uc.initialize=function(t,e,n){var r=this._canvas=t&&Zu(t,"canvas");if(r){var i=this;this.events.forEach(function(t){r.addEventListener(t,function(e){uc[t]?uc[t].call(i,e):i.fire(t,e)})})}return nc.prototype.initialize.call(this,t,e,n)},uc.canvas=function(){return this._canvas},uc.context=function(){return this._canvas.getContext("2d")},uc.events=["keydown","keypress","keyup","dragenter","dragleave","dragover","mousedown","mouseup","mousemove","mouseout","mouseover","click","dblclick","wheel","mousewheel","touchstart","touchmove","touchend"],uc.DOMMouseScroll=function(t){this.fire("mousewheel",t)},uc.mousemove=cc("mousemove","mouseover","mouseout"),uc.dragover=cc("dragover","dragenter","dragleave"),uc.mouseout=lc("mouseout"),uc.dragleave=lc("dragleave"),uc.mousedown=function(t){this._down=this._active,this.fire("mousedown",t)},uc.click=function(t){this._down===this._active&&(this.fire("click",t),this._down=null)},uc.touchstart=function(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire("touchstart",t,!0)},uc.touchmove=function(t){this.fire("touchmove",t,!0)},uc.touchend=function(t){this.fire("touchend",t,!0),this._touch=null},uc.fire=function(t,e,n){var r,i,o=n?this._touch:this._active,a=this._handlers[t];if("click"===t&&o&&o.href?this.handleHref(e,o,o.href):("mouseover"===t||"mouseout"===t)&&o&&o.tooltip&&this.handleTooltip(e,o,"mouseover"===t?o.tooltip:null),a)for(e.vegaType=t,r=0,i=a.length;r<i;++r)a[r].handler.call(this._obj,e,o)},uc.on=function(t,e){var n=this.eventName(t),r=this._handlers;return(r[n]||(r[n]=[])).push({type:t,handler:e}),this},uc.off=function(t,e){var n,r=this.eventName(t),i=this._handlers[r];if(i){for(n=i.length;--n>=0;)i[n].type===t&&(e&&i[n].handler!==e||i.splice(n,1));return this}},uc.pickEvent=function(t){var e=ac(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},uc.pick=function(t,e,n,r,i){var o=this.context();return Vu[t.marktype].pick.call(this,o,t,e,n,r,i)};var hc="undefined"!=typeof window&&window.devicePixelRatio||1;function fc(t){ic.call(this,t),this._redraw=!1,this._dirty=new Ro}var dc=H(fc,ic),pc=ic.prototype,mc=new Ro;function gc(t){nc.call(this,t);var e=this;e._hrefHandler=yc(e,function(t,n){n&&n.href&&e.handleHref(t,n,n.href)}),e._tooltipHandler=yc(e,function(t,n){n&&n.tooltip&&e.handleTooltip(t,n,"mouseover"===t.type?n.tooltip:null)})}dc.initialize=function(t,e,n,r,i){return this._canvas=Fo(1,1),t&&(tc(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),pc.initialize.call(this,t,e,n,r,i)},dc.resize=function(t,e,n,r){var i,o,a,s,u,c,l,h;return pc.resize.call(this,t,e,n,r),i=this._canvas,o=this._width,a=this._height,s=this._origin,u=this._scale,c="undefined"!=typeof HTMLElement&&i instanceof HTMLElement&&null!=i.parentNode,l=i.getContext("2d"),i.width=o*(h=c?hc:u),i.height=a*h,c&&1!==h&&(i.style.width=o+"px",i.style.height=a+"px"),l.pixelRatio=h,l.setTransform(h,0,0,h,h*s[0],h*s[1]),this._redraw=!0,this},dc.canvas=function(){return this._canvas},dc.context=function(){return this._canvas?this._canvas.getContext("2d"):null},dc.dirty=function(t){var e=function(t,e){if(null==e)return t;for(var n=mc.clear().union(t);null!=e;e=e.mark.group)n.translate(e.x||0,e.y||0);return n}(t.bounds,t.mark.group);this._dirty.union(e)},dc._render=function(t){var e,n,r,i=this.context(),o=this._origin,a=this._width,s=this._height,u=this._dirty;return i.save(),this._redraw||u.empty()?(this._redraw=!1,u=null):(e=i,r=o,(n=u).expand(1).round(),n.translate(-r[0]%1,-r[1]%1),e.beginPath(),e.rect(n.x1,n.y1,n.width(),n.height()),e.clip(),u=n),this.clear(-o[0],-o[1],a,s),this.draw(i,t,u),i.restore(),this._dirty.clear(),this},dc.draw=function(t,e,n){var r,i,o=Vu[e.marktype];e.clip&&(i=e.group,(r=t).save(),r.beginPath(),r.rect(0,0,i.width||0,i.height||0),r.clip()),o.draw.call(this,t,e,n),e.clip&&t.restore()},dc.clear=function(t,e,n,r){var i=this.context();i.clearRect(t,e,n,r),null!=this._bgcolor&&(i.fillStyle=this._bgcolor,i.fillRect(t,e,n,r))};var vc=H(gc,nc);function yc(t,e){return function(n){var r=n.target.__data__;n.vegaType=n.type,r=Array.isArray(r)?r[0]:r,e.call(t._obj,n,r)}}function wc(t,e,n){var r,i,o="<"+t;if(e)for(r in e)null!=(i=e[r])&&(o+=" "+r+'="'+i+'"');return n&&(o+=" "+n),o+">"}function bc(t){return"</"+t+">"}vc.initialize=function(t,e,n){var r=this._svg;return r&&(r.removeEventListener("click",this._hrefHandler),r.removeEventListener("mouseover",this._tooltipHandler),r.removeEventListener("mouseout",this._tooltipHandler)),this._svg=r=t&&Zu(t,"svg"),r&&(r.addEventListener("click",this._hrefHandler),r.addEventListener("mouseover",this._tooltipHandler),r.addEventListener("mouseout",this._tooltipHandler)),nc.prototype.initialize.call(this,t,e,n)},vc.svg=function(){return this._svg},vc.on=function(t,e){var n=this.eventName(t),r=this._handlers,i={type:t,handler:e,listener:yc(this,e)};return(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener),this},vc.off=function(t,e){var n,r=this.eventName(t),i=this._svg,o=this._handlers[r];if(o){for(n=o.length;--n>=0;)(o[n].type===t&&!e||o[n].handler===e)&&(this._svg&&i.removeEventListener(r,o[n].listener),o.splice(n,1));return this}};var xc={version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},_c={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},Mc=Object.keys(_c),Ec=xc.xmlns;function Sc(t){ic.call(this,t),this._dirtyID=1,this._dirty=[],this._svg=null,this._root=null,this._defs=null}var Tc=H(Sc,ic),Ac=ic.prototype;function kc(t,e,n){var r,i,o;for((t=Ku(t,n,"linearGradient",Ec)).setAttribute("id",e.id),t.setAttribute("x1",e.x1),t.setAttribute("x2",e.x2),t.setAttribute("y1",e.y1),t.setAttribute("y2",e.y2),r=0,i=e.stops.length;r<i;++r)(o=Ku(t,r,"stop",Ec)).setAttribute("offset",e.stops[r].offset),o.setAttribute("stop-color",e.stops[r].color);tc(t,r)}function Cc(t,e,n){var r;(t=Ku(t,n,"clipPath",Ec)).setAttribute("id",e.id),(r=Ku(t,0,"rect",Ec)).setAttribute("x",0),r.setAttribute("y",0),r.setAttribute("width",e.width),r.setAttribute("height",e.height)}function Rc(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function Dc(t,e,n,r){var i,o=t._svg;if(!o&&(o=Ju(i=e.ownerDocument,r,Ec),t._svg=o,t.mark&&(o.__data__=t,o.__values__={fill:"default"},"g"===r))){var a=Ju(i,"path",Ec);a.setAttribute("class","background"),o.appendChild(a),a.__data__=t;var s=Ju(i,"g",Ec);o.appendChild(s),s.__data__=t}return!i&&o.previousSibling===n&&n||e.insertBefore(o,n?n.nextSibling:e.firstChild),o}Tc.initialize=function(t,e,n,r){return t&&(this._svg=Ku(t,0,"svg",Ec),this._svg.setAttribute("class","marks"),tc(t,1),this._root=Ku(this._svg,0,"g",Ec),tc(this._svg,1)),this._defs={gradient:{},clipping:{}},this.background(this._bgcolor),Ac.initialize.call(this,t,e,n,r)},Tc.background=function(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),Ac.background.apply(this,arguments)},Tc.resize=function(t,e,n,r){return Ac.resize.call(this,t,e,n,r),this._svg&&(this._svg.setAttribute("width",this._width*this._scale),this._svg.setAttribute("height",this._height*this._scale),this._svg.setAttribute("viewBox","0 0 "+this._width+" "+this._height),this._root.setAttribute("transform","translate("+this._origin+")")),this._dirty=[],this},Tc.svg=function(){if(!this._svg)return null;var t={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var e in xc)t[e]=xc[e];var n=this._bgcolor?wc("rect",{width:this._width,height:this._height,style:"fill: "+this._bgcolor+";"})+bc("rect"):"";return wc("svg",t)+n+this._svg.innerHTML+bc("svg")},Tc._render=function(t){return this._dirtyCheck()&&(this._dirtyAll&&this._resetDefs(),this.draw(this._root,t),tc(this._root,1)),this.updateDefs(),this._dirty=[],++this._dirtyID,this},Tc.updateDefs=function(){var t,e=this._svg,n=this._defs,r=n.el,i=0;for(t in n.gradient)r||(n.el=r=Ku(e,0,"defs",Ec)),kc(r,n.gradient[t],i++);for(t in n.clipping)r||(n.el=r=Ku(e,0,"defs",Ec)),Cc(r,n.clipping[t],i++);r&&(0===i?(e.removeChild(r),n.el=null):tc(r,i))},Tc._resetDefs=function(){var t=this._defs;t.gradient={},t.clipping={}},Tc.dirty=function(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},Tc.isDirty=function(t){return this._dirtyAll||!t._svg||t.dirty===this._dirtyID},Tc._dirtyCheck=function(){this._dirtyAll=!0;var t=this._dirty;if(!t.length)return!0;var e,n,r,i,o,a,s,u=++this._dirtyID;for(o=0,a=t.length;o<a;++o)(n=(e=t[o]).mark).marktype!==r&&(i=Vu[r=n.marktype]),n.zdirty&&n.dirty!==u&&(this._dirtyAll=!1,n.dirty=u,Rc(n.group,u)),e.exit?(i.nested&&n.items.length?(s=n.items[0])._svg&&this._update(i,s._svg,s):e._svg&&(s=e._svg.parentNode)&&s.removeChild(e._svg),e._svg=null):(e=i.nested?n.items[0]:e)._update!==u&&(e._svg&&e._svg.ownerSVGElement?this._update(i,e._svg,e):(this._dirtyAll=!1,Rc(e,u)),e._update=u);return!this._dirtyAll},Tc.draw=function(t,e,n){if(!this.isDirty(e))return e._svg;var r,i=this,o=Vu[e.marktype],a=!1===e.interactive?"none":null,s="g"===o.tag,u=null,c=0;function l(t){var e=i.isDirty(t),n=Dc(t,r,u,o.tag);e&&(i._update(o,n,t),s&&function(t,e,n){e=e.lastChild;var r,i=0;Qs(n,function(n){r=t.draw(e,n,r),++i}),tc(e,1+i)}(i,n,t)),u=n,++c}return(r=Dc(e,t,n,"g")).setAttribute("class",ec(e)),!s&&a&&r.style.setProperty("pointer-events",a),e.clip&&r.setAttribute("clip-path",hu(i,e,e.group)),o.nested?e.items.length&&l(e.items[0]):Qs(e,l),tc(r,c),r};var Lc=null,Oc=null,Pc={group:function(t,e,n){Oc=e.__values__,Lc=e.childNodes[1],t.foreground(Ic,n,this),Lc=e.childNodes[0],t.background(Ic,n,this);var r=!1===n.mark.interactive?"none":null;r!==Oc.events&&(Lc.style.setProperty("pointer-events",r),Oc.events=r)},text:function(t,e,n){var r=Iu(n);r!==Oc.text&&(e.textContent=r,Oc.text=r),(r=Nu(n))!==Oc.font&&(e.style.setProperty("font",r),Oc.font=r)}};function Ic(t,e,n){e!==Oc[t]&&(null!=e?n?Lc.setAttributeNS(n,t,e):Lc.setAttribute(t,e):n?Lc.removeAttributeNS(n,t):Lc.removeAttribute(t),Oc[t]=e)}function Nc(t){ic.call(this,t),this._text={head:"",bg:"",root:"",foot:"",defs:"",body:""},this._defs={gradient:{},clipping:{}}}Tc._update=function(t,e,n){Lc=e,Oc=e.__values__,t.attr(Ic,n,this);var r=Pc[t.type];r&&r.call(this,t,e,n),this.style(Lc,n)},Tc.style=function(t,e){var n,r,i,o,a,s;if(null!=e)for(n=0,r=Mc.length;n<r;++n)(a=e[i=Mc[n]])!==Oc[i]&&(o=_c[i],null==a?"fill"===o?t.style.setProperty(o,"none"):t.style.removeProperty(o):(a.id&&(this._defs.gradient[a.id]=a,a="url("+(s=void 0,"undefined"==typeof window?"":(s=window.location).hash?s.href.slice(0,-s.hash.length):s.href)+"#"+a.id+")"),t.style.setProperty(o,a+"")),Oc[i]=a)};var Fc,jc=H(Nc,ic),zc=ic.prototype;function Uc(t,e,n,r){Fc[r||t]=e}function Vc(t,e,n,r){if(null==t)return"";var i,o,a,s,u,c="";for("bgrect"===n&&!1===e.interactive&&(c+="pointer-events: none; "),"text"===n&&(c+="font: "+Nu(t)+"; "),i=0,o=Mc.length;i<o;++i)s=_c[a=Mc[i]],null==(u=t[a])?"fill"===s&&(c+="fill: none; "):"transparent"!==u||"fill"!==s&&"stroke"!==s?(u.id&&(r.gradient[u.id]=u,u="url(#"+u.id+")"),c+=s+": "+u+"; "):c+=s+": none; ";return c?'style="'+c.trim()+'"':null}jc.resize=function(t,e,n,r){zc.resize.call(this,t,e,n,r);var i=this._origin,o=this._text,a={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var s in xc)a[s]=xc[s];o.head=wc("svg",a);var u=this._bgcolor;return"transparent"!==u&&"none"!==u||(u=null),o.bg=u?wc("rect",{width:this._width,height:this._height,style:"fill: "+u+";"})+bc("rect"):"",o.root=wc("g",{transform:"translate("+i+")"}),o.foot=bc("g")+bc("svg"),this},jc.background=function(){var t=zc.background.apply(this,arguments);return arguments.length&&this._text.head&&this.resize(this._width,this._height,this._origin,this._scale),t},jc.svg=function(){var t=this._text;return t.head+t.bg+t.defs+t.root+t.body+t.foot},jc._render=function(t){return this._text.body=this.mark(t),this._text.defs=this.buildDefs(),this},jc.buildDefs=function(){var t,e,n,r,i=this._defs,o="";for(e in i.gradient){for(r=(n=i.gradient[e]).stops,o+=wc("linearGradient",{id:e,x1:n.x1,x2:n.x2,y1:n.y1,y2:n.y2}),t=0;t<r.length;++t)o+=wc("stop",{offset:r[t].offset,"stop-color":r[t].color})+bc("stop");o+=bc("linearGradient")}for(e in i.clipping)n=i.clipping[e],o+=wc("clipPath",{id:e}),o+=wc("rect",{x:0,y:0,width:n.width,height:n.height})+bc("rect"),o+=bc("clipPath");return o.length>0?wc("defs")+o+bc("defs"):""},jc.attributes=function(t,e){return Fc={},t(Uc,e,this),Fc},jc.href=function(t){var e,n=this,r=t.href;if(r){if(e=n._hrefs&&n._hrefs[r])return e;n.sanitizeURL(r).then(function(t){t["xlink:href"]=t.href,t.href=null,(n._hrefs||(n._hrefs={}))[r]=t})}return null},jc.mark=function(t){var e,n=this,r=Vu[t.marktype],i=r.tag,o=this._defs,a="";function s(s){var u=n.href(s);u&&(a+=wc("a",u)),e="g"!==i?Vc(s,t,i,o):null,a+=wc(i,n.attributes(r.attr,s),e),"text"===i?a+=Iu(s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):"g"===i&&(a+=wc("path",n.attributes(r.background,s),Vc(s,t,"bgrect",o))+bc("path"),a+=wc("g",n.attributes(r.foreground,s))+n.markGroup(s)+bc("g")),a+=bc(i),u&&(a+=bc("a"))}return"g"!==i&&!1===t.interactive&&(e='style="pointer-events: none;"'),a+=wc("g",{class:ec(t),"clip-path":t.clip?hu(n,t,t.group):null},e),r.nested?t.items&&t.items.length&&s(t.items[0]):Qs(t,s),a+bc("g")},jc.markGroup=function(t){var e=this,n="";return Qs(t,function(t){n+=e.mark(t)}),n};var Bc={Canvas:"canvas",PNG:"png",SVG:"svg",None:"none"},Hc={};function qc(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(Hc[t]=e,this):Hc[t]}Hc.canvas=Hc.png={renderer:fc,headless:fc,handler:sc},Hc.svg={renderer:Sc,headless:Nc,handler:gc},Hc.none={};var Gc=1e-9;function Wc(t,e,n){return t===e||("path"===n?Yc(t,e):t instanceof Date&&e instanceof Date?+t==+e:W(t)&&W(e)?Math.abs(t-e)<=Gc:t&&e&&(s(t)||s(e))?null!=t&&null!=e&&function(t,e){var n,r,i=Object.keys(t),o=Object.keys(e);if(i.length!==o.length)return!1;for(i.sort(),o.sort(),r=i.length-1;r>=0;r--)if(i[r]!=o[r])return!1;for(r=i.length-1;r>=0;r--)if(!Wc(t[n=i[r]],e[n],n))return!1;return typeof t==typeof e}(t,e):t==e)}function Yc(t,e){return Wc(ns(t),ns(e))}function Xc(t){Ir.call(this,null,t)}var $c=H(Xc,Ir),Qc=new Ro;function Jc(t,e,n){return e(t.bounds.clear(),t,n)}$c.transform=function(t,e){var n,r=e.dataflow,i=t.mark,o=i.marktype,a=Vu[o],s=a.bound,u=i.clip,c=i.bounds;return a.nested?(i.items.length&&r.dirty(i.items[0]),c=Jc(i,s),i.items.forEach(function(t){t.bounds.clear().union(c)})):"group"===o||t.modified()?(e.visit(e.MOD,function(t){r.dirty(t)}),c.clear(),i.items.forEach(function(t){c.union(Jc(t,s))})):(n=e.changed(e.REM),e.visit(e.ADD,function(t){c.union(Jc(t,s))}),e.visit(e.MOD,function(t){n=n||c.alignsWith(t.bounds),r.dirty(t),c.union(Jc(t,s))}),n&&!u&&(c.clear(),i.items.forEach(function(t){c.union(t.bounds)}))),u&&c.intersect(Qc.set(0,0,i.group.width,i.group.height)),e.modifies("bounds")};var Zc=":vega_identifier:";function Kc(t){Ir.call(this,0,t)}function tl(t){Ir.call(this,null,t)}Kc.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},H(Kc,Ir).transform=function(t,e){var n=function(t){var e=t._signals[Zc];return e||(t._signals[Zc]=e=t.add(0)),e}(e.dataflow),r=n.value,i=t.as;return e.visit(e.ADD,function(t){t[i]||(t[i]=++r)}),n.set(this.value=r),e},H(tl,Ir).transform=function(t,e){var n,r,i,o=this.value;o||((o=e.dataflow.scenegraph().mark(t.markdef,(r=(n=t).groups,i=n.parent,r&&1===r.size?r.get(Object.keys(r.object)[0]):r&&i?r.lookup(i):null),t.index)).group.context=t.context,t.context.group||(t.context.group=o.group),o.source=this,this.value=o);var a="group"===o.marktype?No:Io;return e.visit(e.ADD,function(t){a.call(t,o)}),o.items=e.source,e};var el="top",nl="left",rl="right",il="bottom";function ol(t){Ir.call(this,null,t)}var al={parity:function(t){return t.filter(function(t,e){return e%2?t.opacity=0:1})},greedy:function(t){var e;return t.filter(function(t,n){return n&&sl(e.bounds,t.bounds)?t.opacity=0:(e=t,1)})}};function sl(t,e){return!(t.x2-1<e.x1||t.x1+1>e.x2||t.y2-1<e.y1||t.y1+1>e.y2)}function ul(t){for(var e,n=1,r=t.length,i=t[0].bounds;n<r;i=e,++n)if(sl(i,e=t[n].bounds))return!0}function cl(t){var e=t.bounds;return e.width()>1&&e.height()>1}function ll(t){Ir.call(this,null,t)}function hl(t,e){for(var n=0,r=t.length;n<r;++n)e.push(t[n])}function fl(t){return{x1:0,y1:0,x2:t.width||0,y2:t.height||0}}function dl(t){var e=t.bounds.clone();return e.empty()?e.set(0,0,0,0):e.translate(-(t.x||0),-(t.y||0))}function pl(t,e){return"x1"===e?t.x||0:"y1"===e?t.y||0:"x2"===e?(t.x||0)+(t.width||0):"y2"===e?(t.y||0)+(t.height||0):void 0}function ml(t,e){return t.bounds[e]}function gl(t,e,n){var r=s(t)?t[e]:t;return null!=r?r:void 0!==n?n:0}function vl(t){return t<0?Math.ceil(-t):0}function yl(t,e,n,r,i,o,a,s,u,c,l,h,f,d){var p,m,g,v,y,w,b,x,_,M=n.length,E=0,S=0;if(!M)return E;for(p=l;p<M;p+=h)n[p]&&(E=a(E,u(n[p],c)));if(!e.length)return E;for(e.length>i&&(t.warn("Grid headers exceed limit: "+i),e=e.slice(0,i)),E+=o,m=0,v=e.length;m<v;++m)t.dirty(e[m]),e[m].mark.bounds.clear();for(p=l,m=0,v=e.length;m<v;++m,p+=h){for(y=(w=e[m]).mark.bounds,g=p;g>=0&&null==(b=n[g]);g-=f);s?(x=null==d?b.x:Math.round(b.bounds.x1+d*b.bounds.width()),_=E):(x=E,_=null==d?b.y:Math.round(b.bounds.y1+d*b.bounds.height())),y.union(w.bounds.translate(x-(w.x||0),_-(w.y||0))),w.x=x,w.y=_,t.dirty(w),S=a(S,y[c])}return S}function wl(t,e,n,r,i,o){if(e){t.dirty(e);var a=n,s=n;r?a=Math.round(i.x1+o*i.width()):s=Math.round(i.y1+o*i.height()),e.bounds.translate(a-(e.x||0),s-(e.y||0)),e.mark.bounds.clear().union(e.bounds),e.x=a,e.y=s,t.dirty(e)}}H(ol,Ir).transform=function(t,e){var n=al[t.method]||al.parity,r=e.materialize(e.SOURCE).source;if(r){t.sort&&(r=r.slice().sort(t.sort)),"greedy"===t.method&&(r=r.filter(cl)),r.forEach(function(t){t.opacity=1});var i,o,a,s,u=r;if(u.length>=3&&ul(u)){e=e.reflow(t.modified()).modifies("opacity");do{u=n(u)}while(u.length>=3&&ul(u));u.length<3&&!x(r).opacity&&(u.length>1&&(x(u).opacity=0),x(r).opacity=1)}if(t.boundScale){var c=(i=t.boundOrient,o=t.boundTolerance,a=t.boundScale.range(),s=new Ro,i===el||i===il?s.set(a[0],-1/0,a[1],1/0):s.set(-1/0,a[0],1/0,a[1]),s.expand(o||1),function(t){return s.encloses(t.bounds)});r.forEach(function(t){c(t)||(t.opacity=0)})}return e}},H(ll,Ir).transform=function(t,e){var n=e.dataflow;if(e.visit(e.ALL,function(t){n.dirty(t)}),e.fields&&e.fields.zindex){var r=e.source&&e.source[0];r&&(r.mark.zdirty=!0)}};var bl=.5,xl=new Ro;function _l(t){Ir.call(this,null,t)}function Ml(t,e,n){return t[e]===n?0:(t[e]=n,1)}function El(t){var e=t.items[0].datum.orient;return e===nl||e===rl}function Sl(t,e,n,r){var i,o,a,s,u=e.items[0],c=u.datum,l=c.orient,h=(s=+(a=c).grid,[a.ticks?s++:-1,a.labels?s++:-1,s+ +a.domain]),f=u.range,d=u.offset,p=u.position,m=u.minExtent,g=u.maxExtent,v=c.title&&u.items[h[2]].items[0],y=u.titlePadding,w=u.bounds,b=0,x=0;switch(xl.clear().union(w),w.clear(),(i=h[0])>-1&&w.union(u.items[i].bounds),(i=h[1])>-1&&w.union(u.items[i].bounds),l){case el:b=p||0,x=-d,o=Math.max(m,Math.min(g,-w.y1)),v&&(v.auto?(v.y=-(o+=y),o+=v.bounds.height(),w.add(v.bounds.x1,0).add(v.bounds.x2,0)):w.union(v.bounds)),w.add(0,-o).add(f,0);break;case nl:b=-d,x=p||0,o=Math.max(m,Math.min(g,-w.x1)),v&&(v.auto?(v.x=-(o+=y),o+=v.bounds.width(),w.add(0,v.bounds.y1).add(0,v.bounds.y2)):w.union(v.bounds)),w.add(-o,0).add(0,f);break;case rl:b=n+d,x=p||0,o=Math.max(m,Math.min(g,w.x2)),v&&(v.auto?(v.x=o+=y,o+=v.bounds.width(),w.add(0,v.bounds.y1).add(0,v.bounds.y2)):w.union(v.bounds)),w.add(0,0).add(o,f);break;case il:b=p||0,x=r+d,o=Math.max(m,Math.min(g,w.y2)),v&&(v.auto?(v.y=o+=y,o+=v.bounds.height(),w.add(v.bounds.x1,0).add(v.bounds.x2,0)):w.union(v.bounds)),w.add(0,0).add(f,o);break;default:b=u.x,x=u.y}return Fs(w.translate(b,x),u),Ml(u,"x",b+bl)|Ml(u,"y",x+bl)&&(u.bounds=xl,t.dirty(u),u.bounds=w,t.dirty(u)),u.mark.bounds.clear().union(w)}function Tl(t,e,n,r,i,o,a){var s,u,c,l=e.items[0],h=l.datum.orient,f=l.offset,d=l.bounds,p=0,m=0;switch(h===el||h===il?(c=i,p=n[h]):h!==nl&&h!==rl||(c=r,m=n[h]),xl.clear().union(d),d.clear(),l.items.forEach(function(t){d.union(t.bounds)}),s=Math.round(d.width())+2*l.padding-1,u=Math.round(d.height())+2*l.padding-1,h){case nl:p-=s+f-Math.floor(c.x1),n.left+=u+n.margin;break;case rl:p+=f+Math.ceil(c.x2),n.right+=u+n.margin;break;case el:m-=u+f-Math.floor(c.y1),n.top+=s+n.margin;break;case il:m+=f+Math.ceil(c.y2),n.bottom+=s+n.margin;break;case"top-left":p+=f,m+=f;break;case"top-right":p+=o-s-f,m+=f;break;case"bottom-left":p+=f,m+=a-u-f;break;case"bottom-right":p+=o-s-f,m+=a-u-f;break;default:p=l.x,m=l.y}return Fs(d.set(p,m,p+s,m+u),l),Ml(l,"x",p)|Ml(l,"width",s)|Ml(l,"y",m)|Ml(l,"height",u)&&(l.bounds=xl,t.dirty(l),l.bounds=d,t.dirty(l)),l.mark.bounds.clear().union(d)}H(_l,Ir).transform=function(t,e){var n=e.dataflow;return t.mark.items.forEach(function(e){t.layout&&function(t,e,n){var r,i,o,a,s,u,c,l,h,f,d,p,m,g=function(t){for(var e,n,r=t.items,i=r.length,o=0,a={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};o<i;++o)if(n=(e=r[o]).items,"group"===e.marktype)switch(e.role){case"axis":case"legend":break;case"row-header":hl(n,a.rowheaders);break;case"row-footer":hl(n,a.rowfooters);break;case"column-header":hl(n,a.colheaders);break;case"column-footer":hl(n,a.colfooters);break;case"row-title":a.rowtitle=n[0];break;case"column-title":a.coltitle=n[0];break;default:hl(n,a.marks)}return a}(e),v=g.marks,y="flush"===n.bounds,w=y?fl:dl,b=new Ro(0,0,0,0),x=gl(n.align,"column"),_=gl(n.align,"row"),M=gl(n.padding,"column"),E=gl(n.padding,"row"),S=n.offset,T=e.columns||n.columns||v.length,A=T<0?1:Math.ceil(v.length/T),k=A*T,C=[],R=[],D=[],L=[],O=v.length;for(i=0;i<T;++i)R[i]=0;for(i=0;i<A;++i)L[i]=0;for(i=0;i<O;++i)s=w(v[i]),a=~~(i/T),c=(o=i%T)?Math.ceil(w(v[i-1]).x2):0,l=a?Math.ceil(w(v[i-T]).y2):0,R[o]=Math.max(R[o],c),L[a]=Math.max(L[a],l),C.push(M+vl(s.x1)),D.push(E+vl(s.y1)),t.dirty(v[i]);for(i=0;i<O;++i)i%T==0&&(C[i]=0),i<T&&(D[i]=0);if("each"===x)for(o=1;o<T;++o){for(m=0,i=o;i<O;i+=T)m<C[i]&&(m=C[i]);for(i=o;i<O;i+=T)C[i]=m+R[o]}else if("all"===x){for(p=0,o=1;o<T;++o)p<R[o]&&(p=R[o]);for(m=0,i=0;i<O;++i)i%T&&m<C[i]&&(m=C[i]);for(i=0;i<O;++i)i%T&&(C[i]=m+p)}else for(o=1;o<T;++o)for(i=o;i<O;i+=T)C[i]+=R[o];if("each"===_)for(a=1;a<A;++a){for(m=0,r=(i=a*T)+T;i<r;++i)m<D[i]&&(m=D[i]);for(i=a*T;i<r;++i)D[i]=m+L[a]}else if("all"===_){for(p=0,a=1;a<A;++a)p<L[a]&&(p=L[a]);for(m=0,i=T;i<O;++i)m<D[i]&&(m=D[i]);for(i=T;i<O;++i)D[i]=m+p}else for(a=1;a<A;++a)for(r=(i=a*T)+T;i<r;++i)D[i]+=L[a];for(h=0,i=0;i<O;++i)c=(u=v[i]).x||0,u.x=h=C[i]+(i%T?h:0),u.bounds.translate(h-c,0);for(o=0;o<T;++o)for(f=0,i=o;i<O;i+=T)l=(u=v[i]).y||0,u.y=f+=D[i],u.bounds.translate(0,f-l);for(i=0;i<O;++i)v[i].mark.bounds.clear();for(i=0;i<O;++i)t.dirty(u=v[i]),b.union(u.mark.bounds.union(u.bounds));function P(t,e){return Math.floor(Math.min(t,e))}function I(t,e){return Math.ceil(Math.max(t,e))}w=y?pl:ml,d=gl(n.headerBand,"row",null),h=yl(t,g.rowheaders,v,0,A,-gl(S,"rowHeader"),P,0,w,"x1",0,T,1,d),d=gl(n.headerBand,"column",null),f=yl(t,g.colheaders,v,0,T,-gl(S,"columnHeader"),P,1,w,"y1",0,1,T,d),d=gl(n.footerBand,"row",null),yl(t,g.rowfooters,v,0,A,gl(S,"rowFooter"),I,0,w,"x2",T-1,T,1,d),d=gl(n.footerBand,"column",null),yl(t,g.colfooters,v,0,T,gl(S,"columnFooter"),I,1,w,"y2",k-T,1,T,d),g.rowtitle&&(m=h-gl(S,"rowTitle"),d=gl(n.titleBand,"row",.5),wl(t,g.rowtitle,m,0,b,d)),g.coltitle&&(m=f-gl(S,"columnTitle"),d=gl(n.titleBand,"column",.5),wl(t,g.coltitle,m,1,b,d))}(n,e,t.layout),function(t,e,n){var r,i,o,a,s,u,c=e.items,l=Math.max(0,e.width||0),h=Math.max(0,e.height||0),f=(new Ro).set(0,0,l,h),d=f.clone(),p=f.clone(),m=f.clone(),g=[];for(s=0,u=c.length;s<u;++s)switch((i=c[s]).role){case"axis":d.union(a=Sl(t,i,l,h)),(El(i)?p:m).union(a);break;case"title":r=i;break;case"legend":g.push(i);break;case"frame":case"scope":case"row-header":case"row-footer":case"column-header":case"column-footer":p.union(i.bounds),m.union(i.bounds);break;default:f.union(i.bounds)}if(r&&(d.union(a=function(t,e,n){var r=e.items[0],i=r.datum.orient,o=r.offset,a=r.bounds,s=0,u=0;switch(xl.clear().union(a),i){case el:s=r.x,u=n.y1-o;break;case nl:s=n.x1-o,u=r.y;break;case rl:s=n.x2+o,u=r.y;break;case il:s=r.x,u=n.y2+o;break;default:s=r.x,u=r.y}return a.translate(s-r.x,u-r.y),Ml(r,"x",s)|Ml(r,"y",u)&&(r.bounds=xl,t.dirty(r),r.bounds=a,t.dirty(r)),e.bounds.clear().union(a)}(t,r,d)),(El(r)?p:m).union(a)),g.length)for(o={left:0,right:0,top:0,bottom:0,margin:n.legendMargin||8},s=0,u=g.length;s<u;++s)if(a=Tl(t,g[s],o,p,m,l,h),n.autosize&&"fit"===n.autosize.type){var v=g[s].items[0].datum.orient;v===nl||v===rl?f.add(a.x1,0).add(a.x2,0):v!==el&&v!==il||f.add(0,a.y1).add(0,a.y2)}else f.union(a);f.union(p).union(m).union(d),function(t,e,n,r){var i=r.autosize||{},o=i.type,a=t._width,s=t._height,u=t.padding();if(!(t._autosize<1)&&o){var c=Math.max(0,e.width||0),l=Math.max(0,Math.ceil(-n.x1)),h=Math.max(0,Math.ceil(n.x2-c)),f=Math.max(0,e.height||0),d=Math.max(0,Math.ceil(-n.y1)),p=Math.max(0,Math.ceil(n.y2-f));"padding"===i.contains&&(a-=u.left+u.right,s-=u.top+u.bottom),"none"===o?(l=0,d=0,c=a,f=s):"fit"===o?(c=Math.max(0,a-l-h),f=Math.max(0,s-d-p)):"pad"===o&&(a=c+l+h,s=f+d+p),t._resizeView(a,s,c,f,[l,d],i.resize)}}(t,e,f,n)}(n,e,t)}),e};var Al=Object.freeze({bound:Xc,identifier:Kc,mark:tl,overlap:ol,render:ll,viewlayout:_l}),kl="log",Cl="sqrt",Rl="linear",Dl="quantile",Ll="quantize",Ol="threshold",Pl="bin-ordinal",Il="sequential",Nl=function(t){return function(e){var n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}},Fl=function(t){return function(e){var n,r,i,o,a=t.range(),s=e[0],u=e[1],c=-1;for(u<s&&(r=s,s=u,u=r),i=0,o=a.length;i<o;++i)a[i]>=s&&a[i]<=u&&(c<0&&(c=i),n=i);if(!(c<0))return s=t.invertExtent(a[c]),u=t.invertExtent(a[n]),[void 0===s[0]?s[1]:s[0],void 0===u[1]?u[0]:u[1]]}},jl=function(t,e,n){var r=t-e+2*n;return t?r>0?r:1:0},zl=Array.prototype,Ul=zl.map,Vl=zl.slice,Bl={name:"implicit"};function Hl(t){var e=Dt(),n=[],r=Bl;function i(i){var o=i+"",a=e.get(o);if(!a){if(r!==Bl)return r;e.set(o,a=n.push(i))}return t[(a-1)%t.length]}return t=null==t?[]:Vl.call(t),i.domain=function(t){if(!arguments.length)return n.slice();n=[],e=Dt();for(var r,o,a=-1,s=t.length;++a<s;)e.has(o=(r=t[a])+"")||e.set(o,n.push(r));return i},i.range=function(e){return arguments.length?(t=Vl.call(e),i):t.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return Hl().domain(n).range(t).unknown(r)},i}var ql=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function Gl(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Wl(){}var Yl=1/.7,Xl="\\s*([+-]?\\d+)\\s*",$l="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ql="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Jl=/^#([0-9a-f]{3})$/,Zl=/^#([0-9a-f]{6})$/,Kl=new RegExp("^rgb\\("+[Xl,Xl,Xl]+"\\)$"),th=new RegExp("^rgb\\("+[Ql,Ql,Ql]+"\\)$"),eh=new RegExp("^rgba\\("+[Xl,Xl,Xl,$l]+"\\)$"),nh=new RegExp("^rgba\\("+[Ql,Ql,Ql,$l]+"\\)$"),rh=new RegExp("^hsl\\("+[$l,Ql,Ql]+"\\)$"),ih=new RegExp("^hsla\\("+[$l,Ql,Ql,$l]+"\\)$"),oh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function ah(t){var e;return t=(t+"").trim().toLowerCase(),(e=Jl.exec(t))?new hh((e=parseInt(e[1],16))>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):(e=Zl.exec(t))?sh(parseInt(e[1],16)):(e=Kl.exec(t))?new hh(e[1],e[2],e[3],1):(e=th.exec(t))?new hh(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=eh.exec(t))?uh(e[1],e[2],e[3],e[4]):(e=nh.exec(t))?uh(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=rh.exec(t))?fh(e[1],e[2]/100,e[3]/100,1):(e=ih.exec(t))?fh(e[1],e[2]/100,e[3]/100,e[4]):oh.hasOwnProperty(t)?sh(oh[t]):"transparent"===t?new hh(NaN,NaN,NaN,0):null}function sh(t){return new hh(t>>16&255,t>>8&255,255&t,1)}function uh(t,e,n,r){return r<=0&&(t=e=n=NaN),new hh(t,e,n,r)}function ch(t){return t instanceof Wl||(t=ah(t)),t?new hh((t=t.rgb()).r,t.g,t.b,t.opacity):new hh}function lh(t,e,n,r){return 1===arguments.length?ch(t):new hh(t,e,n,null==r?1:r)}function hh(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function fh(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ph(t,e,n,r)}function dh(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof ph)return new ph(t.h,t.s,t.l,t.opacity);if(t instanceof Wl||(t=ah(t)),!t)return new ph;if(t instanceof ph)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new ph(a,s,u,t.opacity)}(t):new ph(t,e,n,null==r?1:r)}function ph(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function mh(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}ql(Wl,ah,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),ql(hh,lh,Gl(Wl,{brighter:function(t){return t=null==t?Yl:Math.pow(Yl,t),new hh(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new hh(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),ql(ph,dh,Gl(Wl,{brighter:function(t){return t=null==t?Yl:Math.pow(Yl,t),new ph(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new ph(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new hh(mh(t>=240?t-240:t+120,i,r),mh(t,i,r),mh(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var gh=Math.PI/180,vh=180/Math.PI,yh=.95047,wh=1,bh=1.08883,xh=4/29,_h=6/29,Mh=3*_h*_h,Eh=_h*_h*_h;function Sh(t){if(t instanceof Ah)return new Ah(t.l,t.a,t.b,t.opacity);if(t instanceof Oh){var e=t.h*gh;return new Ah(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}t instanceof hh||(t=ch(t));var n=Dh(t.r),r=Dh(t.g),i=Dh(t.b),o=kh((.4124564*n+.3575761*r+.1804375*i)/yh),a=kh((.2126729*n+.7151522*r+.072175*i)/wh);return new Ah(116*a-16,500*(o-a),200*(a-kh((.0193339*n+.119192*r+.9503041*i)/bh)),t.opacity)}function Th(t,e,n,r){return 1===arguments.length?Sh(t):new Ah(t,e,n,null==r?1:r)}function Ah(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function kh(t){return t>Eh?Math.pow(t,1/3):t/Mh+xh}function Ch(t){return t>_h?t*t*t:Mh*(t-xh)}function Rh(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Dh(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Lh(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof Oh)return new Oh(t.h,t.c,t.l,t.opacity);t instanceof Ah||(t=Sh(t));var e=Math.atan2(t.b,t.a)*vh;return new Oh(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}(t):new Oh(t,e,n,null==r?1:r)}function Oh(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}ql(Ah,Th,Gl(Wl,{brighter:function(t){return new Ah(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new Ah(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return t=wh*Ch(t),new hh(Rh(3.2404542*(e=yh*Ch(e))-1.5371385*t-.4985314*(n=bh*Ch(n))),Rh(-.969266*e+1.8760108*t+.041556*n),Rh(.0556434*e-.2040259*t+1.0572252*n),this.opacity)}})),ql(Oh,Lh,Gl(Wl,{brighter:function(t){return new Oh(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new Oh(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return Sh(this).rgb()}}));var Ph=1.78277,Ih=-.29227,Nh=-.90649,Fh=1.97294,jh=Fh*Nh,zh=Fh*Ph,Uh=Ph*Ih- -.14861*Nh;function Vh(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof Bh)return new Bh(t.h,t.s,t.l,t.opacity);t instanceof hh||(t=ch(t));var e=t.g/255,n=t.b/255,r=(Uh*n+jh*(t.r/255)-zh*e)/(Uh+jh-zh),i=n-r,o=(Fh*(e-r)-Ih*i)/Nh,a=Math.sqrt(o*o+i*i)/(Fh*r*(1-r)),s=a?Math.atan2(o,i)*vh-120:NaN;return new Bh(s<0?s+360:s,a,r,t.opacity)}(t):new Bh(t,e,n,null==r?1:r)}function Bh(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Hh(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}ql(Bh,Vh,Gl(Wl,{brighter:function(t){return t=null==t?Yl:Math.pow(Yl,t),new Bh(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Bh(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*gh,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new hh(255*(e+n*(-.14861*r+Ph*i)),255*(e+n*(Ih*r+Nh*i)),255*(e+n*(Fh*r)),this.opacity)}}));var qh=function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1];return Hh((n-r/e)*e,r>0?t[r-1]:2*i-o,i,o,r<e-1?t[r+2]:2*o-i)}},Gh=function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e);return Hh((n-r/e)*e,t[(r+e-1)%e],t[r%e],t[(r+1)%e],t[(r+2)%e])}},Wh=function(t){return function(){return t}};function Yh(t,e){return function(n){return t+n*e}}function Xh(t,e){var n=e-t;return n?Yh(t,n>180||n<-180?n-360*Math.round(n/360):n):Wh(isNaN(t)?e:t)}function $h(t,e){var n=e-t;return n?Yh(t,n):Wh(isNaN(t)?e:t)}var Qh=function t(e){var n=function(t){return 1==(t=+t)?$h:function(e,n){return n-e?(r=e,i=n,o=t,r=Math.pow(r,o),i=Math.pow(i,o)-r,o=1/o,function(t){return Math.pow(r+t*i,o)}):Wh(isNaN(e)?n:e);var r,i,o}}(e);function r(t,e){var r=n((t=lh(t)).r,(e=lh(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=$h(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function Jh(t){return function(e){var n,r,i=e.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=lh(e[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=t(o),a=t(a),s=t(s),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=s(t),r+""}}}var Zh,Kh,tf,ef,nf=Jh(qh),rf=Jh(Gh),of=function(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=ff(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<i;++n)a[n]=o[n](t);return a}},af=function(t,e){var n=new Date;return e-=t=+t,function(r){return n.setTime(t+e*r),n}},sf=function(t,e){return e-=t=+t,function(n){return t+e*n}},uf=function(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=ff(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}},cf=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,lf=new RegExp(cf.source,"g"),hf=function(t,e){var n,r,i,o,a,s=cf.lastIndex=lf.lastIndex=0,u=-1,c=[],l=[];for(t+="",e+="";(n=cf.exec(t))&&(r=lf.exec(e));)(i=r.index)>s&&(i=e.slice(s,i),c[u]?c[u]+=i:c[++u]=i),(n=n[0])===(r=r[0])?c[u]?c[u]+=r:c[++u]=r:(c[++u]=null,l.push({i:u,x:sf(n,r)})),s=lf.lastIndex;return s<e.length&&(i=e.slice(s),c[u]?c[u]+=i:c[++u]=i),c.length<2?l[0]?(a=l[0].x,function(t){return a(t)+""}):(o=e,function(){return o}):(e=l.length,function(t){for(var n,r=0;r<e;++r)c[(n=l[r]).i]=n.x(t);return c.join("")})},ff=function(t,e){var n,r=typeof e;return null==e||"boolean"===r?Wh(e):("number"===r?sf:"string"===r?(n=ah(e))?(e=n,Qh):hf:e instanceof ah?Qh:e instanceof Date?af:Array.isArray(e)?of:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?uf:sf)(t,e)},df=function(t,e){return e-=t=+t,function(n){return Math.round(t+e*n)}},pf=180/Math.PI,mf={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},gf=function(t,e,n,r,i,o){var a,s,u;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),t*r<e*n&&(t=-t,e=-e,u=-u,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*pf,skewX:Math.atan(u)*pf,scaleX:a,scaleY:s}};function vf(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var s,u,c,l,h,f,d=[],p=[];return o=t(o),a=t(a),function(t,r,i,o,a,s){if(t!==i||r!==o){var u=a.push("translate(",null,e,null,n);s.push({i:u-4,x:sf(t,i)},{i:u-2,x:sf(r,o)})}else(i||o)&&a.push("translate("+i+e+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,d,p),c=d,(s=o.rotate)!==(u=a.rotate)?(s-u>180?u+=360:u-s>180&&(s+=360),p.push({i:c.push(i(c)+"rotate(",null,r)-2,x:sf(s,u)})):u&&c.push(i(c)+"rotate("+u+r),f=d,(l=o.skewX)!==(h=a.skewX)?p.push({i:f.push(i(f)+"skewX(",null,r)-2,x:sf(l,h)}):h&&f.push(i(f)+"skewX("+h+r),function(t,e,n,r,o,a){if(t!==n||e!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:sf(t,n)},{i:s-2,x:sf(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,d,p),o=a=null,function(t){for(var e,n=-1,r=p.length;++n<r;)d[(e=p[n]).i]=e.x(t);return d.join("")}}}var yf=vf(function(t){return"none"===t?mf:(Zh||(Zh=document.createElement("DIV"),Kh=document.documentElement,tf=document.defaultView),Zh.style.transform=t,t=tf.getComputedStyle(Kh.appendChild(Zh),null).getPropertyValue("transform"),Kh.removeChild(Zh),t=t.slice(7,-1).split(","),gf(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))},"px, ","px)","deg)"),wf=vf(function(t){return null==t?mf:(ef||(ef=document.createElementNS("http://www.w3.org/2000/svg","g")),ef.setAttribute("transform",t),(t=ef.transform.baseVal.consolidate())?gf((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):mf)},", ",")",")"),bf=Math.SQRT2;function xf(t){return((t=Math.exp(t))+1/t)/2}function _f(t){return function(e,n){var r=t((e=dh(e)).h,(n=dh(n)).h),i=$h(e.s,n.s),o=$h(e.l,n.l),a=$h(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=o(t),e.opacity=a(t),e+""}}}var Mf=_f(Xh),Ef=_f($h);function Sf(t){return function(e,n){var r=t((e=Lh(e)).h,(n=Lh(n)).h),i=$h(e.c,n.c),o=$h(e.l,n.l),a=$h(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=o(t),e.opacity=a(t),e+""}}}var Tf=Sf(Xh),Af=Sf($h);function kf(t){return function e(n){function r(e,r){var i=t((e=Vh(e)).h,(r=Vh(r)).h),o=$h(e.s,r.s),a=$h(e.l,r.l),s=$h(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=o(t),e.l=a(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}var Cf=kf(Xh),Rf=kf($h),Df=Object.freeze({interpolate:ff,interpolateArray:of,interpolateBasis:qh,interpolateBasisClosed:Gh,interpolateDate:af,interpolateNumber:sf,interpolateObject:uf,interpolateRound:df,interpolateString:hf,interpolateTransformCss:yf,interpolateTransformSvg:wf,interpolateZoom:function(t,e){var n,r,i=t[0],o=t[1],a=t[2],s=e[2],u=e[0]-i,c=e[1]-o,l=u*u+c*c;if(l<1e-12)r=Math.log(s/a)/bf,n=function(t){return[i+t*u,o+t*c,a*Math.exp(bf*t*r)]};else{var h=Math.sqrt(l),f=(s*s-a*a+4*l)/(2*a*2*h),d=(s*s-a*a-4*l)/(2*s*2*h),p=Math.log(Math.sqrt(f*f+1)-f),m=Math.log(Math.sqrt(d*d+1)-d);r=(m-p)/bf,n=function(t){var e,n,s=t*r,l=xf(p),f=a/(2*h)*(l*(n=bf*s+p,((n=Math.exp(2*n))-1)/(n+1))-(e=p,((e=Math.exp(e))-1/e)/2));return[i+f*u,o+f*c,a*l/xf(bf*s+p)]}}return n.duration=1e3*r,n},interpolateRgb:Qh,interpolateRgbBasis:nf,interpolateRgbBasisClosed:rf,interpolateHsl:Mf,interpolateHslLong:Ef,interpolateLab:function(t,e){var n=$h((t=Th(t)).l,(e=Th(e)).l),r=$h(t.a,e.a),i=$h(t.b,e.b),o=$h(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=o(e),t+""}},interpolateHcl:Tf,interpolateHclLong:Af,interpolateCubehelix:Cf,interpolateCubehelixLong:Rf,quantize:function(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}}),Lf=function(t){return function(){return t}},Of=function(t){return+t},Pf=[0,1];function If(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Lf(e)}function Nf(t,e,n,r){var i=t[0],o=t[1],a=e[0],s=e[1];return o<i?(i=n(o,i),a=r(s,a)):(i=n(i,o),a=r(a,s)),function(t){return a(i(t))}}function Ff(t,e,n,r){var i=Math.min(t.length,e.length)-1,o=new Array(i),a=new Array(i),s=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<i;)o[s]=n(t[s],t[s+1]),a[s]=r(e[s],e[s+1]);return function(e){var n=ti(t,e,1,i)-1;return a[n](o[n](e))}}function jf(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp())}function zf(t,e){var n,r,i,o=Pf,a=Pf,s=ff,u=!1;function c(){return n=Math.min(o.length,a.length)>2?Ff:Nf,r=i=null,l}function l(e){return(r||(r=n(o,a,u?(i=t,function(t,e){var n=i(t=+t,e=+e);return function(r){return r<=t?0:r>=e?1:n(r)}}):t,s)))(+e);var i}return l.invert=function(t){return(i||(i=n(a,o,If,u?(r=e,function(t,e){var n=r(t=+t,e=+e);return function(r){return r<=0?t:r>=1?e:n(r)}}):e)))(+t);var r},l.domain=function(t){return arguments.length?(o=Ul.call(t,Of),c()):o.slice()},l.range=function(t){return arguments.length?(a=Vl.call(t),c()):a.slice()},l.rangeRound=function(t){return a=Vl.call(t),s=df,c()},l.clamp=function(t){return arguments.length?(u=!!t,c()):u},l.interpolate=function(t){return arguments.length?(s=t,c()):s},c()}var Uf,Vf=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]},Bf=function(t){return(t=Vf(Math.abs(t)))?t[1]:NaN},Hf=function(t,e){var n=Vf(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},qf={"":function(t,e){t=t.toPrecision(e);t:for(var n,r=t.length,i=1,o=-1;i<r;++i)switch(t[i]){case".":o=n=i;break;case"0":0===o&&(o=i),n=i;break;case"e":break t;default:o>0&&(o=0)}return o>0?t.slice(0,o)+t.slice(n+1):t},"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Hf(100*t,e)},r:Hf,s:function(t,e){var n=Vf(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(Uf=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Vf(t,Math.max(0,e+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},Gf=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;function Wf(t){return new Yf(t)}function Yf(t){if(!(e=Gf.exec(t)))throw new Error("invalid format: "+t);var e,n=e[1]||" ",r=e[2]||">",i=e[3]||"-",o=e[4]||"",a=!!e[5],s=e[6]&&+e[6],u=!!e[7],c=e[8]&&+e[8].slice(1),l=e[9]||"";"n"===l?(u=!0,l="g"):qf[l]||(l=""),(a||"0"===n&&"="===r)&&(a=!0,n="0",r="="),this.fill=n,this.align=r,this.sign=i,this.symbol=o,this.zero=a,this.width=s,this.comma=u,this.precision=c,this.type=l}Wf.prototype=Yf.prototype,Yf.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var Xf,$f,Qf,Jf=function(t){return t},Zf=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"],Kf=function(t){var e,n,r,i=t.grouping&&t.thousands?(n=t.grouping,r=t.thousands,function(t,e){for(var i=t.length,o=[],a=0,s=n[0],u=0;i>0&&s>0&&(u+s+1>e&&(s=Math.max(1,e-u)),o.push(t.substring(i-=s,i+s)),!((u+=s+1)>e));)s=n[a=(a+1)%n.length];return o.reverse().join(r)}):Jf,o=t.currency,a=t.decimal,s=t.numerals?(e=t.numerals,function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}):Jf,u=t.percent||"%";function c(t){var e=(t=Wf(t)).fill,n=t.align,r=t.sign,c=t.symbol,l=t.zero,h=t.width,f=t.comma,d=t.precision,p=t.type,m="$"===c?o[0]:"#"===c&&/[boxX]/.test(p)?"0"+p.toLowerCase():"",g="$"===c?o[1]:/[%p]/.test(p)?u:"",v=qf[p],y=!p||/[defgprs%]/.test(p);function w(t){var o,u,c,w=m,b=g;if("c"===p)b=v(t)+b,t="";else{var x=(t=+t)<0;if(t=v(Math.abs(t),d),x&&0==+t&&(x=!1),w=(x?"("===r?r:"-":"-"===r||"("===r?"":r)+w,b=("s"===p?Zf[8+Uf/3]:"")+b+(x&&"("===r?")":""),y)for(o=-1,u=t.length;++o<u;)if(48>(c=t.charCodeAt(o))||c>57){b=(46===c?a+t.slice(o+1):t.slice(o))+b,t=t.slice(0,o);break}}f&&!l&&(t=i(t,1/0));var _=w.length+t.length+b.length,M=_<h?new Array(h-_+1).join(e):"";switch(f&&l&&(t=i(M+t,M.length?h-b.length:1/0),M=""),n){case"<":t=w+t+b+M;break;case"=":t=w+M+t+b;break;case"^":t=M.slice(0,_=M.length>>1)+w+t+b+M.slice(_);break;default:t=M+w+t+b}return s(t)}return d=null==d?p?6:12:/[gprs]/.test(p)?Math.max(1,Math.min(21,d)):Math.max(0,Math.min(20,d)),w.toString=function(){return t+""},w}return{format:c,formatPrefix:function(t,e){var n=c(((t=Wf(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Bf(e)/3))),i=Math.pow(10,-r),o=Zf[8+r/3];return function(t){return n(i*t)+o}}}};function td(t){return Xf=Kf(t),$f=Xf.format,Qf=Xf.formatPrefix,Xf}td({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var ed=function(t,e,n){var r,i,o,a,s=t[0],u=t[t.length-1],c=li(s,u,null==e?10:e);switch((n=Wf(null==n?",f":n)).type){case"s":var l=Math.max(Math.abs(s),Math.abs(u));return null!=n.precision||isNaN((a=c,r=Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Bf(l)/3)))-Bf(Math.abs(a)))))||(n.precision=r),Qf(n,l);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN((i=c,o=Math.max(Math.abs(s),Math.abs(u)),i=Math.abs(i),o=Math.abs(o)-i,r=Math.max(0,Bf(o)-Bf(i))+1))||(n.precision=r-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(r=Math.max(0,-Bf(Math.abs(c))))||(n.precision=r-2*("%"===n.type))}return $f(n)};function nd(t){var e=t.domain;return t.ticks=function(t){var n=e();return ui(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){return ed(e(),t,n)},t.nice=function(n){null==n&&(n=10);var r,i=e(),o=0,a=i.length-1,s=i[o],u=i[a];return u<s&&(r=s,s=u,u=r,r=o,o=a,a=r),(r=ci(s,u,n))>0?r=ci(s=Math.floor(s/r)*r,u=Math.ceil(u/r)*r,n):r<0&&(r=ci(s=Math.ceil(s*r)/r,u=Math.floor(u*r)/r,n)),r>0?(i[o]=Math.floor(s/r)*r,i[a]=Math.ceil(u/r)*r,e(i)):r<0&&(i[o]=Math.ceil(s*r)/r,i[a]=Math.floor(u*r)/r,e(i)),t},t}function rd(){var t=zf(If,sf);return t.copy=function(){return jf(t,rd())},nd(t)}var id=function(t,e){var n,r=0,i=(t=t.slice()).length-1,o=t[r],a=t[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),t[r]=e.floor(o),t[i]=e.ceil(a),t};function od(t,e){return(e=Math.log(e/t))?function(n){return Math.log(n/t)/e}:Lf(e)}function ad(t,e){return t<0?function(n){return-Math.pow(-e,n)*Math.pow(-t,1-n)}:function(n){return Math.pow(e,n)*Math.pow(t,1-n)}}function sd(t){return isFinite(t)?+("1e"+t):t<0?0:t}function ud(t){return 10===t?sd:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}function cd(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}function ld(t){return function(e){return-t(-e)}}function hd(t,e){return t<0?-Math.pow(-t,e):Math.pow(t,e)}function fd(){var t=1,e=zf(function(e,n){return(n=hd(n,t)-(e=hd(e,t)))?function(r){return(hd(r,t)-e)/n}:Lf(n)},function(e,n){return n=hd(n,t)-(e=hd(e,t)),function(r){return hd(e+n*r,1/t)}}),n=e.domain;return e.exponent=function(e){return arguments.length?(t=+e,n(n())):t},e.copy=function(){return jf(e,fd().exponent(t))},nd(e)}var dd=1e3,pd=60*dd,md=60*pd,gd=24*md,vd=7*gd,yd=30*gd,wd=365*gd;function bd(t){return new Date(t)}function xd(t){return t instanceof Date?+t:+new Date(+t)}function _d(t,e,n,r,i,o,a,s,u){var c=zf(If,sf),l=c.invert,h=c.domain,f=u(".%L"),d=u(":%S"),p=u("%I:%M"),m=u("%I %p"),g=u("%a %d"),v=u("%b %d"),y=u("%B"),w=u("%Y"),b=[[a,1,dd],[a,5,5*dd],[a,15,15*dd],[a,30,30*dd],[o,1,pd],[o,5,5*pd],[o,15,15*pd],[o,30,30*pd],[i,1,md],[i,3,3*md],[i,6,6*md],[i,12,12*md],[r,1,gd],[r,2,2*gd],[n,1,vd],[e,1,yd],[e,3,3*yd],[t,1,wd]];function x(s){return(a(s)<s?f:o(s)<s?d:i(s)<s?p:r(s)<s?m:e(s)<s?n(s)<s?g:v:t(s)<s?y:w)(s)}function _(e,n,r,i){if(null==e&&(e=10),"number"==typeof e){var o=Math.abs(r-n)/e,a=Zr(function(t){return t[2]}).right(b,o);a===b.length?(i=li(n/wd,r/wd,e),e=t):a?(i=(a=b[o/b[a-1][2]<b[a][2]/o?a-1:a])[1],e=a[0]):(i=Math.max(li(n,r,e),1),e=s)}return null==i?e:e.every(i)}return c.invert=function(t){return new Date(l(t))},c.domain=function(t){return arguments.length?h(Ul.call(t,xd)):h().map(bd)},c.ticks=function(t,e){var n,r=h(),i=r[0],o=r[r.length-1],a=o<i;return a&&(n=i,i=o,o=n),n=(n=_(t,i,o,e))?n.range(i,o+1):[],a?n.reverse():n},c.tickFormat=function(t,e){return null==e?x:u(e)},c.nice=function(t,e){var n=h();return(t=_(t,n[0],n[n.length-1],e))?h(id(n,t)):c},c.copy=function(){return jf(c,_d(t,e,n,r,i,o,a,s,u))},c}var Md=function(t){return t.match(/.{6}/g).map(function(t){return"#"+t})},Ed=Md("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Sd=Md("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),Td=Md("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),Ad=Md("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5");function kd(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}Rf(Vh(300,.5,0),Vh(-240,.5,1)),Rf(Vh(-100,.75,.35),Vh(80,1.5,.8)),Rf(Vh(260,.75,.35),Vh(80,1.5,.8)),Vh();var Cd=kd(Md("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),Rd=kd(Md("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Dd=kd(Md("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),Ld=kd(Md("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function Od(){var t,e,n=Hl().unknown(void 0),r=n.domain,i=n.range,o=[0,1],a=!1,s=0,u=0,c=.5;function l(){var n=r().length,l=o[1]<o[0],h=o[l-0],f=o[1-l],d=jl(n,s,u);t=(f-h)/(d||1),a&&(t=Math.floor(t)),h+=(f-h-t*(n-s))*c,e=t*(1-s),a&&(h=Math.round(h),e=Math.round(e));var p=ii(n).map(function(e){return h+t*e});return i(l?p.reverse():p)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),l()):r()},n.range=function(t){return arguments.length?(o=[+t[0],+t[1]],l()):o.slice()},n.rangeRound=function(t){return o=[+t[0],+t[1]],a=!0,l()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(a=!!t,l()):a},n.padding=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),s=u,l()):s},n.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),l()):s},n.paddingOuter=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),l()):u},n.align=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),l()):c},n.invertRange=function(t){if(null!=t[0]&&null!=t[1]){var n,a,s,u=+t[0],c=+t[1],l=o[1]<o[0],h=l?i().reverse():i(),f=h.length-1;if(u==u&&c==c&&(c<u&&(s=u,u=c,c=s),!(c<h[0]||u>o[1-l])))return n=Math.max(0,ti(h,u)-1),a=u===c?n:ti(h,c)-1,u-h[n]>e+1e-10&&++n,l&&(s=n,n=f-a,a=f-s),n>a?void 0:r().slice(n,a+1)}},n.invert=function(t){var e=n.invertRange([t,t]);return e?e[0]:e},n.copy=function(){return Od().domain(r()).range(o).round(a).paddingInner(s).paddingOuter(u).align(c)},l()}var Pd=Array.prototype.map,Id=Array.prototype.slice;function Nd(t){return Pd.call(t,function(t){return+t})}function Fd(t,e){return arguments.length>1?(jd[t]=(n=t,r=e,function(){var t=r();return t.invertRange||(t.invertRange=t.invert?Nl(t):t.invertExtent?Fl(t):void 0),t.type=n,t}),this):jd.hasOwnProperty(t)?jd[t]:void 0;var n,r}var jd={identity:function t(){var e=[0,1];function n(t){return+t}return n.invert=n,n.domain=n.range=function(t){return arguments.length?(e=Ul.call(t,Of),n):e.slice()},n.copy=function(){return t().domain(e)},nd(n)},linear:rd,log:function t(){var e=zf(od,ad).domain([1,10]),n=e.domain,r=10,i=cd(10),o=ud(10);function a(){return i=cd(r),o=ud(r),n()[0]<0&&(i=ld(i),o=ld(o)),e}return e.base=function(t){return arguments.length?(r=+t,a()):r},e.domain=function(t){return arguments.length?(n(t),a()):n()},e.ticks=function(t){var e,a=n(),s=a[0],u=a[a.length-1];(e=u<s)&&(f=s,s=u,u=f);var c,l,h,f=i(s),d=i(u),p=null==t?10:+t,m=[];if(!(r%1)&&d-f<p){if(f=Math.round(f)-1,d=Math.round(d)+1,s>0){for(;f<d;++f)for(l=1,c=o(f);l<r;++l)if(!((h=c*l)<s)){if(h>u)break;m.push(h)}}else for(;f<d;++f)for(l=r-1,c=o(f);l>=1;--l)if(!((h=c*l)<s)){if(h>u)break;m.push(h)}}else m=ui(f,d,Math.min(d-f,p)).map(o);return e?m.reverse():m},e.tickFormat=function(t,n){if(null==n&&(n=10===r?".0e":","),"function"!=typeof n&&(n=$f(n)),t===1/0)return n;null==t&&(t=10);var a=Math.max(1,r*t/e.ticks().length);return function(t){var e=t/o(Math.round(i(t)));return e*r<r-.5&&(e*=r),e<=a?n(t):""}},e.nice=function(){return n(id(n(),{floor:function(t){return o(Math.floor(i(t)))},ceil:function(t){return o(Math.ceil(i(t)))}}))},e.copy=function(){return jf(e,t().base(r))},e},ordinal:Hl,pow:fd,sqrt:function(){return fd().exponent(.5)},quantile:function t(){var e=[],n=[],r=[];function i(){var t=0,i=Math.max(1,n.length);for(r=new Array(i-1);++t<i;)r[t-1]=fi(e,t/i);return o}function o(t){if(!isNaN(t=+t))return n[ti(r,t)]}return o.invertExtent=function(t){var i=n.indexOf(t);return i<0?[NaN,NaN]:[i>0?r[i-1]:e[0],i<r.length?r[i]:e[e.length-1]]},o.domain=function(t){if(!arguments.length)return e.slice();e=[];for(var n,r=0,o=t.length;r<o;++r)null==(n=t[r])||isNaN(n=+n)||e.push(n);return e.sort(Jr),i()},o.range=function(t){return arguments.length?(n=Vl.call(t),i()):n.slice()},o.quantiles=function(){return r.slice()},o.copy=function(){return t().domain(e).range(n)},o},quantize:function t(){var e=0,n=1,r=1,i=[.5],o=[0,1];function a(t){if(t<=t)return o[ti(i,t,0,r)]}function s(){var t=-1;for(i=new Array(r);++t<r;)i[t]=((t+1)*n-(t-r)*e)/(r+1);return a}return a.domain=function(t){return arguments.length?(e=+t[0],n=+t[1],s()):[e,n]},a.range=function(t){return arguments.length?(r=(o=Vl.call(t)).length-1,s()):o.slice()},a.invertExtent=function(t){var a=o.indexOf(t);return a<0?[NaN,NaN]:a<1?[e,i[0]]:a>=r?[i[r-1],n]:[i[a-1],i[a]]},a.copy=function(){return t().domain([e,n]).range(o)},nd(a)},threshold:function t(){var e=[.5],n=[0,1],r=1;function i(t){if(t<=t)return n[ti(e,t,0,r)]}return i.domain=function(t){return arguments.length?(e=Vl.call(t),r=Math.min(e.length,n.length-1),i):e.slice()},i.range=function(t){return arguments.length?(n=Vl.call(t),r=Math.min(e.length,n.length-1),i):n.slice()},i.invertExtent=function(t){var r=n.indexOf(t);return[e[r-1],e[r]]},i.copy=function(){return t().domain(e).range(n)},i},time:function(){return _d(Ue,ze,Ne,Pe,Oe,Le,De,Ae,tn).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},utc:function(){return _d($e,Xe,Ge,He,Be,Ve,De,Ae,nn).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])},band:Od,point:function(){return function t(e){var n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return t(n())},e}(Od().paddingInner(1))},sequential:function t(e){var n=rd(),r=0,i=1,o=!1;function a(){var t=n.domain();r=t[0],i=x(t)-r}function s(t){var n=(t-r)/i;return e(o?Math.max(0,Math.min(1,n)):n)}return s.clamp=function(t){return arguments.length?(o=!!t,s):o},s.domain=function(t){return arguments.length?(n.domain(t),a(),s):n.domain()},s.interpolator=function(t){return arguments.length?(e=t,s):e},s.copy=function(){return t().domain(n.domain()).clamp(o).interpolator(e)},s.ticks=function(t){return n.ticks(t)},s.tickFormat=function(t,e){return n.tickFormat(t,e)},s.nice=function(t){return n.nice(t),a(),s},s},"bin-linear":function t(){var e=rd(),n=[];function r(t){return e(t)}return r.domain=function(t){return arguments.length?(n=Nd(t),e.domain([n[0],x(n)]),r):n.slice()},r.range=function(t){return arguments.length?(e.range(t),r):e.range()},r.rangeRound=function(t){return arguments.length?(e.rangeRound(t),r):e.rangeRound()},r.interpolate=function(t){return arguments.length?(e.interpolate(t),r):e.interpolate()},r.invert=function(t){return e.invert(t)},r.ticks=function(t){var e=n.length,i=~~(e/(t||e));return i<2?r.domain():n.filter(function(t,e){return!(e%i)})},r.tickFormat=function(){return e.tickFormat.apply(e,arguments)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r},"bin-ordinal":function t(){var e=[],n=[];function r(t){return null==t||t!=t?void 0:n[(ti(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=Nd(t),r):e.slice()},r.range=function(t){return arguments.length?(n=Id.call(t),r):n.slice()},r.copy=function(){return t().domain(r.domain()).range(r.range())},r}};for(var zd in jd)Fd(zd,jd[zd]);function Ud(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}var Vd=Ud("4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac"),Bd=Ud("4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"),Hd=new Array(3).concat("67a9cff7f7f7f1a340","0571b092c5defdb863e66101","0571b092c5def7f7f7fdb863e66101","2166ac67a9cfd1e5f0fee0b6f1a340b35806","2166ac67a9cfd1e5f0f7f7f7fee0b6f1a340b35806","2166ac4393c392c5ded1e5f0fee0b6fdb863e08214b35806","2166ac4393c392c5ded1e5f0f7f7f7fee0b6fdb863e08214b35806","0530612166ac4393c392c5ded1e5f0fee0b6fdb863e08214b358067f3b08","0530612166ac4393c392c5ded1e5f0f7f7f7fee0b6fdb863e08214b358067f3b08").map(Ud),qd=function(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n},Gd=qd("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),Wd=qd("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Yd=qd("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),Xd=qd("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),$d=qd("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),Qd=qd("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),Jd=qd("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),Zd=qd("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),Kd=function(t){return nf(t[t.length-1])},tp=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(qd),ep=Kd(tp),np=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(qd),rp=Kd(np),ip=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(qd),op=Kd(ip),ap=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(qd),sp=Kd(ap),up=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(qd),cp=Kd(up),lp=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(qd),hp=Kd(lp),fp=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(qd),dp=Kd(fp),pp=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(qd),mp=Kd(pp),gp=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(qd),vp=Kd(gp),yp=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(qd),wp=Kd(yp),bp=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(qd),xp=Kd(bp),_p=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(qd),Mp=Kd(_p),Ep=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(qd),Sp=Kd(Ep),Tp=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(qd),Ap=Kd(Tp),kp=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(qd),Cp=Kd(kp),Rp=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(qd),Dp=Kd(Rp),Lp=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(qd),Op=Kd(Lp),Pp=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(qd),Ip=Kd(Pp),Np=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(qd),Fp=Kd(Np),jp=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(qd),zp=Kd(jp),Up=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(qd),Vp=Kd(Up),Bp=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(qd),Hp=Kd(Bp),qp=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(qd),Gp=Kd(qp),Wp=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(qd),Yp=Kd(Wp),Xp=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(qd),$p=Kd(Xp),Qp=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(qd),Jp=Kd(Qp),Zp=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(qd),Kp=Kd(Zp),tm=Object.freeze({schemeAccent:Gd,schemeDark2:Wd,schemePaired:Yd,schemePastel1:Xd,schemePastel2:$d,schemeSet1:Qd,schemeSet2:Jd,schemeSet3:Zd,interpolateBrBG:ep,schemeBrBG:tp,interpolatePRGn:rp,schemePRGn:np,interpolatePiYG:op,schemePiYG:ip,interpolatePuOr:sp,schemePuOr:ap,interpolateRdBu:cp,schemeRdBu:up,interpolateRdGy:hp,schemeRdGy:lp,interpolateRdYlBu:dp,schemeRdYlBu:fp,interpolateRdYlGn:mp,schemeRdYlGn:pp,interpolateSpectral:vp,schemeSpectral:gp,interpolateBuGn:wp,schemeBuGn:yp,interpolateBuPu:xp,schemeBuPu:bp,interpolateGnBu:Mp,schemeGnBu:_p,interpolateOrRd:Sp,schemeOrRd:Ep,interpolatePuBuGn:Ap,schemePuBuGn:Tp,interpolatePuBu:Cp,schemePuBu:kp,interpolatePuRd:Dp,schemePuRd:Rp,interpolateRdPu:Op,schemeRdPu:Lp,interpolateYlGnBu:Ip,schemeYlGnBu:Pp,interpolateYlGn:Fp,schemeYlGn:Np,interpolateYlOrBr:zp,schemeYlOrBr:jp,interpolateYlOrRd:Vp,schemeYlOrRd:Up,interpolateBlues:Hp,schemeBlues:Bp,interpolateGreens:Gp,schemeGreens:qp,interpolateGreys:Yp,schemeGreys:Wp,interpolatePurples:$p,schemePurples:Xp,interpolateReds:Jp,schemeReds:Qp,interpolateOranges:Kp,schemeOranges:Zp}),em={blueorange:Hd},nm={category10:Ed,category20:Ad,category20b:Sd,category20c:Td,accent:Gd,dark2:Wd,paired:Yd,pastel1:Xd,pastel2:$d,set1:Qd,set2:Jd,set3:Zd,tableau10:Vd,tableau20:Bd,viridis:Cd,magma:Rd,inferno:Dd,plasma:Ld,blueorange:nf(x(Hd))};function rm(t,e){nm[t]=tm["interpolate"+e],em[t]=tm["scheme"+e]}rm("blues","Blues"),rm("greens","Greens"),rm("greys","Greys"),rm("purples","Purples"),rm("reds","Reds"),rm("oranges","Oranges"),rm("brownbluegreen","BrBG"),rm("purplegreen","PRGn"),rm("pinkyellowgreen","PiYG"),rm("purpleorange","PuOr"),rm("redblue","RdBu"),rm("redgrey","RdGy"),rm("redyellowblue","RdYlBu"),rm("redyellowgreen","RdYlGn"),rm("spectral","Spectral"),rm("bluegreen","BuGn"),rm("bluepurple","BuPu"),rm("greenblue","GnBu"),rm("orangered","OrRd"),rm("purplebluegreen","PuBuGn"),rm("purpleblue","PuBu"),rm("purplered","PuRd"),rm("redpurple","RdPu"),rm("yellowgreenblue","YlGnBu"),rm("yellowgreen","YlGn"),rm("yelloworangebrown","YlOrBr"),rm("yelloworangered","YlOrRd");var im=function(t,e){if(arguments.length>1)return nm[t]=e,this;var n=t.split("-");return t=n[0],(n=+n[1]+1)&&em.hasOwnProperty(t)?em[t][n-1]:!n&&nm.hasOwnProperty(t)?nm[t]:void 0};function om(t,e){var n=e[0],r=x(e)-n;return function(e){return t(n+e*r)}}function am(t,e,n){var r=n-e;return r?"linear"===t.type||"sequential"===t.type?function(t){return(t-e)/r}:t.copy().domain([e,n]).range([0,1]).interpolate(sm):F(0)}function sm(t,e){var n=e-t;return function(e){return t+e*n}}function um(t,e){var n,r=Df[(n=t,"interpolate"+n.toLowerCase().split("-").map(function(t){return t[0].toUpperCase()+t.slice(1)}).join(""))];return null!=e&&r&&r.gamma?r.gamma(e):r}var cm={millisecond:Ae,second:De,minute:Le,hour:Oe,day:Pe,week:Ne,month:ze,year:Ue},lm={millisecond:Ae,second:De,minute:Ve,hour:Be,day:He,week:Ge,month:Xe,year:$e};function hm(t){return cm.hasOwnProperty(t)&&cm[t]}function fm(t){return lm.hasOwnProperty(t)&&lm[t]}function dm(t,e){var n;return s(e)&&(n=e.step,e=e.interval),u(e)&&(e="time"===t.type?hm(e):"utc"===t.type?fm(e):i("Only time and utc scales accept interval strings."),n&&(e=e.every(n))),e}function pm(t,e,n){var r=t.range(),i=r[0],o=x(r);if(i>o&&(r=o,o=i,i=r),e=e.filter(function(e){return!((e=t(e))<i||e>o)}),n>0&&e.length>1){for(var a=[e[0],x(e)];e.length>n&&e.length>=3;)e=e.filter(function(t,e){return!(e%2)});e.length<3&&(e=a)}return e}function mm(t,e){return t.ticks?t.ticks(e):t.domain()}function gm(t,e,n){var r,i,o=t.tickFormat?t.tickFormat(e,n):String;return t.type===kl?(r=o,i=function(t){var e,n,r=Wf(t||",");if(null==r.precision){switch(r.precision=12,r.type){case"%":r.precision-=2;break;case"e":r.precision-=1}return e=$f(r),n=$f(".1f")(1)[1],function(t){var r,i,o=e(t),a=o.indexOf(n);if(a<0)return o;for(i=(r=function(t,e){var n,r=t.lastIndexOf("e");if(r>0)return r;for(r=t.length;--r>e;)if((n=t.charCodeAt(r))>=48&&n<=57)return r+1}(o,a))<o.length?o.slice(r):"";--r>a;)if("0"!==o[r]){++r;break}return o.slice(0,r)+i}}return $f(r)}(n),function(t){return r(t)?i(t):""}):o}function vm(t){Ir.call(this,null,t)}function ym(t){Ir.call(this,null,t)}function wm(){return ht({})}function bm(t){return t.exit}function xm(t){Ir.call(this,null,t)}H(vm,Ir).transform=function(t,e){if(this.value&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=this.value,i=t.scale,o=null==t.count?t.values?t.values.length:10:dm(i,t.count),a=t.format||gm(i,o,t.formatSpecifier),s=t.values?pm(i,t.values,o):mm(i,o);return r&&(n.rem=r),r=s.map(function(t,e){return ht({index:e/(s.length-1),value:t,label:a(t)})}),t.extra&&r.push(ht({index:-1,extra:{value:r[0].value},label:""})),n.source=r,n.add=r,this.value=r,n},H(ym,Ir).transform=function(t,e){var n=e.dataflow,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),o=t.item||wm,s=t.key||ct,u=this.value;return a(r.encode)&&(r.encode=null),u&&(t.modified("key")||e.modified(s))&&i("DataJoin does not support modified key function or fields."),u||(e=e.addAll(),this.value=u=B().test(bm),u.lookup=function(t){return u.get(s(t))}),e.visit(e.ADD,function(t){var e=s(t),n=u.get(e);n?n.exit?(u.empty--,r.add.push(n)):r.mod.push(n):(u.set(e,n=o(t)),r.add.push(n)),n.datum=t,n.exit=!1}),e.visit(e.MOD,function(t){var e=s(t),n=u.get(e);n&&(n.datum=t,r.mod.push(n))}),e.visit(e.REM,function(t){var e=s(t),n=u.get(e);t!==n.datum||n.exit||(r.rem.push(n),n.exit=!0,++u.empty)}),e.changed(e.ADD_MOD)&&r.modifies("datum"),t.clean&&u.empty>n.cleanThreshold&&n.runAfter(u.clean),r},H(xm,Ir).transform=function(t,e){var n=e.fork(e.ADD_REM),r=t.encoders,i=e.encode;if(a(i)){if(!n.changed()&&!i.every(function(t){return r[t]}))return e.StopPropagation;i=i[0]}var o="enter"===i,s=r.update||v,u=r.enter||v,c=r.exit||v,l=(i&&!o?r[i]:s)||v;if(e.changed(e.ADD)&&(e.visit(e.ADD,function(e){u(e,t),s(e,t),l!==v&&l!==s&&l(e,t)}),n.modifies(u.output),n.modifies(s.output),l!==v&&l!==s&&n.modifies(l.output)),e.changed(e.REM)&&c!==v&&(e.visit(e.REM,function(e){c(e,t)}),n.modifies(c.output)),o||l!==v){var h=e.MOD|(t.modified()?e.REFLOW:0);o?(e.visit(h,function(e){var r=u(e,t);(l(e,t)||r)&&n.mod.push(e)}),n.mod.length&&n.modifies(u.output)):e.visit(h,function(e){l(e,t)&&n.mod.push(e)}),n.mod.length&&n.modifies(l.output)}return n.changed()?n:e.StopPropagation};var _m={};function Mm(t){var e=t.domain();return e.max=e.pop(),e}function Em(t,e){return isFinite(t)?e(t):null}function Sm(t){Ir.call(this,[],t)}_m[Dl]=function(t){var e=[-1/0].concat(t.quantiles());return e.max=1/0,e},_m[Ll]=function(t){var e=t.domain(),n=e[0],r=x(e),i=t.range().length,o=new Array(i),a=0;for(o[0]=-1/0;++a<i;)o[a]=(a*r-(a-i)*n)/i;return o.max=1/0,o},_m[Ol]=function(t){var e=[-1/0].concat(t.domain());return e.max=1/0,e},_m["bin-linear"]=Mm,_m[Pl]=Mm,H(Sm,Ir).transform=function(t,e){if(null!=this.value&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=0,i=this.value,o="gradient"===t.type,a=t.scale,s=null==t.count?5:dm(a,t.count),u=t.format||gm(a,s,t.formatSpecifier),c=t.values||function(t,e,n){if(o)return t.domain();var r=_m[t.type];return r?r(t):mm(t,e)}(a,s);if(u=function(t,e){return _m[a.type]?(r=u,function(t,e,n){var i=n[e+1]||n.max||1/0,o=Em(t,r),a=Em(i,r);return o&&a?o+"\u2013"+a:a?"< "+a:"\u2265 "+o}):(n=u,function(t){return n(t)});var n,r}(),i&&(n.rem=i),o)var l=t.values?a.domain():c,h=am(a,l[0],x(l));else{var f,d=t.size;I(d)?(t.values||0!==a(c[0])||(c=c.slice(1)),f=c.reduce(function(e,n){return Math.max(e,d(n,t))},0)):d=F(f=d||8)}return i=c.map(function(e,n){var i=ht({index:n,label:u(e,n,c),value:e});return o?i.perc=h(e):(i.offset=f,i.size=d(e,t),i.total=Math.round(r),r+=i.size),i}),n.source=i,n.add=i,this.value=i,n};var Tm=B({line:Lm,"line-radial":function(t,e,n,r){return Lm(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n))},arc:Om,"arc-radial":function(t,e,n,r){return Om(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n))},curve:Pm,"curve-radial":function(t,e,n,r){return Pm(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n))},"orthogonal-horizontal":function(t,e,n,r){return"M"+t+","+e+"V"+r+"H"+n},"orthogonal-vertical":function(t,e,n,r){return"M"+t+","+e+"H"+n+"V"+r},"orthogonal-radial":function(t,e,n,r){var i=Math.cos(t),o=Math.sin(t),a=Math.cos(n),s=Math.sin(n);return"M"+e*i+","+e*o+"A"+e+","+e+" 0 0,"+((Math.abs(n-t)>Math.PI?n<=t:n>t)?1:0)+" "+e*a+","+e*s+"L"+r*a+","+r*s},"diagonal-horizontal":function(t,e,n,r){var i=(t+n)/2;return"M"+t+","+e+"C"+i+","+e+" "+i+","+r+" "+n+","+r},"diagonal-vertical":function(t,e,n,r){var i=(e+r)/2;return"M"+t+","+e+"C"+t+","+i+" "+n+","+i+" "+n+","+r},"diagonal-radial":function(t,e,n,r){var i=Math.cos(t),o=Math.sin(t),a=Math.cos(n),s=Math.sin(n),u=(e+r)/2;return"M"+e*i+","+e*o+"C"+u*i+","+u*o+" "+u*a+","+u*s+" "+r*a+","+r*s}});function Am(t){return t.source.x}function km(t){return t.source.y}function Cm(t){return t.target.x}function Rm(t){return t.target.y}function Dm(t){Ir.call(this,{},t)}function Lm(t,e,n,r){return"M"+t+","+e+"L"+n+","+r}function Om(t,e,n,r){var i=n-t,o=r-e,a=Math.sqrt(i*i+o*o)/2;return"M"+t+","+e+"A"+a+","+a+" "+180*Math.atan2(o,i)/Math.PI+" 0 1 "+n+","+r}function Pm(t,e,n,r){var i=n-t,o=r-e,a=.2*(i+o),s=.2*(o-i);return"M"+t+","+e+"C"+(t+a)+","+(e+s)+" "+(n+s)+","+(r-a)+" "+n+","+r}function Im(t){Ir.call(this,null,t)}Dm.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"as",type:"string",default:"path"}]},H(Dm,Ir).transform=function(t,e){var n=t.sourceX||Am,r=t.sourceY||km,o=t.targetX||Cm,a=t.targetY||Rm,s=t.as||"path",u=t.shape||"line",c=Tm.get(u+"-"+(t.orient||"vertical"))||Tm.get(u);return c||i("LinkPath unsupported type: "+t.shape+(t.orient?"-"+t.orient:"")),e.visit(e.SOURCE,function(t){t[s]=c(n(t),r(t),o(t),a(t))}),e.reflow(t.modified()).modifies(s)},Im.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},H(Im,Ir).transform=function(t,e){var n,r,i,o=t.as||["startAngle","endAngle"],a=o[0],s=o[1],u=t.startAngle||0,c=null!=t.endAngle?t.endAngle:2*Math.PI,l=e.source,h=l.map(t.field||m),f=h.length,d=u,p=(c-u)/function(t,e){for(var n,r=t.length,i=-1,o=0;++i<r;)(n=+t[i])&&(o+=n);return o}(h),g=ii(f);for(t.sort&&g.sort(function(t,e){return h[t]-h[e]}),n=0;n<f;++n)i=h[g[n]],(r=l[g[n]])[a]=d,r[s]=d+=i*p;return this.value=h,e.reflow(t.modified()).modifies(o)};var Nm=nt([Rl,"pow",Cl]),Fm=nt([Rl,kl,"pow",Cl,"time","utc"]),jm=nt(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","nice","zero","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function zm(t){Ir.call(this,null,t),this.modified(!0)}function Um(t,e,n){return I(t)&&(e||n)?om(t,Vm(e||[0,1],n)):t}function Vm(t,e){return e?t.slice().reverse():t}function Bm(t){Ir.call(this,null,t)}function Hm(t){Ir.call(this,null,t)}function qm(t,e,n,r,i){for(var o,a=(e-t.sum)/2,s=t.length,u=0;u<s;++u)(o=t[u])[r]=a,o[i]=a+=Math.abs(n(o))}function Gm(t,e,n,r,i){for(var o,a=1/t.sum,s=0,u=t.length,c=0,l=0;c<u;++c)(o=t[c])[r]=s,o[i]=s=a*(l+=Math.abs(n(o)))}function Wm(t,e,n,r,i){for(var o,a,s=0,u=0,c=t.length,l=0;l<c;++l)(o=n(a=t[l]))<0?(a[r]=u,a[i]=u+=o):(a[r]=s,a[i]=s+=o)}H(zm,Ir).transform=function(t,e){var n,r=e.dataflow,o=this.value;for(n in o&&!t.modified("type")||(this.value=o=Fd((t.type||Rl).toLowerCase())()),t)if(!jm[n]){if("padding"===n&&Fm[o.type])continue;I(o[n])?o[n](t[n]):r.warn("Unsupported scale property: "+n)}return function(t,e,n){var r=e.round||!1,o=e.range;if(null!=e.rangeStep)o=function(t,e,n){return"band"!==t&&"point"!==t&&i("Only band and point scales support rangeStep."),[0,e.rangeStep*jl(n,"point"===t?1:(null!=e.paddingInner?e.paddingInner:e.padding)||0,(null!=e.paddingOuter?e.paddingOuter:e.padding)||0)]}(t.type,e,n);else if(e.scheme){if(o=function(t,e,n){var r,o=e.scheme.toLowerCase(),a=im(o),s=e.schemeExtent;return a||i("Unrecognized scheme name: "+e.scheme),n=t===Ol?n+1:t===Pl?n-1:t===Dl||t===Ll?+e.schemeCount||5:n,t===Il?Um(a,s,e.reverse):!s&&(r=im(o+"-"+n))?r:I(a)?function(t,e){for(var n=new Array(e),r=e-1||1,i=0;i<e;++i)n[i]=t(i/r);return n}(Um(a,s),n):"ordinal"===t?a:a.slice(0,n)}(t.type,e,n),I(o))return t.interpolator(o)}else if(o&&t.type===Il)return t.interpolator(nf(Vm(o,e.reverse)));o&&e.interpolate&&t.interpolate?t.interpolate(um(e.interpolate,e.interpolateGamma)):I(t.round)?t.round(r):I(t.rangeRound)&&t.interpolate(r?df:ff),o&&t.range(Vm(o,e.reverse))}(o,t,function(t,e,n){var r,i=(r=e.domainRaw)?(t.domain(r),r.length):-1;if(i>-1)return i;var o,a,s,u,c,l,h,f,d,p,m=e.domain,g=t.type,v=e.zero||void 0===e.zero&&Nm[g];return m?(Fm[g]&&e.padding&&m[0]!==x(m)&&(s=g,u=m,c=e.range,l=e.padding,h=e.exponent,d=(f=Math.abs(x(c)-c[0]))/(f-2*l),p=s===kl?L(u,null,d):s===Cl?O(u,null,d,.5):"pow"===s?O(u,null,d,h):D(u,null,d),(u=u.slice())[0]=p[0],u[u.length-1]=p[1],m=u),(v||null!=e.domainMin||null!=e.domainMax||null!=e.domainMid)&&(o=(m=m.slice()).length-1||1,v&&(m[0]>0&&(m[0]=0),m[o]<0&&(m[o]=0)),null!=e.domainMin&&(m[0]=e.domainMin),null!=e.domainMax&&(m[o]=e.domainMax),null!=e.domainMid&&(((a=e.domainMid)<m[0]||a>m[o])&&n.warn("Scale domainMid exceeds domain min or max.",a),m.splice(o,0,a))),t.domain(m),e.nice&&t.nice&&t.nice(!0!==e.nice&&dm(t,e.nice)||null),m.length):0}(o,t,r)),e.fork(e.NO_SOURCE|e.NO_FIELDS)},H(Bm,Ir).transform=function(t,e){var n=t.modified("sort")||e.changed(e.ADD)||e.modified(t.sort.fields)||e.modified("datum");return n&&e.source.sort(t.sort),this.modified(n),e},Hm.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:"zero",values:["zero","center","normalize"]},{name:"as",type:"string",array:!0,length:2,default:["y0","y1"]}]},H(Hm,Ir).transform=function(t,e){var n,r,i,o,a=t.as||["y0","y1"],s=a[0],u=a[1],c=t.field||m,l="center"===t.offset?qm:"normalize"===t.offset?Gm:Wm;for(r=0,i=(n=function(t,e,n,r){var i,o,a,s,u,c,l,h,f,d=[],p=function(t){return t(u)};if(null==e)d.push(t.slice());else for(i={},o=0,a=t.length;o<a;++o)u=t[o],(l=i[c=e.map(p)])||(i[c]=l=[],d.push(l)),l.push(u);for(c=0,f=0,s=d.length;c<s;++c){for(o=0,h=0,a=(l=d[c]).length;o<a;++o)h+=Math.abs(r(l[o]));l.sum=h,h>f&&(f=h),n&&l.sort(n)}return d.max=f,d}(e.source,t.groupby,t.sort,c)).length,o=n.max;r<i;++r)l(n[r],o,c,s,u);return e.reflow(t.modified()).modifies(a)};var Ym=Object.freeze({axisticks:vm,datajoin:ym,encode:xm,legendentries:Sm,linkpath:Dm,pie:Im,scale:zm,sortitems:Bm,stack:Hm,validTicks:pm}),Xm=Array.prototype.slice,$m=function(t,e){return t-e},Qm=function(t){for(var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r},Jm=function(t){return function(){return t}},Zm=function(t,e){for(var n,r=-1,i=e.length;++r<i;)if(n=Km(t,e[r]))return n;return 0};function Km(t,e){for(var n,r,i,o,a,s,u,c,l,h,f=e[0],d=e[1],p=-1,m=0,g=t.length,v=g-1;m<g;v=m++){var y=t[m],w=y[0],b=y[1],x=t[v],_=x[0],M=x[1];if(h=void 0,o=u=y,s=l=e,((a=c=x)[0]-o[0])*(s[1]-o[1])==(s[0]-o[0])*(a[1]-o[1])&&(n=u[h=+(u[0]===c[0])],i=c[h],n<=(r=l[h])&&r<=i||i<=r&&r<=n))return 0;b>d!=M>d&&f<(_-w)*(d-b)/(M-b)+w&&(p=-p)}return p}var tg=function(){},eg=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]],ng=function(){var t=1,e=1,n=hi,r=a;function i(i){var a=n(i);if(Array.isArray(a))a=a.slice().sort($m);else{var s=ri(i),u=s[0],c=s[1];a=li(u,c,a),a=ii(Math.floor(u/a)*a,Math.floor(c/a)*a,a)}return a.map(function(n){var a=[],s=[];return function(n,r,i){var a,s,u,c,l,h=new Array,f=new Array;for(a=s=-1,eg[(u=n[0]>=r)<<1].forEach(d);++a<t-1;)eg[u|(u=n[a+1]>=r)<<1].forEach(d);for(eg[u<<0].forEach(d);++s<e-1;){for(a=-1,eg[(u=n[s*t+t]>=r)<<1|(c=n[s*t]>=r)<<2].forEach(d);++a<t-1;)l=c,eg[u|(u=n[s*t+t+a+1]>=r)<<1|(c=n[s*t+a+1]>=r)<<2|l<<3].forEach(d);eg[u|c<<3].forEach(d)}for(a=-1,eg[(c=n[s*t]>=r)<<2].forEach(d);++a<t-1;)l=c,eg[(c=n[s*t+a+1]>=r)<<2|l<<3].forEach(d);function d(t){var e,n,r=[t[0][0]+a,t[0][1]+s],u=[t[1][0]+a,t[1][1]+s],c=o(r),l=o(u);(e=f[c])?(n=h[l])?(delete f[e.end],delete h[n.start],e===n?(e.ring.push(u),i(e.ring)):h[e.start]=f[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete f[e.end],e.ring.push(u),f[e.end=l]=e):(e=h[l])?(n=f[c])?(delete h[e.start],delete f[n.end],e===n?(e.ring.push(u),i(e.ring)):h[n.start]=f[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete h[e.start],e.ring.unshift(r),h[e.start=c]=e):h[c]=f[l]={start:c,end:l,ring:[r,u]}}eg[c<<3].forEach(d)}(i,n,function(t){r(t,i,n),Qm(t)>0?a.push([t]):s.push(t)}),s.forEach(function(t){for(var e,n=0,r=a.length;n<r;++n)if(-1!==Zm((e=a[n])[0],t))return void e.push(t)}),a}).map(function(t,e){return{type:"MultiPolygon",value:a[e],coordinates:t}})}function o(e){return 2*e[0]+e[1]*(t+1)*4}function a(n,r,i){n.forEach(function(n){var o,a=n[0],s=n[1],u=0|a,c=0|s,l=r[c*t+u];a>0&&a<t&&u===a&&(n[0]=a+(i-(o=r[c*t+u-1]))/(l-o)-.5),s>0&&s<e&&c===s&&(n[1]=s+(i-(o=r[(c-1)*t+u]))/(l-o)-.5)})}return i.size=function(n){if(!arguments.length)return[t,e];var r=Math.ceil(n[0]),o=Math.ceil(n[1]);if(!(r>0&&o>0))throw new Error("invalid size");return t=r,e=o,i},i.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?Jm(Xm.call(t)):Jm(t),i):n},i.smooth=function(t){return arguments.length?(r=t?a:tg,i):r===a},i};function rg(t,e,n){for(var r=t.width,i=t.height,o=1+(n<<1),a=0;a<i;++a)for(var s=0,u=0;s<r+n;++s)s<r&&(u+=t.data[s+a*r]),s>=n&&(s>=o&&(u-=t.data[s-o+a*r]),e.data[s-n+a*r]=u/Math.min(s+1,r-1+o-s,o))}function ig(t,e,n){for(var r=t.width,i=t.height,o=1+(n<<1),a=0;a<r;++a)for(var s=0,u=0;s<i+n;++s)s<i&&(u+=t.data[a+s*r]),s>=n&&(s>=o&&(u-=t.data[a+(s-o)*r]),e.data[a+(s-n)*r]=u/Math.min(s+1,i-1+o-s,o))}function og(t){return t[0]}function ag(t){return t[1]}var sg=["values","size"],ug=["x","y","size","cellSize","bandwidth"];function cg(t){Ir.call(this,null,t)}cg.Definition={type:"Contour",metadata:{generates:!0,source:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"number",default:!1},{name:"thresholds",type:"number",array:!0}]},H(cg,Ir).transform=function(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r,i,o,a=e.fork(e.NO_SOURCE|e.NO_FIELDS),s=t.count||10;return t.values?(n=ng(),r=sg,i=t.values):(n=function(){var t=og,e=ag,n=960,r=500,i=20,o=2,a=3*i,s=n+2*a>>o,u=r+2*a>>o,c=Jm(20);function l(n){var r=new Float32Array(s*u),l=new Float32Array(s*u);n.forEach(function(n,i,c){var l=t(n,i,c)+a>>o,h=e(n,i,c)+a>>o;l>=0&&l<s&&h>=0&&h<u&&++r[l+h*s]}),rg({width:s,height:u,data:r},{width:s,height:u,data:l},i>>o),ig({width:s,height:u,data:l},{width:s,height:u,data:r},i>>o),rg({width:s,height:u,data:r},{width:s,height:u,data:l},i>>o),ig({width:s,height:u,data:l},{width:s,height:u,data:r},i>>o),rg({width:s,height:u,data:r},{width:s,height:u,data:l},i>>o),ig({width:s,height:u,data:l},{width:s,height:u,data:r},i>>o);var f=c(r);if(!Array.isArray(f)){var d=di(r);f=li(0,d,f),(f=ii(0,Math.floor(d/f)*f,f)).shift()}return ng().thresholds(f).size([s,u])(r).map(h)}function h(t){return t.value*=Math.pow(2,-2*o),t.coordinates.forEach(f),t}function f(t){t.forEach(d)}function d(t){t.forEach(p)}function p(t){t[0]=t[0]*Math.pow(2,o)-a,t[1]=t[1]*Math.pow(2,o)-a}function m(){return s=n+2*(a=3*i)>>o,u=r+2*a>>o,l}return l.x=function(e){return arguments.length?(t="function"==typeof e?e:Jm(+e),l):t},l.y=function(t){return arguments.length?(e="function"==typeof t?t:Jm(+t),l):e},l.size=function(t){if(!arguments.length)return[n,r];var e=Math.ceil(t[0]),i=Math.ceil(t[1]);if(!(e>=0||e>=0))throw new Error("invalid size");return n=e,r=i,m()},l.cellSize=function(t){if(!arguments.length)return 1<<o;if(!((t=+t)>=1))throw new Error("invalid cell size");return o=Math.floor(Math.log(t)/Math.LN2),m()},l.thresholds=function(t){return arguments.length?(c="function"==typeof t?t:Array.isArray(t)?Jm(Xm.call(t)):Jm(t),l):c},l.bandwidth=function(t){if(!arguments.length)return Math.sqrt(i*(i+1));if(!((t=+t)>=0))throw new Error("invalid bandwidth");return i=Math.round((Math.sqrt(4*t*t+1)-1)/2),m()},l}(),r=ug,i=e.materialize(e.SOURCE).source),n.thresholds(t.thresholds||(t.nice?s:(o=s,function(t){for(var e=ri(t),n=e[0],r=e[1]-n,i=[],a=1;a<=o;++a)i.push(n+r*a/(o+1));return i}))),r.forEach(function(e){null!=t[e]&&n[e](t[e])}),this.value&&(a.rem=this.value),this.value=a.source=a.add=n(i).map(ht),a};var lg="FeatureCollection";function hg(t){Ir.call(this,null,t)}hg.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},H(hg,Ir).transform=function(t,e){var n,i=this._features,o=this._points,a=t.fields,s=a&&a[0],u=a&&a[1],c=t.geojson,l=e.ADD;n=t.modified()||e.changed(e.REM)||e.modified(r(c))||s&&e.modified(r(s))||u&&e.modified(r(u)),this.value&&!n||(l=e.SOURCE,this._features=i=[],this._points=o=[]),c&&e.visit(l,function(t){i.push(c(t))}),s&&u&&(e.visit(l,function(t){var e=s(t),n=u(t);null!=e&&null!=n&&(e=+e)===e&&(n=+n)===n&&o.push([e,n])}),i=i.concat({type:"Feature",geometry:{type:"MultiPoint",coordinates:o}})),this.value={type:lg,features:i}};var fg=function(){return new dg};function dg(){this.reset()}dg.prototype={constructor:dg,reset:function(){this.s=this.t=0},add:function(t){mg(pg,t,this.t),mg(this,pg.s,this.s),this.s?this.t+=pg.t:this.s=pg.t},valueOf:function(){return this.s}};var pg=new dg;function mg(t,e,n){var r=t.s=e+n,i=r-e;t.t=e-(r-i)+(n-i)}var gg=1e-6,vg=Math.PI,yg=vg/2,wg=vg/4,bg=2*vg,xg=180/vg,_g=vg/180,Mg=Math.abs,Eg=Math.atan,Sg=Math.atan2,Tg=Math.cos,Ag=Math.ceil,kg=Math.exp,Cg=Math.log,Rg=Math.pow,Dg=Math.sin,Lg=Math.sign||function(t){return t>0?1:t<0?-1:0},Og=Math.sqrt,Pg=Math.tan;function Ig(t){return t>1?0:t<-1?vg:Math.acos(t)}function Ng(t){return t>1?yg:t<-1?-yg:Math.asin(t)}function Fg(){}function jg(t,e){t&&Ug.hasOwnProperty(t.type)&&Ug[t.type](t,e)}var zg={Feature:function(t,e){jg(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)jg(n[r].geometry,e)}},Ug={Sphere:function(t,e){e.sphere()},Point:function(t,e){e.point((t=t.coordinates)[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)e.point((t=n[r])[0],t[1],t[2])},LineString:function(t,e){Vg(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)Vg(n[r],e,0)},Polygon:function(t,e){Bg(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)Bg(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)jg(n[r],e)}};function Vg(t,e,n){var r,i=-1,o=t.length-n;for(e.lineStart();++i<o;)e.point((r=t[i])[0],r[1],r[2]);e.lineEnd()}function Bg(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)Vg(t[n],e,1);e.polygonEnd()}var Hg=function(t,e){t&&zg.hasOwnProperty(t.type)?zg[t.type](t,e):jg(t,e)};function qg(t){return[Sg(t[1],t[0]),Ng(t[2])]}function Gg(t){var e=t[0],n=t[1],r=Tg(n);return[r*Tg(e),r*Dg(e),Dg(n)]}function Wg(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Yg(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Xg(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function $g(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Qg(t){var e=Og(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}fg(),fg(),fg();var Jg=function(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n};function Zg(t,e){return[t>vg?t-bg:t<-vg?t+bg:t,e]}function Kg(t,e,n){return(t%=bg)?e||n?Jg(ev(t),nv(e,n)):ev(t):e||n?nv(e,n):Zg}function tv(t){return function(e,n){return[(e+=t)>vg?e-bg:e<-vg?e+bg:e,n]}}function ev(t){var e=tv(t);return e.invert=tv(-t),e}function nv(t,e){var n=Tg(t),r=Dg(t),i=Tg(e),o=Dg(e);function a(t,e){var a=Tg(e),s=Tg(t)*a,u=Dg(t)*a,c=Dg(e),l=c*n+s*r;return[Sg(u*i-l*o,s*n-c*r),Ng(l*i+u*o)]}return a.invert=function(t,e){var a=Tg(e),s=Tg(t)*a,u=Dg(t)*a,c=Dg(e),l=c*i-u*o;return[Sg(u*i+c*o,s*n+l*r),Ng(l*n-s*r)]},a}Zg.invert=Zg;var rv=function(t){function e(e){return(e=t(e[0]*_g,e[1]*_g))[0]*=xg,e[1]*=xg,e}return t=Kg(t[0]*_g,t[1]*_g,t.length>2?t[2]*_g:0),e.invert=function(e){return(e=t.invert(e[0]*_g,e[1]*_g))[0]*=xg,e[1]*=xg,e},e};function iv(t,e){(e=Gg(e))[0]-=t,Qg(e);var n=Ig(-e[1]);return((-e[2]<0?-n:n)+bg-gg)%bg}var ov=function(){var t,e=[];return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:Fg,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}},av=function(t,e){return Mg(t[0]-e[0])<gg&&Mg(t[1]-e[1])<gg};function sv(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}var uv=function(t,e,n,r,i){var o,a,s=[],u=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],a=t[e];if(av(r,a)){for(i.lineStart(),o=0;o<e;++o)i.point((r=t[o])[0],r[1]);i.lineEnd()}else s.push(n=new sv(r,t,null,!0)),u.push(n.o=new sv(r,null,n,!1)),s.push(n=new sv(a,t,null,!1)),u.push(n.o=new sv(a,null,n,!0))}}),s.length){for(u.sort(e),cv(s),cv(u),o=0,a=u.length;o<a;++o)u[o].e=n=!n;for(var c,l,h=s[0];;){for(var f=h,d=!0;f.v;)if((f=f.n)===h)return;c=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(d)for(o=0,a=c.length;o<a;++o)i.point((l=c[o])[0],l[1]);else r(f.x,f.n.x,1,i);f=f.n}else{if(d)for(o=(c=f.p.z).length-1;o>=0;--o)i.point((l=c[o])[0],l[1]);else r(f.x,f.p.x,-1,i);f=f.p}c=(f=f.o).z,d=!d}while(!f.v);i.lineEnd()}}};function cv(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}var lv=fg(),hv=function(t,e,n,r){return function(i){var o,a,s,u=e(i),c=ov(),l=e(c),h=!1,f={point:d,lineStart:m,lineEnd:g,polygonStart:function(){f.point=v,f.lineStart=y,f.lineEnd=w,a=[],o=[]},polygonEnd:function(){f.point=d,f.lineStart=m,f.lineEnd=g,a=pi(a);var t=function(t,e){var n=e[0],r=e[1],i=[Dg(n),-Tg(n),0],o=0,a=0;lv.reset();for(var s=0,u=t.length;s<u;++s)if(l=(c=t[s]).length)for(var c,l,h=c[l-1],f=h[0],d=h[1]/2+wg,p=Dg(d),m=Tg(d),g=0;g<l;++g,f=y,p=b,m=x,h=v){var v=c[g],y=v[0],w=v[1]/2+wg,b=Dg(w),x=Tg(w),_=y-f,M=_>=0?1:-1,E=M*_,S=E>vg,T=p*b;if(lv.add(Sg(T*M*Dg(E),m*x+T*Tg(E))),o+=S?_+M*bg:_,S^f>=n^y>=n){var A=Yg(Gg(h),Gg(v));Qg(A);var k=Yg(i,A);Qg(k);var C=(S^_>=0?-1:1)*Ng(k[2]);(r>C||r===C&&(A[0]||A[1]))&&(a+=S^_>=0?1:-1)}}return(o<-gg||o<gg&&lv<-gg)^1&a}(o,r);a.length?(h||(i.polygonStart(),h=!0),uv(a,dv,t,n,i)):t&&(h||(i.polygonStart(),h=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),h&&(i.polygonEnd(),h=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(e,n){t(e,n)&&i.point(e,n)}function p(t,e){u.point(t,e)}function m(){f.point=p,u.lineStart()}function g(){f.point=d,u.lineEnd()}function v(t,e){s.push([t,e]),l.point(t,e)}function y(){l.lineStart(),s=[]}function w(){v(s[0][0],s[0][1]),l.lineEnd();var t,e,n,r,u=l.clean(),f=c.result(),d=f.length;if(s.pop(),o.push(s),s=null,d)if(1&u){if((e=(n=f[0]).length-1)>0){for(h||(i.polygonStart(),h=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else d>1&&2&u&&f.push(f.pop().concat(f.shift())),a.push(f.filter(fv))}return f}};function fv(t){return t.length>1}function dv(t,e){return((t=t.x)[0]<0?t[1]-yg-gg:yg-t[1])-((e=e.x)[0]<0?e[1]-yg-gg:yg-e[1])}var pv=hv(function(){return!0},function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var s,u,c,l,h,f,d,p=o>0?vg:-vg,m=Mg(o-n);Mg(m-vg)<gg?(t.point(n,r=(r+a)/2>0?yg:-yg),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(p,r),t.point(o,r),e=0):i!==p&&m>=vg&&(Mg(n-i)<gg&&(n-=i*gg),Mg(o-p)<gg&&(o-=p*gg),u=r,l=a,d=Dg((s=n)-(c=o)),r=Mg(d)>gg?Eg((Dg(u)*(f=Tg(l))*Dg(c)-Dg(l)*(h=Tg(u))*Dg(s))/(h*f*d)):(u+l)/2,t.point(i,r),t.lineEnd(),t.lineStart(),t.point(p,r),e=0),t.point(n=o,r=a),i=p},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}},function(t,e,n,r){var i;if(null==t)r.point(-vg,i=n*yg),r.point(0,i),r.point(vg,i),r.point(vg,0),r.point(vg,-i),r.point(0,-i),r.point(-vg,-i),r.point(-vg,0),r.point(-vg,i);else if(Mg(t[0]-e[0])>gg){var o=t[0]<e[0]?vg:-vg;r.point(-o,i=n*o/2),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])},[-vg,-yg]),mv=function(t){var e=Tg(t),n=6*_g,r=e>0,i=Mg(e)>gg;function o(t,n){return Tg(t)*Tg(n)>e}function a(t,n,r){var i=[1,0,0],o=Yg(Gg(t),Gg(n)),a=Wg(o,o),s=o[0],u=a-s*s;if(!u)return!r&&t;var c=e*a/u,l=-e*s/u,h=Yg(i,o),f=$g(i,c);Xg(f,$g(o,l));var d=h,p=Wg(f,d),m=Wg(d,d),g=p*p-m*(Wg(f,f)-1);if(!(g<0)){var v=Og(g),y=$g(d,(-p-v)/m);if(Xg(y,f),y=qg(y),!r)return y;var w,b=t[0],x=n[0],_=t[1],M=n[1];x<b&&(w=b,b=x,x=w);var E=x-b,S=Mg(E-vg)<gg;if(!S&&M<_&&(w=_,_=M,M=w),S||E<gg?S?_+M>0^y[1]<(Mg(y[0]-b)<gg?_:M):_<=y[1]&&y[1]<=M:E>vg^(b<=y[0]&&y[0]<=x)){var T=$g(d,(-p+v)/m);return Xg(T,f),[y,qg(T)]}}}function s(e,n){var i=r?t:vg-t,o=0;return e<-i?o|=1:e>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return hv(o,function(t){var e,n,u,c,l;return{lineStart:function(){c=u=!1,l=1},point:function(h,f){var d,p=[h,f],m=o(h,f),g=r?m?0:s(h,f):m?s(h+(h<0?vg:-vg),f):0;if(!e&&(c=u=m)&&t.lineStart(),m!==u&&(!(d=a(e,p))||av(e,d)||av(p,d))&&(p[0]+=gg,p[1]+=gg,m=o(p[0],p[1])),m!==u)l=0,m?(t.lineStart(),d=a(p,e),t.point(d[0],d[1])):(d=a(e,p),t.point(d[0],d[1]),t.lineEnd()),e=d;else if(i&&e&&r^m){var v;g&n||!(v=a(p,e,!0))||(l=0,r?(t.lineStart(),t.point(v[0][0],v[0][1]),t.point(v[1][0],v[1][1]),t.lineEnd()):(t.point(v[1][0],v[1][1]),t.lineEnd(),t.lineStart(),t.point(v[0][0],v[0][1])))}!m||e&&av(e,p)||t.point(p[0],p[1]),e=p,u=m,n=g},lineEnd:function(){u&&t.lineEnd(),e=null},clean:function(){return l|(c&&u)<<1}}},function(e,r,i,o){!function(t,e,n,r,i,o){if(n){var a=Tg(e),s=Dg(e),u=r*n;null==i?(i=e+r*bg,o=e-u/2):(i=iv(a,i),o=iv(a,o),(r>0?i<o:i>o)&&(i+=r*bg));for(var c,l=i;r>0?l>o:l<o;l-=u)c=qg([a,-s*Tg(l),-s*Dg(l)]),t.point(c[0],c[1])}}(o,t,n,i,e,r)},r?[0,-t]:[-vg,t-vg])},gv=function(t,e,n,r,i,o){var a,s=t[0],u=t[1],c=0,l=1,h=e[0]-s,f=e[1]-u;if(a=n-s,h||!(a>0)){if(a/=h,h<0){if(a<c)return;a<l&&(l=a)}else if(h>0){if(a>l)return;a>c&&(c=a)}if(a=i-s,h||!(a<0)){if(a/=h,h<0){if(a>l)return;a>c&&(c=a)}else if(h>0){if(a<c)return;a<l&&(l=a)}if(a=r-u,f||!(a>0)){if(a/=f,f<0){if(a<c)return;a<l&&(l=a)}else if(f>0){if(a>l)return;a>c&&(c=a)}if(a=o-u,f||!(a<0)){if(a/=f,f<0){if(a>l)return;a>c&&(c=a)}else if(f>0){if(a<c)return;a<l&&(l=a)}return c>0&&(t[0]=s+c*h,t[1]=u+c*f),l<1&&(e[0]=s+l*h,e[1]=u+l*f),!0}}}}},vv=1e9,yv=-vv;function wv(t,e,n){var r=ii(t,e-gg,n).concat(e);return function(t){return r.map(function(e){return[t,e]})}}function bv(t,e,n){var r=ii(t,e-gg,n).concat(e);return function(t){return r.map(function(e){return[e,t]})}}fg();var xv,_v,Mv,Ev,Sv=function(t){return t},Tv=fg(),Av=fg(),kv={point:Fg,lineStart:Fg,lineEnd:Fg,polygonStart:function(){kv.lineStart=Cv,kv.lineEnd=Lv},polygonEnd:function(){kv.lineStart=kv.lineEnd=kv.point=Fg,Tv.add(Mg(Av)),Av.reset()},result:function(){var t=Tv/2;return Tv.reset(),t}};function Cv(){kv.point=Rv}function Rv(t,e){kv.point=Dv,xv=Mv=t,_v=Ev=e}function Dv(t,e){Av.add(Ev*t-Mv*e),Mv=t,Ev=e}function Lv(){Dv(xv,_v)}var Ov,Pv,Iv,Nv,Fv=1/0,jv=Fv,zv=-Fv,Uv=zv,Vv={point:function(t,e){t<Fv&&(Fv=t),t>zv&&(zv=t),e<jv&&(jv=e),e>Uv&&(Uv=e)},lineStart:Fg,lineEnd:Fg,polygonStart:Fg,polygonEnd:Fg,result:function(){var t=[[Fv,jv],[zv,Uv]];return zv=Uv=-(jv=Fv=1/0),t}},Bv=0,Hv=0,qv=0,Gv=0,Wv=0,Yv=0,Xv=0,$v=0,Qv=0,Jv={point:Zv,lineStart:Kv,lineEnd:ny,polygonStart:function(){Jv.lineStart=ry,Jv.lineEnd=iy},polygonEnd:function(){Jv.point=Zv,Jv.lineStart=Kv,Jv.lineEnd=ny},result:function(){var t=Qv?[Xv/Qv,$v/Qv]:Yv?[Gv/Yv,Wv/Yv]:qv?[Bv/qv,Hv/qv]:[NaN,NaN];return Bv=Hv=qv=Gv=Wv=Yv=Xv=$v=Qv=0,t}};function Zv(t,e){Bv+=t,Hv+=e,++qv}function Kv(){Jv.point=ty}function ty(t,e){Jv.point=ey,Zv(Iv=t,Nv=e)}function ey(t,e){var n=t-Iv,r=e-Nv,i=Og(n*n+r*r);Gv+=i*(Iv+t)/2,Wv+=i*(Nv+e)/2,Yv+=i,Zv(Iv=t,Nv=e)}function ny(){Jv.point=Zv}function ry(){Jv.point=oy}function iy(){ay(Ov,Pv)}function oy(t,e){Jv.point=ay,Zv(Ov=Iv=t,Pv=Nv=e)}function ay(t,e){var n=t-Iv,r=e-Nv,i=Og(n*n+r*r);Gv+=i*(Iv+t)/2,Wv+=i*(Nv+e)/2,Yv+=i,Xv+=(i=Nv*t-Iv*e)*(Iv+t),$v+=i*(Nv+e),Qv+=3*i,Zv(Iv=t,Nv=e)}function sy(t){this._context=t}sy.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,bg)}},result:Fg};var uy,cy,ly,hy,fy,dy=fg(),py={point:Fg,lineStart:function(){py.point=my},lineEnd:function(){uy&&gy(cy,ly),py.point=Fg},polygonStart:function(){uy=!0},polygonEnd:function(){uy=null},result:function(){var t=+dy;return dy.reset(),t}};function my(t,e){py.point=gy,cy=hy=t,ly=fy=e}function gy(t,e){dy.add(Og((hy-=t)*hy+(fy-=e)*fy)),hy=t,fy=e}function vy(){this._string=[]}function yy(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}vy.prototype={_radius:4.5,_circle:yy(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=yy(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}};var wy=function(t,e){var n,r,i=4.5;function o(t){return t&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),Hg(t,n(r))),r.result()}return o.area=function(t){return Hg(t,n(kv)),kv.result()},o.measure=function(t){return Hg(t,n(py)),py.result()},o.bounds=function(t){return Hg(t,n(Vv)),Vv.result()},o.centroid=function(t){return Hg(t,n(Jv)),Jv.result()},o.projection=function(e){return arguments.length?(n=null==e?(t=null,Sv):(t=e).stream,o):t},o.context=function(t){return arguments.length?(r=null==t?(e=null,new vy):new sy(e=t),"function"!=typeof i&&r.pointRadius(i),o):e},o.pointRadius=function(t){return arguments.length?(i="function"==typeof t?t:(r.pointRadius(+t),+t),o):i},o.projection(t).context(e)};function by(t){return function(e){var n=new xy;for(var r in t)n[r]=t[r];return n.stream=e,n}}function xy(){}function _y(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),Hg(n,t.stream(Vv)),e(Vv.result()),null!=r&&t.clipExtent(r),t}function My(t,e,n){return _y(t,function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),a=+e[0][0]+(r-o*(n[1][0]+n[0][0]))/2,s=+e[0][1]+(i-o*(n[1][1]+n[0][1]))/2;t.scale(150*o).translate([a,s])},n)}function Ey(t,e,n){return My(t,[[0,0],e],n)}function Sy(t,e,n){return _y(t,function(n){var r=+e,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,a=-i*n[0][1];t.scale(150*i).translate([o,a])},n)}function Ty(t,e,n){return _y(t,function(n){var r=+e,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],a=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([o,a])},n)}xy.prototype={constructor:xy,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Ay=16,ky=Tg(30*_g),Cy=function(t,e){return+e?function(t,e){function n(r,i,o,a,s,u,c,l,h,f,d,p,m,g){var v=c-r,y=l-i,w=v*v+y*y;if(w>4*e&&m--){var b=a+f,x=s+d,_=u+p,M=Og(b*b+x*x+_*_),E=Ng(_/=M),S=Mg(Mg(_)-1)<gg||Mg(o-h)<gg?(o+h)/2:Sg(x,b),T=t(S,E),A=T[0],k=T[1],C=A-r,R=k-i,D=y*C-v*R;(D*D/w>e||Mg((v*C+y*R)/w-.5)>.3||a*f+s*d+u*p<ky)&&(n(r,i,o,a,s,u,A,k,S,b/=M,x/=M,_,m,g),g.point(A,k),n(A,k,S,b,x,_,c,l,h,f,d,p,m,g))}}return function(e){var r,i,o,a,s,u,c,l,h,f,d,p,m={point:g,lineStart:v,lineEnd:w,polygonStart:function(){e.polygonStart(),m.lineStart=b},polygonEnd:function(){e.polygonEnd(),m.lineStart=v}};function g(n,r){n=t(n,r),e.point(n[0],n[1])}function v(){l=NaN,m.point=y,e.lineStart()}function y(r,i){var o=Gg([r,i]),a=t(r,i);n(l,h,c,f,d,p,l=a[0],h=a[1],c=r,f=o[0],d=o[1],p=o[2],Ay,e),e.point(l,h)}function w(){m.point=g,e.lineEnd()}function b(){v(),m.point=x,m.lineEnd=_}function x(t,e){y(r=t,e),i=l,o=h,a=f,s=d,u=p,m.point=y}function _(){n(l,h,c,f,d,p,i,o,r,a,s,u,Ay,e),m.lineEnd=w,w()}return m}}(t,e):(n=t,by({point:function(t,e){t=n(t,e),this.stream.point(t[0],t[1])}}));var n},Ry=by({point:function(t,e){this.stream.point(t*_g,e*_g)}});function Dy(t){return Ly(function(){return t})()}function Ly(t){var e,n,r,i,o,a,s,u,c,l,h=150,f=480,d=250,p=0,m=0,g=0,v=0,y=0,w=null,b=pv,x=null,_=Sv,M=.5,E=Cy(A,M);function S(t){return[(t=o(t[0]*_g,t[1]*_g))[0]*h+n,r-t[1]*h]}function T(t){return(t=o.invert((t[0]-n)/h,(r-t[1])/h))&&[t[0]*xg,t[1]*xg]}function A(t,i){return[(t=e(t,i))[0]*h+n,r-t[1]*h]}function k(){o=Jg(i=Kg(g,v,y),e);var t=e(p,m);return n=f-t[0]*h,r=d+t[1]*h,C()}function C(){return c=l=null,S}return S.stream=function(t){return c&&l===t?c:c=Ry((e=i,by({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}}))(b(E(_(l=t)))));var e},S.preclip=function(t){return arguments.length?(b=t,w=void 0,C()):b},S.postclip=function(t){return arguments.length?(_=t,x=a=s=u=null,C()):_},S.clipAngle=function(t){return arguments.length?(b=+t?mv(w=t*_g):(w=null,pv),C()):w*xg},S.clipExtent=function(t){return arguments.length?(_=null==t?(x=a=s=u=null,Sv):function(t,e,n,r){function i(i,o){return t<=i&&i<=n&&e<=o&&o<=r}function o(i,o,s,c){var l=0,h=0;if(null==i||(l=a(i,s))!==(h=a(o,s))||u(i,o)<0^s>0)do{c.point(0===l||3===l?t:n,l>1?r:e)}while((l=(l+s+4)%4)!==h);else c.point(o[0],o[1])}function a(r,i){return Mg(r[0]-t)<gg?i>0?0:3:Mg(r[0]-n)<gg?i>0?2:1:Mg(r[1]-e)<gg?i>0?1:0:i>0?3:2}function s(t,e){return u(t.x,e.x)}function u(t,e){var n=a(t,1),r=a(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(a){var u,c,l,h,f,d,p,m,g,v,y,w=a,b=ov(),x={point:_,lineStart:function(){x.point=M,c&&c.push(l=[]),v=!0,g=!1,p=m=NaN},lineEnd:function(){u&&(M(h,f),d&&g&&b.rejoin(),u.push(b.result())),x.point=_,g&&w.lineEnd()},polygonStart:function(){w=b,u=[],c=[],y=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=c.length;n<i;++n)for(var o,a,s=c[n],u=1,l=s.length,h=s[0],f=h[0],d=h[1];u<l;++u)o=f,a=d,f=(h=s[u])[0],d=h[1],a<=r?d>r&&(f-o)*(r-a)>(d-a)*(t-o)&&++e:d<=r&&(f-o)*(r-a)<(d-a)*(t-o)&&--e;return e}(),n=y&&e,i=(u=pi(u)).length;(n||i)&&(a.polygonStart(),n&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&uv(u,s,e,o,a),a.polygonEnd()),w=a,u=c=l=null}};function _(t,e){i(t,e)&&w.point(t,e)}function M(o,a){var s=i(o,a);if(c&&l.push([o,a]),v)h=o,f=a,d=s,v=!1,s&&(w.lineStart(),w.point(o,a));else if(s&&g)w.point(o,a);else{var u=[p=Math.max(yv,Math.min(vv,p)),m=Math.max(yv,Math.min(vv,m))],b=[o=Math.max(yv,Math.min(vv,o)),a=Math.max(yv,Math.min(vv,a))];gv(u,b,t,e,n,r)?(g||(w.lineStart(),w.point(u[0],u[1])),w.point(b[0],b[1]),s||w.lineEnd(),y=!1):s&&(w.lineStart(),w.point(o,a),y=!1)}p=o,m=a,g=s}return x}}(x=+t[0][0],a=+t[0][1],s=+t[1][0],u=+t[1][1]),C()):null==x?null:[[x,a],[s,u]]},S.scale=function(t){return arguments.length?(h=+t,k()):h},S.translate=function(t){return arguments.length?(f=+t[0],d=+t[1],k()):[f,d]},S.center=function(t){return arguments.length?(p=t[0]%360*_g,m=t[1]%360*_g,k()):[p*xg,m*xg]},S.rotate=function(t){return arguments.length?(g=t[0]%360*_g,v=t[1]%360*_g,y=t.length>2?t[2]%360*_g:0,k()):[g*xg,v*xg,y*xg]},S.precision=function(t){return arguments.length?(E=Cy(A,M=t*t),C()):Og(M)},S.fitExtent=function(t,e){return My(S,t,e)},S.fitSize=function(t,e){return Ey(S,t,e)},S.fitWidth=function(t,e){return Sy(S,t,e)},S.fitHeight=function(t,e){return Ty(S,t,e)},function(){return e=t.apply(this,arguments),S.invert=e.invert&&T,k()}}function Oy(t){var e=0,n=vg/3,r=Ly(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*_g,n=t[1]*_g):[e*xg,n*xg]},i}function Py(t,e){var n=Dg(t),r=(n+Dg(e))/2;if(Mg(r)<gg)return function(t){var e=Tg(t);function n(t,n){return[t*e,Dg(n)/e]}return n.invert=function(t,n){return[t/e,Ng(n*e)]},n}(t);var i=1+n*(2*r-n),o=Og(i)/r;function a(t,e){var n=Og(i-2*r*Dg(e))/r;return[n*Dg(t*=r),o-n*Tg(t)]}return a.invert=function(t,e){var n=o-e;return[Sg(t,Mg(n))/r*Lg(n),Ng((i-(t*t+n*n)*r*r)/(2*r))]},a}var Iy=function(){return Oy(Py).scale(155.424).center([0,33.6442])},Ny=function(){return Iy().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])};function Fy(t){return function(e,n){var r=Tg(e),i=Tg(n),o=t(r*i);return[o*i*Dg(e),o*Dg(n)]}}function jy(t){return function(e,n){var r=Og(e*e+n*n),i=t(r),o=Dg(i),a=Tg(i);return[Sg(e*o,r*a),Ng(r&&n*o/r)]}}var zy=Fy(function(t){return Og(2/(1+t))});zy.invert=jy(function(t){return 2*Ng(t/2)});var Uy=Fy(function(t){return(t=Ig(t))&&t/Dg(t)});function Vy(t,e){return[t,Cg(Pg((yg+e)/2))]}function By(t){var e,n,r,i=Dy(t),o=i.center,a=i.scale,s=i.translate,u=i.clipExtent,c=null;function l(){var o=vg*a(),s=i(rv(i.rotate()).invert([0,0]));return u(null==c?[[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]]:t===Vy?[[Math.max(s[0]-o,c),e],[Math.min(s[0]+o,n),r]]:[[c,Math.max(s[1]-o,e)],[n,Math.min(s[1]+o,r)]])}return i.scale=function(t){return arguments.length?(a(t),l()):a()},i.translate=function(t){return arguments.length?(s(t),l()):s()},i.center=function(t){return arguments.length?(o(t),l()):o()},i.clipExtent=function(t){return arguments.length?(null==t?c=e=n=r=null:(c=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),l()):null==c?null:[[c,e],[n,r]]},l()}function Hy(t){return Pg((yg+t)/2)}function qy(t,e){var n=Tg(t),r=t===e?Dg(t):Cg(n/Tg(e))/Cg(Hy(e)/Hy(t)),i=n*Rg(Hy(t),r)/r;if(!r)return Vy;function o(t,e){i>0?e<-yg+gg&&(e=-yg+gg):e>yg-gg&&(e=yg-gg);var n=i/Rg(Hy(e),r);return[n*Dg(r*t),i-n*Tg(r*t)]}return o.invert=function(t,e){var n=i-e,o=Lg(r)*Og(t*t+n*n);return[Sg(t,Mg(n))/r*Lg(n),2*Eg(Rg(i/o,1/r))-yg]},o}function Gy(t,e){return[t,e]}function Wy(t,e){var n=Tg(t),r=t===e?Dg(t):(n-Tg(e))/(e-t),i=n/r+t;if(Mg(r)<gg)return Gy;function o(t,e){var n=i-e,o=r*t;return[n*Dg(o),i-n*Tg(o)]}return o.invert=function(t,e){var n=i-e;return[Sg(t,Mg(n))/r*Lg(n),i-Lg(r)*Og(t*t+n*n)]},o}function Yy(t,e){var n=Tg(e),r=Tg(t)*n;return[n*Dg(t)/r,Dg(e)/r]}function Xy(t,e){return[Tg(e)*Dg(t),Dg(e)]}function $y(t,e){var n=Tg(e),r=1+Tg(t)*n;return[n*Dg(t)/r,Dg(e)/r]}function Qy(t,e){return[Cg(Pg((yg+e)/2)),-t]}Uy.invert=jy(function(t){return t}),Vy.invert=function(t,e){return[t,2*Eg(kg(e))-yg]},Gy.invert=Gy,Yy.invert=jy(Eg),Xy.invert=jy(Ng),$y.invert=jy(function(t){return 2*Eg(t)}),Qy.invert=function(t,e){return[-e,2*Eg(kg(t))-yg]};var Jy=wy(),Zy=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function Ky(t,e){return arguments.length>1?(ew[t]=(n=t,r=e,function t(){var e=r();return e.type=n,e.path=wy().projection(e),e.copy=e.copy||function(){var n=t();return Zy.forEach(function(t){e.hasOwnProperty(t)&&n[t](e[t]())}),n.path.pointRadius(e.path.pointRadius()),n},e}),this):ew.hasOwnProperty(t)?ew[t]:null;var n,r}function tw(t){return t&&t.path||Jy}var ew={albers:Ny,albersusa:function(){var t,e,n,r,i,o,a=Ny(),s=Iy().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=Iy().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(t,e){o=[t,e]}};function l(t){var e=t[0],a=t[1];return o=null,n.point(e,a),o||(r.point(e,a),o)||(i.point(e,a),o)}function h(){return t=e=null,l}return l.invert=function(t){var e=a.scale(),n=a.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?u:a).invert(t)},l.stream=function(n){return t&&e===n?t:(r=[a.stream(e=n),s.stream(n),u.stream(n)],i=r.length,t={point:function(t,e){for(var n=-1;++n<i;)r[n].point(t,e)},sphere:function(){for(var t=-1;++t<i;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<i;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<i;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<i;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<i;)r[t].polygonEnd()}});var r,i},l.precision=function(t){return arguments.length?(a.precision(t),s.precision(t),u.precision(t),h()):a.precision()},l.scale=function(t){return arguments.length?(a.scale(t),s.scale(.35*t),u.scale(t),l.translate(a.translate())):a.scale()},l.translate=function(t){if(!arguments.length)return a.translate();var e=a.scale(),o=+t[0],l=+t[1];return n=a.translate(t).clipExtent([[o-.455*e,l-.238*e],[o+.455*e,l+.238*e]]).stream(c),r=s.translate([o-.307*e,l+.201*e]).clipExtent([[o-.425*e+gg,l+.12*e+gg],[o-.214*e-gg,l+.234*e-gg]]).stream(c),i=u.translate([o-.205*e,l+.212*e]).clipExtent([[o-.214*e+gg,l+.166*e+gg],[o-.115*e-gg,l+.234*e-gg]]).stream(c),h()},l.fitExtent=function(t,e){return My(l,t,e)},l.fitSize=function(t,e){return Ey(l,t,e)},l.fitWidth=function(t,e){return Sy(l,t,e)},l.fitHeight=function(t,e){return Ty(l,t,e)},l.scale(1070)},azimuthalequalarea:function(){return Dy(zy).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return Dy(Uy).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return Oy(qy).scale(109.5).parallels([30,30])},conicequalarea:Iy,conicequidistant:function(){return Oy(Wy).scale(131.154).center([0,13.9389])},equirectangular:function(){return Dy(Gy).scale(152.63)},gnomonic:function(){return Dy(Yy).scale(144.049).clipAngle(60)},mercator:function(){return By(Vy).scale(961/bg)},orthographic:function(){return Dy(Xy).scale(249.5).clipAngle(90+gg)},stereographic:function(){return Dy($y).scale(250).clipAngle(142)},transversemercator:function(){var t=By(Qy),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)}};for(var nw in ew)Ky(nw,ew[nw]);function rw(t){Ir.call(this,null,t)}function iw(t){Ir.call(this,null,t)}function ow(t){Ir.call(this,null,t)}function aw(t){Ir.call(this,[],t),this.generator=function(){var t,e,n,r,i,o,a,s,u,c,l,h,f=10,d=f,p=90,m=360,g=2.5;function v(){return{type:"MultiLineString",coordinates:y()}}function y(){return ii(Ag(r/p)*p,n,p).map(l).concat(ii(Ag(s/m)*m,a,m).map(h)).concat(ii(Ag(e/f)*f,t,f).filter(function(t){return Mg(t%p)>gg}).map(u)).concat(ii(Ag(o/d)*d,i,d).filter(function(t){return Mg(t%m)>gg}).map(c))}return v.lines=function(){return y().map(function(t){return{type:"LineString",coordinates:t}})},v.outline=function(){return{type:"Polygon",coordinates:[l(r).concat(h(a).slice(1),l(n).reverse().slice(1),h(s).reverse().slice(1))]}},v.extent=function(t){return arguments.length?v.extentMajor(t).extentMinor(t):v.extentMinor()},v.extentMajor=function(t){return arguments.length?(s=+t[0][1],a=+t[1][1],(r=+t[0][0])>(n=+t[1][0])&&(t=r,r=n,n=t),s>a&&(t=s,s=a,a=t),v.precision(g)):[[r,s],[n,a]]},v.extentMinor=function(n){return arguments.length?(o=+n[0][1],i=+n[1][1],(e=+n[0][0])>(t=+n[1][0])&&(n=e,e=t,t=n),o>i&&(n=o,o=i,i=n),v.precision(g)):[[e,o],[t,i]]},v.step=function(t){return arguments.length?v.stepMajor(t).stepMinor(t):v.stepMinor()},v.stepMajor=function(t){return arguments.length?(p=+t[0],m=+t[1],v):[p,m]},v.stepMinor=function(t){return arguments.length?(f=+t[0],d=+t[1],v):[f,d]},v.precision=function(f){return arguments.length?(g=+f,u=wv(o,i,90),c=bv(e,t,g),l=wv(s,a,90),h=bv(r,n,g),v):g},v.extentMajor([[-180,-90+gg],[180,90-gg]]).extentMinor([[-180,-80-gg],[180,80+gg]])}()}function sw(t){Ir.call(this,null,t),this.modified(!0)}function uw(t,e,n){I(t[e])&&t[e](n)}rw.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"as",type:"string",default:"path"}]},H(rw,Ir).transform=function(t,e){var n,r=e.fork(e.ALL),i=this.value,o=t.field||d,a=t.as||"path";function s(t){t[a]=i(o(t))}return!i||t.modified()?(this.value=i=tw(t.projection).context(null),r.materialize().reflow().visit(r.SOURCE,s)):(i.context(null),n=o===d||e.modified(o.fields),r.visit(n?r.ADD_MOD:r.ADD,s)),r.modifies(a)},iw.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},H(iw,Ir).transform=function(t,e){var n,r=t.projection,i=t.fields[0],o=t.fields[1],a=t.as||["x","y"],s=a[0],u=a[1];function c(t){var e=r([i(t),o(t)]);e?(t[s]=e[0],t[u]=e[1]):(t[s]=void 0,t[u]=void 0)}return t.modified()?e=e.materialize().reflow(!0).visit(e.SOURCE,c):(n=e.modified(i.fields)||e.modified(o.fields),e.visit(n?e.ADD_MOD:e.ADD,c)),e.modifies(a)},ow.Definition={type:"GeoShape",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"as",type:"string",default:"shape"}]},H(ow,Ir).transform=function(t,e){var n,r,i,o=e.fork(e.ALL),a=this.value,s=t.field||l("datum"),u=t.as||"shape",c=o.ADD_MOD;return a&&!t.modified()||(this.value=(n=tw(t.projection),r=s,(i=function(t){return n(r(t))}).context=function(t){return n.context(t),i},a=i),o.materialize().reflow(),c=o.SOURCE),o.visit(c,function(t){t[u]=a}),o.modifies(u)},aw.Definition={type:"Graticule",metadata:{source:!0,generates:!0,changes:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},H(aw,Ir).transform=function(t,e){var n,r=e.fork(),i=this.value,o=this.generator;if(!i.length||t.modified())for(var a in t)I(o[a])&&o[a](t[a]);return n=o(),i.length?r.mod.push(pt(i[0],n)):r.add.push(ht(n)),i[0]=n,r.source=i,r},H(sw,Ir).transform=function(t,e){var n,r,o,s,u=this.value;return!u||t.modified("type")?(this.value=u=function(t){var e=Ky((t||"mercator").toLowerCase());return e||i("Unrecognized projection type: "+t),e()}(t.type),Zy.forEach(function(e){null!=t[e]&&uw(u,e,t[e])})):Zy.forEach(function(e){t.modified(e)&&uw(u,e,t[e])}),null!=t.pointRadius&&u.path.pointRadius(t.pointRadius),t.fit&&(n=u,s=(r=t).fit,o=1===(s=P(s)).length?s[0]:{type:lg,features:s.reduce(function(t,e){return e&&e.type===lg?t.push.apply(t,e.features):a(e)?t.push.apply(t,e):t.push(e),t},[])},r.extent?n.fitExtent(r.extent,o):r.size&&n.fitSize(r.size,o)),e.fork(e.NO_SOURCE|e.NO_FIELDS)};var cw=Object.freeze({contour:cg,geojson:hg,geopath:rw,geopoint:iw,geoshape:ow,graticule:aw,projection:sw}),lw=function(t){return function(){return t}},hw=function(){return 1e-6*(Math.random()-.5)};function fw(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o,a,s,u,c,l,h,f,d=t._root,p={data:r},m=t._x0,g=t._y0,v=t._x1,y=t._y1;if(!d)return t._root=p,t;for(;d.length;)if((c=e>=(o=(m+v)/2))?m=o:v=o,(l=n>=(a=(g+y)/2))?g=a:y=a,i=d,!(d=d[h=l<<1|c]))return i[h]=p,t;if(s=+t._x.call(null,d.data),u=+t._y.call(null,d.data),e===s&&n===u)return p.next=d,i?i[h]=p:t._root=p,t;do{i=i?i[h]=new Array(4):t._root=new Array(4),(c=e>=(o=(m+v)/2))?m=o:v=o,(l=n>=(a=(g+y)/2))?g=a:y=a}while((h=l<<1|c)==(f=(u>=a)<<1|s>=o));return i[f]=d,i[h]=p,t}var dw=function(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i};function pw(t){return t[0]}function mw(t){return t[1]}function gw(t,e,n){var r=new vw(null==e?pw:e,null==n?mw:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function vw(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function yw(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var ww=gw.prototype=vw.prototype;function bw(t){return t.x+t.vx}function xw(t){return t.y+t.vy}function _w(t){return t.index}function Mw(t,e){var n=t.get(e);if(!n)throw new Error("missing: "+e);return n}ww.copy=function(){var t,e,n=new vw(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=yw(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=yw(e));return n},ww.add=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return fw(this.cover(e,n),e,n,t)},ww.addAll=function(t){var e,n,r,i,o=t.length,a=new Array(o),s=new Array(o),u=1/0,c=1/0,l=-1/0,h=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(a[n]=r,s[n]=i,r<u&&(u=r),r>l&&(l=r),i<c&&(c=i),i>h&&(h=i));for(l<u&&(u=this._x0,l=this._x1),h<c&&(c=this._y0,h=this._y1),this.cover(u,c).cover(l,h),n=0;n<o;++n)fw(this,a[n],s[n],t[n]);return this},ww.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{if(!(n>t||t>i||r>e||e>o))return this;var a,s,u=i-n,c=this._root;switch(s=(e<(r+o)/2)<<1|t<(n+i)/2){case 0:do{(a=new Array(4))[s]=c,c=a}while(o=r+(u*=2),t>(i=n+u)||e>o);break;case 1:do{(a=new Array(4))[s]=c,c=a}while(o=r+(u*=2),(n=i-u)>t||e>o);break;case 2:do{(a=new Array(4))[s]=c,c=a}while(r=o-(u*=2),t>(i=n+u)||r>e);break;case 3:do{(a=new Array(4))[s]=c,c=a}while(r=o-(u*=2),(n=i-u)>t||r>e)}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},ww.data=function(){var t=[];return this.visit(function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)}),t},ww.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},ww.find=function(t,e,n){var r,i,o,a,s,u,c,l=this._x0,h=this._y0,f=this._x1,d=this._y1,p=[],m=this._root;for(m&&p.push(new dw(m,l,h,f,d)),null==n?n=1/0:(l=t-n,h=e-n,f=t+n,d=e+n,n*=n);u=p.pop();)if(!(!(m=u.node)||(i=u.x0)>f||(o=u.y0)>d||(a=u.x1)<l||(s=u.y1)<h))if(m.length){var g=(i+a)/2,v=(o+s)/2;p.push(new dw(m[3],g,v,a,s),new dw(m[2],i,v,g,s),new dw(m[1],g,o,a,v),new dw(m[0],i,o,g,v)),(c=(e>=v)<<1|t>=g)&&(u=p[p.length-1],p[p.length-1]=p[p.length-1-c],p[p.length-1-c]=u)}else{var y=t-+this._x.call(null,m.data),w=e-+this._y.call(null,m.data),b=y*y+w*w;if(b<n){var x=Math.sqrt(n=b);l=t-x,h=e-x,f=t+x,d=e+x,r=m.data}}return r},ww.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,n,r,i,o,a,s,u,c,l,h,f,d=this._root,p=this._x0,m=this._y0,g=this._x1,v=this._y1;if(!d)return this;if(d.length)for(;;){if((c=o>=(s=(p+g)/2))?p=s:g=s,(l=a>=(u=(m+v)/2))?m=u:v=u,e=d,!(d=d[h=l<<1|c]))return this;if(!d.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,f=h)}for(;d.data!==t;)if(r=d,!(d=d.next))return this;return(i=d.next)&&delete d.next,r?(i?r.next=i:delete r.next,this):e?(i?e[h]=i:delete e[h],(d=e[0]||e[1]||e[2]||e[3])&&d===(e[3]||e[2]||e[1]||e[0])&&!d.length&&(n?n[f]=d:this._root=d),this):(this._root=i,this)},ww.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},ww.root=function(){return this._root},ww.size=function(){var t=0;return this.visit(function(e){if(!e.length)do{++t}while(e=e.next)}),t},ww.visit=function(t){var e,n,r,i,o,a,s=[],u=this._root;for(u&&s.push(new dw(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,r=e.x0,i=e.y0,o=e.x1,a=e.y1)&&u.length){var c=(r+o)/2,l=(i+a)/2;(n=u[3])&&s.push(new dw(n,c,l,o,a)),(n=u[2])&&s.push(new dw(n,r,l,c,a)),(n=u[1])&&s.push(new dw(n,c,i,o,l)),(n=u[0])&&s.push(new dw(n,r,i,c,l))}return this},ww.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new dw(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var o,a=e.x0,s=e.y0,u=e.x1,c=e.y1,l=(a+u)/2,h=(s+c)/2;(o=i[0])&&n.push(new dw(o,a,s,l,h)),(o=i[1])&&n.push(new dw(o,l,s,u,h)),(o=i[2])&&n.push(new dw(o,a,h,l,c)),(o=i[3])&&n.push(new dw(o,l,h,u,c))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},ww.x=function(t){return arguments.length?(this._x=t,this):this._x},ww.y=function(t){return arguments.length?(this._y=t,this):this._y};var Ew,Sw,Tw=0,Aw=0,kw=0,Cw=1e3,Rw=0,Dw=0,Lw=0,Ow="object"==typeof performance&&performance.now?performance:Date,Pw="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Iw(){return Dw||(Pw(Nw),Dw=Ow.now()+Lw)}function Nw(){Dw=0}function Fw(){this._call=this._time=this._next=null}function jw(t,e,n){var r=new Fw;return r.restart(t,e,n),r}function zw(){Dw=(Rw=Ow.now())+Lw,Tw=Aw=0;try{!function(){Iw(),++Tw;for(var t,e=Ew;e;)(t=Dw-e._time)>=0&&e._call.call(null,t),e=e._next;--Tw}()}finally{Tw=0,function(){for(var t,e,n=Ew,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Ew=e);Sw=t,Vw(r)}(),Dw=0}}function Uw(){var t=Ow.now(),e=t-Rw;e>Cw&&(Lw-=e,Rw=t)}function Vw(t){Tw||(Aw&&(Aw=clearTimeout(Aw)),t-Dw>24?(t<1/0&&(Aw=setTimeout(zw,t-Ow.now()-Lw)),kw&&(kw=clearInterval(kw))):(kw||(Rw=Ow.now(),kw=setInterval(Uw,Cw)),Tw=1,Pw(zw)))}function Bw(t){return t.x}function Hw(t){return t.y}Fw.prototype=jw.prototype={constructor:Fw,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Iw():+n)+(null==e?0:+e),this._next||Sw===this||(Sw?Sw._next=this:Ew=this,Sw=this),this._call=t,this._time=n,Vw()},stop:function(){this._call&&(this._call=null,this._time=1/0,Vw())}};var qw=10,Gw=Math.PI*(3-Math.sqrt(5)),Ww={center:function(t,e){var n;function r(){var r,i,o=n.length,a=0,s=0;for(r=0;r<o;++r)a+=(i=n[r]).x,s+=i.y;for(a=a/o-t,s=s/o-e,r=0;r<o;++r)(i=n[r]).x-=a,i.y-=s}return null==t&&(t=0),null==e&&(e=0),r.initialize=function(t){n=t},r.x=function(e){return arguments.length?(t=+e,r):t},r.y=function(t){return arguments.length?(e=+t,r):e},r},collide:function(t){var e,n,r=1,i=1;function o(){for(var t,o,s,u,c,l,h,f=e.length,d=0;d<i;++d)for(o=gw(e,bw,xw).visitAfter(a),t=0;t<f;++t)h=(l=n[(s=e[t]).index])*l,u=s.x+s.vx,c=s.y+s.vy,o.visit(p);function p(t,e,n,i,o){var a=t.data,f=t.r,d=l+f;if(!a)return e>u+d||i<u-d||n>c+d||o<c-d;if(a.index>s.index){var p=u-a.x-a.vx,m=c-a.y-a.vy,g=p*p+m*m;g<d*d&&(0===p&&(g+=(p=hw())*p),0===m&&(g+=(m=hw())*m),g=(d-(g=Math.sqrt(g)))/g*r,s.vx+=(p*=g)*(d=(f*=f)/(h+f)),s.vy+=(m*=g)*d,a.vx-=p*(d=1-d),a.vy-=m*d)}}}function a(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function s(){if(e){var r,i,o=e.length;for(n=new Array(o),r=0;r<o;++r)n[(i=e[r]).index]=+t(i,r,e)}}return"function"!=typeof t&&(t=lw(null==t?1:+t)),o.initialize=function(t){e=t,s()},o.iterations=function(t){return arguments.length?(i=+t,o):i},o.strength=function(t){return arguments.length?(r=+t,o):r},o.radius=function(e){return arguments.length?(t="function"==typeof e?e:lw(+e),s(),o):t},o},nbody:function(){var t,e,n,r,i=lw(-30),o=1,a=1/0,s=.81;function u(r){var i,o=t.length,a=gw(t,Bw,Hw).visitAfter(l);for(n=r,i=0;i<o;++i)e=t[i],a.visit(h)}function c(){if(t){var e,n,o=t.length;for(r=new Array(o),e=0;e<o;++e)r[(n=t[e]).index]=+i(n,e,t)}}function l(t){var e,n,i,o,a,s=0,u=0;if(t.length){for(i=o=a=0;a<4;++a)(e=t[a])&&(n=Math.abs(e.value))&&(s+=e.value,u+=n,i+=n*e.x,o+=n*e.y);t.x=i/u,t.y=o/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=r[e.data.index]}while(e=e.next)}t.value=s}function h(t,i,u,c){if(!t.value)return!0;var l=t.x-e.x,h=t.y-e.y,f=c-i,d=l*l+h*h;if(f*f/s<d)return d<a&&(0===l&&(d+=(l=hw())*l),0===h&&(d+=(h=hw())*h),d<o&&(d=Math.sqrt(o*d)),e.vx+=l*t.value*n/d,e.vy+=h*t.value*n/d),!0;if(!(t.length||d>=a)){(t.data!==e||t.next)&&(0===l&&(d+=(l=hw())*l),0===h&&(d+=(h=hw())*h),d<o&&(d=Math.sqrt(o*d)));do{t.data!==e&&(e.vx+=l*(f=r[t.data.index]*n/d),e.vy+=h*f)}while(t=t.next)}}return u.initialize=function(e){t=e,c()},u.strength=function(t){return arguments.length?(i="function"==typeof t?t:lw(+t),c(),u):i},u.distanceMin=function(t){return arguments.length?(o=t*t,u):Math.sqrt(o)},u.distanceMax=function(t){return arguments.length?(a=t*t,u):Math.sqrt(a)},u.theta=function(t){return arguments.length?(s=t*t,u):Math.sqrt(s)},u},link:function(t){var e,n,r,i,o,a=_w,s=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},u=lw(30),c=1;function l(r){for(var i=0,a=t.length;i<c;++i)for(var s,u,l,h,f,d,p,m=0;m<a;++m)u=(s=t[m]).source,h=(l=s.target).x+l.vx-u.x-u.vx||hw(),f=l.y+l.vy-u.y-u.vy||hw(),h*=d=((d=Math.sqrt(h*h+f*f))-n[m])/d*r*e[m],f*=d,l.vx-=h*(p=o[m]),l.vy-=f*p,u.vx+=h*(p=1-p),u.vy+=f*p}function h(){if(r){var s,u,c=r.length,l=t.length,h=Dt(r,a);for(s=0,i=new Array(c);s<l;++s)(u=t[s]).index=s,"object"!=typeof u.source&&(u.source=Mw(h,u.source)),"object"!=typeof u.target&&(u.target=Mw(h,u.target)),i[u.source.index]=(i[u.source.index]||0)+1,i[u.target.index]=(i[u.target.index]||0)+1;for(s=0,o=new Array(l);s<l;++s)o[s]=i[(u=t[s]).source.index]/(i[u.source.index]+i[u.target.index]);e=new Array(l),f(),n=new Array(l),d()}}function f(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+s(t[n],n,t)}function d(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+u(t[e],e,t)}return null==t&&(t=[]),l.initialize=function(t){r=t,h()},l.links=function(e){return arguments.length?(t=e,h(),l):t},l.id=function(t){return arguments.length?(a=t,l):a},l.iterations=function(t){return arguments.length?(c=+t,l):c},l.strength=function(t){return arguments.length?(s="function"==typeof t?t:lw(+t),f(),l):s},l.distance=function(t){return arguments.length?(u="function"==typeof t?t:lw(+t),d(),l):u},l},x:function(t){var e,n,r,i=lw(.1);function o(t){for(var i,o=0,a=e.length;o<a;++o)(i=e[o]).vx+=(r[o]-i.x)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=lw(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:lw(+t),a(),o):i},o.x=function(e){return arguments.length?(t="function"==typeof e?e:lw(+e),a(),o):t},o},y:function(t){var e,n,r,i=lw(.1);function o(t){for(var i,o=0,a=e.length;o<a;++o)(i=e[o]).vy+=(r[o]-i.y)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=lw(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:lw(+t),a(),o):i},o.y=function(e){return arguments.length?(t="function"==typeof e?e:lw(+e),a(),o):t},o}},Yw="forces",Xw=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],$w=["static","iterations"],Qw=["x","y","vx","vy"];function Jw(t){Ir.call(this,null,t)}Jw.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:Qw}]};var Zw=H(Jw,Ir);function Kw(t,e,n,r){var i,o,a,s,u=P(e.forces);for(i=0,o=Xw.length;i<o;++i)(a=Xw[i])!==Yw&&e.modified(a)&&t[a](e[a]);for(i=0,o=u.length;i<o;++i)s=Yw+i,(a=n||e.modified(Yw,i)?eb(u[i]):r&&tb(u[i],r)?t.force(s):null)&&t.force(s,a);for(o=t.numForces||0;i<o;++i)t.force(Yw+i,null);return t.numForces=u.length,t}function tb(t,e){var n,i;for(n in t)if(I(i=t[n])&&e.modified(r(i)))return 1;return 0}function eb(t){var e,n;for(n in Ww.hasOwnProperty(t.force)||i("Unrecognized force: "+t.force),e=Ww[t.force](),t)I(e[n])&&nb(e[n],t[n],t);return e}function nb(t,e,n){t(I(e)?function(t){return e(t,n)}:e)}Zw.transform=function(t,e){var n,r,i,o,a,s,u,c=this.value,l=e.changed(e.ADD_REM),h=t.modified(Xw),f=t.iterations||300;if(c?(l&&(e.modifies("index"),c.nodes(e.source)),(h||e.changed(e.MOD))&&Kw(c,t,0,e)):(this.value=(i=t,o=function(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=Dt(),u=jw(l),c=zt("tick","end");function l(){h(),c.call("tick",e),n<r&&(u.stop(),c.call("end",e))}function h(){var e,r,u=t.length;for(n+=(o-n)*i,s.each(function(t){t(n)}),e=0;e<u;++e)null==(r=t[e]).fx?r.x+=r.vx*=a:(r.x=r.fx,r.vx=0),null==r.fy?r.y+=r.vy*=a:(r.y=r.fy,r.vy=0)}function f(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,isNaN(e.x)||isNaN(e.y)){var i=qw*Math.sqrt(n),o=n*Gw;e.x=i*Math.cos(o),e.y=i*Math.sin(o)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function d(e){return e.initialize&&e.initialize(t),e}return null==t&&(t=[]),f(),e={tick:h,restart:function(){return u.restart(l),e},stop:function(){return u.stop(),e},nodes:function(n){return arguments.length?(t=n,f(),s.each(d),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(o=+t,e):o},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},force:function(t,n){return arguments.length>1?(null==n?s.remove(t):s.set(t,d(n)),e):s.get(t)},find:function(e,n,r){var i,o,a,s,u,c=0,l=t.length;for(null==r?r=1/0:r*=r,c=0;c<l;++c)(a=(i=e-(s=t[c]).x)*i+(o=n-s.y)*o)<r&&(u=s,r=a);return u},on:function(t,n){return arguments.length>1?(c.on(t,n),e):c.on(t)}}}(e.source),a=!1,s=o.stop,u=o.restart,o.stopped=function(){return a},o.restart=function(){return a=!1,u()},o.stop=function(){return a=!0,s()},c=Kw(o,i,!0).on("end",function(){a=!0})),c.on("tick",(n=e.dataflow,r=this,function(){n.touch(r).run()})),t.static||(l=!0,c.tick()),e.modifies("index")),h||l||t.modified($w)||e.changed()&&t.restart)if(c.alpha(Math.max(c.alpha(),t.alpha||1)).alphaDecay(1-Math.pow(c.alphaMin(),1/f)),t.static)for(c.stop();--f>=0;)c.tick();else if(c.stopped()&&c.restart(),!l)return e.StopPropagation;return this.finish(t,e)},Zw.finish=function(t,e){for(var n,r=e.dataflow,i=this._argops,o=0,a=i.length;o<a;++o)if((n=i[o]).name===Yw&&"link"===n.op._argval.force)for(var s,u=n.op._argops,c=0,l=u.length;c<l;++c)if("links"===u[c].name&&(s=u[c].op.source)){r.pulse(s,r.changeset().reflow());break}return e.reflow(t.modified()).modifies(Qw)};var rb=Object.freeze({force:Jw});function ib(t,e){return t.parent===e.parent?1:2}function ob(t,e){return t+e.x}function ab(t,e){return Math.max(t,e.y)}function sb(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function ub(t,e){var n,r,i,o,a,s=new fb(t),u=+t.value&&(s.value=t.value),c=[s];for(null==e&&(e=cb);n=c.pop();)if(u&&(n.value=+n.data.value),(i=e(n.data))&&(a=i.length))for(n.children=new Array(a),o=a-1;o>=0;--o)c.push(r=n.children[o]=new fb(i[o])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(hb)}function cb(t){return t.children}function lb(t){t.data=t.data.data}function hb(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function fb(t){this.data=t,this.depth=this.height=0,this.parent=null}fb.prototype=ub.prototype={constructor:fb,count:function(){return this.eachAfter(sb)},each:function(t){var e,n,r,i,o=this,a=[o];do{for(e=a.reverse(),a=[];o=e.pop();)if(t(o),n=o.children)for(r=0,i=n.length;r<i;++r)a.push(n[r])}while(a.length);return this},eachAfter:function(t){for(var e,n,r,i=this,o=[i],a=[];i=o.pop();)if(a.push(i),e=i.children)for(n=0,r=e.length;n<r;++n)o.push(e[n]);for(;i=a.pop();)t(i);return this},eachBefore:function(t){for(var e,n,r=this,i=[r];r=i.pop();)if(t(r),e=r.children)for(n=e.length-1;n>=0;--n)i.push(e[n]);return this},sum:function(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n})},sort:function(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)r.push(e=e.parent);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){var t=[];return this.each(function(e){t.push(e)}),t},leaves:function(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t},links:function(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e},copy:function(){return ub(this).eachBefore(lb)}};var db=Array.prototype.slice,pb=function(t){for(var e,n,r=0,i=(t=function(t){for(var e,n,r=t.length;r;)n=Math.random()*r--|0,e=t[r],t[r]=t[n],t[n]=e;return t}(db.call(t))).length,o=[];r<i;)e=t[r],n&&vb(n,e)?++r:(n=wb(o=mb(o,e)),r=0);return n};function mb(t,e){var n,r;if(yb(e,t))return[e];for(n=0;n<t.length;++n)if(gb(e,t[n])&&yb(bb(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(gb(bb(t[n],t[r]),e)&&gb(bb(t[n],e),t[r])&&gb(bb(t[r],e),t[n])&&yb(xb(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function gb(t,e){var n=t.r-e.r,r=e.x-t.x,i=e.y-t.y;return n<0||n*n<r*r+i*i}function vb(t,e){var n=t.r-e.r+1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function yb(t,e){for(var n=0;n<e.length;++n)if(!vb(t,e[n]))return!1;return!0}function wb(t){switch(t.length){case 1:return{x:(e=t[0]).x,y:e.y,r:e.r};case 2:return bb(t[0],t[1]);case 3:return xb(t[0],t[1],t[2])}var e}function bb(t,e){var n=t.x,r=t.y,i=t.r,o=e.x,a=e.y,s=e.r,u=o-n,c=a-r,l=s-i,h=Math.sqrt(u*u+c*c);return{x:(n+o+u/h*l)/2,y:(r+a+c/h*l)/2,r:(h+i+s)/2}}function xb(t,e,n){var r=t.x,i=t.y,o=t.r,a=e.x,s=e.y,u=e.r,c=n.x,l=n.y,h=n.r,f=r-a,d=r-c,p=i-s,m=i-l,g=u-o,v=h-o,y=r*r+i*i-o*o,w=y-a*a-s*s+u*u,b=y-c*c-l*l+h*h,x=d*p-f*m,_=(p*b-m*w)/(2*x)-r,M=(m*g-p*v)/x,E=(d*w-f*b)/(2*x)-i,S=(f*v-d*g)/x,T=M*M+S*S-1,A=2*(o+_*M+E*S),k=_*_+E*E-o*o,C=-(T?(A+Math.sqrt(A*A-4*T*k))/(2*T):k/A);return{x:r+_+M*C,y:i+E+S*C,r:C}}function _b(t,e,n){var r=t.x,i=t.y,o=e.r+n.r,a=t.r+n.r,s=e.x-r,u=e.y-i,c=s*s+u*u;if(c){var l=.5+((a*=a)-(o*=o))/(2*c),h=Math.sqrt(Math.max(0,2*o*(a+c)-(a-=c)*a-o*o))/(2*c);n.x=r+l*s+h*u,n.y=i+l*u-h*s}else n.x=r+a,n.y=i}function Mb(t,e){var n=e.x-t.x,r=e.y-t.y,i=t.r+e.r;return i*i-1e-6>n*n+r*r}function Eb(t){var e=t._,n=t.next._,r=e.r+n.r,i=(e.x*n.r+n.x*e.r)/r,o=(e.y*n.r+n.y*e.r)/r;return i*i+o*o}function Sb(t){this._=t,this.next=null,this.previous=null}function Tb(t){if("function"!=typeof t)throw new Error;return t}function Ab(){return 0}var kb=function(t){return function(){return t}};function Cb(t){return Math.sqrt(t.value)}function Rb(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function Db(t,e){return function(n){if(r=n.children){var r,i,o,a=r.length,s=t(n)*e||0;if(s)for(i=0;i<a;++i)r[i].r+=s;if(o=function(t){if(!(i=t.length))return 0;var e,n,r,i,o,a,s,u,c,l,h;if((e=t[0]).x=0,e.y=0,!(i>1))return e.r;if(e.x=-(n=t[1]).r,n.x=e.r,n.y=0,!(i>2))return e.r+n.r;_b(n,e,r=t[2]),e=new Sb(e),n=new Sb(n),r=new Sb(r),e.next=r.previous=n,n.next=e.previous=r,r.next=n.previous=e;t:for(s=3;s<i;++s){_b(e._,n._,r=t[s]),r=new Sb(r),u=n.next,c=e.previous,l=n._.r,h=e._.r;do{if(l<=h){if(Mb(u._,r._)){e.next=n=u,n.previous=e,--s;continue t}l+=u._.r,u=u.next}else{if(Mb(c._,r._)){(e=c).next=n,n.previous=e,--s;continue t}h+=c._.r,c=c.previous}}while(u!==c.next);for(r.previous=e,r.next=n,e.next=n.previous=n=r,o=Eb(e);(r=r.next)!==n;)(a=Eb(r))<o&&(e=r,o=a);n=e.next}for(e=[n._],r=n;(r=r.next)!==n;)e.push(r._);for(r=pb(e),s=0;s<i;++s)(e=t[s]).x-=r.x,e.y-=r.y;return r.r}(r),s)for(i=0;i<a;++i)r[i].r-=s;n.r=o+s}}}function Lb(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}var Ob=function(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)},Pb=function(t,e,n,r,i){for(var o,a=t.children,s=-1,u=a.length,c=t.value&&(r-e)/t.value;++s<u;)(o=a[s]).y0=n,o.y1=i,o.x0=e,o.x1=e+=o.value*c},Ib="$",Nb={depth:-1},Fb={};function jb(t){return t.id}function zb(t){return t.parentId}function Ub(t,e){return t.parent===e.parent?1:2}function Vb(t){var e=t.children;return e?e[0]:t.t}function Bb(t){var e=t.children;return e?e[e.length-1]:t.t}function Hb(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}Hb.prototype=Object.create(fb.prototype);var qb=function(t,e,n,r,i){for(var o,a=t.children,s=-1,u=a.length,c=t.value&&(i-n)/t.value;++s<u;)(o=a[s]).x0=e,o.x1=r,o.y0=n,o.y1=n+=o.value*c},Gb=(1+Math.sqrt(5))/2;function Wb(t,e,n,r,i,o){for(var a,s,u,c,l,h,f,d,p,m,g,v=[],y=e.children,w=0,b=0,x=y.length,_=e.value;w<x;){u=i-n,c=o-r;do{l=y[b++].value}while(!l&&b<x);for(h=f=l,g=l*l*(m=Math.max(c/u,u/c)/(_*t)),p=Math.max(f/g,g/h);b<x;++b){if(l+=s=y[b].value,s<h&&(h=s),s>f&&(f=s),g=l*l*m,(d=Math.max(f/g,g/h))>p){l-=s;break}p=d}v.push(a={value:l,dice:u<c,children:y.slice(w,b)}),a.dice?Pb(a,n,r,i,_?r+=c*l/_:o):qb(a,n,r,_?n+=u*l/_:i,o),_-=l,w=b}return v}var Yb=function t(e){function n(t,n,r,i,o){Wb(e,t,n,r,i,o)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(Gb),Xb=function t(e){function n(t,n,r,i,o){if((a=t._squarify)&&a.ratio===e)for(var a,s,u,c,l,h=-1,f=a.length,d=t.value;++h<f;){for(u=(s=a[h]).children,c=s.value=0,l=u.length;c<l;++c)s.value+=u[c].value;s.dice?Pb(s,n,r,i,r+=(o-r)*s.value/d):qb(s,n,r,n+=(i-n)*s.value/d,o),d-=s.value}else t._squarify=a=Wb(e,t,n,r,i,o),a.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(Gb);function $b(t){Ir.call(this,null,t)}function Qb(t){return t.values}function Jb(t){Ir.call(this,null,t)}$b.Definition={type:"Nest",metadata:{treesource:!0,source:!0,generates:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"key",type:"field"},{name:"generate",type:"boolean"}]},H($b,Ir).transform=function(t,e){e.source||i("Nest transform requires an upstream data source.");var n,r,o,a=t.key||ct,s=t.generate,u=t.modified(),c=s||u?e.fork(e.ALL):e;return(!this.value||u||e.changed())&&(s&&this.value&&(c.materialize(c.REM),this.value.each(function(t){t.children&&c.rem.push(t)})),n=P(t.keys).reduce(function(t,e){return t.key(e),t},function(){var t,e,n,r=[],i=[];function o(n,i,a,s){if(i>=r.length)return null!=t&&n.sort(t),null!=e?e(n):n;for(var u,c,l,h=-1,f=n.length,d=r[i++],p=Dt(),m=a();++h<f;)(l=p.get(u=d(c=n[h])+""))?l.push(c):p.set(u,[c]);return p.each(function(t,e){s(m,e,o(t,i,a,s))}),m}return n={object:function(t){return o(t,0,Lt,Ot)},map:function(t){return o(t,0,Pt,It)},entries:function(t){return function t(n,o){if(++o>r.length)return n;var a,s=i[o-1];return null!=e&&o>=r.length?a=n.entries():(a=[],n.each(function(e,n){a.push({key:n,values:t(e,o)})})),null!=s?a.sort(function(t,e){return s(t.key,e.key)}):a}(o(t,0,Pt,It),0)},key:function(t){return r.push(t),n},sortKeys:function(t){return i[r.length-1]=t,n},sortValues:function(e){return t=e,n},rollup:function(t){return e=t,n}}}()).entries(e.source),this.value=r=ub({values:n},Qb),s&&(c.materialize(c.ADD),c.source=c.source.slice(),r.each(function(t){t.children&&(t=ht(t.data),c.add.push(t),c.source.push(t))})),o=r.lookup={},r.each(function(t){null!=ct(t.data)&&(o[a(t.data)]=t)})),c.source.root=this.value,c},H(Jb,Ir).transform=function(t,e){e.source&&e.source.root||i(this.constructor.name+" transform requires a backing tree data source.");var n=this.layout(t.method),r=this.fields,o=e.source.root,a=t.as||r;t.field&&o.sum(t.field),t.sort&&o.sort(t.sort),function(t,e,n){for(var r,i=0,o=e.length;i<o;++i)(r=e[i])in n&&t[r](n[r])}(n,this.params,t);try{this.value=n(o)}catch(t){i(t)}return o.each(function(t){!function(t,e,n){for(var r=t.data,i=0,o=e.length-1;i<o;++i)r[n[i]]=t[e[i]];r[n[o]]=t.children?t.children.length:0}(t,r,a)}),e.reflow(t.modified()).modifies(a).modifies("leaf")};var Zb=["x","y","r","depth","children"];function Kb(t){Jb.call(this,t)}Kb.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:3,default:Zb}]};var tx=H(Kb,Jb);tx.layout=function(){var t=null,e=1,n=1,r=Ab;function i(i){return i.x=e/2,i.y=n/2,t?i.eachBefore(Rb(t)).eachAfter(Db(r,.5)).eachBefore(Lb(1)):i.eachBefore(Rb(Cb)).eachAfter(Db(Ab,1)).eachAfter(Db(r,i.r/Math.min(e,n))).eachBefore(Lb(Math.min(e,n)/(2*i.r))),i}return i.radius=function(e){return arguments.length?(t=null==(n=e)?null:Tb(n),i):t;var n},i.size=function(t){return arguments.length?(e=+t[0],n=+t[1],i):[e,n]},i.padding=function(t){return arguments.length?(r="function"==typeof t?t:kb(+t),i):r},i},tx.params=["size","padding"],tx.fields=Zb;var ex=["x0","y0","x1","y1","depth","children"];function nx(t){Jb.call(this,t)}nx.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:4,default:ex}]};var rx=H(nx,Jb);function ix(t){Ir.call(this,null,t)}rx.layout=function(){var t=1,e=1,n=0,r=!1;function i(i){var o,a,s=i.height+1;return i.x0=i.y0=n,i.x1=t,i.y1=e/s,i.eachBefore((o=e,a=s,function(t){t.children&&Pb(t,t.x0,o*(t.depth+1)/a,t.x1,o*(t.depth+2)/a);var e=t.x0,r=t.y0,i=t.x1-n,s=t.y1-n;i<e&&(e=i=(e+i)/2),s<r&&(r=s=(r+s)/2),t.x0=e,t.y0=r,t.x1=i,t.y1=s})),r&&i.eachBefore(Ob),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(n){return arguments.length?(t=+n[0],e=+n[1],i):[t,e]},i.padding=function(t){return arguments.length?(n=+t,i):n},i},rx.params=["size","round","padding"],rx.fields=ex,ix.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},H(ix,Ir).transform=function(t,e){e.source||i("Stratify transform requires an upstream data source.");var n,r,o=t.modified();return(!this.value||o||e.changed(e.ADD_REM)||e.modified(t.key.fields)||e.modified(t.parentKey.fields))&&(n=function(){var t=jb,e=zb;function n(n){var r,i,o,a,s,u,c,l=n.length,h=new Array(l),f={};for(i=0;i<l;++i)s=h[i]=new fb(r=n[i]),null!=(u=t(r,i,n))&&(u+="")&&(f[c=Ib+(s.id=u)]=c in f?Fb:s);for(i=0;i<l;++i)if(s=h[i],null!=(u=e(n[i],i,n))&&(u+="")){if(!(a=f[Ib+u]))throw new Error("missing: "+u);if(a===Fb)throw new Error("ambiguous: "+u);a.children?a.children.push(s):a.children=[s],s.parent=a}else{if(o)throw new Error("multiple roots");o=s}if(!o)throw new Error("no root");if(o.parent=Nb,o.eachBefore(function(t){t.depth=t.parent.depth+1,--l}).eachBefore(hb),o.parent=null,l>0)throw new Error("cycle");return o}return n.id=function(e){return arguments.length?(t=Tb(e),n):t},n.parentId=function(t){return arguments.length?(e=Tb(t),n):e},n}().id(t.key).parentId(t.parentKey)(e.source),r=n.lookup={},n.each(function(e){r[t.key(e.data)]=e}),this.value=n),e.source.root=this.value,o?e.fork(e.ALL):e};var ox={tidy:function(){var t=Ub,e=1,n=1,r=null;function i(i){var u=function(t){for(var e,n,r,i,o,a=new Hb(t,0),s=[a];e=s.pop();)if(r=e._.children)for(e.children=new Array(o=r.length),i=o-1;i>=0;--i)s.push(n=e.children[i]=new Hb(r[i],i)),n.parent=e;return(a.parent=new Hb(null,0)).children=[a],a}(i);if(u.eachAfter(o),u.parent.m=-u.z,u.eachBefore(a),r)i.eachBefore(s);else{var c=i,l=i,h=i;i.eachBefore(function(t){t.x<c.x&&(c=t),t.x>l.x&&(l=t),t.depth>h.depth&&(h=t)});var f=c===l?1:t(c,l)/2,d=f-c.x,p=e/(l.x+f+d),m=n/(h.depth||1);i.eachBefore(function(t){t.x=(t.x+d)*p,t.y=t.depth*m})}return i}function o(e){var n=e.children,r=e.parent.children,i=e.i?r[e.i-1]:null;if(n){!function(t){for(var e,n=0,r=0,i=t.children,o=i.length;--o>=0;)(e=i[o]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}(e);var o=(n[0].z+n[n.length-1].z)/2;i?(e.z=i.z+t(e._,i._),e.m=e.z-o):e.z=o}else i&&(e.z=i.z+t(e._,i._));e.parent.A=function(e,n,r){if(n){for(var i,o=e,a=e,s=n,u=o.parent.children[0],c=o.m,l=a.m,h=s.m,f=u.m;s=Bb(s),o=Vb(o),s&&o;)u=Vb(u),(a=Bb(a)).a=e,(i=s.z+h-o.z-c+t(s._,o._))>0&&(d=(v=s).a.parent===e.parent?v.a:r,g=(m=i)/((p=e).i-d.i),p.c-=g,p.s+=m,d.c+=g,p.z+=m,p.m+=m,c+=i,l+=i),h+=s.m,c+=o.m,f+=u.m,l+=a.m;s&&!Bb(a)&&(a.t=s,a.m+=h-l),o&&!Vb(u)&&(u.t=o,u.m+=c-f,r=e)}var d,p,m,g,v;return r}(e,i,e.parent.A||r[0])}function a(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function s(t){t.x*=e,t.y=t.depth*n}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i},cluster:function(){var t=ib,e=1,n=1,r=!1;function i(i){var o,a=0;i.eachAfter(function(e){var n,r=e.children;r?(e.x=(n=r).reduce(ob,0)/n.length,e.y=1+r.reduce(ab,0)):(e.x=o?a+=t(e,o):0,e.y=0,o=e)});var s=function(t){for(var e;e=t.children;)t=e[0];return t}(i),u=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(i),c=s.x-t(s,u)/2,l=u.x+t(u,s)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*e,t.y=(i.y-t.y)*n}:function(t){t.x=(t.x-c)/(l-c)*e,t.y=(1-(i.y?t.y/i.y:1))*n})}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i}},ax=["x","y","depth","children"];function sx(t){Jb.call(this,t)}sx.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:4,default:ax}]};var ux=H(sx,Jb);function cx(t){Ir.call(this,{},t)}ux.layout=function(t){var e=t||"tidy";if(ox.hasOwnProperty(e))return ox[e]();i("Unrecognized Tree layout method: "+e)},ux.params=["size","nodeSize","separation"],ux.fields=ax,cx.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[{name:"key",type:"field"}]},H(cx,Ir).transform=function(t,e){e.source&&e.source.root||i("TreeLinks transform requires a backing tree data source.");var n=e.source.root.lookup,r=this.value,o=t.key||ct,a={},s=e.fork();function u(t){var e=r[t];e&&(a[t]=1,s.mod.push(e))}return e.visit(e.REM,function(t){var e=o(t),n=r[e];n&&(delete r[e],s.rem.push(n))}),e.visit(e.ADD,function(t){var e,i,u,c=o(t);(e=(i=n[c]).parent&&(u=i.parent.data)&&null!=ct(u)&&u)&&(s.add.push(r[c]=ht({source:e,target:t})),a[c]=1)}),e.visit(e.MOD,function(t){var e=o(t),r=n[e].children;if(u(e),r)for(var i=0,s=r.length;i<s;++i)a[e=o(r[i].data)]||u(e)}),s};var lx={binary:function(t,e,n,r,i){var o,a,s=t.children,u=s.length,c=new Array(u+1);for(c[0]=a=o=0;o<u;++o)c[o+1]=a+=s[o].value;!function t(e,n,r,i,o,a,u){if(e>=n-1){var l=s[e];return l.x0=i,l.y0=o,l.x1=a,void(l.y1=u)}for(var h=c[e],f=r/2+h,d=e+1,p=n-1;d<p;){var m=d+p>>>1;c[m]<f?d=m+1:p=m}f-c[d-1]<c[d]-f&&e+1<d&&--d;var g=c[d]-h,v=r-g;if(a-i>u-o){var y=(i*v+a*g)/r;t(e,d,g,i,o,y,u),t(d,n,v,y,o,a,u)}else{var w=(o*v+u*g)/r;t(e,d,g,i,o,a,w),t(d,n,v,i,w,a,u)}}(0,u,t.value,e,n,r,i)},dice:Pb,slice:qb,slicedice:function(t,e,n,r,i){(1&t.depth?qb:Pb)(t,e,n,r,i)},squarify:Yb,resquarify:Xb},hx=["x0","y0","x1","y1","depth","children"];function fx(t){Jb.call(this,t)}fx.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:4,default:hx}]};var dx=H(fx,Jb);dx.layout=function(){var t=function(){var t=Yb,e=!1,n=1,r=1,i=[0],o=Ab,a=Ab,s=Ab,u=Ab,c=Ab;function l(t){return t.x0=t.y0=0,t.x1=n,t.y1=r,t.eachBefore(h),i=[0],e&&t.eachBefore(Ob),t}function h(e){var n=i[e.depth],r=e.x0+n,l=e.y0+n,h=e.x1-n,f=e.y1-n;h<r&&(r=h=(r+h)/2),f<l&&(l=f=(l+f)/2),e.x0=r,e.y0=l,e.x1=h,e.y1=f,e.children&&(n=i[e.depth+1]=o(e)/2,r+=c(e)-n,l+=a(e)-n,h-=s(e)-n,f-=u(e)-n,h<r&&(r=h=(r+h)/2),f<l&&(l=f=(l+f)/2),t(e,r,l,h,f))}return l.round=function(t){return arguments.length?(e=!!t,l):e},l.size=function(t){return arguments.length?(n=+t[0],r=+t[1],l):[n,r]},l.tile=function(e){return arguments.length?(t=Tb(e),l):t},l.padding=function(t){return arguments.length?l.paddingInner(t).paddingOuter(t):l.paddingInner()},l.paddingInner=function(t){return arguments.length?(o="function"==typeof t?t:kb(+t),l):o},l.paddingOuter=function(t){return arguments.length?l.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):l.paddingTop()},l.paddingTop=function(t){return arguments.length?(a="function"==typeof t?t:kb(+t),l):a},l.paddingRight=function(t){return arguments.length?(s="function"==typeof t?t:kb(+t),l):s},l.paddingBottom=function(t){return arguments.length?(u="function"==typeof t?t:kb(+t),l):u},l.paddingLeft=function(t){return arguments.length?(c="function"==typeof t?t:kb(+t),l):c},l}();return t.ratio=function(e){var n=t.tile();n.ratio&&t.tile(n.ratio(e))},t.method=function(e){lx.hasOwnProperty(e)?t.tile(lx[e]):i("Unrecognized Treemap layout method: "+e)},t},dx.params=["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],dx.fields=hx;var px=Object.freeze({nest:$b,pack:Kb,partition:nx,stratify:ix,tree:sx,treelinks:cx,treemap:fx}),mx=function(t){return function(){return t}};function gx(t){return t[0]}function vx(t){return t[1]}function yx(){this._=null}function wx(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function bx(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function xx(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function _x(t){for(;t.L;)t=t.L;return t}function Mx(t,e,n,r){var i=[null,null],o=Hx.push(i)-1;return i.left=t,i.right=e,n&&Sx(i,t,e,n),r&&Sx(i,e,t,r),Vx[t.index].halfedges.push(o),Vx[e.index].halfedges.push(o),i}function Ex(t,e,n){var r=[e,n];return r.left=t,r}function Sx(t,e,n,r){t[0]||t[1]?t.left===n?t[1]=r:t[0]=r:(t[0]=r,t.left=e,t.right=n)}function Tx(t,e,n,r,i){var o,a=t[0],s=t[1],u=a[0],c=a[1],l=0,h=1,f=s[0]-u,d=s[1]-c;if(o=e-u,f||!(o>0)){if(o/=f,f<0){if(o<l)return;o<h&&(h=o)}else if(f>0){if(o>h)return;o>l&&(l=o)}if(o=r-u,f||!(o<0)){if(o/=f,f<0){if(o>h)return;o>l&&(l=o)}else if(f>0){if(o<l)return;o<h&&(h=o)}if(o=n-c,d||!(o>0)){if(o/=d,d<0){if(o<l)return;o<h&&(h=o)}else if(d>0){if(o>h)return;o>l&&(l=o)}if(o=i-c,d||!(o<0)){if(o/=d,d<0){if(o>h)return;o>l&&(l=o)}else if(d>0){if(o<l)return;o<h&&(h=o)}return!(l>0||h<1)||(l>0&&(t[0]=[u+l*f,c+l*d]),h<1&&(t[1]=[u+h*f,c+h*d]),!0)}}}}}function Ax(t,e,n,r,i){var o=t[1];if(o)return!0;var a,s,u=t[0],c=t.left,l=t.right,h=c[0],f=c[1],d=l[0],p=l[1],m=(h+d)/2,g=(f+p)/2;if(p===f){if(m<e||m>=r)return;if(h>d){if(u){if(u[1]>=i)return}else u=[m,n];o=[m,i]}else{if(u){if(u[1]<n)return}else u=[m,i];o=[m,n]}}else if(s=g-(a=(h-d)/(p-f))*m,a<-1||a>1)if(h>d){if(u){if(u[1]>=i)return}else u=[(n-s)/a,n];o=[(i-s)/a,i]}else{if(u){if(u[1]<n)return}else u=[(i-s)/a,i];o=[(n-s)/a,n]}else if(f<p){if(u){if(u[0]>=r)return}else u=[e,a*e+s];o=[r,a*r+s]}else{if(u){if(u[0]<e)return}else u=[r,a*r+s];o=[e,a*e+s]}return t[0]=u,t[1]=o,!0}function kx(t,e){return e[+(e.left!==t.site)]}yx.prototype={constructor:yx,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=_x(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(r=n.U).L?(i=r.R)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(bx(this,n),n=(t=n).U),n.C=!1,r.C=!0,xx(this,r)):(i=r.L)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(xx(this,n),n=(t=n).U),n.C=!1,r.C=!0,bx(this,r)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,i=t.U,o=t.L,a=t.R;if(n=o?a?_x(a):o:a,i?i.L===t?i.L=n:i.R=n:this._=n,o&&a?(r=n.C,n.C=t.C,n.L=o,o.U=n,n!==a?(i=n.U,n.U=t.U,i.L=t=n.R,n.R=a,a.U=n):(n.U=i,i=n,t=n.R)):(r=t.C,t=n),t&&(t.U=i),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((e=i.R).C&&(e.C=!1,i.C=!0,bx(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,xx(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,bx(this,i),t=this._;break}}else if((e=i.L).C&&(e.C=!1,i.C=!0,xx(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,bx(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,xx(this,i),t=this._;break}e.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}};var Cx,Rx=[];function Dx(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,i=t.site,o=n.site;if(r!==o){var a=i[0],s=i[1],u=r[0]-a,c=r[1]-s,l=o[0]-a,h=o[1]-s,f=2*(u*h-c*l);if(!(f>=-Gx)){var d=u*u+c*c,p=l*l+h*h,m=(h*d-c*p)/f,g=(u*p-l*d)/f,v=Rx.pop()||new function(){wx(this),this.x=this.y=this.arc=this.site=this.cy=null};v.arc=t,v.site=i,v.x=m+a,v.y=(v.cy=g+s)+Math.sqrt(m*m+g*g),t.circle=v;for(var y=null,w=Bx._;w;)if(v.y<w.y||v.y===w.y&&v.x<=w.x){if(!w.L){y=w.P;break}w=w.L}else{if(!w.R){y=w;break}w=w.R}Bx.insert(y,v),y||(Cx=v)}}}}function Lx(t){var e=t.circle;e&&(e.P||(Cx=e.N),Bx.remove(e),Rx.push(e),wx(e),t.circle=null)}var Ox=[];function Px(t){var e=Ox.pop()||new function(){wx(this),this.edge=this.site=this.circle=null};return e.site=t,e}function Ix(t){Lx(t),Ux.remove(t),Ox.push(t),wx(t)}function Nx(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],o=t.P,a=t.N,s=[t];Ix(t);for(var u=o;u.circle&&Math.abs(n-u.circle.x)<qx&&Math.abs(r-u.circle.cy)<qx;)o=u.P,s.unshift(u),Ix(u),u=o;s.unshift(u),Lx(u);for(var c=a;c.circle&&Math.abs(n-c.circle.x)<qx&&Math.abs(r-c.circle.cy)<qx;)a=c.N,s.push(c),Ix(c),c=a;s.push(c),Lx(c);var l,h=s.length;for(l=1;l<h;++l)Sx((c=s[l]).edge,(u=s[l-1]).site,c.site,i);(c=s[h-1]).edge=Mx((u=s[0]).site,c.site,null,i),Dx(u),Dx(c)}function Fx(t){for(var e,n,r,i,o,a=t[0],s=t[1],u=Ux._;u;)if((r=jx(u,s)-a)>qx)u=u.L;else{if(!((i=a-zx(u,s))>qx)){r>-qx?(e=u.P,n=u):i>-qx?(e=u,n=u.N):e=n=u;break}if(!u.R){e=u;break}u=u.R}Vx[(o=t).index]={site:o,halfedges:[]};var c=Px(t);if(Ux.insert(e,c),e||n){if(e===n)return Lx(e),n=Px(e.site),Ux.insert(c,n),c.edge=n.edge=Mx(e.site,c.site),Dx(e),void Dx(n);if(n){Lx(e),Lx(n);var l=e.site,h=l[0],f=l[1],d=t[0]-h,p=t[1]-f,m=n.site,g=m[0]-h,v=m[1]-f,y=2*(d*v-p*g),w=d*d+p*p,b=g*g+v*v,x=[(v*w-p*b)/y+h,(d*b-g*w)/y+f];Sx(n.edge,l,m,x),c.edge=Mx(l,t,null,x),n.edge=Mx(t,m,null,x),Dx(e),Dx(n)}else c.edge=Mx(e.site,c.site)}}function jx(t,e){var n=t.site,r=n[0],i=n[1],o=i-e;if(!o)return r;var a=t.P;if(!a)return-1/0;var s=(n=a.site)[0],u=n[1],c=u-e;if(!c)return s;var l=s-r,h=1/o-1/c,f=l/c;return h?(-f+Math.sqrt(f*f-2*h*(l*l/(-2*c)-u+c/2+i-o/2)))/h+r:(r+s)/2}function zx(t,e){var n=t.N;if(n)return jx(n,e);var r=t.site;return r[1]===e?r[0]:1/0}var Ux,Vx,Bx,Hx,qx=1e-6,Gx=1e-12;function Wx(t,e){return e[1]-t[1]||e[0]-t[0]}function Yx(t,e){var n,r,i,o=t.sort(Wx).pop();for(Hx=[],Vx=new Array(t.length),Ux=new yx,Bx=new yx;;)if(i=Cx,o&&(!i||o[1]<i.y||o[1]===i.y&&o[0]<i.x))o[0]===n&&o[1]===r||(Fx(o),n=o[0],r=o[1]),o=t.pop();else{if(!i)break;Nx(i.arc)}if(function(){for(var t,e,n,r,i=0,o=Vx.length;i<o;++i)if((t=Vx[i])&&(r=(e=t.halfedges).length)){var a=new Array(r),s=new Array(r);for(n=0;n<r;++n)a[n]=n,s[n]=(l=void 0,h=void 0,l=(u=Hx[e[n]]).left,(c=t.site)===(h=u.right)&&(h=l,l=c),h?Math.atan2(h[1]-l[1],h[0]-l[0]):(c===l?(l=u[1],h=u[0]):(l=u[0],h=u[1]),Math.atan2(l[0]-h[0],h[1]-l[1])));for(a.sort(function(t,e){return s[e]-s[t]}),n=0;n<r;++n)s[n]=e[a[n]];for(n=0;n<r;++n)e[n]=s[n]}var u,c,l,h}(),e){var a=+e[0][0],s=+e[0][1],u=+e[1][0],c=+e[1][1];!function(t,e,n,r){for(var i,o=Hx.length;o--;)Ax(i=Hx[o],t,e,n,r)&&Tx(i,t,e,n,r)&&(Math.abs(i[0][0]-i[1][0])>qx||Math.abs(i[0][1]-i[1][1])>qx)||delete Hx[o]}(a,s,u,c),function(t,e,n,r){var i,o,a,s,u,c,l,h,f,d,p,m,g,v=Vx.length,y=!0;for(i=0;i<v;++i)if(o=Vx[i]){for(a=o.site,s=(u=o.halfedges).length;s--;)Hx[u[s]]||u.splice(s,1);for(s=0,c=u.length;s<c;)p=(d=(g=Hx[u[s]])[+(g.left===o.site)])[0],m=d[1],h=(l=kx(o,Hx[u[++s%c]]))[0],f=l[1],(Math.abs(p-h)>qx||Math.abs(m-f)>qx)&&(u.splice(s,0,Hx.push(Ex(a,d,Math.abs(p-t)<qx&&r-m>qx?[t,Math.abs(h-t)<qx?f:r]:Math.abs(m-r)<qx&&n-p>qx?[Math.abs(f-r)<qx?h:n,r]:Math.abs(p-n)<qx&&m-e>qx?[n,Math.abs(h-n)<qx?f:e]:Math.abs(m-e)<qx&&p-t>qx?[Math.abs(f-e)<qx?h:t,e]:null))-1),++c);c&&(y=!1)}if(y){var w,b,x,_=1/0;for(i=0,y=null;i<v;++i)(o=Vx[i])&&(x=(w=(a=o.site)[0]-t)*w+(b=a[1]-e)*b)<_&&(_=x,y=o);if(y){var M=[t,e],E=[t,r],S=[n,r],T=[n,e];y.halfedges.push(Hx.push(Ex(a=y.site,M,E))-1,Hx.push(Ex(a,E,S))-1,Hx.push(Ex(a,S,T))-1,Hx.push(Ex(a,T,M))-1)}}for(i=0;i<v;++i)(o=Vx[i])&&(o.halfedges.length||delete Vx[i])}(a,s,u,c)}this.edges=Hx,this.cells=Vx,Ux=Bx=Hx=Vx=null}function Xx(t){Ir.call(this,null,t)}Yx.prototype={constructor:Yx,polygons:function(){var t=this.edges;return this.cells.map(function(e){var n=e.halfedges.map(function(n){return kx(e,t[n])});return n.data=e.site.data,n})},triangles:function(){var t=[],e=this.edges;return this.cells.forEach(function(n,r){if(o=(i=n.halfedges).length)for(var i,o,a,s,u,c,l=n.site,h=-1,f=e[i[o-1]],d=f.left===l?f.right:f.left;++h<o;)a=d,d=(f=e[i[h]]).left===l?f.right:f.left,a&&d&&r<a.index&&r<d.index&&((s=l)[0]-(c=d)[0])*((u=a)[1]-s[1])-(s[0]-u[0])*(c[1]-s[1])<0&&t.push([l.data,a.data,d.data])}),t},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(t,e,n){for(var r,i,o=this,a=o._found||0,s=o.cells.length;!(i=o.cells[a]);)if(++a>=s)return null;var u=t-i.site[0],c=e-i.site[1],l=u*u+c*c;do{i=o.cells[r=a],a=null,i.halfedges.forEach(function(n){var r=o.edges[n],s=r.left;if(s!==i.site&&s||(s=r.right)){var u=t-s[0],c=e-s[1],h=u*u+c*c;h<l&&(l=h,a=s.index)}})}while(null!==a);return o._found=r,null==n||l<=n*n?i.site:null}},Xx.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};var $x=[[-1e5,-1e5],[1e5,1e5]];H(Xx,Ir).transform=function(t,e){var n,r,i,o,a=t.as||"path",s=e.source;for(n=function(){var t=gx,e=vx,n=null;function r(r){return new Yx(r.map(function(n,i){var o=[Math.round(t(n,i,r)/qx)*qx,Math.round(e(n,i,r)/qx)*qx];return o.index=i,o.data=n,o}),n)}return r.polygons=function(t){return r(t).polygons()},r.links=function(t){return r(t).links()},r.triangles=function(t){return r(t).triangles()},r.x=function(e){return arguments.length?(t="function"==typeof e?e:mx(+e),r):t},r.y=function(t){return arguments.length?(e="function"==typeof t?t:mx(+t),r):e},r.extent=function(t){return arguments.length?(n=null==t?null:[[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]],r):n&&[[n[0][0],n[0][1]],[n[1][0],n[1][1]]]},r.size=function(t){return arguments.length?(n=null==t?null:[[0,0],[+t[0],+t[1]]],r):n&&[n[1][0]-n[0][0],n[1][1]-n[0][1]]},r}().x(t.x).y(t.y),t.size?n.size(t.size):n.extent(t.extent||$x),this.value=n=n(s),r=n.polygons(),i=0,o=s.length;i<o;++i)s[i][a]=r[i]?"M"+r[i].join("L")+"Z":null;return e.reflow(t.modified()).modifies(a)};var Qx=Object.freeze({voronoi:Xx}),Jx=Math.PI/180,Zx=64,Kx=2048,t_=function(){var t,e,n,r,i,o,a,s=[256,256],u=i_,c=[],l=Math.random,h={};function f(t,e,n){for(var r,i,o,a,c,h=e.x,f=e.y,d=Math.sqrt(s[0]*s[0]+s[1]*s[1]),p=u(s),m=l()<.5?1:-1,g=-m;(r=p(g+=m))&&(i=~~r[0],o=~~r[1],!(Math.min(Math.abs(i),Math.abs(o))>=d));)if(e.x=h+i,e.y=f+o,!(e.x+e.x0<0||e.y+e.y0<0||e.x+e.x1>s[0]||e.y+e.y1>s[1]||n&&n_(e,t,s[0])||n&&(c=n,!((a=e).x+a.x1>c[0].x&&a.x+a.x0<c[1].x&&a.y+a.y1>c[0].y&&a.y+a.y0<c[1].y)))){for(var v,y=e.sprite,w=e.width>>5,b=s[0]>>5,x=e.x-(w<<4),_=127&x,M=32-_,E=e.y1-e.y0,S=(e.y+e.y0)*b+(x>>5),T=0;T<E;T++){v=0;for(var A=0;A<=w;A++)t[S+A]|=v<<M|(A<w?(v=y[T*w+A])>>>_:0);S+=b}return e.sprite=null,!0}return!1}return h.layout=function(){for(var u=function(t){t.width=t.height=1;var e=Math.sqrt(t.getContext("2d").getImageData(0,0,1,1).data.length>>2);t.width=(Zx<<5)/e,t.height=Kx/e;var n=t.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:e}}(Fo()),h=function(t){for(var e=[],n=-1;++n<t;)e[n]=0;return e}((s[0]>>5)*s[1]),d=null,p=c.length,m=-1,g=[],v=c.map(function(s){return{text:t(s),font:e(s),style:r(s),weight:i(s),rotate:o(s),size:~~n(s),padding:a(s),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:s}}).sort(function(t,e){return e.size-t.size});++m<p;){var y=v[m];y.x=s[0]*(l()+.5)>>1,y.y=s[1]*(l()+.5)>>1,e_(u,y,v,m),y.hasText&&f(h,y,d)&&(g.push(y),d?r_(d,y):d=[{x:y.x+y.x0,y:y.y+y.y0},{x:y.x+y.x1,y:y.y+y.y1}],y.x-=s[0]>>1,y.y-=s[1]>>1)}return g},h.words=function(t){return arguments.length?(c=t,h):c},h.size=function(t){return arguments.length?(s=[+t[0],+t[1]],h):s},h.font=function(t){return arguments.length?(e=o_(t),h):e},h.fontStyle=function(t){return arguments.length?(r=o_(t),h):r},h.fontWeight=function(t){return arguments.length?(i=o_(t),h):i},h.rotate=function(t){return arguments.length?(o=o_(t),h):o},h.text=function(e){return arguments.length?(t=o_(e),h):t},h.spiral=function(t){return arguments.length?(u=a_[t]||t,h):u},h.fontSize=function(t){return arguments.length?(n=o_(t),h):n},h.padding=function(t){return arguments.length?(a=o_(t),h):a},h.random=function(t){return arguments.length?(l=t,h):l},h};function e_(t,e,n,r){if(!e.sprite){var i=t.context,o=t.ratio;i.clearRect(0,0,(Zx<<5)/o,Kx/o);var a,s,u,c,l,h=0,f=0,d=0,p=n.length;for(--r;++r<p;){if(e=n[r],i.save(),i.font=e.style+" "+e.weight+" "+~~((e.size+1)/o)+"px "+e.font,a=i.measureText(e.text+"m").width*o,u=e.size<<1,e.rotate){var m=Math.sin(e.rotate*Jx),g=Math.cos(e.rotate*Jx),v=a*g,y=a*m,w=u*g,b=u*m;a=Math.max(Math.abs(v+b),Math.abs(v-b))+31>>5<<5,u=~~Math.max(Math.abs(y+w),Math.abs(y-w))}else a=a+31>>5<<5;if(u>d&&(d=u),h+a>=Zx<<5&&(h=0,f+=d,d=0),f+u>=Kx)break;i.translate((h+(a>>1))/o,(f+(u>>1))/o),e.rotate&&i.rotate(e.rotate*Jx),i.fillText(e.text,0,0),e.padding&&(i.lineWidth=2*e.padding,i.strokeText(e.text,0,0)),i.restore(),e.width=a,e.height=u,e.xoff=h,e.yoff=f,e.x1=a>>1,e.y1=u>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,h+=a}for(var x=i.getImageData(0,0,(Zx<<5)/o,Kx/o).data,_=[];--r>=0;)if((e=n[r]).hasText){for(s=(a=e.width)>>5,u=e.y1-e.y0,c=0;c<u*s;c++)_[c]=0;if(null==(h=e.xoff))return;f=e.yoff;var M=0,E=-1;for(l=0;l<u;l++){for(c=0;c<a;c++){var S=x[(f+l)*(Zx<<5)+(h+c)<<2]?1<<31-c%32:0;_[s*l+(c>>5)]|=S,M|=S}M?E=l:(e.y0++,u--,l--,f++)}e.y1=e.y0+E,e.sprite=_.slice(0,(e.y1-e.y0)*s)}}}function n_(t,e,n){for(var r,i=t.sprite,o=t.width>>5,a=t.x-(o<<4),s=127&a,u=32-s,c=t.y1-t.y0,l=(t.y+t.y0)*(n>>=5)+(a>>5),h=0;h<c;h++){r=0;for(var f=0;f<=o;f++)if((r<<u|(f<o?(r=i[h*o+f])>>>s:0))&e[l+f])return!0;l+=n}return!1}function r_(t,e){var n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}function i_(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function o_(t){return"function"==typeof t?t:function(){return t}}var a_={archimedean:i_,rectangular:function(t){var e=4*t[0]/t[1],n=0,r=0;return function(t){var i=t<0?-1:1;switch(Math.sqrt(1+4*i*t)-i&3){case 0:n+=e;break;case 1:r+=4;break;case 2:n-=e;break;default:r-=4}return[n,r]}}},s_=["x","y","font","fontSize","fontStyle","fontWeight","angle"],u_=["text","font","rotate","fontSize","fontStyle","fontWeight"];function c_(t){Ir.call(this,t_(),t)}c_.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:s_}]},H(c_,Ir).transform=function(e,n){var r=e.modified();if(r||n.changed(n.ADD_REM)||u_.some(function(t){var r=e[t];return I(r)&&n.modified(r.fields)})){var i,o=n.materialize(n.SOURCE).source,a=this.value,s=e.as||s_,u=e.fontSize||14;if(I(u)?i=e.fontSizeRange:u=F(u),i){var c=u,l=Fd("sqrt")().domain(function(t,e){for(var n,r=1/0,i=-1/0,o=0,a=e.length;o<a;++o)(n=t(e[o]))<r&&(r=n),n>i&&(i=n);return[r,i]}(c,o)).range(i);u=function(t){return l(c(t))}}o.forEach(function(t){t[s[0]]=NaN,t[s[1]]=NaN,t[s[3]]=0});for(var h,f,d=a.words(o).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(u).random(t.random).layout(),p=a.size(),m=p[0]>>1,g=p[1]>>1,v=0,y=d.length;v<y;++v)(f=(h=d[v]).datum)[s[0]]=h.x+m,f[s[1]]=h.y+g,f[s[2]]=h.font,f[s[3]]=h.size,f[s[4]]=h.style,f[s[5]]=h.weight,f[s[6]]=h.rotate;return n.reflow(r).modifies(s)}};var l_=Object.freeze({wordcloud:c_});function h_(t){return new Uint32Array(t)}function f_(t,e,n){var r=(e<257?function(t){return new Uint8Array(t)}:e<65537?function(t){return new Uint16Array(t)}:h_)(t);return n&&r.set(n),r}var d_=function(t,e,n){var r=1<<e;return{one:r,zero:~r,range:n.slice(),bisect:t.bisect,index:t.index,size:t.size,onAdd:function(t,e){var n,i=this.bisect(this.range,t.value),o=t.index,a=i[0],s=i[1],u=o.length;for(n=0;n<a;++n)e[o[n]]|=r;for(n=s;n<u;++n)e[o[n]]|=r;return this}}};function p_(){var t=h_(0),e=[],n=0;return{insert:function(r,i,o){if(!i.length)return[];var a,s,u,c,l,h=n,f=i.length,d=Array(f),p=h_(f);for(u=0;u<f;++u)d[u]=r(i[u]),p[u]=u;if((c=d).sort.call(l=p,function(t,e){var n=c[t],r=c[e];return n<r?-1:n>r?1:0}),d=mi(c,l),h)a=e,s=t,e=Array(h+f),t=h_(h+f),function(t,e,n,r,i,o,a,s,u){var c,l=0,h=0;for(c=0;l<r&&h<a;++c)e[l]<i[h]?(s[c]=e[l],u[c]=n[l++]):(s[c]=i[h],u[c]=o[h++]+t);for(;l<r;++l,++c)s[c]=e[l],u[c]=n[l];for(;h<a;++h,++c)s[c]=i[h],u[c]=o[h]+t}(o,a,s,h,d,p,f,e,t);else{if(o>0)for(u=0;u<f;++u)p[u]+=o;e=d,t=p}return n=h+f,{index:p,value:d}},remove:function(r,i){var o,a,s,u=n;for(a=0;!i[t[a]]&&a<u;++a);for(s=a;a<u;++a)i[o=t[a]]||(t[s]=o,e[s]=e[a],++s);n=u-r},bisect:function(t,r){var i;return r?i=r.length:(r=e,i=n),[ei(r,t[0],0,i),ti(r,t[1],0,i)]},reindex:function(e){for(var r=0,i=n;r<i;++r)t[r]=e[t[r]]},index:function(){return t},size:function(){return n}}}function m_(t){var e,n,r,i,o;Ir.call(this,(e=8,n=[],r=h_(0),i=f_(0,e),o=f_(0,e),{data:function(){return n},seen:function(){return r=(t=r).length>=(e=n.length)?t:((i=i||new t.constructor(e)).set(t),i);var t,e,i},add:function(t){for(var e,r=0,i=n.length,o=t.length;r<o;++r)(e=t[r])._index=i++,n.push(e)},remove:function(t,e){var r,a,s,u=n.length,c=Array(u-t),l=n;for(a=0;!e[a]&&a<u;++a)c[a]=n[a],l[a]=a;for(s=a;a<u;++a)r=n[a],e[a]?l[a]=-1:(l[a]=s,i[s]=i[a],o[s]=o[a],c[s]=r,r._index=s++),i[a]=0;return n=c,l},size:function(){return n.length},curr:function(){return i},prev:function(){return o},reset:function(t){o[t]=i[t]},all:function(){return e<257?255:e<65537?65535:4294967295},set:function(t,e){i[t]|=e},clear:function(t,e){i[t]&=~e},resize:function(t,n){(t>i.length||n>e)&&(e=Math.max(n,e),i=f_(t,e,i),o=f_(t,e))}}),t),this._indices=null,this._dims=null}m_.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};var g_=H(m_,Ir);function v_(t){Ir.call(this,null,t)}g_.transform=function(t,e){return this._dims?t.modified("fields")||t.fields.some(function(t){return e.modified(t.fields)})?this.reinit(t,e):this.eval(t,e):this.init(t,e)},g_.init=function(t,e){for(var n,r,i=t.fields,o=t.query,a=this._indices={},s=this._dims=[],u=o.length,c=0;c<u;++c)r=a[n=i[c].fname]||(a[n]=p_()),s.push(d_(r,c,o[c]));return this.eval(t,e)},g_.reinit=function(t,e){var n,r,i,o,a,s,u,c,l,h=e.materialize().fork(),f=t.fields,d=t.query,p=this._indices,m=this._dims,g=this.value,v=g.curr(),y=g.prev(),w=g.all(),b=h.rem=h.add,x=h.mod,_=d.length,M={};if(y.set(v),e.rem.length&&(a=this.remove(t,e,h)),e.add.length&&g.add(e.add),e.mod.length)for(s={},u=0,c=(o=e.mod).length;u<c;++u)s[o[u]._index]=1;for(u=0;u<_;++u)l=f[u],(!m[u]||t.modified("fields",u)||e.modified(l.fields))&&((n=M[i=l.fname])||(p[i]=r=p_(),M[i]=n=r.insert(l,e.source,0)),m[u]=d_(r,u,d[u]).onAdd(n,v));for(u=0,c=g.data().length;u<c;++u)a[u]||(y[u]!==v[u]?b.push(u):s[u]&&v[u]!==w&&x.push(u));return g.mask=(1<<_)-1,h},g_.eval=function(t,e){var n=e.materialize().fork(),r=this._dims.length,i=0;return e.rem.length&&(this.remove(t,e,n),i|=(1<<r)-1),t.modified("query")&&!t.modified("fields")&&(i|=this.update(t,e,n)),e.add.length&&(this.insert(t,e,n),i|=(1<<r)-1),e.mod.length&&(this.modify(e,n),i|=(1<<r)-1),this.value.mask=i,n},g_.insert=function(t,e,n){var r,i,o,a=e.add,s=this.value,u=this._dims,c=this._indices,l=t.fields,h={},f=n.add,d=s.size(),p=d+a.length,m=u.length;s.resize(p,m),s.add(a);var g=s.curr(),v=s.prev(),y=s.all();for(r=0;r<m;++r)o=h[i=l[r].fname]||(h[i]=c[i].insert(l[r],a,d)),u[r].onAdd(o,g);for(;d<p;++d)v[d]=y,g[d]!==y&&f.push(d)},g_.modify=function(t,e){var n,r,i,o=e.mod,a=this.value,s=a.curr(),u=a.all(),c=t.mod;for(n=0,r=c.length;n<r;++n)s[i=c[n]._index]!==u&&o.push(i)},g_.remove=function(t,e,n){var r,i,o,a,s=this._indices,u=this.value,c=u.curr(),l=u.prev(),h=u.all(),f={},d=n.rem,p=e.rem;for(r=0,i=p.length;r<i;++r)f[o=p[r]._index]=1,l[o]=a=c[o],c[o]=h,a!==h&&d.push(o);for(o in s)s[o].remove(i,f);return this.reindex(e,i,f),f},g_.reindex=function(t,e,n){var r=this._indices,i=this.value;t.runAfter(function(){var t=i.remove(e,n);for(var o in r)r[o].reindex(t)})},g_.update=function(t,e,n){var r,i,o=this._dims,a=t.query,s=e.stamp,u=o.length,c=0;for(n.filters=0,i=0;i<u;++i)t.modified("query",i)&&(r=i,++c);if(1===c)c=o[r].one,this.incrementOne(o[r],a[r],n.add,n.rem);else for(i=0,c=0;i<u;++i)t.modified("query",i)&&(c|=o[i].one,this.incrementAll(o[i],a[i],s,n.add),n.rem=n.add);return c},g_.incrementAll=function(t,e,n,r){var i,o,a,s=this.value,u=s.seen(),c=s.curr(),l=s.prev(),h=t.index(),f=t.bisect(t.range),d=t.bisect(e),p=d[0],m=d[1],g=f[0],v=f[1],y=t.one;if(p<g)for(i=p,o=Math.min(g,m);i<o;++i)u[a=h[i]]!==n&&(l[a]=c[a],u[a]=n,r.push(a)),c[a]^=y;else if(p>g)for(i=g,o=Math.min(p,v);i<o;++i)u[a=h[i]]!==n&&(l[a]=c[a],u[a]=n,r.push(a)),c[a]^=y;if(m>v)for(i=Math.max(p,v),o=m;i<o;++i)u[a=h[i]]!==n&&(l[a]=c[a],u[a]=n,r.push(a)),c[a]^=y;else if(m<v)for(i=Math.max(g,m),o=v;i<o;++i)u[a=h[i]]!==n&&(l[a]=c[a],u[a]=n,r.push(a)),c[a]^=y;t.range=e.slice()},g_.incrementOne=function(t,e,n,r){var i,o,a,s=this.value.curr(),u=t.index(),c=t.bisect(t.range),l=t.bisect(e),h=l[0],f=l[1],d=c[0],p=c[1],m=t.one;if(h<d)for(i=h,o=Math.min(d,f);i<o;++i)s[a=u[i]]^=m,n.push(a);else if(h>d)for(i=d,o=Math.min(h,p);i<o;++i)s[a=u[i]]^=m,r.push(a);if(f>p)for(i=Math.max(h,p),o=f;i<o;++i)s[a=u[i]]^=m,n.push(a);else if(f<p)for(i=Math.max(d,f),o=p;i<o;++i)s[a=u[i]]^=m,r.push(a);t.range=e.slice()},v_.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},H(v_,Ir).transform=function(t,e){var n=~(t.ignore||0),r=t.filter,i=r.mask;if(0==(i&n))return e.StopPropagation;var o=e.fork(e.ALL),a=r.data(),s=r.curr(),u=r.prev(),c=function(t){return s[t]&n?null:a[t]};return o.filter(o.MOD,c),i&i-1?(o.filter(o.ADD,function(t){var e=s[t]&n;return!e&&e^u[t]&n?a[t]:null}),o.filter(o.REM,function(t){var e=s[t]&n;return!e||e^e^u[t]&n?null:a[t]})):(o.filter(o.ADD,c),o.filter(o.REM,function(t){return(s[t]&n)===i?a[t]:null})),o.filter(o.SOURCE,function(t){return c(t._index)})};var y_=Object.freeze({crossfilter:m_,resolvefilter:v_}),w_="default",b_=function(t){var e=t._signals.cursor;e||(t._signals.cursor=e=t.add({user:w_,item:null})),t.on(t.events("view","mousemove"),e,function(t,n){var r=e.value,i=r?u(r)?r:r.user:w_,o=n.item&&n.item.cursor||null;return r&&i===r.user&&o==r.item?r:{user:i,item:o}}),t.add(null,function(t){var e=t.cursor,n=this.value;return u(e)||(n=e.item,e=e.user),"undefined"!=typeof document&&document.body&&(document.body.style.cursor=e&&e!==w_?e:n||e),n},{cursor:e})};function x_(t,e){var n=t._runtime.data;return n.hasOwnProperty(e)||i("Unrecognized data set: "+e),n[e]}function __(t,e){mt(e)||i("Second argument to changes must be a changeset.");var n=x_(this,t);return n.modified=!0,this.pulse(n.input,e)}function M_(t){var e=t.padding();return Math.max(0,t._viewWidth+e.left+e.right)}function E_(t){var e=t.padding();return Math.max(0,t._viewHeight+e.top+e.bottom)}function S_(t){var e=t.padding(),n=t._origin;return[e.left+n[0],e.top+n[1]]}var T_=function(t,e,n){var r,i,o=t._renderer.scene();return o&&(i=S_(t),(r=ac(e.changedTouches?e.changedTouches[0]:e,o))[0]-=i[0],r[1]-=i[1]),e.dataflow=t,e.vega=function(t,e,n){var r=e?"group"===e.mark.marktype?e:e.mark.group:null;function i(t){var n,i=r;if(t)for(n=e;n;n=n.mark.group)if(n.mark.name===t){i=n;break}return i&&i.mark&&i.mark.interactive?i:{}}function o(t){if(!t)return n;u(t)&&(t=i(t));for(var e=n.slice();t;)e[0]-=t.x||0,e[1]-=t.y||0,t=t.mark&&t.mark.group;return e}return{view:F(t),item:F(e||{}),group:i,xy:o,x:function(t){return o(t)[0]},y:function(t){return o(t)[1]}}}(t,n,r),e.item=n,e};function A_(t){return t.item}function k_(t){var e=t.item.mark.source;return e.source||e}function C_(t){return function(e,n){return n.vega.view().changeset().encode(n.item,t)}}var R_=function(t,e,n){var r=document.createElement(t);for(var i in e)r.setAttribute(i,e[i]);return null!=n&&(r.textContent=n),r},D_="vega-bind-radio",L_="vega-option-";function O_(t,e,n,r){var i=R_("input");for(var o in n)"signal"!==o&&"element"!==o&&i.setAttribute("input"===o?"type":o,n[o]);i.setAttribute("name",n.signal),i.value=r,e.appendChild(i),i.addEventListener("input",function(){t.update(i.value)}),t.elements=[i],t.set=function(t){i.value=t}}function P_(t,e,n,r){var i={type:"checkbox",name:n.signal};r&&(i.checked=!0);var o=R_("input",i);e.appendChild(o),o.addEventListener("change",function(){t.update(o.checked)}),t.elements=[o],t.set=function(t){o.checked=!!t||null}}function I_(t,e,n,r){var i=R_("select",{name:n.signal});n.options.forEach(function(t){var e={value:t};j_(t,r)&&(e.selected=!0),i.appendChild(R_("option",e,t+""))}),e.appendChild(i),i.addEventListener("change",function(){t.update(n.options[i.selectedIndex])}),t.elements=[i],t.set=function(t){for(var e=0,r=n.options.length;e<r;++e)if(j_(n.options[e],t))return void(i.selectedIndex=e)}}function N_(t,e,n,r){var i=R_("span",{class:D_});e.appendChild(i),t.elements=n.options.map(function(e){var o=L_+n.signal+"-"+e,a={id:o,type:"radio",name:n.signal,value:e};j_(e,r)&&(a.checked=!0);var s=R_("input",a);return s.addEventListener("change",function(){t.update(e)}),i.appendChild(s),i.appendChild(R_("label",{for:o},e+"")),s}),t.set=function(e){for(var n=t.elements,r=0,i=n.length;r<i;++r)j_(n[r].value,e)&&(n[r].checked=!0)}}function F_(t,e,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;var i=n.min||Math.min(0,+r)||0,o=n.max||Math.max(100,+r)||100,a=n.step||li(i,o,100),s=R_("input",{type:"range",name:n.signal,min:i,max:o,step:a});s.value=r;var u=R_("label",{},+r);function c(){u.textContent=s.value,t.update(+s.value)}e.appendChild(s),e.appendChild(u),s.addEventListener("input",c),s.addEventListener("change",c),t.elements=[s],t.set=function(t){s.value=t,u.textContent=t}}function j_(t,e){return t===e||t+""==e+""}var z_=function(t,e,n,r,i){return(e=e||new r(t.loader())).initialize(n,M_(t),E_(t),S_(t),i).background(t._background)};function U_(t,e){if("string"==typeof e){if("undefined"==typeof document)return t.error("DOM document instance not found."),null;if(!(e=document.querySelector(e)))return t.error("Signal bind element not found: "+e),null}if(e)try{e.innerHTML=""}catch(n){e=null,t.error(n)}return e}var V_=function(t,e,n){var r=qc(e),i=r&&r.headless;return i?t.runAsync().then(function(){return z_(t,null,null,i,n).renderAsync(t._scenegraph.root)}):Promise.reject("Unrecognized renderer type: "+e)};function B_(t){return+t||0}var H_=["value","update","react","bind"];function q_(t,e){i(t+' for "outer" push: '+c(e))}var G_,W_,Y_,X_,$_=function(t,e){var n=t.name;if("outer"===t.push)e.signals[n]||q_("No prior signal definition",n),H_.forEach(function(e){void 0!==t[e]&&q_("Invalid property ",e)});else{var r=e.addSignal(n,t.value);!1===t.react&&(r.react=!1),t.bind&&e.addBinding(n,t.bind)}};function Q_(t){this.type=t}Q_.prototype.visit=function(t){var e,n,r;if(t(this))return 1;for(n=0,r=(e=function(t){switch(t.type){case"ArrayExpression":return t.elements;case"BinaryExpression":case"LogicalExpression":return[t.left,t.right];case"CallExpression":var e=t.arguments.slice();return e.unshift(t.callee),e;case"ConditionalExpression":return[t.test,t.consequent,t.alternate];case"MemberExpression":return[t.object,t.property];case"ObjectExpression":return t.properties;case"Property":return[t.key,t.value];case"UnaryExpression":return[t.argument];case"Identifier":case"Literal":case"RawCode":default:return[]}}(this)).length;n<r;++n)if(e[n].visit(t))return 1};var J_=1,Z_=2,K_=3,tM=4,eM=5,nM=6,rM=7,iM=8,oM="ArrayExpression",aM="BinaryExpression",sM="CallExpression",uM="ConditionalExpression",cM="Identifier",lM="Literal",hM="LogicalExpression",fM="MemberExpression",dM="ObjectExpression",pM="Property",mM="UnaryExpression",gM="Unexpected token %0",vM="Unexpected number",yM="Unexpected string",wM="Unexpected identifier",bM="Unexpected reserved word",xM="Unexpected end of input",_M="Invalid regular expression",MM="Invalid regular expression: missing /",EM="Octal literals are not allowed in strict mode.",SM="Duplicate data property in object literal not allowed in strict mode",TM="ILLEGAL",AM="Disabled.",kM=new RegExp("[\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0-\u08b2\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191e\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua69d\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\ua9e0-\ua9e4\ua9e6-\ua9ef\ua9fa-\ua9fe\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa7e-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]"),CM=new RegExp("[\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0300-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0483-\u0487\u048a-\u052f\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f2\u0610-\u061a\u0620-\u0669\u066e-\u06d3\u06d5-\u06dc\u06df-\u06e8\u06ea-\u06fc\u06ff\u0710-\u074a\u074d-\u07b1\u07c0-\u07f5\u07fa\u0800-\u082d\u0840-\u085b\u08a0-\u08b2\u08e4-\u0963\u0966-\u096f\u0971-\u0983\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bc-\u09c4\u09c7\u09c8\u09cb-\u09ce\u09d7\u09dc\u09dd\u09df-\u09e3\u09e6-\u09f1\u0a01-\u0a03\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a59-\u0a5c\u0a5e\u0a66-\u0a75\u0a81-\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abc-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ad0\u0ae0-\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3c-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b5c\u0b5d\u0b5f-\u0b63\u0b66-\u0b6f\u0b71\u0b82\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd0\u0bd7\u0be6-\u0bef\u0c00-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c58\u0c59\u0c60-\u0c63\u0c66-\u0c6f\u0c81-\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbc-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0cde\u0ce0-\u0ce3\u0ce6-\u0cef\u0cf1\u0cf2\u0d01-\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d-\u0d44\u0d46-\u0d48\u0d4a-\u0d4e\u0d57\u0d60-\u0d63\u0d66-\u0d6f\u0d7a-\u0d7f\u0d82\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0de6-\u0def\u0df2\u0df3\u0e01-\u0e3a\u0e40-\u0e4e\u0e50-\u0e59\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb9\u0ebb-\u0ebd\u0ec0-\u0ec4\u0ec6\u0ec8-\u0ecd\u0ed0-\u0ed9\u0edc-\u0edf\u0f00\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e-\u0f47\u0f49-\u0f6c\u0f71-\u0f84\u0f86-\u0f97\u0f99-\u0fbc\u0fc6\u1000-\u1049\u1050-\u109d\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u135d-\u135f\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176c\u176e-\u1770\u1772\u1773\u1780-\u17d3\u17d7\u17dc\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u1820-\u1877\u1880-\u18aa\u18b0-\u18f5\u1900-\u191e\u1920-\u192b\u1930-\u193b\u1946-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u19d0-\u19d9\u1a00-\u1a1b\u1a20-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1aa7\u1ab0-\u1abd\u1b00-\u1b4b\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1bf3\u1c00-\u1c37\u1c40-\u1c49\u1c4d-\u1c7d\u1cd0-\u1cd2\u1cd4-\u1cf6\u1cf8\u1cf9\u1d00-\u1df5\u1dfc-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u200c\u200d\u203f\u2040\u2054\u2071\u207f\u2090-\u209c\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d7f-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2de0-\u2dff\u2e2f\u3005-\u3007\u3021-\u302f\u3031-\u3035\u3038-\u303c\u3041-\u3096\u3099\u309a\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua62b\ua640-\ua66f\ua674-\ua67d\ua67f-\ua69d\ua69f-\ua6f1\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua7ad\ua7b0\ua7b1\ua7f7-\ua827\ua840-\ua873\ua880-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f7\ua8fb\ua900-\ua92d\ua930-\ua953\ua960-\ua97c\ua980-\ua9c0\ua9cf-\ua9d9\ua9e0-\ua9fe\uaa00-\uaa36\uaa40-\uaa4d\uaa50-\uaa59\uaa60-\uaa76\uaa7a-\uaac2\uaadb-\uaadd\uaae0-\uaaef\uaaf2-\uaaf6\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab5f\uab64\uab65\uabc0-\uabea\uabec\uabed\uabf0-\uabf9\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe00-\ufe0f\ufe20-\ufe2d\ufe33\ufe34\ufe4d-\ufe4f\ufe70-\ufe74\ufe76-\ufefc\uff10-\uff19\uff21-\uff3a\uff3f\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]");function RM(t,e){if(!t)throw new Error("ASSERT: "+e)}function DM(t){return t>=48&&t<=57}function LM(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function OM(t){return"01234567".indexOf(t)>=0}function PM(t){return 10===t||13===t||8232===t||8233===t}function IM(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||t>=128&&kM.test(String.fromCharCode(t))}function NM(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||t>=128&&CM.test(String.fromCharCode(t))}var FM={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function jM(){for(var t,e;W_<Y_&&(32===(e=t=G_.charCodeAt(W_))||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0||PM(t));)++W_}function zM(t){var e,n,r,i=0;for(n="u"===t?4:2,e=0;e<n;++e)W_<Y_&&LM(G_[W_])?(r=G_[W_++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):ZM({},gM,TM);return String.fromCharCode(i)}function UM(){var t,e;for(e=0,"}"===(t=G_[W_])&&ZM({},gM,TM);W_<Y_&&LM(t=G_[W_++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||"}"!==t)&&ZM({},gM,TM),e<=65535?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}function VM(){var t,e;for(t=G_.charCodeAt(W_++),e=String.fromCharCode(t),92===t&&(117!==G_.charCodeAt(W_)&&ZM({},gM,TM),++W_,(t=zM("u"))&&"\\"!==t&&IM(t.charCodeAt(0))||ZM({},gM,TM),e=t);W_<Y_&&NM(t=G_.charCodeAt(W_));)++W_,e+=String.fromCharCode(t),92===t&&(e=e.substr(0,e.length-1),117!==G_.charCodeAt(W_)&&ZM({},gM,TM),++W_,(t=zM("u"))&&"\\"!==t&&NM(t.charCodeAt(0))||ZM({},gM,TM),e+=t);return e}function BM(){var t,e,n,r,i=W_,o=G_.charCodeAt(W_),a=G_[W_];switch(o){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++W_,{type:rM,value:String.fromCharCode(o),start:i,end:W_};default:if(61===(t=G_.charCodeAt(W_+1)))switch(o){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return W_+=2,{type:rM,value:String.fromCharCode(o)+String.fromCharCode(t),start:i,end:W_};case 33:case 61:return 61===G_.charCodeAt(W_+=2)&&++W_,{type:rM,value:G_.slice(i,W_),start:i,end:W_}}}return">>>="===(r=G_.substr(W_,4))?{type:rM,value:r,start:i,end:W_+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:rM,value:n,start:i,end:W_+=3}:a===(e=n.substr(0,2))[1]&&"+-<>&|".indexOf(a)>=0||"=>"===e?{type:rM,value:e,start:i,end:W_+=2}:"<>=!+-*%&|^/".indexOf(a)>=0?{type:rM,value:a,start:i,end:++W_}:void ZM({},gM,TM)}function HM(){var t,e,n;if(RM(DM((n=G_[W_]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),e=W_,t="","."!==n){if(t=G_[W_++],n=G_[W_],"0"===t){if("x"===n||"X"===n)return++W_,function(t){for(var e="";W_<Y_&&LM(G_[W_]);)e+=G_[W_++];return 0===e.length&&ZM({},gM,TM),IM(G_.charCodeAt(W_))&&ZM({},gM,TM),{type:nM,value:parseInt("0x"+e,16),start:t,end:W_}}(e);if(OM(n))return function(t){for(var e="0"+G_[W_++];W_<Y_&&OM(G_[W_]);)e+=G_[W_++];return(IM(G_.charCodeAt(W_))||DM(G_.charCodeAt(W_)))&&ZM({},gM,TM),{type:nM,value:parseInt(e,8),octal:!0,start:t,end:W_}}(e);n&&DM(n.charCodeAt(0))&&ZM({},gM,TM)}for(;DM(G_.charCodeAt(W_));)t+=G_[W_++];n=G_[W_]}if("."===n){for(t+=G_[W_++];DM(G_.charCodeAt(W_));)t+=G_[W_++];n=G_[W_]}if("e"===n||"E"===n)if(t+=G_[W_++],"+"!==(n=G_[W_])&&"-"!==n||(t+=G_[W_++]),DM(G_.charCodeAt(W_)))for(;DM(G_.charCodeAt(W_));)t+=G_[W_++];else ZM({},gM,TM);return IM(G_.charCodeAt(W_))&&ZM({},gM,TM),{type:nM,value:parseFloat(t),start:e,end:W_}}function qM(){var t;return jM(),W_>=Y_?{type:Z_,start:W_,end:W_}:IM(t=G_.charCodeAt(W_))?function(){var t,e;return t=W_,{type:1===(e=92===G_.charCodeAt(W_)?VM():function(){var t,e;for(t=W_++;W_<Y_;){if(92===(e=G_.charCodeAt(W_)))return W_=t,VM();if(!NM(e))break;++W_}return G_.slice(t,W_)}()).length?K_:FM.hasOwnProperty(e)?tM:"null"===e?eM:"true"===e||"false"===e?J_:K_,value:e,start:t,end:W_}}():40===t||41===t||59===t?BM():39===t||34===t?function(){var t,e,n,r,i="",o=!1;for(RM("'"===(t=G_[W_])||'"'===t,"String literal must starts with a quote"),e=W_,++W_;W_<Y_;){if((n=G_[W_++])===t){t="";break}if("\\"===n)if((n=G_[W_++])&&PM(n.charCodeAt(0)))"\r"===n&&"\n"===G_[W_]&&++W_;else switch(n){case"u":case"x":"{"===G_[W_]?(++W_,i+=UM()):i+=zM(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:OM(n)?(0!==(r="01234567".indexOf(n))&&(o=!0),W_<Y_&&OM(G_[W_])&&(o=!0,r=8*r+"01234567".indexOf(G_[W_++]),"0123".indexOf(n)>=0&&W_<Y_&&OM(G_[W_])&&(r=8*r+"01234567".indexOf(G_[W_++]))),i+=String.fromCharCode(r)):i+=n}else{if(PM(n.charCodeAt(0)))break;i+=n}}return""!==t&&ZM({},gM,TM),{type:iM,value:i,octal:o,start:e,end:W_}}():46===t?DM(G_.charCodeAt(W_+1))?HM():BM():DM(t)?HM():BM()}function GM(){var t;return W_=(t=X_).end,X_=qM(),W_=t.end,t}function WM(){var t;t=W_,X_=qM(),W_=t}function YM(t,e,n){var r=new Q_("||"===t||"&&"===t?hM:aM);return r.operator=t,r.left=e,r.right=n,r}function XM(t){var e=new Q_(cM);return e.name=t,e}function $M(t){var e=new Q_(lM);return e.value=t.value,e.raw=G_.slice(t.start,t.end),t.regex&&("//"===e.raw&&(e.raw="/(?:)/"),e.regex=t.regex),e}function QM(t,e,n){var r=new Q_(fM);return r.computed="["===t,r.object=e,r.property=n,r.computed||(n.member=!0),r}function JM(t,e,n){var r=new Q_(pM);return r.key=e,r.value=n,r.kind=t,r}function ZM(t,e){var n,r=Array.prototype.slice.call(arguments,2),i=e.replace(/%(\d)/g,function(t,e){return RM(e<r.length,"Message reference must be in range"),r[e]});throw(n=new Error(i)).index=W_,n.description=i,n}function KM(t){t.type===Z_&&ZM(t,xM),t.type===nM&&ZM(t,vM),t.type===iM&&ZM(t,yM),t.type===K_&&ZM(t,wM),t.type===tM&&ZM(t,bM),ZM(t,gM,t.value)}function tE(t){var e=GM();e.type===rM&&e.value===t||KM(e)}function eE(t){return X_.type===rM&&X_.value===t}function nE(t){return X_.type===tM&&X_.value===t}function rE(){var t;return W_=X_.start,(t=GM()).type===iM||t.type===nM?(t.octal&&ZM(t,EM),$M(t)):XM(t.value)}var iE={if:1,this:1};function oE(){var t=[];if(tE("("),!eE(")"))for(;W_<Y_&&(t.push(lE()),!eE(")"));)tE(",");return tE(")"),t}function aE(){var t,e;return W_=X_.start,(e=t=GM()).type!==K_&&e.type!==tM&&e.type!==J_&&e.type!==eM&&KM(t),XM(t.value)}function sE(){var t=function(){var t,e,n,r,i;for(t=function(){var t,e,n,r;if(eE("("))return tE("("),r=hE(),tE(")"),r;if(eE("["))return function(){var t,e,n=[];for(W_=X_.start,tE("[");!eE("]");)eE(",")?(GM(),n.push(null)):(n.push(lE()),eE("]")||tE(","));return GM(),t=n,(e=new Q_(oM)).elements=t,e}();if(eE("{"))return function(){var t,e,n,r,i,o,a,s=[],u={},c=String;for(W_=X_.start,tE("{");!eE("}");)n=void 0,r=void 0,i=void 0,W_=X_.start,e="$"+((t=(n=X_).type===K_?(i=rE(),tE(":"),JM("init",i,lE())):n.type!==Z_&&n.type!==rM?(r=rE(),tE(":"),JM("init",r,lE())):void KM(n)).key.type===cM?t.key.name:c(t.key.value)),Object.prototype.hasOwnProperty.call(u,e)?ZM({},SM):u[e]=!0,s.push(t),eE("}")||tE(",");return tE("}"),o=s,(a=new Q_(dM)).properties=o,a}();if(W_=X_.start,(t=X_.type)===K_||iE[X_.value])n=XM(GM().value);else if(t===iM||t===nM)X_.octal&&ZM(X_,EM),n=$M(GM());else{if(t===tM)throw new Error(AM);t===J_?((e=GM()).value="true"===e.value,n=$M(e)):t===eM?((e=GM()).value=null,n=$M(e)):eE("/")||eE("/=")?(n=$M(function(){var t,e,n,r;return X_=null,jM(),t=W_,e=function(){var t,e,n,r;for(RM("/"===(t=G_[W_]),"Regular expression literal must start with a slash"),e=G_[W_++],n=!1,r=!1;W_<Y_;)if(e+=t=G_[W_++],"\\"===t)PM((t=G_[W_++]).charCodeAt(0))&&ZM({},MM),e+=t;else if(PM(t.charCodeAt(0)))ZM({},MM);else if(n)"]"===t&&(n=!1);else{if("/"===t){r=!0;break}"["===t&&(n=!0)}return r||ZM({},MM),{value:e.substr(1,e.length-2),literal:e}}(),n=function(){var t,e,n;for(e="",n="";W_<Y_&&NM((t=G_[W_]).charCodeAt(0));)++W_,"\\"===t&&W_<Y_?ZM({},gM,TM):(n+=t,e+=t);return n.search(/[^gimuy]/g)>=0&&ZM({},_M,n),{value:n,literal:e}}(),r=function(t,e){var n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(t,e){if(parseInt(e,16)<=1114111)return"x";ZM({},_M)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(t){ZM({},_M)}try{return new RegExp(t,e)}catch(t){return null}}(e.value,n.value),{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:W_}}()),WM()):KM(GM())}return n}();;)if(eE("."))tE("."),t=QM(".",t,aE());else if(eE("("))n=t,r=oE(),i=void 0,(i=new Q_(sM)).callee=n,i.arguments=r,t=i;else{if(!eE("["))break;e=void 0,tE("["),e=hE(),tE("]"),t=QM("[",t,e)}return t}();if(X_.type===rM&&(eE("++")||eE("--")))throw new Error(AM);return t}function uE(){var t,e,n,r,i;if(X_.type!==rM&&X_.type!==tM)e=sE();else{if(eE("++")||eE("--"))throw new Error(AM);if(eE("+")||eE("-")||eE("~")||eE("!"))t=GM(),e=uE(),n=t.value,r=e,(i=new Q_(mM)).operator=n,i.argument=r,i.prefix=!0,e=i;else{if(nE("delete")||nE("void")||nE("typeof"))throw new Error(AM);e=sE()}}return e}function cE(t){var e=0;if(t.type!==rM&&t.type!==tM)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11}return e}function lE(){var t,e,n,r,i,o;return t=function(){var t,e,n,r,i,o,a,s,u,c;if(t=X_,u=uE(),0===(i=cE(r=X_)))return u;for(r.prec=i,GM(),e=[t,X_],o=[u,r,a=uE()];(i=cE(X_))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)a=o.pop(),s=o.pop().value,u=o.pop(),e.pop(),n=YM(s,u,a),o.push(n);(r=GM()).prec=i,o.push(r),e.push(X_),n=uE(),o.push(n)}for(n=o[c=o.length-1],e.pop();c>1;)e.pop(),n=YM(o[c-1].value,o[c-2],n),c-=2;return n}(),eE("?")&&(GM(),e=lE(),tE(":"),n=t,r=e,i=lE(),(o=new Q_(uM)).test=n,o.consequent=r,o.alternate=i,t=o),t}function hE(){var t=lE();if(eE(","))throw new Error(AM);return t}var fE={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"},dE=function(t){function e(e,n,r){return function(i){return o=e,s=n,u=r,c=t((a=i)[0]),s&&(c=s+"("+c+")",0===s.lastIndexOf("new ",0)&&(c="("+c+")")),c+"."+o+(u<0?"":0===u?"()":"("+a.slice(1).map(t).join(",")+")");var o,a,s,u,c}}var n="new Date",r="String";return{isNaN:"isNaN",isFinite:"isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(e){e.length<3&&i("Missing arguments to clamp function."),e.length>3&&i("Too many arguments to clamp function.");var n=e.map(t);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:e("getDate",n,0),day:e("getDay",n,0),year:e("getFullYear",n,0),month:e("getMonth",n,0),hours:e("getHours",n,0),minutes:e("getMinutes",n,0),seconds:e("getSeconds",n,0),milliseconds:e("getMilliseconds",n,0),time:e("getTime",n,0),timezoneoffset:e("getTimezoneOffset",n,0),utcdate:e("getUTCDate",n,0),utcday:e("getUTCDay",n,0),utcyear:e("getUTCFullYear",n,0),utcmonth:e("getUTCMonth",n,0),utchours:e("getUTCHours",n,0),utcminutes:e("getUTCMinutes",n,0),utcseconds:e("getUTCSeconds",n,0),utcmilliseconds:e("getUTCMilliseconds",n,0),length:e("length",null,-1),indexof:e("indexOf",null),lastindexof:e("lastIndexOf",null),slice:e("slice",null),parseFloat:"parseFloat",parseInt:"parseInt",upper:e("toUpperCase",r,0),lower:e("toLowerCase",r,0),substring:e("substring",r),replace:e("replace",r),regexp:"RegExp",test:e("test","RegExp"),if:function(e){e.length<3&&i("Missing arguments to if function."),e.length>3&&i("Too many arguments to if function.");var n=e.map(t);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}},pE={};function mE(t,e,n){var r=t+":"+n,i=pE[r];return i&&i[0]===e||(pE[r]=i=[e,e(n)]),i[1]}function gE(t,e){return mE("timeFormat",tn,e)(t)}var vE=new Date(2e3,0,1);function yE(t,e,n){return vE.setMonth(t),vE.setDate(e),gE(vE,n)}function wE(t,e,n){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(n)))}catch(e){t.warn(e)}return n[n.length-1]}var bE="undefined"!=typeof window&&window||null,xE="Literal",_E="Identifier",ME="@",EE="%",SE=":";function TE(t,e){var n;return I(t)?t:u(t)?(n=e.scales[t])&&n.value:void 0}function AE(t,e,n){var r=EE+n;if(!e.hasOwnProperty(r))try{e[r]=t.scaleRef(n)}catch(t){}}function kE(t,e,n,r){if(e[0].type===xE)AE(n,r,e[0].value);else if(e[0].type===_E)for(t in n.scales)AE(n,r,t)}function CE(t){return function(e,n,r){var i=TE(e,(r||this).context);return i&&i.path[t](n)}}var RE=CE("area"),DE=CE("bounds"),LE=CE("centroid");function OE(t){var e=this.context.data[t];return e?e.values.value:[]}function PE(t,e,n,r){e[0].type!==xE&&i("First argument to data functions must be a string literal.");var o=e[0].value,a=SE+o;r.hasOwnProperty(a)||(r[a]=n.getData(o).tuplesRef())}var IE={};function NE(t){return t.data}function FE(t,e){var n=OE.call(e,t);return n.root&&n.root.lookup||IE}var jE=function(t,e,n,r){var i,o=e[0],a=e[e.length-1];return o>a&&(i=o,o=a,a=i),n=void 0===n||n,r=void 0===r||r,(n?o<=t:o<t)&&(r?t<=a:t<a)};function zE(t,e){return t===e||t!=t&&e!=e||!(!a(t)||!a(e)||t.length!==e.length)&&function(t,e){for(var n=0,r=t.length;n<r;++n)if(!zE(t[n],e[n]))return!1;return!0}(t,e)}function UE(t){return function(e){for(var n in t)if(!zE(e[n],t[n]))return!1;return!0}}var VE="bin_",BE="intersect",HE="union",qE="index:unit";function GE(t,e){for(var n,r=e.fields,i=e.values,o=e.getter||(e.getter=[]),a=r.length,s=0;s<a;++s)if(o[s]=o[s]||l(r[s]),n=o[s](t),G(n)&&(n=_(n)),G(i[s])&&(i[s]=_(i[s])),e[VE+r[s]]){if(G(i[s][0])&&(i[s]=i[s].map(_)),!jE(n,i[s],!0,!1))return!1}else if(n!==i[s])return!1;return!0}function WE(t,e){for(var n,r,i=e.intervals,o=i.length,a=0;a<o;++a){if(n=i[a].extent,r=(i[a].getter||(i[a].getter=l(i[a].field)))(t),!n||n[0]===n[1])return!1;if(G(r)&&(r=_(r)),G(n[0])&&(n=i[a].extent=n.map(_)),W(n[0])&&!jE(r,n))return!1;if(u(n[0])&&n.indexOf(r)<0)return!1}return!0}function YE(t,e,n,r){for(var i,o,a,s,u,c=this.context.data[t],l=c?c.values.value:[],h=c?c[qE]&&c[qE].value:void 0,f=n===BE,d=l.length,p=0;p<d;++p)if(i=l[p],h&&f){if(-1===(a=(o=o||{})[s=i.unit]||0))continue;if(u=r(e,i),o[s]=u?-1:++a,u&&1===h.size)return!0;if(!u&&a===h.get(s).count)return!1}else if(f^(u=r(e,i)))return u;return d&&f}function XE(t,e,n){return YE.call(this,t,e,n,GE)}function $E(t,e,n,r){e[0].type!==xE&&i("First argument to indata must be a string literal.");var o=e[0].value,a=ME+"unit";(e.length>=2&&e[e.length-1].value)!==BE||r.hasOwnProperty(a)||(r[a]=n.getData(o).indataRef(n,"unit")),PE(0,e,n,r)}function QE(t,e,n,r){var i,o,a,s,u,c=this.context.data[t],l=c?c.values.value:[],h=c?c[qE]&&c[qE].value:void 0,f=l[0],d=0;if(f){for(i=e?f.encodings.length:f.fields.length;d<i;++d)if(e&&f.encodings[d]===e||n&&f.fields[d]===n){o=d,s=f[VE+f.fields[d]];break}return h&&1===h.size&&(r=HE),h&&r===BE?(u=l.reduce(function(t,e){return(t[e.unit]||(t[e.unit]=[])).push({unit:e.unit,value:e.values[o]}),t},{}),a=Object.keys(u).map(function(t){return{unit:t,value:s?ZE(u[t],HE):JE(u[t],HE)}})):a=l.map(function(t){return{unit:t.unit,value:t.values[o]}}),s?ZE(a,r):JE(a,r)}}function JE(t,e){for(var n,r,i,o,a={},s=0,u={},c=[],l=0,h=t.length;l<h;++l)r=(n=t[l]).unit,o=n.value,a[r]||(a[r]=++s),(i=u[o])||(u[o]=i={value:o,units:{},count:0}),i.units[r]||(i.units[r]=++i.count);for(o in u)i=u[o],e===BE&&i.count!==s||c.push(i.value);return c.length?c:void 0}function ZE(t,e){for(var n,r,i,o,a=e===BE?tS:KE,s=0,u=t.length;s<u;++s)G((n=t[s].value)[0])&&(n=n.map(_)),(i=n[0])>(o=n[1])&&(o=n[0],i=n[1]),r=r?a(r,i,o):[i,o];return r&&r.length&&+r[0]!=+r[1]?r:void 0}function KE(t,e,n){return t[0]>e&&(t[0]=e),t[1]<n&&(t[1]=n),t}function tS(t,e,n){return n<t[0]||t[1]<e?[]:(t[0]<e&&(t[0]=e),t[1]>n&&(t[1]=n),t)}var eS={random:function(){return t.random()},isArray:a,isBoolean:q,isDate:G,isNumber:W,isObject:s,isRegExp:Y,isString:u,isTuple:ut,toBoolean:Z,toDate:tt,toNumber:_,toString:et,pad:J,peek:x,truncate:rt,rgb:lh,lab:Th,hcl:Lh,hsl:dh,sequence:ii,format:function(t,e){return mE("format",$f,e)(t)},utcFormat:function(t,e){return mE("utcFormat",nn,e)(t)},utcParse:function(t,e){return mE("utcParse",rn,e)(t)},timeFormat:gE,timeParse:function(t,e){return mE("timeParse",en,e)(t)},monthFormat:function(t){return yE(t,1,"%B")},monthAbbrevFormat:function(t){return yE(t,1,"%b")},dayFormat:function(t){return yE(0,2+t,"%A")},dayAbbrevFormat:function(t){return yE(0,2+t,"%a")},quarter:function(t){return 1+~~(new Date(t).getMonth()/3)},utcquarter:function(t){return 1+~~(new Date(t).getUTCMonth()/3)},warn:function(){return wE(this.context.dataflow,"warn",arguments)},info:function(){return wE(this.context.dataflow,"info",arguments)},debug:function(){return wE(this.context.dataflow,"debug",arguments)},inScope:function(t){var e=this.context.group,n=!1;if(e)for(;t;){if(t===e){n=!0;break}t=t.mark.group}return n},clampRange:function(t,e,n){var r,i=t[0],o=t[1];return o<i&&(r=o,o=i,i=r),(r=o-i)>=n-e?[e,n]:[Math.min(Math.max(i,e),n-r),Math.min(Math.max(o,r),n)]},pinchDistance:function(t){var e=t.touches,n=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.sqrt(n*n+r*r)},pinchAngle:function(t){var e=t.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)},screen:function(){return bE?bE.screen:{}},containerSize:function(){var t=this.context.dataflow,e=t.container&&t.container();return e?[e.clientWidth,e.clientHeight]:[void 0,void 0]},windowSize:function(){return bE?[bE.innerWidth,bE.innerHeight]:[void 0,void 0]},span:function(t){return t[t.length-1]-t[0]||0},flush:function(t,e,n,r,i,o){var a=Math.abs(e-t[0]),s=Math.abs(x(t)-e);return a<s&&a<=n?r:s<=n?i:o},bandspace:function(t,e,n){return jl(t||0,e||0,n||0)},inrange:jE,setdata:function(t,e){var n=this.context.dataflow;return n.pulse(this.context.data[t].input,n.changeset().remove(g).insert(e)),1},panLinear:A,panLog:k,panPow:C,zoomLinear:D,zoomLog:L,zoomPow:O,encode:function(t,e,n){if(t){var r=this.context.dataflow;r.pulse(t.mark.source,r.changeset().encode(t,e))}return void 0!==n?n:t},modify:function(t,e,n,r,i,o){var s,u,c=this.context.dataflow,l=this.context.data[t],h=l.input,f=l.changes,d=c.stamp();if(!1===c._trigger||!(h.value.length||e||r))return 0;if((!f||f.stamp<d)&&(l.changes=f=c.changeset(),f.stamp=d,c.runAfter(function(){l.modified=!0,c.pulse(h,f).run()},!0)),n&&(s=!0===n?g:a(n)||ut(n)?n:UE(n),f.remove(s)),e&&f.insert(e),r&&(s=UE(r),h.value.some(s)?f.remove(s):f.insert(r)),i)for(u in o)f.modify(i,u,o[u]);return 1}},nS=["view","item","group","xy","x","y"],rS="this.",iS={};function oS(t,e,n){return 1===arguments.length?eS[t]:(eS[t]=e,n&&(iS[t]=n),sS&&(sS.functions[t]=rS+t),this)}oS("bandwidth",function(t,e){var n=TE(t,(e||this).context);return n&&n.bandwidth?n.bandwidth():0},kE),oS("copy",function(t,e){var n=TE(t,(e||this).context);return n?n.copy():void 0},kE),oS("domain",function(t,e){var n=TE(t,(e||this).context);return n?n.domain():[]},kE),oS("range",function(t,e){var n=TE(t,(e||this).context);return n&&n.range?n.range():[]},kE),oS("invert",function(t,e,n){var r=TE(t,(n||this).context);return r?a(e)?(r.invertRange||r.invert)(e):(r.invert||r.invertExtent)(e):void 0},kE),oS("scale",function(t,e,n){var r=TE(t,(n||this).context);return r?r(e):void 0},kE),oS("gradient",function(t,e,n,r){var i=Po(e,n),o=t.domain(),a=o[0],s=o[o.length-1],u=am(t,a,s);t.ticks&&(a!==(o=t.ticks(+r||15))[0]&&o.unshift(a),s!==o[o.length-1]&&o.push(s));for(var c=0,l=o.length;c<l;++c)i.stop(u(o[c]),t(o[c]));return i},kE),oS("geoArea",RE,kE),oS("geoBounds",DE,kE),oS("geoCentroid",LE,kE),oS("indata",function(t,e,n){var r=this.context.data[t]["index:"+e],i=r?r.value.get(n):void 0;return i?i.count:i},function(t,e,n,r){e[0].type!==xE&&i("First argument to indata must be a string literal."),e[1].type!==xE&&i("Second argument to indata must be a string literal.");var o=e[0].value,a=e[1].value,s=ME+a;r.hasOwnProperty(s)||(r[s]=n.getData(o).indataRef(n,a))}),oS("data",OE,PE),oS("vlSingle",XE,PE),oS("vlSingleDomain",QE,PE),oS("vlMulti",XE,$E),oS("vlMultiDomain",QE,$E),oS("vlInterval",function(t,e,n){return YE.call(this,t,e,n,WE)},PE),oS("vlIntervalDomain",function(t,e,n,r){var i,o,a,s,u,c=this.context.data[t],l=c?c.values.value:[],h=l[0],f=0;if(h){for(i=h.intervals.length;f<i;++f)if(o=h.intervals[f],e&&o.encoding===e||n&&o.field===n){if(!o.extent)return;a=f,u=o.extent.length>2;break}return s=l.reduce(function(t,e){var n=e.intervals[a].extent,r=u?n.map(function(t){return{unit:e.unit,value:t}}):{unit:e.unit,value:n};return u?t.push.apply(t,r):t.push(r),t},[]),u?JE(s,r):ZE(s,r)}},PE),oS("treePath",function(t,e,n){var r=FE(t,this),i=r[e],o=r[n];return i&&o?i.path(o).map(NE):void 0},PE),oS("treeAncestors",function(t,e){var n=FE(t,this)[e];return n?n.ancestors().map(NE):void 0},PE);var aS={blacklist:["_"],whitelist:["datum","event","item"],fieldvar:"datum",globalvar:function(t){return"_["+c("$"+t)+"]"},functions:function(t){var e=dE(t);for(var n in nS.forEach(function(t){e[t]="event.vega."+t}),eS)e[n]=rS+n;return e},constants:fE,visitors:iS},sS=function(t){var e=(t=t||{}).whitelist?nt(t.whitelist):{},n=t.blacklist?nt(t.blacklist):{},r=t.constants||fE,o=(t.functions||dE)(d),a=t.globalvar,s=t.fieldvar,c={},l={},h=0,f=I(a)?a:function(t){return a+'["'+t+'"]'};function d(t){if(u(t))return t;var e=p[t.type];return null==e&&i("Unsupported type: "+t.type),e(t)}var p={Literal:function(t){return t.raw},Identifier:function(t){var o=t.name;return h>0?o:n.hasOwnProperty(o)?i("Illegal identifier: "+o):r.hasOwnProperty(o)?r[o]:e.hasOwnProperty(o)?o:(c[o]=1,f(o))},MemberExpression:function(t){var e=!t.computed,n=d(t.object);e&&(h+=1);var r=d(t.property);return n===s&&(l[r]=1),e&&(h-=1),n+(e?"."+r:"["+r+"]")},CallExpression:function(t){"Identifier"!==t.callee.type&&i("Illegal callee type: "+t.callee.type);var e=t.callee.name,n=t.arguments,r=o.hasOwnProperty(e)&&o[e];return r||i("Unrecognized function: "+e),I(r)?r(n):r+"("+n.map(d).join(",")+")"},ArrayExpression:function(t){return"["+t.elements.map(d).join(",")+"]"},BinaryExpression:function(t){return"("+d(t.left)+t.operator+d(t.right)+")"},UnaryExpression:function(t){return"("+t.operator+d(t.argument)+")"},ConditionalExpression:function(t){return"("+d(t.test)+"?"+d(t.consequent)+":"+d(t.alternate)+")"},LogicalExpression:function(t){return"("+d(t.left)+t.operator+d(t.right)+")"},ObjectExpression:function(t){return"{"+t.properties.map(d).join(",")+"}"},Property:function(t){h+=1;var e=d(t.key);return h-=1,e+":"+d(t.value)}};function m(t){var e={code:d(t),globals:Object.keys(c),fields:Object.keys(l)};return c={},l={},e}return m.functions=o,m.constants=r,m}(aS),uS=function(t,e,n){var r,o,a={};try{r=function(t){W_=0,Y_=(G_=t).length,X_=null,WM();var e=hE();if(X_.type!==Z_)throw new Error("Unexpect token after expression.");return e}(t)}catch(e){i("Expression parse error: "+c(t))}return r.visit(function(t){if("CallExpression"===t.type){var n=t.callee.name,r=aS.visitors[n];r&&r(n,t.arguments,e,a)}}),(o=sS(r)).globals.forEach(function(t){var n="$"+t;!a.hasOwnProperty(n)&&e.getSignal(t)&&(a[n]=e.signalRef(t))}),{$expr:n?n+"return("+o.code+");":o.code,$fields:o.fields,$params:a}},cS="view",lS="scope";function hS(t,e){return(t.merge?function(t,e){var n=fS({merge:t.merge.map(function(t){return hS(t,e)})},t,e);return e.addStream(n).id}:t.stream?function(t,e){var n=fS({stream:hS(t.stream,e)},t,e);return e.addStream(n).id}:t.type?function(t,e){var n,r=e.event((n=t.source)===lS?cS:n||cS,t.type),i=fS({stream:r},t,e);return 1===Object.keys(i).length?r:e.addStream(i).id}:i("Invalid stream specification: "+c(t)))(t,e)}function fS(t,e,n){var r,o,a,s,u=e.between;return u&&(2!==u.length&&i('Stream "between" parameter must have 2 entries: '+c(e)),t.between=[hS(u[0],n),hS(u[1],n)]),u=e.filter?P(e.filter):[],(e.marktype||e.markname||e.markrole)&&u.push((o=e.markname,a=e.markrole,(s="event.item")+((r=e.marktype)&&"*"!==r?"&&"+s+".mark.marktype==='"+r+"'":"")+(a?"&&"+s+".mark.role==='"+a+"'":"")+(o?"&&"+s+".mark.name==='"+o+"'":""))),e.source===lS&&u.push("inScope(event.item)"),u.length&&(t.filter=uS("("+u.join(")&&(")+")").$expr),null!=(u=e.throttle)&&(t.throttle=+u),null!=(u=e.debounce)&&(t.debounce=+u),e.consume&&(t.consume=!0),t}var dS,pS,mS="[",gS="]",vS="{",yS="}",wS=":",bS=",",xS="@",_S=">",MS=/[[\]{}]/,ES={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};function SS(t,e,n,r,i){for(var o,a=0,s=t.length;e<s;++e){if(o=t[e],!a&&o===n)return e;i&&i.indexOf(o)>=0?--a:r&&r.indexOf(o)>=0&&++a}return e}function TS(t){for(var e=[],n=0,r=t.length,i=0;i<r;)i=SS(t,i,bS,mS+vS,gS+yS),e.push(t.substring(n,i).trim()),n=++i;if(0===e.length)throw"Empty event selector: "+t;return e}function AS(t){return"["===t[0]?function(t){var e,n,r=t.length,i=1;if((i=SS(t,i,gS,mS,gS))===r)throw"Empty between selector: "+t;if(2!==(e=TS(t.substring(1,i))).length)throw"Between selector must have two elements: "+t;if((t=t.slice(i+1).trim())[0]!==_S)throw"Expected '>' after between selector: "+t;return e=e.map(AS),(n=AS(t.slice(1).trim())).between?{between:e,stream:n}:(n.between=e,n)}(t):function(t){var e,n,r={source:dS},i=[],o=[0,0],a=0,s=0,u=t.length,c=0;if(t[u-1]===yS){if(!((c=t.lastIndexOf(vS))>=0))throw"Unmatched right brace: "+t;try{o=function(t){var e=t.split(bS);if(!t.length||e.length>2)throw t;return e.map(function(e){var n=+e;if(n!=n)throw t;return n})}(t.substring(c+1,u-1))}catch(e){throw"Invalid throttle specification: "+t}u=(t=t.slice(0,c).trim()).length,c=0}if(!u)throw t;if(t[0]===xS&&(a=++c),(e=SS(t,c,wS))<u&&(i.push(t.substring(s,e).trim()),s=c=++e),(c=SS(t,c,mS))===u)i.push(t.substring(s,u).trim());else if(i.push(t.substring(s,c).trim()),n=[],(s=++c)===u)throw"Unmatched left bracket: "+t;for(;c<u;){if((c=SS(t,c,gS))===u)throw"Unmatched left bracket: "+t;if(n.push(t.substring(s,c).trim()),c<u-1&&t[++c]!==mS)throw"Expected left bracket: "+t;s=++c}if(!(u=i.length)||MS.test(i[u-1]))throw"Invalid event selector: "+t;return u>1?(r.type=i[1],a?r.markname=i[0].slice(1):pS.hasOwnProperty(i[0])?r.marktype=i[0]:r.source=i[0]):r.type=i[0],"!"===r.type.slice(-1)&&(r.consume=!0,r.type=r.type.slice(0,-1)),null!=n&&(r.filter=n),o[0]&&(r.throttle=o[0]),o[1]&&(r.debounce=o[1]),r}(t)}var kS="var datum=event.item&&event.item.datum;";function CS(t,e,n,r){this.id=-1,this.type=t,this.value=e,this.params=n,r&&(this.parent=r)}function RS(t,e,n,r){return new CS(t,e,n,r)}function DS(t,e){return RS("operator",t,e)}function LS(t){var e={$ref:t.id};return t.id<0&&(t.refs=t.refs||[]).push(e),e}var OS={$tupleid:1,toString:function(){return":_tupleid_:"}};function PS(t,e){return e?{$field:t,$name:e}:{$field:t}}var IS=PS("key");function NS(t,e){return{$compare:t,$order:e}}var FS="descending";function jS(t,e){return(t&&t.signal?"$"+t.signal:t||"")+(t&&e?"_":"")+(e&&e.signal?"$"+e.signal:e||"")}function zS(t){return t&&t.signal}function US(t,e){return null!=t?t:e}function VS(t){return function(e,n,r){return RS(t,n,e||void 0,r)}}var BS=VS("aggregate"),HS=VS("axisticks"),qS=VS("bound"),GS=VS("collect"),WS=VS("compare"),YS=VS("datajoin"),XS=VS("encode"),$S=VS("facet"),QS=VS("field"),JS=VS("key"),ZS=VS("legendentries"),KS=VS("mark"),tT=VS("multiextent"),eT=VS("multivalues"),nT=VS("overlap"),rT=VS("params"),iT=VS("prefacet"),oT=VS("projection"),aT=VS("proxy"),sT=VS("relay"),uT=VS("render"),cT=VS("scale"),lT=VS("sieve"),hT=VS("sortitems"),fT=VS("viewlayout"),dT=VS("values"),pT=0,mT=["identity","ordinal","band","point","bin-linear","bin-ordinal","linear","pow","sqrt","log","sequential","time","utc","quantize","quantile","threshold"],gT=nt(mT),vT=nt(mT.slice(1,6));function yT(t){return vT.hasOwnProperty(t)}function wT(t){return"quantile"===t}function bT(t,e){return s(t)?t.signal?e.signalRef(t.signal):i("Unsupported object: "+c(t)):t}function xT(t){i("Can not find data set: "+c(t))}function _T(t,e,n){if(t)return t.signal?n.signalRef(t.signal):(a(t)?function(t,e,n){return t.map(function(t){return bT(t,n)})}:t.fields?function(t,e,n){var r=t.data,i=t.fields.reduce(function(t,e){return e=u(e)?{data:r,field:e}:a(e)||e.signal?function(t,e){var n="_:vega:_"+pT++,r=GS({});if(a(t))r.value={$ingest:t};else if(t.signal){var i="setdata("+c(n)+","+t.signal+")";r.params.input=e.signalRef(i)}return e.addDataPipeline(n,[r,lT({})]),{data:n,field:"data"}}(e,n):e,t.push(e),t},[]);return(yT(e.type)?function(t,e,n){var r,i,o;return r=n.map(function(t){var n=e.getData(t.data);return n||xT(t.data),n.countsRef(e,t.field)}),i=e.add(BS({groupby:IS,ops:["sum"],fields:[e.fieldRef("count")],as:["count"],pulse:r})),o=e.add(GS({pulse:LS(i)})),LS(e.add(dT({field:IS,sort:e.sortRef(MT(t.sort,!0)),pulse:LS(o)})))}:wT(e.type)?function(t,e,n){var r=n.map(function(t){var n=e.getData(t.data);return n||xT(t.data),n.domainRef(e,t.field)});return LS(e.add(eT({values:r})))}:function(t,e,n){var r=n.map(function(t){var n=e.getData(t.data);return n||xT(t.data),n.extentRef(e,t.field)});return LS(e.add(tT({extents:r})))})(t,n,i)}:function(t,e,n){var r=n.getData(t.data);return r||xT(t.data),yT(e.type)?r.valuesRef(n,t.field,MT(t.sort,!1)):wT(e.type)?r.domainRef(n,t.field):r.extentRef(n,t.field)})(t,e,n);null==e.domainMin&&null==e.domainMax||i("No scale domain defined for domainMin/domainMax to override.")}function MT(t,e){return t&&(t.field||t.op?t.field||"count"===t.op?e&&t.field?i("Multiple domain scales can not sort by field."):e&&t.op&&"count"!==t.op&&i("Multiple domain scales support op count only."):i("No field provided for sort aggregate op: "+t.op):s(t)?t.field="key":t={field:"key"}),t}function ET(t,e){return a(t)?t.map(function(t){return ET(t,e)}):s(t)?t.signal?e.signalRef(t.signal):i("Unsupported parameter object: "+c(t)):t}var ST="top",TT="left",AT="bottom",kT="label",CT="value",RT="guide-label",DT="guide-title",LT=["shape","size","fill","stroke","strokeDash","opacity"],OT={name:1,interactive:1},PT=nt(["rule"]),IT=nt(["group","image","rect"]),NT=function(t,e){var n="";return PT[e]?n:(t.x2&&(t.x?(IT[e]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),t.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),t.y2&&(t.y?(IT[e]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),t.yc&&(n+="o.y=o.yc-(o.height||0)/2;"),n)},FT=function(t,e,n,r){var i=uS(t,e);return i.$fields.forEach(function(t){r[t]=1}),z(n,i.$params),i.$expr},jT=function(t,e,n,r){return function t(e,n,r,a){var s,l,h;if(e.signal)s="datum",h=FT(e.signal,n,r,a);else if(e.group||e.parent){for(l=Math.max(1,e.level||1),s="item";l-- >0;)s+=".mark.group";e.parent?(h=e.parent,s+=".datum"):h=e.group}else e.datum?(s="datum",h=e.datum):i("Invalid field reference: "+c(e));return e.signal||(u(h)?(a[h]=1,h=o(h).map(c).join("][")):h=t(h,n,r,a)),s+"["+h+"]"}(s(t)?t:{datum:t},e,n,r)};function zT(t,e,n,r){var i;if(u(t))n.hasOwnProperty(i=EE+t)||(n[i]=e.scaleRef(t)),i=c(i);else{for(i in e.scales)n[EE+i]=e.scaleRef(i);i=c(EE)+"+"+(t.signal?"("+FT(t.signal,e,n,r)+")":jT(t,e,n,r))}return"_["+i+"]"}var UT=function(t,e,n,r){return s(t)?"("+VT(null,t,e,n,r)+")":t},VT=function(t,e,n,r,i){if(null!=e.gradient)return"this.gradient("+zT((o=e).gradient,n,r,i)+","+c(o.start)+","+c(o.stop)+","+c(o.count)+")";var o,a=e.signal?FT(e.signal,n,r,i):e.color?function(t,e,n,r){function i(t,i,o,a){return"this."+t+"("+[VT(null,i,e,n,r),VT(null,o,e,n,r),VT(null,a,e,n,r)].join(",")+").toString()"}return t.c?i("hcl",t.h,t.c,t.l):t.h||t.s?i("hsl",t.h,t.s,t.l):t.l||t.a?i("lab",t.l,t.a,t.b):t.r||t.g||t.b?i("rgb",t.r,t.g,t.b):null}(e.color,n,r,i):null!=e.field?jT(e.field,n,r,i):void 0!==e.value?c(e.value):void 0;return null!=e.scale&&(a=function(t,e,n,r,i){var o,a,s,c=zT(t.scale,n,r,i);return null!=t.range?(a=c+".range()",e=0==(o=+t.range)?a+"[0]":"($="+a+","+(1===o?"$[$.length-1]":"$[0]+"+o+"*($[$.length-1]-$[0])")+")"):(void 0!==e&&(e=c+"("+e+")"),t.band&&(s=function(t,e){if(!u(t))return-1;var n=e.scaleType(t);return"band"===n||"point"===n?1:0}(t.scale,n))&&(o=(a=c+".bandwidth")+"()"+(1==(o=+t.band)?"":"*"+o),s<0&&(o="("+a+"?"+o+":0)"),e=(e?e+"+":"")+o,t.extra&&(e="(datum.extra?"+c+"(datum.extra.value):"+e+")")),null==e&&(e="0")),e}(e,a,n,r,i)),void 0===a&&(a=null),null!=e.exponent&&(a="Math.pow("+a+","+UT(e.exponent,n,r,i)+")"),null!=e.mult&&(a+="*"+UT(e.mult,n,r,i)),null!=e.offset&&(a+="+"+UT(e.offset,n,r,i)),e.round&&(a="Math.round("+a+")"),a},BT=function(t,e,n){return t+"["+c(e)+"]="+n+";"},HT=function(t,e,n,r,i){var o="";return e.forEach(function(e){var a=VT(t,e,n,r,i);o+=e.test?FT(e.test,n,r,i)+"?"+a+":":a}),BT("o",t,o)};function qT(t,e,n,r){var i,o,s,u={},c="var o=item,datum=o.datum,$;";for(i in t)a(o=t[i])?c+=HT(i,o,r,n,u):(s=VT(i,o,r,n,u),c+=BT("o",i,s));return c+=NT(t,e),{$expr:c+="return 1;",$fields:Object.keys(u),$output:Object.keys(t)}}var GT="mark",WT="frame",YT="legend-label";function XT(t){return s(t)?t:{value:t}}function $T(t,e,n){return null!=n?(t[e]=s(n)&&!a(n)?n:{value:n},1):0}function QT(t,e,n){for(var r in e)n&&n.hasOwnProperty(r)||(t[r]=z(t[r]||{},e[r]));return t}function JT(t,e,n,r,i,o){var a,s;for(s in(o=o||{}).encoders={$encode:a={}},t=function(t,e,n,r,i){var o,a,s={};for(o in"legend"!=n&&0!==String(n).indexOf("axis")||(n=null),a=n===WT?i.group:n===GT?z({},i.mark,i[e]):null)ZT(o,t)||("fill"===o||"stroke"===o)&&(ZT("fill",t)||ZT("stroke",t))||(s[o]={value:a[o]});return P(r).forEach(function(e){var n=i.style&&i.style[e];for(var r in n)ZT(r,t)||(s[r]={value:n[r]})}),(t=z({},t)).enter=z(s,t.enter),t}(t,e,n,r,i.config))a[s]=qT(t[s],e,o,i);return o}function ZT(t,e){return e&&(e.enter&&e.enter[t]||e.update&&e.update[t])}var KT=function(t,e,n,r,i,o,a){return{type:t,name:a?a.name:void 0,role:e,style:a&&a.style||n,key:r,from:i,interactive:!(!a||!a.interactive),encode:QT(o,a,OT)}},tA="group",eA="rule",nA="text",rA=function(t,e,n,r,i,o,a){return{type:tA,name:n,role:t,style:e,from:r,interactive:i,encode:o,marks:a}},iA=function(t){var e=t.role||"";return e.indexOf("axis")&&e.indexOf("legend")?t.type===tA?"scope":e||GT:e},oA=function(t,e){var n=jr(t.type);n||i("Unrecognized transform type: "+c(t.type));var r=RS(n.type.toLowerCase(),null,aA(n,t,e));return t.signal&&e.addSignal(t.signal,e.proxy(r)),r.metadata=n.metadata||{},r};function aA(t,e,n){var r,i,o,a={};for(i=0,o=t.params.length;i<o;++i)a[(r=t.params[i]).name]=sA(r,e,n);return a}function sA(t,e,n){var r,o,s,l=t.type,h=e[t.name];return"index"===l?function(t,e,n){return u(e.from)||i('Lookup "from" parameter must be a string literal.'),n.getData(e.from).lookupRef(n,e.key)}(0,e,n):void 0!==h?"param"===l?(o=n,s=e[(r=t).name],r.array?(a(s)||i("Expected an array of sub-parameters. Instead: "+c(s)),s.map(function(t){return cA(r,t,o)})):cA(r,s,o)):"projection"===l?n.projectionRef(e[t.name]):t.array&&!zS(h)?h.map(function(e){return uA(t,e,n)}):uA(t,h,n):void(t.required&&i("Missing required "+c(e.type)+" parameter: "+c(t.name)))}function uA(t,e,n){var r=t.type;if(zS(e))return lA(r)?i("Expression references can not be signals."):hA(r)?n.fieldRef(e):fA(r)?n.compareRef(e):n.signalRef(e.signal);var o,a,s=t.expr||hA(r);return s&&(a=e)&&a.expr?uS(e.expr,n):s&&(o=e)&&o.field?PS(e.field):lA(r)?uS(e,n):"data"===r?LS(n.getData(e).values):hA(r)?PS(e):fA(r)?n.compareRef(e):e}function cA(t,e,n){var r,o,a,s,u;for(s=0,u=t.params.length;s<u;++s){for(a in(o=t.params[s]).key)if(o.key[a]!==e[a]){o=null;break}if(o)break}return o||i("Unsupported parameter: "+c(e)),r=z(aA(o,e,n),o.key),LS(n.add(rT(r)))}function lA(t){return"expr"===t}function hA(t){return"field"===t}function fA(t){return"compare"===t}function dA(t,e,n,r,i){this.scope=t,this.input=e,this.output=n,this.values=r,this.aggregate=i,this.index={}}dA.fromEntries=function(t,e){var n=e.length,r=1,i=e[0],o=e[n-1],a=e[n-2],s=null;for(t.add(e[0]);r<n;++r)e[r].params.pulse=LS(e[r-1]),t.add(e[r]),"aggregate"===e[r].type&&(s=e[r]);return new dA(t,i,a,o,s)};var pA=dA.prototype;function mA(t){return u(t)?t:null}function gA(t,e,n){var r,i=jS(n.op,n.field);if(e.ops){for(var o=0,a=e.as.length;o<a;++o)if(e.as[o]===i)return}else e.ops=["count"],e.fields=[null],e.as=["count"];n.op&&(e.ops.push((r=n.op.signal)?t.signalRef(r):n.op),e.fields.push(t.fieldRef(n.field)),e.as.push(i))}function vA(t,e,n,r,i,o,a){var u,c,l,h=e[n]||(e[n]={}),f=s(l=o)?(l.order===FS?"-":"+")+jS(l.op,l.field):"",d=mA(i);if(null!=d&&(t=e.scope,u=h[d+=f?"|"+f:""]),!u){var p=o?{field:IS,pulse:e.countsRef(t,i,o)}:{field:t.fieldRef(i),pulse:LS(e.output)};f&&(p.sort=t.sortRef(o)),c=t.add(RS(r,void 0,p)),a&&(e.index[i]=c),u=LS(c),null!=d&&(h[d]=u)}return u}pA.countsRef=function(t,e,n){var r,i,o,a=this.counts||(this.counts={}),s=mA(e);return null!=s&&(t=this.scope,r=a[s]),r?n&&n.field&&gA(t,r.agg.params,n):(o={groupby:t.fieldRef(e,"key"),pulse:LS(this.output)},n&&n.field&&gA(t,o,n),r={agg:i=t.add(BS(o)),ref:LS(r=t.add(GS({pulse:LS(i)})))},null!=s&&(a[s]=r)),r.ref},pA.tuplesRef=function(){return LS(this.values)},pA.extentRef=function(t,e){return vA(t,this,"extent","extent",e,!1)},pA.domainRef=function(t,e){return vA(t,this,"domain","values",e,!1)},pA.valuesRef=function(t,e,n){return vA(t,this,"vals","values",e,n||!0)},pA.lookupRef=function(t,e){return vA(t,this,"lookup","tupleindex",e,!1)},pA.indataRef=function(t,e){return vA(t,this,"indata","tupleindex",e,!0,!0)};var yA=function(t,e,n){var r,i,o=t.remove,a=t.insert,s=t.toggle,u=t.modify,c=t.values,l=e.add(DS());r="if("+t.trigger+',modify("'+n+'",'+[a,o,s,u,c].map(function(t){return null==t?"null":t}).join(",")+"),0)",i=uS(r,e),l.update=i.$expr,l.params=i.$params},wA=function(t,e){var n,r,o,a,s,u,l,h,f,d,p,m,g,v,y,w,b,x,_,M,E,S,T,A,k,C,R,D,L,O,I,N,F,j,U,V=iA(t),B=t.type===tA,H=t.from&&t.from.facet,q=t.layout||"scope"===V||V===WT,G=V===GT||q||H,W=t.overlap;y=e,(v=t.from)?(w=v.facet)&&(B||i("Only group marks can be faceted."),null!=w.field?_=M=LS(y.getData(w.data).output):(v.data?M=LS(y.getData(v.data).aggregate):((x=oA(z({type:"aggregate",groupby:P(w.groupby)},w.aggregate),y)).params.key=y.keyRef(w.groupby),x.params.pulse=LS(y.getData(w.data).output),_=M=LS(y.add(x))),b=y.keyRef(w.groupby,!0))):_=LS(y.add(GS(null,[{}]))),_||(_=v.$ref?v:LS(y.getData(v.data).output)),f=LS(r=e.add(YS({key:(o={key:b,pulse:_,parent:M}).key||(t.key?PS(t.key):void 0),pulse:o.pulse,clean:!B}))),r=a=e.add(GS({pulse:f})),d=LS(r=e.add(KS({markdef:(E=t,{clip:E.clip||!1,interactive:!1!==E.interactive,marktype:E.type,name:E.name||void 0,role:E.role||iA(E),zindex:+E.zindex||void 0}),context:{$context:!0},groups:e.lookup(),parent:e.signals.parent?e.signalRef("parent"):null,index:e.markpath(),pulse:LS(r)}))),(r=e.add(XS(JT(t.encode,t.type,V,t.style,e,{pulse:d})))).params.parent=e.encode(),t.transform&&t.transform.forEach(function(t){var n=oA(t,e);(n.metadata.generates||n.metadata.changes)&&i("Mark transforms should not generate new data."),n.params.pulse=LS(r),e.add(r=n)}),t.sort&&(r=e.add(hT({sort:e.compareRef(t.sort),pulse:LS(r)}))),p=LS(r),(H||q)&&(m=LS(q=e.add(fT({layout:e.objectProperty(t.layout),legendMargin:e.config.legendMargin,mark:d,pulse:p})))),g=LS(s=e.add(qS({mark:d,pulse:m||p}))),B&&(G&&((n=e.operators).pop(),q&&n.pop()),e.pushState(p,m||g,f),H?(D=o,j=(F=(C=t).from.facet).name,U=LS((R=e).getData(F.data).output),F.name||i("Facet must have a name: "+c(F)),F.data||i("Facet must reference a data set: "+c(F)),F.field?N=R.add(iT({field:R.fieldRef(F.field),pulse:U})):F.groupby?N=R.add($S({key:R.keyRef(F.groupby),group:LS(R.proxy(D.parent)),pulse:U})):i("Facet must specify groupby or field: "+c(F)),O=(L=R.fork()).add(GS()),I=L.add(lT({pulse:LS(O)})),L.addData(j,new dA(L,O,O,I)),L.addSignal("parent",null),N.params.subflow={$subflow:EA(C,L).toRuntime()}):G?(S=t,A=(T=e).add(iT({pulse:o.pulse})),(k=T.fork()).add(lT()),k.addSignal("parent",null),A.params.subflow={$subflow:EA(S,k).toRuntime()}):EA(t,e),e.popState(),G&&(q&&n.push(q),n.push(s))),W&&(r={method:!0===W.method?"parity":W.method,pulse:g},W.order&&(r.sort=e.compareRef({field:W.order})),W.bound&&(r.boundScale=e.scaleRef(W.bound.scale),r.boundOrient=W.bound.orient,r.boundTolerance=W.bound.tolerance),g=LS(e.add(nT(r)))),u=e.add(uT({pulse:g})),l=e.add(lT({pulse:LS(u)},void 0,e.parent())),null!=t.name&&(e.addData(h=t.name,new dA(e,a,u,l)),t.on&&t.on.forEach(function(t){(t.insert||t.remove||t.toggle)&&i("Marks only support modify triggers."),yA(t,e,h)}))};function bA(t,e,n,r){var i=e&&(e.update&&e.update[n]||e.enter&&e.enter[n]);return+(i?i.value:r&&(i=t.config.style[r])&&i[n])}function xA(t){var e=GS({},t);return e.metadata={source:!0},e}function _A(t,e){return{scale:t.scale,range:e}}function MA(t,e,n,r,i){return{signal:'flush(range("'+t+'"), scale("'+t+'", datum.value), '+e+","+n+","+r+","+i+")"}}var EA=function(t,e,n){var r=P(t.signals),o=P(t.scales);return n||r.forEach(function(t){$_(t,e)}),P(t.projections).forEach(function(t){!function(t,e){var n={};for(var r in t)"name"!==r&&(n[r]=ET(t[r],e));e.addProjection(t.name,n)}(t,e)}),o.forEach(function(t){var n,r,o;r=e,o=(n=t).type||"linear",gT.hasOwnProperty(o)||i("Unrecognized scale type: "+c(o)),r.addScale(n.name,{type:o,domain:void 0})}),P(t.data).forEach(function(t){!function(t,e){var n=[];t.transform&&t.transform.forEach(function(t){n.push(oA(t,e))}),t.on&&t.on.forEach(function(n){yA(n,e,t.name)}),e.addDataPipeline(t.name,function(t,e,n){var r,i,o,a,s,u=[],c=null,l=!1,h=!1;for(t.values?u.push(c=xA({$ingest:t.values,$format:t.format})):t.url?u.push(c=xA({$request:t.url,$format:t.format})):t.source&&(c=r=P(t.source).map(function(t){return LS(e.getData(t).output)}),u.push(null)),i=0,o=n.length;i<o;++i)s=(a=n[i]).metadata,c||s.source||u.push(c=xA()),u.push(a),s.generates&&(h=!0),s.modifies&&!h&&(l=!0),s.source?c=a:s.changes&&(c=null);return r&&(u[0]=sT({derive:l,pulse:(o=r.length-1)?r:r[0]}),(l||o)&&u.splice(1,0,xA())),c||u.push(xA()),u.push(lT({})),u}(t,e,n))}(t,e)}),o.forEach(function(t){!function(t,e){var n,r,o,l,h=e.getScale(t.name).params;for(n in h.domain=_T(t.domain,t,e),null!=t.range&&(h.range=function t(e,n,r){var o,s,l=e.range,h=n.config.range;if(l.signal)return n.signalRef(l.signal);if(u(l)){if(h&&h.hasOwnProperty(l))return t(e=z({},e,{range:h[l]}),n,r);"width"===l?l=[0,{signal:"width"}]:"height"===l?l=yT(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:i("Unrecognized scale range value: "+c(l))}else{if(l.scheme)return r.scheme=bT(l.scheme,n),l.extent&&(r.schemeExtent=(s=n,(o=l.extent).signal?s.signalRef(o.signal):o.map(function(t){return bT(t,s)}))),void(l.count&&(r.schemeCount=bT(l.count,n)));if(l.step)return void(r.rangeStep=bT(l.step,n));if(yT(e.type)&&!a(l))return _T(l,e,n);a(l)||i("Unsupported range type: "+c(l))}return l.map(function(t){return bT(t,n)})}(t,e,h)),null!=t.interpolate&&((o=h).interpolate=bT((r=t.interpolate).type||r),null!=r.gamma&&(o.interpolateGamma=bT(r.gamma))),null!=t.nice&&(h.nice=s(l=t.nice)?{interval:bT(l.interval),step:bT(l.step)}:bT(l)),t)h.hasOwnProperty(n)||"name"===n||(h[n]=bT(t[n],e))}(t,e)}),r.forEach(function(t){!function(t,e){var n=e.getSignal(t.name);if(t.update){var r=uS(t.update,e);n.update=r.$expr,n.params=r.$params}t.on&&t.on.forEach(function(t){!function(t,e,n){var r,o,a=t.events,s=t.update,l=t.encode,h=[];a||i("Signal update missing events specification."),u(a)&&(dS="view",pS=ES,a=TS(a.trim()).map(AS)),(a=P(a).filter(function(t){return t.signal||t.scale?(h.push(t),0):1})).length&&h.push(a.length>1?{merge:a}:a[0]),null!=l&&(s&&i("Signal encode and update are mutually exclusive."),s="encode(item(),"+c(l)+")"),r=u(s)?uS(s,e,kS):null!=s.expr?uS(s.expr,e,kS):null!=s.value?s.value:null!=s.signal?{$expr:"_.value",$params:{value:e.signalRef(s.signal)}}:i("Invalid signal update specification."),o={target:n,update:r},t.force&&(o.options={force:!0}),h.forEach(function(t){var n,r;t={source:(n=t,r=e,n.signal?r.getSignal(n.signal).id:n.scale?r.getScale(n.scale).id:hS(n,r))},e.addUpdate(z(t,o))})}(t,e,n.id)})}(t,e)}),P(t.axes).forEach(function(t){!function(t,e){var n,r,i,o,a,s,u,c,l,h,f,d,p,m,g,v,y,w,b,x,_,M,E,S,T,A,k,C,R,D,L,O,P,I,N,F,j,U,V,B,H,q,G,W,Y,X,$,Q,J,Z,K,tt,et,nt,rt,it,ot,at,st,ut,ct,lt,ht,ft,dt,pt,mt,gt,vt,yt,wt,bt,xt,_t,Mt,Et,St,Tt,At,kt,Ct,Rt,Dt,Lt,Ot,Pt,It,Nt,Ft,jt=(l=(c=e).config,f=(h=(u=t).orient)===ST||h===AT?l.axisX:l.axisY,d=l["axis"+h[0].toUpperCase()+h.slice(1)],p="band"===c.scaleType(u.scale)&&l.axisBand,f||d||p?z({},l.axis,f,d,p):l.axis),zt=t.encode||{},Ut=zt.axis||{},Vt=Ut.name||void 0,Bt=!!Ut.interactive,Ht=Ut.style;n={orient:t.orient,ticks:!!US(t.ticks,jt.ticks),labels:!!US(t.labels,jt.labels),grid:!!US(t.grid,jt.grid),domain:!!US(t.domain,jt.domain),title:!!US(t.title,!1)},r=LS(e.add(GS({},[n]))),Ut=QT({update:{range:{signal:'abs(span(range("'+t.scale+'")))'},offset:XT(US(t.offset,0)),position:XT(US(t.position,0)),titlePadding:XT(US(t.titlePadding,jt.titlePadding)),minExtent:XT(US(t.minExtent,jt.minExtent)),maxExtent:XT(US(t.maxExtent,jt.maxExtent))}},zt.axis,OT),i=LS(e.add(HS({scale:e.scaleRef(t.scale),extra:jt.tickExtra,count:e.objectProperty(t.tickCount),values:e.objectProperty(t.values),formatSpecifier:e.property(t.format)}))),s=[],n.grid&&s.push((g=jt,v=zt.grid,y=i,A=(m=t).gridScale,C=(k=(T=m.orient)===TT||T===ST?1:-1)*m.offset||0,(D={}).enter=w={opacity:R={value:0}},$T(w,"stroke",g.gridColor),$T(w,"strokeWidth",g.gridWidth),$T(w,"strokeDash",g.gridDash),D.exit=b={opacity:R},D.update=x={},$T(x,"opacity",g.gridOpacity),T===ST||T===AT?(_="x",M="y",S="height"):(_="y",M="x",S="width"),E=M+"2",x[_]=w[_]=b[_]={scale:m.scale,field:CT,band:g.bandPosition,round:g.tickRound,extra:g.tickExtra,offset:g.tickOffset},A?(w[M]={scale:A,range:0,mult:k,offset:C},x[E]=w[E]={scale:A,range:1,mult:k,offset:C}):(w[M]={value:C},x[E]=w[E]={signal:S,mult:k,offset:C}),KT(eA,"axis-grid",null,CT,y,D,v))),n.ticks&&(o=US(t.tickSize,jt.tickSize),s.push((O=jt,P=zt.ticks,I=i,N=o,q=(H=(L=t).orient)===TT||H===ST?-1:1,(W={}).enter=F={opacity:G={value:0}},$T(F,"stroke",O.tickColor),$T(F,"strokeWidth",O.tickWidth),W.exit=j={opacity:G},W.update=U={opacity:{value:1}},(V=XT(N)).mult=q,B={scale:L.scale,field:CT,band:O.bandPosition,round:O.tickRound,extra:O.tickExtra,offset:O.tickOffset},H===ST||H===AT?(U.y=F.y=G,U.y2=F.y2=V,U.x=F.x=j.x=B):(U.x=F.x=G,U.x2=F.x2=V,U.y=F.y=j.y=B),KT(eA,"axis-tick",null,CT,I,W,P)))),n.labels&&s.push((X=jt,$=zt.labels,Q=i,J=o=n.ticks?o:0,it=(rt=(Y=t).orient)===TT||rt===ST?-1:1,ot=Y.scale,at=US(Y.labelPadding,X.labelPadding),st=US(Y.labelBound,X.labelBound),ct=null!=(ut=US(Y.labelFlush,X.labelFlush))&&!1!==ut&&(ut=+ut)===ut,lt=+US(Y.labelFlushOffset,X.labelFlushOffset),ht=US(Y.labelOverlap,X.labelOverlap),(dt={}).enter=Z={opacity:ft={value:0}},$T(Z,"angle",X.labelAngle),$T(Z,"fill",X.labelColor),$T(Z,"font",X.labelFont),$T(Z,"fontSize",X.labelFontSize),$T(Z,"fontWeight",X.labelFontWeight),$T(Z,"limit",X.labelLimit),dt.exit=K={opacity:ft},dt.update=tt={opacity:{value:1},text:{field:kT}},(et=XT(J)).mult=it,et.offset=XT(at),et.offset.mult=it,nt={scale:ot,field:CT,band:.5,offset:X.tickOffset},rt===ST||rt===AT?(tt.y=Z.y=et,tt.x=Z.x=K.x=nt,$T(tt,"align",ct?MA(ot,ut,'"left"','"right"','"center"'):"center"),ct&&lt&&$T(tt,"dx",MA(ot,ut,-lt,lt,0)),$T(tt,"baseline",rt===ST?"bottom":"top")):(tt.x=Z.x=et,tt.y=Z.y=K.y=nt,$T(tt,"align","right"===rt?"left":"right"),$T(tt,"baseline",ct?MA(ot,ut,'"bottom"','"top"','"middle"'):"middle"),ct&&lt&&$T(tt,"dy",MA(ot,ut,lt,-lt,0))),Y=KT(nA,"axis-label",RT,CT,Q,dt,$),(ht||st)&&(Y.overlap={method:ht,order:"datum.index",bound:st?{scale:ot,orient:rt,tolerance:+st}:null}),Y)),n.domain&&s.push((mt=jt,gt=zt.domain,vt=r,Mt=(pt=t).orient,(St={}).enter=yt={opacity:Et={value:0}},$T(yt,"stroke",mt.domainColor),$T(yt,"strokeWidth",mt.domainWidth),St.exit={opacity:Et},St.update=wt={opacity:{value:1}},Mt===ST||Mt===AT?(bt="x",_t="y"):(bt="y",_t="x"),xt=bt+"2",yt[_t]=Et,wt[bt]=yt[bt]=_A(pt,0),wt[xt]=yt[xt]=_A(pt,1),KT(eA,"axis-domain",null,null,vt,St,gt))),n.title&&s.push((At=jt,kt=zt.title,Ct=r,Pt=(Tt=t).title,It=(Ot=Tt.orient)===TT||Ot===ST?-1:1,Nt=Ot===ST||Ot===AT,(Ft={}).enter=Rt={opacity:{value:0}},$T(Rt,"align",At.titleAlign),$T(Rt,"fill",At.titleColor),$T(Rt,"font",At.titleFont),$T(Rt,"fontSize",At.titleFontSize),$T(Rt,"fontWeight",At.titleFontWeight),$T(Rt,"limit",At.titleLimit),Ft.exit={opacity:{value:0}},Ft.update=Dt={opacity:{value:1},text:Pt&&Pt.signal?{signal:Pt.signal}:{value:Pt+""}},Lt={scale:Tt.scale,range:.5},Nt?(Dt.x=Lt,Dt.angle={value:0},Dt.baseline={value:Ot===ST?"bottom":"top"}):(Dt.y=Lt,Dt.angle={value:90*It},Dt.baseline={value:"bottom"}),$T(Dt,"angle",At.titleAngle),$T(Dt,"baseline",At.titleBaseline),!$T(Dt,"x",At.titleX)&&Nt&&!ZT("x",kt)&&(Ft.enter.auto={value:!0}),!$T(Dt,"y",At.titleY)&&!Nt&&!ZT("y",kt)&&(Ft.enter.auto={value:!0}),KT(nA,"axis-title",DT,null,Ct,Ft,kt))),a=rA("axis",Ht,Vt,r,Bt,Ut,s),t.zindex&&(a.zindex=t.zindex),wA(a,e)}(t,e)}),P(t.marks).forEach(function(t){wA(t,e)}),P(t.legends).forEach(function(t){!function(t,e){var n,r,o,a,s,u,c,l,h,f,d,p,m,g,v,y,w,b,x,_,M,E,S,T,A,k,C,R,D,L,O,P,I,N,F,j,z,U,V,B,H,q,G,W,Y,X,$=t.type||"symbol",Q=e.config.legend,J=t.encode||{},Z=J.legend||{},K=Z.name||void 0,tt=!!Z.interactive,et=Z.style,nt=t.size||t.shape||t.fill||t.stroke||t.strokeDash||t.opacity;nt||i("Missing valid scale for legend."),n={orient:US(t.orient,Q.orient),title:null!=t.title},r=LS(e.add(GS(null,[n]))),Z=QT({enter:(h=Q,f={},$T(f,"fill",h.fillColor)+$T(f,"stroke",h.strokeColor)+$T(f,"strokeWidth",h.strokeWidth)+$T(f,"strokeDash",h.strokeDash)+$T(f,"cornerRadius",h.cornerRadius)?f:void 0),update:{offset:XT(US(t.offset,Q.offset)),padding:XT(US(t.padding,Q.padding)),titlePadding:XT(US(t.titlePadding,Q.titlePadding))}},Z,OT),u={update:{x:{field:{group:"padding"}},y:{field:{group:"padding"}},entryPadding:XT(US(t.entryPadding,Q.entryPadding))}},"gradient"===$?(o=LS(e.add(ZS({type:"gradient",scale:e.scaleRef(nt),count:e.objectProperty(t.tickCount),values:e.objectProperty(t.values),formatSpecifier:e.property(t.format)}))),l=[(I=nt,N=Q,F=J.gradient,U={value:0},V={},V.enter=j={opacity:U,x:U,y:U},$T(j,"width",N.gradientWidth),$T(j,"height",N.gradientHeight),$T(j,"stroke",N.gradientStrokeColor),$T(j,"strokeWidth",N.gradientStrokeWidth),V.exit={opacity:U},V.update=z={x:U,y:U,fill:{gradient:I},opacity:{value:1}},$T(z,"width",N.gradientWidth),$T(z,"height",N.gradientHeight),KT("rect","legend-gradient",null,void 0,void 0,V,F)),(k=Q,C=J.labels,R=o,O={value:0},P={},P.enter=D={opacity:O},$T(D,"fill",k.labelColor),$T(D,"font",k.labelFont),$T(D,"fontSize",k.labelFontSize),$T(D,"fontWeight",k.labelFontWeight),$T(D,"baseline",k.gradientLabelBaseline),$T(D,"limit",k.gradientLabelLimit),P.exit={opacity:O},P.update=L={opacity:{value:1},text:{field:kT}},D.x=L.x={field:"perc",mult:k.gradientWidth},D.y=L.y={value:k.gradientHeight,offset:k.gradientLabelOffset},D.align=L.align={signal:'datum.perc<=0?"left":datum.perc>=1?"right":"center"'},KT(nA,YT,RT,"perc",R,P,C))]):(o=LS(e.add(ZS(c={scale:e.scaleRef(nt),count:e.objectProperty(t.tickCount),values:e.objectProperty(t.values),formatSpecifier:e.property(t.format)}))),l=[(b=t,x=Q,_=J.symbols,M=o,T={value:0},A={},A.enter=E={opacity:T},$T(E,"shape",x.symbolType),$T(E,"size",x.symbolSize),$T(E,"strokeWidth",x.symbolStrokeWidth),b.fill||($T(E,"fill",x.symbolFillColor),$T(E,"stroke",x.symbolStrokeColor)),A.exit={opacity:T},A.update=S={opacity:{value:1}},E.x=S.x={field:"offset",mult:.5},E.y=S.y={field:"size",mult:.5,offset:{field:"total",offset:{field:{group:"entryPadding"},mult:{field:"index"}}}},LT.forEach(function(t){b[t]&&(S[t]=E[t]={scale:b[t],field:CT})}),KT("symbol","legend-symbol",null,CT,M,A,_)),(d=Q,p=J.labels,m=o,y={value:0},w={},w.enter=g={opacity:y},$T(g,"align",d.labelAlign),$T(g,"baseline",d.labelBaseline),$T(g,"fill",d.labelColor),$T(g,"font",d.labelFont),$T(g,"fontSize",d.labelFontSize),$T(g,"fontWeight",d.labelFontWeight),$T(g,"limit",d.labelLimit),w.exit={opacity:y},w.update=v={opacity:{value:1},text:{field:kT}},g.x=v.x={field:"offset",offset:d.labelOffset},g.y=v.y={field:"size",mult:.5,offset:{field:"total",offset:{field:{group:"entryPadding"},mult:{field:"index"}}}},KT(nA,YT,RT,CT,m,w,p))],c.size=function(t,e,n){var r=bA(e,n[1].encode,"fontSize",RT);if(t.size)return{$expr:"Math.max(Math.ceil(Math.sqrt(_.scale(datum))),"+r+")"};var i=bA(e,n[0].encode,"size");return Math.max(Math.ceil(Math.sqrt(i)),r)}(t,e,l)),l=[rA("legend-entry",null,null,r,tt,u,l)],n.title&&(B=Q,H=J.title,q=r,Y=t.title,(X={}).enter=G={x:{field:{group:"padding"}},y:{field:{group:"padding"}},opacity:W={value:0}},$T(G,"align",B.titleAlign),$T(G,"baseline",B.titleBaseline),$T(G,"fill",B.titleColor),$T(G,"font",B.titleFont),$T(G,"fontSize",B.titleFontSize),$T(G,"fontWeight",B.titleFontWeight),$T(G,"limit",B.titleLimit),X.exit={opacity:W},X.update={opacity:{value:1},text:Y&&Y.signal?{signal:Y.signal}:{value:Y+""}},s=KT(nA,"legend-title",DT,null,q,X,H),u.update.y.offset={field:{group:"titlePadding"},offset:bA(e,s.encode,"fontSize",DT)},l.push(s)),a=rA("legend",et,K,r,tt,Z,l),t.zindex&&(a.zindex=t.zindex),wA(a,e)}(t,e)}),t.title&&function(t,e){t=u(t)?{text:t}:t;var n,r,i=e.config.title,o=z({},t.encode);n=LS(e.add(GS(null,[{orient:null!=t.orient?t.orient:i.orient}]))),o.name=t.name,o.interactive=t.interactive,r=function(t,e,n,r){var i,o,a,u,c,l,h=t.text,f=t.orient||e.orient,d=t.anchor||e.anchor,p=f===TT||f===ST?-1:1,m=f===ST||f===AT,g={group:m?"width":"height"},v={};return v.enter=i={opacity:{value:0}},$T(i,"fill",e.color),$T(i,"font",e.font),$T(i,"fontSize",e.fontSize),$T(i,"fontWeight",e.fontWeight),v.exit={opacity:{value:0}},v.update=o={opacity:{value:1},text:s(h)?h:{value:h+""},offset:XT((null!=t.offset?t.offset:e.offset)||0)},"start"===d?(c=0,l="left"):"end"===d?(c=1,l="right"):(c=.5,l="center"),a={field:g,mult:c},u=p<0?{value:0}:m?{field:{group:"height"}}:{field:{group:"width"}},m?(o.x=a,o.y=u,o.angle={value:0},o.baseline={value:f===ST?"bottom":"top"}):(o.x=u,o.y=a,o.angle={value:90*p},o.baseline={value:"bottom"}),o.align={value:l},o.limit={field:g},$T(o,"angle",e.angle),$T(o,"baseline",e.baseline),$T(o,"limit",e.limit),KT(nA,"title",t.style||"group-title",null,r,v,n)}(t,i,o,n),t.zindex&&(r.zindex=t.zindex),wA(r,e)}(t.title,e),e.parseLambdas(),e},SA=nt(["width","height","padding","autosize"]);function TA(t){this.config=t,this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.background=null,this.eventConfig=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function AA(t){this.config=t.config,this.field=Object.create(t.field),this.signals=Object.create(t.signals),this.lambdas=Object.create(t.lambdas),this.scales=Object.create(t.scales),this.events=Object.create(t.events),this.data=Object.create(t.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++t._nextsub[0],this._nextsub=t._nextsub,this._parent=t._parent.slice(),this._encode=t._encode.slice(),this._lookup=t._lookup.slice(),this._markpath=t._markpath}var kA=TA.prototype=AA.prototype;kA.fork=function(){return new AA(this)},kA.toRuntime=function(){return this.finish(),{background:this.background,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig}},kA.id=function(){return(this._subid?this._subid+":":0)+this._id++},kA.add=function(t){return this.operators.push(t),t.id=this.id(),t.refs&&(t.refs.forEach(function(e){e.$ref=t.id}),t.refs=null),t},kA.proxy=function(t){var e=t instanceof CS?LS(t):t;return this.add(aT({value:e}))},kA.addStream=function(t){return this.streams.push(t),t.id=this.id(),t},kA.addUpdate=function(t){return this.updates.push(t),t},kA.finish=function(){var t,e;for(t in this.root&&(this.root.root=!0),this.signals)this.signals[t].signal=t;for(t in this.scales)this.scales[t].scale=t;function n(t,e,n){var r;t&&((r=t.data||(t.data={}))[e]||(r[e]=[])).push(n)}for(t in this.data)for(var r in n((e=this.data[t]).input,t,"input"),n(e.output,t,"output"),n(e.values,t,"values"),e.index)n(e.index[r],t,"index:"+r);return this},kA.pushState=function(t,e,n){this._encode.push(LS(this.add(lT({pulse:t})))),this._parent.push(e),this._lookup.push(n?LS(this.proxy(n)):null),this._markpath.push(-1)},kA.popState=function(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},kA.parent=function(){return x(this._parent)},kA.encode=function(){return x(this._encode)},kA.lookup=function(){return x(this._lookup)},kA.markpath=function(){var t=this._markpath;return++t[t.length-1]},kA.fieldRef=function(t,e){if(u(t))return PS(t,e);t.signal||i("Unsupported field reference: "+c(t));var n,r=t.signal,o=this.field[r];return o||(n={name:this.signalRef(r)},e&&(n.as=e),this.field[r]=o=LS(this.add(QS(n)))),o},kA.compareRef=function(t){function e(t){return zS(t)?(r=!0,LS(n[t.signal])):t}var n=this.signals,r=!1,i=P(t.field).map(e),o=P(t.order).map(e);return r?LS(this.add(WS({fields:i,orders:o}))):NS(i,o)},kA.keyRef=function(t,e){var n,r=this.signals,i=!1;return t=P(t).map(function(t){return zS(t)?(i=!0,LS(r[t.signal])):t}),i?LS(this.add(JS({fields:t,flat:e}))):(n={$key:t},e&&(n.$flat=!0),n)},kA.sortRef=function(t){if(!t)return t;var e=[jS(t.op,t.field),OS],n=t.order||"ascending";return n.signal?LS(this.add(WS({fields:e,orders:[n=this.signalRef(n.signal),n]}))):NS(e,[n,n])},kA.event=function(t,e){var n=t+":"+e;if(!this.events[n]){var r=this.id();this.streams.push({id:r,source:t,type:e}),this.events[n]=r}return this.events[n]},kA.addSignal=function(t,e){this.signals.hasOwnProperty(t)&&i("Duplicate signal name: "+c(t));var n=e instanceof CS?e:this.add(DS(e));return this.signals[t]=n},kA.getSignal=function(t){return this.signals[t]||i("Unrecognized signal name: "+c(t)),this.signals[t]},kA.signalRef=function(t){return this.signals[t]?LS(this.signals[t]):(this.lambdas.hasOwnProperty(t)||(this.lambdas[t]=this.add(DS(null))),LS(this.lambdas[t]))},kA.parseLambdas=function(){for(var t=Object.keys(this.lambdas),e=0,n=t.length;e<n;++e){var r=t[e],i=uS(r,this),o=this.lambdas[r];o.params=i.$params,o.update=i.$expr}},kA.property=function(t){return t&&t.signal?this.signalRef(t.signal):t},kA.objectProperty=function(t){return t&&s(t)?this.signalRef(t.signal||function t(e){return(a(e)?function(e){for(var n,r="[",i=0,o=e.length;i<o;++i)n=e[i],r+=(i>0?",":"")+(s(n)?n.signal||t(n):c(n));return r+"]"}:function(e){var n,r,i="{",o=0;for(n in e)r=e[n],i+=(++o>1?",":"")+c(n)+":"+(s(r)?r.signal||t(r):c(r));return i+"}"})(e)}(t)):t},kA.addBinding=function(t,e){this.bindings||i("Nested signals do not support binding: "+c(t)),this.bindings.push(z({signal:t},e))},kA.addScaleProj=function(t,e){this.scales.hasOwnProperty(t)&&i("Duplicate scale or projection name: "+c(t)),this.scales[t]=this.add(e)},kA.addScale=function(t,e){this.addScaleProj(t,cT(e))},kA.addProjection=function(t,e){this.addScaleProj(t,oT(e))},kA.getScale=function(t){return this.scales[t]||i("Unrecognized scale name: "+c(t)),this.scales[t]},kA.projectionRef=kA.scaleRef=function(t){return LS(this.getScale(t))},kA.projectionType=kA.scaleType=function(t){return this.getScale(t).params.type},kA.addData=function(t,e){return this.data.hasOwnProperty(t)&&i("Duplicate data set name: "+c(t)),this.data[t]=e},kA.getData=function(t){return this.data[t]||i("Undefined data set name: "+c(t)),this.data[t]},kA.addDataPipeline=function(t,e){return this.data.hasOwnProperty(t)&&i("Duplicate data set name: "+c(t)),this.addData(t,dA.fromEntries(this,e))};var CA=function(t){var e={padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:OA},area:{fill:OA},image:null,line:{stroke:OA,strokeWidth:LA},path:{stroke:OA},rect:{fill:OA},rule:{stroke:PA},shape:{stroke:OA},symbol:{fill:OA,size:64},text:{fill:PA,font:RA,fontSize:11},style:{"guide-label":{fill:PA,font:RA,fontSize:10},"guide-title":{fill:PA,font:RA,fontSize:11,fontWeight:"bold"},"group-title":{fill:PA,font:RA,fontSize:13,fontWeight:"bold"},point:{size:DA,strokeWidth:LA,shape:"circle"},circle:{size:DA,strokeWidth:LA},square:{size:DA,strokeWidth:LA,shape:"square"},cell:{fill:"transparent",stroke:NA}},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:IA,grid:!1,gridWidth:1,gridColor:NA,gridOpacity:1,labels:!0,labelAngle:0,labelLimit:180,labelPadding:2,ticks:!0,tickColor:IA,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titleAlign:"center",titlePadding:4},axisBand:{tickOffset:-1},legend:{orient:"right",offset:18,padding:0,entryPadding:5,titlePadding:5,gradientWidth:100,gradientHeight:20,gradientStrokeColor:NA,gradientStrokeWidth:0,gradientLabelBaseline:"top",gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelOffset:8,labelLimit:160,symbolType:"circle",symbolSize:100,symbolFillColor:"transparent",symbolStrokeColor:IA,symbolStrokeWidth:1.5,titleAlign:"left",titleBaseline:"top",titleLimit:180},title:{orient:"top",anchor:"middle",offset:4},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues",extent:[.2,1]},heatmap:{scheme:"viridis"},ramp:{scheme:"blues",extent:[.2,1]},diverging:{scheme:"blueorange"},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}};return(t||[]).forEach(function(t){var n,r,i;if(t)for(n in t)if("style"===n)for(n in i=e.style||(e.style={}),t.style)i[n]=z(i[n]||{},t.style[n]);else e[n]=s(r=t[n])&&!a(r)?z(s(e[n])?e[n]:{},r):r}),e},RA="sans-serif",DA=30,LA=2,OA="#4c78a8",PA="#000",IA="#888",NA="#ddd";function FA(t,e,n){";"!==e[e.length-1]&&(e="return("+e+");");var r=Function.apply(null,t.concat(e));return n&&n.functions?r.bind(n.functions):r}function jA(t,e){return FA(["event"],t,e)}function zA(t,e,n){var r,i;for(r in n=n||{},t)(i=t[r])&&i.$expr&&i.$params&&zA(i.$params,e,n),n[r]=a(i)?i.map(function(t){return UA(t,e)}):UA(i,e);return n}function UA(t,e){if(!t||!s(t))return t;for(var n,r=0,i=VA.length;r<i;++r)if(t.hasOwnProperty((n=VA[r]).key))return n.parse(t,e);return t}var VA=[{key:"$ref",parse:function(t,e){return e.get(t.$ref)||i("Operator not defined: "+t.$ref)}},{key:"$key",parse:function(t,e){var n="k:"+t.$key+"_"+!!t.$flat;return e.fn[n]||(e.fn[n]=X(t.$key,t.$flat))}},{key:"$expr",parse:function(t,n){var r="e:"+t.$expr;return n.fn[r]||(n.fn[r]=e(FA(["datum","_"],t.$expr,n),t.$fields,t.$name))}},{key:"$field",parse:function(t,e){if(!t.$field)return null;var n="f:"+t.$field+"_"+t.$name;return e.fn[n]||(e.fn[n]=l(t.$field,t.$name))}},{key:"$encode",parse:function(t,n){var r,i,o=t.$encode,a={};for(r in o)a[r]=e(FA(["item","_"],(i=o[r]).$expr,n),i.$fields),a[r].output=i.$output;return a}},{key:"$compare",parse:function(t,e){var n="c:"+t.$compare+"_"+t.$order,r=P(t.$compare).map(function(t){return t&&t.$tupleid?ct:t});return e.fn[n]||(e.fn[n]=N(r,t.$order))}},{key:"$context",parse:function(t,e){return e}},{key:"$subflow",parse:function(t,e){var n=t.$subflow;return function(t,r,i){var o=HA(n,e.fork()),a=o.get(n.operators[0].id),s=o.signals.parent;return s&&s.set(i),a}}},{key:"$tupleid",parse:function(){return ct}}];function BA(t){return(t+"").toLowerCase()}var HA=function(t,e){var n=t.operators||[];return t.background&&(e.background=t.background),t.eventConfig&&(e.eventConfig=t.eventConfig),n.forEach(function(t){!function(t,e){"operator"!==BA(t.type)&&t.type?e.transform(t,t.type):e.operator(t,t.update?FA(["_"],t.update,e):null)}(t,e)}),n.forEach(function(t){var n,r,o,a;r=e,(n=t).params&&((o=r.get(n.id))||i("Invalid operator id: "+n.id),a=zA(n.params,r),r.dataflow.connect(o,o.parameters(a)))}),(t.streams||[]).forEach(function(t){var n,r,o,a,s;r=e,a=null!=(n=t).filter?jA(n.filter,r):void 0,s=null!=n.stream?r.get(n.stream):void 0,n.source?s=r.events(n.source,n.type,a):n.merge&&(s=(o=n.merge.map(r.get.bind(r)))[0].merge.apply(o[0],o.slice(1))),n.between&&(o=n.between.map(r.get.bind(r)),s=s.between(o[0],o[1])),n.filter&&(s=s.filter(a)),null!=n.throttle&&(s=s.throttle(+n.throttle)),null!=n.debounce&&(s=s.debounce(+n.debounce)),null==s&&i("Invalid stream definition: "+JSON.stringify(n)),n.consume&&s.consume(!0),r.stream(n,s)}),(t.updates||[]).forEach(function(t){!function(t,e){var n,r=e.get(t.source),o=t.update,a=void 0;r||i("Source not defined: "+t.source),n=t.target&&t.target.$expr?jA(t.target.$expr,e):e.get(t.target),o&&o.$expr&&(o.$params&&(a=zA(o.$params,e)),o=FA(["_","event"],o.$expr,e)),e.update(t,r,n,o,a)}(t,e)}),e.resolve()},qA={skip:!0},GA=function(t,e,n){return new WA(t,e,n)};function WA(t,e,n){this.dataflow=t,this.transforms=e,this.events=t.events.bind(t),this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function YA(t){this.dataflow=t.dataflow,this.transforms=t.transforms,this.functions=t.functions,this.events=t.events,this.signals=Object.create(t.signals),this.scales=Object.create(t.scales),this.nodes=Object.create(t.nodes),this.data=Object.create(t.data),this.fn=Object.create(t.fn),t.functions&&(this.functions=Object.create(t.functions),this.functions.context=this)}WA.prototype=YA.prototype={fork:function(){var t=new YA(this);return(this.subcontext||(this.subcontext=[])).push(t),t},get:function(t){return this.nodes[t]},set:function(t,e){return this.nodes[t]=e},add:function(t,e){var n,r=this,i=r.dataflow;if(r.set(t.id,e),"collect"===BA(t.type)&&(n=t.value)&&(n.$ingest?i.ingest(e,n.$ingest,n.$format):n.$request?i.request(e,n.$request,n.$format):i.pulse(e,i.changeset().insert(n))),t.root&&(r.root=e),t.parent){var o=r.get(t.parent.$ref);o?(i.connect(o,[e]),e.targets().add(o)):(r.unresolved=r.unresolved||[]).push(function(){o=r.get(t.parent.$ref),i.connect(o,[e]),e.targets().add(o)})}if(t.signal&&(r.signals[t.signal]=e),t.scale&&(r.scales[t.scale]=e),t.data)for(var a in t.data)n=r.data[a]||(r.data[a]={}),t.data[a].forEach(function(t){n[t]=e})},resolve:function(){return(this.unresolved||[]).forEach(function(t){t()}),delete this.unresolved,this},operator:function(t,e,n){this.add(t,this.dataflow.add(t.value,e,n,t.react))},transform:function(t,e,n){this.add(t,this.dataflow.add(this.transforms[BA(e)],n))},stream:function(t,e){this.set(t.id,e)},update:function(t,e,n,r,i){this.dataflow.on(e,n,r,i,t.options)},getState:function(t){var e=this,n={};if(t.signals){var r=n.signals={};Object.keys(e.signals).forEach(function(n){var i=e.signals[n];t.signals(n,i)&&(r[n]=i.value)})}if(t.data){var i=n.data={};Object.keys(e.data).forEach(function(n){var r=e.data[n];t.data(n,r)&&(i[n]=r.input.value)})}return e.subcontext&&!1!==t.recurse&&(n.subcontext=e.subcontext.map(function(e){return e.getState(t)})),n},setState:function(t){var e=this,n=e.dataflow,r=t.data,i=t.signals;Object.keys(i||{}).forEach(function(t){n.update(e.signals[t],i[t],qA)}),Object.keys(r||{}).forEach(function(t){n.pulse(e.data[t].input,n.changeset().remove(g).insert(r[t]))}),(t.subcontext||[]).forEach(function(t,n){var r=e.subcontext[n];r&&r.setState(t)})}};var XA=function(t,e,n){return HA(e,GA(t,Fr,n||eS))},$A="padding";function QA(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===$A?r.left+r.right:0)}function JA(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===$A?r.top+r.bottom:0)}function ZA(t,e){return e.modified&&a(e.input.value)&&t.indexOf("_:vega:_")}function KA(t,e){return!("parent"===t||e instanceof Fr.proxy)}function tk(t,e){var n=this;e=e||{},Lr.call(n),n.loader(e.loader||n._loader),n.logLevel(e.logLevel||0),n._el=null,n._renderType=e.renderer||Bc.Canvas,n._scenegraph=new Xu;var r=n._scenegraph.root;n._renderer=null,n._redraw=!0,n._handler=(new sc).scene(r),n._eventListeners=[],n._preventDefault=!1;var i,o,s=XA(n,t,e.functions);n._runtime=s,n._signals=s.signals,n._bind=(t.bindings||[]).map(function(t){return{state:null,param:z({},t)}}),s.root&&s.root.set(r),r.source=s.data.root.input,n.pulse(s.data.root.input,n.changeset().insert(r.items)),n._background=s.background||null,n._eventConfig=((o=(i=z({},i=s.eventConfig)).defaults)&&(a(o.prevent)&&(o.prevent=nt(o.prevent)),a(o.allow)&&(o.allow=nt(o.allow))),i),n._width=n.width(),n._height=n.height(),n._viewWidth=QA(n,n._width),n._viewHeight=JA(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function(t){var e=t._signals,n=e.width,r=e.height,i=e.padding;function o(){t._autosize=t._resize=1}t._resizeWidth=t.add(null,function(e){t._width=e.size,t._viewWidth=QA(t,e.size),o()},{size:n}),t._resizeHeight=t.add(null,function(e){t._height=e.size,t._viewHeight=JA(t,e.size),o()},{size:r});var a=t.add(null,o,{pad:i});t._resizeWidth.rank=n.rank+1,t._resizeHeight.rank=r.rank+1,a.rank=i.rank+1}(n),b_(n)}var ek=H(tk,Lr);function nk(t,e){return t._signals.hasOwnProperty(e)?t._signals[e]:i("Unrecognized signal name: "+c(e))}ek.run=function(t){if(Lr.prototype.run.call(this,t),this._redraw||this._resize)try{this.render()}catch(t){this.error(t)}return this},ek.render=function(){var t,e;return this._renderer&&(this._resize&&(this._resize=0,e=S_(t=this),t._renderer.background(t._background),t._renderer.resize(M_(t),E_(t),e),t._handler.origin(e)),this._renderer.render(this._scenegraph.root)),this._redraw=!1,this},ek.dirty=function(t){this._redraw=!0,this._renderer&&this._renderer.dirty(t)},ek.container=function(){return this._el},ek.scenegraph=function(){return this._scenegraph},ek.signal=function(t,e,n){var r=nk(this,t);return 1===arguments.length?r.value:this.update(r,e,n)},ek.background=function(t){return arguments.length?(this._background=t,this._resize=1,this):this._background},ek.width=function(t){return arguments.length?this.signal("width",t):this.signal("width")},ek.height=function(t){return arguments.length?this.signal("height",t):this.signal("height")},ek.padding=function(t){return arguments.length?this.signal("padding",t):this.signal("padding")},ek.autosize=function(t){return arguments.length?this.signal("autosize",t):this.signal("autosize")},ek.renderer=function(t){return arguments.length?(qc(t)||i("Unrecognized renderer type: "+t),t!==this._renderType&&(this._renderType=t,this._renderer&&(this._renderer=null,this.initialize(this._el))),this):this._renderType},ek.loader=function(t){return arguments.length?(t!==this._loader&&(Lr.prototype.loader.call(this,t),this._renderer&&(this._renderer=null,this.initialize(this._el))),this):this._loader},ek.resize=function(){return this._autosize=1,this},ek._resizeView=function(t,e,n,r,i,o){this.runAfter(function(a){var s=0;a._autosize=0,a.width()!==n&&(s=1,a.width(n),a._resizeWidth.skip(!0)),a.height()!==r&&(s=1,a.height(r),a._resizeHeight.skip(!0)),a._viewWidth!==t&&(a._resize=1,a._viewWidth=t),a._viewHeight!==e&&(a._resize=1,a._viewHeight=e),a._origin[0]===i[0]&&a._origin[1]===i[1]||(a._resize=1,a._origin=i),s&&a.run("enter"),o&&a.runAfter(function(){a.resize()})})},ek.addEventListener=function(t,e){return this._handler.on(t,e),this},ek.removeEventListener=function(t,e){return this._handler.off(t,e),this},ek.addSignalListener=function(t,e){var n=nk(this,t),r=function(){e(t,n.value)};return r.handler=e,this.on(n,null,r),this},ek.removeSignalListener=function(t,e){var n=nk(this,t)._targets||[],r=n.filter(function(t){var n=t._update;return n&&n.handler===e});return r.length&&n.remove(r[0]),this},ek.preventDefault=function(t){return arguments.length?(this._preventDefault=t,this):this._preventDefault},ek.tooltipHandler=function(t){var e=this._handler;return arguments.length?(e.handleTooltip=t||nc.prototype.handleTooltip,this):e.handleTooltip},ek.events=function(t,e,n){var r,i=this,o=new Tt(n),a=function(n,r){var a,s,u,c,l;"view"!==t||(s=e,c=(u=(a=i)._eventConfig.defaults)&&u.prevent,l=u&&u.allow,!1===c||!0===l||!0!==c&&!1!==l&&(c?!c[s]:l?l[s]:!a.preventDefault()))||n.preventDefault();try{o.receive(T_(i,n,r))}catch(t){i.error(t)}finally{i.run()}};if("view"===t)return i.addEventListener(e,a),o;if("window"===t?"undefined"!=typeof window&&(r=[window]):"undefined"!=typeof document&&(r=document.querySelectorAll(t)),!r)return i.warn("Can not resolve event source: "+t),o;for(var s=0,u=r.length;s<u;++s)r[s].addEventListener(e,a);return i._eventListeners.push({type:e,sources:r,handler:a}),o},ek.finalize=function(){for(var t,e,n=this._eventListeners,r=n.length;--r>=0;)for(t=(e=n[r]).sources.length;--t>=0;)e.sources[t].removeEventListener(e.type,e.handler)},ek.hover=function(t,e){return t=[t||"hover"],e=[e||"update",t],this.on(this.events("view","mouseover",A_),k_,C_(t)),this.on(this.events("view","mouseout",A_),k_,C_(e)),this},ek.data=function(t){return x_(this,t).values.value},ek.change=__,ek.insert=function(t,e){return __.call(this,t,gt().insert(e))},ek.remove=function(t,e){return __.call(this,t,gt().remove(e))},ek.initialize=function(t,e){var n,r,i,o,a,s,u=this,c=u._renderType,l=qc(c);return t=u._el=t?U_(u,t):null,l||u.error("Unrecognized renderer type: "+c),n=l.handler||sc,u._renderer=(r=t?l.renderer:l.headless)?z_(u,u._renderer,t,r):null,u._handler=(i=u,o=u._handler,a=t,s=(new n).scene(i.scenegraph().root).initialize(a,S_(i),i),o&&(s.handleTooltip=o.handleTooltip,o.handlers().forEach(function(t){s.on(t.type,t.handler)})),s),u._redraw=!0,t&&(e=e?U_(u,e):t.appendChild(R_("div",{class:"vega-bindings"})),u._bind.forEach(function(t){t.param.element&&(t.element=U_(u,t.param.element))}),u._bind.forEach(function(t){!function(t,e,n){if(e){var r=n.param,i=n.state;i||(i=n.state={elements:null,active:!1,set:null,update:function(e){i.source=!0,t.signal(r.signal,e).run()}},r.debounce&&(i.update=j(r.debounce,i.update))),function(t,e,n,r){var i=R_("div",{class:"vega-bind"});i.appendChild(R_("span",{class:"vega-bind-name"},n.name||n.signal)),e.appendChild(i);var o=O_;switch(n.input){case"checkbox":o=P_;break;case"select":o=I_;break;case"radio":o=N_;break;case"range":o=F_}o(t,i,n,r)}(i,e,r,t.signal(r.signal)),i.active||(t.on(t._signals[r.signal],null,function(){i.source?i.source=!1:i.set(t.signal(r.signal))}),i.active=!0)}}(u,t.element||e,t)})),u},ek.toImageURL=function(t,e){return t!==Bc.Canvas&&t!==Bc.SVG&&t!==Bc.PNG?Promise.reject("Unrecognized image type: "+t):V_(this,t,e).then(function(e){return t===Bc.SVG?(n=e.svg(),r=new Blob([n],{type:"image/svg+xml"}),window.URL.createObjectURL(r)):e.canvas().toDataURL("image/png");var n,r})},ek.toCanvas=function(t){return V_(this,Bc.Canvas,t).then(function(t){return t.canvas()})},ek.toSVG=function(t){return V_(this,Bc.SVG,t).then(function(t){return t.svg()})},ek.getState=function(t){return this._runtime.getState(t||{data:ZA,signals:KA,recurse:!0})},ek.setState=function(t){var e=this;return e._trigger=!1,e._runtime.setState(t),e.run().runAfter(function(){e._trigger=!0}),this},z(Fr,Co,Al,Ym,cw,rb,px,Qx,l_,y_),t.version="3.0.10",t.Dataflow=Lr,t.EventStream=Tt,t.Parameters=yt,t.Pulse=br,t.MultiPulse=Sr,t.Operator=_t,t.Transform=Ir,t.changeset=gt,t.ingest=ht,t.isTuple=ut,t.definition=jr,t.transform=zr,t.transforms=Fr,t.tupleid=ct,t.scale=Fd,t.scheme=im,t.interpolate=um,t.interpolateRange=om,t.timeInterval=hm,t.utcInterval=fm,t.projection=Ky,t.View=tk,t.parse=function(t,e){return s(t)||i("Input Vega specification must be an object."),(n=t,r=new TA(CA([e,t.config])),h=r.config,r.background=n.background||h.background,r.eventConfig=h.events,l=LS(r.root=r.add(DS())),r.addSignal("width",n.width||0),r.addSignal("height",n.height||0),r.addSignal("padding",function(t,e){return s(t=t||h.padding)?{top:B_(t.top),bottom:B_(t.bottom),left:B_(t.left),right:B_(t.right)}:{top:n=B_(t),bottom:n,left:n,right:n};var n}(n.padding)),r.addSignal("autosize",function(t,e){return s(t=t||h.autosize)?t:{type:t=t||"pad"}}(n.autosize)),P(n.signals).forEach(function(t){SA[t.name]||$_(t,r)}),a=r.add(GS()),u=QT({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},n.encode),u=r.add(XS(JT(u,tA,WT,n.style,r,{pulse:LS(a)}))),c=r.add(fT({layout:r.objectProperty(n.layout),legendMargin:h.legendMargin,autosize:r.signalRef("autosize"),mark:l,pulse:LS(u)})),r.operators.pop(),r.pushState(LS(u),LS(c),null),EA(n,r,!0),r.operators.push(c),o=r.add(qS({mark:l,pulse:LS(c)})),o=r.add(uT({pulse:LS(o)})),o=r.add(lT({pulse:LS(o)})),r.addData("root",new dA(r,a,a,o)),r).toRuntime();var n,r,o,a,u,c,l,h},t.expressionFunction=oS,t.formatLocale=td,t.timeFormatLocale=mr,t.runtime=HA,t.runtimeContext=GA,t.bin=Xr,t.bootstrapCI=gi,t.quartiles=vi,t.setRandom=function(e){t.random=e},t.randomInteger=function(e,n){null==n&&(n=e,e=0);var r,i,o,a={min:function(t){return arguments.length?(o=i-(r=t||0),a):r},max:function(t){return arguments.length?(o=(i=t||0)-r,a):i},sample:function(){return r+Math.floor(o*t.random())},pdf:function(t){return t===Math.floor(t)&&t>=r&&t<i?1/o:0},cdf:function(t){var e=Math.floor(t);return e<r?0:e>=i?1:(e-r+1)/o},icdf:function(t){return t>=0&&t<=1?r-1+Math.floor(t*o):NaN}};return a.min(e).max(n)},t.randomKDE=wi,t.randomMixture=bi,t.randomNormal=yi,t.randomUniform=xi,t.accessor=e,t.accessorName=n,t.accessorFields=r,t.id=f,t.identity=d,t.zero=p,t.one=m,t.truthy=g,t.falsy=v,t.logger=b,t.None=0,t.Error=w,t.Warn=2,t.Info=3,t.Debug=4,t.panLinear=A,t.panLog=k,t.panPow=C,t.zoomLinear=D,t.zoomLog=L,t.zoomPow=O,t.array=P,t.compare=N,t.constant=F,t.debounce=j,t.error=i,t.extend=z,t.extentIndex=U,t.fastmap=B,t.field=l,t.inherits=H,t.isArray=a,t.isBoolean=q,t.isDate=G,t.isFunction=I,t.isNumber=W,t.isObject=s,t.isRegExp=Y,t.isString=u,t.key=X,t.merge=$,t.pad=J,t.peek=x,t.repeat=Q,t.splitAccessPath=o,t.stringValue=c,t.toBoolean=Z,t.toDate=tt,t.toNumber=_,t.toString=et,t.toSet=nt,t.truncate=rt,t.visitArray=it,t.loader=te,t.read=vr,t.inferType=he,t.inferTypes=fe,t.typeParsers=ue,t.formats=Me,t.Bounds=Ro,t.Gradient=Po,t.GroupItem=No,t.ResourceLoader=jo,t.Item=Io,t.Scenegraph=Xu,t.Handler=nc,t.Renderer=ic,t.CanvasHandler=sc,t.CanvasRenderer=fc,t.SVGHandler=gc,t.SVGRenderer=Sc,t.SVGStringRenderer=Nc,t.RenderType=Bc,t.renderModule=qc,t.Marks=Vu,t.boundContext=Vs,t.boundStroke=Fs,t.boundItem=Bu,t.boundMark=qu,t.pathCurves=Ka,t.pathSymbols=ps,t.pathRectangle=xs,t.pathTrail=Ms,t.pathParse=ns,t.pathRender=cs,t.point=ac,t.domCreate=Ju,t.domFind=Zu,t.domChild=Ku,t.domClear=tc,t.openTag=wc,t.closeTag=bc,t.font=Nu,t.textMetrics=ku,t.resetSVGClipId=function(){lu=1},t.sceneEqual=Wc,t.pathEqual=Yc,t.sceneToJSON=Wu,t.sceneFromJSON=Yu,t.sceneZOrder=$s,t.sceneVisit=Qs,t.scenePickVisit=Js,Object.defineProperty(t,"__esModule",{value:!0})}),function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).vegaTooltip=t()}(function(){return function t(e,n,r){function i(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[a]={exports:{}};e[a][0].call(l.exports,function(t){return i(e[a][1][t]||t)},l,l.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,e,n){!function(t,r){!function(t){"use strict";function e(t){return new n(t)}function n(t){if(!(e=c.exec(t)))throw new Error("invalid format: "+t);var e,n=e[1]||" ",r=e[2]||">",i=e[3]||"-",o=e[4]||"",a=!!e[5],s=e[6]&&+e[6],l=!!e[7],h=e[8]&&+e[8].slice(1),f=e[9]||"";"n"===f?(l=!0,f="g"):u[f]||(f=""),(a||"0"===n&&"="===r)&&(a=!0,n="0",r="="),this.fill=n,this.align=r,this.sign=i,this.symbol=o,this.zero=a,this.width=s,this.comma=l,this.precision=h,this.type=f}function r(e){return l=d(e),t.format=l.format,t.formatPrefix=l.formatPrefix,l}var i,o=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]},a=function(t){return(t=o(Math.abs(t)))?t[1]:NaN},s=function(t,e){var n=o(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},u={"":function(t,e){t:for(var n,r=(t=t.toPrecision(e)).length,i=1,o=-1;i<r;++i)switch(t[i]){case".":o=n=i;break;case"0":0===o&&(o=i),n=i;break;case"e":break t;default:o>0&&(o=0)}return o>0?t.slice(0,o)+t.slice(n+1):t},"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return s(100*t,e)},r:s,s:function(t,e){var n=o(t,e);if(!n)return t+"";var r=n[0],a=n[1],s=a-(i=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,u=r.length;return s===u?r:s>u?r+new Array(s-u+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+o(t,Math.max(0,e+s-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},c=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;e.prototype=n.prototype,n.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var l,h=function(t){return t},f=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"],d=function(t){function n(t){function n(t){var e,n,o,u=b,l=x;if("c"===w)l=_(t)+l,t="";else{var p=(t=+t)<0;if(t=_(Math.abs(t),y),p&&0==+t&&(p=!1),u=(p?"("===d?d:"-":"-"===d||"("===d?"":d)+u,l=l+("s"===w?f[8+i/3]:"")+(p&&"("===d?")":""),M)for(e=-1,n=t.length;++e<n;)if(48>(o=t.charCodeAt(e))||o>57){l=(46===o?s+t.slice(e+1):t.slice(e))+l,t=t.slice(0,e);break}}v&&!m&&(t=r(t,1/0));var E=u.length+t.length+l.length,S=E<g?new Array(g-E+1).join(a):"";switch(v&&m&&(t=r(S+t,S.length?g-l.length:1/0),S=""),h){case"<":t=u+t+l+S;break;case"=":t=u+S+t+l;break;case"^":t=S.slice(0,E=S.length>>1)+u+t+l+S.slice(E);break;default:t=S+u+t+l}return c(t)}var a=(t=e(t)).fill,h=t.align,d=t.sign,p=t.symbol,m=t.zero,g=t.width,v=t.comma,y=t.precision,w=t.type,b="$"===p?o[0]:"#"===p&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",x="$"===p?o[1]:/[%p]/.test(w)?l:"",_=u[w],M=!w||/[defgprs%]/.test(w);return y=null==y?w?6:12:/[gprs]/.test(w)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y)),n.toString=function(){return t+""},n}var r=t.grouping&&t.thousands?function(t,e){return function(n,r){for(var i=n.length,o=[],a=0,s=t[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(n.substring(i-=s,i+s)),!((u+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(e)}}(t.grouping,t.thousands):h,o=t.currency,s=t.decimal,c=t.numerals?function(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}(t.numerals):h,l=t.percent||"%";return{format:n,formatPrefix:function(t,r){var i=n(((t=e(t)).type="f",t)),o=3*Math.max(-8,Math.min(8,Math.floor(a(r)/3))),s=Math.pow(10,-o),u=f[8+o/3];return function(t){return i(s*t)+u}}}};r({decimal:".",thousands:",",grouping:[3],currency:["$",""]}),t.formatDefaultLocale=r,t.formatLocale=d,t.formatSpecifier=e,t.precisionFixed=function(t){return Math.max(0,-a(Math.abs(t)))},t.precisionPrefix=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(a(e)/3)))-a(Math.abs(t)))},t.precisionRound=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,a(e)-a(t))+1},Object.defineProperty(t,"__esModule",{value:!0})}("object"==typeof n&&void 0!==e?n:t.d3=t.d3||{})}(this)},{}],2:[function(t,e,n){!function(t,r){!function(t){"use strict";function e(){return new n}function n(){this._="@"+(++L).toString(36)}function r(t,e,n){return t=i(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function i(e,n,r){return function(i){var o=t.event;t.event=i;try{e.call(this,this.__data__,n,r)}finally{t.event=o}}}function o(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function a(t,e,n){var o=F.hasOwnProperty(t.type)?r:i;return function(r,i,a){var s,u=this.__on,c=o(e,i,a);if(u)for(var l=0,h=u.length;l<h;++l)if((s=u[l]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=c,s.capture=n),void(s.value=e);this.addEventListener(t.type,c,n),s={type:t.type,name:t.name,value:e,listener:c,capture:n},u?u.push(s):this.__on=[s]}}function s(){}function u(){return[]}function c(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function l(t,e,n,r,i,o){for(var a,s=0,u=e.length,l=o.length;s<l;++s)(a=e[s])?(a.__data__=o[s],r[s]=a):n[s]=new c(t,o[s]);for(;s<u;++s)(a=e[s])&&(i[s]=a)}function h(t,e,n,r,i,o,a){var s,u,l,h={},f=e.length,d=o.length,p=new Array(f);for(s=0;s<f;++s)(u=e[s])&&(p[s]=l=H+a.call(u,u.__data__,s,e),l in h?i[s]=u:h[l]=u);for(s=0;s<d;++s)(u=h[l=H+a.call(t,o[s],s,o)])?(r[s]=u,u.__data__=o[s],h[l]=null):n[s]=new c(t,o[s]);for(s=0;s<f;++s)(u=e[s])&&h[p[s]]===u&&(i[s]=u)}function f(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function d(t,e){return t.style.getPropertyValue(e)||q(t).getComputedStyle(t,null).getPropertyValue(e)}function p(t){return t.trim().split(/^|\s+/)}function m(t){return t.classList||new g(t)}function g(t){this._node=t,this._names=p(t.getAttribute("class")||"")}function v(t,e){for(var n=m(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function y(t,e){for(var n=m(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function w(){this.textContent=""}function b(){this.innerHTML=""}function x(){this.nextSibling&&this.parentNode.appendChild(this)}function _(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function M(){return null}function E(){var t=this.parentNode;t&&t.removeChild(this)}function S(t,e,n){var r=q(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function T(t,e){this._groups=t,this._parents=e}function A(){return new T([[document.documentElement]],G)}var k="http://www.w3.org/1999/xhtml",C={svg:"http://www.w3.org/2000/svg",xhtml:k,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},R=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),C.hasOwnProperty(e)?{space:C[e],local:t}:t},D=function(t){var e=R(t);return(e.local?function(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}:function(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===k&&e.documentElement.namespaceURI===k?e.createElement(t):e.createElementNS(n,t)}})(e)},L=0;n.prototype=e.prototype={constructor:n,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var O=function(t){return function(){return this.matches(t)}};if("undefined"!=typeof document){var P=document.documentElement;if(!P.matches){var I=P.webkitMatchesSelector||P.msMatchesSelector||P.mozMatchesSelector||P.oMatchesSelector;O=function(t){return function(){return I.call(this,t)}}}}var N=O,F={};t.event=null,"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(F={mouseenter:"mouseover",mouseleave:"mouseout"}));var j=function(){for(var e,n=t.event;e=n.sourceEvent;)n=e;return n},z=function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]},U=function(t){return null==t?s:function(){return this.querySelector(t)}},V=function(t){return null==t?u:function(){return this.querySelectorAll(t)}},B=function(t){return new Array(t.length)};c.prototype={constructor:c,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var H="$",q=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};g.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var G=[null];T.prototype=A.prototype={constructor:T,select:function(t){"function"!=typeof t&&(t=U(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a,s=e[i],u=s.length,c=r[i]=new Array(u),l=0;l<u;++l)(o=s[l])&&(a=t.call(o,o.__data__,l,s))&&("__data__"in o&&(a.__data__=o.__data__),c[l]=a);return new T(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=V(t));for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a,s=e[o],u=s.length,c=0;c<u;++c)(a=s[c])&&(r.push(t.call(a,a.__data__,c,s)),i.push(a));return new T(r,i)},filter:function(t){"function"!=typeof t&&(t=N(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,u=r[i]=[],c=0;c<s;++c)(o=a[c])&&t.call(o,o.__data__,c,a)&&u.push(o);return new T(r,this._parents)},data:function(t,e){if(!t)return m=new Array(this.size()),c=-1,this.each(function(t){m[++c]=t}),m;var n=e?h:l,r=this._parents,i=this._groups;"function"!=typeof t&&(t=function(t){return function(){return t}}(t));for(var o=i.length,a=new Array(o),s=new Array(o),u=new Array(o),c=0;c<o;++c){var f=r[c],d=i[c],p=d.length,m=t.call(f,f&&f.__data__,c,r),g=m.length,v=s[c]=new Array(g),y=a[c]=new Array(g);n(f,d,v,y,u[c]=new Array(p),m,e);for(var w,b,x=0,_=0;x<g;++x)if(w=v[x]){for(x>=_&&(_=x+1);!(b=y[_])&&++_<g;);w._next=b||null}}return(a=new T(a,r))._enter=s,a._exit=u,a},enter:function(){return new T(this._enter||this._groups.map(B),this._parents)},exit:function(){return new T(this._exit||this._groups.map(B),this._parents)},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=Math.min(r,n.length),o=new Array(r),a=0;a<i;++a)for(var s,u=e[a],c=n[a],l=u.length,h=o[a]=new Array(l),f=0;f<l;++f)(s=u[f]||c[f])&&(h[f]=s);for(;a<r;++a)o[a]=e[a];return new T(o,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&a!==r.nextSibling&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=f);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,s=n[o],u=s.length,c=i[o]=new Array(u),l=0;l<u;++l)(a=s[l])&&(c[l]=a);c.sort(e)}return new T(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){var t=0;return this.each(function(){++t}),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],a=0,s=o.length;a<s;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,e){var n=R(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}}:"function"==typeof e?n.local?function(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}:function(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}:n.local?function(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}:function(t,e){return function(){this.setAttribute(t,e)}})(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?function(t){return function(){this.style.removeProperty(t)}}:"function"==typeof e?function(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}:function(t,e,n){return function(){this.style.setProperty(t,e,n)}})(t,e,null==n?"":n)):d(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?function(t){return function(){delete this[t]}}:"function"==typeof e?function(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}:function(t,e){return function(){this[t]=e}})(t,e)):this.node()[t]},classed:function(t,e){var n=p(t+"");if(arguments.length<2){for(var r=m(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?function(t,e){return function(){(e.apply(this,arguments)?v:y)(this,t)}}:e?function(t){return function(){v(this,t)}}:function(t){return function(){y(this,t)}})(n,e))},text:function(t){return arguments.length?this.each(null==t?w:("function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}:function(t){return function(){this.textContent=t}})(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?b:("function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}:function(t){return function(){this.innerHTML=t}})(t)):this.node().innerHTML},raise:function(){return this.each(x)},lower:function(){return this.each(_)},append:function(t){var e="function"==typeof t?t:D(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:D(t),r=null==e?M:"function"==typeof e?e:U(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(E)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,s=function(t){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}(t+""),u=s.length;if(!(arguments.length<2)){for(c=e?a:o,null==n&&(n=!1),r=0;r<u;++r)this.each(c(s[r],e,n));return this}var c=this.node().__on;if(c)for(var l,h=0,f=c.length;h<f;++h)for(r=0,l=c[h];r<u;++r)if((i=s[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?function(t,e){return function(){return S(this,t,e.apply(this,arguments))}}:function(t,e){return function(){return S(this,t,e)}})(t,e))}},t.creator=D,t.local=e,t.matcher=N,t.mouse=function(t){var e=j();return e.changedTouches&&(e=e.changedTouches[0]),z(t,e)},t.namespace=R,t.namespaces=C,t.select=function(t){return"string"==typeof t?new T([[document.querySelector(t)]],[document.documentElement]):new T([[t]],G)},t.selectAll=function(t){return"string"==typeof t?new T([document.querySelectorAll(t)],[document.documentElement]):new T([null==t?[]:t],G)},t.selection=A,t.selector=U,t.selectorAll=V,t.style=d,t.touch=function(t,e,n){arguments.length<3&&(n=e,e=j().changedTouches);for(var r,i=0,o=e?e.length:0;i<o;++i)if((r=e[i]).identifier===n)return z(t,r);return null},t.touches=function(t,e){null==e&&(e=j().touches);for(var n=0,r=e?e.length:0,i=new Array(r);n<r;++n)i[n]=z(t,e[n]);return i},t.window=q,t.customEvent=function(e,n,r,i){var o=t.event;e.sourceEvent=t.event,t.event=e;try{return n.apply(r,i)}finally{t.event=o}},Object.defineProperty(t,"__esModule",{value:!0})}("object"==typeof n&&void 0!==e?n:t.d3=t.d3||{})}(this)},{}],3:[function(t,e,n){var r,i;r=this,i=function(t,e){"use strict";function n(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function r(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function i(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}function o(t){function e(t,e){return function(n){var r,i,o,a=[],s=-1,u=0,c=t.length;for(n instanceof Date||(n=new Date(+n));++s<c;)37===t.charCodeAt(s)&&(a.push(t.slice(u,s)),null!=(i=et[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),a.push(r),u=s+1);return a.push(t.slice(u,s)),a.join("")}}function o(t,e){return function(n){var o=i(1900);if(a(o,t,n+="",0)!=n.length)return null;if("p"in o&&(o.H=o.H%12+12*o.p),"W"in o||"U"in o){"w"in o||(o.w="W"in o?1:0);var s="Z"in o?r(i(o.y)).getUTCDay():e(i(o.y)).getDay();o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(s+5)%7:o.w+7*o.U-(s+6)%7}return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,r(o)):e(o)}}function a(t,e,n,r){for(var i,o,a=0,s=e.length,u=n.length;a<s;){if(r>=u)return-1;if(37===(i=e.charCodeAt(a++))){if(i=e.charAt(a++),!(o=wt[i in et?e.charAt(a++):i])||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}var s=t.dateTime,K=t.date,tt=t.time,nt=t.periods,rt=t.days,it=t.shortDays,ot=t.months,at=t.shortMonths,st=u(nt),ut=c(nt),ct=u(rt),lt=c(rt),ht=u(it),ft=c(it),dt=u(ot),pt=c(ot),mt=u(at),gt=c(at),vt={a:function(t){return it[t.getDay()]},A:function(t){return rt[t.getDay()]},b:function(t){return at[t.getMonth()]},B:function(t){return ot[t.getMonth()]},c:null,d:E,e:E,H:S,I:T,j:A,L:k,m:C,M:R,p:function(t){return nt[+(t.getHours()>=12)]},S:D,U:L,w:O,W:P,x:null,X:null,y:I,Y:N,Z:F,"%":Z},yt={a:function(t){return it[t.getUTCDay()]},A:function(t){return rt[t.getUTCDay()]},b:function(t){return at[t.getUTCMonth()]},B:function(t){return ot[t.getUTCMonth()]},c:null,d:j,e:j,H:z,I:U,j:V,L:B,m:H,M:q,p:function(t){return nt[+(t.getUTCHours()>=12)]},S:G,U:W,w:Y,W:X,x:null,X:null,y:$,Y:Q,Z:J,"%":Z},wt={a:function(t,e,n){var r=ht.exec(e.slice(n));return r?(t.w=ft[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=ct.exec(e.slice(n));return r?(t.w=lt[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=mt.exec(e.slice(n));return r?(t.m=gt[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=dt.exec(e.slice(n));return r?(t.m=pt[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,e,n){return a(t,s,e,n)},d:v,e:v,H:w,I:w,j:y,L:_,m:g,M:b,p:function(t,e,n){var r=st.exec(e.slice(n));return r?(t.p=ut[r[0].toLowerCase()],n+r[0].length):-1},S:x,U:h,w:l,W:f,x:function(t,e,n){return a(t,K,e,n)},X:function(t,e,n){return a(t,tt,e,n)},y:p,Y:d,Z:m,"%":M};return vt.x=e(K,vt),vt.X=e(tt,vt),vt.c=e(s,vt),yt.x=e(K,yt),yt.X=e(tt,yt),yt.c=e(s,yt),{format:function(t){var n=e(t+="",vt);return n.toString=function(){return t},n},parse:function(t){var e=o(t+="",n);return e.toString=function(){return t},e},utcFormat:function(t){var n=e(t+="",yt);return n.toString=function(){return t},n},utcParse:function(t){var e=o(t,r);return e.toString=function(){return t},e}}}function a(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function s(t){return t.replace(it,"\\$&")}function u(t){return new RegExp("^(?:"+t.map(s).join("|")+")","i")}function c(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function l(t,e,n){var r=nt.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function h(t,e,n){var r=nt.exec(e.slice(n));return r?(t.U=+r[0],n+r[0].length):-1}function f(t,e,n){var r=nt.exec(e.slice(n));return r?(t.W=+r[0],n+r[0].length):-1}function d(t,e,n){var r=nt.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function p(t,e,n){var r=nt.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function m(t,e,n){var r=/^(Z)|([+-]\d\d)(?:\:?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function g(t,e,n){var r=nt.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function v(t,e,n){var r=nt.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function y(t,e,n){var r=nt.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function w(t,e,n){var r=nt.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function b(t,e,n){var r=nt.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function x(t,e,n){var r=nt.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function _(t,e,n){var r=nt.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function M(t,e,n){var r=rt.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function E(t,e){return a(t.getDate(),e,2)}function S(t,e){return a(t.getHours(),e,2)}function T(t,e){return a(t.getHours()%12||12,e,2)}function A(t,n){return a(1+e.timeDay.count(e.timeYear(t),t),n,3)}function k(t,e){return a(t.getMilliseconds(),e,3)}function C(t,e){return a(t.getMonth()+1,e,2)}function R(t,e){return a(t.getMinutes(),e,2)}function D(t,e){return a(t.getSeconds(),e,2)}function L(t,n){return a(e.timeSunday.count(e.timeYear(t),t),n,2)}function O(t){return t.getDay()}function P(t,n){return a(e.timeMonday.count(e.timeYear(t),t),n,2)}function I(t,e){return a(t.getFullYear()%100,e,2)}function N(t,e){return a(t.getFullYear()%1e4,e,4)}function F(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+a(e/60|0,"0",2)+a(e%60,"0",2)}function j(t,e){return a(t.getUTCDate(),e,2)}function z(t,e){return a(t.getUTCHours(),e,2)}function U(t,e){return a(t.getUTCHours()%12||12,e,2)}function V(t,n){return a(1+e.utcDay.count(e.utcYear(t),t),n,3)}function B(t,e){return a(t.getUTCMilliseconds(),e,3)}function H(t,e){return a(t.getUTCMonth()+1,e,2)}function q(t,e){return a(t.getUTCMinutes(),e,2)}function G(t,e){return a(t.getUTCSeconds(),e,2)}function W(t,n){return a(e.utcSunday.count(e.utcYear(t),t),n,2)}function Y(t){return t.getUTCDay()}function X(t,n){return a(e.utcMonday.count(e.utcYear(t),t),n,2)}function $(t,e){return a(t.getUTCFullYear()%100,e,2)}function Q(t,e){return a(t.getUTCFullYear()%1e4,e,4)}function J(){return"+0000"}function Z(){return"%"}function K(e){return tt=o(e),t.timeFormat=tt.format,t.timeParse=tt.parse,t.utcFormat=tt.utcFormat,t.utcParse=tt.utcParse,tt}var tt,et={"-":"",_:" ",0:"0"},nt=/^\s*\d+/,rt=/^%/,it=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;K({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var ot=Date.prototype.toISOString?function(t){return t.toISOString()}:t.utcFormat("%Y-%m-%dT%H:%M:%S.%LZ"),at=+new Date("2000-01-01T00:00:00.000Z")?function(t){var e=new Date(t);return isNaN(e)?null:e}:t.utcParse("%Y-%m-%dT%H:%M:%S.%LZ");t.timeFormatDefaultLocale=K,t.timeFormatLocale=o,t.isoFormat=ot,t.isoParse=at,Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof n&&void 0!==e?i(n,t("d3-time")):i(r.d3=r.d3||{},r.d3)},{"d3-time":4}],4:[function(t,e,n){!function(t,r){!function(t){"use strict";function e(t,n,r,a){function s(e){return t(e=new Date(+e)),e}return s.floor=s,s.ceil=function(e){return t(e=new Date(e-1)),n(e,1),t(e),e},s.round=function(t){var e=s(t),n=s.ceil(t);return t-e<n-t?e:n},s.offset=function(t,e){return n(t=new Date(+t),null==e?1:Math.floor(e)),t},s.range=function(e,r,i){var o=[];if(e=s.ceil(e),i=null==i?1:Math.floor(i),!(e<r&&i>0))return o;do{o.push(new Date(+e))}while(n(e,i),t(e),e<r);return o},s.filter=function(r){return e(function(e){if(e>=e)for(;t(e),!r(e);)e.setTime(e-1)},function(t,e){if(t>=t)for(;--e>=0;)for(;n(t,1),!r(t););})},r&&(s.count=function(e,n){return i.setTime(+e),o.setTime(+n),t(i),t(o),Math.floor(r(i,o))},s.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?s.filter(a?function(e){return a(e)%t==0}:function(e){return s.count(0,e)%t==0}):s:null}),s}function n(t){return e(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*u)/c})}function r(t){return e(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/c})}var i=new Date,o=new Date,a=e(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});a.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?e(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):a:null};var s=a.range,u=6e4,c=6048e5,l=e(function(t){t.setTime(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(+t+1e3*e)},function(t,e){return(e-t)/1e3},function(t){return t.getUTCSeconds()}),h=l.range,f=e(function(t){t.setTime(Math.floor(t/u)*u)},function(t,e){t.setTime(+t+e*u)},function(t,e){return(e-t)/u},function(t){return t.getMinutes()}),d=f.range,p=e(function(t){var e=t.getTimezoneOffset()*u%36e5;e<0&&(e+=36e5),t.setTime(36e5*Math.floor((+t-e)/36e5)+e)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getHours()}),m=p.range,g=e(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*u)/864e5},function(t){return t.getDate()-1}),v=g.range,y=n(0),w=n(1),b=n(2),x=n(3),_=n(4),M=n(5),E=n(6),S=y.range,T=w.range,A=b.range,k=x.range,C=_.range,R=M.range,D=E.range,L=e(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())},function(t){return t.getMonth()}),O=L.range,P=e(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});P.every=function(t){return isFinite(t=Math.floor(t))&&t>0?e(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)}):null};var I=P.range,N=e(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*u)},function(t,e){return(e-t)/u},function(t){return t.getUTCMinutes()}),F=N.range,j=e(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getUTCHours()}),z=j.range,U=e(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/864e5},function(t){return t.getUTCDate()-1}),V=U.range,B=r(0),H=r(1),q=r(2),G=r(3),W=r(4),Y=r(5),X=r(6),$=B.range,Q=H.range,J=q.range,Z=G.range,K=W.range,tt=Y.range,et=X.range,nt=e(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()}),rt=nt.range,it=e(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});it.every=function(t){return isFinite(t=Math.floor(t))&&t>0?e(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null};var ot=it.range;t.timeInterval=e,t.timeMillisecond=a,t.timeMilliseconds=s,t.utcMillisecond=a,t.utcMilliseconds=s,t.timeSecond=l,t.timeSeconds=h,t.utcSecond=l,t.utcSeconds=h,t.timeMinute=f,t.timeMinutes=d,t.timeHour=p,t.timeHours=m,t.timeDay=g,t.timeDays=v,t.timeWeek=y,t.timeWeeks=S,t.timeSunday=y,t.timeSundays=S,t.timeMonday=w,t.timeMondays=T,t.timeTuesday=b,t.timeTuesdays=A,t.timeWednesday=x,t.timeWednesdays=k,t.timeThursday=_,t.timeThursdays=C,t.timeFriday=M,t.timeFridays=R,t.timeSaturday=E,t.timeSaturdays=D,t.timeMonth=L,t.timeMonths=O,t.timeYear=P,t.timeYears=I,t.utcMinute=N,t.utcMinutes=F,t.utcHour=j,t.utcHours=z,t.utcDay=U,t.utcDays=V,t.utcWeek=B,t.utcWeeks=$,t.utcSunday=B,t.utcSundays=$,t.utcMonday=H,t.utcMondays=Q,t.utcTuesday=q,t.utcTuesdays=J,t.utcWednesday=G,t.utcWednesdays=Z,t.utcThursday=W,t.utcThursdays=K,t.utcFriday=Y,t.utcFridays=tt,t.utcSaturday=X,t.utcSaturdays=et,t.utcMonth=nt,t.utcMonths=rt,t.utcYear=it,t.utcYears=ot,Object.defineProperty(t,"__esModule",{value:!0})}("object"==typeof n&&void 0!==e?n:t.d3=t.d3||{})}(this)},{}],5:[function(t,e,n){"use strict";var r;Object.defineProperty(n,"__esModule",{value:!0}),function(t){t.QUANTITATIVE="quantitative",t.ORDINAL="ordinal",t.TEMPORAL="temporal",t.NOMINAL="nominal"}(r=n.Type||(n.Type={})),n.QUANTITATIVE=r.QUANTITATIVE,n.ORDINAL=r.ORDINAL,n.TEMPORAL=r.TEMPORAL,n.NOMINAL=r.NOMINAL,n.getFullName=function(t){if(t)switch(t=t.toLowerCase()){case"q":case n.QUANTITATIVE:return"quantitative";case"t":case n.TEMPORAL:return"temporal";case"o":case n.ORDINAL:return"ordinal";case"n":case n.NOMINAL:return"nominal"}}},{}],6:[function(t,e,n){"use strict";function r(t){return t%1==0?o.format(",")(t):o.format(",.2f")(t)}function i(t){var e=s.timeFormat(".%L"),n=s.timeFormat(":%S"),r=s.timeFormat("%I:%M"),i=s.timeFormat("%I %p"),o=s.timeFormat("%a %d"),u=s.timeFormat("%b %d"),c=s.timeFormat("%B"),l=s.timeFormat("%Y");return(a.timeSecond(t)<t?e:a.timeMinute(t)<t?n:a.timeHour(t)<t?r:a.timeDay(t)<t?i:a.timeMonth(t)<t?a.timeWeek(t)<t?o:u:a.timeYear(t)<t?c:l)(t)}Object.defineProperty(n,"__esModule",{value:!0});var o=t("d3-format"),a=t("d3-time"),s=t("d3-time-format");n.customFormat=function(t,e,n){if(void 0!==t&&null!==t&&e)switch(e){case"time":return n?s.timeFormat(n)(t):i(t);case"number":return n?o.format(n)(t):r(t);case"string":default:return t}},n.autoFormat=function(t){return"number"==typeof t?r(t):t instanceof Date?i(t):t},n.autoNumberFormat=r,n.autoTimeFormat=i},{"d3-format":1,"d3-time":4,"d3-time-format":3}],7:[function(t,e,n){"use strict";function r(t,e){t.addEventListener("mouseover.tooltipInit",function(t,n){o(n)&&(i(),f=window.setTimeout(function(){!function(t,e,n){var r=h.getTooltipPlaceholder(),i=c.getTooltipData(e,n);i&&0!==i.length&&(h.bindData(r,i),h.updatePosition(t,n),h.updateColorTheme(n),s.select("#vis-tooltip").style("visibility","visible"),d=!0,n.onAppear&&n.onAppear(t,e))}(t,n,e)},e.delay||u.DELAY))}),t.addEventListener("mousemove.tooltipUpdate",function(t,n){o(n)&&d&&function(t,e,n){o(e)&&(h.updatePosition(t,n),n.onMove&&n.onMove(t,e))}(t,n,e)}),t.addEventListener("mouseout.tooltipRemove",function(t,n){o(n)&&(i(),d&&function(t,e,n){o(e)&&(s.select("#vis-tooltip").style("visibility","hidden"),d=!1,h.clearData(),h.clearColorTheme(),h.clearPosition(),n.onDisappear&&n.onDisappear(t,e))}(t,n,e))})}function i(){window.clearTimeout(f),f=void 0}function o(t){return!(!t||!t.datum||t.datum._facetID)}function a(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}Object.defineProperty(n,"__esModule",{value:!0});var s=t("d3-selection"),u=t("./options"),c=t("./parseOption"),l=t("./supplementField"),h=t("./tooltipDisplay"),f=void 0,d=!1;n.vega=function(t,e){return void 0===e&&(e={showAllFields:!0}),r(t,a(e)),{destroy:function(){t.removeEventListener("mouseover.tooltipInit"),t.removeEventListener("mousemove.tooltipUpdate"),t.removeEventListener("mouseout.tooltipRemove"),i()}}},n.vegaLite=function(t,e,n){return void 0===n&&(n={showAllFields:!0}),n=l.supplementOptions(a(n),e),r(t,n),{destroy:function(){t.removeEventListener("mouseover.tooltipInit"),t.removeEventListener("mousemove.tooltipUpdate"),t.removeEventListener("mouseout.tooltipRemove"),i()}}}},{"./options":8,"./parseOption":9,"./supplementField":10,"./tooltipDisplay":11,"d3-selection":2}],8:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DELAY=100},{}],9:[function(t,e,n){"use strict";function r(t,e){var n=[];return e.fields.forEach(function(e){var r=e.title?e.title:e.field,o=i(t,e.field);if(void 0!==o){var a=l.customFormat(o,e.formatType,e.format)||l.autoFormat(o);n.push({title:r,value:a})}}),n}function i(t,e){var n,r=e.split("."),i=r[0];return r.shift(),t[i]&&(n=t[i],r.forEach(function(t){(n=n)[t]&&(n=n[t])})),void 0===n?void console.warn("[Tooltip] Cannot find field "+e+" in data."):n}function o(t,e){var n=[],r={};if(e&&e.fields)for(var i=0,o=e.fields;i<o.length;i++){var a=o[i];r[a.field]=a}for(var s in t)if(t.hasOwnProperty(s)){var u,c=t[s];u=r[s]&&r[s].title?r[s].title:s;var h=void 0,f=void 0;r[s]&&(h=r[s].formatType,f=r[s].format);var d=l.customFormat(c,h,f)||l.autoFormat(c);n.push({title:u,value:d})}return n}function a(t,e){e.forEach(function(e){delete t[e]})}function s(t,e){e&&e.forEach(function(e){e.removeOriginalTemporalField&&a(t,[e.removeOriginalTemporalField])})}function u(t,e){if(e)return e.forEach(function(e){if(!0===e.bin){var n=e.field,r=n.concat("_start"),i=n.concat("_mid"),o=n.concat("_end"),s=t[r],u=t[o];void 0!==s&&void 0!==u&&(t[n]=s+"-"+u);var c=[];c.push(r,i,o),a(t,c)}}),t}function c(t,e){if("line"===t||"area"===t){var n=[];for(var r in e)e.hasOwnProperty(r)&&e[r]instanceof Date&&n.push(r);a(e,n)}}Object.defineProperty(n,"__esModule",{value:!0});var l=t("./formatFieldValue");n.getTooltipData=function(t,e){if("group"!==t.mark.marktype){var n={};for(var i in t.datum)t.datum.hasOwnProperty(i)&&(n[i]=t.datum[i]);return a(n,["_id","_prev","width","height","count_start","count_end","layout_start","layout_mid","layout_end","layout_path","layout_x","layout_y"]),s(n,e.fields),u(n,e.fields),c(t.mark.marktype,n),!0===e.showAllFields?o(n,e):r(n,e)}},n.prepareCustomFieldsData=r,n.getValue=i,n.prepareAllFieldsData=o,n.removeFields=a,n.removeDuplicateTimeFields=s,n.combineBinFields=u,n.dropFieldsForLineArea=c},{"./formatFieldValue":6}],10:[function(t,e,n){(function(e){"use strict";function r(t,e){if(e&&t&&!(t.length<=0))if(e.aggregate){for(var n=0,r=t;n<r.length;n++)if((u=r[n]).field===e.field&&u.aggregate===e.aggregate)return u;for(var i=0,o=t;i<o.length;i++)if((u=o[i]).field===e.field&&!u.aggregate)return u}else for(var a=0,s=t;a<s.length;a++){var u=s[a];if(u.field===e.field)return u}}function i(t,e){if(e&&e.field&&t)for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i.field===e.field){if(!i.aggregate)return i;if(i.aggregate===e.aggregate||!e.aggregate)return i}}}function o(t,e,n){var r=a({},n.config);if(t||e){!t&&e&&(t={}),t&&!e&&(e={});var i={};if(i.field=e.field?s.fieldDef.field(e):t.field,e.type===u.TEMPORAL&&e.timeUnit){var o=e.field;i.removeOriginalTemporalField=o;for(var l=0,h=s.spec.fieldDefs(n);l<h.length;l++){var f=h[l];if(f.field===o&&!f.timeUnit){i.removeOriginalTemporalField=void 0;break}}}if(r.countTitle||(r.countTitle=s.config.defaultConfig.countTitle),i.title=t.title?t.title:s.fieldDef.title(e,r),i.formatType=t.formatType?t.formatType:c[e.type],t.format)i.format=t.format;else switch(i.formatType){case"time":i.format=e.timeUnit?s.timeUnit.formatExpression(e.timeUnit,"",!1,!1).split("'")[1]:r.timeFormat||s.config.defaultConfig.timeFormat;break;case"number":i.format=r.numberFormat}return e.bin&&(i.field=i.field.replace("_start","_range"),i.bin=!0,i.formatType="string"),i}console.error("[Tooltip] Cannot supplement a field when field and fieldDef are both empty.")}var a=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};Object.defineProperty(n,"__esModule",{value:!0});var s="undefined"!=typeof window?window.vl:void 0!==e?e.vl:null,u=t("vega-lite/build/src/type"),c={quantitative:"number",temporal:"time",ordinal:void 0,nominal:void 0};n.supplementOptions=function(t,e){var n=[];return!1!==t.showAllFields?s.spec.fieldDefs(e).forEach(function(i){var a=o(r(t.fields,i),i,e);n.push(a)}):t.fields&&t.fields.forEach(function(t){var r=o(t,i(s.spec.fieldDefs(e),t),e);n.push(r)}),t.fields=n,t},n.getFieldOption=r,n.getFieldDef=i,n.supplementFieldOption=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"vega-lite/build/src/type":5}],11:[function(t,e,n){"use strict";function r(){i.select("#vis-tooltip").classed("dark-theme light-theme",!1)}Object.defineProperty(n,"__esModule",{value:!0});var i=t("d3-selection");n.getTooltipPlaceholder=function(){return i.select("#vis-tooltip").empty()?i.select("body").append("div").attr("id","vis-tooltip").attr("class","vg-tooltip"):i.select("#vis-tooltip")},n.bindData=function(t,e){t.selectAll("table").remove();var n=t.append("table").selectAll(".tooltip-row").data(e);n.exit().remove();var r=n.enter().append("tr").attr("class","tooltip-row");r.append("td").attr("class","key").text(function(t){return t.title+":"}),r.append("td").attr("class","value").text(function(t){return t.value})},n.clearData=function(){i.select("#vis-tooltip").selectAll(".tooltip-row").data([]).exit().remove()},n.updatePosition=function(t,e){var n=10,r=10;e&&e.offset&&void 0!==e.offset.x&&null!==e.offset.x&&(n=e.offset.x),e&&e.offset&&void 0!==e.offset.y&&null!==e.offset.y&&(r=e.offset.y),i.select("#vis-tooltip").style("top",function(){var e=this.getBoundingClientRect().height;return t.clientY+e+r<window.innerHeight?t.clientY+r+"px":t.clientY-e-r+"px"}).style("left",function(){var e=this.getBoundingClientRect().width;return t.clientX+e+n<window.innerWidth?t.clientX+n+"px":t.clientX-e-n+"px"})},n.clearPosition=function(){i.select("#vis-tooltip").style("top","-9999px").style("left","-9999px")},n.updateColorTheme=function(t){r(),t&&"dark"===t.colorTheme?i.select("#vis-tooltip").classed("dark-theme",!0):i.select("#vis-tooltip").classed("light-theme",!0)},n.clearColorTheme=r},{"d3-selection":2}]},{},[7])(7)}),require=function t(e,n,r){function i(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[a]={exports:{}};e[a][0].call(l.exports,function(t){return i(e[a][1][t]||t)},l,l.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({"./defaults":[function(t,e,n){"use strict";n.__esModule=!0,n.default={pool:{size:navigator.hardwareConcurrency||8}}},{}],"./worker":[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t){var e=(0,u.getConfig)().basepath.web;return e?function(t,e){return t&&e?"/"===t.charAt(t.length-1)||"/"===e.charAt(0)?t+e:t+"/"+e:t+e}(e,t):t}n.__esModule=!0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=r(t("eventemitter3")),s=r(t("./slave-code-uri")),u=t("../config");if("object"!==o(window.Worker)&&"function"!=typeof window.Worker)throw new Error("Browser does not support web workers!");var c=function(t){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return i.currentRunnable=null,i.currentImportScripts=[],i.initWorker(),i.worker.addEventListener("message",i.handleMessage.bind(i)),i.worker.addEventListener("error",i.handleError.bind(i)),n&&i.run(n,r),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.initWorker=function(){try{this.worker=new window.Worker(s.default)}catch(e){var t=(0,u.getConfig)().fallback.slaveScriptUrl;if(!t)throw e;this.worker=new window.Worker(t)}},e.prototype.run=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.alreadyInitializedToRun(t,e)?this:("function"==typeof t?this.runMethod(t,e):this.runScripts(t,e),this.currentRunnable=t,this.currentImportScripts=e,this)},e.prototype.runMethod=function(t,e){var n=t.toString(),r=n.substring(n.indexOf("(")+1,n.indexOf(")")).split(","),o=n.substring(n.indexOf("{")+1,n.lastIndexOf("}"));this.worker.postMessage({initByMethod:!0,method:{args:r,body:o},scripts:e.map(i)})},e.prototype.runScripts=function(t,e){if(!t)throw new Error("Must pass a function or a script URL to run().");this.worker.postMessage({initByScripts:!0,scripts:e.concat([t]).map(i)})},e.prototype.send=function(t){return this.worker.postMessage({doRun:!0,param:t},arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]),this},e.prototype.kill=function(){return this.worker.terminate(),this.emit("exit"),this},e.prototype.promise=function(){var t=this;return new Promise(function(e,n){var r,i=void 0;r=function(n){t.removeListener("error",i),e(n)},i=function(e){t.removeListener("message",r),n(e)},t.once("message",r).once("error",i)})},e.prototype.alreadyInitializedToRun=function(t,e){return this.currentRunnable===t&&(this.currentImportScripts===e||0===e.length&&0===this.currentImportScripts.length)},e.prototype.handleMessage=function(t){if(t.data.error)this.handleError(t.data.error);else if(t.data.progress)this.handleProgress(t.data.progress);else{var e=function(t){return Array.prototype.slice.call(t)}(t.data.response);this.emit.apply(this,["message"].concat(e)),this.emit.apply(this,["done"].concat(e))}},e.prototype.handleProgress=function(t){this.emit("progress",t)},e.prototype.handleError=function(t){this.listeners("error",!0)||function(t){if(t.stack)console.error(t.stack);else if(t.message&&t.filename&&t.lineno){var e=t.filename.match(/^data:text\/javascript/)&&t.filename.length>50?t.filename.substr(0,50)+"...":t.filename;console.error(t.message+" @"+e+":"+t.lineno)}else console.error(t)}(t),t.preventDefault&&t.preventDefault(),this.emit("error",t)},e}(a.default);n.default=c},{"../config":2,"./slave-code-uri":6,eventemitter3:8}],1:[function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(t){return t&&t.__esModule?t:{default:t}}(t("./index"));"object"===("undefined"==typeof window?"undefined":r(window))&&(window.thread=i.default),"function"==typeof define?define([],function(){return i.default}):"object"===("undefined"==typeof e?"undefined":r(e))&&(e.exports=i.default)},{"./index":3}],2:[function(t,e,n){"use strict";n.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n.getConfig=function(){return o.get()},n.setConfig=function(){return o.set.apply(o,arguments)};var i={basepath:{node:"",web:""},fallback:{slaveScriptUrl:""}},o={get:function(){return i},set:function(t){if("object"!==("undefined"==typeof t?"undefined":r(t)))throw new Error("Expected config object.");!function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];Object.keys(n).forEach(function(o){var a=n[o],s=i.concat([o]);if("object"===("undefined"==typeof a?"undefined":r(a))){if("undefined"!=typeof e[o]&&"object"!==r(e[o]))throw new Error("Expected config property not to be an object: "+s.join("."));t(e[o],a,s)}else{if("object"===r(e[o]))throw new Error("Expected config property to be an object: "+s.join("."));e[o]=a}})}(i,t)}};n.default=o},{}],3:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(){return new u.default(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,arguments.length>1&&void 0!==arguments[1]?arguments[1]:[])}n.__esModule=!0,n.Pool=n.defaults=n.config=void 0,n.spawn=i,t("native-promise-only");var o=r(t("./config")),a=r(t("./defaults")),s=r(t("./pool")),u=r(t("./worker"));n.config=o.default,n.defaults=a.default,n.Pool=s.default,n.default={config:o.default,defaults:a.default,Pool:s.default,spawn:i,Worker:u.default}},{"./config":2,"./defaults":"./defaults","./pool":5,"./worker":"./worker","native-promise-only":9}],4:[function(t,e,n){"use strict";n.__esModule=!0;var r=function(t){function e(n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return r.pool=n,r.thread=null,r.runArgs=[],r.sendArgs=[],n.emit("newJob",r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.run=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(0===e.length)throw new Error("Cannot call .run() without arguments.");return this.runArgs=e,this},e.prototype.send=function(){if(0===this.runArgs.length)throw new Error("Cannot .send() before .run().");for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.sendArgs=e,this.emit("readyToRun"),this},e.prototype.executeOn=function(t){var e,n,r=this,i=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.emit.apply(r,["progress"].concat(e))};return(e=(n=t.on("progress",i).once("message",function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];r.emit.apply(r,["done"].concat(n)),t.removeListener("progress",i)}).once("error",function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];r.emit.apply(r,["error"].concat(n)),t.removeListener("progress",i)})).run.apply(n,this.runArgs)).send.apply(e,this.sendArgs),this.thread=t,this.emit("threadChanged"),this},e.prototype.promise=function(){var t=this;return new Promise(function(e){t.thread?e(t.thread.promise()):t.once("threadChanged",function(){e(t.thread.promise())})})},e.prototype.destroy=function(){this.removeAllListeners(),delete this.runArgs,delete this.sendArgs},e}(function(t){return t&&t.__esModule?t:{default:t}}(t("eventemitter3")).default);n.default=r},{eventemitter3:8}],5:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var i=r(t("eventemitter3")),o=r(t("./job")),a=r(t("./defaults")),s=t("./"),u=function(t){function e(n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,t.call(this));return r.threads=e.spawn(n||a.default.pool.size),r.idleThreads=r.threads.slice(),r.jobQueue=[],r.runArgs=[],r.on("newJob",function(t){return r.handleNewJob(t)}),r.on("threadAvailable",function(){return r.dequeue()}),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.run=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.runArgs=e,this},e.prototype.send=function(){var t;if(!this.runArgs)throw new Error("Pool.send() called without prior Pool.run(). You need to define what to run first.");var e=new o.default(this);return(t=e.run.apply(e,this.runArgs)).send.apply(t,arguments)},e.prototype.killAll=function(){this.threads.forEach(function(t){t.kill()})},e.prototype.queueJob=function(t){this.jobQueue.push(t),this.dequeue()},e.prototype.dequeue=function(){var t=this;if(0!==this.jobQueue.length&&0!==this.idleThreads.length){var e=this.jobQueue.shift(),n=this.idleThreads.shift();e.once("done",function(){for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];return t.handleJobSuccess.apply(t,[n,e].concat(i))}).once("error",function(){for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];return t.handleJobError.apply(t,[n,e].concat(i))}),e.executeOn(n)}},e.prototype.handleNewJob=function(t){var e=this;t.once("readyToRun",function(){return e.queueJob(t)})},e.prototype.handleJobSuccess=function(t,e){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];this.emit.apply(this,["done",e].concat(r)),this.handleJobDone(t,e)},e.prototype.handleJobError=function(t,e,n){this.emit("error",e,n),this.handleJobDone(t,e)},e.prototype.handleJobDone=function(t,e){var n=this;e.destroy(),this.idleThreads.push(t),this.emit("threadAvailable"),this.idleThreads.length===this.threads.length&&setTimeout(function(){n.emit("finished")},0)},e}(i.default);n.default=u,u.spawn=function(t){for(var e=[],n=0;n<t;n++)e.push((0,s.spawn)());return e}},{"./":3,"./defaults":"./defaults","./job":4,eventemitter3:8}],6:[function(t,e,n){"use strict";n.__esModule=!0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./slave-code")),i="data:text/javascript;charset=utf-8,"+encodeURI(r.default),o=window.createBlobURL||window.createObjectURL;if(!o){var a=window.URL||window.webkitURL;if(!a)throw new Error("No Blob creation implementation found.");o=a.createObjectURL}if("function"==typeof window.BlobBuilder&&"function"==typeof o){var s=new window.BlobBuilder;s.append(r.default),i=o(s.getBlob())}else"function"==typeof window.Blob&&"function"==typeof o&&(i=o(new window.Blob([r.default],{type:"text/javascript"})));n.default=i},{"./slave-code":7}],7:[function(t,e,n){e.exports="/*eslint-env worker*/\n/*global importScripts*/\n/*eslint-disable no-console*/\nself.module = {\n  exports : function() {\n    if (console) { console.error('No thread logic initialized.'); }\n  }\n};\n\nfunction handlerDone() {\n  var args = Array.prototype.slice.call(arguments, 0);\n  this.postMessage({ response : args });\n}\n\nfunction handlerProgress(progress) {\n  this.postMessage({ progress : progress });\n}\n\nfunction handlerError(error) {\n  // Need to clone error manually to avoid DataCloneError, since errors cannot be send\n  var cloned = {\n    message: error.message,\n    name: error.name,\n    stack: error.stack\n  };\n  this.postMessage({ error : cloned });\n}\n\nfunction handlerDoneTransfer() {\n  var args = Array.prototype.slice.call(arguments);\n  var lastArg = args.pop();\n\n  if (!(lastArg instanceof Array) && this.console) {\n    console.error('Expected 2nd parameter of <doneCallback>.transfer() to be an array. Got:', lastArg);\n  }\n\n  this.postMessage({ response : args }, lastArg);\n}\n\nfunction isPromise (thing) {\n  return thing && typeof thing.then === 'function';\n}\n\nself.onmessage = function (event) {\n  var scripts = event.data.scripts;\n  if (scripts && scripts.length > 0 && typeof importScripts !== 'function') {\n    throw new Error('importScripts() not supported.');\n  }\n\n  if (event.data.initByScripts) {\n    importScripts.apply(null, scripts);\n  }\n\n  if (event.data.initByMethod) {\n    var method = event.data.method;\n    this.module.exports = Function.apply(null, method.args.concat(method.body));\n\n    if (scripts && scripts.length > 0) {\n      importScripts.apply(null, scripts);\n    }\n  }\n\n  if (event.data.doRun) {\n    var handler = this.module.exports;\n\n    if (typeof handler !== 'function') {\n      throw new Error('Cannot run thread logic. No handler has been exported.');\n    }\n\n    var preparedHandlerDone = handlerDone.bind(this);\n    preparedHandlerDone.transfer = handlerDoneTransfer.bind(this);\n\n    var returned = handler.call(this, event.data.param, preparedHandlerDone, handlerProgress.bind(this));\n\n    if (isPromise(returned)) {\n      returned.then(preparedHandlerDone, handlerError.bind(this));\n    }\n  }\n}.bind(self);\n"},{}],8:[function(t,e,n){"use strict";function r(){}function i(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function o(){this._events=new r,this._eventsCount=0}var a=Object.prototype.hasOwnProperty,s="~";Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(s=!1)),o.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)a.call(t,e)&&n.push(s?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},o.prototype.listeners=function(t,e){var n=this._events[s?s+t:t];if(e)return!!n;if(!n)return[];if(n.fn)return[n.fn];for(var r=0,i=n.length,o=new Array(i);r<i;r++)o[r]=n[r].fn;return o},o.prototype.emit=function(t,e,n,r,i,o){var a=s?s+t:t;if(!this._events[a])return!1;var u,c,l=this._events[a],h=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),h){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,n),!0;case 4:return l.fn.call(l.context,e,n,r),!0;case 5:return l.fn.call(l.context,e,n,r,i),!0;case 6:return l.fn.call(l.context,e,n,r,i,o),!0}for(c=1,u=new Array(h-1);c<h;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var f,d=l.length;for(c=0;c<d;c++)switch(l[c].once&&this.removeListener(t,l[c].fn,void 0,!0),h){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,e);break;case 3:l[c].fn.call(l[c].context,e,n);break;case 4:l[c].fn.call(l[c].context,e,n,r);break;default:if(!u)for(f=1,u=new Array(h-1);f<h;f++)u[f-1]=arguments[f];l[c].fn.apply(l[c].context,u)}}return!0},o.prototype.on=function(t,e,n){var r=new i(e,n||this),o=s?s+t:t;return this._events[o]?this._events[o].fn?this._events[o]=[this._events[o],r]:this._events[o].push(r):(this._events[o]=r,this._eventsCount++),this},o.prototype.once=function(t,e,n){var r=new i(e,n||this,!0),o=s?s+t:t;return this._events[o]?this._events[o].fn?this._events[o]=[this._events[o],r]:this._events[o].push(r):(this._events[o]=r,this._eventsCount++),this},o.prototype.removeListener=function(t,e,n,i){var o=s?s+t:t;if(!this._events[o])return this;if(!e)return 0==--this._eventsCount?this._events=new r:delete this._events[o],this;var a=this._events[o];if(a.fn)a.fn!==e||i&&!a.once||n&&a.context!==n||(0==--this._eventsCount?this._events=new r:delete this._events[o]);else{for(var u=0,c=[],l=a.length;u<l;u++)(a[u].fn!==e||i&&!a[u].once||n&&a[u].context!==n)&&c.push(a[u]);c.length?this._events[o]=1===c.length?c[0]:c:0==--this._eventsCount?this._events=new r:delete this._events[o]}return this},o.prototype.removeAllListeners=function(t){var e;return t?this._events[e=s?s+t:t]&&(0==--this._eventsCount?this._events=new r:delete this._events[e]):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prototype.setMaxListeners=function(){return this},o.prefixed=s,o.EventEmitter=o,"undefined"!=typeof e&&(e.exports=o)},{}],9:[function(t,e,n){(function(t){!function(t,n,r){n[t]=n[t]||function(){"use strict";function t(t,e){h.add(t,e),l||(l=d(h.drain))}function e(t){var e,n=typeof t;return null==t||"object"!=n&&"function"!=n||(e=t.then),"function"==typeof e&&e}function n(){for(var t=0;t<this.chain.length;t++)r(this,1===this.state?this.chain[t].success:this.chain[t].failure,this.chain[t]);this.chain.length=0}function r(t,n,r){var i,o;try{!1===n?r.reject(t.msg):(i=!0===n?t.msg:n.call(void 0,t.msg))===r.promise?r.reject(TypeError("Promise-chain cycle")):(o=e(i))?o.call(i,r.resolve,r.reject):r.resolve(i)}catch(t){r.reject(t)}}function i(r){var a,u=this;if(!u.triggered){u.triggered=!0,u.def&&(u=u.def);try{(a=e(r))?t(function(){var t=new s(u);try{a.call(r,function(){i.apply(t,arguments)},function(){o.apply(t,arguments)})}catch(e){o.call(t,e)}}):(u.msg=r,u.state=1,u.chain.length>0&&t(n,u))}catch(t){o.call(new s(u),t)}}}function o(e){var r=this;r.triggered||(r.triggered=!0,r.def&&(r=r.def),r.msg=e,r.state=2,r.chain.length>0&&t(n,r))}function a(t,e,n,r){for(var i=0;i<e.length;i++)!function(i){t.resolve(e[i]).then(function(t){n(i,t)},r)}(i)}function s(t){this.def=t,this.triggered=!1}function u(e){if("function"!=typeof e)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var r=new function(t){this.promise=t,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}(this);this.then=function(e,i){var o={success:"function"!=typeof e||e,failure:"function"==typeof i&&i};return o.promise=new this.constructor(function(t,e){if("function"!=typeof t||"function"!=typeof e)throw TypeError("Not a function");o.resolve=t,o.reject=e}),r.chain.push(o),0!==r.state&&t(n,r),o.promise},this.catch=function(t){return this.then(void 0,t)};try{e.call(void 0,function(t){i.call(r,t)},function(t){o.call(r,t)})}catch(t){o.call(r,t)}}var c,l,h,f=Object.prototype.toString,d="undefined"!=typeof setImmediate?function(t){return setImmediate(t)}:setTimeout;try{Object.defineProperty({},"x",{}),c=function(t,e,n,r){return Object.defineProperty(t,e,{value:n,writable:!0,configurable:!1!==r})}}catch(t){c=function(t,e,n){return t[e]=n,t}}h=function(){var t,e,n;return{add:function(r,i){n=new function(t,e){this.fn=r,this.self=e,this.next=void 0}(0,i),e?e.next=n:t=n,e=n,n=void 0},drain:function(){var n=t;for(t=e=l=void 0;n;)n.fn.call(n.self),n=n.next}}}();var p=c({},"constructor",u,!1);return u.prototype=p,c(p,"__NPO__",0,!1),c(u,"resolve",function(t){return t&&"object"==typeof t&&1===t.__NPO__?t:new this(function(e,n){if("function"!=typeof e||"function"!=typeof n)throw TypeError("Not a function");e(t)})}),c(u,"reject",function(t){return new this(function(e,n){if("function"!=typeof e||"function"!=typeof n)throw TypeError("Not a function");n(t)})}),c(u,"all",function(t){var e=this;return"[object Array]"!=f.call(t)?e.reject(TypeError("Not an array")):0===t.length?e.resolve([]):new e(function(n,r){if("function"!=typeof n||"function"!=typeof r)throw TypeError("Not a function");var i=t.length,o=Array(i),s=0;a(e,t,function(t,e){o[t]=e,++s===i&&n(o)},r)})}),c(u,"race",function(t){var e=this;return"[object Array]"!=f.call(t)?e.reject(TypeError("Not an array")):new e(function(n,r){if("function"!=typeof n||"function"!=typeof r)throw TypeError("Not a function");a(e,t,function(t,e){n(e)},r)})}),u}(),"undefined"!=typeof e&&e.exports?e.exports=n[t]:"function"==typeof define&&define.amd&&define(function(){return n[t]})}("Promise","undefined"!=typeof t?t:this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1]),function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).PouchDB=t()}(function(){return function t(e,n,r){function i(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[a]={exports:{}};e[a][0].call(l.exports,function(t){return i(e[a][1][t]||t)},l,l.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,e,n){"use strict";e.exports=function(t){return function(){var e=arguments.length;if(e){for(var n=[],r=-1;++r<e;)n[r]=arguments[r];return t.call(this,n)}return t.call(this,[])}}},{}],2:[function(t,e,n){(function(r){function i(){var t;try{t=n.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}(n=e.exports=t(3)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},n.formatArgs=function(t){var e=this.useColors;if(t[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+t[0]+(e?"%c ":" ")+"+"+n.humanize(this.diff),e){var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var i=0,o=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&"%c"===t&&(o=++i)}),t.splice(o,0,r)}},n.save=function(t){try{null==t?n.storage.removeItem("debug"):n.storage.debug=t}catch(t){}},n.load=i,n.useColors=function(){return!("undefined"==typeof window||!window||void 0===window.process||"renderer"!==window.process.type)||"undefined"!=typeof document&&document&&"WebkitAppearance"in document.documentElement.style||"undefined"!=typeof window&&window&&window.console&&(console.firebug||console.exception&&console.table)||"undefined"!=typeof navigator&&navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},n.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),n.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],n.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},n.enable(i())}).call(this,t(9))},{3:3,9:9}],3:[function(t,e,n){function r(t){function e(){if(e.enabled){var t=e,r=+new Date;t.diff=r-(i||r),t.prev=i,t.curr=r,i=r;for(var o=new Array(arguments.length),a=0;a<o.length;a++)o[a]=arguments[a];o[0]=n.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var s=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(e,r){if("%%"===e)return e;s++;var i=n.formatters[r];return"function"==typeof i&&(e=i.call(t,o[s]),o.splice(s,1),s--),e}),n.formatArgs.call(t,o),(e.log||n.log||console.log.bind(console)).apply(t,o)}}return e.namespace=t,e.enabled=n.enabled(t),e.useColors=n.useColors(),e.color=function(t){var e,r=0;for(e in t)r=(r<<5)-r+t.charCodeAt(e),r|=0;return n.colors[Math.abs(r)%n.colors.length]}(t),"function"==typeof n.init&&n.init(e),e}var i;(n=e.exports=r.debug=r.default=r).coerce=function(t){return t instanceof Error?t.stack||t.message:t},n.disable=function(){n.enable("")},n.enable=function(t){n.save(t),n.names=[],n.skips=[];for(var e=("string"==typeof t?t:"").split(/[\s,]+/),r=e.length,i=0;i<r;i++)e[i]&&("-"===(t=e[i].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+t.substr(1)+"$")):n.names.push(new RegExp("^"+t+"$")))},n.enabled=function(t){var e,r;for(e=0,r=n.skips.length;e<r;e++)if(n.skips[e].test(t))return!1;for(e=0,r=n.names.length;e<r;e++)if(n.names[e].test(t))return!0;return!1},n.humanize=t(8),n.names=[],n.skips=[],n.formatters={}},{8:8}],4:[function(t,e,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function o(t){return"object"==typeof t&&null!==t}function a(t){return void 0===t}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!function(t){return"number"==typeof t}(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,n,r,s,u,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var l=new Error('Uncaught, unspecified "error" event. ('+e+")");throw l.context=e,l}if(a(n=this._events[t]))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(o(n))for(s=Array.prototype.slice.call(arguments,1),r=(c=n.slice()).length,u=0;u<r;u++)c[u].apply(this,s);return!0},r.prototype.on=r.prototype.addListener=function(t,e){var n;if(!i(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e),this._events[t]?o(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,o(this._events[t])&&!this._events[t].warned&&(n=a(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.once=function(t,e){function n(){this.removeListener(t,n),r||(r=!0,e.apply(this,arguments))}if(!i(e))throw TypeError("listener must be a function");var r=!1;return n.listener=e,this.on(t,n),this},r.prototype.removeListener=function(t,e){var n,r,a,s;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(a=(n=this._events[t]).length,r=-1,n===e||i(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(o(n)){for(s=a;s-- >0;)if(n[s]===e||n[s].listener&&n[s].listener===e){r=s;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(i(n=this._events[t]))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){return this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(i(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(t,e){return t.listenerCount(e)}},{}],5:[function(t,e,n){(function(t){"use strict";function n(){c=!0;for(var t,e,n=l.length;n;){for(e=l,l=[],t=-1;++t<n;)e[t]();n=l.length}c=!1}var r,i=t.MutationObserver||t.WebKitMutationObserver;if(i){var o=0,a=new i(n),s=t.document.createTextNode("");a.observe(s,{characterData:!0}),r=function(){s.data=o=++o%2}}else if(t.setImmediate||void 0===t.MessageChannel)r="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){n(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(n,0)};else{var u=new t.MessageChannel;u.port1.onmessage=n,r=function(){u.port2.postMessage(0)}}var c,l=[];e.exports=function(t){1!==l.push(t)||c||r()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(t,e,n){e.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],7:[function(t,e,n){"use strict";function r(){}function i(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=p,this.queue=[],this.outcome=void 0,t!==r&&u(this,t)}function o(t,e,n){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function a(t,e,n){l(function(){var r;try{r=e(n)}catch(e){return h.reject(t,e)}r===t?h.reject(t,new TypeError("Cannot resolve promise with itself")):h.resolve(t,r)})}function s(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function u(t,e){function n(e){i||(i=!0,h.reject(t,e))}function r(e){i||(i=!0,h.resolve(t,e))}var i=!1,o=c(function(){e(r,n)});"error"===o.status&&n(o.value)}function c(t,e){var n={};try{n.value=t(e),n.status="success"}catch(t){n.status="error",n.value=t}return n}var l=t(5),h={},f=["REJECTED"],d=["FULFILLED"],p=["PENDING"];e.exports=i,i.prototype.catch=function(t){return this.then(null,t)},i.prototype.then=function(t,e){if("function"!=typeof t&&this.state===d||"function"!=typeof e&&this.state===f)return this;var n=new this.constructor(r);return this.state!==p?a(n,this.state===d?t:e,this.outcome):this.queue.push(new o(n,t,e)),n},o.prototype.callFulfilled=function(t){h.resolve(this.promise,t)},o.prototype.otherCallFulfilled=function(t){a(this.promise,this.onFulfilled,t)},o.prototype.callRejected=function(t){h.reject(this.promise,t)},o.prototype.otherCallRejected=function(t){a(this.promise,this.onRejected,t)},h.resolve=function(t,e){var n=c(s,e);if("error"===n.status)return h.reject(t,n.value);var r=n.value;if(r)u(t,r);else{t.state=d,t.outcome=e;for(var i=-1,o=t.queue.length;++i<o;)t.queue[i].callFulfilled(e)}return t},h.reject=function(t,e){t.state=f,t.outcome=e;for(var n=-1,r=t.queue.length;++n<r;)t.queue[n].callRejected(e);return t},i.resolve=function(t){return t instanceof this?t:h.resolve(new this(r),t)},i.reject=function(t){var e=new this(r);return h.reject(e,t)},i.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,i=!1;if(!n)return this.resolve([]);for(var o=new Array(n),a=0,s=-1,u=new this(r);++s<n;)!function(t,r){e.resolve(t).then(function(t){o[r]=t,++a!==n||i||(i=!0,h.resolve(u,o))},function(t){i||(i=!0,h.reject(u,t))})}(t[s],s);return u},i.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,i=!1;if(!n)return this.resolve([]);for(var o=-1,a=new this(r);++o<n;)!function(t){e.resolve(t).then(function(t){i||(i=!0,h.resolve(a,t))},function(t){i||(i=!0,h.reject(a,t))})}(t[o]);return a}},{5:5}],8:[function(t,e,n){function r(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}var i=1e3,o=6e4,a=36e5,s=24*a;e.exports=function(t,e){e=e||{};var n=typeof t;if("string"===n&&t.length>0)return function(t){if(!((t=String(t)).length>1e4)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"days":case"day":case"d":return n*s;case"hours":case"hour":case"hrs":case"hr":case"h":return n*a;case"minutes":case"minute":case"mins":case"min":case"m":return n*o;case"seconds":case"second":case"secs":case"sec":case"s":return n*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}(t);if("number"===n&&!1===isNaN(t))return e.long?function(t){return r(t,s,"day")||r(t,a,"hour")||r(t,o,"minute")||r(t,i,"second")||t+" ms"}(t):function(t){return t>=s?Math.round(t/s)+"d":t>=a?Math.round(t/a)+"h":t>=o?Math.round(t/o)+"m":t>=i?Math.round(t/i)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},{}],9:[function(t,e,n){function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(t){if(l===setTimeout)return setTimeout(t,0);if((l===r||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(e){try{return l.call(null,t,0)}catch(e){return l.call(this,t,0)}}}function a(){m&&d&&(m=!1,d.length?p=d.concat(p):g=-1,p.length&&s())}function s(){if(!m){var t=o(a);m=!0;for(var e=p.length;e;){for(d=p,p=[];++g<e;)d&&d[g].run();g=-1,e=p.length}d=null,m=!1,function(t){if(h===clearTimeout)return clearTimeout(t);if((h===i||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}(t)}}function u(t,e){this.fun=t,this.array=e}function c(){}var l,h,f=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:r}catch(t){l=r}try{h="function"==typeof clearTimeout?clearTimeout:i}catch(t){h=i}}();var d,p=[],m=!1,g=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];p.push(new u(t,e)),1!==p.length||m||o(s)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.prependListener=c,f.prependOnceListener=c,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],10:[function(t,e,n){!function(t){if("object"==typeof n)e.exports=t();else{var r;try{r=window}catch(t){r=self}r.SparkMD5=t()}}(function(t){"use strict";function e(t,e){var n=t[0],r=t[1],i=t[2],o=t[3];r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&i|~r&o)+e[0]-680876936|0)<<7|n>>>25)+r|0)&r|~n&i)+e[1]-389564586|0)<<12|o>>>20)+n|0)&n|~o&r)+e[2]+606105819|0)<<17|i>>>15)+o|0)&o|~i&n)+e[3]-1044525330|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&i|~r&o)+e[4]-176418897|0)<<7|n>>>25)+r|0)&r|~n&i)+e[5]+1200080426|0)<<12|o>>>20)+n|0)&n|~o&r)+e[6]-1473231341|0)<<17|i>>>15)+o|0)&o|~i&n)+e[7]-45705983|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&i|~r&o)+e[8]+1770035416|0)<<7|n>>>25)+r|0)&r|~n&i)+e[9]-1958414417|0)<<12|o>>>20)+n|0)&n|~o&r)+e[10]-42063|0)<<17|i>>>15)+o|0)&o|~i&n)+e[11]-1990404162|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&i|~r&o)+e[12]+1804603682|0)<<7|n>>>25)+r|0)&r|~n&i)+e[13]-40341101|0)<<12|o>>>20)+n|0)&n|~o&r)+e[14]-1502002290|0)<<17|i>>>15)+o|0)&o|~i&n)+e[15]+1236535329|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&o|i&~o)+e[1]-165796510|0)<<5|n>>>27)+r|0)&i|r&~i)+e[6]-1069501632|0)<<9|o>>>23)+n|0)&r|n&~r)+e[11]+643717713|0)<<14|i>>>18)+o|0)&n|o&~n)+e[0]-373897302|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&o|i&~o)+e[5]-701558691|0)<<5|n>>>27)+r|0)&i|r&~i)+e[10]+38016083|0)<<9|o>>>23)+n|0)&r|n&~r)+e[15]-660478335|0)<<14|i>>>18)+o|0)&n|o&~n)+e[4]-405537848|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&o|i&~o)+e[9]+568446438|0)<<5|n>>>27)+r|0)&i|r&~i)+e[14]-1019803690|0)<<9|o>>>23)+n|0)&r|n&~r)+e[3]-187363961|0)<<14|i>>>18)+o|0)&n|o&~n)+e[8]+1163531501|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&o|i&~o)+e[13]-1444681467|0)<<5|n>>>27)+r|0)&i|r&~i)+e[2]-51403784|0)<<9|o>>>23)+n|0)&r|n&~r)+e[7]+1735328473|0)<<14|i>>>18)+o|0)&n|o&~n)+e[12]-1926607734|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r^i^o)+e[5]-378558|0)<<4|n>>>28)+r|0)^r^i)+e[8]-2022574463|0)<<11|o>>>21)+n|0)^n^r)+e[11]+1839030562|0)<<16|i>>>16)+o|0)^o^n)+e[14]-35309556|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r^i^o)+e[1]-1530992060|0)<<4|n>>>28)+r|0)^r^i)+e[4]+1272893353|0)<<11|o>>>21)+n|0)^n^r)+e[7]-155497632|0)<<16|i>>>16)+o|0)^o^n)+e[10]-1094730640|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r^i^o)+e[13]+681279174|0)<<4|n>>>28)+r|0)^r^i)+e[0]-358537222|0)<<11|o>>>21)+n|0)^n^r)+e[3]-722521979|0)<<16|i>>>16)+o|0)^o^n)+e[6]+76029189|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r^i^o)+e[9]-640364487|0)<<4|n>>>28)+r|0)^r^i)+e[12]-421815835|0)<<11|o>>>21)+n|0)^n^r)+e[15]+530742520|0)<<16|i>>>16)+o|0)^o^n)+e[2]-995338651|0)<<23|r>>>9)+i|0,r=((r+=((o=((o+=(r^((n=((n+=(i^(r|~o))+e[0]-198630844|0)<<6|n>>>26)+r|0)|~i))+e[7]+1126891415|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~r))+e[14]-1416354905|0)<<15|i>>>17)+o|0)|~n))+e[5]-57434055|0)<<21|r>>>11)+i|0,r=((r+=((o=((o+=(r^((n=((n+=(i^(r|~o))+e[12]+1700485571|0)<<6|n>>>26)+r|0)|~i))+e[3]-1894986606|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~r))+e[10]-1051523|0)<<15|i>>>17)+o|0)|~n))+e[1]-2054922799|0)<<21|r>>>11)+i|0,r=((r+=((o=((o+=(r^((n=((n+=(i^(r|~o))+e[8]+1873313359|0)<<6|n>>>26)+r|0)|~i))+e[15]-30611744|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~r))+e[6]-1560198380|0)<<15|i>>>17)+o|0)|~n))+e[13]+1309151649|0)<<21|r>>>11)+i|0,r=((r+=((o=((o+=(r^((n=((n+=(i^(r|~o))+e[4]-145523070|0)<<6|n>>>26)+r|0)|~i))+e[11]-1120210379|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~r))+e[2]+718787259|0)<<15|i>>>17)+o|0)|~n))+e[9]-343485551|0)<<21|r>>>11)+i|0,t[0]=n+t[0]|0,t[1]=r+t[1]|0,t[2]=i+t[2]|0,t[3]=o+t[3]|0}function n(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}function r(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t[e]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24);return n}function i(t){var r,i,o,a,s,u,c=t.length,l=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=c;r+=64)e(l,n(t.substring(r-64,r)));for(i=(t=t.substring(r-64)).length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0;r<i;r+=1)o[r>>2]|=t.charCodeAt(r)<<(r%4<<3);if(o[r>>2]|=128<<(r%4<<3),r>55)for(e(l,o),r=0;r<16;r+=1)o[r]=0;return a=(a=8*c).toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(a[2],16),u=parseInt(a[1],16)||0,o[14]=s,o[15]=u,e(l,o),l}function o(t){var n,i,o,a,s,u,c=t.length,l=[1732584193,-271733879,-1732584194,271733878];for(n=64;n<=c;n+=64)e(l,r(t.subarray(n-64,n)));for(i=(t=n-64<c?t.subarray(n-64):new Uint8Array(0)).length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=0;n<i;n+=1)o[n>>2]|=t[n]<<(n%4<<3);if(o[n>>2]|=128<<(n%4<<3),n>55)for(e(l,o),n=0;n<16;n+=1)o[n]=0;return a=(a=8*c).toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(a[2],16),u=parseInt(a[1],16)||0,o[14]=s,o[15]=u,e(l,o),l}function a(t){var e,n="";for(e=0;e<4;e+=1)n+=h[t>>8*e+4&15]+h[t>>8*e&15];return n}function s(t){var e;for(e=0;e<t.length;e+=1)t[e]=a(t[e]);return t.join("")}function u(t){return/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t))),t}function c(t){var e,n=[],r=t.length;for(e=0;e<r-1;e+=2)n.push(parseInt(t.substr(e,2),16));return String.fromCharCode.apply(String,n)}function l(){this.reset()}var h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return s(i("hello")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function e(t,e){return(t=0|t||0)<0?Math.max(t+e,0):Math.min(t,e)}ArrayBuffer.prototype.slice=function(n,r){var i,o,a,s,u=this.byteLength,c=e(n,u),l=u;return r!==t&&(l=e(r,u)),c>l?new ArrayBuffer(0):(i=l-c,o=new ArrayBuffer(i),a=new Uint8Array(o),s=new Uint8Array(this,c,i),a.set(s),o)}}(),l.prototype.append=function(t){return this.appendBinary(u(t)),this},l.prototype.appendBinary=function(t){this._buff+=t,this._length+=t.length;var r,i=this._buff.length;for(r=64;r<=i;r+=64)e(this._hash,n(this._buff.substring(r-64,r)));return this._buff=this._buff.substring(r-64),this},l.prototype.end=function(t){var e,n,r=this._buff,i=r.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<i;e+=1)o[e>>2]|=r.charCodeAt(e)<<(e%4<<3);return this._finish(o,i),n=s(this._hash),t&&(n=c(n)),this.reset(),n},l.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},l.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},l.prototype.setState=function(t){return this._buff=t.buff,this._length=t.length,this._hash=t.hash,this},l.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},l.prototype._finish=function(t,n){var r,i,o,a=n;if(t[a>>2]|=128<<(a%4<<3),a>55)for(e(this._hash,t),a=0;a<16;a+=1)t[a]=0;r=(r=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(r[2],16),o=parseInt(r[1],16)||0,t[14]=i,t[15]=o,e(this._hash,t)},l.hash=function(t,e){return l.hashBinary(u(t),e)},l.hashBinary=function(t,e){var n=s(i(t));return e?c(n):n},(l.ArrayBuffer=function(){this.reset()}).prototype.append=function(t){var n,i=function(t,e,n){var r=new Uint8Array(t.byteLength+e.byteLength);return r.set(new Uint8Array(t)),r.set(new Uint8Array(e),t.byteLength),r}(this._buff.buffer,t),o=i.length;for(this._length+=t.byteLength,n=64;n<=o;n+=64)e(this._hash,r(i.subarray(n-64,n)));return this._buff=n-64<o?new Uint8Array(i.buffer.slice(n-64)):new Uint8Array(0),this},l.ArrayBuffer.prototype.end=function(t){var e,n,r=this._buff,i=r.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<i;e+=1)o[e>>2]|=r[e]<<(e%4<<3);return this._finish(o,i),n=s(this._hash),t&&(n=c(n)),this.reset(),n},l.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},l.ArrayBuffer.prototype.getState=function(){var t=l.prototype.getState.call(this);return t.buff=function(t){return String.fromCharCode.apply(null,new Uint8Array(t))}(t.buff),t},l.ArrayBuffer.prototype.setState=function(t){return t.buff=function(t,e){var n,r=t.length,i=new ArrayBuffer(r),o=new Uint8Array(i);for(n=0;n<r;n+=1)o[n]=t.charCodeAt(n);return o}(t.buff),l.prototype.setState.call(this,t)},l.ArrayBuffer.prototype.destroy=l.prototype.destroy,l.ArrayBuffer.prototype._finish=l.prototype._finish,l.ArrayBuffer.hash=function(t,e){var n=s(o(new Uint8Array(t)));return e?c(n):n},l})},{}],11:[function(t,e,n){var r=t(14),i=t(15),o=i;o.v1=r,o.v4=i,e.exports=o},{14:14,15:15}],12:[function(t,e,n){for(var r=[],i=0;i<256;++i)r[i]=(i+256).toString(16).substr(1);e.exports=function(t,e){var n=e||0;return r[t[n++]]+r[t[n++]]+r[t[n++]]+r[t[n++]]+"-"+r[t[n++]]+r[t[n++]]+"-"+r[t[n++]]+r[t[n++]]+"-"+r[t[n++]]+r[t[n++]]+"-"+r[t[n++]]+r[t[n++]]+r[t[n++]]+r[t[n++]]+r[t[n++]]+r[t[n++]]}},{}],13:[function(t,e,n){(function(t){var n,r=t.crypto||t.msCrypto;if(r&&r.getRandomValues){var i=new Uint8Array(16);n=function(){return r.getRandomValues(i),i}}if(!n){var o=new Array(16);n=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),o[e]=t>>>((3&e)<<3)&255;return o}}e.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],14:[function(t,e,n){var r=t(13),i=t(12),o=r(),a=[1|o[0],o[1],o[2],o[3],o[4],o[5]],s=16383&(o[6]<<8|o[7]),u=0,c=0;e.exports=function(t,e,n){var r=e&&n||0,o=e||[],l=void 0!==(t=t||{}).clockseq?t.clockseq:s,h=void 0!==t.msecs?t.msecs:(new Date).getTime(),f=void 0!==t.nsecs?t.nsecs:c+1,d=h-u+(f-c)/1e4;if(d<0&&void 0===t.clockseq&&(l=l+1&16383),(d<0||h>u)&&void 0===t.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=h,c=f,s=l;var p=(1e4*(268435455&(h+=122192928e5))+f)%4294967296;o[r++]=p>>>24&255,o[r++]=p>>>16&255,o[r++]=p>>>8&255,o[r++]=255&p;var m=h/4294967296*1e4&268435455;o[r++]=m>>>8&255,o[r++]=255&m,o[r++]=m>>>24&15|16,o[r++]=m>>>16&255,o[r++]=l>>>8|128,o[r++]=255&l;for(var g=t.node||a,v=0;v<6;++v)o[r+v]=g[v];return e||i(o)}},{12:12,13:13}],15:[function(t,e,n){var r=t(13),i=t(12);e.exports=function(t,e,n){var o=e&&n||0;"string"==typeof t&&(e="binary"==t?new Array(16):null,t=null);var a=(t=t||{}).random||(t.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,e)for(var s=0;s<16;++s)e[o+s]=a[s];return e||i(a)}},{12:12,13:13}],16:[function(t,e,n){"use strict";function r(t,e,n){var r=n[n.length-1];t===r.element&&(n.pop(),r=n[n.length-1]);var i=r.element,o=r.index;Array.isArray(i)?i.push(t):o===e.length-2?i[e.pop()]=t:e.push(t)}n.stringify=function(t){var e=[];e.push({obj:t});for(var n,r,i,o,a,s,u,c,l,h="";n=e.pop();)if(r=n.obj,h+=n.prefix||"",i=n.val||"")h+=i;else if("object"!=typeof r)h+=void 0===r?null:JSON.stringify(r);else if(null===r)h+="null";else if(Array.isArray(r)){for(e.push({val:"]"}),o=r.length-1;o>=0;o--)e.push({obj:r[o],prefix:0===o?"":","});e.push({val:"["})}else{for(s in a=[],r)r.hasOwnProperty(s)&&a.push(s);for(e.push({val:"}"}),o=a.length-1;o>=0;o--)c=r[u=a[o]],l=o>0?",":"",l+=JSON.stringify(u)+":",e.push({obj:c,prefix:l});e.push({val:"{"})}return h},n.parse=function(t){for(var e,n,i,o,a,s,u,c,l,h=[],f=[],d=0;;)if("}"!==(e=t[d++])&&"]"!==e&&void 0!==e)switch(e){case" ":case"\t":case"\n":case":":case",":break;case"n":d+=3,r(null,h,f);break;case"t":d+=3,r(!0,h,f);break;case"f":d+=4,r(!1,h,f);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(n="",d--;;){if(i=t[d++],!/[\d\.\-e\+]/.test(i)){d--;break}n+=i}r(parseFloat(n),h,f);break;case'"':for(o="",a=void 0,s=0;'"'!==(u=t[d++])||"\\"===a&&s%2==1;)o+=u,"\\"===(a=u)?s++:s=0;r(JSON.parse('"'+o+'"'),h,f);break;case"[":h.push((c={element:[],index:h.length}).element),f.push(c);break;case"{":h.push((l={element:{},index:h.length}).element),f.push(l);break;default:throw new Error("unexpectedly reached end of input: "+e)}else{if(1===h.length)return h.pop();r(h.pop(),h,f)}}},{}],17:[function(t,e,n){(function(n){"use strict";function r(t){return t&&"object"==typeof t&&"default"in t?t.default:t}function i(t){var e,n,r;if(!t||"object"!=typeof t)return t;if(Array.isArray(t)){for(e=[],n=0,r=t.length;n<r;n++)e[n]=i(t[n]);return e}if(t instanceof Date)return t.toISOString();if(function(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}(t))return function(t){if(t instanceof ArrayBuffer)return function(t){if("function"==typeof t.slice)return t.slice(0);var e=new ArrayBuffer(t.byteLength),n=new Uint8Array(e),r=new Uint8Array(t);return n.set(r),e}(t);var e=t.size,n=t.type;return"function"==typeof t.slice?t.slice(0,e,n):t.webkitSlice(0,e,n)}(t);if(!function(t){var e=Object.getPrototypeOf(t);if(null===e)return!0;var n=e.constructor;return"function"==typeof n&&n instanceof n&&dn.call(n)==pn}(t))return t;for(n in e={},t)if(Object.prototype.hasOwnProperty.call(t,n)){var o=i(t[n]);void 0!==o&&(e[n]=o)}return e}function o(t){var e=!1;return on(function(n){if(e)throw new Error("once called more than once");e=!0,t.apply(this,n)})}function a(t){return on(function(e){var n=this,r="function"==typeof(e=i(e))[e.length-1]&&e.pop(),a=new fn(function(r,i){var a;try{var s=o(function(t,e){t?i(t):r(e)});e.push(s),(a=t.apply(n,e))&&"function"==typeof a.then&&r(a)}catch(t){i(t)}});return r&&a.then(function(t){r(null,t)},r),a})}function s(t,e){return a(on(function(n){if(this._closed)return fn.reject(new Error("database is closed"));if(this._destroyed)return fn.reject(new Error("database is destroyed"));var r=this;return function(t,e,n){if(t.constructor.listeners("debug").length){for(var r=["api",t.name,e],i=0;i<n.length-1;i++)r.push(n[i]);t.constructor.emit("debug",r);var o=n[n.length-1];n[n.length-1]=function(n,r){var i=["api",t.name,e];i=i.concat(n?["error",n]:["success",r]),t.constructor.emit("debug",i),o(n,r)}}}(r,t,n),this.taskqueue.isReady?e.apply(this,n):new fn(function(e,i){r.taskqueue.addTask(function(o){o?i(o):e(r[t].apply(r,n))})})}))}function u(t){return"$"+t}function c(t){return t.substring(1)}function l(){this._store={}}function h(t){if(this._store=new l,t&&Array.isArray(t))for(var e=0,n=t.length;e<n;e++)this.add(t[e])}function f(t,e){for(var n={},r=0,i=e.length;r<i;r++){var o=e[r];o in t&&(n[o]=t[o])}return n}function d(t){return t}function p(t){return[{ok:t}]}function m(t,e,n){function r(){var t;++l===c&&(t=[],h.forEach(function(e){e.docs.forEach(function(n){t.push({id:e.id,docs:[n]})})}),n(null,{results:t}))}function i(t,e,n){h[t]={id:e,docs:n},r()}function o(){if(!(g>=m.length)){var t=Math.min(g+gn,m.length),e=m.slice(g,t);a(e,g),g+=e.length}}function a(n,r){n.forEach(function(n,a){var s=r+a,c=u.get(n),l=f(c[0],["atts_since","attachments"]);l.open_revs=c.map(function(t){return t.rev}),l.open_revs=l.open_revs.filter(d);var h=d;0===l.open_revs.length&&(delete l.open_revs,h=p),["revs","attachments","binary","ajax","latest"].forEach(function(t){t in e&&(l[t]=e[t])}),t.get(n,l,function(t,e){var r;r=t?[{error:t}]:h(e),i(s,n,r),o()})})}var s=e.docs,u=new en;s.forEach(function(t){u.has(t.id)?u.get(t.id).push(t):u.set(t.id,[t])});var c=u.size,l=0,h=new Array(c),m=[];u.forEach(function(t,e){m.push(e)});var g=0;o()}function g(){return"undefined"!=typeof chrome&&void 0!==chrome.storage&&void 0!==chrome.storage.local}function v(){return mn}function y(){var t;an.EventEmitter.call(this),this._listeners={},t=this,g()?chrome.storage.onChanged.addListener(function(e){null!=e.db_name&&t.emit(e.dbName.newValue)}):v()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(e){t.emit(e.key)}):window.attachEvent("storage",function(e){t.emit(e.key)}))}function w(t){if("undefined"!==console&&t in console){var e=Array.prototype.slice.call(arguments,1);console[t].apply(console,e)}}function b(t){var e=0;return t||(e=2e3),function(t,e){return t=parseInt(t,10)||0,(e=parseInt(e,10))!=e||e<=t?e=(t||1)<<1:e+=1,e>6e5&&(t=3e5,e=6e5),~~((e-t)*Math.random()+t)}(t,e)}function x(t,e){w("info","The above "+t+" is totally normal. "+e)}function _(t,e,n){Error.call(this,n),this.status=t,this.name=e,this.message=n,this.error=!0}function M(t,e){function n(e){for(var n in t)"function"!=typeof t[n]&&(this[n]=t[n]);void 0!==e&&(this.reason=e)}return n.prototype=_.prototype,new n(e)}function E(t){if("object"!=typeof t){var e=t;(t=En).data=e}return"error"in t&&"conflict"===t.error&&(t.name="conflict",t.status=409),"name"in t||(t.name=t.error||"unknown"),"status"in t||(t.status=500),"message"in t||(t.message=t.message||t.reason),t}function S(t){var e={},n=t.filter&&"function"==typeof t.filter;return e.query=t.query_params,function(r){r.doc||(r.doc={});var i=n&&function(t,e,n){try{return!t(e,n)}catch(t){var r="Filter function threw: "+t.toString();return M(kn,r)}}(t.filter,r.doc,e);if("object"==typeof i)return i;if(i)return!1;if(t.include_docs){if(!t.attachments)for(var o in r.doc._attachments)r.doc._attachments.hasOwnProperty(o)&&(r.doc._attachments[o].stub=!0)}else delete r.doc;return!0}}function T(t){for(var e=[],n=0,r=t.length;n<r;n++)e=e.concat(t[n]);return e}function A(t){var e;if(t?"string"!=typeof t?e=M(xn):/^_/.test(t)&&!/^_(design|local)/.test(t)&&(e=M(Mn)):e=M(_n),e)throw e}function k(t){return"boolean"==typeof t._remote?t._remote:"function"==typeof t.type&&(w("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),"http"===t.type())}function C(t){if(!t)return null;var e=t.split("/");return 2===e.length?e:1===e.length?[t,t]:null}function R(t){var e=C(t);return e?e.join("/"):null}function D(t){for(var e=Fn.exec(t),n={},r=14;r--;){var i=Pn[r],o=e[r]||"",a=-1!==["user","password"].indexOf(i);n[i]=a?decodeURIComponent(o):o}return n[In]={},n[Pn[12]].replace(Nn,function(t,e,r){e&&(n[In][e]=r)}),n}function L(t,e){var n=[],r=[];for(var i in e)e.hasOwnProperty(i)&&(n.push(i),r.push(e[i]));return n.push(t),Function.apply(null,n).apply(null,r)}function O(t,e,n){return new fn(function(r,i){t.get(e,function(o,a){if(o){if(404!==o.status)return i(o);a={}}var s=a._rev,u=n(a);if(!u)return r({updated:!1,rev:s});u._id=e,u._rev=s,r(function(t,e,n){return t.put(e).then(function(t){return{updated:!0,rev:t.rev}},function(r){if(409!==r.status)throw r;return O(t,e._id,n)})}(t,u,n))})})}function P(){return nn.v4().replace(/-/g,"").toLowerCase()}function I(t){for(var e,n,r,i,o=t.rev_tree.slice();i=o.pop();){var a=i.ids,s=a[2],u=i.pos;if(s.length)for(var c=0,l=s.length;c<l;c++)o.push({pos:u+1,ids:s[c]});else{var h=!!a[1].deleted,f=a[0];e&&!(r!==h?r:n!==u?n<u:e<f)||(e=f,n=u,r=h)}}return n+"-"+e}function N(t,e){for(var n,r=t.slice();n=r.pop();)for(var i=n.pos,o=n.ids,a=o[2],s=e(0===a.length,i,o[0],n.ctx,o[1]),u=0,c=a.length;u<c;u++)r.push({pos:i+1,ids:a[u],ctx:s})}function F(t,e){return t.pos-e.pos}function j(t){var e=[];N(t,function(t,n,r,i,o){t&&e.push({rev:n+"-"+r,pos:n,opts:o})}),e.sort(F).reverse();for(var n=0,r=e.length;n<r;n++)delete e[n].pos;return e}function z(t){for(var e=I(t),n=j(t.rev_tree),r=[],i=0,o=n.length;i<o;i++){var a=n[i];a.rev===e||a.opts.deleted||r.push(a.rev)}return r}function U(t){var e=[];return N(t.rev_tree,function(t,n,r,i,o){"available"!==o.status||t||(e.push(n+"-"+r),o.status="missing")}),e}function V(t){for(var e,n=[],r=t.slice();e=r.pop();){var i=e.pos,o=e.ids,a=o[0],s=o[1],u=o[2],c=0===u.length,l=e.history?e.history.slice():[];l.push({id:a,opts:s}),c&&n.push({pos:i+1-l.length,ids:l});for(var h=0,f=u.length;h<f;h++)r.push({pos:i+1,ids:u[h],history:l})}return n.reverse()}function B(t,e){return t.pos-e.pos}function H(t,e,n){var r=function(t,e,n){for(var r,i=0,o=t.length;i<o;)n(t[r=i+o>>>1],e)<0?i=r+1:o=r;return i}(t,e,n);t.splice(r,0,e)}function q(t,e){for(var n,r,i=e,o=t.length;i<o;i++){var a=t[i],s=[a.id,a.opts,[]];r?(r[2].push(s),r=s):n=r=s}return n}function G(t,e){return t[0]<e[0]?-1:1}function W(t,e){for(var n=[{tree1:t,tree2:e}],r=!1;n.length>0;){var i=n.pop(),o=i.tree1,a=i.tree2;(o[1].status||a[1].status)&&(o[1].status="available"===o[1].status||"available"===a[1].status?"available":"missing");for(var s=0;s<a[2].length;s++)if(o[2][0]){for(var u=!1,c=0;c<o[2].length;c++)o[2][c][0]===a[2][s][0]&&(n.push({tree1:o[2][c],tree2:a[2][s]}),u=!0);u||(r="new_branch",H(o[2],a[2][s],G))}else r="new_leaf",o[2][0]=a[2][s]}return{conflicts:r,tree:t}}function Y(t,e,n){var r,i=[],o=!1,a=!1;if(!t.length)return{tree:[e],conflicts:"new_leaf"};for(var s=0,u=t.length;s<u;s++){var c=t[s];if(c.pos===e.pos&&c.ids[0]===e.ids[0])r=W(c.ids,e.ids),i.push({pos:c.pos,ids:r.tree}),o=o||r.conflicts,a=!0;else if(!0!==n){var l=c.pos<e.pos?c:e,h=c.pos<e.pos?e:c,f=[],d=[];for(d.push({ids:l.ids,diff:h.pos-l.pos,parent:null,parentIdx:null});d.length>0;){var p=d.pop();if(0!==p.diff)for(var m=p.ids[2],g=0,v=m.length;g<v;g++)d.push({ids:m[g],diff:p.diff-1,parent:p.ids,parentIdx:g});else p.ids[0]===h.ids[0]&&f.push(p)}var y=f[0];y?(r=W(y.ids,h.ids),y.parent[2][y.parentIdx]=r.tree,i.push({pos:l.pos,ids:l.ids}),o=o||r.conflicts,a=!0):i.push(c)}else i.push(c)}return a||i.push(e),i.sort(B),{tree:i,conflicts:o||"internal_node"}}function X(t,e,n){var r=Y(t,e),i=function(t,e){for(var n,r,i=V(t),o=0,a=i.length;o<a;o++){var s,u=i[o],c=u.ids;if(c.length>e){n||(n={});var l=c.length-e;s={pos:u.pos+l,ids:q(c,l)};for(var h=0;h<l;h++)n[u.pos+h+"-"+c[h].id]=!0}else s={pos:u.pos,ids:q(c,0)};r=r?Y(r,s,!0).tree:[s]}return n&&N(r,function(t,e,r){delete n[e+"-"+r]}),{tree:r,revs:n?Object.keys(n):[]}}(r.tree,n);return{tree:i.tree,stemmedRevs:i.revs,conflicts:r.conflicts}}function $(t){return t.ids}function Q(t,e){e||(e=I(t));for(var n,r=e.substring(e.indexOf("-")+1),i=t.rev_tree.map($);n=i.pop();){if(n[0]===r)return!!n[1].deleted;i=i.concat(n[2])}}function J(t){return/^_local/.test(t)}function Z(t,e){for(var n,r=e.rev_tree.slice();n=r.pop();){var i=n.pos,o=n.ids,a=o[0],s=o[1],u=o[2],c=0===u.length,l=n.history?n.history.slice():[];if(l.push({id:a,pos:i,opts:s}),c)for(var h=0,f=l.length;h<f;h++){var d=l[h];if(d.pos+"-"+d.id===t)return i+"-"+a}for(var p=0,m=u.length;p<m;p++)r.push({pos:i+1,ids:u[p],history:l})}throw new Error("Unable to resolve latest revision for id "+e.id+", rev "+t)}function K(t,e,n){function r(){a.cancel()}an.EventEmitter.call(this);var a=this;this.db=t;var s=(e=e?i(e):{}).complete=o(function(e,n){e?function(t,e){return"listenerCount"in t?t.listenerCount(e):an.EventEmitter.listenerCount(t,e)}(a,"error")>0&&a.emit("error",e):a.emit("complete",n),a.removeAllListeners(),t.removeListener("destroyed",r)});n&&(a.on("complete",function(t){n(null,t)}),a.on("error",n)),t.once("destroyed",r),e.onChange=function(t){a.isCancelled||function(t,e){try{t.emit("change",e)}catch(t){w("error",'Error in .on("change", function):',t)}}(a,t)};var u=new fn(function(t,n){e.complete=function(e,r){e?n(e):t(r)}});a.once("cancel",function(){t.removeListener("destroyed",r),e.complete(null,{status:"cancelled"})}),this.then=u.then.bind(u),this.catch=u.catch.bind(u),this.then(function(t){s(null,t)},s),t.taskqueue.isReady?a.validateChanges(e):t.taskqueue.addTask(function(t){t?e.complete(t):a.isCancelled?a.emit("cancel"):a.validateChanges(e)})}function tt(t,e,n){var r=[{rev:t._rev}];"all_docs"===n.style&&(r=j(e.rev_tree).map(function(t){return{rev:t.rev}}));var i={id:e.id,changes:r,doc:t};return Q(e,t._rev)&&(i.deleted=!0),n.conflicts&&(i.doc._conflicts=z(e),i.doc._conflicts.length||delete i.doc._conflicts),i}function et(t,e){return t<e?-1:t>e?1:0}function nt(t,e){return function(n,r){n||r[0]&&r[0].error?((n=n||r[0]).docId=e,t(n)):t(null,r.length?r[0]:r)}}function rt(t,e){var n=et(t._id,e._id);return 0!==n?n:et(t._revisions?t._revisions.start:0,e._revisions?e._revisions.start:0)}function it(){an.EventEmitter.call(this)}function ot(){this.isReady=!1,this.failed=!1,this.queue=[]}function at(t,e){if(!(this instanceof at))return new at(t,e);var n=this;if(e=e||{},t&&"object"==typeof t&&(t=(e=t).name,delete e.name),this.__opts=e=i(e),n.auto_compaction=e.auto_compaction,n.prefix=at.prefix,"string"!=typeof t)throw new Error("Missing/invalid DB name");var r=function(t,e){var n=t.match(/([a-z-]*):\/\/(.*)/);if(n)return{name:/https?/.test(n[1])?n[1]+"://"+n[2]:n[2],adapter:n[1]};var r=at.adapters,i=at.preferredAdapters,o=at.prefix,a=e.adapter;if(!a)for(var s=0;s<i.length&&"idb"===(a=i[s])&&"websql"in r&&v()&&localStorage["_pouch__websqldb_"+o+t];++s)w("log",'PouchDB is downgrading "'+t+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');var u=r[a];return{name:u&&"use_prefix"in u&&!u.use_prefix?t:o+t,adapter:a}}((e.prefix||"")+t,e);if(e.name=r.name,e.adapter=e.adapter||r.adapter,n.name=t,n._adapter=e.adapter,at.emit("debug",["adapter","Picked adapter: ",e.adapter]),!at.adapters[e.adapter]||!at.adapters[e.adapter].valid())throw new Error("Invalid Adapter: "+e.adapter);it.call(n),n.taskqueue=new ot,n.adapter=e.adapter,at.adapters[e.adapter].call(n,e,function(t){if(t)return n.taskqueue.fail(t);(function(t){function e(e){t.removeListener("closed",n),e||t.constructor.emit("destroyed",t.name)}function n(){t.removeListener("destroyed",e),t.constructor.emit("unref",t)}t.once("destroyed",e),t.once("closed",n),t.constructor.emit("ref",t)})(n),n.emit("created",n),at.emit("created",n.name),n.taskqueue.ready(n)})}function st(t,e){for(var n=t,r=0,i=e.length;r<i&&(n=n[e[r]]);r++);return n}function ut(t){for(var e=[],n="",r=0,i=t.length;r<i;r++){var o=t[r];"."===o?r>0&&"\\"===t[r-1]?n=n.substring(0,n.length-1)+".":(e.push(n),n=""):n+=o}return e.push(n),e}function ct(t){return Un.indexOf(t)>-1}function lt(t){return Object.keys(t)[0]}function ht(t){var e={};return t.forEach(function(t){Object.keys(t).forEach(function(n){var r=t[n];if("object"!=typeof r&&(r={$eq:r}),ct(n))e[n]=r instanceof Array?r.map(function(t){return ht([t])}):ht([r]);else{var i=e[n]=e[n]||{};Object.keys(r).forEach(function(t){var e=r[t];return"$gt"===t||"$gte"===t?function(t,e,n){void 0===n.$eq&&(void 0!==n.$gte?"$gte"===t?e>n.$gte&&(n.$gte=e):e>=n.$gte&&(delete n.$gte,n.$gt=e):void 0!==n.$gt?"$gte"===t?e>n.$gt&&(delete n.$gt,n.$gte=e):e>n.$gt&&(n.$gt=e):n[t]=e)}(t,e,i):"$lt"===t||"$lte"===t?function(t,e,n){void 0===n.$eq&&(void 0!==n.$lte?"$lte"===t?e<n.$lte&&(n.$lte=e):e<=n.$lte&&(delete n.$lte,n.$lt=e):void 0!==n.$lt?"$lte"===t?e<n.$lt&&(delete n.$lt,n.$lte=e):e<n.$lt&&(n.$lt=e):n[t]=e)}(t,e,i):"$ne"===t?function(t,e){"$ne"in e?e.$ne.push(t):e.$ne=[t]}(e,i):"$eq"===t?function(t,e){delete e.$gt,delete e.$gte,delete e.$lt,delete e.$lte,delete e.$ne,e.$eq=t}(e,i):void(i[t]=e)})}})}),e}function ft(t,e){if(t===e)return 0;t=dt(t),e=dt(e);var n=vt(t),r=vt(e);if(n-r!=0)return n-r;switch(typeof t){case"number":return t-e;case"boolean":return t<e?-1:1;case"string":return function(t,e){return t===e?0:t>e?1:-1}(t,e)}return Array.isArray(t)?function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=ft(t[r],e[r]);if(0!==i)return i}return t.length===e.length?0:t.length>e.length?1:-1}(t,e):function(t,e){for(var n=Object.keys(t),r=Object.keys(e),i=Math.min(n.length,r.length),o=0;o<i;o++){var a=ft(n[o],r[o]);if(0!==a)return a;if(0!==(a=ft(t[n[o]],e[r[o]])))return a}return n.length===r.length?0:n.length>r.length?1:-1}(t,e)}function dt(t){switch(typeof t){case"undefined":return null;case"number":return t===1/0||t===-1/0||isNaN(t)?null:t;case"object":var e=t;if(Array.isArray(t)){var n=t.length;t=new Array(n);for(var r=0;r<n;r++)t[r]=dt(e[r])}else{if(t instanceof Date)return t.toJSON();if(null!==t)for(var i in t={},e)if(e.hasOwnProperty(i)){var o=e[i];void 0!==o&&(t[i]=dt(o))}}}return t}function pt(t){return vt(t=dt(t))+Hn+function(t){if(null!==t)switch(typeof t){case"boolean":return t?1:0;case"number":return function(t){if(0===t)return"1";var e=t.toExponential().split(/e\+?/),n=parseInt(e[1],10),r=t<0,i=r?"0":"2",o=function(t,e,n){return function(t,e,n){for(var r="",i=Bn-t.length;r.length<i;)r+="0";return r}(t)+t}(((r?-n:n)-Vn).toString());i+=Hn+o;var a=Math.abs(parseFloat(e[0]));r&&(a=10-a);var s=a.toFixed(20);return s=s.replace(/\.?0+$/,""),i+(Hn+s)}(t);case"string":return t.replace(/\u0002/g,"\x02\x02").replace(/\u0001/g,"\x01\x02").replace(/\u0000/g,"\x01\x01");case"object":var e=Array.isArray(t),n=e?t:Object.keys(t),r=-1,i=n.length,o="";if(e)for(;++r<i;)o+=pt(n[r]);else for(;++r<i;){var a=n[r];o+=pt(a)+pt(t[a])}return o}return""}(t)+"\0"}function mt(t,e){var n,r=e;if("1"===t[e])n=0,e++;else{var i="0"===t[e],o="",a=t.substring(++e,e+Bn),s=parseInt(a,10)+Vn;for(i&&(s=-s),e+=Bn;;){var u=t[e];if("\0"===u)break;o+=u,e++}n=1===(o=o.split(".")).length?parseInt(o,10):parseFloat(o[0]+"."+o[1]),i&&(n-=10),0!==s&&(n=parseFloat(n+"e"+s))}return{num:n,length:e-r}}function gt(t,e){var n=t.pop();if(e.length){var r=e[e.length-1];n===r.element&&(e.pop(),r=e[e.length-1]);var i=r.element,o=r.index;Array.isArray(i)?i.push(n):o===t.length-2?i[t.pop()]=n:t.push(n)}}function vt(t){var e=["boolean","number","string","object"].indexOf(typeof t);return~e?null===t?1:Array.isArray(t)?5:e<3?e+2:e+3:Array.isArray(t)?5:void 0}function yt(t,e,n){return n.every(function(n){var r=e[n],i=ut(n),o=st(t,i);return ct(n)?function(t,e,n){return"$or"===t?e.some(function(t){return yt(n,t,Object.keys(t))}):"$not"===t?!yt(n,e,Object.keys(e)):!e.find(function(t){return yt(n,t,Object.keys(t))})}(n,r,t):wt(r,t,i,o)})}function wt(t,e,n,r){return!t||Object.keys(t).every(function(i){return function(t,e,n,r,i){if(!qn[t])throw new Error('unknown operator "'+t+'" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all');return qn[t](e,n,r,i)}(i,e,t[i],n,r)})}function bt(t){return void 0!==t&&null!==t}function xt(t){return void 0!==t}function _t(t,e){return e.some(function(e){return t instanceof Array?t.indexOf(e)>-1:t===e})}function Mt(t,e){if(t.selector&&t.filter&&"_selector"!==t.filter)return e(new Error('selector invalid for filter "'+("string"==typeof t.filter?t.filter:"function")+'"'));e()}function Et(t){t.view&&!t.filter&&(t.filter="_view"),t.selector&&!t.filter&&(t.filter="_selector"),t.filter&&"string"==typeof t.filter&&("_view"===t.filter?t.view=R(t.view):t.filter=R(t.filter))}function St(t,e){return e.filter&&"string"==typeof e.filter&&!e.doc_ids&&!k(t.db)}function Tt(t,e){var n=e.complete;if("_view"===e.filter){if(!e.view||"string"!=typeof e.view){var r=M(kn,"`view` filter parameter not found or invalid.");return n(r)}var o=C(e.view);t.db.get("_design/"+o[0],function(r,i){if(t.isCancelled)return n(null,{status:"cancelled"});if(r)return n(E(r));var a=i&&i.views&&i.views[o[1]]&&i.views[o[1]].map;if(!a)return n(M(wn,i.views?"missing json key: "+o[1]:"missing json key: views"));e.filter=L(["return function(doc) {",'  "use strict";',"  var emitted = false;","  var emit = function (a, b) {","    emitted = true;","  };","  var view = "+a+";","  view(doc);","  if (emitted) {","    return true;","  }","};"].join("\n"),{}),t.doChanges(e)})}else if(e.selector)e.filter=function(t){return function(t,e){if("object"!=typeof e)throw new Error("Selector error: expected a JSON object");e=function(t){var e=i(t),n=!1;"$and"in e&&(e=ht(e.$and),n=!0),["$or","$nor"].forEach(function(t){t in e&&e[t].forEach(function(t){for(var e=Object.keys(t),n=0;n<e.length;n++){var r=e[n],i=t[r];"object"==typeof i&&null!==i||(t[r]={$eq:i})}})}),"$not"in e&&(e.$not=ht([e.$not]));for(var r=Object.keys(e),o=0;o<r.length;o++){var a=r[o],s=e[a];"object"!=typeof s||null===s?s={$eq:s}:"$ne"in s&&!n&&(s.$ne=[s.$ne]),e[a]=s}return e}(e);var n=function(t,e,n){if(t=t.filter(function(t){return yt(t.doc,e.selector,n)}),e.sort){var r=function(t){function e(e){return t.map(function(t){var n=ut(lt(t));return st(e,n)})}return function(t,n){var r=ft(e(t.doc),e(n.doc));return 0!==r?r:function(t,e){return t<e?-1:t>e?1:0}(t.doc._id,n.doc._id)}}(e.sort);t=t.sort(r),"string"!=typeof e.sort[0]&&"desc"===function(t){return t[lt(t)]}(e.sort[0])&&(t=t.reverse())}if("limit"in e||"skip"in e){var i=e.skip||0;t=t.slice(i,("limit"in e?e.limit:t.length)+i)}return t}([{doc:t}],{selector:e},Object.keys(e));return n&&1===n.length}(t,e.selector)},t.doChanges(e);else{var a=C(e.filter);t.db.get("_design/"+a[0],function(r,i){if(t.isCancelled)return n(null,{status:"cancelled"});if(r)return n(E(r));var o=i&&i.filters&&i.filters[a[1]];if(!o)return n(M(wn,i&&i.filters?"missing json key: "+a[1]:"missing json key: filters"));e.filter=L('"use strict";\nreturn '+o+";",{}),t.doChanges(e)})}}function At(t){return t.reduce(function(t,e){return t[e]=!0,t},{})}function kt(t){if(!/^\d+-./.test(t))return M(Ln);var e=t.indexOf("-"),n=t.substring(0,e),r=t.substring(e+1);return{prefix:parseInt(n,10),id:r}}function Ct(t,e){var n,r,i,o={status:"available"};if(t._deleted&&(o.deleted=!0),e)if(t._id||(t._id=jn()),r=P(),t._rev){if((i=kt(t._rev)).error)return i;t._rev_tree=[{pos:i.prefix,ids:[i.id,{status:"missing"},[[r,o,[]]]]}],n=i.prefix+1}else t._rev_tree=[{pos:1,ids:[r,o,[]]}],n=1;else if(t._revisions&&(t._rev_tree=function(t,e){for(var n=t.start-t.ids.length+1,r=t.ids,i=[r[0],e,[]],o=1,a=r.length;o<a;o++)i=[r[o],{status:"missing"},[i]];return[{pos:n,ids:i}]}(t._revisions,o),n=t._revisions.start,r=t._revisions.ids[0]),!t._rev_tree){if((i=kt(t._rev)).error)return i;t._rev_tree=[{pos:n=i.prefix,ids:[r=i.id,o,[]]}]}A(t._id),t._rev=n+"-"+r;var a={metadata:{},data:{}};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){var u="_"===s[0];if(u&&!Wn[s]){var c=M(An,s);throw c.message=An.message+": "+s,c}u&&!Yn[s]?a.metadata[s.slice(1)]=t[s]:a.data[s]=t[s]}return a}function Rt(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(i){if("TypeError"!==i.name)throw i;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<t.length;r+=1)n.append(t[r]);return n.getBlob(e.type)}}function Dt(t,e){return Rt([function(t){for(var e=t.length,n=new ArrayBuffer(e),r=new Uint8Array(n),i=0;i<e;i++)r[i]=t.charCodeAt(i);return n}(t)],{type:e})}function Lt(t,e){return Dt(Xn(t),e)}function Ot(t){for(var e="",n=new Uint8Array(t),r=n.byteLength,i=0;i<r;i++)e+=String.fromCharCode(n[i]);return e}function Pt(t,e){if("undefined"==typeof FileReader)return e(Ot((new FileReaderSync).readAsArrayBuffer(t)));var n=new FileReader,r="function"==typeof n.readAsBinaryString;n.onloadend=function(t){var n=t.target.result||"";if(r)return e(n);e(Ot(n))},r?n.readAsBinaryString(t):n.readAsArrayBuffer(t)}function It(t,e){Pt(t,function(t){e(t)})}function Nt(t,e){It(t,function(t){e($n(t))})}function Ft(t,e){if("undefined"==typeof FileReader)return e((new FileReaderSync).readAsArrayBuffer(t));var n=new FileReader;n.onloadend=function(t){var n=t.target.result||new ArrayBuffer(0);e(n)},n.readAsArrayBuffer(t)}function jt(t,e,n,r,i){(n>0||r<e.size)&&(e=function(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.slice(e,n)}(e,n,r)),Ft(e,function(e){t.append(e),i()})}function zt(t,e,n,r,i){(n>0||r<e.length)&&(e=e.substring(n,r)),t.appendBinary(e),i()}function Ut(t,e){function n(){Qn(i)}function r(){var t=function(t){return $n(t)}(l.end(!0));e(t),l.destroy()}function i(){var e=c*s;h(l,t,e,e+s,++c<u?n:r)}var o="string"==typeof t,a=o?t.length:t.size,s=Math.min(Jn,a),u=Math.ceil(a/s),c=0,l=o?new ln:new ln.ArrayBuffer,h=o?zt:jt;i()}function Vt(t,e,n){if(t.stub)return n();"string"==typeof t.data?function(t,e,n){var r=function(t){try{return Xn(t)}catch(t){return{error:M(Sn,"Attachment is not a valid base64 string")}}}(t.data);if(r.error)return n(r.error);t.length=r.length,t.data="blob"===e?Dt(r,t.content_type):"base64"===e?$n(r):r,Ut(r,function(e){t.digest="md5-"+e,n()})}(t,e,n):function(t,e,n){Ut(t.data,function(r){t.digest="md5-"+r,t.length=t.data.size||t.data.length||0,"binary"===e?It(t.data,function(e){t.data=e,n()}):"base64"===e?Nt(t.data,function(e){t.data=e,n()}):n()})}(t,e,n)}function Bt(t,e,n){function r(){t.length===++o&&(i?n(i):n())}if(!t.length)return n();var i,o=0;t.forEach(function(t){function n(t){i=t,++a===o.length&&r()}var o=t.data&&t.data._attachments?Object.keys(t.data._attachments):[],a=0;if(!o.length)return r();for(var s in t.data._attachments)t.data._attachments.hasOwnProperty(s)&&Vt(t.data._attachments[s],e,n)})}function Ht(t,e,n,r,i,o,a,s,u){function c(t,e,n){var r=I(t.metadata),i=Q(t.metadata,r);if("was_delete"in s&&i)return o[e]=M(wn,"deleted"),n();if(h&&function(t){return"missing"===t.metadata.rev_tree[0].ids[1].status}(t)){var u=M(bn);return o[e]=u,n()}a(t,r,i,i,!1,i?0:1,e,n)}function l(){++d===p&&u&&u()}t=t||1e3;var h=s.new_edits,f=new en,d=0,p=e.length;e.forEach(function(t,e){if(t._id&&J(t._id))n[t._deleted?"_removeLocal":"_putLocal"](t,{ctx:i},function(t,n){o[e]=t||n,l()});else{var r=t.metadata.id;f.has(r)?(p--,f.get(r).push([t,e])):f.set(r,[[t,e]])}}),f.forEach(function(e,n){function i(){++u<e.length?s():l()}function s(){var s=e[u],l=s[0],f=s[1];if(r.has(n))!function(t,e,n,r,i,o,a,s){if(function(t,e){for(var n,r=t.slice(),i=e.split("-"),o=parseInt(i[0],10),a=i[1];n=r.pop();){if(n.pos===o&&n.ids[0]===a)return!0;for(var s=n.ids[2],u=0,c=s.length;u<c;u++)r.push({pos:n.pos+1,ids:s[u]})}return!1}(e.rev_tree,n.metadata.rev))return r[i]=n,o();var u=e.winningRev||I(e),c="deleted"in e?e.deleted:Q(e,u),l="deleted"in n.metadata?n.metadata.deleted:Q(n.metadata),h=/^1-/.test(n.metadata.rev);if(c&&!l&&s&&h){var f=n.data;f._rev=u,f._id=n.metadata.id,n=Ct(f,s)}var d=X(e.rev_tree,n.metadata.rev_tree[0],t);if(s&&(c&&l&&"new_leaf"!==d.conflicts||!c&&"new_leaf"!==d.conflicts||c&&!l&&"new_branch"===d.conflicts)){var p=M(bn);return r[i]=p,o()}var m=n.metadata.rev;n.metadata.rev_tree=d.tree,n.stemmedRevs=d.stemmedRevs||[],e.rev_map&&(n.metadata.rev_map=e.rev_map);var g=I(n.metadata),v=Q(n.metadata,g),y=c===v?0:c<v?-1:1;a(n,g,v,m===g?v:Q(n.metadata,m),!0,y,i,o)}(t,r.get(n),l,o,f,i,a,h);else{var d=X([],l.metadata.rev_tree[0],t);l.metadata.rev_tree=d.tree,l.stemmedRevs=d.stemmedRevs||[],c(l,f,i)}}var u=0;s()})}function qt(t){try{return JSON.parse(t)}catch(e){return hn.parse(t)}}function Gt(t){try{return JSON.stringify(t)}catch(e){return hn.stringify(t)}}function Wt(t){return function(e){var n="unknown_error";e.target&&e.target.error&&(n=e.target.error.name||e.target.error.message),t(M(Rn,n))}}function Yt(t,e,n){return{data:Gt(t),winningRev:e,deletedOrLocal:n?"1":"0",seq:t.seq,id:t.id}}function Xt(t){if(!t)return null;var e=qt(t.data);return e.winningRev=t.winningRev,e.deleted="1"===t.deletedOrLocal,e.seq=t.seq,e}function $t(t){if(!t)return t;var e=t._doc_id_rev.lastIndexOf(":");return t._id=t._doc_id_rev.substring(0,e-1),t._rev=t._doc_id_rev.substring(e+1),delete t._doc_id_rev,t}function Qt(t,e,n,r){n?r(t?"string"!=typeof t?t:Lt(t,e):Rt([""],{type:e})):t?"string"!=typeof t?Pt(t,function(t){r($n(t))}):r(t):r("")}function Jt(t,e,n,r){function i(){++s===a.length&&r&&r()}function o(t,e){var r=t._attachments[e],o=r.digest;n.objectStore(er).get(o).onsuccess=function(t){r.body=t.target.result.body,i()}}var a=Object.keys(t._attachments||{});if(!a.length)return r&&r();var s=0;a.forEach(function(n){e.attachments&&e.include_docs?o(t,n):(t._attachments[n].stub=!0,i())})}function Zt(t,e){return fn.all(t.map(function(t){if(t.doc&&t.doc._attachments){var n=Object.keys(t.doc._attachments);return fn.all(n.map(function(n){var r=t.doc._attachments[n];if("body"in r){var i=r.body,o=r.content_type;return new fn(function(a){Qt(i,o,e,function(e){t.doc._attachments[n]=vn(f(r,["digest","content_type"]),{data:e}),a()})})}}))}}))}function Kt(t,e,n){function r(){--u||i.length&&i.forEach(function(t){s.index("digestSeq").count(IDBKeyRange.bound(t+"::",t+"::\uffff",!1,!1)).onsuccess=function(e){e.target.result||a.delete(t)}})}var i=[],o=n.objectStore(tr),a=n.objectStore(er),s=n.objectStore(nr),u=t.length;t.forEach(function(t){o.index("_doc_id_rev").getKey(e+"::"+t).onsuccess=function(t){var e=t.target.result;if("number"!=typeof e)return r();o.delete(e),s.index("seq").openCursor(IDBKeyRange.only(e)).onsuccess=function(t){var e=t.target.result;if(e){var n=e.value.digestSeq.split("::")[0];i.push(n),s.delete(e.primaryKey),e.continue()}else r()}}})}function te(t,e,n){try{return{txn:t.transaction(e,n)}}catch(t){return{error:t}}}function ee(t,e,n,r,i){function o(t){c=t.target.result,u&&i(u,c,l)}function a(t){u=t.target.result,c&&i(u,c,l)}function s(t){var e=t.target.result;if(!e)return i();i([e.key],[e.value],e)}var u,c,l;"function"==typeof t.getAll&&"function"==typeof t.getAllKeys&&r>1&&!n?(l={continue:function(){if(!u.length)return i();var n,s=u[u.length-1];if(e&&e.upper)try{n=IDBKeyRange.bound(s,e.upper,!0,e.upperOpen)}catch(t){if("DataError"===t.name&&0===t.code)return i()}else n=IDBKeyRange.lowerBound(s,!0);u=null,c=null,t.getAll(e=n,r).onsuccess=o,t.getAllKeys(e,r).onsuccess=a}},t.getAll(e,r).onsuccess=o,t.getAllKeys(e,r).onsuccess=a):n?t.openCursor(e,"prev").onsuccess=s:t.openCursor(e).onsuccess=s}function ne(){!sr&&ur.length&&(sr=!0,ur.shift()())}function re(t,e,n,r){function o(t,e,n,r){return n.seq!==e?r():n.winningRev===t._rev?r(n,t):void(g.get(t._id+"::"+n.winningRev).onsuccess=function(t){r(n,$t(t.target.result))})}function a(t,e,n){if(c&&!c.has(t._id))return n();var r=b.get(t._id);if(r)return o(t,e,r,n);m.get(t._id).onsuccess=function(i){r=Xt(i.target.result),b.set(t._id,r),o(t,e,r,n)}}function s(){t.complete(null,{results:v,last_seq:h})}if((t=i(t)).continuous){var u=n+":"+jn();return ar.addListener(n,u,e,t),ar.notify(n),{cancel:function(){ar.removeListener(n,u)}}}var c=t.doc_ids&&new tn(t.doc_ids);t.since=t.since||0;var l,h=t.since,f="limit"in t?t.limit:-1;0===f&&(f=1),l="return_docs"in t?t.return_docs:!("returnDocs"in t)||t.returnDocs;var d,p,m,g,v=[],y=0,w=S(t),b=new en,x=[Kn,tr];t.attachments&&x.push(er);var _=te(r,x,"readonly");if(_.error)return t.complete(_.error);(d=_.txn).onabort=Wt(t.complete),d.oncomplete=function(){!t.continuous&&t.attachments?Zt(v).then(s):s()},p=d.objectStore(tr),m=d.objectStore(Kn),g=p.index("_doc_id_rev"),ee(p,t.since&&!t.descending?IDBKeyRange.lowerBound(t.since,!0):null,t.descending,f,function(e,n,r){function i(e,n){var r=t.processChange(n,e,t);h=r.seq=e.seq;var i=w(r);if("object"==typeof i)return t.complete(i);i&&(y++,l&&v.push(r),t.attachments&&t.include_docs?Jt(n,t,d,function(){Zt([r],t.binary).then(function(){t.onChange(r)})}):t.onChange(r))}function o(){for(var t=0,e=s.length;t<e&&y!==f;t++){var n=s[t];n&&i(u[t],n)}y!==f&&r.continue()}if(r&&e.length){var s=new Array(e.length),u=new Array(e.length),c=0;n.forEach(function(t,n){a($t(t),e[n],function(t,r){u[n]=t,s[n]=r,++c===e.length&&o()})})}})}function ie(t,e){var n=this;!function(t,e,n){ur.push(function(){t(function(t,r){(function(t,e,n,r){try{t(e,n)}catch(e){r.emit("error",e)}})(e,t,r,n),sr=!1,un(function(){ne()})})}),ne()}(function(e){!function(t,e,n){function r(t,e){var n=t.objectStore(Kn);n.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),n.openCursor().onsuccess=function(t){var r=t.target.result;if(r){var i=r.value,o=Q(i);i.deletedOrLocal=o?"1":"0",n.put(i),r.continue()}else e()}}function i(t,e){var n=t.objectStore(ir),r=t.objectStore(Kn),i=t.objectStore(tr);r.openCursor().onsuccess=function(t){var o=t.target.result;if(o){var a=o.value,s=a.id,u=J(s),c=I(a);if(u){var l=s+"::"+c,h=s+"::",f=s+"::~",d=i.index("_doc_id_rev"),p=IDBKeyRange.bound(h,f,!1,!1),m=d.openCursor(p);m.onsuccess=function(t){if(m=t.target.result){var e=m.value;e._doc_id_rev===l&&n.put(e),i.delete(m.primaryKey),m.continue()}else r.delete(o.primaryKey),o.continue()}}else o.continue()}else e&&e()}}function o(t,e){var n=t.objectStore(tr),r=t.objectStore(er),i=t.objectStore(nr);r.count().onsuccess=function(t){if(!t.target.result)return e();n.openCursor().onsuccess=function(t){var n=t.target.result;if(!n)return e();for(var r=n.value,o=n.primaryKey,a=Object.keys(r._attachments||{}),s={},u=0;u<a.length;u++)s[r._attachments[a[u]].digest]=!0;var c=Object.keys(s);for(u=0;u<c.length;u++)i.put({seq:o,digestSeq:c[u]+"::"+o});n.continue()}}}function s(t){var e=t.objectStore(tr),n=t.objectStore(Kn);n.openCursor().onsuccess=function(t){function r(){var t=Yt(o,o.winningRev,o.deleted);n.put(t).onsuccess=function(){i.continue()}}var i=t.target.result;if(i){var o=function(t){return t.data?Xt(t):(t.deleted="1"===t.deletedOrLocal,t)}(i.value);if(o.winningRev=o.winningRev||I(o),o.seq)return r();!function(){var t=o.id+"::",n=o.id+"::\uffff",i=0;e.index("_doc_id_rev").openCursor(IDBKeyRange.bound(t,n)).onsuccess=function(t){var e=t.target.result;if(!e)return o.seq=i,r();var n=e.primaryKey;n>i&&(i=n),e.continue()}}()}}}var u=e.name,c=null;t._meta=null,t._remote=!1,t.type=function(){return"idb"},t._id=a(function(e){e(null,t._meta.instanceId)}),t._bulkDocs=function(n,r,i){!function(t,e,n,r,i,o){function a(){S=!0,u()}function s(){Ht(t.revs_limit,b,r,k,f,A,l,n,a)}function u(){w&&S&&(w.docCount+=T,v.put(w))}function c(){C||(ar.notify(r._meta.name),o(null,A))}function l(t,e,n,r,i,o,a,s){t.metadata.winningRev=e,t.metadata.deleted=n;var c=t.data;if(c._id=t.metadata.id,c._rev=t.metadata.rev,r&&(c._deleted=!0),c._attachments&&Object.keys(c._attachments).length)return function(t,e,n,r,i,o){function a(){u===c.length&&h(t,e,n,r,i,o)}function s(){u++,a()}var u=0,c=Object.keys(t.data._attachments);c.forEach(function(n){var r=t.data._attachments[n];if(r.stub)u++,a();else{var i=r.data;delete r.data,r.revpos=parseInt(e,10),function(t,e,n){m.count(t).onsuccess=function(r){if(r.target.result)return n();m.put({digest:t,body:e}).onsuccess=n}}(r.digest,i,s)}})}(t,e,n,i,a,s);T+=o,u(),h(t,e,n,i,a,s)}function h(t,e,n,i,o,a){function s(o){var a=t.stemmedRevs||[];i&&r.auto_compaction&&(a=a.concat(U(t.metadata))),a&&a.length&&Kt(a,t.metadata.id,f),l.seq=o.target.result;var s=Yt(l,e,n);d.put(s).onsuccess=u}function u(){A[o]={ok:!0,id:l.id,rev:l.rev},k.set(t.metadata.id,t.metadata),function(t,e,n){function r(){++i===o.length&&n()}var i=0,o=Object.keys(t.data._attachments||{});if(!o.length)return n();for(var a=0;a<o.length;a++)!function(n){var i=g.put({seq:e,digestSeq:t.data._attachments[n].digest+"::"+e});i.onsuccess=r,i.onerror=function(t){t.preventDefault(),t.stopPropagation(),r()}}(o[a])}(t,l.seq,a)}var c=t.data,l=t.metadata;c._doc_id_rev=l.id+"::"+l.rev,delete c._id,delete c._rev;var h=p.put(c);h.onsuccess=s,h.onerror=function(t){t.preventDefault(),t.stopPropagation(),p.index("_doc_id_rev").getKey(c._doc_id_rev).onsuccess=function(t){p.put(c,t.target.result).onsuccess=s}}}for(var f,d,p,m,g,v,y,w,b=e.docs,x=0,_=b.length;x<_;x++){var E=b[x];E._id&&J(E._id)||(E=b[x]=Ct(E,n.new_edits)).error&&!y&&(y=E)}if(y)return o(y);var S=!1,T=0,A=new Array(b.length),k=new en,C=!1;Bt(b,r._meta.blobSupport?"blob":"base64",function(t){if(t)return o(t);!function(){var t=te(i,[Kn,tr,er,ir,nr,rr],"readwrite");if(t.error)return o(t.error);(f=t.txn).onabort=Wt(o),f.ontimeout=Wt(o),f.oncomplete=c,d=f.objectStore(Kn),p=f.objectStore(tr),m=f.objectStore(er),g=f.objectStore(nr),(v=f.objectStore(rr)).get(rr).onsuccess=function(t){w=t.target.result,u()},function(t){function e(){++i===n.length&&t(r)}var n=[];if(b.forEach(function(t){t.data&&t.data._attachments&&Object.keys(t.data._attachments).forEach(function(e){var r=t.data._attachments[e];r.stub&&n.push(r.digest)})}),!n.length)return t();var r,i=0;n.forEach(function(t){!function(t,e){m.get(t).onsuccess=function(n){if(n.target.result)e();else{var r=M(On,"unknown stub attachment with digest "+t);r.status=412,e(r)}}}(t,function(t){t&&!r&&(r=t),e()})})}(function(t){if(t)return C=!0,o(t);!function(){function t(){++n===b.length&&s()}function e(e){var n=Xt(e.target.result);n&&k.set(n.id,n),t()}if(b.length)for(var n=0,r=0,i=b.length;r<i;r++){var o=b[r];o._id&&J(o._id)?t():d.get(o.metadata.id).onsuccess=e}}()})}()})}(e,n,r,t,c,i)},t._get=function(t,e,n){function r(){n(a,{doc:i,metadata:o,ctx:s})}var i,o,a,s=e.ctx;if(!s){var u=te(c,[Kn,tr,er],"readonly");if(u.error)return n(u.error);s=u.txn}s.objectStore(Kn).get(t).onsuccess=function(t){if(!(o=Xt(t.target.result)))return a=M(wn,"missing"),r();var n;if(e.rev)n=e.latest?Z(e.rev,o):e.rev;else if(n=o.winningRev,Q(o))return a=M(wn,"deleted"),r();var u=s.objectStore(tr),c=o.id+"::"+n;u.index("_doc_id_rev").get(c).onsuccess=function(t){if((i=t.target.result)&&(i=$t(i)),!i)return a=M(wn,"missing"),r();r()}}},t._getAttachment=function(t,e,n,r,i){var o;if(r.ctx)o=r.ctx;else{var a=te(c,[Kn,tr,er],"readonly");if(a.error)return i(a.error);o=a.txn}var s=n.digest,u=n.content_type;o.objectStore(er).get(s).onsuccess=function(t){Qt(t.target.result.body,u,r.binary,function(t){i(null,t)})}},t._info=function(e){var n,r,i=te(c,[rr,tr],"readonly");if(i.error)return e(i.error);var o=i.txn;o.objectStore(rr).get(rr).onsuccess=function(t){r=t.target.result.docCount},o.objectStore(tr).openCursor(null,"prev").onsuccess=function(t){var e=t.target.result;n=e?e.key:0},o.oncomplete=function(){e(null,{doc_count:r,update_seq:n,idb_attachment_format:t._meta.blobSupport?"binary":"base64"})}},t._allDocs=function(t,e){!function(t,e,n){function r(e,n,r){y.get(e.id+"::"+r).onsuccess=function(r){if(n.doc=$t(r.target.result),t.conflicts){var i=z(e);i.length&&(n.doc._conflicts=i)}Jt(n.doc,t,d)}}function i(e,n){var i={id:n.id,key:n.id,value:{rev:e}},o=n.deleted;"ok"===t.deleted?(w.push(i),o?(i.value.deleted=!0,i.doc=null):t.include_docs&&r(n,i,e)):!o&&s--<=0&&(w.push(i),t.include_docs&&r(n,i,e))}function o(t){for(var e=0,n=t.length;e<n&&w.length!==u;e++){var r=Xt(t[e]);i(r.winningRev,r)}}function a(){n(null,{total_rows:p,offset:t.skip,rows:w})}var s=t.skip||0,u="number"==typeof t.limit?t.limit:-1,c=function(t,e,n,r,i){try{if(t&&e)return i?IDBKeyRange.bound(e,t,!n,!1):IDBKeyRange.bound(t,e,!1,!n);if(t)return i?IDBKeyRange.upperBound(t):IDBKeyRange.lowerBound(t);if(e)return i?IDBKeyRange.lowerBound(e,!n):IDBKeyRange.upperBound(e,!n);if(r)return IDBKeyRange.only(r)}catch(t){return{error:t}}return null}("startkey"in t&&t.startkey,"endkey"in t&&t.endkey,!1!==t.inclusive_end,"key"in t&&t.key,t.descending),l=c&&c.error;if(l&&("DataError"!==l.name||0!==l.code))return n(M(Rn,l.name));var h=[Kn,tr,rr];t.attachments&&h.push(er);var f=te(e,h,"readonly");if(f.error)return n(f.error);var d=f.txn;d.oncomplete=function(){t.attachments?Zt(w,t.binary).then(a):a()},d.onabort=Wt(n);var p,m=d.objectStore(Kn),g=d.objectStore(tr),v=d.objectStore(rr),y=g.index("_doc_id_rev"),w=[];v.get(rr).onsuccess=function(t){p=t.target.result.docCount},l||0===u||(-1===u?function(t,e,n){if("function"!=typeof t.getAll){var r=[];t.openCursor(e).onsuccess=function(t){var e=t.target.result;e?(r.push(e.value),e.continue()):n({target:{result:r}})}}else t.getAll(e).onsuccess=n}(m,c,function(e){var n=e.target.result;t.descending&&(n=n.reverse()),o(n)}):ee(m,c,t.descending,u+s,function(t,e,n){n&&(o(e),w.length<u&&n.continue())}))}(t,c,e)},t._changes=function(e){return re(e,t,u,c)},t._close=function(t){c.close(),cr.delete(u),t()},t._getRevisionTree=function(t,e){var n=te(c,[Kn],"readonly");if(n.error)return e(n.error);n.txn.objectStore(Kn).get(t).onsuccess=function(t){var n=Xt(t.target.result);n?e(null,n.rev_tree):e(M(wn))}},t._doCompaction=function(t,e,n){var r=te(c,[Kn,tr,er,nr],"readwrite");if(r.error)return n(r.error);var i=r.txn;i.objectStore(Kn).get(t).onsuccess=function(n){var r=Xt(n.target.result);N(r.rev_tree,function(t,n,r,i,o){-1!==e.indexOf(n+"-"+r)&&(o.status="missing")}),Kt(e,t,i);var o=r.winningRev,a=r.deleted;i.objectStore(Kn).put(Yt(r,o,a))},i.onabort=Wt(n),i.oncomplete=function(){n()}},t._getLocal=function(t,e){var n=te(c,[ir],"readonly");if(n.error)return e(n.error);var r=n.txn.objectStore(ir).get(t);r.onerror=Wt(e),r.onsuccess=function(t){var n=t.target.result;n?(delete n._doc_id_rev,e(null,n)):e(M(wn))}},t._putLocal=function(t,e,n){"function"==typeof e&&(n=e,e={}),delete t._revisions;var r=t._rev,i=t._id;t._rev=r?"0-"+(parseInt(r.split("-")[1],10)+1):"0-1";var o,a=e.ctx;if(!a){var s=te(c,[ir],"readwrite");if(s.error)return n(s.error);(a=s.txn).onerror=Wt(n),a.oncomplete=function(){o&&n(null,o)}}var u,l=a.objectStore(ir);r?(u=l.get(i)).onsuccess=function(i){var a=i.target.result;a&&a._rev===r?l.put(t).onsuccess=function(){o={ok:!0,id:t._id,rev:t._rev},e.ctx&&n(null,o)}:n(M(bn))}:((u=l.add(t)).onerror=function(t){n(M(bn)),t.preventDefault(),t.stopPropagation()},u.onsuccess=function(){o={ok:!0,id:t._id,rev:t._rev},e.ctx&&n(null,o)})},t._removeLocal=function(t,e,n){"function"==typeof e&&(n=e,e={});var r=e.ctx;if(!r){var i=te(c,[ir],"readwrite");if(i.error)return n(i.error);(r=i.txn).oncomplete=function(){o&&n(null,o)}}var o,a=t._id,s=r.objectStore(ir),u=s.get(a);u.onerror=Wt(n),u.onsuccess=function(r){var i=r.target.result;i&&i._rev===t._rev?(s.delete(a),o={ok:!0,id:a,rev:"0-0"},e.ctx&&n(null,o)):n(M(wn))}},t._destroy=function(t,e){ar.removeAllListeners(u);var n=lr.get(u);n&&n.result&&(n.result.close(),cr.delete(u));var r=indexedDB.deleteDatabase(u);r.onsuccess=function(){lr.delete(u),v()&&u in localStorage&&delete localStorage[u],e(null,{ok:!0})},r.onerror=Wt(e)};var l,h=cr.get(u);if(h)return c=h.idb,t._meta=h.global,un(function(){n(null,t)});l=e.storage?function(t,e){try{return indexedDB.open(t,{version:Zn,storage:e})}catch(e){return indexedDB.open(t,Zn)}}(u,e.storage):indexedDB.open(u,Zn),lr.set(u,l),l.onupgradeneeded=function(t){var e=t.target.result;if(t.oldVersion<1)return function(t){var e=t.createObjectStore(Kn,{keyPath:"id"});t.createObjectStore(tr,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),t.createObjectStore(er,{keyPath:"digest"}),t.createObjectStore(rr,{keyPath:"id",autoIncrement:!1}),t.createObjectStore(or),e.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),t.createObjectStore(ir,{keyPath:"_id"});var n=t.createObjectStore(nr,{autoIncrement:!0});n.createIndex("seq","seq"),n.createIndex("digestSeq","digestSeq",{unique:!0})}(e);var n=t.currentTarget.transaction;t.oldVersion<3&&e.createObjectStore(ir,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),t.oldVersion<4&&function(t){var n=e.createObjectStore(nr,{autoIncrement:!0});n.createIndex("seq","seq"),n.createIndex("digestSeq","digestSeq",{unique:!0})}();var a=[r,i,o,s],u=t.oldVersion;!function t(){var e=a[u-1];u++,e&&e(n,t)}()},l.onsuccess=function(e){function r(){void 0!==s&&f&&(t._meta={name:u,instanceId:l,blobSupport:s},cr.set(u,{idb:c,global:t._meta}),n(null,t))}function i(){if(void 0!==a&&void 0!==o){var t=u+"_id";t in o?l=o[t]:o[t]=l=jn(),o.docCount=a,h.objectStore(rr).put(o)}}(c=e.target.result).onversionchange=function(){c.close(),cr.delete(u)},c.onabort=function(t){w("error","Database has a global failure",t.target.error),c.close(),cr.delete(u)};var o,a,s,l,h=c.transaction([rr,or,Kn],"readwrite"),f=!1;h.objectStore(rr).get(rr).onsuccess=function(t){o=t.target.result||{id:rr},i()},h.objectStore(Kn).index("deletedOrLocal").count(IDBKeyRange.only("0")).onsuccess=function(t){!function(t){a=t,i()}(t.target.result)},Gn||(Gn=function(t){return new fn(function(e){var n=Rt([""]);t.objectStore(or).put(n,"key").onsuccess=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);e(n||!t||parseInt(t[1],10)>=43)},t.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)}}).catch(function(){return!1})}(h)),Gn.then(function(t){s=t,r()}),h.oncomplete=function(){f=!0,r()}},l.onerror=function(){var t="Failed to open indexedDB, are you in private browsing mode?";w("error",t),n(M(Rn,t))}}(n,t,e)},e,n.constructor)}function oe(t){return t<65?t-48:t-55}function ae(t,e){return"UTF-8"===e?function(t){return decodeURIComponent(escape(t))}(function(t,e,n){for(var r="";e<n;)r+=String.fromCharCode(oe(t.charCodeAt(e++))<<4|oe(t.charCodeAt(e++)));return r}(t,0,t.length)):function(t,e,n){for(var r="";e<n;)r+=String.fromCharCode(oe(t.charCodeAt(e+2))<<12|oe(t.charCodeAt(e+3))<<8|oe(t.charCodeAt(e))<<4|oe(t.charCodeAt(e+1))),e+=4;return r}(t,0,t.length)}function se(t){return"'"+t+"'"}function ue(t){return delete t._id,delete t._rev,JSON.stringify(t)}function ce(t,e,n){return(t=JSON.parse(t))._id=e,t._rev=n,t}function le(t){for(var e="(";t--;)e+="?",t&&(e+=",");return e+")"}function he(t,e,n,r,i){return"SELECT "+t+" FROM "+("string"==typeof e?e:e.join(" JOIN "))+(n?" ON "+n:"")+(r?" WHERE "+("string"==typeof r?r:r.join(" AND ")):"")+(i?" ORDER BY "+i:"")}function fe(t,e,n){function r(){++i===t.length&&function(){if(o.length){var t="SELECT DISTINCT digest AS digest FROM "+vr+" WHERE seq IN "+le(o.length);n.executeSql(t,o,function(t,e){for(var n=[],r=0;r<e.rows.length;r++)n.push(e.rows.item(r).digest);if(n.length){var i="DELETE FROM "+vr+" WHERE seq IN ("+o.map(function(){return"?"}).join(",")+")";t.executeSql(i,o,function(t){var e="SELECT digest FROM "+vr+" WHERE digest IN ("+n.map(function(){return"?"}).join(",")+")";t.executeSql(e,n,function(t,e){for(var r=new tn,i=0;i<e.rows.length;i++)r.add(e.rows.item(i).digest);n.forEach(function(e){r.has(e)||(t.executeSql("DELETE FROM "+vr+" WHERE digest=?",[e]),t.executeSql("DELETE FROM "+pr+" WHERE digest=?",[e]))})})})}})}}()}if(t.length){var i=0,o=[];t.forEach(function(t){n.executeSql("SELECT seq FROM "+dr+" WHERE doc_id=? AND rev=?",[e,t],function(t,e){if(!e.rows.length)return r();var n=e.rows.item(0).seq;o.push(n),t.executeSql("DELETE FROM "+dr+" WHERE seq=?",[n],r)})})}}function de(t){return function(e){w("error","WebSQL threw an error",e),e&&e.constructor.toString().match(/function ([^(]+)/),t(M(Dn,e.target||e.message))}}function pe(t,e,n,r,i){function o(){++u===s.length&&i&&i()}function a(t,i){var a=t._attachments[i];n._getAttachment(t._id,i,a,{binary:e.binary,ctx:r},function(e,n){t._attachments[i]=vn(f(a,["digest","content_type"]),{data:n}),o()})}var s=Object.keys(t._attachments||{});if(!s.length)return i&&i();var u=0;s.forEach(function(n){e.attachments&&e.include_docs?a(t,n):(t._attachments[n].stub=!0,o())})}function me(t,e,n,r){return openDatabase(t,e,n,r)}function ge(t,e){var n=vn({websql:me},t);(function(t,e){function n(t,e){t.executeSql(Mr),t.executeSql("ALTER TABLE "+dr+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){t.executeSql(xr),t.executeSql("ALTER TABLE "+fr+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){t.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+fr+" (local, id)"),t.executeSql("SELECT "+fr+".winningseq AS seq, "+fr+".json AS metadata FROM "+dr+" JOIN "+fr+" ON "+dr+".seq = "+fr+".winningseq",[],function(t,n){for(var r=[],i=[],o=0;o<n.rows.length;o++){var a=n.rows.item(o),s=a.seq,u=JSON.parse(a.metadata);Q(u)&&r.push(s),J(u.id)&&i.push(u.id)}t.executeSql("UPDATE "+fr+"SET local = 1 WHERE id IN "+le(i.length),i,function(){t.executeSql("UPDATE "+dr+" SET deleted = 1 WHERE seq IN "+le(r.length),r,e)})})})})}function r(t,e){t.executeSql("CREATE TABLE IF NOT EXISTS "+mr+" (id UNIQUE, rev, json)",[],function(){t.executeSql("SELECT "+fr+".id AS id, "+dr+".json AS data FROM "+dr+" JOIN "+fr+" ON "+dr+".seq = "+fr+".winningseq WHERE local = 1",[],function(t,n){for(var r=[],i=0;i<n.rows.length;i++)r.push(n.rows.item(i));!function n(){if(!r.length)return e(t);var i=r.shift(),o=JSON.parse(i.data)._rev;t.executeSql("INSERT INTO "+mr+" (id, rev, json) VALUES (?,?,?)",[i.id,o,i.data],function(t){t.executeSql("DELETE FROM "+fr+" WHERE id=?",[i.id],function(t){t.executeSql("DELETE FROM "+dr+" WHERE seq=?",[i.seq],function(){n()})})})}()})})}function o(t,e){function n(n){!function r(){if(!n.length)return e(t);var i=ae(n.shift().hex,d),o=i.lastIndexOf("::"),a=i.substring(0,o),s=i.substring(o+2);t.executeSql("UPDATE "+dr+" SET doc_id=?, rev=? WHERE doc_id_rev=?",[a,s,i],function(){r()})}()}t.executeSql("ALTER TABLE "+dr+" ADD COLUMN doc_id",[],function(t){t.executeSql("ALTER TABLE "+dr+" ADD COLUMN rev",[],function(t){t.executeSql(_r,[],function(t){t.executeSql("SELECT hex(doc_id_rev) as hex FROM "+dr,[],function(t,e){for(var r=[],i=0;i<e.rows.length;i++)r.push(e.rows.item(i));n(r)})})})})}function s(t,e){function n(t){t.executeSql("SELECT COUNT(*) AS cnt FROM "+pr,[],function(t,n){if(!n.rows.item(0).cnt)return e(t);var r=0;!function n(){var i=he(Ar+", "+fr+".id AS id",[fr,dr],Tr,null,fr+".id ");i+=" LIMIT 10 OFFSET "+r,r+=10,t.executeSql(i,[],function(t,r){if(!r.rows.length)return e(t);for(var i={},o=0;o<r.rows.length;o++)for(var a=r.rows.item(o),s=ce(a.data,a.id,a.rev),u=Object.keys(s._attachments||{}),c=0;c<u.length;c++)!function(t,e){var n=i[t]=i[t]||[];-1===n.indexOf(e)&&n.push(e)}(s._attachments[u[c]].digest,a.seq);var l=[];if(Object.keys(i).forEach(function(t){i[t].forEach(function(e){l.push([t,e])})}),!l.length)return n();var h=0;l.forEach(function(e){t.executeSql("INSERT INTO "+vr+" (digest, seq) VALUES (?,?)",e,function(){++h===l.length&&n()})})})}()})}t.executeSql("CREATE TABLE IF NOT EXISTS "+vr+" (digest, seq INTEGER)",[],function(t){t.executeSql(Sr,[],function(t){t.executeSql(Er,[],n)})})}function u(t,e){t.executeSql("ALTER TABLE "+pr+" ADD COLUMN escaped TINYINT(1) DEFAULT 0",[],e)}function c(t,e){t.executeSql("ALTER TABLE "+fr+" ADD COLUMN max_seq INTEGER",[],function(t){t.executeSql("UPDATE "+fr+" SET max_seq=(SELECT MAX(seq) FROM "+dr+" WHERE doc_id=id)",[],function(t){t.executeSql("CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+fr+" (max_seq)",[],e)})})}function l(){for(;y.length>0;)y.pop()(null,m)}function h(t,e){if(0===e){var i="CREATE TABLE IF NOT EXISTS "+gr+" (dbid, db_version INTEGER)",a="CREATE TABLE IF NOT EXISTS "+vr+" (digest, seq INTEGER)",h="CREATE TABLE IF NOT EXISTS "+fr+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",f="CREATE TABLE IF NOT EXISTS "+dr+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",d="CREATE TABLE IF NOT EXISTS "+mr+" (id UNIQUE, rev, json)";t.executeSql("CREATE TABLE IF NOT EXISTS "+pr+" (digest UNIQUE, escaped TINYINT(1), body BLOB)"),t.executeSql(d),t.executeSql(a,[],function(){t.executeSql(Er),t.executeSql(Sr)}),t.executeSql(h,[],function(){t.executeSql(Mr),t.executeSql(f,[],function(){t.executeSql(xr),t.executeSql(_r),t.executeSql(i,[],function(){var e="INSERT INTO "+gr+" (db_version, dbid) VALUES (?,?)";m=jn(),t.executeSql(e,[hr,m],function(){l()})})})})}else{var p=[n,r,o,s,u,c,function(){e<hr&&t.executeSql("UPDATE "+gr+" SET db_version = "+hr),t.executeSql("SELECT dbid FROM "+gr,[],function(t,e){m=e.rows.item(0).dbid,l()})}],g=e,v=function(t){p[g-1](t,v),g++};v(t)}}function f(t,e){var n=he("COUNT("+fr+".id) AS 'num'",[fr,dr],Tr,dr+".deleted=0");t.executeSql(n,[],function(t,n){e(n.rows.item(0).num)})}var d,p=this,m=null,g=function(t){return"size"in t?1e6*t.size:"undefined"!=typeof navigator&&/Android/.test(navigator.userAgent)?5e6:1}(t),y=[];p._name=t.name;var w=function(t){var e=yr.get(t.name);return e||(e=function(t){try{return{db:function(t){return t.websql(t.name,t.version,t.description,t.size)}(t)}}catch(t){return{error:t}}}(t),yr.set(t.name,e)),e}(vn({},t,{version:br,description:t.name,size:g}));if(w.error)return de(e)(w.error);var b=w.db;"function"!=typeof b.readTransaction&&(b.readTransaction=b.transaction),b.transaction(function(t){!function(t,e){t.executeSql('SELECT HEX("a") AS hex',[],function(t,n){var r=n.rows.item(0).hex;d=2===r.length?"UTF-8":"UTF-16",e()})}(t,function(){!function(t){t.executeSql("SELECT sql FROM sqlite_master WHERE tbl_name = "+gr,[],function(t,e){e.rows.length?/db_version/.test(e.rows.item(0).sql)?t.executeSql("SELECT db_version FROM "+gr,[],function(t,e){h(t,e.rows.item(0).db_version)}):t.executeSql("ALTER TABLE "+gr+" ADD COLUMN db_version INTEGER",[],function(){h(t,1)}):h(t,0)})}(t)})},de(e),function(){v()&&(window.localStorage["_pouch__websqldb_"+p._name]=!0),e(null,p)}),p._remote=!1,p.type=function(){return"websql"},p._id=a(function(t){t(null,m)}),p._info=function(t){var e,n;b.readTransaction(function(t){(function(t,e){t.executeSql("SELECT MAX(seq) AS seq FROM "+dr,[],function(t,n){var r=n.rows.item(0).seq||0;e(r)})})(t,function(t){e=t}),f(t,function(t){n=t})},de(t),function(){t(null,{doc_count:n,update_seq:e,websql_encoding:d})})},p._bulkDocs=function(e,n,r){!function(t,e,n,r,i,o,a){function s(){if(p)return a(p);o.notify(r._name),a(null,m)}function u(t,e,n,i,o,a,s,u){function c(){function e(t,e){function r(){return++i===o.length&&e(),!1}var i=0,o=Object.keys(n._attachments||{});if(!o.length)return e();for(var a=0;a<o.length;a++)d.executeSql("INSERT INTO "+vr+" (digest, seq) VALUES (?,?)",[n._attachments[o[a]].digest,t],r,r)}var n=t.data,r=i?1:0,o=n._id,a=n._rev,s=ue(n);d.executeSql("INSERT INTO "+dr+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",[o,a,s,r],function(t,n){var r=n.insertId;e(r,function(){f(t,r)})},function(){var t=he("seq",dr,null,"doc_id=? AND rev=?");return d.executeSql(t,[o,a],function(t,n){var i=n.rows.item(0).seq;t.executeSql("UPDATE "+dr+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",[s,r,o,a],function(t){e(i,function(){f(t,i)})})}),!1})}function l(t){p||(t?u(p=t):v===y.length&&c())}function h(t){v++,l(t)}function f(n,i){var a=t.metadata.id,c=t.stemmedRevs||[];o&&r.auto_compaction&&(c=U(t.metadata).concat(c)),c.length&&fe(c,a,n),t.metadata.seq=i;var l=t.metadata.rev;delete t.metadata.rev;var h=o?"UPDATE "+fr+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+dr+" WHERE doc_id="+fr+".id AND rev=?) WHERE id=?":"INSERT INTO "+fr+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",f=Gt(t.metadata);n.executeSql(h,o?[f,i,e,a]:[a,i,i,f],function(){m[s]={ok:!0,id:t.metadata.id,rev:l},g.set(a,t.metadata),u()})}var p=null,v=0;t.data._id=t.metadata.id,t.data._rev=t.metadata.rev;var y=Object.keys(t.data._attachments||{});i&&(t.data._deleted=!0),y.forEach(function(n){var r=t.data._attachments[n];if(r.stub)v++,l();else{var i=r.data;delete r.data,r.revpos=parseInt(e,10),function(t,e,n){var r="SELECT digest FROM "+pr+" WHERE digest=?";d.executeSql(r,[t],function(i,o){if(o.rows.length)return n();i.executeSql(r="INSERT INTO "+pr+" (digest, body, escaped) VALUES (?,?,1)",[t,e.replace(/\u0002/g,"\x02\x02").replace(/\u0001/g,"\x01\x02").replace(/\u0000/g,"\x01\x01")],function(){n()},function(){return n(),!1})})}(r.digest,i,h)}}),y.length||c()}function c(){Ht(t.revs_limit,h,r,g,d,m,u,n)}var l=n.new_edits,h=e.docs.map(function(t){return t._id&&J(t._id)?t:Ct(t,l)}),f=h.filter(function(t){return t.error});if(f.length)return a(f[0]);var d,p,m=new Array(h.length),g=new en;Bt(h,"binary",function(t){if(t)return a(t);i.transaction(function(t){d=t,function(t){function e(){++i===n.length&&t(r)}var n=[];if(h.forEach(function(t){t.data&&t.data._attachments&&Object.keys(t.data._attachments).forEach(function(e){var r=t.data._attachments[e];r.stub&&n.push(r.digest)})}),!n.length)return t();var r,i=0;n.forEach(function(t){!function(t,e){d.executeSql("SELECT count(*) as cnt FROM "+pr+" WHERE digest=?",[t],function(n,r){if(0===r.rows.item(0).cnt){var i=M(On,"unknown stub attachment with digest "+t);e(i)}else e()})}(t,function(t){t&&!r&&(r=t),e()})})}(function(t){t?p=t:function(t){function e(){++n===h.length&&t()}if(!h.length)return t();var n=0;h.forEach(function(t){if(t._id&&J(t._id))return e();var n=t.metadata.id;d.executeSql("SELECT json FROM "+fr+" WHERE id = ?",[n],function(t,r){if(r.rows.length){var i=qt(r.rows.item(0).json);g.set(n,i)}e()})})}(c)})},de(a),s)})}(t,e,n,p,b,wr,r)},p._get=function(t,e,n){function r(t){n(t,{doc:i,metadata:o,ctx:u})}var i,o,a,s,u=e.ctx;if(!u)return b.readTransaction(function(r){p._get(t,vn({ctx:r},e),n)});if(e.rev){if(e.latest)return void function(t,e,n,r,i){var o=he(Ar,[fr,dr],Tr,fr+".id=?");t.executeSql(o,[e],function(t,e){if(!e.rows.length){var o=M(wn,"missing");return i(o)}var a=qt(e.rows.item(0).metadata);r(Z(n,a))})}(u,t,e.rev,function(r){e.latest=!1,e.rev=r,p._get(t,e,n)},r);a=he(Ar,[fr,dr],fr+".id="+dr+".doc_id",[dr+".doc_id=?",dr+".rev=?"]),s=[t,e.rev]}else a=he(Ar,[fr,dr],Tr,fr+".id=?"),s=[t];u.executeSql(a,s,function(t,n){if(!n.rows.length)return r(M(wn,"missing"));var a=n.rows.item(0);if(o=qt(a.metadata),a.deleted&&!e.rev)return r(M(wn,"deleted"));i=ce(a.data,o.id,a.rev),r()})},p._allDocs=function(t,e){var n,r=[],i="startkey"in t&&t.startkey,o="endkey"in t&&t.endkey,a="key"in t&&t.key,s="descending"in t&&t.descending,u="limit"in t?t.limit:-1,c="skip"in t?t.skip:0,l=!1!==t.inclusive_end,h=[],d=[];if(!1!==a)d.push(fr+".id = ?"),h.push(a);else if(!1!==i||!1!==o){if(!1!==i&&(d.push(fr+".id "+(s?"<=":">=")+" ?"),h.push(i)),!1!==o){var m=s?">":"<";l&&(m+="="),d.push(fr+".id "+m+" ?"),h.push(o)}!1!==a&&(d.push(fr+".id = ?"),h.push(a))}"ok"!==t.deleted&&d.push(dr+".deleted = 0"),b.readTransaction(function(e){if(f(e,function(t){n=t}),0!==u){var i=he(Ar,[fr,dr],Tr,d,fr+".id "+(s?"DESC":"ASC"));e.executeSql(i+=" LIMIT "+u+" OFFSET "+c,h,function(e,n){for(var i=0,o=n.rows.length;i<o;i++){var a=n.rows.item(i),s=qt(a.metadata),u=s.id,c=ce(a.data,u,a.rev),l=c._rev,h={id:u,key:u,value:{rev:l}};if(t.include_docs){if(h.doc=c,h.doc._rev=l,t.conflicts){var f=z(s);f.length&&(h.doc._conflicts=f)}pe(h.doc,t,p,e)}if(a.deleted){if("ok"!==t.deleted)continue;h.value.deleted=!0,h.doc=null}r.push(h)}})}},de(e),function(){e(null,{total_rows:n,offset:t.skip,rows:r})})},p._changes=function(t){if((t=i(t)).continuous){var e=p._name+":"+jn();return wr.addListener(p._name,e,p,t),wr.notify(p._name),{cancel:function(){wr.removeListener(p._name,e)}}}var n=t.descending;t.since=t.since&&!n?t.since:0;var r,o="limit"in t?t.limit:-1;0===o&&(o=1),r="return_docs"in t?t.return_docs:!("returnDocs"in t)||t.returnDocs;var a=[],s=0;!function(){var e=fr+".json AS metadata, "+fr+".max_seq AS maxSeq, "+dr+".json AS winningDoc, "+dr+".rev AS winningRev ",i=fr+" JOIN "+dr,u=fr+".id="+dr+".doc_id AND "+fr+".winningseq="+dr+".seq",c=["maxSeq > ?"],l=[t.since];t.doc_ids&&(c.push(fr+".id IN "+le(t.doc_ids.length)),l=l.concat(t.doc_ids));var h=he(e,i,u,c,"maxSeq "+(n?"DESC":"ASC")),f=S(t);t.view||t.filter||(h+=" LIMIT "+o);var d=t.since||0;b.readTransaction(function(e){e.executeSql(h,l,function(e,n){function i(e){return function(){t.onChange(e)}}for(var u=0,c=n.rows.length;u<c;u++){var l=n.rows.item(u),h=qt(l.metadata);d=l.maxSeq;var m=ce(l.winningDoc,h.id,l.winningRev),g=t.processChange(m,h,t);g.seq=l.maxSeq;var v=f(g);if("object"==typeof v)return t.complete(v);if(v&&(s++,r&&a.push(g),t.attachments&&t.include_docs?pe(m,t,p,e,i(g)):i(g)()),s===o)break}})},de(t.complete),function(){t.continuous||t.complete(null,{results:a,last_seq:d})})}()},p._close=function(t){t()},p._getAttachment=function(t,e,n,r,i){var o,a=n.content_type;r.ctx.executeSql("SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+pr+" WHERE digest=?",[n.digest],function(t,e){var n=e.rows.item(0),s=n.escaped?n.body.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"\x01").replace(/\u0002\u0002/g,"\x02"):ae(n.body,d);o=r.binary?Dt(s,a):$n(s),i(null,o)})},p._getRevisionTree=function(t,e){b.readTransaction(function(n){n.executeSql("SELECT json AS metadata FROM "+fr+" WHERE id = ?",[t],function(t,n){if(n.rows.length){var r=qt(n.rows.item(0).metadata);e(null,r.rev_tree)}else e(M(wn))})})},p._doCompaction=function(t,e,n){if(!e.length)return n();b.transaction(function(n){n.executeSql("SELECT json AS metadata FROM "+fr+" WHERE id = ?",[t],function(n,r){var i=qt(r.rows.item(0).metadata);N(i.rev_tree,function(t,n,r,i,o){-1!==e.indexOf(n+"-"+r)&&(o.status="missing")}),n.executeSql("UPDATE "+fr+" SET json = ? WHERE id = ?",[Gt(i),t])}),fe(e,t,n)},de(n),function(){n()})},p._getLocal=function(t,e){b.readTransaction(function(n){n.executeSql("SELECT json, rev FROM "+mr+" WHERE id=?",[t],function(n,r){if(r.rows.length){var i=r.rows.item(0),o=ce(i.json,t,i.rev);e(null,o)}else e(M(wn))})})},p._putLocal=function(t,e,n){function r(t){var r,c;o?(r="UPDATE "+mr+" SET rev=?, json=? WHERE id=? AND rev=?",c=[i,u,a,o]):(r="INSERT INTO "+mr+" (id, rev, json) VALUES (?,?,?)",c=[a,i,u]),t.executeSql(r,c,function(t,r){r.rowsAffected?(s={ok:!0,id:a,rev:i},e.ctx&&n(null,s)):n(M(bn))},function(){return n(M(bn)),!1})}"function"==typeof e&&(n=e,e={}),delete t._revisions;var i,o=t._rev,a=t._id;i=t._rev=o?"0-"+(parseInt(o.split("-")[1],10)+1):"0-1";var s,u=ue(t);e.ctx?r(e.ctx):b.transaction(r,de(n),function(){s&&n(null,s)})},p._removeLocal=function(t,e,n){function r(r){r.executeSql("DELETE FROM "+mr+" WHERE id=? AND rev=?",[t._id,t._rev],function(r,o){if(!o.rowsAffected)return n(M(wn));i={ok:!0,id:t._id,rev:"0-0"},e.ctx&&n(null,i)})}var i;"function"==typeof e&&(n=e,e={}),e.ctx?r(e.ctx):b.transaction(r,de(n),function(){i&&n(null,i)})},p._destroy=function(t,e){wr.removeAllListeners(p._name),b.transaction(function(t){[fr,dr,pr,gr,mr,vr].forEach(function(e){t.executeSql("DROP TABLE IF EXISTS "+e,[])})},de(e),function(){v()&&(delete window.localStorage["_pouch__websqldb_"+p._name],delete window.localStorage[p._name]),e(null,{ok:!0})})}}).call(this,n,e)}function ve(t,e){return t=i(t),(t=vn({method:"GET",headers:{},json:!0,processData:!0,timeout:1e4,cache:!1},t)).json&&(t.binary||(t.headers.Accept="application/json"),t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json"),t.binary&&(t.encoding=null,t.json=!1),t.processData||(t.json=!1),function(t,e){return kr||t.xhr?function(t,e){var n,r,i=!1,o=function(){i=!0,n.abort(),s()},a={abort:function(){n.abort(),s()}},s=function(){clearTimeout(r),a.abort=function(){},n&&(n.onprogress=void 0,n.upload&&(n.upload.onprogress=void 0),n.onreadystatechange=void 0,n=void 0)};n=t.xhr?new t.xhr:new XMLHttpRequest;try{n.open(t.method,t.url)}catch(t){return e(new Error(t.name||"Url is invalid"))}for(var u in n.withCredentials=!("withCredentials"in t)||t.withCredentials,"GET"===t.method?delete t.headers["Content-Type"]:t.json&&(t.headers.Accept="application/json",t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.body&&t.processData&&"string"!=typeof t.body&&(t.body=JSON.stringify(t.body))),t.binary&&(n.responseType="arraybuffer"),"body"in t||(t.body=null),t.headers)t.headers.hasOwnProperty(u)&&n.setRequestHeader(u,t.headers[u]);return t.timeout>0&&(r=setTimeout(o,t.timeout),n.onprogress=function(){clearTimeout(r),4!==n.readyState&&(r=setTimeout(o,t.timeout))},void 0!==n.upload&&(n.upload.onprogress=n.onprogress)),n.onreadystatechange=function(){if(4===n.readyState){var r={statusCode:n.status};if(n.status>=200&&n.status<300){var o;o=t.binary?Rt([n.response||""],{type:n.getResponseHeader("Content-Type")}):n.responseText,e(null,r,o)}else{var a={};if(i)(a=new Error("ETIMEDOUT")).code="ETIMEDOUT";else if("string"==typeof n.response)try{a=JSON.parse(n.response)}catch(t){}a.status=n.status,e(a)}s()}},t.body&&t.body instanceof Blob?Ft(t.body,function(t){n.send(t)}):n.send(t.body),a}(t,e):function(t,e){var n,r,i,o=new Headers,a={method:t.method,credentials:"include",headers:o};return t.json&&(o.set("Accept","application/json"),o.set("Content-Type",t.headers["Content-Type"]||"application/json")),a.body=t.body&&t.processData&&"string"!=typeof t.body?JSON.stringify(t.body):"body"in t?t.body:null,Object.keys(t.headers).forEach(function(e){t.headers.hasOwnProperty(e)&&o.set(e,t.headers[e])}),n=function(){for(var t={},e=new fn(function(e,n){t.resolve=e,t.reject=n}),n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return t.promise=e,fn.resolve().then(function(){return fetch.apply(null,n)}).then(function(e){t.resolve(e)}).catch(function(e){t.reject(e)}),t}(t.url,a),t.timeout>0&&(r=setTimeout(function(){n.reject(new Error("Load timeout for resource: "+t.url))},t.timeout)),n.promise.then(function(e){return i={statusCode:e.status},t.timeout>0&&clearTimeout(r),i.statusCode>=200&&i.statusCode<300?t.binary?e.blob():e.text():e.json()}).then(function(t){i.statusCode>=200&&i.statusCode<300?e(null,i,t):(t.status=i.statusCode,e(t))}).catch(function(t){t||(t=new Error("canceled")),e(t)}),{abort:n.reject}}(t,e)}(t,function(n,r,i){if(n)return e(E(n));var o,a=i||"";if(!t.binary&&(t.json||!t.processData)&&"object"!=typeof a&&(/json/.test(r.headers&&r.headers["content-type"])||/^[\s]*\{/.test(a)&&/\}[\s]*$/.test(a)))try{a=JSON.parse(a.toString())}catch(t){}r.statusCode>=200&&r.statusCode<300?function(e,n,r){if(!t.binary&&t.json&&"string"==typeof e)try{e=JSON.parse(e)}catch(t){return r(t)}Array.isArray(e)&&(e=e.map(function(t){return t.error||t.missing?E(t):t})),t.binary&&Cr(e,n),r(null,e,n)}(a,r,e):((o=E(a)).status=r.statusCode,e(o))})}function ye(t,e){var n=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",r=-1!==n.indexOf("safari")&&-1===n.indexOf("chrome"),i=-1!==n.indexOf("msie"),o=-1!==n.indexOf("edge"),a=r||(i||o)&&"GET"===t.method,s=!("cache"in t)||t.cache;if(!/^blob:/.test(t.url)&&(a||!s)){var u=-1!==t.url.indexOf("?");t.url+=(u?"&":"?")+"_nonce="+Date.now()}return ve(t,e)}function we(t){var e=t.doc&&t.doc._attachments;e&&Object.keys(e).forEach(function(t){var n=e[t];n.data=Lt(n.data,n.content_type)})}function be(t){return/^_design/.test(t)?"_design/"+encodeURIComponent(t.slice(8)):/^_local/.test(t)?"_local/"+encodeURIComponent(t.slice(7)):encodeURIComponent(t)}function xe(t){return t._attachments&&Object.keys(t._attachments)?fn.all(Object.keys(t._attachments).map(function(e){var n=t._attachments[e];if(n.data&&"string"!=typeof n.data)return new fn(function(t){Nt(n.data,t)}).then(function(t){n.data=t})})):fn.resolve()}function _e(t,e){return Me(t,t.db+"/"+e)}function Me(t,e){return t.protocol+"://"+t.host+(t.port?":"+t.port:"")+"/"+t.path+(t.path?"/":"")+e}function Ee(t){return"?"+Object.keys(t).map(function(e){return e+"="+encodeURIComponent(t[e])}).join("&")}function Se(t,e){function n(t,e,n){var r=t.ajax||{},o=vn(i(p),r,e),a=i(p.headers||{});return o.headers=vn(a,r.headers,e.headers||{}),l.constructor.listeners("debug").length&&l.constructor.emit("debug",["http",o.method,o.url]),l._ajax(o,n)}function r(t,e){return new fn(function(r,i){n(t,e,function(t,e){if(t)return i(t);r(e)})})}function o(t,e){return s(t,on(function(t){a().then(function(){return e.apply(this,t)}).catch(function(e){t.pop()(e)})}))}function a(){return t.skipSetup||t.skip_setup?fn.resolve():c||((c=r({},{method:"GET",url:d}).catch(function(t){return t&&t.status&&404===t.status?(x(404,"PouchDB is just detecting if the remote exists."),r({},{method:"PUT",url:d})):fn.reject(t)}).catch(function(t){return!(!t||!t.status||412!==t.status)||fn.reject(t)})).catch(function(){c=null}),c)}function u(t){return t.split("/").map(encodeURIComponent).join("/")}var c,l=this,h=function(t,e){if(function(t){if(!t.prefix)return!1;var e=D(t.prefix).protocol;return"http"===e||"https"===e}(e)){var n=e.name.substr(e.prefix.length);t=e.prefix+encodeURIComponent(n)}var r=D(t);(r.user||r.password)&&(r.auth={username:r.user,password:r.password});var i=r.path.replace(/(^\/|\/$)/g,"").split("/");return r.db=i.pop(),-1===r.db.indexOf("%")&&(r.db=encodeURIComponent(r.db)),r.path=i.join("/"),r}(t.name,t),d=_e(h,""),p=(t=i(t)).ajax||{};if(t.auth||h.auth){var g=t.auth||h.auth,v=$n(unescape(encodeURIComponent(g.username+":"+g.password)));p.headers=p.headers||{},p.headers.Authorization="Basic "+v}l._ajax=ye,un(function(){e(null,l)}),l._remote=!0,l.type=function(){return"http"},l.id=o("id",function(t){n({},{method:"GET",url:Me(h,"")},function(e,n){var r=n&&n.uuid?n.uuid+h.db:_e(h,"");t(null,r)})}),l.request=o("request",function(t,e){t.url=_e(h,t.url),n({},t,e)}),l.compact=o("compact",function(t,e){"function"==typeof t&&(e=t,t={}),n(t=i(t),{url:_e(h,"_compact"),method:"POST"},function(){!function n(){l.info(function(r,i){i&&!i.compact_running?e(null,{ok:!0}):setTimeout(n,t.interval||200)})}()})}),l.bulkGet=s("bulkGet",function(t,e){function r(e){var r={};t.revs&&(r.revs=!0),t.attachments&&(r.attachments=!0),t.latest&&(r.latest=!0),n(t,{url:_e(h,"_bulk_get"+Ee(r)),method:"POST",body:{docs:t.docs}},e)}function i(){for(var n=Dr,r=Math.ceil(t.docs.length/n),i=0,a=new Array(r),s=0;s<r;s++){var u=f(t,["revs","attachments","latest"]);u.ajax=p,u.docs=t.docs.slice(s*n,Math.min(t.docs.length,(s+1)*n)),m(o,u,function(t){return function(n,o){a[t]=o.results,++i===r&&e(null,{results:T(a)})}}(s))}}var o=this,a=Me(h,""),s=Pr[a];"boolean"!=typeof s?r(function(t,n){t?(Pr[a]=!1,x(t.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),i()):(Pr[a]=!0,e(null,n))}):s?r(e):i()}),l._info=function(t){a().then(function(){n({},{method:"GET",url:_e(h,"")},function(e,n){if(e)return t(e);n.host=_e(h,""),t(null,n)})}).catch(t)},l.get=o("get",function(t,e,n){function o(t){function n(n){var o=i[n],a=be(t._id)+"/"+u(n)+"?rev="+t._rev;return r(e,{method:"GET",url:_e(h,a),binary:!0}).then(function(t){return e.binary?t:new fn(function(e){Nt(t,e)})}).then(function(t){delete o.stub,delete o.length,o.data=t})}var i=t._attachments,o=i&&Object.keys(i);if(i&&o.length)return function(t,e){return new fn(function(n,r){function i(){++h===f?u?r(u):n():s()}function o(){c--,i()}function a(t){c--,u=u||t,i()}function s(){for(;c<e&&l<f;)c++,t[l++]().then(o,a)}var u,c=0,l=0,h=0,f=t.length;s()})}(o.map(function(t){return function(){return n(t)}}),5)}"function"==typeof e&&(n=e,e={});var a={};(e=i(e)).revs&&(a.revs=!0),e.revs_info&&(a.revs_info=!0),e.latest&&(a.latest=!0),e.open_revs&&("all"!==e.open_revs&&(e.open_revs=JSON.stringify(e.open_revs)),a.open_revs=e.open_revs),e.rev&&(a.rev=e.rev),e.conflicts&&(a.conflicts=e.conflicts),t=be(t);var s={method:"GET",url:_e(h,t+Ee(a))};r(e,s).then(function(t){return fn.resolve().then(function(){if(e.attachments)return function(t){return Array.isArray(t)?fn.all(t.map(function(t){if(t.ok)return o(t.ok)})):o(t)}(t)}).then(function(){n(null,t)})}).catch(function(e){e.docId=t,n(e)})}),l.remove=o("remove",function(t,e,r,i){var o;"string"==typeof e?(o={_id:t,_rev:e},"function"==typeof r&&(i=r,r={})):(o=t,"function"==typeof e?(i=e,r={}):(i=r,r=e));var a=o._rev||r.rev;n(r,{method:"DELETE",url:_e(h,be(o._id))+"?rev="+a},i)}),l.getAttachment=o("getAttachment",function(t,e,r,i){"function"==typeof r&&(i=r,r={});var o=r.rev?"?rev="+r.rev:"";n(r,{method:"GET",url:_e(h,be(t))+"/"+u(e)+o,binary:!0},i)}),l.removeAttachment=o("removeAttachment",function(t,e,r,i){n({},{method:"DELETE",url:_e(h,be(t)+"/"+u(e))+"?rev="+r},i)}),l.putAttachment=o("putAttachment",function(t,e,r,i,o,a){"function"==typeof o&&(a=o,o=i,i=r,r=null);var s=be(t)+"/"+u(e),c=_e(h,s);if(r&&(c+="?rev="+r),"string"==typeof i){var l;try{l=Xn(i)}catch(t){return a(M(Sn,"Attachment is not a valid base64 string"))}i=l?Dt(l,o):""}n({},{headers:{"Content-Type":o},method:"PUT",url:c,processData:!1,body:i,timeout:p.timeout||6e4},a)}),l._bulkDocs=function(t,e,r){t.new_edits=e.new_edits,a().then(function(){return fn.all(t.docs.map(xe))}).then(function(){n(e,{method:"POST",url:_e(h,"_bulk_docs"),timeout:e.timeout,body:t},function(t,e){if(t)return r(t);e.forEach(function(t){t.ok=!0}),r(null,e)})}).catch(r)},l._put=function(t,e,r){a().then(function(){return xe(t)}).then(function(){n(e,{method:"PUT",url:_e(h,be(t._id)),body:t},function(e,n){if(e)return e.docId=t&&t._id,r(e);r(null,n)})}).catch(r)},l.allDocs=o("allDocs",function(t,e){"function"==typeof t&&(e=t,t={});var n,o={},a="GET";(t=i(t)).conflicts&&(o.conflicts=!0),t.descending&&(o.descending=!0),t.include_docs&&(o.include_docs=!0),t.attachments&&(o.attachments=!0),t.key&&(o.key=JSON.stringify(t.key)),t.start_key&&(t.startkey=t.start_key),t.startkey&&(o.startkey=JSON.stringify(t.startkey)),t.end_key&&(t.endkey=t.end_key),t.endkey&&(o.endkey=JSON.stringify(t.endkey)),void 0!==t.inclusive_end&&(o.inclusive_end=!!t.inclusive_end),void 0!==t.limit&&(o.limit=t.limit),void 0!==t.skip&&(o.skip=t.skip);var s=Ee(o);void 0!==t.keys&&(a="POST",n={keys:t.keys}),r(t,{method:a,url:_e(h,"_all_docs"+s),body:n}).then(function(n){t.include_docs&&t.attachments&&t.binary&&n.rows.forEach(we),e(null,n)}).catch(e)}),l._changes=function(t){var e="batch_size"in t?t.batch_size:Rr;!(t=i(t)).continuous||"heartbeat"in t||(t.heartbeat=Or);var r="timeout"in t?t.timeout:"timeout"in p?p.timeout:3e4;"timeout"in t&&t.timeout&&r-t.timeout<Lr&&(r=t.timeout+Lr),"heartbeat"in t&&t.heartbeat&&r-t.heartbeat<Lr&&(r=t.heartbeat+Lr);var o={};"timeout"in t&&t.timeout&&(o.timeout=t.timeout);var s,u=void 0!==t.limit&&t.limit;s="return_docs"in t?t.return_docs:!("returnDocs"in t)||t.returnDocs;var c=u;if(t.style&&(o.style=t.style),(t.include_docs||t.filter&&"function"==typeof t.filter)&&(o.include_docs=!0),t.attachments&&(o.attachments=!0),t.continuous&&(o.feed="longpoll"),t.conflicts&&(o.conflicts=!0),t.descending&&(o.descending=!0),"heartbeat"in t&&t.heartbeat&&(o.heartbeat=t.heartbeat),t.filter&&"string"==typeof t.filter&&(o.filter=t.filter),t.view&&"string"==typeof t.view&&(o.filter="_view",o.view=t.view),t.query_params&&"object"==typeof t.query_params)for(var l in t.query_params)t.query_params.hasOwnProperty(l)&&(o[l]=t.query_params[l]);var f,d="GET";t.doc_ids?(o.filter="_doc_ids",d="POST",f={doc_ids:t.doc_ids}):t.selector&&(o.filter="_selector",d="POST",f={selector:t.selector});var m,g,v=function(i,s){if(!t.aborted){o.since=i,"object"==typeof o.since&&(o.since=JSON.stringify(o.since)),t.descending?u&&(o.limit=c):o.limit=!u||c>e?e:c;var l={method:d,url:_e(h,"_changes"+Ee(o)),timeout:r,body:f};g=i,t.aborted||a().then(function(){m=n(t,l,s)}).catch(s)}},y={results:[]},w=function(n,r){if(!t.aborted){var i=0;if(r&&r.results)i=r.results.length,y.last_seq=r.last_seq,r.results=r.results.filter(function(e){c--;var n=S(t)(e);return n&&(t.include_docs&&t.attachments&&t.binary&&we(e),s&&y.results.push(e),t.onChange(e)),n});else if(n)return t.aborted=!0,void t.complete(n);r&&r.last_seq&&(g=r.last_seq),(!t.continuous||u&&c<=0)&&(u&&c<=0||r&&i<e||t.descending)?t.complete(null,y):un(function(){v(g,w)})}};return v(t.since||0,w),{cancel:function(){t.aborted=!0,m&&m.abort()}}},l.revsDiff=o("revsDiff",function(t,e,r){"function"==typeof e&&(r=e,e={}),n(e,{method:"POST",url:_e(h,"_revs_diff"),body:t},r)}),l._close=function(t){t()},l._destroy=function(t,e){n(t,{url:_e(h,""),method:"DELETE"},function(t,n){if(t&&t.status&&404!==t.status)return e(t);e(null,n)})}}function Te(t){this.status=400,this.name="query_parse_error",this.message=t,this.error=!0;try{Error.captureStackTrace(this,Te)}catch(t){}}function Ae(t){this.status=404,this.name="not_found",this.message=t,this.error=!0;try{Error.captureStackTrace(this,Ae)}catch(t){}}function ke(t){this.status=500,this.name="invalid_value",this.message=t,this.error=!0;try{Error.captureStackTrace(this,ke)}catch(t){}}function Ce(t,e){return e&&t.then(function(t){un(function(){e(null,t)})},function(t){un(function(){e(t)})}),t}function Re(t,e){return function(){var n=arguments,r=this;return t.add(function(){return e.apply(r,n)})}}function De(t){var e=new tn(t),n=new Array(e.size),r=-1;return e.forEach(function(t){n[++r]=t}),n}function Le(t){var e=new Array(t.size),n=-1;return t.forEach(function(t,r){e[++n]=r}),e}function Oe(t){return new ke("builtin "+t+" function requires map values to be numbers or number arrays")}function Pe(t){for(var e=0,n=0,r=t.length;n<r;n++){var i=t[n];if("number"!=typeof i){if(!Array.isArray(i))throw Oe("_sum");e="number"==typeof e?[e]:e;for(var o=0,a=i.length;o<a;o++){var s=i[o];if("number"!=typeof s)throw Oe("_sum");void 0===e[o]?e.push(s):e[o]+=s}}else"number"==typeof e?e+=i:e[0]+=i}return e}function Ie(t,e){return L("return ("+t.replace(/;\s*$/,"")+");",{emit:e,sum:Pe,log:Ir,isArray:Nr,toJSON:Fr})}function Ne(){this.promise=new fn(function(t){t()})}function Fe(t){if(!t)return"undefined";switch(typeof t){case"function":case"string":return t.toString();default:return JSON.stringify(t)}}function je(t,e,n,r,i,o){var a,s=function(t,e){return Fe(n)+Fe(e)+"undefined"}(0,r);if(!i&&(a=t._cachedViews=t._cachedViews||{})[s])return a[s];var u=t.info().then(function(u){var c=u.db_name+"-mrview-"+(i?"temp":ln.hash(s));return O(t,"_local/"+o,function(t){t.views=t.views||{};var n=e;-1===n.indexOf("/")&&(n=e+"/"+e);var r=t.views[n]=t.views[n]||{};if(!r[c])return r[c]=!0,t}).then(function(){return t.registerDependentDatabase(c).then(function(e){var i=e.db;i.auto_compaction=!0;var o={name:c,db:i,sourceDB:t,adapter:t.adapter,mapFun:n,reduceFun:r};return o.db.get("_local/lastSeq").catch(function(t){if(404!==t.status)throw t}).then(function(t){return o.seq=t?t.seq:0,a&&o.db.once("destroyed",function(){delete a[s]}),o})})})});return a&&(a[s]=u),u}function ze(t){return-1===t.indexOf("/")?[t,t]:t.split("/")}function Ue(t,e){try{t.emit("error",e)}catch(t){w("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),w("error",e)}}function Ve(t){return/^1-/.test(t)}function Be(t,e){var n=Object.keys(e._attachments);return fn.all(n.map(function(n){return t.getAttachment(e._id,n,{rev:e._rev})}))}function He(t,e,n,r){function o(e){return t.allDocs({keys:e,include_docs:!0,conflicts:!0}).then(function(t){if(r.cancelled)throw new Error("cancelled");t.rows.forEach(function(t){t.deleted||!t.doc||!Ve(t.value.rev)||function(t){return t._attachments&&Object.keys(t._attachments).length>0}(t.doc)||function(t){return t._conflicts&&t._conflicts.length>0}(t.doc)||(t.doc._conflicts&&delete t.doc._conflicts,a.push(t.doc),delete n[t.id])})})}n=i(n);var a=[],s=!0;return fn.resolve().then(function(){var t=Object.keys(n).filter(function(t){var e=n[t].missing;return 1===e.length&&Ve(e[0])});if(t.length>0)return o(t)}).then(function(){var i=function(t){var e=[];return Object.keys(t).forEach(function(n){t[n].missing.forEach(function(t){e.push({id:n,rev:t})})}),{docs:e,revs:!0,latest:!0}}(n);if(i.docs.length)return t.bulkGet(i).then(function(n){if(r.cancelled)throw new Error("cancelled");return fn.all(n.results.map(function(n){return fn.all(n.docs.map(function(n){var r=n.ok;return n.error&&(s=!1),r&&r._attachments?function(t,e,n){var r=k(e)&&!k(t),i=Object.keys(n._attachments);return r?t.get(n._id).then(function(r){return fn.all(i.map(function(i){return function(t,e,n){return!r._attachments||!r._attachments[i]||r._attachments[i].digest!==e._attachments[i].digest}(0,n)?e.getAttachment(n._id,i):t.getAttachment(r._id,i)}))}).catch(function(t){if(404!==t.status)throw t;return Be(e,n)}):Be(e,n)}(e,t,r).then(function(t){var e=Object.keys(r._attachments);return t.forEach(function(t,n){var i=r._attachments[e[n]];delete i.stub,delete i.length,i.data=t}),r}):r}))})).then(function(t){a=a.concat(T(t).filter(Boolean))})})}).then(function(){return{ok:s,docs:a}})}function qe(t,e,n,r,i){return t.get(e).catch(function(n){if(404===n.status)return"http"!==t.adapter&&"https"!==t.adapter||x(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:r,_id:e,history:[],replicator:Yr,version:Wr};throw n}).then(function(o){if(!i.cancelled&&o.last_seq!==n)return o.history=(o.history||[]).filter(function(t){return t.session_id!==r}),o.history.unshift({last_seq:n,session_id:r}),o.history=o.history.slice(0,Xr),o.version=Wr,o.replicator=Yr,o.session_id=r,o.last_seq=n,t.put(o).catch(function(o){if(409===o.status)return qe(t,e,n,r,i);throw o})})}function Ge(t,e,n,r,i){this.src=t,this.target=e,this.id=n,this.returnValue=r,this.opts=i}function We(t,e){var n=e[0],r=e.slice(1);return!(!t||0===e.length)&&(t===n.session_id||We(t,r))}function Ye(t){return"number"==typeof t.status&&4===Math.floor(t.status/100)}function Xe(t,e,n,r){if(!1===t.retry)return e.emit("error",n),void e.removeAllListeners();if("function"!=typeof t.back_off_function&&(t.back_off_function=b),e.emit("requestError",n),"active"===e.state||"pending"===e.state){e.emit("paused",n),e.state="stopped";var i=function(){t.current_back_off=Qr};e.once("paused",function(){e.removeListener("active",i)}),e.once("active",i)}t.current_back_off=t.current_back_off||Qr,t.current_back_off=t.back_off_function(t.current_back_off),setTimeout(r,t.current_back_off)}function $e(){an.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var t=this,e=new fn(function(e,n){t.once("complete",e),t.once("error",n)});t.then=function(t,n){return e.then(t,n)},t.catch=function(t){return e.catch(t)},t.catch(function(){})}function Qe(t,e){return"string"==typeof t?new(0,e.PouchConstructor)(t,e):t}function Je(t,e,n,r){if("function"==typeof n&&(r=n,n={}),void 0===n&&(n={}),n.doc_ids&&!Array.isArray(n.doc_ids))throw M(kn,"`doc_ids` filter parameter is not a list.");n.complete=r,(n=i(n)).continuous=n.continuous||n.live,n.retry="retry"in n&&n.retry,n.PouchConstructor=n.PouchConstructor||this;var o=new $e(n);return function t(e,n,r,o,a){function s(){return _?fn.resolve():function(t,e,n){var r=n.doc_ids?n.doc_ids.sort(ft):"",i=n.filter?n.filter.toString():"",o="",a="",s="";return n.selector&&(s=JSON.stringify(n.selector)),n.filter&&n.query_params&&(o=JSON.stringify(function(t){return Object.keys(t).sort(ft).reduce(function(e,n){return e[n]=t[n],e},{})}(n.query_params))),n.filter&&"_view"===n.filter&&(a=n.view.toString()),fn.all([t.id(),e.id()]).then(function(t){var e=t[0]+t[1]+i+a+o+r+s;return new fn(function(t){Ut(e,t)})}).then(function(t){return"_local/"+t.replace(/\//g,".").replace(/\+/g,"_")})}(e,n,r).then(function(t){_=new Ge(e,n,t,o,!1===r.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!1}:"source"===r.checkpoint?{writeSourceCheckpoint:!0,writeTargetCheckpoint:!1}:"target"===r.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!0}:{writeSourceCheckpoint:!0,writeTargetCheckpoint:!0})})}function u(){if(F=[],0!==x.docs.length){var t=x.docs;return n.bulkDocs({docs:t,new_edits:!1},{timeout:r.timeout}).then(function(e){if(o.cancelled)throw p(),new Error("cancelled");var n=Object.create(null);e.forEach(function(t){t.error&&(n[t.id]=t)});var r=Object.keys(n).length;a.doc_write_failures+=r,a.docs_written+=t.length-r,t.forEach(function(t){var e=n[t._id];if(e){if(a.errors.push(e),"unauthorized"!==e.name&&"forbidden"!==e.name)throw e;o.emit("denied",i(e))}else F.push(t)})},function(e){throw a.doc_write_failures+=t.length,e})}}function c(){if(x.error)throw new Error("There was a problem getting docs.");a.last_seq=R=x.seq;var t=i(a);return F.length&&(t.docs=F,o.emit("change",t)),A=!0,_.writeCheckpoint(x.seq,j).then(function(){if(A=!1,o.cancelled)throw p(),new Error("cancelled");x=void 0,y()}).catch(function(t){throw b(t),t})}function l(){return He(e,n,x.diffs,o).then(function(t){x.error=!t.ok,t.docs.forEach(function(t){delete x.diffs[t._id],a.docs_read++,x.docs.push(t)})})}function h(){if(!o.cancelled&&!x){if(0===E.length)return void f(!0);x=E.shift(),(t={},x.changes.forEach(function(e){"_user/"!==e.id&&(t[e.id]=e.changes.map(function(t){return t.rev}))}),n.revsDiff(t).then(function(t){if(o.cancelled)throw p(),new Error("cancelled");x.diffs=t})).then(l).then(u).then(c).then(h).catch(function(t){d("batch processing terminated with error",t)})}var t}function f(t){0!==T.changes.length?(t||k||T.changes.length>=L)&&(E.push(T),T={seq:0,changes:[],docs:[]},"pending"!==o.state&&"stopped"!==o.state||(o.state="active",o.emit("active")),h()):0!==E.length||x||((D&&z.live||k)&&(o.state="pending",o.emit("paused")),k&&p())}function d(t,e){C||(e.message||(e.message=t),a.ok=!1,a.status="aborting",E=[],T={seq:0,changes:[],docs:[]},p(e))}function p(i){C||o.cancelled&&(a.status="cancelled",A)||(a.status=a.status||"complete",a.end_time=new Date,a.last_seq=R,C=!0,i?((i=M(i)).result=a,"unauthorized"===i.name||"forbidden"===i.name?(o.emit("error",i),o.removeAllListeners()):Xe(r,o,i,function(){t(e,n,r,o)})):(o.emit("complete",a),o.removeAllListeners()))}function m(t){if(o.cancelled)return p();S(r)(t)&&(T.seq=t.seq,T.changes.push(t),f(0===E.length&&z.live))}function g(t){if(P=!1,o.cancelled)return p();if(t.results.length>0)z.since=t.last_seq,y(),f(!0);else{var e=function(){D?(z.live=!0,y()):k=!0,f(!0)};x||0!==t.results.length?e():(A=!0,_.writeCheckpoint(t.last_seq,j).then(function(){A=!1,a.last_seq=R=t.last_seq,e()}).catch(b))}}function v(t){if(P=!1,o.cancelled)return p();d("changes rejected",t)}function y(){function t(){i.cancel()}function n(){o.removeListener("cancel",t)}if(!P&&!k&&E.length<O){P=!0,o._changes&&(o.removeListener("cancel",o._abortChanges),o._changes.cancel()),o.once("cancel",t);var i=e.changes(z).on("change",m);i.then(n,n),i.then(g).catch(v),r.retry&&(o._changes=i,o._abortChanges=t)}}function w(){s().then(function(){return o.cancelled?void p():_.getCheckpoint().then(function(t){z={since:R=t,limit:L,batch_size:L,style:"all_docs",doc_ids:I,selector:N,return_docs:!0},r.filter&&("string"!=typeof r.filter?z.include_docs=!0:z.filter=r.filter),"heartbeat"in r&&(z.heartbeat=r.heartbeat),"timeout"in r&&(z.timeout=r.timeout),r.query_params&&(z.query_params=r.query_params),r.view&&(z.view=r.view),y()})}).catch(function(t){d("getCheckpoint rejected with ",t)})}function b(t){A=!1,d("writeCheckpoint completed with error",t)}var x,_,E=[],T={seq:0,changes:[],docs:[]},A=!1,k=!1,C=!1,R=0,D=r.continuous||r.live||!1,L=r.batch_size||100,O=r.batches_limit||10,P=!1,I=r.doc_ids,N=r.selector,F=[],j=jn();a=a||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var z={};o.ready(e,n),o.cancelled?p():(o._addedListeners||(o.once("cancel",p),"function"==typeof r.complete&&(o.once("error",r.complete),o.once("complete",function(t){r.complete(null,t)})),o._addedListeners=!0),void 0===r.since?w():s().then(function(){return A=!0,_.writeCheckpoint(r.since,j)}).then(function(){A=!1,o.cancelled?p():(R=r.since,w())}).catch(b))}(Qe(t,n),Qe(e,n),n,o),o}function Ze(t,e,n,r){return"function"==typeof n&&(r=n,n={}),void 0===n&&(n={}),(n=i(n)).PouchConstructor=n.PouchConstructor||this,new Ke(t=Qe(t,n),e=Qe(e,n),n,r)}function Ke(t,e,n,r){function i(t){p.emit("change",{direction:"pull",change:t})}function o(t){p.emit("change",{direction:"push",change:t})}function a(t){p.emit("denied",{direction:"push",doc:t})}function s(t){p.emit("denied",{direction:"pull",doc:t})}function u(){p.pushPaused=!0,p.pullPaused&&p.emit("paused")}function c(){p.pullPaused=!0,p.pushPaused&&p.emit("paused")}function l(){p.pushPaused=!1,p.pullPaused&&p.emit("active",{direction:"push"})}function h(){p.pullPaused=!1,p.pushPaused&&p.emit("active",{direction:"pull"})}function f(t){return function(e,n){("change"===e&&(n===i||n===o)||"denied"===e&&(n===s||n===a)||"paused"===e&&(n===c||n===u)||"active"===e&&(n===h||n===l))&&(e in v||(v[e]={}),v[e][t]=!0,2===Object.keys(v[e]).length&&p.removeAllListeners(e))}}function d(t,e,n){-1==t.listeners(e).indexOf(n)&&t.on(e,n)}var p=this;this.canceled=!1;var m=n.push?vn({},n,n.push):n,g=n.pull?vn({},n,n.pull):n;this.push=Je(t,e,m),this.pull=Je(e,t,g),this.pushPaused=!0,this.pullPaused=!0;var v={};n.live&&(this.push.on("complete",p.pull.cancel.bind(p.pull)),this.pull.on("complete",p.push.cancel.bind(p.push))),this.on("newListener",function(t){"change"===t?(d(p.pull,"change",i),d(p.push,"change",o)):"denied"===t?(d(p.pull,"denied",s),d(p.push,"denied",a)):"active"===t?(d(p.pull,"active",h),d(p.push,"active",l)):"paused"===t&&(d(p.pull,"paused",c),d(p.push,"paused",u))}),this.on("removeListener",function(t){"change"===t?(p.pull.removeListener("change",i),p.push.removeListener("change",o)):"denied"===t?(p.pull.removeListener("denied",s),p.push.removeListener("denied",a)):"active"===t?(p.pull.removeListener("active",h),p.push.removeListener("active",l)):"paused"===t&&(p.pull.removeListener("paused",c),p.push.removeListener("paused",u))}),this.pull.on("removeListener",f("pull")),this.push.on("removeListener",f("push"));var y=fn.all([this.push,this.pull]).then(function(t){var e={push:t[0],pull:t[1]};return p.emit("complete",e),r&&r(null,e),p.removeAllListeners(),e},function(t){if(p.cancel(),r?r(t):p.emit("error",t),p.removeAllListeners(),r)throw t});this.then=function(t,e){return y.then(t,e)},this.catch=function(t){return y.catch(t)}}var tn,en,nn=r(t(11)),rn=r(t(7)),on=r(t(1)),an=t(4),sn=r(t(6)),un=r(t(5)),cn=r(t(2)),ln=r(t(10)),hn=r(t(16)),fn="function"==typeof Promise?Promise:rn,dn=Function.prototype.toString,pn=dn.call(Object);l.prototype.get=function(t){var e=u(t);return this._store[e]},l.prototype.set=function(t,e){var n=u(t);return this._store[n]=e,!0},l.prototype.has=function(t){return u(t)in this._store},l.prototype.delete=function(t){var e=u(t),n=e in this._store;return delete this._store[e],n},l.prototype.forEach=function(t){for(var e=Object.keys(this._store),n=0,r=e.length;n<r;n++){var i=e[n];t(this._store[i],i=c(i))}},Object.defineProperty(l.prototype,"size",{get:function(){return Object.keys(this._store).length}}),h.prototype.add=function(t){return this._store.set(t,!0)},h.prototype.has=function(t){return this._store.has(t)},h.prototype.forEach=function(t){this._store.forEach(function(e,n){t(n)})},Object.defineProperty(h.prototype,"size",{get:function(){return this._store.size}}),function(){if("undefined"==typeof Symbol||"undefined"==typeof Map||"undefined"==typeof Set)return!1;var t=Object.getOwnPropertyDescriptor(Map,Symbol.species);return t&&"get"in t&&Map[Symbol.species]===Map}()?(tn=Set,en=Map):(tn=h,en=l);var mn,gn=6;if(g())mn=!1;else try{localStorage.setItem("_pouch_check_localstorage",1),mn=!!localStorage.getItem("_pouch_check_localstorage")}catch(t){mn=!1}sn(y,an.EventEmitter),y.prototype.addListener=function(t,e,n,r){function i(){if(o._listeners[e]){if(a)return void(a="waiting");a=!0;var t=f(r,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);n.changes(t).on("change",function(t){t.seq>r.since&&!r.cancelled&&(r.since=t.seq,r.onChange(t))}).on("complete",function(){"waiting"===a&&un(i),a=!1}).on("error",function(){a=!1})}}if(!this._listeners[e]){var o=this,a=!1;this._listeners[e]=i,this.on(t,i)}},y.prototype.removeListener=function(t,e){e in this._listeners&&(an.EventEmitter.prototype.removeListener.call(this,t,this._listeners[e]),delete this._listeners[e])},y.prototype.notifyLocalWindows=function(t){g()?chrome.storage.local.set({dbName:t}):v()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},y.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)};var vn="function"==typeof Object.assign?Object.assign:function(t){for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e};sn(_,Error),_.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var yn=(new _(401,"unauthorized","Name or password is incorrect."),new _(400,"bad_request","Missing JSON list of 'docs'")),wn=new _(404,"not_found","missing"),bn=new _(409,"conflict","Document update conflict"),xn=new _(400,"bad_request","_id field must contain a string"),_n=new _(412,"missing_id","_id is required for puts"),Mn=new _(400,"bad_request","Only reserved document ids may start with underscore."),En=(new _(412,"precondition_failed","Database not open"),new _(500,"unknown_error","Database encountered an unknown error")),Sn=new _(500,"badarg","Some query argument is invalid"),Tn=(new _(400,"invalid_request","Request was invalid"),new _(400,"query_parse_error","Some query parameter is invalid")),An=new _(500,"doc_validation","Bad special document member"),kn=new _(400,"bad_request","Something wrong with the request"),Cn=new _(400,"bad_request","Document must be a JSON object"),Rn=(new _(404,"not_found","Database not found"),new _(500,"indexed_db_went_bad","unknown")),Dn=new _(500,"web_sql_went_bad","unknown"),Ln=(new _(500,"levelDB_went_went_bad","unknown"),new _(403,"forbidden","Forbidden by design doc validate_doc_update function"),new _(400,"bad_request","Invalid rev format")),On=(new _(412,"file_exists","The database could not be created, the file already exists."),new _(412,"missing_stub","A pre-existing attachment stub wasn't found")),Pn=(new _(413,"invalid_url","Provided URL is invalid"),["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"]),In="queryKey",Nn=/(?:^|&)([^&=]*)=?([^&]*)/g,Fn=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,jn=nn.v4;sn(K,an.EventEmitter),K.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},K.prototype.validateChanges=function(t){var e=t.complete,n=this;at._changesFilterPlugin?at._changesFilterPlugin.validate(t,function(r){if(r)return e(r);n.doChanges(t)}):n.doChanges(t)},K.prototype.doChanges=function(t){var e=this,n=t.complete;if("live"in(t=i(t))&&!("continuous"in t)&&(t.continuous=t.live),t.processChange=tt,"latest"===t.since&&(t.since="now"),t.since||(t.since=0),"now"!==t.since){if(at._changesFilterPlugin){if(at._changesFilterPlugin.normalize(t),at._changesFilterPlugin.shouldFilter(this,t))return at._changesFilterPlugin.filter(this,t)}else["doc_ids","filter","selector","view"].forEach(function(e){e in t&&w("warn",'The "'+e+'" option was passed in to changes/replicate, but pouchdb-changes-filter plugin is not installed, so it was ignored. Please install the plugin to enable filtering.')});"descending"in t||(t.descending=!1),t.limit=0===t.limit?1:t.limit,t.complete=n;var r=this.db._changes(t);if(r&&"function"==typeof r.cancel){var o=e.cancel;e.cancel=on(function(t){r.cancel(),o.apply(this,t)})}}else this.db.info().then(function(r){e.isCancelled?n(null,{status:"cancelled"}):(t.since=r.update_seq,e.doChanges(t))},n)},sn(it,an.EventEmitter),it.prototype.post=s("post",function(t,e,n){if("function"==typeof e&&(n=e,e={}),"object"!=typeof t||Array.isArray(t))return n(M(Cn));this.bulkDocs({docs:[t]},e,nt(n,t._id))}),it.prototype.put=s("put",function(t,e,n){function r(n){"function"==typeof i._put&&!1!==e.new_edits?i._put(t,e,n):i.bulkDocs({docs:[t]},e,nt(n,t._id))}if("function"==typeof e&&(n=e,e={}),"object"!=typeof t||Array.isArray(t))return n(M(Cn));if(A(t._id),J(t._id)&&"function"==typeof this._putLocal)return t._deleted?this._removeLocal(t,n):this._putLocal(t,n);var i=this;e.force&&t._rev?(function(){var n=t._rev.split("-"),r=n[1],i=parseInt(n[0],10)+1,o=P();t._revisions={start:i,ids:[o,r]},t._rev=i+"-"+o,e.new_edits=!1}(),r(function(e){n(e,e?null:{ok:!0,id:t._id,rev:t._rev})})):r(n)}),it.prototype.putAttachment=s("putAttachment",function(t,e,n,r,i){function o(t){var n="_rev"in t?parseInt(t._rev,10):0;return t._attachments=t._attachments||{},t._attachments[e]={content_type:i,data:r,revpos:++n},a.put(t)}var a=this;return"function"==typeof i&&(i=r,r=n,n=null),void 0===i&&(i=r,r=n,n=null),i||w("warn","Attachment",e,"on document",t,"is missing content_type"),a.get(t).then(function(t){if(t._rev!==n)throw M(bn);return o(t)},function(e){if(e.reason===wn.message)return o({_id:t});throw e})}),it.prototype.removeAttachment=s("removeAttachment",function(t,e,n,r){var i=this;i.get(t,function(t,o){return t?void r(t):o._rev!==n?void r(M(bn)):o._attachments?(delete o._attachments[e],0===Object.keys(o._attachments).length&&delete o._attachments,void i.put(o,r)):r()})}),it.prototype.remove=s("remove",function(t,e,n,r){var i;"string"==typeof e?(i={_id:t,_rev:e},"function"==typeof n&&(r=n,n={})):(i=t,"function"==typeof e?(r=e,n={}):(r=n,n=e)),(n=n||{}).was_delete=!0;var o={_id:i._id,_rev:i._rev||n.rev,_deleted:!0};if(J(o._id)&&"function"==typeof this._removeLocal)return this._removeLocal(i,r);this.bulkDocs({docs:[o]},n,nt(r,o._id))}),it.prototype.revsDiff=s("revsDiff",function(t,e,n){function r(t,e){s.has(t)||s.set(t,{missing:[]}),s.get(t).missing.push(e)}function i(e,n){var i=t[e].slice(0);N(n,function(t,n,o,a,s){var u=n+"-"+o,c=i.indexOf(u);-1!==c&&(i.splice(c,1),"available"!==s.status&&r(e,u))}),i.forEach(function(t){r(e,t)})}"function"==typeof e&&(n=e,e={});var o=Object.keys(t);if(!o.length)return n(null,{});var a=0,s=new en;o.map(function(e){this._getRevisionTree(e,function(r,u){if(r&&404===r.status&&"missing"===r.message)s.set(e,{missing:t[e]});else{if(r)return n(r);i(e,u)}if(++a===o.length){var c={};return s.forEach(function(t,e){c[e]=t}),n(null,c)}})},this)}),it.prototype.bulkGet=s("bulkGet",function(t,e){m(this,t,e)}),it.prototype.compactDocument=s("compactDocument",function(t,e,n){var r=this;this._getRevisionTree(t,function(i,o){if(i)return n(i);var a=function(t){var e={},n=[];return N(o,function(t,r,i,o){var a=r+"-"+i;return t&&(e[a]=0),void 0!==o&&n.push({from:o,to:a}),a}),n.reverse(),n.forEach(function(t){e[t.from]=void 0===e[t.from]?1+e[t.to]:Math.min(e[t.from],1+e[t.to])}),e}(),s=[],u=[];Object.keys(a).forEach(function(t){a[t]>e&&s.push(t)}),N(o,function(t,e,n,r,i){var o=e+"-"+n;"available"===i.status&&-1!==s.indexOf(o)&&u.push(o)}),r._doCompaction(t,u,n)})}),it.prototype.compact=s("compact",function(t,e){"function"==typeof t&&(e=t,t={});var n=this;t=t||{},n._compactionQueue=n._compactionQueue||[],n._compactionQueue.push({opts:t,callback:e}),1===n._compactionQueue.length&&function t(e){var n=e._compactionQueue[0],r=n.opts,i=n.callback;e.get("_local/compaction").catch(function(){return!1}).then(function(n){n&&n.last_seq&&(r.last_seq=n.last_seq),e._compact(r,function(n,r){n?i(n):i(null,r),un(function(){e._compactionQueue.shift(),e._compactionQueue.length&&t(e)})})})}(n)}),it.prototype._compact=function(t,e){var n=this,r=[];n.changes({return_docs:!1,last_seq:t.last_seq||0}).on("change",function(t){r.push(n.compactDocument(t.id,0))}).on("complete",function(t){var i=t.last_seq;fn.all(r).then(function(){return O(n,"_local/compaction",function(t){return(!t.last_seq||t.last_seq<i)&&(t.last_seq=i,t)})}).then(function(){e(null,{ok:!0})}).catch(e)}).on("error",e)},it.prototype.get=s("get",function(t,e,n){function r(){var r=[],a=i.length;if(!a)return n(null,r);i.forEach(function(i){o.get(t,{rev:i,revs:e.revs,latest:e.latest,attachments:e.attachments},function(t,e){if(t)r.push({missing:i});else{for(var o,s=0,u=r.length;s<u;s++)if(r[s].ok&&r[s].ok._rev===e._rev){o=!0;break}o||r.push({ok:e})}--a||n(null,r)})})}if("function"==typeof e&&(n=e,e={}),"string"!=typeof t)return n(M(xn));if(J(t)&&"function"==typeof this._getLocal)return this._getLocal(t,n);var i=[],o=this;if(!e.open_revs)return this._get(t,e,function(r,i){if(r)return r.docId=t,n(r);var a=i.doc,s=i.metadata,u=i.ctx;if(e.conflicts){var c=z(s);c.length&&(a._conflicts=c)}if(Q(s,a._rev)&&(a._deleted=!0),e.revs||e.revs_info){for(var l=a._rev.split("-"),h=parseInt(l[0],10),f=l[1],d=V(s.rev_tree),p=null,m=0;m<d.length;m++){var g=d[m],v=g.ids.map(function(t){return t.id}).indexOf(f);(v===h-1||!p&&-1!==v)&&(p=g)}var y=p.ids.map(function(t){return t.id}).indexOf(a._rev.split("-")[1])+1;if(p.ids.splice(y,p.ids.length-y),p.ids.reverse(),e.revs&&(a._revisions={start:p.pos+p.ids.length-1,ids:p.ids.map(function(t){return t.id})}),e.revs_info){var w=p.pos+p.ids.length;a._revs_info=p.ids.map(function(t){return{rev:--w+"-"+t.id,status:t.opts.status}})}}if(e.attachments&&a._attachments){var b=a._attachments,x=Object.keys(b).length;if(0===x)return n(null,a);Object.keys(b).forEach(function(t){this._getAttachment(a._id,t,b[t],{rev:a._rev,binary:e.binary,ctx:u},function(e,r){var i=a._attachments[t];i.data=r,delete i.stub,delete i.length,--x||n(null,a)})},o)}else{if(a._attachments)for(var _ in a._attachments)a._attachments.hasOwnProperty(_)&&(a._attachments[_].stub=!0);n(null,a)}});if("all"===e.open_revs)this._getRevisionTree(t,function(t,e){if(t)return n(t);i=j(e).map(function(t){return t.rev}),r()});else{if(!Array.isArray(e.open_revs))return n(M(En,"function_clause"));i=e.open_revs;for(var a=0;a<i.length;a++){var s=i[a];if("string"!=typeof s||!/^\d+-/.test(s))return n(M(Ln))}r()}}),it.prototype.getAttachment=s("getAttachment",function(t,e,n,r){var i=this;n instanceof Function&&(r=n,n={}),this._get(t,n,function(o,a){return o?r(o):a.doc._attachments&&a.doc._attachments[e]?(n.ctx=a.ctx,n.binary=!0,void i._getAttachment(t,e,a.doc._attachments[e],n,r)):r(M(wn))})}),it.prototype.allDocs=s("allDocs",function(t,e){if("function"==typeof t&&(e=t,t={}),t.skip=void 0!==t.skip?t.skip:0,t.start_key&&(t.startkey=t.start_key),t.end_key&&(t.endkey=t.end_key),"keys"in t){if(!Array.isArray(t.keys))return e(new TypeError("options.keys must be an array"));var n=["startkey","endkey","key"].filter(function(e){return e in t})[0];if(n)return void e(M(Tn,"Query parameter `"+n+"` is not compatible with multi-get"));if(!k(this))return function(t,e,n){var r="limit"in e?e.keys.slice(e.skip,e.limit+e.skip):e.skip>0?e.keys.slice(e.skip):e.keys;if(e.descending&&r.reverse(),!r.length)return t._allDocs({limit:0},n);var i={offset:e.skip};return fn.all(r.map(function(n){var r=vn({key:n,deleted:"ok"},e);return["limit","skip","keys"].forEach(function(t){delete r[t]}),new fn(function(e,o){t._allDocs(r,function(t,r){if(t)return o(t);i.total_rows=r.total_rows,e(r.rows[0]||{key:n,error:"not_found"})})})})).then(function(t){return i.rows=t,i})}(this,t,e)}return this._allDocs(t,e)}),it.prototype.changes=function(t,e){return"function"==typeof t&&(e=t,t={}),new K(this,t,e)},it.prototype.close=s("close",function(t){return this._closed=!0,this.emit("closed"),this._close(t)}),it.prototype.info=s("info",function(t){var e=this;this._info(function(n,r){if(n)return t(n);r.db_name=r.db_name||e.name,r.auto_compaction=!(!e.auto_compaction||k(e)),r.adapter=e.adapter,t(null,r)})}),it.prototype.id=s("id",function(t){return this._id(t)}),it.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},it.prototype.bulkDocs=s("bulkDocs",function(t,e,n){if("function"==typeof e&&(n=e,e={}),e=e||{},Array.isArray(t)&&(t={docs:t}),!t||!t.docs||!Array.isArray(t.docs))return n(M(yn));for(var r=0;r<t.docs.length;++r)if("object"!=typeof t.docs[r]||Array.isArray(t.docs[r]))return n(M(Cn));var i;if(t.docs.forEach(function(t){t._attachments&&Object.keys(t._attachments).forEach(function(e){i=i||function(t){return"_"===t.charAt(0)&&t+" is not a valid attachment name, attachment names cannot start with '_'"}(e),t._attachments[e].content_type||w("warn","Attachment",e,"on document",t._id,"is missing content_type")})}),i)return n(M(kn,i));"new_edits"in e||(e.new_edits=!("new_edits"in t)||t.new_edits);var o=this;e.new_edits||k(o)||t.docs.sort(rt),function(t){for(var e=0;e<t.length;e++){var n=t[e];if(n._deleted)delete n._attachments;else if(n._attachments)for(var r=Object.keys(n._attachments),i=0;i<r.length;i++){var o=r[i];n._attachments[o]=f(n._attachments[o],["data","digest","content_type","length","revpos","stub"])}}}(t.docs);var a=t.docs.map(function(t){return t._id});return this._bulkDocs(t,e,function(t,r){if(t)return n(t);if(e.new_edits||(r=r.filter(function(t){return t.error})),!k(o))for(var i=0,s=r.length;i<s;i++)r[i].id=r[i].id||a[i];n(null,r)})}),it.prototype.registerDependentDatabase=s("registerDependentDatabase",function(t,e){var n=new this.constructor(t,this.__opts);O(this,"_local/_pouch_dependentDbs",function(e){return e.dependentDbs=e.dependentDbs||{},!e.dependentDbs[t]&&(e.dependentDbs[t]=!0,e)}).then(function(){e(null,{db:n})}).catch(e)}),it.prototype.destroy=s("destroy",function(t,e){function n(){r._destroy(t,function(t,n){if(t)return e(t);r._destroyed=!0,r.emit("destroyed"),e(null,n||{ok:!0})})}"function"==typeof t&&(e=t,t={});var r=this,i=!("use_prefix"in r)||r.use_prefix;if(k(r))return n();r.get("_local/_pouch_dependentDbs",function(t,o){if(t)return 404!==t.status?e(t):n();var a=r.constructor,s=Object.keys(o.dependentDbs).map(function(t){var e=i?t.replace(new RegExp("^"+a.prefix),""):t;return new a(e,r.__opts).destroy()});fn.all(s).then(n,e)})}),ot.prototype.execute=function(){var t;if(this.failed)for(;t=this.queue.shift();)t(this.failed);else for(;t=this.queue.shift();)t()},ot.prototype.fail=function(t){this.failed=t,this.execute()},ot.prototype.ready=function(t){this.isReady=!0,this.db=t,this.execute()},ot.prototype.addTask=function(t){this.queue.push(t),this.failed&&this.execute()},sn(at,it),at.adapters={},at.preferredAdapters=[],at.prefix="_pouch_";var zn=new an.EventEmitter;!function(t){Object.keys(an.EventEmitter.prototype).forEach(function(e){"function"==typeof an.EventEmitter.prototype[e]&&(t[e]=zn[e].bind(zn))});var e=t._destructionListeners=new en;t.on("ref",function(t){e.has(t.name)||e.set(t.name,[]),e.get(t.name).push(t)}),t.on("unref",function(t){if(e.has(t.name)){var n=e.get(t.name),r=n.indexOf(t);r<0||(n.splice(r,1),n.length>1?e.set(t.name,n):e.delete(t.name))}}),t.on("destroyed",function(t){if(e.has(t)){var n=e.get(t);e.delete(t),n.forEach(function(t){t.emit("destroyed",!0)})}})}(at),at.adapter=function(t,e,n){e.valid()&&(at.adapters[t]=e,n&&at.preferredAdapters.push(t))},at.plugin=function(t){if("function"==typeof t)t(at);else{if("object"!=typeof t||0===Object.keys(t).length)throw new Error('Invalid plugin: got "'+t+'", expected an object or a function');Object.keys(t).forEach(function(e){at.prototype[e]=t[e]})}return this.__defaults&&(at.__defaults=vn({},this.__defaults)),at},at.defaults=function(t){function e(t,n){if(!(this instanceof e))return new e(t,n);n=n||{},t&&"object"==typeof t&&(t=(n=t).name,delete n.name),n=vn({},e.__defaults,n),at.call(this,t,n)}return sn(e,at),e.preferredAdapters=at.preferredAdapters.slice(),Object.keys(at).forEach(function(t){t in e||(e[t]=at[t])}),e.__defaults=vn({},this.__defaults,t),e};var Un=["$or","$nor","$not"],Vn=-324,Bn=3,Hn="",qn={$elemMatch:function(t,e,n,r){return!!Array.isArray(r)&&0!==r.length&&r.some("object"==typeof r[0]?function(t){return yt(t,e,Object.keys(e))}:function(r){return wt(e,t,n,r)})},$allMatch:function(t,e,n,r){return!!Array.isArray(r)&&0!==r.length&&r.every("object"==typeof r[0]?function(t){return yt(t,e,Object.keys(e))}:function(r){return wt(e,t,n,r)})},$eq:function(t,e,n,r){return xt(r)&&0===ft(r,e)},$gte:function(t,e,n,r){return xt(r)&&ft(r,e)>=0},$gt:function(t,e,n,r){return xt(r)&&ft(r,e)>0},$lte:function(t,e,n,r){return xt(r)&&ft(r,e)<=0},$lt:function(t,e,n,r){return xt(r)&&ft(r,e)<0},$exists:function(t,e,n,r){return e?xt(r):!xt(r)},$mod:function(t,e,n,r){return bt(r)&&function(t,e){var n=e[0],r=e[1];if(0===n)throw new Error("Bad divisor, cannot divide by zero");if(parseInt(n,10)!==n)throw new Error("Divisor is not an integer");if(parseInt(r,10)!==r)throw new Error("Modulus is not an integer");return parseInt(t,10)===t&&t%n===r}(r,e)},$ne:function(t,e,n,r){return e.every(function(t){return 0!==ft(r,t)})},$in:function(t,e,n,r){return bt(r)&&_t(r,e)},$nin:function(t,e,n,r){return bt(r)&&!_t(r,e)},$size:function(t,e,n,r){return bt(r)&&function(t,e){return r.length===e}(0,e)},$all:function(t,e,n,r){return Array.isArray(r)&&function(t,e){return e.every(function(e){return t.indexOf(e)>-1})}(r,e)},$regex:function(t,e,n,r){return bt(r)&&function(t,e){return new RegExp(e).test(t)}(r,e)},$type:function(t,e,n,r){return function(t,e){switch(e){case"null":return null===t;case"boolean":return"boolean"==typeof t;case"number":return"number"==typeof t;case"string":return"string"==typeof t;case"array":return t instanceof Array;case"object":return"[object Object]"==={}.toString.call(t)}throw new Error(e+" not supported as a type.Please use one of object, string, array, number, boolean or null.")}(r,e)}};at.plugin(function(t){t.debug=cn;var e={};t.on("debug",function(t){var n=t[0],r=t.slice(1);e[n]||(e[n]=cn("pouchdb:"+n)),e[n].apply(null,r)})}),at.plugin(function(t){t._changesFilterPlugin={validate:Mt,normalize:Et,shouldFilter:St,filter:Tt}}),at.version="6.3.4";var Gn,Wn=At(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),Yn=At(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),Xn=function(t){return atob(t)},$n=function(t){return btoa(t)},Qn=n.setImmediate||n.setTimeout,Jn=32768,Zn=5,Kn="document-store",tr="by-sequence",er="attach-store",nr="attach-seq-store",rr="meta-store",ir="local-store",or="detect-blob-support",ar=new y,sr=!1,ur=[],cr=new en,lr=new en;ie.valid=function(){return!("undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform))&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var hr=7,fr=se("document-store"),dr=se("by-sequence"),pr=se("attach-store"),mr=se("local-store"),gr=se("metadata-store"),vr=se("attach-seq-store"),yr=new en,wr=new y,br=1,xr="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+dr+" (seq, deleted)",_r="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+dr+" (doc_id, rev)",Mr="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+fr+" (winningseq)",Er="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+vr+" (seq)",Sr="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+vr+" (digest, seq)",Tr=dr+".seq = "+fr+".winningseq",Ar=dr+".seq AS seq, "+dr+".deleted AS deleted, "+dr+".json AS data, "+dr+".rev AS rev, "+fr+".json AS metadata";ge.valid=function(){return"function"==typeof openDatabase&&function(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent))return!0;var t=v(),e="_pouch__websqldb_valid_"+navigator.userAgent;if(t&&localStorage[e])return"1"===localStorage[e];var n=function(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(t){return!1}}();return t&&(localStorage[e]=n?"1":"0"),n}()},ge.use_prefix=!0;var kr=function(){try{return new XMLHttpRequest,!0}catch(t){return!1}}(),Cr=function(){},Rr=25,Dr=50,Lr=5e3,Or=1e4,Pr={};Se.valid=function(){return!0},sn(Te,Error),sn(Ae,Error),sn(ke,Error);var Ir=w.bind(null,"log"),Nr=Array.isArray,Fr=JSON.parse;Ne.prototype.add=function(t){return this.promise=this.promise.catch(function(){}).then(function(){return t()}),this.promise},Ne.prototype.finish=function(){return this.promise};var jr={},zr=new Ne,Ur=50,Vr=function(t,e){return Pe(e)},Br=function(t,e){return e.length},Hr=function(t,e){return{sum:Pe(e),min:Math.min.apply(null,e),max:Math.max.apply(null,e),count:e.length,sumsqr:function(t){for(var e=0,n=0,r=t.length;n<r;n++){var i=t[n];e+=i*i}return e}(e)}},qr=function(t,e,n,r){function i(t,e,n){try{e(n)}catch(e){Ue(t,e)}}function o(t,e,n,r,i){try{return{output:e(n,r,i)}}catch(e){return Ue(t,e),{error:e}}}function a(t,e){var n=ft(t.key,e.key);return 0!==n?n:ft(t.value,e.value)}function s(t){var e=t.value;return e&&"object"==typeof e&&e._id||t.id}function u(t){return function(e){return t.include_docs&&t.attachments&&t.binary&&e.rows.forEach(function(t){var e=t.doc&&t.doc._attachments;e&&Object.keys(e).forEach(function(t){var n=e[t];e[t].data=Lt(n.data,n.content_type)})}),e}}function c(t,e,n,r){var i=e[t];void 0!==i&&(r&&(i=encodeURIComponent(JSON.stringify(i))),n.push(t+"="+i))}function l(t){if(void 0!==t){var e=Number(t);return isNaN(e)||e!==parseInt(t,10)?t:e}}function h(t,e){var n=t.descending?"endkey":"startkey",r=t.descending?"startkey":"endkey";if(void 0!==t[n]&&void 0!==t[r]&&ft(t[n],t[r])>0)throw new Te("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(e.reduce&&!1!==t.reduce){if(t.include_docs)throw new Te("{include_docs:true} is invalid for reduce");if(t.keys&&t.keys.length>1&&!t.group&&!t.group_level)throw new Te("Multi-key fetches for reduce views must use {group: true}")}["group_level","limit","skip"].forEach(function(e){var n=function(t){if(t){if("number"!=typeof t)return new Te('Invalid value for integer: "'+t+'"');if(t<0)return new Te('Invalid value for positive integer: "'+t+'"')}}(t[e]);if(n)throw n})}function f(t){return function(e){if(404===e.status)return t;throw e}}function d(t){var e="string"==typeof t?t:t.name,n=jr[e];return n||(n=jr[e]=new Ne),n}function p(t){return Re(d(t),function(){return function(t){function n(e,n){return function(){return function(t,e,n){return t.db.get("_local/lastSeq").catch(f({_id:"_local/lastSeq",seq:0})).then(function(r){var i=Le(e);return fn.all(i.map(function(n){return function(t,e,n){var r="_local/doc_"+t,i={_id:r,keys:[]},o=n.get(t),a=o[0],s=o[1];return function(){return 1===(t=s).length&&/^1-/.test(t[0].rev)?fn.resolve(i):e.db.get(r).catch(f(i));var t}().then(function(t){return function(t){return t.keys.length?e.db.allDocs({keys:t.keys,include_docs:!0}):fn.resolve({rows:[]})}(t).then(function(e){return function(t,e){for(var n=[],r=new tn,i=0,o=e.rows.length;i<o;i++){var s=e.rows[i].doc;if(s&&(n.push(s),r.add(s._id),s._deleted=!a.has(s._id),!s._deleted)){var u=a.get(s._id);"value"in u&&(s.value=u.value)}}var c=Le(a);return c.forEach(function(t){if(!r.has(t)){var e={_id:t},i=a.get(t);"value"in i&&(e.value=i.value),n.push(e)}}),t.keys=De(c.concat(t.keys)),n.push(t),n}(t,e)})})}(n,t,e)})).then(function(e){var i=T(e);return r.seq=n,i.push(r),t.db.bulkDocs({docs:i})})})}(t,e,n)}}function r(){return t.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:d,limit:Ur}).then(o)}function o(t){var e=t.results;if(e.length){var i=s(e);if(p.add(n(i,d)),!(e.length<Ur))return r()}}function s(e){for(var n=new en,r=0,o=e.length;r<o;r++){var s=e[r];if("_"!==s.doc._id[0]){c=[],(l=s.doc)._deleted||i(t.sourceDB,h,l),c.sort(a);var f=u(c);n.set(s.doc._id,[f,s.changes])}d=s.seq}return n}function u(t){for(var e,n=new en,r=0,i=t.length;r<i;r++){var o=t[r],a=[o.key,o.id];r>0&&0===ft(o.key,e)&&a.push(r),n.set(pt(a),o),e=o.key}return n}var c,l,h=e(t.mapFun,function(t,e){var n={id:l._id,key:dt(t)};void 0!==e&&null!==e&&(n.value=dt(e)),c.push(n)}),d=t.seq||0,p=new Ne;return r().then(function(){return p.finish()}).then(function(){t.seq=d})}(t)})()}function m(t,e,r){0===r.group_level&&delete r.group_level;var i=r.group||r.group_level,a=n(t.reduceFun),s=[],u=isNaN(r.group_level)?Number.POSITIVE_INFINITY:r.group_level;e.forEach(function(t){var e=s[s.length-1],n=i?t.key:null;if(i&&Array.isArray(n)&&(n=n.slice(0,u)),e&&0===ft(e.groupKey,n))return e.keys.push([t.key,t.id]),void e.values.push(t.value);s.push({keys:[[t.key,t.id]],values:[t.value],groupKey:n})}),e=[];for(var c=0,l=s.length;c<l;c++){var h=s[c],f=o(t.sourceDB,a,h.keys,h.values,!1);if(f.error&&f.error instanceof ke)throw f.error;e.push({value:f.error?null:f.output,key:h.groupKey})}return{rows:function(t,e,n){return n=n||0,"number"==typeof e?t.slice(n,e+n):n>0?t.slice(n):t}(e,r.limit,r.skip)}}function g(t,e){return Re(d(t),function(){return function(t,e){function n(e){return e.include_docs=!0,t.db.allDocs(e).then(function(t){return i=t.total_rows,t.rows.map(function(t){if("value"in t.doc&&"object"==typeof t.doc.value&&null!==t.doc.value){var e=Object.keys(t.doc.value).sort(),n=["id","key","value"];if(!(e<n||e>n))return t.doc.value}var r=function(t){for(var e=[],n=[],r=0;;){var i=t[r++];if("\0"!==i)switch(i){case"1":e.push(null);break;case"2":e.push("1"===t[r]),r++;break;case"3":var o=mt(t,r);e.push(o.num),r+=o.length;break;case"4":for(var a="";;){var s=t[r];if("\0"===s)break;a+=s,r++}a=a.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"\x01").replace(/\u0002\u0002/g,"\x02"),e.push(a);break;case"5":var u={element:[],index:e.length};e.push(u.element),n.push(u);break;case"6":var c={element:{},index:e.length};e.push(c.element),n.push(c);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+i)}else{if(1===e.length)return e.pop();gt(e,n)}}}(t.doc._id);return{key:r[0],id:r[1],value:"value"in t.doc?t.doc.value:null}})})}function r(n){var r;if(r=o?m(t,n,e):{total_rows:i,offset:a,rows:n},e.include_docs){var u=De(n.map(s));return t.sourceDB.allDocs({keys:u,include_docs:!0,conflicts:e.conflicts,attachments:e.attachments,binary:e.binary}).then(function(t){var e=new en;return t.rows.forEach(function(t){e.set(t.id,t.doc)}),n.forEach(function(t){var n=s(t),r=e.get(n);r&&(t.doc=r)}),r})}return r}var i,o=t.reduceFun&&!1!==e.reduce,a=e.skip||0;if(void 0===e.keys||e.keys.length||(e.limit=0,delete e.keys),void 0!==e.keys){var u=e.keys.map(function(t){return n({startkey:pt([t]),endkey:pt([t,{}])})});return fn.all(u).then(T).then(r)}var c,l,h={descending:e.descending};if("start_key"in e&&(c=e.start_key),"startkey"in e&&(c=e.startkey),"end_key"in e&&(l=e.end_key),"endkey"in e&&(l=e.endkey),void 0!==c&&(h.startkey=pt(e.descending?[c,{}]:[c])),void 0!==l){var f=!1!==e.inclusive_end;e.descending&&(f=!f),h.endkey=pt(f?[l,{}]:[l])}if(void 0!==e.key){var d=pt([e.key]),p=pt([e.key,{}]);h.descending?(h.endkey=d,h.startkey=p):(h.startkey=d,h.endkey=p)}return o||("number"==typeof e.limit&&(h.limit=e.limit),h.skip=a),n(h).then(r)}(t,e)})()}function v(e){return e.get("_local/"+t).then(function(t){var n=new en;Object.keys(t.views).forEach(function(t){var e=ze(t),r="_design/"+e[0],i=e[1],o=n.get(r);o||(o=new tn,n.set(r,o)),o.add(i)});var r={keys:Le(n),include_docs:!0};return e.allDocs(r).then(function(r){var i={};r.rows.forEach(function(e){var r=e.key.substring(8);n.get(e.key).forEach(function(n){var o=r+"/"+n;t.views[o]||(o=n);var a=Object.keys(t.views[o]),s=e.doc&&e.doc.views&&e.doc.views[n];a.forEach(function(t){i[t]=i[t]||s})})});var o=Object.keys(i).filter(function(t){return!i[t]}).map(function(t){return Re(d(t),function(){return new e.constructor(t,e.__opts).destroy()})()});return fn.all(o).then(function(){return{ok:!0}})})},f({ok:!0}))}function y(e,n,i){if("function"==typeof e._query)return function(t,e,n){return new fn(function(r,i){t._query(e,n,function(t,e){if(t)return i(t);r(e)})})}(e,n,i);if(k(e))return function(t,e,n){var r,i=[],o="GET";if(c("reduce",n,i),c("include_docs",n,i),c("attachments",n,i),c("limit",n,i),c("descending",n,i),c("group",n,i),c("group_level",n,i),c("skip",n,i),c("stale",n,i),c("conflicts",n,i),c("startkey",n,i,!0),c("start_key",n,i,!0),c("endkey",n,i,!0),c("end_key",n,i,!0),c("inclusive_end",n,i),c("key",n,i,!0),i=""===(i=i.join("&"))?"":"?"+i,void 0!==n.keys){var a="keys="+encodeURIComponent(JSON.stringify(n.keys));a.length+i.length+1<=2e3?i+=("?"===i[0]?"&":"?")+a:(o="POST","string"==typeof e?r={keys:n.keys}:e.keys=n.keys)}if("string"==typeof e){var s=ze(e);return t.request({method:o,url:"_design/"+s[0]+"/_view/"+s[1]+i,body:r}).then(function(t){return t.rows.forEach(function(t){if(t.value&&t.value.error&&"builtin_reduce_error"===t.value.error)throw new Error(t.reason)}),t}).then(u(n))}return r=r||{},Object.keys(e).forEach(function(t){r[t]=Array.isArray(e[t])?e[t]:e[t].toString()}),t.request({method:"POST",url:"_temp_view"+i,body:r}).then(u(n))}(e,n,i);if("string"!=typeof n)return h(i,n),zr.add(function(){return je(e,"temp_view/temp_view",n.map,n.reduce,!0,t).then(function(t){return function(t,e){return t.then(function(t){return e().then(function(){return t})},function(t){return e().then(function(){throw t})})}(p(t).then(function(){return g(t,i)}),function(){return t.db.destroy()})})}),zr.finish();var o=n,a=ze(o),s=a[1];return e.get("_design/"+a[0]).then(function(n){var a=n.views&&n.views[s];if(!a)throw new Ae("ddoc "+n._id+" has no view named "+s);return r(n,s),h(i,a),je(e,o,a.map,a.reduce,!1,t).then(function(t){return"ok"===i.stale||"update_after"===i.stale?("update_after"===i.stale&&un(function(){p(t)}),g(t,i)):p(t).then(function(){return g(t,i)})})})}return{query:function(t,e,n){var r=this;"function"==typeof e&&(n=e,e={}),e=e?function(t){return t.group_level=l(t.group_level),t.limit=l(t.limit),t.skip=l(t.skip),t}(e):{},"function"==typeof t&&(t={map:t});var i=fn.resolve().then(function(){return y(r,t,e)});return Ce(i,n),i},viewCleanup:on(function(t){var e=t.pop(),n=(function(){var t=this;return"function"==typeof t._viewCleanup?function(t){return new fn(function(e,n){t._viewCleanup(function(t,r){if(t)return n(t);e(r)})})}(t):k(t)?function(t){return t.request({method:"POST",url:"_view_cleanup"})}(t):v(t)}).apply(this,t);return"function"==typeof e&&Ce(n,e),n})}}("mrviews",function(t,e){if("function"==typeof t&&2===t.length){var n=t;return function(t){return n(t,e)}}return Ie(t.toString(),e)},function(t){var e=t.toString();return function(t){if(/^_sum/.test(t))return Vr;if(/^_count/.test(t))return Br;if(/^_stats/.test(t))return Hr;if(/^_/.test(t))throw new Error(t+" is not a supported reduce function.")}(e)||Ie(e)},function(t,e){var n=t.views&&t.views[e];if("string"!=typeof n.map)throw new Ae("ddoc "+t._id+" has no string view named "+e+", instead found object of type: "+typeof n.map)}),Gr={query:function(t,e,n){return qr.query.call(this,t,e,n)},viewCleanup:function(t){return qr.viewCleanup.call(this,t)}},Wr=1,Yr="pouchdb",Xr=5;Ge.prototype.writeCheckpoint=function(t,e){var n=this;return this.updateTarget(t,e).then(function(){return n.updateSource(t,e)})},Ge.prototype.updateTarget=function(t,e){return this.opts.writeTargetCheckpoint?qe(this.target,this.id,t,e,this.returnValue):fn.resolve(!0)},Ge.prototype.updateSource=function(t,e){if(this.opts.writeSourceCheckpoint){var n=this;return this.readOnlySource?fn.resolve(!0):qe(this.src,this.id,t,e,this.returnValue).catch(function(t){if(Ye(t))return n.readOnlySource=!0,!0;throw t})}return fn.resolve(!0)};var $r={undefined:function(t,e){return 0===ft(t.last_seq,e.last_seq)?e.last_seq:0},1:function(t,e){return function(t,e){return t.session_id===e.session_id?{last_seq:t.last_seq,history:t.history}:function t(e,n){var r=e[0],i=e.slice(1),o=n[0],a=n.slice(1);return r&&0!==n.length?We(r.session_id,n)?{last_seq:r.last_seq,history:e}:We(o.session_id,i)?{last_seq:o.last_seq,history:a}:t(i,a):{last_seq:0,history:[]}}(t.history,e.history)}(e,t).last_seq}};Ge.prototype.getCheckpoint=function(){var t=this;return t.target.get(t.id).then(function(e){return t.readOnlySource?fn.resolve(e.last_seq):t.src.get(t.id).then(function(t){return e.version!==t.version?0:(n=e.version?e.version.toString():"undefined")in $r?$r[n](e,t):0;var n},function(n){if(404===n.status&&e.last_seq)return t.src.put({_id:t.id,last_seq:0}).then(function(){return 0},function(n){return Ye(n)?(t.readOnlySource=!0,e.last_seq):0});throw n})}).catch(function(t){if(404!==t.status)throw t;return 0})};var Qr=0;sn($e,an.EventEmitter),$e.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},$e.prototype.ready=function(t,e){function n(){r.cancel()}var r=this;r._readyCalled||(r._readyCalled=!0,t.once("destroyed",n),e.once("destroyed",n),r.once("complete",function(){t.removeListener("destroyed",n),e.removeListener("destroyed",n)}))},sn(Ke,an.EventEmitter),Ke.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},at.plugin(function(t){t.adapter("idb",ie,!0)}).plugin(function(t){t.adapter("websql",ge,!0)}).plugin(function(t){t.adapter("http",Se,!1),t.adapter("https",Se,!1)}).plugin(Gr).plugin(function(t){t.replicate=Je,t.sync=Ze,Object.defineProperty(t.prototype,"replicate",{get:function(){var t=this;return{from:function(e,n,r){return t.constructor.replicate(e,t,n,r)},to:function(e,n,r){return t.constructor.replicate(t,e,n,r)}}}}),t.prototype.sync=function(t,e,n){return this.constructor.sync(this,t,e,n)}}),e.exports=at}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,11:11,16:16,2:2,4:4,5:5,6:6,7:7}]},{},[17])(17)}),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ML=e():t.ML=e()}(this,function(){var e=Number.MAX_VALUE,t=Number.MIN_VALUE,n=Math.tanh,o=Math.exp,s=Math.ceil,r=Math.log,c=Math.pow,u=Math.abs,a=Number.EPSILON,M=Math.max,v=Math.min,g=Math.floor,m=Number.isInteger,R=Math.sqrt;return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=103)}([function(t){"use strict";function e(t,e){for(var n=0,r=0;r<t.length;r++)n+=(t[r]-e[r])*(t[r]-e[r]);return n}function n(t,n){return R(e(t,n))}t.exports=n,n.squared=e},function(t,e,n){"use strict";t.exports=e=n(105),e.getEquallySpacedData=n(107).getEquallySpacedData,e.SNV=n(108).SNV},function(t,e,n){"use strict";e.array=n(52),e.matrix=n(106)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(125);Object.defineProperty(e,"maybeToPrecision",{enumerable:!0,get:function(){return r(i).default}});var o=n(126);Object.defineProperty(e,"checkArrayLength",{enumerable:!0,get:function(){return r(o).default}});class a{constructor(){if(new.target===a)throw new Error("BaseRegression must be subclassed")}predict(t){if("number"==typeof t)return this._predict(t);if(Array.isArray(t)){for(var e=Array(t.length),n=0;n<t.length;n++)e[n]=this._predict(t[n]);return e}throw new TypeError("x must be a number or array")}_predict(){throw new Error("_predict must be implemented")}train(){}toString(){return""}toLaTeX(){return""}score(t,e){if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)throw new Error("x and y must be arrays of the same length");for(var n=t.length,r=Array(n),i=0;i<n;i++)r[i]=this._predict(t[i]);for(var o=0,a=0,s=0,u=0,c=0,l=0,h=0,f=0;f<n;f++)o+=r[f],a+=e[f],c+=r[f]*r[f],l+=e[f]*e[f],h+=r[f]*e[f],0!==e[f]&&(s+=(e[f]-r[f])*(e[f]-r[f])/e[f]),u=(e[f]-r[f])*(e[f]-r[f]);var d=(n*h-o*a)/R((n*c-o*o)*(n*l-a*a));return{r:d,r2:d*d,chi2:s,rmsd:u*u/n}}}e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n(104);var r=n(32),i=r&&r.__esModule?r:{default:r},o=n(23);class a extends((0,i.default)(Array)){constructor(t,e){var n;if(1===arguments.length&&"number"==typeof t)return Array(t);if(a.isMatrix(t))return t.clone();if(m(t)&&0<t){if(super(t),!(m(e)&&0<e))throw new TypeError("nColumns must be a positive integer");for(n=0;n<t;n++)this[n]=Array(e)}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");var r=t;if(t=r.length,"number"!=typeof(e=r[0].length)||0===e)throw new TypeError("Data must be a 2D array with at least one element");for(super(t),n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");this[n]=[].concat(r[n])}}return this.rows=t,this.columns=e,this}set(t,e,n){return this[t][e]=n,this}get(t,e){return this[t][e]}clone(){for(var t=new this.constructor[Symbol.species](this.rows,this.columns),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(e,n,this.get(e,n));return t}removeRow(t){if((0,o.checkRowIndex)(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),(0,o.checkRowIndex)(this,t,!0),e=(0,o.checkRowVector)(this,e,!0),this.splice(t,0,e),this.rows+=1,this}removeColumn(t){if((0,o.checkColumnIndex)(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var e=0;e<this.rows;e++)this[e].splice(t,1);return this.columns-=1,this}addColumn(t,e){"undefined"==typeof e&&(e=t,t=this.columns),(0,o.checkColumnIndex)(this,t,!0),e=(0,o.checkColumnVector)(this,e);for(var n=0;n<this.rows;n++)this[n].splice(t,0,e[n]);return this.columns+=1,this}}e.default=a},function(t,e,n){"use strict";n(193);var r=n(69),i=n(24);class o extends(r(Array)){constructor(t,e){var n;if(1===arguments.length&&"number"==typeof t)return Array(t);if(o.isMatrix(t))return t.clone();if(m(t)&&0<t){if(super(t),!(m(e)&&0<e))throw new TypeError("nColumns must be a positive integer");for(n=0;n<t;n++)this[n]=Array(e)}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");var r=t;if(t=r.length,"number"!=typeof(e=r[0].length)||0===e)throw new TypeError("Data must be a 2D array with at least one element");for(super(t),n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");this[n]=[].concat(r[n])}}return this.rows=t,this.columns=e,this}set(t,e,n){return this[t][e]=n,this}get(t,e){return this[t][e]}clone(){for(var t=new this.constructor[Symbol.species](this.rows,this.columns),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(e,n,this.get(e,n));return t}removeRow(t){if(i.checkRowIndex(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),i.checkRowIndex(this,t,!0),e=i.checkRowVector(this,e,!0),this.splice(t,0,e),this.rows+=1,this}removeColumn(t){if(i.checkColumnIndex(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var e=0;e<this.rows;e++)this[e].splice(t,1);return this.columns-=1,this}addColumn(t,e){"undefined"==typeof e&&(e=t,t=this.columns),i.checkColumnIndex(this,t,!0),e=i.checkColumnVector(this,e);for(var n=0;n<this.rows;n++)this[n].splice(t,0,e[n]);return this.columns+=1,this}}e.Matrix=o,o.abstractMatrix=r},function(t,e,n){"use strict";n(211);var r=n(73),i=n(25);class o extends(r(Array)){constructor(t,e){var n;if(1===arguments.length&&"number"==typeof t)return Array(t);if(o.isMatrix(t))return t.clone();if(m(t)&&0<t){if(super(t),!(m(e)&&0<e))throw new TypeError("nColumns must be a positive integer");for(n=0;n<t;n++)this[n]=Array(e)}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");var r=t;if(t=r.length,"number"!=typeof(e=r[0].length)||0===e)throw new TypeError("Data must be a 2D array with at least one element");for(super(t),n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");this[n]=[].concat(r[n])}}return this.rows=t,this.columns=e,this}set(t,e,n){return this[t][e]=n,this}get(t,e){return this[t][e]}clone(){for(var t=new this.constructor[Symbol.species](this.rows,this.columns),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(e,n,this.get(e,n));return t}removeRow(t){if(i.checkRowIndex(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),i.checkRowIndex(this,t,!0),e=i.checkRowVector(this,e,!0),this.splice(t,0,e),this.rows+=1,this}removeColumn(t){if(i.checkColumnIndex(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var e=0;e<this.rows;e++)this[e].splice(t,1);return this.columns-=1,this}addColumn(t,e){"undefined"==typeof e&&(e=t,t=this.columns),i.checkColumnIndex(this,t,!0),e=i.checkColumnVector(this,e);for(var n=0;n<this.rows;n++)this[n].splice(t,0,e[n]);return this.columns+=1,this}}e.Matrix=o,o.abstractMatrix=r},function(t,e,n){"use strict";n(228);var r=n(76),i=n(26);class o extends(r(Array)){constructor(t,e){var n;if(1===arguments.length&&"number"==typeof t)return Array(t);if(o.isMatrix(t))return t.clone();if(m(t)&&0<t){if(super(t),!(m(e)&&0<e))throw new TypeError("nColumns must be a positive integer");for(n=0;n<t;n++)this[n]=Array(e)}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");var r=t;if(t=r.length,"number"!=typeof(e=r[0].length)||0===e)throw new TypeError("Data must be a 2D array with at least one element");for(super(t),n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");this[n]=[].concat(r[n])}}return this.rows=t,this.columns=e,this}set(t,e,n){return this[t][e]=n,this}get(t,e){return this[t][e]}clone(){for(var t=new this.constructor[Symbol.species](this.rows,this.columns),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(e,n,this.get(e,n));return t}removeRow(t){if(i.checkRowIndex(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),i.checkRowIndex(this,t,!0),e=i.checkRowVector(this,e,!0),this.splice(t,0,e),this.rows+=1,this}removeColumn(t){if(i.checkColumnIndex(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var e=0;e<this.rows;e++)this[e].splice(t,1);return this.columns-=1,this}addColumn(t,e){"undefined"==typeof e&&(e=t,t=this.columns),i.checkColumnIndex(this,t,!0),e=i.checkColumnVector(this,e);for(var n=0;n<this.rows;n++)this[n].splice(t,0,e[n]);return this.columns+=1,this}}e.Matrix=o,o.abstractMatrix=r},function(t,e,n){"use strict";n(241);var r=n(80),i=n(27);class o extends(r(Array)){constructor(t,e){var n;if(1===arguments.length&&"number"==typeof t)return Array(t);if(o.isMatrix(t))return t.clone();if(m(t)&&0<t){if(super(t),!(m(e)&&0<e))throw new TypeError("nColumns must be a positive integer");for(n=0;n<t;n++)this[n]=Array(e)}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");var r=t;if(t=r.length,"number"!=typeof(e=r[0].length)||0===e)throw new TypeError("Data must be a 2D array with at least one element");for(super(t),n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");this[n]=[].concat(r[n])}}return this.rows=t,this.columns=e,this}set(t,e,n){return this[t][e]=n,this}get(t,e){return this[t][e]}clone(){for(var t=new this.constructor[Symbol.species](this.rows,this.columns),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(e,n,this.get(e,n));return t}removeRow(t){if(i.checkRowIndex(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),i.checkRowIndex(this,t,!0),e=i.checkRowVector(this,e,!0),this.splice(t,0,e),this.rows+=1,this}removeColumn(t){if(i.checkColumnIndex(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var e=0;e<this.rows;e++)this[e].splice(t,1);return this.columns-=1,this}addColumn(t,e){"undefined"==typeof e&&(e=t,t=this.columns),i.checkColumnIndex(this,t,!0),e=i.checkColumnVector(this,e);for(var n=0;n<this.rows;n++)this[n].splice(t,0,e[n]);return this.columns+=1,this}}e.Matrix=o,o.abstractMatrix=r},function(t,e,n){"use strict";n(257);var r=n(83),i=n(28);class o extends(r(Array)){constructor(t,e){var n;if(1===arguments.length&&"number"==typeof t)return Array(t);if(o.isMatrix(t))return t.clone();if(m(t)&&0<t){if(super(t),!(m(e)&&0<e))throw new TypeError("nColumns must be a positive integer");for(n=0;n<t;n++)this[n]=Array(e)}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");var r=t;if(t=r.length,"number"!=typeof(e=r[0].length)||0===e)throw new TypeError("Data must be a 2D array with at least one element");for(super(t),n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");this[n]=[].concat(r[n])}}return this.rows=t,this.columns=e,this}set(t,e,n){return this[t][e]=n,this}get(t,e){return this[t][e]}clone(){for(var t=new this.constructor[Symbol.species](this.rows,this.columns),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(e,n,this.get(e,n));return t}removeRow(t){if(i.checkRowIndex(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),i.checkRowIndex(this,t,!0),e=i.checkRowVector(this,e,!0),this.splice(t,0,e),this.rows+=1,this}removeColumn(t){if(i.checkColumnIndex(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var e=0;e<this.rows;e++)this[e].splice(t,1);return this.columns-=1,this}addColumn(t,e){"undefined"==typeof e&&(e=t,t=this.columns),i.checkColumnIndex(this,t,!0),e=i.checkColumnVector(this,e);for(var n=0;n<this.rows;n++)this[n].splice(t,0,e[n]);return this.columns+=1,this}}e.Matrix=o,o.abstractMatrix=r},function(t,e,n){"use strict";n(277);var r=n(88),i=n(29);class o extends(r(Array)){constructor(t,e){var n;if(1===arguments.length&&"number"==typeof t)return Array(t);if(o.isMatrix(t))return t.clone();if(m(t)&&0<t){if(super(t),!(m(e)&&0<e))throw new TypeError("nColumns must be a positive integer");for(n=0;n<t;n++)this[n]=Array(e)}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");var r=t;if(t=r.length,"number"!=typeof(e=r[0].length)||0===e)throw new TypeError("Data must be a 2D array with at least one element");for(super(t),n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");this[n]=[].concat(r[n])}}return this.rows=t,this.columns=e,this}set(t,e,n){return this[t][e]=n,this}get(t,e){return this[t][e]}clone(){for(var t=new this.constructor[Symbol.species](this.rows,this.columns),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(e,n,this.get(e,n));return t}removeRow(t){if(i.checkRowIndex(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),i.checkRowIndex(this,t,!0),e=i.checkRowVector(this,e,!0),this.splice(t,0,e),this.rows+=1,this}removeColumn(t){if(i.checkColumnIndex(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var e=0;e<this.rows;e++)this[e].splice(t,1);return this.columns-=1,this}addColumn(t,e){"undefined"==typeof e&&(e=t,t=this.columns),i.checkColumnIndex(this,t,!0),e=i.checkColumnVector(this,e);for(var n=0;n<this.rows;n++)this[n].splice(t,0,e[n]);return this.columns+=1,this}}e.Matrix=o,o.abstractMatrix=r},function(t,e,n){"use strict";n(291);var r=n(91),i=n(30);class o extends(r(Array)){constructor(t,e){var n;if(1===arguments.length&&"number"==typeof t)return Array(t);if(o.isMatrix(t))return t.clone();if(m(t)&&0<t){if(super(t),!(m(e)&&0<e))throw new TypeError("nColumns must be a positive integer");for(n=0;n<t;n++)this[n]=Array(e)}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");var r=t;if(t=r.length,"number"!=typeof(e=r[0].length)||0===e)throw new TypeError("Data must be a 2D array with at least one element");for(super(t),n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");this[n]=[].concat(r[n])}}return this.rows=t,this.columns=e,this}set(t,e,n){return this[t][e]=n,this}get(t,e){return this[t][e]}clone(){for(var t=new this.constructor[Symbol.species](this.rows,this.columns),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(e,n,this.get(e,n));return t}removeRow(t){if(i.checkRowIndex(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),i.checkRowIndex(this,t,!0),e=i.checkRowVector(this,e,!0),this.splice(t,0,e),this.rows+=1,this}removeColumn(t){if(i.checkColumnIndex(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var e=0;e<this.rows;e++)this[e].splice(t,1);return this.columns-=1,this}addColumn(t,e){"undefined"==typeof e&&(e=t,t=this.columns),i.checkColumnIndex(this,t,!0),e=i.checkColumnVector(this,e);for(var n=0;n<this.rows;n++)this[n].splice(t,0,e[n]);return this.columns+=1,this}}e.Matrix=o,o.abstractMatrix=r},function(t,e,n){"use strict";n(322);var r=n(97),i=n(31);class o extends(r(Array)){constructor(t,e){var n;if(1===arguments.length&&"number"==typeof t)return Array(t);if(o.isMatrix(t))return t.clone();if(m(t)&&0<t){if(super(t),!(m(e)&&0<e))throw new TypeError("nColumns must be a positive integer");for(n=0;n<t;n++)this[n]=Array(e)}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");var r=t;if(t=r.length,"number"!=typeof(e=r[0].length)||0===e)throw new TypeError("Data must be a 2D array with at least one element");for(super(t),n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");this[n]=[].concat(r[n])}}return this.rows=t,this.columns=e,this}set(t,e,n){return this[t][e]=n,this}get(t,e){return this[t][e]}clone(){for(var t=new this.constructor[Symbol.species](this.rows,this.columns),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(e,n,this.get(e,n));return t}removeRow(t){if(i.checkRowIndex(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),i.checkRowIndex(this,t,!0),e=i.checkRowVector(this,e,!0),this.splice(t,0,e),this.rows+=1,this}removeColumn(t){if(i.checkColumnIndex(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var e=0;e<this.rows;e++)this[e].splice(t,1);return this.columns-=1,this}addColumn(t,e){"undefined"==typeof e&&(e=t,t=this.columns),i.checkColumnIndex(this,t,!0),e=i.checkColumnVector(this,e);for(var n=0;n<this.rows;n++)this[n].splice(t,0,e[n]);return this.columns+=1,this}}e.Matrix=o,o.abstractMatrix=r},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(4);Object.defineProperty(e,"default",{enumerable:!0,get:function(){return r(i).default}}),Object.defineProperty(e,"Matrix",{enumerable:!0,get:function(){return r(i).default}});var o=n(32);Object.defineProperty(e,"abstractMatrix",{enumerable:!0,get:function(){return r(o).default}});var a=n(116);Object.defineProperty(e,"solve",{enumerable:!0,get:function(){return a.solve}}),Object.defineProperty(e,"inverse",{enumerable:!0,get:function(){return a.inverse}});var s=n(51);Object.defineProperty(e,"SingularValueDecomposition",{enumerable:!0,get:function(){return r(s).default}}),Object.defineProperty(e,"SVD",{enumerable:!0,get:function(){return r(s).default}});var u=n(117);Object.defineProperty(e,"EigenvalueDecomposition",{enumerable:!0,get:function(){return r(u).default}}),Object.defineProperty(e,"EVD",{enumerable:!0,get:function(){return r(u).default}});var c=n(118);Object.defineProperty(e,"CholeskyDecomposition",{enumerable:!0,get:function(){return r(c).default}}),Object.defineProperty(e,"CHO",{enumerable:!0,get:function(){return r(c).default}});var l=n(33);Object.defineProperty(e,"LuDecomposition",{enumerable:!0,get:function(){return r(l).default}}),Object.defineProperty(e,"LU",{enumerable:!0,get:function(){return r(l).default}});var h=n(53);Object.defineProperty(e,"QrDecomposition",{enumerable:!0,get:function(){return r(h).default}}),Object.defineProperty(e,"QR",{enumerable:!0,get:function(){return r(h).default}})},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(32)),o=r(n(4));e.default=class extends((0,i.default)()){constructor(t,e,n){super(),this.matrix=t,this.rows=e,this.columns=n}static get[Symbol.species](){return o.default}}},function(t,e,n){"use strict";var r=n(69),i=n(5);t.exports=class extends(r()){constructor(t,e,n){super(),this.matrix=t,this.rows=e,this.columns=n}static get[Symbol.species](){return i.Matrix}}},function(t,e,n){"use strict";var r=n(73),i=n(6);t.exports=class extends(r()){constructor(t,e,n){super(),this.matrix=t,this.rows=e,this.columns=n}static get[Symbol.species](){return i.Matrix}}},function(t,e,n){"use strict";var r=n(76),i=n(7);t.exports=class extends(r()){constructor(t,e,n){super(),this.matrix=t,this.rows=e,this.columns=n}static get[Symbol.species](){return i.Matrix}}},function(t,e,n){"use strict";var r=n(80),i=n(8);t.exports=class extends(r()){constructor(t,e,n){super(),this.matrix=t,this.rows=e,this.columns=n}static get[Symbol.species](){return i.Matrix}}},function(t,e,n){"use strict";var r=n(83),i=n(9);t.exports=class extends(r()){constructor(t,e,n){super(),this.matrix=t,this.rows=e,this.columns=n}static get[Symbol.species](){return i.Matrix}}},function(t,e,n){"use strict";var r=n(88),i=n(10);t.exports=class extends(r()){constructor(t,e,n){super(),this.matrix=t,this.rows=e,this.columns=n}static get[Symbol.species](){return i.Matrix}}},function(t,e,n){"use strict";var r=n(91),i=n(11);t.exports=class extends(r()){constructor(t,e,n){super(),this.matrix=t,this.rows=e,this.columns=n}static get[Symbol.species](){return i.Matrix}}},function(t,e,n){"use strict";var r=n(97),i=n(12);t.exports=class extends(r()){constructor(t,e,n){super(),this.matrix=t,this.rows=e,this.columns=n}static get[Symbol.species](){return i.Matrix}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.checkRowIndex=function(t,e,n){if(0>e||e>(n?t.rows:t.rows-1))throw new RangeError("Row index out of range")},e.checkColumnIndex=function(t,e,n){if(0>e||e>(n?t.columns:t.columns-1))throw new RangeError("Column index out of range")},e.checkRowVector=function(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e},e.checkColumnVector=function(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e},e.checkIndices=function(t,e,n){var r=e.some(e=>0>e||e>=t.rows),i=n.some(e=>0>e||e>=t.columns);if(r||i)throw new RangeError("Indices are out of range");if("object"!=typeof e||"object"!=typeof n)throw new TypeError("Unexpected type for row/column indices");return Array.isArray(e)||(e=Array.from(e)),Array.isArray(n)||(e=Array.from(n)),{row:e,column:n}},e.checkRange=function(t,e,n,r,i){if(5!==arguments.length)throw new TypeError("Invalid argument type");if(Array.from(arguments).slice(1).some(function(t){return"number"!=typeof t}))throw new TypeError("Invalid argument type");if(e>n||r>i||0>e||e>=t.rows||0>n||n>=t.rows||0>r||r>=t.columns||0>i||i>=t.columns)throw new RangeError("Submatrix indices are out of range")},e.getRange=function(t,e){for(var n=Array(e-t+1),r=0;r<n.length;r++)n[r]=t+r;return n},e.sumByRow=function(t){for(var e=i.default.zeros(t.rows,1),n=0;n<t.rows;++n)for(var r=0;r<t.columns;++r)e.set(n,0,e.get(n,0)+t.get(n,r));return e},e.sumByColumn=function(t){for(var e=i.default.zeros(1,t.columns),n=0;n<t.rows;++n)for(var r=0;r<t.columns;++r)e.set(0,r,e.get(0,r)+t.get(n,r));return e},e.sumAll=function(t){for(var e=0,n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)e+=t.get(n,r);return e};var r=n(4),i=r&&r.__esModule?r:{default:r}},function(t,e,n){"use strict";var r=n(5);e.checkRowIndex=function(t,e,n){if(0>e||e>(n?t.rows:t.rows-1))throw new RangeError("Row index out of range")},e.checkColumnIndex=function(t,e,n){if(0>e||e>(n?t.columns:t.columns-1))throw new RangeError("Column index out of range")},e.checkRowVector=function(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e},e.checkColumnVector=function(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e},e.checkIndices=function(t,e,n){var r=e.some(e=>0>e||e>=t.rows),i=n.some(e=>0>e||e>=t.columns);if(r||i)throw new RangeError("Indices are out of range");if("object"!=typeof e||"object"!=typeof n)throw new TypeError("Unexpected type for row/column indices");return Array.isArray(e)||(e=Array.from(e)),Array.isArray(n)||(e=Array.from(n)),{row:e,column:n}},e.checkRange=function(t,e,n,r,i){if(5!==arguments.length)throw new TypeError("Invalid argument type");if(Array.from(arguments).slice(1).some(function(t){return"number"!=typeof t}))throw new TypeError("Invalid argument type");if(e>n||r>i||0>e||e>=t.rows||0>n||n>=t.rows||0>r||r>=t.columns||0>i||i>=t.columns)throw new RangeError("Submatrix indices are out of range")},e.getRange=function(t,e){for(var n=Array(e-t+1),r=0;r<n.length;r++)n[r]=t+r;return n},e.sumByRow=function(t){for(var e=r.Matrix.zeros(t.rows,1),n=0;n<t.rows;++n)for(var i=0;i<t.columns;++i)e.set(n,0,e.get(n,0)+t.get(n,i));return e},e.sumByColumn=function(t){for(var e=r.Matrix.zeros(1,t.columns),n=0;n<t.rows;++n)for(var i=0;i<t.columns;++i)e.set(0,i,e.get(0,i)+t.get(n,i));return e},e.sumAll=function(t){for(var e=0,n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)e+=t.get(n,r);return e}},function(t,e,n){"use strict";var r=n(6);e.checkRowIndex=function(t,e,n){if(0>e||e>(n?t.rows:t.rows-1))throw new RangeError("Row index out of range")},e.checkColumnIndex=function(t,e,n){if(0>e||e>(n?t.columns:t.columns-1))throw new RangeError("Column index out of range")},e.checkRowVector=function(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e},e.checkColumnVector=function(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e},e.checkIndices=function(t,e,n){var r=e.some(e=>0>e||e>=t.rows),i=n.some(e=>0>e||e>=t.columns);if(r||i)throw new RangeError("Indices are out of range");if("object"!=typeof e||"object"!=typeof n)throw new TypeError("Unexpected type for row/column indices");return Array.isArray(e)||(e=Array.from(e)),Array.isArray(n)||(e=Array.from(n)),{row:e,column:n}},e.checkRange=function(t,e,n,r,i){if(5!==arguments.length)throw new TypeError("Invalid argument type");if(Array.from(arguments).slice(1).some(function(t){return"number"!=typeof t}))throw new TypeError("Invalid argument type");if(e>n||r>i||0>e||e>=t.rows||0>n||n>=t.rows||0>r||r>=t.columns||0>i||i>=t.columns)throw new RangeError("Submatrix indices are out of range")},e.getRange=function(t,e){for(var n=Array(e-t+1),r=0;r<n.length;r++)n[r]=t+r;return n},e.sumByRow=function(t){for(var e=r.Matrix.zeros(t.rows,1),n=0;n<t.rows;++n)for(var i=0;i<t.columns;++i)e.set(n,0,e.get(n,0)+t.get(n,i));return e},e.sumByColumn=function(t){for(var e=r.Matrix.zeros(1,t.columns),n=0;n<t.rows;++n)for(var i=0;i<t.columns;++i)e.set(0,i,e.get(0,i)+t.get(n,i));return e},e.sumAll=function(t){for(var e=0,n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)e+=t.get(n,r);return e}},function(t,e,n){"use strict";var r=n(7);e.checkRowIndex=function(t,e,n){if(0>e||e>(n?t.rows:t.rows-1))throw new RangeError("Row index out of range")},e.checkColumnIndex=function(t,e,n){if(0>e||e>(n?t.columns:t.columns-1))throw new RangeError("Column index out of range")},e.checkRowVector=function(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e},e.checkColumnVector=function(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e},e.checkIndices=function(t,e,n){var r=e.some(e=>0>e||e>=t.rows),i=n.some(e=>0>e||e>=t.columns);if(r||i)throw new RangeError("Indices are out of range");if("object"!=typeof e||"object"!=typeof n)throw new TypeError("Unexpected type for row/column indices");return Array.isArray(e)||(e=Array.from(e)),Array.isArray(n)||(e=Array.from(n)),{row:e,column:n}},e.checkRange=function(t,e,n,r,i){if(5!==arguments.length)throw new TypeError("Invalid argument type");if(Array.from(arguments).slice(1).some(function(t){return"number"!=typeof t}))throw new TypeError("Invalid argument type");if(e>n||r>i||0>e||e>=t.rows||0>n||n>=t.rows||0>r||r>=t.columns||0>i||i>=t.columns)throw new RangeError("Submatrix indices are out of range")},e.getRange=function(t,e){for(var n=Array(e-t+1),r=0;r<n.length;r++)n[r]=t+r;return n},e.sumByRow=function(t){for(var e=r.Matrix.zeros(t.rows,1),n=0;n<t.rows;++n)for(var i=0;i<t.columns;++i)e.set(n,0,e.get(n,0)+t.get(n,i));return e},e.sumByColumn=function(t){for(var e=r.Matrix.zeros(1,t.columns),n=0;n<t.rows;++n)for(var i=0;i<t.columns;++i)e.set(0,i,e.get(0,i)+t.get(n,i));return e},e.sumAll=function(t){for(var e=0,n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)e+=t.get(n,r);return e}},function(t,e,n){"use strict";var r=n(8);e.checkRowIndex=function(t,e,n){if(0>e||e>(n?t.rows:t.rows-1))throw new RangeError("Row index out of range")},e.checkColumnIndex=function(t,e,n){if(0>e||e>(n?t.columns:t.columns-1))throw new RangeError("Column index out of range")},e.checkRowVector=function(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e},e.checkColumnVector=function(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e},e.checkIndices=function(t,e,n){var r=e.some(e=>0>e||e>=t.rows),i=n.some(e=>0>e||e>=t.columns);if(r||i)throw new RangeError("Indices are out of range");if("object"!=typeof e||"object"!=typeof n)throw new TypeError("Unexpected type for row/column indices");return Array.isArray(e)||(e=Array.from(e)),Array.isArray(n)||(e=Array.from(n)),{row:e,column:n}},e.checkRange=function(t,e,n,r,i){if(5!==arguments.length)throw new TypeError("Invalid argument type");if(Array.from(arguments).slice(1).some(function(t){return"number"!=typeof t}))throw new TypeError("Invalid argument type");if(e>n||r>i||0>e||e>=t.rows||0>n||n>=t.rows||0>r||r>=t.columns||0>i||i>=t.columns)throw new RangeError("Submatrix indices are out of range")},e.getRange=function(t,e){for(var n=Array(e-t+1),r=0;r<n.length;r++)n[r]=t+r;return n},e.sumByRow=function(t){for(var e=r.Matrix.zeros(t.rows,1),n=0;n<t.rows;++n)for(var i=0;i<t.columns;++i)e.set(n,0,e.get(n,0)+t.get(n,i));return e},e.sumByColumn=function(t){for(var e=r.Matrix.zeros(1,t.columns),n=0;n<t.rows;++n)for(var i=0;i<t.columns;++i)e.set(0,i,e.get(0,i)+t.get(n,i));return e},e.sumAll=function(t){for(var e=0,n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)e+=t.get(n,r);return e}},function(t,e,n){"use strict";var r=n(9);e.checkRowIndex=function(t,e,n){if(0>e||e>(n?t.rows:t.rows-1))throw new RangeError("Row index out of range")},e.checkColumnIndex=function(t,e,n){if(0>e||e>(n?t.columns:t.columns-1))throw new RangeError("Column index out of range")},e.checkRowVector=function(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e},e.checkColumnVector=function(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e},e.checkIndices=function(t,e,n){var r=e.some(e=>0>e||e>=t.rows),i=n.some(e=>0>e||e>=t.columns);if(r||i)throw new RangeError("Indices are out of range");if("object"!=typeof e||"object"!=typeof n)throw new TypeError("Unexpected type for row/column indices");return Array.isArray(e)||(e=Array.from(e)),Array.isArray(n)||(e=Array.from(n)),{row:e,column:n}},e.checkRange=function(t,e,n,r,i){if(5!==arguments.length)throw new TypeError("Invalid argument type");if(Array.from(arguments).slice(1).some(function(t){return"number"!=typeof t}))throw new TypeError("Invalid argument type");if(e>n||r>i||0>e||e>=t.rows||0>n||n>=t.rows||0>r||r>=t.columns||0>i||i>=t.columns)throw new RangeError("Submatrix indices are out of range")},e.getRange=function(t,e){for(var n=Array(e-t+1),r=0;r<n.length;r++)n[r]=t+r;return n},e.sumByRow=function(t){for(var e=r.Matrix.zeros(t.rows,1),n=0;n<t.rows;++n)for(var i=0;i<t.columns;++i)e.set(n,0,e.get(n,0)+t.get(n,i));return e},e.sumByColumn=function(t){for(var e=r.Matrix.zeros(1,t.columns),n=0;n<t.rows;++n)for(var i=0;i<t.columns;++i)e.set(0,i,e.get(0,i)+t.get(n,i));return e},e.sumAll=function(t){for(var e=0,n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)e+=t.get(n,r);return e}},function(t,e,n){"use strict";var r=n(10);e.checkRowIndex=function(t,e,n){if(0>e||e>(n?t.rows:t.rows-1))throw new RangeError("Row index out of range")},e.checkColumnIndex=function(t,e,n){if(0>e||e>(n?t.columns:t.columns-1))throw new RangeError("Column index out of range")},e.checkRowVector=function(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e},e.checkColumnVector=function(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e},e.checkIndices=function(t,e,n){var r=e.some(e=>0>e||e>=t.rows),i=n.some(e=>0>e||e>=t.columns);if(r||i)throw new RangeError("Indices are out of range");if("object"!=typeof e||"object"!=typeof n)throw new TypeError("Unexpected type for row/column indices");return Array.isArray(e)||(e=Array.from(e)),Array.isArray(n)||(e=Array.from(n)),{row:e,column:n}},e.checkRange=function(t,e,n,r,i){if(5!==arguments.length)throw new TypeError("Invalid argument type");if(Array.from(arguments).slice(1).some(function(t){return"number"!=typeof t}))throw new TypeError("Invalid argument type");if(e>n||r>i||0>e||e>=t.rows||0>n||n>=t.rows||0>r||r>=t.columns||0>i||i>=t.columns)throw new RangeError("Submatrix indices are out of range")},e.getRange=function(t,e){for(var n=Array(e-t+1),r=0;r<n.length;r++)n[r]=t+r;return n},e.sumByRow=function(t){for(var e=r.Matrix.zeros(t.rows,1),n=0;n<t.rows;++n)for(var i=0;i<t.columns;++i)e.set(n,0,e.get(n,0)+t.get(n,i));return e},e.sumByColumn=function(t){for(var e=r.Matrix.zeros(1,t.columns),n=0;n<t.rows;++n)for(var i=0;i<t.columns;++i)e.set(0,i,e.get(0,i)+t.get(n,i));return e},e.sumAll=function(t){for(var e=0,n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)e+=t.get(n,r);return e}},function(t,e,n){"use strict";var r=n(11);e.checkRowIndex=function(t,e,n){if(0>e||e>(n?t.rows:t.rows-1))throw new RangeError("Row index out of range")},e.checkColumnIndex=function(t,e,n){if(0>e||e>(n?t.columns:t.columns-1))throw new RangeError("Column index out of range")},e.checkRowVector=function(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e},e.checkColumnVector=function(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e},e.checkIndices=function(t,e,n){var r=e.some(e=>0>e||e>=t.rows),i=n.some(e=>0>e||e>=t.columns);if(r||i)throw new RangeError("Indices are out of range");if("object"!=typeof e||"object"!=typeof n)throw new TypeError("Unexpected type for row/column indices");return Array.isArray(e)||(e=Array.from(e)),Array.isArray(n)||(e=Array.from(n)),{row:e,column:n}},e.checkRange=function(t,e,n,r,i){if(5!==arguments.length)throw new TypeError("Invalid argument type");if(Array.from(arguments).slice(1).some(function(t){return"number"!=typeof t}))throw new TypeError("Invalid argument type");if(e>n||r>i||0>e||e>=t.rows||0>n||n>=t.rows||0>r||r>=t.columns||0>i||i>=t.columns)throw new RangeError("Submatrix indices are out of range")},e.getRange=function(t,e){for(var n=Array(e-t+1),r=0;r<n.length;r++)n[r]=t+r;return n},e.sumByRow=function(t){for(var e=r.Matrix.zeros(t.rows,1),n=0;n<t.rows;++n)for(var i=0;i<t.columns;++i)e.set(n,0,e.get(n,0)+t.get(n,i));return e},e.sumByColumn=function(t){for(var e=r.Matrix.zeros(1,t.columns),n=0;n<t.rows;++n)for(var i=0;i<t.columns;++i)e.set(0,i,e.get(0,i)+t.get(n,i));return e},e.sumAll=function(t){for(var e=0,n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)e+=t.get(n,r);return e}},function(t,e,n){"use strict";var r=n(12);e.checkRowIndex=function(t,e,n){if(0>e||e>(n?t.rows:t.rows-1))throw new RangeError("Row index out of range")},e.checkColumnIndex=function(t,e,n){if(0>e||e>(n?t.columns:t.columns-1))throw new RangeError("Column index out of range")},e.checkRowVector=function(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e},e.checkColumnVector=function(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e},e.checkIndices=function(t,e,n){var r=e.some(e=>0>e||e>=t.rows),i=n.some(e=>0>e||e>=t.columns);if(r||i)throw new RangeError("Indices are out of range");if("object"!=typeof e||"object"!=typeof n)throw new TypeError("Unexpected type for row/column indices");return Array.isArray(e)||(e=Array.from(e)),Array.isArray(n)||(e=Array.from(n)),{row:e,column:n}},e.checkRange=function(t,e,n,r,i){if(5!==arguments.length)throw new TypeError("Invalid argument type");if(Array.from(arguments).slice(1).some(function(t){return"number"!=typeof t}))throw new TypeError("Invalid argument type");if(e>n||r>i||0>e||e>=t.rows||0>n||n>=t.rows||0>r||r>=t.columns||0>i||i>=t.columns)throw new RangeError("Submatrix indices are out of range")},e.getRange=function(t,e){for(var n=Array(e-t+1),r=0;r<n.length;r++)n[r]=t+r;return n},e.sumByRow=function(t){for(var e=r.Matrix.zeros(t.rows,1),n=0;n<t.rows;++n)for(var i=0;i<t.columns;++i)e.set(n,0,e.get(n,0)+t.get(n,i));return e},e.sumByColumn=function(t){for(var e=r.Matrix.zeros(1,t.columns),n=0;n<t.rows;++n)for(var i=0;i<t.columns;++i)e.set(0,i,e.get(0,i)+t.get(n,i));return e},e.sumAll=function(t){for(var e=0,n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)e+=t.get(n,r);return e}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){function e(t,e){return t-e}function n(t,e){for(var n in e)t=t.replace(new RegExp("%"+n+"%","g"),e[n]);return t}void 0===t&&(t=Object);class r extends t{static get[Symbol.species](){return this}static from1DArray(t,e,n){if(t*e!==n.length)throw new RangeError("Data length does not match given dimensions");for(var r=new this(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)r.set(i,o,n[i*e+o]);return r}static rowVector(t){for(var e=new this(1,t.length),n=0;n<t.length;n++)e.set(0,n,t[n]);return e}static columnVector(t){for(var e=new this(t.length,1),n=0;n<t.length;n++)e.set(n,0,t[n]);return e}static empty(t,e){return new this(t,e)}static zeros(t,e){return this.empty(t,e).fill(0)}static ones(t,e){return this.empty(t,e).fill(1)}static rand(t,e,n){void 0===n&&(n=Math.random);for(var r=this.empty(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)r.set(i,o,n());return r}static randInt(t,e,n,r){void 0===n&&(n=1e3),void 0===r&&(r=Math.random);for(var i=this.empty(t,e),o=0;o<t;o++)for(var a,s=0;s<e;s++)a=g(r()*n),i.set(o,s,a);return i}static eye(t,e,n){void 0===e&&(e=t),void 0===n&&(n=1);for(var r=v(t,e),i=this.zeros(t,e),o=0;o<r;o++)i.set(o,o,n);return i}static diag(t,e,n){var r=t.length;void 0===e&&(e=r),void 0===n&&(n=e);for(var i=v(r,e,n),o=this.zeros(e,n),a=0;a<i;a++)o.set(a,a,t[a]);return o}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),o=0;o<n;o++)for(var a=0;a<r;a++)i.set(o,a,v(t.get(o,a),e.get(o,a)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),o=0;o<n;o++)for(var a=0;a<r;a++)i.set(o,a,M(t.get(o,a),e.get(o,a)));return i}static checkMatrix(t){return r.isMatrix(t)?t:new this(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=this.rows,n=this.columns,r=0;r<e;r++)for(var i=0;i<n;i++)t.call(this,r,i);return this}to1DArray(){for(var t=Array(this.size),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t[e*this.columns+n]=this.get(e,n);return t}to2DArray(){for(var t=Array(this.rows),e=0;e<this.rows;e++){t[e]=Array(this.columns);for(var n=0;n<this.columns;n++)t[e][n]=this.get(e,n)}return t}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t,e){t=t||1,e=e||1;for(var n=new this.constructor[Symbol.species](this.rows*t,this.columns*e),r=0;r<t;r++)for(var i=0;i<e;i++)n.setSubMatrix(this,this.rows*r,this.columns*i);return n}fill(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,t);return this}neg(){return this.mulS(-1)}getRow(t){c.checkRowIndex(this,t);for(var e=Array(this.columns),n=0;n<this.columns;n++)e[n]=this.get(t,n);return e}getRowVector(t){return this.constructor.rowVector(this.getRow(t))}setRow(t,e){c.checkRowIndex(this,t),e=c.checkRowVector(this,e);for(var n=0;n<this.columns;n++)this.set(t,n,e[n]);return this}swapRows(t,e){c.checkRowIndex(this,t),c.checkRowIndex(this,e);for(var n,r=0;r<this.columns;r++)n=this.get(t,r),this.set(t,r,this.get(e,r)),this.set(e,r,n);return this}getColumn(t){c.checkColumnIndex(this,t);for(var e=Array(this.rows),n=0;n<this.rows;n++)e[n]=this.get(n,t);return e}getColumnVector(t){return this.constructor.columnVector(this.getColumn(t))}setColumn(t,e){c.checkColumnIndex(this,t),e=c.checkColumnVector(this,e);for(var n=0;n<this.rows;n++)this.set(n,t,e[n]);return this}swapColumns(t,e){c.checkColumnIndex(this,t),c.checkColumnIndex(this,e);for(var n,r=0;r<this.rows;r++)n=this.get(r,t),this.set(r,t,this.get(r,e)),this.set(r,e,n);return this}addRowVector(t){t=c.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[n]);return this}subRowVector(t){t=c.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[n]);return this}mulRowVector(t){t=c.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[n]);return this}divRowVector(t){t=c.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[n]);return this}addColumnVector(t){t=c.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[e]);return this}subColumnVector(t){t=c.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[e]);return this}mulColumnVector(t){t=c.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[e]);return this}divColumnVector(t){t=c.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[e]);return this}mulRow(t,e){c.checkRowIndex(this,t);for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this}mulColumn(t,e){c.checkColumnIndex(this,t);for(var n=0;n<this.rows;n++)this.set(n,t,this.get(n,t)*e);return this}max(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)>t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}min(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)<t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}maxRow(t){c.checkRowIndex(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxRowIndex(t){c.checkRowIndex(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r),n[1]=r);return n}minRow(t){c.checkRowIndex(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minRowIndex(t){c.checkRowIndex(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r),n[1]=r);return n}maxColumn(t){c.checkColumnIndex(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t));return e}maxColumnIndex(t){c.checkColumnIndex(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t),n[0]=r);return n}minColumn(t){c.checkColumnIndex(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t));return e}minColumnIndex(t){c.checkColumnIndex(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t),n[0]=r);return n}diag(){for(var t=v(this.rows,this.columns),e=Array(t),n=0;n<t;n++)e[n]=this.get(n,n);return e}sum(t){return"row"===t?c.sumByRow(this):"column"===t?c.sumByColumn(this):c.sumAll(this)}mean(){return this.sum()/this.size}prod(){for(var t=1,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t*=this.get(e,n);return t}cumulativeSum(){for(var t=0,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t+=this.get(e,n),this.set(e,n,t);return this}dot(t){r.isMatrix(t)&&(t=t.to1DArray());var e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");for(var n=0,i=0;i<e.length;i++)n+=e[i]*t[i];return n}mmul(t){t=this.constructor.checkMatrix(t),this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var e=this.rows,n=this.columns,r=t.columns,i=new this.constructor[Symbol.species](e,r),o=Array(n),a=0;a<r;a++){for(var s=0;s<n;s++)o[s]=t.get(s,a);for(var u,c=0;c<e;c++){for(u=0,s=0;s<n;s++)u+=this.get(c,s)*o[s];i.set(c,a,u)}}return i}strassen2x2(t){var e=new this.constructor[Symbol.species](2,2),n=this.get(0,0),r=t.get(0,0),i=this.get(0,1),o=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),c=t.get(1,1),l=(n+u)*(r+c),h=(a+u)*r,f=n*(o-c),d=u*(s-r),p=(n+i)*c;return e.set(0,0,l+d-p+(i-u)*(s+c)),e.set(0,1,f+p),e.set(1,0,h+d),e.set(1,1,l-h+f+(a-n)*(r+o)),e}strassen3x3(t){var e=new this.constructor[Symbol.species](3,3),n=this.get(0,0),r=this.get(0,1),i=this.get(0,2),o=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),c=this.get(2,1),l=this.get(2,2),h=t.get(0,0),f=t.get(0,1),d=t.get(0,2),p=t.get(1,0),m=t.get(1,1),g=t.get(1,2),v=t.get(2,0),y=t.get(2,1),w=t.get(2,2),b=(n-o)*(-f+m),x=(-n+o+a)*(h-f+m),_=(o+a)*(-h+f),M=n*h,E=(-n+u+c)*(h-d+g),S=(-n+u)*(d-g),T=(u+c)*(-h+d),A=(-i+c+l)*(m+v-y),k=(i-l)*(m-y),C=i*v,R=(c+l)*(-v+y),D=(-i+a+s)*(g+v-w),L=(i-s)*(g-w),O=(a+s)*(-v+w);return e.set(0,0,M+C+r*p),e.set(0,1,(n+r+i-o-a-c-l)*m+x+_+M+A+C+R),e.set(0,2,M+E+T+(n+r+i-a-s-u-c)*g+C+D+O),e.set(1,0,b+a*(-h+f+p-m-g-v+w)+x+M+C+D+L),e.set(1,1,b+x+_+M+s*y),e.set(1,2,C+D+L+O+o*d),e.set(2,0,M+E+S+c*(-h+d+p-m-g-v+y)+A+k+C),e.set(2,1,A+k+C+R+u*f),e.set(2,2,M+E+S+T+l*w),e}mmulStrassen(t){function e(t,e,n){return t.rows===e&&t.columns===n?t:r.zeros(e,n).setSubMatrix(t,0,0)}var n=this.clone(),i=n.rows,o=n.columns,a=t.rows,s=t.columns;o!==a&&console.warn(`Multiplying ${i} x ${o} and ${a} x ${s} matrix: dimensions do not match.`);var u=M(i,a),c=M(o,s);return function t(n,i,o,a){if(512>=o||512>=a)return n.mmul(i);1==o%2&&1==a%2?(n=e(n,o+1,a+1),i=e(i,o+1,a+1)):1==o%2?(n=e(n,o+1,a),i=e(i,o+1,a)):1==a%2&&(n=e(n,o,a+1),i=e(i,o,a+1));var s=parseInt(n.rows/2),u=parseInt(n.columns/2),c=n.subMatrix(0,s-1,0,u-1),l=i.subMatrix(0,s-1,0,u-1),h=n.subMatrix(0,s-1,u,n.columns-1),f=i.subMatrix(0,s-1,u,i.columns-1),d=n.subMatrix(s,n.rows-1,0,u-1),p=i.subMatrix(s,i.rows-1,0,u-1),m=n.subMatrix(s,n.rows-1,u,n.columns-1),g=i.subMatrix(s,i.rows-1,u,i.columns-1),v=t(r.add(c,m),r.add(l,g),s,u),y=t(r.add(d,m),l,s,u),w=t(c,r.sub(f,g),s,u),b=t(m,r.sub(p,l),s,u),x=t(r.add(c,h),g,s,u),_=t(r.sub(d,c),r.add(l,f),s,u),M=t(r.sub(h,m),r.add(p,g),s,u),E=r.add(v,b);E.sub(x),E.add(M);var S=r.add(w,x),T=r.add(y,b),A=r.sub(v,y);A.add(w),A.add(_);var k=r.zeros(2*E.rows,2*E.columns);return(k=(k=(k=(k=k.setSubMatrix(E,0,0)).setSubMatrix(S,E.rows,0)).setSubMatrix(T,0,E.columns)).setSubMatrix(A,E.rows,E.columns)).subMatrix(0,o-1,0,a-1)}(n=e(n,u,c),t=e(t,u,c),u,c)}scaleRows(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n,r=this.constructor.empty(this.rows,this.columns),i=0;i<this.rows;i++)n=(0,s.scale)(this.getRow(i),{min:t,max:e}),r.setRow(i,n);return r}scaleColumns(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n,r=this.constructor.empty(this.rows,this.columns),i=0;i<this.columns;i++)n=(0,s.scale)(this.getColumn(i),{min:t,max:e}),r.setColumn(i,n);return r}kroneckerProduct(t){t=this.constructor.checkMatrix(t);for(var e=this.rows,n=this.columns,r=t.rows,i=t.columns,o=new this.constructor[Symbol.species](e*r,n*i),a=0;a<e;a++)for(var s=0;s<n;s++)for(var u=0;u<r;u++)for(var c=0;c<i;c++)o[r*a+u][i*s+c]=this.get(a,s)*t.get(u,c);return o}transpose(){for(var t=new this.constructor[Symbol.species](this.columns,this.rows),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(n,e,this.get(e,n));return t}sortRows(t){void 0===t&&(t=e);for(var n=0;n<this.rows;n++)this.setRow(n,this.getRow(n).sort(t));return this}sortColumns(t){void 0===t&&(t=e);for(var n=0;n<this.columns;n++)this.setColumn(n,this.getColumn(n).sort(t));return this}subMatrix(t,e,n,r){c.checkRange(this,t,e,n,r);for(var i=new this.constructor[Symbol.species](e-t+1,r-n+1),o=t;o<=e;o++)for(var a=n;a<=r;a++)i[o-t][a-n]=this.get(o,a);return i}subMatrixRow(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.columns-1),e>n||0>e||e>=this.columns||0>n||n>=this.columns)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](t.length,n-e+1),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(0>t[i]||t[i]>=this.rows)throw new RangeError("Row index out of range: "+t[i]);r.set(i,o-e,this.get(t[i],o))}return r}subMatrixColumn(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.rows-1),e>n||0>e||e>=this.rows||0>n||n>=this.rows)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](n-e+1,t.length),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(0>t[i]||t[i]>=this.columns)throw new RangeError("Column index out of range: "+t[i]);r.set(o-e,i,this.get(o,t[i]))}return r}setSubMatrix(t,e,n){t=this.constructor.checkMatrix(t),c.checkRange(this,e,e+t.rows-1,n,n+t.columns-1);for(var r=0;r<t.rows;r++)for(var i=0;i<t.columns;i++)this[e+r][n+i]=t.get(r,i);return this}selection(t,e){for(var n,r=c.checkIndices(this,t,e),i=new this.constructor[Symbol.species](t.length,e.length),o=0;o<r.row.length;o++){n=r.row[o];for(var a=0;a<r.column.length;a++)i[o][a]=this.get(n,r.column[a])}return i}trace(){for(var t=v(this.rows,this.columns),e=0,n=0;n<t;n++)e+=this.get(n,n);return e}transposeView(){return new l.default(this)}rowView(t){return c.checkRowIndex(this,t),new h.default(this,t)}columnView(t){return c.checkColumnIndex(this,t),new p.default(this,t)}flipRowView(){return new m.default(this)}flipColumnView(){return new y.default(this)}subMatrixView(t,e,n,r){return new f.default(this,t,e,n,r)}selectionView(t,e){return new d.default(this,t,e)}det(){var t,e,n,r,o,a;if(this.isSquare())return 2===this.columns?(t=this.get(0,0),e=this.get(0,1),n=this.get(1,0),t*this.get(1,1)-e*n):3===this.columns?(r=this.selectionView([1,2],[1,2]),o=this.selectionView([1,2],[0,2]),a=this.selectionView([1,2],[0,1]),t=this.get(0,0),e=this.get(0,1),n=this.get(0,2),t*r.det()-e*o.det()+n*a.det()):new i.default(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(t){void 0===t&&(t=a);for(var e=new o.default(this,{autoTranspose:!0}),n=e.leftSingularVectors,r=e.rightSingularVectors,i=e.diagonal,s=0;s<i.length;s++)i[s]=u(i[s])>t?1/i[s]:0;return i=this.constructor[Symbol.species].diag(i),r.mmul(i.mmul(n.transposeView()))}}r.prototype.klass="Matrix",r.random=r.rand,r.diagonal=r.diag,r.prototype.diagonal=r.prototype.diag,r.identity=r.eye,r.prototype.negate=r.prototype.neg,r.prototype.tensorProduct=r.prototype.kroneckerProduct,r.prototype.determinant=r.prototype.det;var w,b,x="\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",_=eval,E=!0,S=!1;try{for(var T,A=[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]][Symbol.iterator]();!(E=(T=A.next()).done);E=!0){var k=T.value,C=_(n("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",{name:k[1],op:k[0]})),R=_(n("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",{name:k[1]+"S",op:k[0]})),D=_(n("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",{name:k[1]+"M",op:k[0]})),L=_(n("\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",{name:k[1]}));for(w=1;w<k.length;w++)r.prototype[k[w]]=C,r.prototype[k[w]+"S"]=R,r.prototype[k[w]+"M"]=D,r[k[w]]=L}}catch(t){S=!0,b=t}finally{try{!E&&A.return&&A.return()}finally{if(S)throw b}}var O=[["~","not"]];["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(t){O.push(["Math."+t,t])});var P,I=!0,N=!1;try{for(var F,j=O[Symbol.iterator]();!(I=(F=j.next()).done);I=!0){var z=F.value,U=_(n("\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",{name:z[1],method:z[0]})),V=_(n("\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",{name:z[1]}));for(w=1;w<z.length;w++)r.prototype[z[w]]=U,r[z[w]]=V}}catch(t){N=!0,P=t}finally{try{!I&&j.return&&j.return()}finally{if(N)throw P}}var B,H=!0,q=!1;try{for(var G,W=[["Math.pow",1,"pow"]][Symbol.iterator]();!(H=(G=W.next()).done);H=!0){var Y=G.value,X="arg0";for(w=1;w<Y[1];w++)X+=`, arg${w}`;if(1!==Y[1]){var $=_(n("\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",{name:Y[2],method:Y[0],args:X})),Q=_(n(x,{name:Y[2],args:X}));for(w=2;w<Y.length;w++)r.prototype[Y[w]]=$,r[Y[w]]=Q}else{var J={name:Y[2],args:X,method:Y[0]},Z=_(n("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",J)),K=_(n("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",J)),tt=_(n("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",J)),et=_(n(x,J));for(w=2;w<Y.length;w++)r.prototype[Y[w]]=Z,r.prototype[Y[w]+"M"]=tt,r.prototype[Y[w]+"S"]=K,r[Y[w]]=et}}}catch(t){q=!0,B=t}finally{try{!H&&W.return&&W.return()}finally{if(q)throw B}}return r};var i=r(n(33)),o=r(n(51)),s=n(1),c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(23)),l=r(n(109)),h=r(n(110)),f=r(n(111)),d=r(n(112)),p=r(n(113)),m=r(n(114)),y=r(n(115))},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);var e,n,i,a,s,c,l,h,f,d,p=(t=o.default.checkMatrix(t)).clone(),m=p.rows,g=p.columns,y=Array(m),w=1;for(e=0;e<m;e++)y[e]=e;for(f=Array(m),n=0;n<g;n++){for(e=0;e<m;e++)f[e]=p[e][n];for(e=0;e<m;e++){for(h=p[e],d=v(e,n),s=0,i=0;i<d;i++)s+=h[i]*f[i];h[n]=f[e]-=s}for(a=n,e=n+1;e<m;e++)u(f[e])>u(f[a])&&(a=e);if(a!==n){for(i=0;i<g;i++)c=p[a][i],p[a][i]=p[n][i],p[n][i]=c;l=y[a],y[a]=y[n],y[n]=l,w=-w}if(n<m&&0!==p[n][n])for(e=n+1;e<m;e++)p[e][n]/=p[n][n]}this.LU=p,this.pivotVector=y,this.pivotSign=w}Object.defineProperty(e,"__esModule",{value:!0});var i=n(4),o=i&&i.__esModule?i:{default:i};r.prototype={isSingular:function(){for(var t=this.LU,e=t.columns,n=0;n<e;n++)if(0===t[n][n])return!0;return!1},get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var e=this.pivotSign,n=t.columns,r=0;r<n;r++)e*=t[r][r];return e},get lowerTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new o.default(e,n),i=0;i<e;i++)for(var a=0;a<n;a++)r[i][a]=i>a?t[i][a]:i===a?1:0;return r},get upperTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new o.default(e,n),i=0;i<e;i++)for(var a=0;a<n;a++)r[i][a]=i<=a?t[i][a]:0;return r},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(t){t=o.default.checkMatrix(t);var e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var n,r,i,a=t.columns,s=t.subMatrixRow(this.pivotVector,0,a-1),u=e.columns;for(i=0;i<u;i++)for(n=i+1;n<u;n++)for(r=0;r<a;r++)s[n][r]-=s[i][r]*e[n][i];for(i=u-1;0<=i;i--){for(r=0;r<a;r++)s[i][r]/=e[i][i];for(n=0;n<i;n++)for(r=0;r<a;r++)s[n][r]-=s[i][r]*e[n][i]}return s}},e.default=r},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.hypotenuse=function(t,e){var n;return u(t)>u(e)?(n=e/t,u(t)*R(1+n*n)):0===e?0:(n=t/e,u(e)*R(1+n*n))},e.getEmpty2DArray=function(t,e){for(var n=Array(t),r=0;r<t;r++)n[r]=Array(e);return n},e.getFilled2DArray=function(t,e,n){for(var r=Array(t),i=0;i<t;i++){r[i]=Array(e);for(var o=0;o<e;o++)r[i][o]=n}return r}},function(t){"use strict";var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,r=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===n.call(t)},i=function(t){if(!t||"[object Object]"!==n.call(t))return!1;var r=e.call(t,"constructor"),i=t.constructor&&t.constructor.prototype&&e.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!r&&!i)return!1;for(var o in t);return"undefined"==typeof o||e.call(t,o)};t.exports=function t(){var e,n,o,a,s,u,c=arguments[0],l=1,h=arguments.length,f=!1;for("boolean"==typeof c&&(f=c,c=arguments[1]||{},l=2),(null==c||"object"!=typeof c&&"function"!=typeof c)&&(c={});l<h;++l)if(null!=(e=arguments[l]))for(n in e)o=c[n],c!==(a=e[n])&&(f&&a&&(i(a)||(s=r(a)))?(s?(s=!1,u=o&&r(o)?o:[]):u=o&&i(o)?o:{},c[n]=t(f,u,a)):"undefined"!=typeof a&&(c[n]=a));return c}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=r&&r.__esModule?r:{default:r};class o extends i.default{constructor(t,e){super(),!0===t?(this.slope=e.slope,this.intercept=e.intercept,this.coefficients=[e.intercept,e.slope]):((0,r.checkArrayLength)(t,e),function(t,e,n){for(var r=e.length,i=0,o=0,a=0,s=0,u=0;u<r;u++)i+=e[u],o+=n[u],a+=e[u]*e[u],s+=e[u]*n[u];t.slope=(r*s-i*o)/(r*a-i*i),t.intercept=1/r*o-t.slope*(1/r)*i,t.coefficients=[t.intercept,t.slope]}(this,t,e))}toJSON(){return{name:"simpleLinearRegression",slope:this.slope,intercept:this.intercept}}_predict(t){return this.slope*t+this.intercept}computeX(t){return(t-this.intercept)/this.slope}toString(t){var e="f(x) = ";if(0!==this.slope){var n=(0,r.maybeToPrecision)(this.slope,t);if(e+=("1"===n?"":n+" * ")+"x",this.intercept){var i=u(this.intercept);e+=` ${i===this.intercept?"+":"-"} ${(0,r.maybeToPrecision)(i,t)}`}}else e+=(0,r.maybeToPrecision)(this.intercept,t);return e}toLaTeX(t){return this.toString(t)}static load(t){if("simpleLinearRegression"!==t.name)throw new TypeError("not a SLR model");return new o(!0,t)}}e.default=o},function(t,e,n){"use strict";var r=n(13).Matrix,i=n(131),o=n(132),a=n(133),s=n(134),u=n(135),c=n(136),l=n(137),h=n(138),f=n(139),d=n(140),p={gaussian:i,rbf:i,polynomial:o,poly:o,anova:a,cauchy:s,exponential:u,histogram:c,min:c,laplacian:l,multiquadratic:h,rational:f,sigmoid:d,mlp:d};t.exports=class{constructor(t,e){if(this.kernelType=t,"linear"!==t)if("string"==typeof t){t=t.toLowerCase();var n=p[t];if(!n)throw new Error("unsupported kernel type: "+t);this.kernelFunction=new n(e)}else{if("object"!=typeof t||"function"!=typeof t.compute)throw new TypeError("first argument must be a valid kernel type or instance");this.kernelFunction=t}}compute(t,e){if(void 0===e&&(e=t),"linear"===this.kernelType)return new r(t).mmul(new r(e).transposeView());var n,i,o=new r(t.length,e.length);if(t===e)for(n=0;n<t.length;n++)for(i=n;i<t.length;i++)o[n][i]=o[i][n]=this.kernelFunction.compute(t[n],t[i]);else for(n=0;n<t.length;n++)for(i=0;i<e.length;i++)o[n][i]=this.kernelFunction.compute(t[n],e[i]);return o}}},function(t,e){"use strict";e.hypotenuse=function(t,e){var n;return u(t)>u(e)?(n=e/t,u(t)*R(1+n*n)):0===e?0:(n=t/e,u(e)*R(1+n*n))},e.getEmpty2DArray=function(t,e){for(var n=Array(t),r=0;r<t;r++)n[r]=Array(e);return n},e.getFilled2DArray=function(t,e,n){for(var r=Array(t),i=0;i<t;i++){r[i]=Array(e);for(var o=0;o<e;o++)r[i][o]=n}return r}},function(t,e){"use strict";e.hypotenuse=function(t,e){var n;return u(t)>u(e)?(n=e/t,u(t)*R(1+n*n)):0===e?0:(n=t/e,u(e)*R(1+n*n))},e.getEmpty2DArray=function(t,e){for(var n=Array(t),r=0;r<t;r++)n[r]=Array(e);return n},e.getFilled2DArray=function(t,e,n){for(var r=Array(t),i=0;i<t;i++){r[i]=Array(e);for(var o=0;o<e;o++)r[i][o]=n}return r}},function(t,e,n){"use strict";t.exports=n(7).Matrix,t.exports.Decompositions=t.exports.DC=n(236)},function(t,e){"use strict";e.hypotenuse=function(t,e){var n;return u(t)>u(e)?(n=e/t,u(t)*R(1+n*n)):0===e?0:(n=t/e,u(e)*R(1+n*n))},e.getEmpty2DArray=function(t,e){for(var n=Array(t),r=0;r<t;r++)n[r]=Array(e);return n},e.getFilled2DArray=function(t,e,n){for(var r=Array(t),i=0;i<t;i++){r[i]=Array(e);for(var o=0;o<e;o++)r[i][o]=n}return r}},function(t,e){"use strict";e.hypotenuse=function(t,e){var n;return u(t)>u(e)?(n=e/t,u(t)*R(1+n*n)):0===e?0:(n=t/e,u(e)*R(1+n*n))},e.getEmpty2DArray=function(t,e){for(var n=Array(t),r=0;r<t;r++)n[r]=Array(e);return n},e.getFilled2DArray=function(t,e,n){for(var r=Array(t),i=0;i<t;i++){r[i]=Array(e);for(var o=0;o<e;o++)r[i][o]=n}return r}},function(t,e){"use strict";e.hypotenuse=function(t,e){var n;return u(t)>u(e)?(n=e/t,u(t)*R(1+n*n)):0===e?0:(n=t/e,u(e)*R(1+n*n))},e.getEmpty2DArray=function(t,e){for(var n=Array(t),r=0;r<t;r++)n[r]=Array(e);return n},e.getFilled2DArray=function(t,e,n){for(var r=Array(t),i=0;i<t;i++){r[i]=Array(e);for(var o=0;o<e;o++)r[i][o]=n}return r}},function(t,e){"use strict";e.hypotenuse=function(t,e){var n;return u(t)>u(e)?(n=e/t,u(t)*R(1+n*n)):0===e?0:(n=t/e,u(e)*R(1+n*n))},e.getEmpty2DArray=function(t,e){for(var n=Array(t),r=0;r<t;r++)n[r]=Array(e);return n},e.getFilled2DArray=function(t,e,n){for(var r=Array(t),i=0;i<t;i++){r[i]=Array(e);for(var o=0;o<e;o++)r[i][o]=n}return r}},function(t,e,n){"use strict";t.exports=n(11).Matrix,t.exports.Decompositions=t.exports.DC=n(299)},function(t,e){"use strict";e.hypotenuse=function(t,e){var n;return u(t)>u(e)?(n=e/t,u(t)*R(1+n*n)):0===e?0:(n=t/e,u(e)*R(1+n*n))},e.getEmpty2DArray=function(t,e){for(var n=Array(t),r=0;r<t;r++)n[r]=Array(e);return n},e.getFilled2DArray=function(t,e,n){for(var r=Array(t),i=0;i<t;i++){r[i]=Array(e);for(var o=0;o<e;o++)r[i][o]=n}return r}},function(t,e,n){"use strict";function r(t,e){return this[t][e]*=this[t][e],this}var i=n(45),o=n(2);t.exports={norm:function(t){return R(t.clone().apply(r).sum())},pow2array:r,featureNormalize:function(t){var e=o.matrix.mean(t),n=o.matrix.standardDeviation(t,e,!0);return{result:i.checkMatrix(t).subRowVector(e).divRowVector(n),means:e,std:n}}}},function(t,e,n){"use strict";function r(){this.children=[],this.distance=-1,this.index=[]}var i=n(311);r.prototype.cut=function(t){if(0>t)throw new RangeError("Threshold too small");var e=new r;e.children=this.children,e.distance=this.distance,e.index=this.index;for(var n=[e],i=[];0<n.length;){var o=n.shift();t>=o.distance?i.push(o):n=n.concat(o.children)}return i},r.prototype.group=function(t){if(!m(t)||1>t)throw new RangeError("Number of groups must be a positive integer");var e=new i(function(t,e){return e.distance-t.distance});for(e.push(this);e.size()<t;){var n=e.pop();if(0===n.children.length)break;n.children.forEach(t=>e.push(t))}var o=new r;return o.children=e.toArray(),o.distance=this.distance,o},r.prototype.traverse=function(t){!function t(e,n){if(n(e),e.children)for(var r=e.children.length-1;0<=r;r--)t(e.children[r],n)}(this,t)},t.exports=r},function(t,e,n){"use strict";t.exports=n(12).Matrix,t.exports.Decompositions=t.exports.DC=n(330)},function(t,e){"use strict";e.hypotenuse=function(t,e){var n;return u(t)>u(e)?(n=e/t,u(t)*R(1+n*n)):0===e?0:(n=t/e,u(e)*R(1+n*n))},e.getEmpty2DArray=function(t,e){for(var n=Array(t),r=0;r<t;r++)n[r]=Array(e);return n},e.getFilled2DArray=function(t,e,n){for(var r=Array(t),i=0;i<t;i++){r[i]=Array(e);for(var o=0;o<e;o++)r[i][o]=n}return r}},function(t,e,n){"use strict";function r(t,e){if(!(this instanceof r))return new r(t,e);t=o.default.checkMatrix(t),e=e||{};var n=t.rows,i=t.columns,s=v(n,i),c=!0,l=!0;!1===e.computeLeftSingularVectors&&(c=!1),!1===e.computeRightSingularVectors&&(l=!1);var h,f=!1;if(n<i)if(!0===e.autoTranspose){n=(h=t.transpose()).rows,i=h.columns,f=!0;var d=c;c=l,l=d}else h=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else h=t.clone();var p,m,g,y,w,b,x,_,E,S,T,A,k,C,D,L,O,P,I,N,F,j=Array(v(n+1,i)),z=(0,a.getFilled2DArray)(n,s,0),U=(0,a.getFilled2DArray)(i,i,0),V=Array(i),B=Array(n),H=v(n-1,i),q=M(0,v(i-2,n));for(g=0,S=M(H,q);g<S;g++){if(g<H){for(j[g]=0,p=g;p<n;p++)j[g]=(0,a.hypotenuse)(j[g],h[p][g]);if(0!==j[g]){for(0>h[g][g]&&(j[g]=-j[g]),p=g;p<n;p++)h[p][g]/=j[g];h[g][g]+=1}j[g]=-j[g]}for(m=g+1;m<i;m++){if(g<H&&0!==j[g]){for(w=0,p=g;p<n;p++)w+=h[p][g]*h[p][m];for(w=-w/h[g][g],p=g;p<n;p++)h[p][m]+=w*h[p][g]}V[m]=h[g][m]}if(c&&g<H)for(p=g;p<n;p++)z[p][g]=h[p][g];if(g<q){for(V[g]=0,p=g+1;p<i;p++)V[g]=(0,a.hypotenuse)(V[g],V[p]);if(0!==V[g]){for(0>V[g+1]&&(V[g]=0-V[g]),p=g+1;p<i;p++)V[p]/=V[g];V[g+1]+=1}if(V[g]=-V[g],g+1<n&&0!==V[g]){for(p=g+1;p<n;p++)B[p]=0;for(m=g+1;m<i;m++)for(p=g+1;p<n;p++)B[p]+=V[m]*h[p][m];for(m=g+1;m<i;m++)for(w=-V[m]/V[g+1],p=g+1;p<n;p++)h[p][m]+=w*B[p]}if(l)for(p=g+1;p<i;p++)U[p][g]=V[p]}}if(y=v(i,n+1),H<i&&(j[H]=h[H][H]),n<y&&(j[y-1]=0),q+1<y&&(V[q]=h[q][y-1]),V[y-1]=0,c){for(m=H;m<s;m++){for(p=0;p<n;p++)z[p][m]=0;z[m][m]=1}for(g=H-1;0<=g;g--)if(0!==j[g]){for(m=g+1;m<s;m++){for(w=0,p=g;p<n;p++)w+=z[p][g]*z[p][m];for(w=-w/z[g][g],p=g;p<n;p++)z[p][m]+=w*z[p][g]}for(p=g;p<n;p++)z[p][g]=-z[p][g];for(z[g][g]=1+z[g][g],p=0;p<g-1;p++)z[p][g]=0}else{for(p=0;p<n;p++)z[p][g]=0;z[g][g]=1}}if(l)for(g=i-1;0<=g;g--){if(g<q&&0!==V[g])for(m=g+1;m<i;m++){for(w=0,p=g+1;p<i;p++)w+=U[p][g]*U[p][m];for(w=-w/U[g+1][g],p=g+1;p<i;p++)U[p][m]+=w*U[p][g]}for(p=0;p<i;p++)U[p][g]=0;U[g][g]=1}for(var G=y-1,W=2.220446049250313e-16;0<y;){for(g=y-2;-1<=g&&-1!==g;g--)if(u(V[g])<=W*(u(j[g])+u(j[g+1]))){V[g]=0;break}if(g===y-2)T=4;else{for(b=y-1;b>=g&&b!==g;b--)if(w=(b===y?0:u(V[b]))+(b===g+1?0:u(V[b-1])),u(j[b])<=W*w){j[b]=0;break}b===g?T=3:b===y-1?T=1:(T=2,g=b)}switch(g++,T){case 1:for(x=V[y-2],V[y-2]=0,m=y-2;m>=g;m--)if(w=(0,a.hypotenuse)(j[m],x),_=j[m]/w,E=x/w,j[m]=w,m!==g&&(x=-E*V[m-1],V[m-1]=_*V[m-1]),l)for(p=0;p<i;p++)w=_*U[p][m]+E*U[p][y-1],U[p][y-1]=-E*U[p][m]+_*U[p][y-1],U[p][m]=w;break;case 2:for(x=V[g-1],V[g-1]=0,m=g;m<y;m++)if(w=(0,a.hypotenuse)(j[m],x),_=j[m]/w,E=x/w,j[m]=w,x=-E*V[m],V[m]=_*V[m],c)for(p=0;p<n;p++)w=_*z[p][m]+E*z[p][g-1],z[p][g-1]=-E*z[p][m]+_*z[p][g-1],z[p][m]=w;break;case 3:for(A=M(M(M(M(u(j[y-1]),u(j[y-2])),u(V[y-2])),u(j[g])),u(V[g])),L=j[g]/A,O=V[g]/A,I=(k=j[y-1]/A)*(D=V[y-2]/A)*(k*D),N=0,(0!=(P=(((C=j[y-2]/A)+k)*(C-k)+D*D)/2)||0!==I)&&(N=R(P*P+I),0>P&&(N=-N),N=I/(P+N)),x=(L+k)*(L-k)+N,F=L*O,m=g;m<y-1;m++){if(_=x/(w=(0,a.hypotenuse)(x,F)),E=F/w,m!==g&&(V[m-1]=w),x=_*j[m]+E*V[m],V[m]=_*V[m]-E*j[m],F=E*j[m+1],j[m+1]=_*j[m+1],l)for(p=0;p<i;p++)w=_*U[p][m]+E*U[p][m+1],U[p][m+1]=-E*U[p][m]+_*U[p][m+1],U[p][m]=w;if(_=x/(w=(0,a.hypotenuse)(x,F)),E=F/w,j[m]=w,x=_*V[m]+E*j[m+1],j[m+1]=-E*V[m]+_*j[m+1],F=E*V[m+1],V[m+1]=_*V[m+1],c&&m<n-1)for(p=0;p<n;p++)w=_*z[p][m]+E*z[p][m+1],z[p][m+1]=-E*z[p][m]+_*z[p][m+1],z[p][m]=w}V[y-2]=x;break;case 4:if(0>=j[g]&&(j[g]=0>j[g]?-j[g]:0,l))for(p=0;p<=G;p++)U[p][g]=-U[p][g];for(;g<G&&!(j[g]>=j[g+1]);){if(w=j[g],j[g]=j[g+1],j[g+1]=w,l&&g<i-1)for(p=0;p<i;p++)w=U[p][g+1],U[p][g+1]=U[p][g],U[p][g]=w;if(c&&g<n-1)for(p=0;p<n;p++)w=z[p][g+1],z[p][g+1]=z[p][g],z[p][g]=w;g++}y--}}if(f){var Y=U;U=z,z=Y}this.m=n,this.n=i,this.s=j,this.U=z,this.V=U}Object.defineProperty(e,"__esModule",{value:!0});var i=n(4),o=i&&i.__esModule?i:{default:i},a=n(34);r.prototype={get condition(){return this.s[0]/this.s[v(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var t=M(this.m,this.n)*this.s[0]*2.220446049250313e-16,e=0,n=this.s,r=0,i=n.length;r<i;r++)n[r]>t&&e++;return e},get diagonal(){return this.s},get threshold(){return 1.1102230246251565e-16*M(this.m,this.n)*this.s[0]},get leftSingularVectors(){return o.default.isMatrix(this.U)||(this.U=new o.default(this.U)),this.U},get rightSingularVectors(){return o.default.isMatrix(this.V)||(this.V=new o.default(this.V)),this.V},get diagonalMatrix(){return o.default.diag(this.s)},solve:function(t){var e,n=this.threshold,r=this.s.length,i=o.default.zeros(r,r);for(e=0;e<r;e++)i[e][e]=u(this.s[e])<=n?0:1/this.s[e];var a,s,c,l=this.U,h=this.rightSingularVectors,f=h.mmul(i),d=h.rows,p=l.length,m=o.default.zeros(d,p);for(e=0;e<d;e++)for(a=0;a<p;a++){for(c=0,s=0;s<r;s++)c+=f[e][s]*l[a][s];m[e][a]=c}return m.mmul(t)},solveForDiagonal:function(t){return this.solve(o.default.diag(t))},inverse:function(){var t,e,n=this.V,r=this.threshold,i=n.length,a=n[0].length,s=new o.default(i,this.s.length);for(t=0;t<i;t++)for(e=0;e<a;e++)s[t][e]=u(this.s[e])>r?n[t][e]/this.s[e]:0;var c,l,h=this.U,f=h.length,d=h[0].length,p=new o.default(i,f);for(t=0;t<i;t++)for(e=0;e<f;e++){for(l=0,c=0;c<d;c++)l+=s[t][c]*h[e][c];p[t][e]=l}return p}},e.default=r},function(t,e){"use strict";function n(t,e){return t-e}e.sum=function(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e},e.max=function(t){for(var e=t[0],n=t.length,r=1;r<n;r++)t[r]>e&&(e=t[r]);return e},e.min=function(t){for(var e=t[0],n=t.length,r=1;r<n;r++)t[r]<e&&(e=t[r]);return e},e.minMax=function(t){for(var e=t[0],n=t[0],r=t.length,i=1;i<r;i++)t[i]<e&&(e=t[i]),t[i]>n&&(n=t[i]);return{min:e,max:n}},e.arithmeticMean=function(t){for(var e=0,n=t.length,r=0;r<n;r++)e+=t[r];return e/n},e.mean=e.arithmeticMean,e.geometricMean=function(t){for(var e=1,n=t.length,r=0;r<n;r++)e*=t[r];return c(e,1/n)},e.logMean=function(t){for(var e=0,n=t.length,i=0;i<n;i++)e+=r(t[i]);return e/n},e.grandMean=function(t,e){for(var n=0,r=0,i=t.length,o=0;o<i;o++)n+=e[o]*t[o],r+=e[o];return n/r},e.truncatedMean=function(t,e,r){void 0===r&&(r=!1),r||(t=[].concat(t).sort(n));for(var i=t.length,o=g(i*e),a=0,s=o;s<i-o;s++)a+=t[s];return a/(i-2*o)},e.harmonicMean=function(t){for(var e=0,n=t.length,r=0;r<n;r++){if(0===t[r])throw new RangeError("value at index "+r+"is zero");e+=1/t[r]}return n/e},e.contraHarmonicMean=function(t){for(var e=0,n=0,r=t.length,i=0;i<r;i++)e+=t[i]*t[i],n+=t[i];if(0>n)throw new RangeError("sum of values is negative");return e/n},e.median=function(t,e){void 0===e&&(e=!1),e||(t=[].concat(t).sort(n));var r=t.length,i=g(r/2);return 0==r%2?.5*(t[i-1]+t[i]):t[i]},e.variance=function(t,n){void 0===n&&(n=!0);for(var r,i=e.mean(t),o=0,a=t.length,s=0;s<a;s++)o+=(r=t[s]-i)*r;return n?o/(a-1):o/a},e.standardDeviation=function(t,n){return R(e.variance(t,n))},e.standardError=function(t){return e.standardDeviation(t)/R(t.length)},e.robustMeanAndStdev=function(t){var e=0,r=t.length,i=0;for(i=0;i<r;i++)e+=t[i];e/=r;var o=Array(r);for(i=0;i<r;i++)o[i]=u(t[i]-e);return o.sort(n),{mean:e,stdev:1==r%2?o[(r-1)/2]/.6745:.5*(o[r/2]+o[r/2-1])/.6745}},e.quartiles=function(t,r){"undefined"==typeof r&&(r=!1),r||(t=[].concat(t).sort(n));var i=t.length/4;return{q1:t[s(i)-1],q2:e.median(t,!0),q3:t[s(3*i)-1]}},e.pooledStandardDeviation=function(t,n){return R(e.pooledVariance(t,n))},e.pooledVariance=function(t,n){"undefined"==typeof n&&(n=!0);for(var r=0,i=0,o=t.length,a=0;a<o;a++){var s=t[a],u=e.variance(s);r+=(s.length-1)*u,i+=n?s.length-1:s.length}return r/i},e.mode=function(t){var e,n=t.length,r=Array(n);for(e=0;e<n;e++)r[e]=0;var i=Array(n),o=0;for(e=0;e<n;e++){var a=i.indexOf(t[e]);0<=a?r[a]++:(i[o]=t[e],r[o]=1,o++)}var s=0,u=0;for(e=0;e<o;e++)r[e]>s&&(s=r[e],u=e);return i[u]},e.covariance=function(t,n,r){"undefined"==typeof r&&(r=!0);var i=e.mean(t),o=e.mean(n);if(t.length!==n.length)throw"Vectors do not have the same dimensions";for(var a=0,s=t.length,u=0;u<s;u++)a+=(t[u]-i)*(n[u]-o);return r?a/(s-1):a/s},e.skewness=function(t,n){"undefined"==typeof n&&(n=!0);for(var r,i=e.mean(t),o=0,a=0,s=t.length,u=0;u<s;u++)o+=(r=t[u]-i)*r,a+=r*r*r;var l=a/s/c(o/s,1.5);return n?R(s*(s-1))/(s-2)*l:l},e.kurtosis=function(t,n){"undefined"==typeof n&&(n=!0);for(var r,i=e.mean(t),o=t.length,a=0,s=0,u=0;u<o;u++)a+=(r=t[u]-i)*r,s+=r*r*r*r;var c=a/o,l=s/o;if(n){var h=a/(o-1);return o*(o+1)/((o-1)*(o-2)*(o-3))*(s/(h*h))-(o-1)*(o-1)/((o-2)*(o-3))*3}return l/(c*c)-3},e.entropy=function(t,e){"undefined"==typeof e&&(e=0);for(var n=0,i=t.length,o=0;o<i;o++)n+=t[o]*r(t[o]+e);return-n},e.weightedMean=function(t,e){for(var n=0,r=t.length,i=0;i<r;i++)n+=t[i]*e[i];return n},e.weightedStandardDeviation=function(t,n){return R(e.weightedVariance(t,n))},e.weightedVariance=function(t,n){for(var r=e.weightedMean(t,n),i=0,o=t.length,a=0,s=0,u=0;u<o;u++){var c=t[u]-r,l=n[u];i+=l*(c*c),s+=l,a+=l*l}return i*(s/(s*s-a))},e.center=function(t,n){"undefined"==typeof n&&(n=!1);var r=t;n||(r=[].concat(t));for(var i=e.mean(r),o=r.length,a=0;a<o;a++)r[a]-=i},e.standardize=function(t,n,r){"undefined"==typeof n&&(n=e.standardDeviation(t)),"undefined"==typeof r&&(r=!1);for(var i=t.length,o=r?t:Array(i),a=0;a<i;a++)o[a]=t[a]/n;return o},e.cumulativeSum=function(t){var e=t.length,n=Array(e);n[0]=t[0];for(var r=1;r<e;r++)n[r]=n[r-1]+t[r];return n}},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);var e,n,i,s,u=(t=o.default.checkMatrix(t)).clone(),c=t.rows,l=t.columns,h=Array(l);for(i=0;i<l;i++){var f=0;for(e=i;e<c;e++)f=(0,a.hypotenuse)(f,u[e][i]);if(0!==f){for(0>u[i][i]&&(f=-f),e=i;e<c;e++)u[e][i]/=f;for(u[i][i]+=1,n=i+1;n<l;n++){for(s=0,e=i;e<c;e++)s+=u[e][i]*u[e][n];for(s=-s/u[i][i],e=i;e<c;e++)u[e][n]+=s*u[e][i]}}h[i]=-f}this.QR=u,this.Rdiag=h}Object.defineProperty(e,"__esModule",{value:!0});var i=n(4),o=i&&i.__esModule?i:{default:i},a=n(34);r.prototype={solve:function(t){t=o.default.checkMatrix(t);var e=this.QR,n=e.rows;if(t.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var r,i,a,s,u=t.columns,c=t.clone(),l=e.columns;for(a=0;a<l;a++)for(i=0;i<u;i++){for(s=0,r=a;r<n;r++)s+=e[r][a]*c[r][i];for(s=-s/e[a][a],r=a;r<n;r++)c[r][i]+=s*e[r][a]}for(a=l-1;0<=a;a--){for(i=0;i<u;i++)c[a][i]/=this.Rdiag[a];for(r=0;r<a;r++)for(i=0;i<u;i++)c[r][i]-=c[a][i]*e[r][a]}return c.subMatrix(0,l-1,0,u-1)},isFullRank:function(){for(var t=this.QR.columns,e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0},get upperTriangularMatrix(){var t,e,n=this.QR,r=n.columns,i=new o.default(r,r);for(t=0;t<r;t++)for(e=0;e<r;e++)i[t][e]=t<e?n[t][e]:t===e?this.Rdiag[t]:0;return i},get orthogonalMatrix(){var t,e,n,r,i=this.QR,a=i.rows,s=i.columns,u=new o.default(a,s);for(n=s-1;0<=n;n--){for(t=0;t<a;t++)u[t][n]=0;for(u[n][n]=1,e=n;e<s;e++)if(0!==i[n][n]){for(r=0,t=n;t<a;t++)r+=i[t][n]*u[t][e];for(r=-r/i[n][n],t=n;t<a;t++)u[t][e]+=r*i[t][n]}}return u}},e.default=r},function(t,e,n){"use strict";function r(t,e){return v(t-2,0|t*e)}function i(t,e,n){return s(M(t+1,0|4*t/(3*e+n)))}var o=n(121),a=n(122),s=a.nextPrime,u=a.largestPrime,c=0,l=1,h=2;class f{constructor(t={}){if(t instanceof f)return this.table=t.table.slice(),this.values=t.values.slice(),this.state=t.state.slice(),this.minLoadFactor=t.minLoadFactor,this.maxLoadFactor=t.maxLoadFactor,this.distinct=t.distinct,this.freeEntries=t.freeEntries,this.lowWaterMark=t.lowWaterMark,void(this.highWaterMark=t.maxLoadFactor);var e=void 0===t.initialCapacity?150:t.initialCapacity;if(0>e)throw new RangeError(`initial capacity must not be less than zero: ${e}`);var n=void 0===t.minLoadFactor?1/6:t.minLoadFactor,i=void 0===t.maxLoadFactor?2/3:t.maxLoadFactor;if(0>n||1<=n)throw new RangeError(`invalid minLoadFactor: ${n}`);if(0>=i||1<=i)throw new RangeError(`invalid maxLoadFactor: ${i}`);if(n>=i)throw new RangeError(`minLoadFactor (${n}) must be smaller than maxLoadFactor (${i})`);var a=e;0===(a=s(a=0|a/i))&&(a=1),this.table=o(a,0),this.values=o(a,0),this.state=o(a,0),this.minLoadFactor=n,this.maxLoadFactor=a===u?1:i,this.distinct=0,this.freeEntries=a,this.lowWaterMark=0,this.highWaterMark=r(a,this.maxLoadFactor)}clone(){return new f(this)}get size(){return this.distinct}get(t){var e=this.indexOfKey(t);return 0>e?0:this.values[e]}set(t,e){var n=this.indexOfInsertion(t);if(0>n)return this.values[n=-n-1]=e,!1;if(this.distinct>this.highWaterMark){var r=i(this.distinct+1,this.minLoadFactor,this.maxLoadFactor);return this.rehash(r),this.set(t,e)}if(this.table[n]=t,this.values[n]=e,this.state[n]===c&&this.freeEntries--,this.state[n]=l,this.distinct++,1>this.freeEntries){var o=i(this.distinct+1,this.minLoadFactor,this.maxLoadFactor);this.rehash(o)}return!0}remove(t,e){var n=this.indexOfKey(t);return!(0>n||(this.state[n]=h,this.distinct--,e||this.maybeShrinkCapacity(),0))}delete(t,e){var n=this.indexOfKey(t);return!(0>n||(this.state[n]=c,this.distinct--,e||this.maybeShrinkCapacity(),0))}maybeShrinkCapacity(){if(this.distinct<this.lowWaterMark){var t=function(t,e,n){return s(M(t+1,0|4*t/(e+3*n)))}(this.distinct,this.minLoadFactor,this.maxLoadFactor);this.rehash(t)}}containsKey(t){return 0<=this.indexOfKey(t)}indexOfKey(t){var e=this.table,n=this.state,r=this.table.length,i=2147483647&t,o=i%r,a=i%(r-2);for(0==a&&(a=1);n[o]!==c&&(n[o]===h||e[o]!==t);)0>(o-=a)&&(o+=r);return n[o]===c?-1:o}containsValue(t){return 0<=this.indexOfValue(t)}indexOfValue(t){for(var e=this.values,n=this.state,r=0;r<n.length;r++)if(n[r]===l&&e[r]===t)return r;return-1}indexOfInsertion(t){var e=this.table,n=this.state,r=e.length,i=2147483647&t,o=i%r,a=i%(r-2);for(0==a&&(a=1);n[o]===l&&e[o]!==t;)0>(o-=a)&&(o+=r);if(n[o]===h){for(var s=o;n[o]!==c&&(n[o]===h||e[o]!==t);)0>(o-=a)&&(o+=r);n[o]===c&&(o=s)}return n[o]===l?-o-1:o}ensureCapacity(t){if(this.table.length<t){var e=s(t);this.rehash(e)}}rehash(t){var e=this.table.length;if(t<=this.distinct)throw new Error("Unexpected");var n=this.table,i=this.values,a=this.state,s=o(t,0),u=o(t,0),c=o(t,0);this.lowWaterMark=function(t,e){return 0|t*e}(t,this.minLoadFactor),this.highWaterMark=r(t,this.maxLoadFactor),this.table=s,this.values=u,this.state=c,this.freeEntries=t-this.distinct;for(var h=0;h<e;h++)if(a[h]===l){var f=n[h],d=this.indexOfInsertion(f);s[d]=f,u[d]=i[h],c[d]=l}}forEachKey(t){for(var e=0;e<this.state.length;e++)if(this.state[e]===l&&!t(this.table[e]))return!1;return!0}forEachValue(t){for(var e=0;e<this.state.length;e++)if(this.state[e]===l&&!t(this.values[e]))return!1;return!0}forEachPair(t){for(var e=0;e<this.state.length;e++)if(this.state[e]===l&&!t(this.table[e],this.values[e]))return!1;return!0}}t.exports=f},function(t){"use strict";t.exports=function(t,e,n,r,i){var o,a;if(void 0===r)r=0;else if(0>(r|=0)||r>=t.length)throw new RangeError("invalid lower bound");if(void 0===i)i=t.length-1;else if((i|=0)<r||i>=t.length)throw new RangeError("invalid upper bound");for(;r<=i;)if(0>(a=+n(t[o=r+(i-r>>1)],e,o,t)))r=o+1;else{if(!(0<a))return o;i=o-1}return~r}},function(t,e,n){"use strict";function r(t){if("number"!=typeof t||i(t))throw new TypeError("Expected a number")}var i=n(123);e.asc=function(t,e){return r(t),r(e),t-e},e.desc=function(t,e){return r(t),r(e),e-t}},function(t,e,n){"use strict";var r=n(35),i={size:1,value:0};t.exports=function(t,e){if(e=r({},i,e),Array.isArray(t))return Array.isArray(t[0])?function(t,e){throw void 0===e.size[0]&&(e.size=[e.size,e.size,e.size,e.size]),new Error("matrix not supported yet, sorry")}(0,e):function(t,e){var n=t.length;"number"==typeof e.size&&(e.size=[e.size,e.size]);var r,i,o=n+e.size[0]+e.size[1];if(e.output){if(e.output.length!==o)throw new RangeError("Wrong output size");r=e.output}else r=Array(o);if("circular"===e.value)for(i=0;i<o;i++)r[i]=i<e.size[0]?t[(n-e.size[0]%n+i)%n]:i<e.size[0]+n?t[i-e.size[0]]:t[(i-e.size[0])%n];else if("replicate"===e.value)for(i=0;i<o;i++)r[i]=i<e.size[0]?t[0]:i<e.size[0]+n?t[i-e.size[0]]:t[n-1];else if("symmetric"===e.value){if(e.size[0]>n||e.size[1]>n)throw new RangeError("expanded value should not be bigger than the data length");for(i=0;i<o;i++)r[i]=i<e.size[0]?t[e.size[0]-1-i]:i<e.size[0]+n?t[i-e.size[0]]:t[2*n+e.size[0]-i-1]}else for(i=0;i<o;i++)r[i]=i<e.size[0]?e.value:i<e.size[0]+n?t[i-e.size[0]]:e.value;return r}(t,e);throw new TypeError("data should be an array")}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),o=r(i),a=n(13),s=r(a);class u extends o.default{constructor(t,e,n){super(),!0===t?(this.degree=e.degree,this.powers=e.powers,this.coefficients=e.coefficients):((0,i.checkArrayLength)(t,e),function(t,e,n,r){var i,o=e.length;if(Array.isArray(r))r=(i=r).length;else{r++,i=Array(r);for(var u=0;u<r;u++)i[u]=u}for(var l=new s.default(o,r),h=new s.default([n]),f=0;f<r;f++)for(var d=0;d<o;d++)l[d][f]=0===i[f]?1:c(e[d],i[f]);var p=l.transposeView(),m=p.mmul(l),g=p.mmul(h.transposeView());t.degree=r-1,t.powers=i,t.coefficients=(0,a.solve)(m,g).to1DArray()}(this,t,e,n))}_predict(t){for(var e=0,n=0;n<this.powers.length;n++)e+=this.coefficients[n]*c(t,this.powers[n]);return e}toJSON(){return{name:"polynomialRegression",degree:this.degree,powers:this.powers,coefficients:this.coefficients}}toString(t){return this._toFormula(t,!1)}toLaTeX(t){return this._toFormula(t,!0)}_toFormula(t,e){var n="^",r="",o=" * ";e&&(n="^{",r="}",o="");for(var a="",s="",u=0;u<this.coefficients.length;u++)s="",0!==this.coefficients[u]&&(s=0===this.powers[u]?(0,i.maybeToPrecision)(this.coefficients[u],t):1===this.powers[u]?(0,i.maybeToPrecision)(this.coefficients[u],t)+o+"x":(0,i.maybeToPrecision)(this.coefficients[u],t)+o+"x"+n+this.powers[u]+r,0<this.coefficients[u]&&u!==this.coefficients.length-1?s=" + "+s:u!==this.coefficients.length-1&&(s=" "+s)),a=s+a;return"+"===a.charAt(0)&&(a=a.slice(1)),"f(x) = "+a}static load(t){if("polynomialRegression"!==t.name)throw new TypeError("not a polynomial regression model");return new u(!0,t)}}e.default=u},function(t){"use strict";t.exports=function(t,e){for(var n=0,r=0,i=0;i<t.length;i++)n+=v(t[i],e[i]),r+=t[i]+e[i];return 2*n/r}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,r=0,i=0,o=0,a=0;a<n;a++)r+=t[a]*t[a],i+=e[a]*e[a],o+=(t[a]-e[a])*(t[a]-e[a]);return o/(r+i)}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,r=0,i=0;i<n;i++)r+=v(t[i],e[i]);return 1-r}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,r=0,i=0,o=0,a=0,s=0;s<n;s++)r+=t[s]*e[s],i+=t[s]*t[s],o+=e[s]*e[s],a+=(t[s]-e[s])*(t[s]-e[s]);return a/(i+o-r)}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,r=0,i=0,o=0;o<n;o++)r+=u(t[o]-e[o]),i+=v(t[o],e[o]);return r/i}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,r=0,i=0,o=0;o<n;o++)r+=v(t[o],e[o]),i+=t[o]+e[o];return 1-r/i}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,r=0,i=0;i<n;i++)r+=(R(t[i])-R(e[i]))*(R(t[i])-R(e[i]));return r}},function(t){"use strict";t.exports=function(t,e,n){if(n){for(var r=0,i=0,o=0;o<t.length;o++)r+=t[o]&&e[o],i+=t[o]||e[o];return 0===i?1:r/i}for(var a=t.length,s=0,u=0,c=0,l=0;l<a;l++)s+=t[l],u+=e[l],c+=v(t[l],e[l]);return 1-(s+u-2*c)/(s+u-c)}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,r=0,i=0,o=0,a=0;a<n;a++)r+=t[a]*e[a],i+=t[a]*t[a],o+=e[a]*e[a];return r/(R(i)*R(o))}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,r=Array.from({length:n}).map(()=>Array.from({length:n})),i=0;i<n;i++)for(var o=0;o<=i;o++)r[i][o]=e(t[i],t[o]);for(var a=0;a<n;a++)for(var s=a+1;s<n;s++)r[a][s]=r[s][a];return r}},function(e,t,i){"use strict";function n(e){function t(t,e){if(t.rows!==e.rows||t.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal")}function n(t,e){return t-e}function x(t,e){for(var n in e)t=t.replace(new RegExp("%"+n+"%","g"),e[n]);return t}void 0===e&&(e=Object);class w extends e{static get[Symbol.species](){return this}static from1DArray(t,e,n){if(t*e!==n.length)throw new RangeError("Data length does not match given dimensions");for(var r=new this(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)r.set(i,o,n[i*e+o]);return r}static rowVector(t){for(var e=new this(1,t.length),n=0;n<t.length;n++)e.set(0,n,t[n]);return e}static columnVector(t){for(var e=new this(t.length,1),n=0;n<t.length;n++)e.set(n,0,t[n]);return e}static empty(t,e){return new this(t,e)}static zeros(t,e){return this.empty(t,e).fill(0)}static ones(t,e){return this.empty(t,e).fill(1)}static rand(t,e,n){void 0===n&&(n=Math.random);for(var r=this.empty(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)r.set(i,o,n());return r}static randInt(t,e,n,r){void 0===n&&(n=1e3),void 0===r&&(r=Math.random);for(var i=this.empty(t,e),o=0;o<t;o++)for(var a,s=0;s<e;s++)a=g(r()*n),i.set(o,s,a);return i}static eye(t,e,n){void 0===e&&(e=t),void 0===n&&(n=1);for(var r=v(t,e),i=this.zeros(t,e),o=0;o<r;o++)i.set(o,o,n);return i}static diag(t,e,n){var r=t.length;void 0===e&&(e=r),void 0===n&&(n=e);for(var i=v(r,e,n),o=this.zeros(e,n),a=0;a<i;a++)o.set(a,a,t[a]);return o}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),o=0;o<n;o++)for(var a=0;a<r;a++)i.set(o,a,v(t.get(o,a),e.get(o,a)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),o=0;o<n;o++)for(var a=0;a<r;a++)i.set(o,a,M(t.get(o,a),e.get(o,a)));return i}static checkMatrix(t){return w.isMatrix(t)?t:new this(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=this.rows,n=this.columns,r=0;r<e;r++)for(var i=0;i<n;i++)t.call(this,r,i);return this}to1DArray(){for(var t=Array(this.size),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t[e*this.columns+n]=this.get(e,n);return t}to2DArray(){for(var t=Array(this.rows),e=0;e<this.rows;e++){t[e]=Array(this.columns);for(var n=0;n<this.columns;n++)t[e][n]=this.get(e,n)}return t}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t,e){t=t||1,e=e||1;for(var n=new this.constructor[Symbol.species](this.rows*t,this.columns*e),r=0;r<t;r++)for(var i=0;i<e;i++)n.setSubMatrix(this,this.rows*r,this.columns*i);return n}fill(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,t);return this}neg(){return this.mulS(-1)}getRow(t){l.checkRowIndex(this,t);for(var e=Array(this.columns),n=0;n<this.columns;n++)e[n]=this.get(t,n);return e}getRowVector(t){return this.constructor.rowVector(this.getRow(t))}setRow(t,e){l.checkRowIndex(this,t),e=l.checkRowVector(this,e);for(var n=0;n<this.columns;n++)this.set(t,n,e[n]);return this}swapRows(t,e){l.checkRowIndex(this,t),l.checkRowIndex(this,e);for(var n,r=0;r<this.columns;r++)n=this.get(t,r),this.set(t,r,this.get(e,r)),this.set(e,r,n);return this}getColumn(t){l.checkColumnIndex(this,t);for(var e=Array(this.rows),n=0;n<this.rows;n++)e[n]=this.get(n,t);return e}getColumnVector(t){return this.constructor.columnVector(this.getColumn(t))}setColumn(t,e){l.checkColumnIndex(this,t),e=l.checkColumnVector(this,e);for(var n=0;n<this.rows;n++)this.set(n,t,e[n]);return this}swapColumns(t,e){l.checkColumnIndex(this,t),l.checkColumnIndex(this,e);for(var n,r=0;r<this.rows;r++)n=this.get(r,t),this.set(r,t,this.get(r,e)),this.set(r,e,n);return this}addRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[n]);return this}subRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[n]);return this}mulRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[n]);return this}divRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[n]);return this}addColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[e]);return this}subColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[e]);return this}mulColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[e]);return this}divColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[e]);return this}mulRow(t,e){l.checkRowIndex(this,t);for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this}mulColumn(t,e){l.checkColumnIndex(this,t);for(var n=0;n<this.rows;n++)this.set(n,t,this.get(n,t)*e);return this}max(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)>t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}min(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)<t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}maxRow(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxRowIndex(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r),n[1]=r);return n}minRow(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minRowIndex(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r),n[1]=r);return n}maxColumn(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t));return e}maxColumnIndex(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t),n[0]=r);return n}minColumn(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t));return e}minColumnIndex(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t),n[0]=r);return n}diag(){for(var t=v(this.rows,this.columns),e=Array(t),n=0;n<t;n++)e[n]=this.get(n,n);return e}sum(t){return"row"===t?l.sumByRow(this):"column"===t?l.sumByColumn(this):l.sumAll(this)}mean(){return this.sum()/this.size}prod(){for(var t=1,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t*=this.get(e,n);return t}cumulativeSum(){for(var t=0,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t+=this.get(e,n),this.set(e,n,t);return this}dot(t){w.isMatrix(t)&&(t=t.to1DArray());var e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n}mmul(t){t=this.constructor.checkMatrix(t),this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var e=this.rows,n=this.columns,r=t.columns,i=new this.constructor[Symbol.species](e,r),o=Array(n),a=0;a<r;a++){for(var s=0;s<n;s++)o[s]=t.get(s,a);for(var u,c=0;c<e;c++){for(u=0,s=0;s<n;s++)u+=this.get(c,s)*o[s];i.set(c,a,u)}}return i}strassen2x2(t){var e=new this.constructor[Symbol.species](2,2),n=this.get(0,0),r=t.get(0,0),i=this.get(0,1),o=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),c=t.get(1,1),l=(n+u)*(r+c),h=(a+u)*r,f=n*(o-c),d=u*(s-r),p=(n+i)*c;return e.set(0,0,l+d-p+(i-u)*(s+c)),e.set(0,1,f+p),e.set(1,0,h+d),e.set(1,1,l-h+f+(a-n)*(r+o)),e}strassen3x3(t){var e=new this.constructor[Symbol.species](3,3),n=this.get(0,0),r=this.get(0,1),i=this.get(0,2),o=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),c=this.get(2,1),l=this.get(2,2),h=t.get(0,0),f=t.get(0,1),d=t.get(0,2),p=t.get(1,0),m=t.get(1,1),g=t.get(1,2),v=t.get(2,0),y=t.get(2,1),w=t.get(2,2),b=(n-o)*(-f+m),x=(-n+o+a)*(h-f+m),_=(o+a)*(-h+f),M=n*h,E=(-n+u+c)*(h-d+g),S=(-n+u)*(d-g),T=(u+c)*(-h+d),A=(-i+c+l)*(m+v-y),k=(i-l)*(m-y),C=i*v,R=(c+l)*(-v+y),D=(-i+a+s)*(g+v-w),L=(i-s)*(g-w),O=(a+s)*(-v+w);return e.set(0,0,M+C+r*p),e.set(0,1,(n+r+i-o-a-c-l)*m+x+_+M+A+C+R),e.set(0,2,M+E+T+(n+r+i-a-s-u-c)*g+C+D+O),e.set(1,0,b+a*(-h+f+p-m-g-v+w)+x+M+C+D+L),e.set(1,1,b+x+_+M+s*y),e.set(1,2,C+D+L+O+o*d),e.set(2,0,M+E+S+c*(-h+d+p-m-g-v+y)+A+k+C),e.set(2,1,A+k+C+R+u*f),e.set(2,2,M+E+S+T+l*w),e}mmulStrassen(t){function e(t,e,n){return t.rows===e&&t.columns===n?t:w.zeros(e,n).setSubMatrix(t,0,0)}var n=this.clone(),r=n.rows,i=n.columns,o=t.rows,a=t.columns;i!==o&&console.warn(`Multiplying ${r} x ${i} and ${o} x ${a} matrix: dimensions do not match.`);var s=M(r,o),u=M(i,a);return function t(n,r,i,o){if(512>=i||512>=o)return n.mmul(r);1==i%2&&1==o%2?(n=e(n,i+1,o+1),r=e(r,i+1,o+1)):1==i%2?(n=e(n,i+1,o),r=e(r,i+1,o)):1==o%2&&(n=e(n,i,o+1),r=e(r,i,o+1));var a=parseInt(n.rows/2),s=parseInt(n.columns/2),u=n.subMatrix(0,a-1,0,s-1),c=r.subMatrix(0,a-1,0,s-1),l=n.subMatrix(0,a-1,s,n.columns-1),h=r.subMatrix(0,a-1,s,r.columns-1),f=n.subMatrix(a,n.rows-1,0,s-1),d=r.subMatrix(a,r.rows-1,0,s-1),p=n.subMatrix(a,n.rows-1,s,n.columns-1),m=r.subMatrix(a,r.rows-1,s,r.columns-1),g=t(w.add(u,p),w.add(c,m),a,s),v=t(w.add(f,p),c,a,s),y=t(u,w.sub(h,m),a,s),b=t(p,w.sub(d,c),a,s),x=t(w.add(u,l),m,a,s),_=t(w.sub(f,u),w.add(c,h),a,s),M=t(w.sub(l,p),w.add(d,m),a,s),E=w.add(g,b);E.sub(x),E.add(M);var S=w.add(y,x),T=w.add(v,b),A=w.sub(g,v);A.add(y),A.add(_);var k=w.zeros(2*E.rows,2*E.columns);return(k=(k=(k=(k=k.setSubMatrix(E,0,0)).setSubMatrix(S,E.rows,0)).setSubMatrix(T,0,E.columns)).setSubMatrix(A,E.rows,E.columns)).subMatrix(0,i-1,0,o-1)}(n=e(n,s,u),t=e(t,s,u),s,u)}scaleRows(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n,r=this.constructor.empty(this.rows,this.columns),i=0;i<this.rows;i++)n=s.scale(this.getRow(i),{min:t,max:e}),r.setRow(i,n);return r}scaleColumns(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n,r=this.constructor.empty(this.rows,this.columns),i=0;i<this.columns;i++)n=s.scale(this.getColumn(i),{min:t,max:e}),r.setColumn(i,n);return r}kroneckerProduct(t){t=this.constructor.checkMatrix(t);for(var e=this.rows,n=this.columns,r=t.rows,i=t.columns,o=new this.constructor[Symbol.species](e*r,n*i),a=0;a<e;a++)for(var s=0;s<n;s++)for(var u=0;u<r;u++)for(var c=0;c<i;c++)o[r*a+u][i*s+c]=this.get(a,s)*t.get(u,c);return o}transpose(){for(var t=new this.constructor[Symbol.species](this.columns,this.rows),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(n,e,this.get(e,n));return t}sortRows(t){void 0===t&&(t=n);for(var e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t){void 0===t&&(t=n);for(var e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,n,r){l.checkRange(this,t,e,n,r);for(var i=new this.constructor[Symbol.species](e-t+1,r-n+1),o=t;o<=e;o++)for(var a=n;a<=r;a++)i[o-t][a-n]=this.get(o,a);return i}subMatrixRow(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.columns-1),e>n||0>e||e>=this.columns||0>n||n>=this.columns)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](t.length,n-e+1),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(0>t[i]||t[i]>=this.rows)throw new RangeError("Row index out of range: "+t[i]);r.set(i,o-e,this.get(t[i],o))}return r}subMatrixColumn(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.rows-1),e>n||0>e||e>=this.rows||0>n||n>=this.rows)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](n-e+1,t.length),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(0>t[i]||t[i]>=this.columns)throw new RangeError("Column index out of range: "+t[i]);r.set(o-e,i,this.get(o,t[i]))}return r}setSubMatrix(t,e,n){t=this.constructor.checkMatrix(t),l.checkRange(this,e,e+t.rows-1,n,n+t.columns-1);for(var r=0;r<t.rows;r++)for(var i=0;i<t.columns;i++)this[e+r][n+i]=t.get(r,i);return this}selection(t,e){for(var n,r=l.checkIndices(this,t,e),i=new this.constructor[Symbol.species](t.length,e.length),o=0;o<r.row.length;o++){n=r.row[o];for(var a=0;a<r.column.length;a++)i[o][a]=this.get(n,r.column[a])}return i}trace(){for(var t=v(this.rows,this.columns),e=0,n=0;n<t;n++)e+=this.get(n,n);return e}transposeView(){return new c(this)}rowView(t){return l.checkRowIndex(this,t),new m(this,t)}columnView(t){return l.checkColumnIndex(this,t),new p(this,t)}flipRowView(){return new k(this)}flipColumnView(){return new j(this)}subMatrixView(t,e,n,r){return new d(this,t,e,n,r)}selectionView(t,e){return new h(this,t,e)}det(){var t,e,n,r,i,a;if(this.isSquare())return 2===this.columns?(t=this.get(0,0),e=this.get(0,1),n=this.get(1,0),t*this.get(1,1)-e*n):3===this.columns?(r=this.selectionView([1,2],[1,2]),i=this.selectionView([1,2],[0,2]),a=this.selectionView([1,2],[0,1]),t=this.get(0,0),e=this.get(0,1),n=this.get(0,2),t*r.det()-e*i.det()+n*a.det()):new o(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(t){void 0===t&&(t=a);for(var e=new r(this,{autoTranspose:!0}),n=e.leftSingularVectors,i=e.rightSingularVectors,o=e.diagonal,s=0;s<o.length;s++)o[s]=u(o[s])>t?1/o[s]:0;return o=this.constructor[Symbol.species].diag(o),i.mmul(o.mmul(n.transposeView()))}}w.prototype.klass="Matrix",w.random=w.rand,w.diagonal=w.diag,w.prototype.diagonal=w.prototype.diag,w.identity=w.eye,w.prototype.negate=w.prototype.neg,w.prototype.tensorProduct=w.prototype.kroneckerProduct,w.prototype.determinant=w.prototype.det;var f="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",y="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",b="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",R="\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",I="\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",S="\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",C="\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",V="\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",D="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",z="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",_="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",P=V,A=[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]],L=!0,U=!1,F,i;try{for(var T=A[Symbol.iterator](),q;!(L=(q=T.next()).done);L=!0){var N=q.value,O=eval(x(f,{name:N[1],op:N[0]})),E=eval(x(y,{name:N[1]+"S",op:N[0]})),B=eval(x(b,{name:N[1]+"M",op:N[0]})),Q=eval(x(R,{name:N[1]}));for(F=1;F<N.length;F++)w.prototype[N[F]]=O,w.prototype[N[F]+"S"]=E,w.prototype[N[F]+"M"]=B,w[N[F]]=Q}}catch(e){U=!0,i=e}finally{try{!L&&T.return&&T.return()}finally{if(U)throw i}}var W=[["~","not"]];["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(t){W.push(["Math."+t,t])});var X=!0,J=!1,Y;try{for(var H=W[Symbol.iterator](),K;!(X=(K=H.next()).done);X=!0){var G=K.value,Z=eval(x(I,{name:G[1],method:G[0]})),$=eval(x(S,{name:G[1]}));for(F=1;F<G.length;F++)w.prototype[G[F]]=Z,w[G[F]]=$}}catch(e){J=!0,Y=e}finally{try{!X&&H.return&&H.return()}finally{if(J)throw Y}}var ee=[["Math.pow",1,"pow"]],te=!0,ie=!1,ne;try{for(var oe=ee[Symbol.iterator](),se;!(te=(se=oe.next()).done);te=!0){var re=se.value,ae="arg0";for(F=1;F<re[1];F++)ae+=`, arg${F}`;if(1!==re[1]){var le=eval(x(C,{name:re[2],method:re[0],args:ae})),ce=eval(x(V,{name:re[2],args:ae}));for(F=2;F<re.length;F++)w.prototype[re[F]]=le,w[re[F]]=ce}else{var ue={name:re[2],args:ae,method:re[0]},me=eval(x(_,ue)),de=eval(x(D,ue)),ge=eval(x(z,ue)),he=eval(x(P,ue));for(F=2;F<re.length;F++)w.prototype[re[F]]=me,w.prototype[re[F]+"M"]=ge,w.prototype[re[F]+"S"]=de,w[re[F]]=he}}}catch(e){ie=!0,ne=e}finally{try{!te&&oe.return&&oe.return()}finally{if(ie)throw ne}}return w}e.exports=n;var o=i(70),r=i(71),s=i(1),l=i(24),c=i(194),m=i(195),d=i(196),h=i(197),p=i(198),k=i(199),j=i(200)},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);var e,n,o,a,s,c,l,h,f,d,p=(t=i.Matrix.checkMatrix(t)).clone(),m=p.rows,g=p.columns,y=Array(m),w=1;for(e=0;e<m;e++)y[e]=e;for(f=Array(m),n=0;n<g;n++){for(e=0;e<m;e++)f[e]=p[e][n];for(e=0;e<m;e++){for(h=p[e],d=v(e,n),s=0,o=0;o<d;o++)s+=h[o]*f[o];h[n]=f[e]-=s}for(a=n,e=n+1;e<m;e++)u(f[e])>u(f[a])&&(a=e);if(a!==n){for(o=0;o<g;o++)c=p[a][o],p[a][o]=p[n][o],p[n][o]=c;l=y[a],y[a]=y[n],y[n]=l,w=-w}if(n<m&&0!==p[n][n])for(e=n+1;e<m;e++)p[e][n]/=p[n][n]}this.LU=p,this.pivotVector=y,this.pivotSign=w}var i=n(5);r.prototype={isSingular:function(){for(var t=this.LU,e=t.columns,n=0;n<e;n++)if(0===t[n][n])return!0;return!1},get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var e=this.pivotSign,n=t.columns,r=0;r<n;r++)e*=t[r][r];return e},get lowerTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new i.Matrix(e,n),o=0;o<e;o++)for(var a=0;a<n;a++)r[o][a]=o>a?t[o][a]:o===a?1:0;return r},get upperTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new i.Matrix(e,n),o=0;o<e;o++)for(var a=0;a<n;a++)r[o][a]=o<=a?t[o][a]:0;return r},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(t){t=i.Matrix.checkMatrix(t);var e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var n,r,o,a=t.columns,s=t.subMatrixRow(this.pivotVector,0,a-1),u=e.columns;for(o=0;o<u;o++)for(n=o+1;n<u;n++)for(r=0;r<a;r++)s[n][r]-=s[o][r]*e[n][o];for(o=u-1;0<=o;o--){for(r=0;r<a;r++)s[o][r]/=e[o][o];for(n=0;n<o;n++)for(r=0;r<a;r++)s[n][r]-=s[o][r]*e[n][o]}return s}},t.exports=r},function(t,e,n){"use strict";function r(t,e){if(!(this instanceof r))return new r(t,e);t=i.Matrix.checkMatrix(t),e=e||{};var n=t.rows,o=t.columns,c=v(n,o),l=!0,h=!0;!1===e.computeLeftSingularVectors&&(l=!1),!1===e.computeRightSingularVectors&&(h=!1);var f,d=!1;if(n<o)if(!0===e.autoTranspose){n=(f=t.transpose()).rows,o=f.columns,d=!0;var p=l;l=h,h=p}else f=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else f=t.clone();var m,g,y,w,b,x,_,E,S,T,A,k,C,D,L,O,P,I,N,F,j,z=Array(v(n+1,o)),U=s(n,c,0),V=s(o,o,0),B=Array(o),H=Array(n),q=v(n-1,o),G=M(0,v(o-2,n));for(y=0,T=M(q,G);y<T;y++){if(y<q){for(z[y]=0,m=y;m<n;m++)z[y]=a(z[y],f[m][y]);if(0!==z[y]){for(0>f[y][y]&&(z[y]=-z[y]),m=y;m<n;m++)f[m][y]/=z[y];f[y][y]+=1}z[y]=-z[y]}for(g=y+1;g<o;g++){if(y<q&&0!==z[y]){for(b=0,m=y;m<n;m++)b+=f[m][y]*f[m][g];for(b=-b/f[y][y],m=y;m<n;m++)f[m][g]+=b*f[m][y]}B[g]=f[y][g]}if(l&&y<q)for(m=y;m<n;m++)U[m][y]=f[m][y];if(y<G){for(B[y]=0,m=y+1;m<o;m++)B[y]=a(B[y],B[m]);if(0!==B[y]){for(0>B[y+1]&&(B[y]=0-B[y]),m=y+1;m<o;m++)B[m]/=B[y];B[y+1]+=1}if(B[y]=-B[y],y+1<n&&0!==B[y]){for(m=y+1;m<n;m++)H[m]=0;for(g=y+1;g<o;g++)for(m=y+1;m<n;m++)H[m]+=B[g]*f[m][g];for(g=y+1;g<o;g++)for(b=-B[g]/B[y+1],m=y+1;m<n;m++)f[m][g]+=b*H[m]}if(h)for(m=y+1;m<o;m++)V[m][y]=B[m]}}if(w=v(o,n+1),q<o&&(z[q]=f[q][q]),n<w&&(z[w-1]=0),G+1<w&&(B[G]=f[G][w-1]),B[w-1]=0,l){for(g=q;g<c;g++){for(m=0;m<n;m++)U[m][g]=0;U[g][g]=1}for(y=q-1;0<=y;y--)if(0!==z[y]){for(g=y+1;g<c;g++){for(b=0,m=y;m<n;m++)b+=U[m][y]*U[m][g];for(b=-b/U[y][y],m=y;m<n;m++)U[m][g]+=b*U[m][y]}for(m=y;m<n;m++)U[m][y]=-U[m][y];for(U[y][y]=1+U[y][y],m=0;m<y-1;m++)U[m][y]=0}else{for(m=0;m<n;m++)U[m][y]=0;U[y][y]=1}}if(h)for(y=o-1;0<=y;y--){if(y<G&&0!==B[y])for(g=y+1;g<o;g++){for(b=0,m=y+1;m<o;m++)b+=V[m][y]*V[m][g];for(b=-b/V[y+1][y],m=y+1;m<o;m++)V[m][g]+=b*V[m][y]}for(m=0;m<o;m++)V[m][y]=0;V[y][y]=1}for(var W=w-1,Y=2.220446049250313e-16;0<w;){for(y=w-2;-1<=y&&-1!==y;y--)if(u(B[y])<=Y*(u(z[y])+u(z[y+1]))){B[y]=0;break}if(y===w-2)A=4;else{for(x=w-1;x>=y&&x!==y;x--)if(b=(x===w?0:u(B[x]))+(x===y+1?0:u(B[x-1])),u(z[x])<=Y*b){z[x]=0;break}x===y?A=3:x===w-1?A=1:(A=2,y=x)}switch(y++,A){case 1:for(_=B[w-2],B[w-2]=0,g=w-2;g>=y;g--)if(b=a(z[g],_),E=z[g]/b,S=_/b,z[g]=b,g!==y&&(_=-S*B[g-1],B[g-1]=E*B[g-1]),h)for(m=0;m<o;m++)b=E*V[m][g]+S*V[m][w-1],V[m][w-1]=-S*V[m][g]+E*V[m][w-1],V[m][g]=b;break;case 2:for(_=B[y-1],B[y-1]=0,g=y;g<w;g++)if(b=a(z[g],_),E=z[g]/b,S=_/b,z[g]=b,_=-S*B[g],B[g]=E*B[g],l)for(m=0;m<n;m++)b=E*U[m][g]+S*U[m][y-1],U[m][y-1]=-S*U[m][g]+E*U[m][y-1],U[m][g]=b;break;case 3:for(k=M(M(M(M(u(z[w-1]),u(z[w-2])),u(B[w-2])),u(z[y])),u(B[y])),O=z[y]/k,P=B[y]/k,N=(C=z[w-1]/k)*(L=B[w-2]/k)*(C*L),F=0,(0!=(I=(((D=z[w-2]/k)+C)*(D-C)+L*L)/2)||0!==N)&&(F=R(I*I+N),0>I&&(F=-F),F=N/(I+F)),_=(O+C)*(O-C)+F,j=O*P,g=y;g<w-1;g++){if(E=_/(b=a(_,j)),S=j/b,g!==y&&(B[g-1]=b),_=E*z[g]+S*B[g],B[g]=E*B[g]-S*z[g],j=S*z[g+1],z[g+1]=E*z[g+1],h)for(m=0;m<o;m++)b=E*V[m][g]+S*V[m][g+1],V[m][g+1]=-S*V[m][g]+E*V[m][g+1],V[m][g]=b;if(E=_/(b=a(_,j)),S=j/b,z[g]=b,_=E*B[g]+S*z[g+1],z[g+1]=-S*B[g]+E*z[g+1],j=S*B[g+1],B[g+1]=E*B[g+1],l&&g<n-1)for(m=0;m<n;m++)b=E*U[m][g]+S*U[m][g+1],U[m][g+1]=-S*U[m][g]+E*U[m][g+1],U[m][g]=b}B[w-2]=_;break;case 4:if(0>=z[y]&&(z[y]=0>z[y]?-z[y]:0,h))for(m=0;m<=W;m++)V[m][y]=-V[m][y];for(;y<W&&!(z[y]>=z[y+1]);){if(b=z[y],z[y]=z[y+1],z[y+1]=b,h&&y<o-1)for(m=0;m<o;m++)b=V[m][y+1],V[m][y+1]=V[m][y],V[m][y]=b;if(l&&y<n-1)for(m=0;m<n;m++)b=U[m][y+1],U[m][y+1]=U[m][y],U[m][y]=b;y++}w--}}if(d){var X=V;V=U,U=X}this.m=n,this.n=o,this.s=z,this.U=U,this.V=V}var i=n(5),o=n(38),a=o.hypotenuse,s=o.getFilled2DArray;r.prototype={get condition(){return this.s[0]/this.s[v(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var t=M(this.m,this.n)*this.s[0]*2.220446049250313e-16,e=0,n=this.s,r=0,i=n.length;r<i;r++)n[r]>t&&e++;return e},get diagonal(){return this.s},get threshold(){return 1.1102230246251565e-16*M(this.m,this.n)*this.s[0]},get leftSingularVectors(){return i.Matrix.isMatrix(this.U)||(this.U=new i.Matrix(this.U)),this.U},get rightSingularVectors(){return i.Matrix.isMatrix(this.V)||(this.V=new i.Matrix(this.V)),this.V},get diagonalMatrix(){return i.Matrix.diag(this.s)},solve:function(t){var e,n=this.threshold,r=this.s.length,o=i.Matrix.zeros(r,r);for(e=0;e<r;e++)o[e][e]=u(this.s[e])<=n?0:1/this.s[e];var a,s,c,l=this.U,h=this.rightSingularVectors,f=h.mmul(o),d=h.rows,p=l.length,m=i.Matrix.zeros(d,p);for(e=0;e<d;e++)for(a=0;a<p;a++){for(c=0,s=0;s<r;s++)c+=f[e][s]*l[a][s];m[e][a]=c}return m.mmul(t)},solveForDiagonal:function(t){return this.solve(i.Matrix.diag(t))},inverse:function(){var t,e,n=this.V,r=this.threshold,o=n.length,a=n[0].length,s=new i.Matrix(o,this.s.length);for(t=0;t<o;t++)for(e=0;e<a;e++)s[t][e]=u(this.s[e])>r?n[t][e]/this.s[e]:0;var c,l,h=this.U,f=h.length,d=h[0].length,p=new i.Matrix(o,f);for(t=0;t<o;t++)for(e=0;e<f;e++){for(l=0,c=0;c<d;c++)l+=s[t][c]*h[e][c];p[t][e]=l}return p}},t.exports=r},function(t,e){"use strict";function n(t,e){return t-e}e.sum=function(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e},e.max=function(t){for(var e=-1/0,n=t.length,r=0;r<n;r++)t[r]>e&&(e=t[r]);return e},e.min=function(t){for(var e=1/0,n=t.length,r=0;r<n;r++)t[r]<e&&(e=t[r]);return e},e.minMax=function(t){for(var e=1/0,n=-1/0,r=t.length,i=0;i<r;i++)t[i]<e&&(e=t[i]),t[i]>n&&(n=t[i]);return{min:e,max:n}},e.arithmeticMean=function(t){for(var e=0,n=t.length,r=0;r<n;r++)e+=t[r];return e/n},e.mean=e.arithmeticMean,e.geometricMean=function(t){for(var e=1,n=t.length,r=0;r<n;r++)e*=t[r];return c(e,1/n)},e.logMean=function(t){for(var e=0,n=t.length,i=0;i<n;i++)e+=r(t[i]);return e/n},e.grandMean=function(t,e){for(var n=0,r=0,i=t.length,o=0;o<i;o++)n+=e[o]*t[o],r+=e[o];return n/r},e.truncatedMean=function(t,e,r){void 0===r&&(r=!1),r||(t=t.slice().sort(n));for(var i=t.length,o=g(i*e),a=0,s=o;s<i-o;s++)a+=t[s];return a/(i-2*o)},e.harmonicMean=function(t){for(var e=0,n=t.length,r=0;r<n;r++){if(0===t[r])throw new RangeError("value at index "+r+"is zero");e+=1/t[r]}return n/e},e.contraHarmonicMean=function(t){for(var e=0,n=0,r=t.length,i=0;i<r;i++)e+=t[i]*t[i],n+=t[i];if(0>n)throw new RangeError("sum of values is negative");return e/n},e.median=function(t,e){void 0===e&&(e=!1),e||(t=t.slice().sort(n));var r=t.length,i=g(r/2);return 0==r%2?.5*(t[i-1]+t[i]):t[i]},e.variance=function(t,n){void 0===n&&(n=!0);for(var r,i=e.mean(t),o=0,a=t.length,s=0;s<a;s++)o+=(r=t[s]-i)*r;return n?o/(a-1):o/a},e.standardDeviation=function(t,n){return R(e.variance(t,n))},e.standardError=function(t){return e.standardDeviation(t)/R(t.length)},e.quartiles=function(t,r){"undefined"==typeof r&&(r=!1),r||(t=t.slice()).sort(n);var i=t.length/4;return{q1:t[s(i)-1],q2:e.median(t,!0),q3:t[s(3*i)-1]}},e.pooledStandardDeviation=function(t,n){return R(e.pooledVariance(t,n))},e.pooledVariance=function(t,n){"undefined"==typeof n&&(n=!0);for(var r=0,i=0,o=t.length,a=0;a<o;a++){var s=t[a],u=e.variance(s);r+=(s.length-1)*u,i+=n?s.length-1:s.length}return r/i},e.mode=function(t){var e,n=t.length,r=Array(n);for(e=0;e<n;e++)r[e]=0;var i=Array(n),o=0;for(e=0;e<n;e++){var a=i.indexOf(t[e]);0<=a?r[a]++:(i[o]=t[e],r[o]=1,o++)}var s=0,u=0;for(e=0;e<o;e++)r[e]>s&&(s=r[e],u=e);return i[u]},e.covariance=function(t,n,r){"undefined"==typeof r&&(r=!0);var i=e.mean(t),o=e.mean(n);if(t.length!==n.length)throw"Vectors do not have the same dimensions";for(var a=0,s=t.length,u=0;u<s;u++)a+=(t[u]-i)*(n[u]-o);return r?a/(s-1):a/s},e.skewness=function(t,n){"undefined"==typeof n&&(n=!0);for(var r,i=e.mean(t),o=0,a=0,s=t.length,u=0;u<s;u++)o+=(r=t[u]-i)*r,a+=r*r*r;var l=a/s/c(o/s,1.5);return n?R(s*(s-1))/(s-2)*l:l},e.kurtosis=function(t,n){"undefined"==typeof n&&(n=!0);for(var r,i=e.mean(t),o=t.length,a=0,s=0,u=0;u<o;u++)a+=(r=t[u]-i)*r,s+=r*r*r*r;var c=a/o,l=s/o;if(n){var h=a/(o-1);return o*(o+1)/((o-1)*(o-2)*(o-3))*(s/(h*h))-(o-1)*(o-1)/((o-2)*(o-3))*3}return l/(c*c)-3},e.entropy=function(t,e){"undefined"==typeof e&&(e=0);for(var n=0,i=t.length,o=0;o<i;o++)n+=t[o]*r(t[o]+e);return-n},e.weightedMean=function(t,e){for(var n=0,r=t.length,i=0;i<r;i++)n+=t[i]*e[i];return n},e.weightedStandardDeviation=function(t,n){return R(e.weightedVariance(t,n))},e.weightedVariance=function(t,n){for(var r=e.weightedMean(t,n),i=0,o=t.length,a=0,s=0,u=0;u<o;u++){var c=t[u]-r,l=n[u];i+=l*(c*c),s+=l,a+=l*l}return i*(s/(s*s-a))},e.center=function(t,n){"undefined"==typeof n&&(n=!1);var r=t;n||(r=t.slice());for(var i=e.mean(r),o=r.length,a=0;a<o;a++)r[a]-=i},e.standardize=function(t,n,r){"undefined"==typeof n&&(n=e.standardDeviation(t)),"undefined"==typeof r&&(r=!1);for(var i=t.length,o=r?t:Array(i),a=0;a<i;a++)o[a]=t[a]/n;return o},e.cumulativeSum=function(t){var e=t.length,n=Array(e);n[0]=t[0];for(var r=1;r<e;r++)n[r]=n[r-1]+t[r];return n}},function(e,t,i){"use strict";function n(e){function t(t,e){if(t.rows!==e.rows||t.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal")}function n(t,e){return t-e}function x(t,e){for(var n in e)t=t.replace(new RegExp("%"+n+"%","g"),e[n]);return t}void 0===e&&(e=Object);class w extends e{static get[Symbol.species](){return this}static from1DArray(t,e,n){if(t*e!==n.length)throw new RangeError("Data length does not match given dimensions");for(var r=new this(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)r.set(i,o,n[i*e+o]);return r}static rowVector(t){for(var e=new this(1,t.length),n=0;n<t.length;n++)e.set(0,n,t[n]);return e}static columnVector(t){for(var e=new this(t.length,1),n=0;n<t.length;n++)e.set(n,0,t[n]);return e}static empty(t,e){return new this(t,e)}static zeros(t,e){return this.empty(t,e).fill(0)}static ones(t,e){return this.empty(t,e).fill(1)}static rand(t,e,n){void 0===n&&(n=Math.random);for(var r=this.empty(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)r.set(i,o,n());return r}static randInt(t,e,n,r){void 0===n&&(n=1e3),void 0===r&&(r=Math.random);for(var i=this.empty(t,e),o=0;o<t;o++)for(var a,s=0;s<e;s++)a=g(r()*n),i.set(o,s,a);return i}static eye(t,e,n){void 0===e&&(e=t),void 0===n&&(n=1);for(var r=v(t,e),i=this.zeros(t,e),o=0;o<r;o++)i.set(o,o,n);return i}static diag(t,e,n){var r=t.length;void 0===e&&(e=r),void 0===n&&(n=e);for(var i=v(r,e,n),o=this.zeros(e,n),a=0;a<i;a++)o.set(a,a,t[a]);return o}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),o=0;o<n;o++)for(var a=0;a<r;a++)i.set(o,a,v(t.get(o,a),e.get(o,a)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),o=0;o<n;o++)for(var a=0;a<r;a++)i.set(o,a,M(t.get(o,a),e.get(o,a)));return i}static checkMatrix(t){return w.isMatrix(t)?t:new this(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=this.rows,n=this.columns,r=0;r<e;r++)for(var i=0;i<n;i++)t.call(this,r,i);return this}to1DArray(){for(var t=Array(this.size),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t[e*this.columns+n]=this.get(e,n);return t}to2DArray(){for(var t=Array(this.rows),e=0;e<this.rows;e++){t[e]=Array(this.columns);for(var n=0;n<this.columns;n++)t[e][n]=this.get(e,n)}return t}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t,e){t=t||1,e=e||1;for(var n=new this.constructor[Symbol.species](this.rows*t,this.columns*e),r=0;r<t;r++)for(var i=0;i<e;i++)n.setSubMatrix(this,this.rows*r,this.columns*i);return n}fill(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,t);return this}neg(){return this.mulS(-1)}getRow(t){l.checkRowIndex(this,t);for(var e=Array(this.columns),n=0;n<this.columns;n++)e[n]=this.get(t,n);return e}getRowVector(t){return this.constructor.rowVector(this.getRow(t))}setRow(t,e){l.checkRowIndex(this,t),e=l.checkRowVector(this,e);for(var n=0;n<this.columns;n++)this.set(t,n,e[n]);return this}swapRows(t,e){l.checkRowIndex(this,t),l.checkRowIndex(this,e);for(var n,r=0;r<this.columns;r++)n=this.get(t,r),this.set(t,r,this.get(e,r)),this.set(e,r,n);return this}getColumn(t){l.checkColumnIndex(this,t);for(var e=Array(this.rows),n=0;n<this.rows;n++)e[n]=this.get(n,t);return e}getColumnVector(t){return this.constructor.columnVector(this.getColumn(t))}setColumn(t,e){l.checkColumnIndex(this,t),e=l.checkColumnVector(this,e);for(var n=0;n<this.rows;n++)this.set(n,t,e[n]);return this}swapColumns(t,e){l.checkColumnIndex(this,t),l.checkColumnIndex(this,e);for(var n,r=0;r<this.rows;r++)n=this.get(r,t),this.set(r,t,this.get(r,e)),this.set(r,e,n);return this}addRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[n]);return this}subRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[n]);return this}mulRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[n]);return this}divRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[n]);return this}addColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[e]);return this}subColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[e]);return this}mulColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[e]);return this}divColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[e]);return this}mulRow(t,e){l.checkRowIndex(this,t);for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this}mulColumn(t,e){l.checkColumnIndex(this,t);for(var n=0;n<this.rows;n++)this.set(n,t,this.get(n,t)*e);return this}max(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)>t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}min(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)<t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}maxRow(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxRowIndex(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r),n[1]=r);return n}minRow(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minRowIndex(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r),n[1]=r);return n}maxColumn(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t));return e}maxColumnIndex(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t),n[0]=r);return n}minColumn(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t));return e}minColumnIndex(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t),n[0]=r);return n}diag(){for(var t=v(this.rows,this.columns),e=Array(t),n=0;n<t;n++)e[n]=this.get(n,n);return e}sum(t){return"row"===t?l.sumByRow(this):"column"===t?l.sumByColumn(this):l.sumAll(this)}mean(){return this.sum()/this.size}prod(){for(var t=1,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t*=this.get(e,n);return t}cumulativeSum(){for(var t=0,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t+=this.get(e,n),this.set(e,n,t);return this}dot(t){w.isMatrix(t)&&(t=t.to1DArray());var e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n}mmul(t){t=this.constructor.checkMatrix(t),this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var e=this.rows,n=this.columns,r=t.columns,i=new this.constructor[Symbol.species](e,r),o=Array(n),a=0;a<r;a++){for(var s=0;s<n;s++)o[s]=t.get(s,a);for(var u,c=0;c<e;c++){for(u=0,s=0;s<n;s++)u+=this.get(c,s)*o[s];i.set(c,a,u)}}return i}strassen2x2(t){var e=new this.constructor[Symbol.species](2,2),n=this.get(0,0),r=t.get(0,0),i=this.get(0,1),o=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),c=t.get(1,1),l=(n+u)*(r+c),h=(a+u)*r,f=n*(o-c),d=u*(s-r),p=(n+i)*c;return e.set(0,0,l+d-p+(i-u)*(s+c)),e.set(0,1,f+p),e.set(1,0,h+d),e.set(1,1,l-h+f+(a-n)*(r+o)),e}strassen3x3(t){var e=new this.constructor[Symbol.species](3,3),n=this.get(0,0),r=this.get(0,1),i=this.get(0,2),o=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),c=this.get(2,1),l=this.get(2,2),h=t.get(0,0),f=t.get(0,1),d=t.get(0,2),p=t.get(1,0),m=t.get(1,1),g=t.get(1,2),v=t.get(2,0),y=t.get(2,1),w=t.get(2,2),b=(n-o)*(-f+m),x=(-n+o+a)*(h-f+m),_=(o+a)*(-h+f),M=n*h,E=(-n+u+c)*(h-d+g),S=(-n+u)*(d-g),T=(u+c)*(-h+d),A=(-i+c+l)*(m+v-y),k=(i-l)*(m-y),C=i*v,R=(c+l)*(-v+y),D=(-i+a+s)*(g+v-w),L=(i-s)*(g-w),O=(a+s)*(-v+w);return e.set(0,0,M+C+r*p),e.set(0,1,(n+r+i-o-a-c-l)*m+x+_+M+A+C+R),e.set(0,2,M+E+T+(n+r+i-a-s-u-c)*g+C+D+O),e.set(1,0,b+a*(-h+f+p-m-g-v+w)+x+M+C+D+L),e.set(1,1,b+x+_+M+s*y),e.set(1,2,C+D+L+O+o*d),e.set(2,0,M+E+S+c*(-h+d+p-m-g-v+y)+A+k+C),e.set(2,1,A+k+C+R+u*f),e.set(2,2,M+E+S+T+l*w),e}mmulStrassen(t){function e(t,e,n){return t.rows===e&&t.columns===n?t:w.zeros(e,n).setSubMatrix(t,0,0)}var n=this.clone(),r=n.rows,i=n.columns,o=t.rows,a=t.columns;i!==o&&console.warn(`Multiplying ${r} x ${i} and ${o} x ${a} matrix: dimensions do not match.`);var s=M(r,o),u=M(i,a);return function t(n,r,i,o){if(512>=i||512>=o)return n.mmul(r);1==i%2&&1==o%2?(n=e(n,i+1,o+1),r=e(r,i+1,o+1)):1==i%2?(n=e(n,i+1,o),r=e(r,i+1,o)):1==o%2&&(n=e(n,i,o+1),r=e(r,i,o+1));var a=parseInt(n.rows/2),s=parseInt(n.columns/2),u=n.subMatrix(0,a-1,0,s-1),c=r.subMatrix(0,a-1,0,s-1),l=n.subMatrix(0,a-1,s,n.columns-1),h=r.subMatrix(0,a-1,s,r.columns-1),f=n.subMatrix(a,n.rows-1,0,s-1),d=r.subMatrix(a,r.rows-1,0,s-1),p=n.subMatrix(a,n.rows-1,s,n.columns-1),m=r.subMatrix(a,r.rows-1,s,r.columns-1),g=t(w.add(u,p),w.add(c,m),a,s),v=t(w.add(f,p),c,a,s),y=t(u,w.sub(h,m),a,s),b=t(p,w.sub(d,c),a,s),x=t(w.add(u,l),m,a,s),_=t(w.sub(f,u),w.add(c,h),a,s),M=t(w.sub(l,p),w.add(d,m),a,s),E=w.add(g,b);E.sub(x),E.add(M);var S=w.add(y,x),T=w.add(v,b),A=w.sub(g,v);A.add(y),A.add(_);var k=w.zeros(2*E.rows,2*E.columns);return(k=(k=(k=(k=k.setSubMatrix(E,0,0)).setSubMatrix(S,E.rows,0)).setSubMatrix(T,0,E.columns)).setSubMatrix(A,E.rows,E.columns)).subMatrix(0,i-1,0,o-1)}(n=e(n,s,u),t=e(t,s,u),s,u)}scaleRows(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n,r=this.constructor.empty(this.rows,this.columns),i=0;i<this.rows;i++)n=s.scale(this.getRow(i),{min:t,max:e}),r.setRow(i,n);return r}scaleColumns(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n,r=this.constructor.empty(this.rows,this.columns),i=0;i<this.columns;i++)n=s.scale(this.getColumn(i),{min:t,max:e}),r.setColumn(i,n);return r}kroneckerProduct(t){t=this.constructor.checkMatrix(t);for(var e=this.rows,n=this.columns,r=t.rows,i=t.columns,o=new this.constructor[Symbol.species](e*r,n*i),a=0;a<e;a++)for(var s=0;s<n;s++)for(var u=0;u<r;u++)for(var c=0;c<i;c++)o[r*a+u][i*s+c]=this.get(a,s)*t.get(u,c);return o}transpose(){for(var t=new this.constructor[Symbol.species](this.columns,this.rows),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(n,e,this.get(e,n));return t}sortRows(t){void 0===t&&(t=n);for(var e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t){void 0===t&&(t=n);for(var e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,n,r){l.checkRange(this,t,e,n,r);for(var i=new this.constructor[Symbol.species](e-t+1,r-n+1),o=t;o<=e;o++)for(var a=n;a<=r;a++)i[o-t][a-n]=this.get(o,a);return i}subMatrixRow(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.columns-1),e>n||0>e||e>=this.columns||0>n||n>=this.columns)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](t.length,n-e+1),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(0>t[i]||t[i]>=this.rows)throw new RangeError("Row index out of range: "+t[i]);r.set(i,o-e,this.get(t[i],o))}return r}subMatrixColumn(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.rows-1),e>n||0>e||e>=this.rows||0>n||n>=this.rows)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](n-e+1,t.length),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(0>t[i]||t[i]>=this.columns)throw new RangeError("Column index out of range: "+t[i]);r.set(o-e,i,this.get(o,t[i]))}return r}setSubMatrix(t,e,n){t=this.constructor.checkMatrix(t),l.checkRange(this,e,e+t.rows-1,n,n+t.columns-1);for(var r=0;r<t.rows;r++)for(var i=0;i<t.columns;i++)this[e+r][n+i]=t.get(r,i);return this}selection(t,e){for(var n,r=l.checkIndices(this,t,e),i=new this.constructor[Symbol.species](t.length,e.length),o=0;o<r.row.length;o++){n=r.row[o];for(var a=0;a<r.column.length;a++)i[o][a]=this.get(n,r.column[a])}return i}trace(){for(var t=v(this.rows,this.columns),e=0,n=0;n<t;n++)e+=this.get(n,n);return e}transposeView(){return new c(this)}rowView(t){return l.checkRowIndex(this,t),new m(this,t)}columnView(t){return l.checkColumnIndex(this,t),new p(this,t)}flipRowView(){return new k(this)}flipColumnView(){return new j(this)}subMatrixView(t,e,n,r){return new d(this,t,e,n,r)}selectionView(t,e){return new h(this,t,e)}det(){var t,e,n,r,i,a;if(this.isSquare())return 2===this.columns?(t=this.get(0,0),e=this.get(0,1),n=this.get(1,0),t*this.get(1,1)-e*n):3===this.columns?(r=this.selectionView([1,2],[1,2]),i=this.selectionView([1,2],[0,2]),a=this.selectionView([1,2],[0,1]),t=this.get(0,0),e=this.get(0,1),n=this.get(0,2),t*r.det()-e*i.det()+n*a.det()):new o(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(t){void 0===t&&(t=a);for(var e=new r(this,{autoTranspose:!0}),n=e.leftSingularVectors,i=e.rightSingularVectors,o=e.diagonal,s=0;s<o.length;s++)o[s]=u(o[s])>t?1/o[s]:0;return o=this.constructor[Symbol.species].diag(o),i.mmul(o.mmul(n.transposeView()))}}w.prototype.klass="Matrix",w.random=w.rand,w.diagonal=w.diag,w.prototype.diagonal=w.prototype.diag,w.identity=w.eye,w.prototype.negate=w.prototype.neg,w.prototype.tensorProduct=w.prototype.kroneckerProduct,w.prototype.determinant=w.prototype.det;var f="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",y="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",b="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",R="\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",I="\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",S="\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",C="\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",V="\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",D="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",z="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",_="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",P=V,A=[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]],L=!0,U=!1,F,i;try{for(var T=A[Symbol.iterator](),q;!(L=(q=T.next()).done);L=!0){var N=q.value,O=eval(x(f,{name:N[1],op:N[0]})),E=eval(x(y,{name:N[1]+"S",op:N[0]})),B=eval(x(b,{name:N[1]+"M",op:N[0]})),Q=eval(x(R,{name:N[1]}));for(F=1;F<N.length;F++)w.prototype[N[F]]=O,w.prototype[N[F]+"S"]=E,w.prototype[N[F]+"M"]=B,w[N[F]]=Q}}catch(e){U=!0,i=e}finally{try{!L&&T.return&&T.return()}finally{if(U)throw i}}var W=[["~","not"]];["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(t){W.push(["Math."+t,t])});var X=!0,J=!1,Y;try{for(var H=W[Symbol.iterator](),K;!(X=(K=H.next()).done);X=!0){var G=K.value,Z=eval(x(I,{name:G[1],method:G[0]})),$=eval(x(S,{name:G[1]}));for(F=1;F<G.length;F++)w.prototype[G[F]]=Z,w[G[F]]=$}}catch(e){J=!0,Y=e}finally{try{!X&&H.return&&H.return()}finally{if(J)throw Y}}var ee=[["Math.pow",1,"pow"]],te=!0,ie=!1,ne;try{for(var oe=ee[Symbol.iterator](),se;!(te=(se=oe.next()).done);te=!0){var re=se.value,ae="arg0";for(F=1;F<re[1];F++)ae+=`, arg${F}`;if(1!==re[1]){var le=eval(x(C,{name:re[2],method:re[0],args:ae})),ce=eval(x(V,{name:re[2],args:ae}));for(F=2;F<re.length;F++)w.prototype[re[F]]=le,w[re[F]]=ce}else{var ue={name:re[2],args:ae,method:re[0]},me=eval(x(_,ue)),de=eval(x(D,ue)),ge=eval(x(z,ue)),he=eval(x(P,ue));for(F=2;F<re.length;F++)w.prototype[re[F]]=me,w.prototype[re[F]+"M"]=ge,w.prototype[re[F]+"S"]=de,w[re[F]]=he}}}catch(e){ie=!0,ne=e}finally{try{!te&&oe.return&&oe.return()}finally{if(ie)throw ne}}return w}e.exports=n;var o=i(74),r=i(75),s=i(1),l=i(25),c=i(212),m=i(213),d=i(214),h=i(215),p=i(216),k=i(217),j=i(218)},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);var e,n,o,a,s,c,l,h,f,d,p=(t=i.Matrix.checkMatrix(t)).clone(),m=p.rows,g=p.columns,y=Array(m),w=1;for(e=0;e<m;e++)y[e]=e;for(f=Array(m),n=0;n<g;n++){for(e=0;e<m;e++)f[e]=p[e][n];for(e=0;e<m;e++){for(h=p[e],d=v(e,n),s=0,o=0;o<d;o++)s+=h[o]*f[o];h[n]=f[e]-=s}for(a=n,e=n+1;e<m;e++)u(f[e])>u(f[a])&&(a=e);if(a!==n){for(o=0;o<g;o++)c=p[a][o],p[a][o]=p[n][o],p[n][o]=c;l=y[a],y[a]=y[n],y[n]=l,w=-w}if(n<m&&0!==p[n][n])for(e=n+1;e<m;e++)p[e][n]/=p[n][n]}this.LU=p,this.pivotVector=y,this.pivotSign=w}var i=n(6);r.prototype={isSingular:function(){for(var t=this.LU,e=t.columns,n=0;n<e;n++)if(0===t[n][n])return!0;return!1},get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var e=this.pivotSign,n=t.columns,r=0;r<n;r++)e*=t[r][r];return e},get lowerTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new i.Matrix(e,n),o=0;o<e;o++)for(var a=0;a<n;a++)r[o][a]=o>a?t[o][a]:o===a?1:0;return r},get upperTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new i.Matrix(e,n),o=0;o<e;o++)for(var a=0;a<n;a++)r[o][a]=o<=a?t[o][a]:0;return r},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(t){t=i.Matrix.checkMatrix(t);var e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var n,r,o,a=t.columns,s=t.subMatrixRow(this.pivotVector,0,a-1),u=e.columns;for(o=0;o<u;o++)for(n=o+1;n<u;n++)for(r=0;r<a;r++)s[n][r]-=s[o][r]*e[n][o];for(o=u-1;0<=o;o--){for(r=0;r<a;r++)s[o][r]/=e[o][o];for(n=0;n<o;n++)for(r=0;r<a;r++)s[n][r]-=s[o][r]*e[n][o]}return s}},t.exports=r},function(t,e,n){"use strict";function r(t,e){if(!(this instanceof r))return new r(t,e);t=i.Matrix.checkMatrix(t),e=e||{};var n=t.rows,o=t.columns,c=v(n,o),l=!0,h=!0;!1===e.computeLeftSingularVectors&&(l=!1),!1===e.computeRightSingularVectors&&(h=!1);var f,d=!1;if(n<o)if(!0===e.autoTranspose){n=(f=t.transpose()).rows,o=f.columns,d=!0;var p=l;l=h,h=p}else f=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else f=t.clone();var m,g,y,w,b,x,_,E,S,T,A,k,C,D,L,O,P,I,N,F,j,z=Array(v(n+1,o)),U=s(n,c,0),V=s(o,o,0),B=Array(o),H=Array(n),q=v(n-1,o),G=M(0,v(o-2,n));for(y=0,T=M(q,G);y<T;y++){if(y<q){for(z[y]=0,m=y;m<n;m++)z[y]=a(z[y],f[m][y]);if(0!==z[y]){for(0>f[y][y]&&(z[y]=-z[y]),m=y;m<n;m++)f[m][y]/=z[y];f[y][y]+=1}z[y]=-z[y]}for(g=y+1;g<o;g++){if(y<q&&0!==z[y]){for(b=0,m=y;m<n;m++)b+=f[m][y]*f[m][g];for(b=-b/f[y][y],m=y;m<n;m++)f[m][g]+=b*f[m][y]}B[g]=f[y][g]}if(l&&y<q)for(m=y;m<n;m++)U[m][y]=f[m][y];if(y<G){for(B[y]=0,m=y+1;m<o;m++)B[y]=a(B[y],B[m]);if(0!==B[y]){for(0>B[y+1]&&(B[y]=0-B[y]),m=y+1;m<o;m++)B[m]/=B[y];B[y+1]+=1}if(B[y]=-B[y],y+1<n&&0!==B[y]){for(m=y+1;m<n;m++)H[m]=0;for(g=y+1;g<o;g++)for(m=y+1;m<n;m++)H[m]+=B[g]*f[m][g];for(g=y+1;g<o;g++)for(b=-B[g]/B[y+1],m=y+1;m<n;m++)f[m][g]+=b*H[m]}if(h)for(m=y+1;m<o;m++)V[m][y]=B[m]}}if(w=v(o,n+1),q<o&&(z[q]=f[q][q]),n<w&&(z[w-1]=0),G+1<w&&(B[G]=f[G][w-1]),B[w-1]=0,l){for(g=q;g<c;g++){for(m=0;m<n;m++)U[m][g]=0;U[g][g]=1}for(y=q-1;0<=y;y--)if(0!==z[y]){for(g=y+1;g<c;g++){for(b=0,m=y;m<n;m++)b+=U[m][y]*U[m][g];for(b=-b/U[y][y],m=y;m<n;m++)U[m][g]+=b*U[m][y]}for(m=y;m<n;m++)U[m][y]=-U[m][y];for(U[y][y]=1+U[y][y],m=0;m<y-1;m++)U[m][y]=0}else{for(m=0;m<n;m++)U[m][y]=0;U[y][y]=1}}if(h)for(y=o-1;0<=y;y--){if(y<G&&0!==B[y])for(g=y+1;g<o;g++){for(b=0,m=y+1;m<o;m++)b+=V[m][y]*V[m][g];for(b=-b/V[y+1][y],m=y+1;m<o;m++)V[m][g]+=b*V[m][y]}for(m=0;m<o;m++)V[m][y]=0;V[y][y]=1}for(var W=w-1,Y=2.220446049250313e-16;0<w;){for(y=w-2;-1<=y&&-1!==y;y--)if(u(B[y])<=Y*(u(z[y])+u(z[y+1]))){B[y]=0;break}if(y===w-2)A=4;else{for(x=w-1;x>=y&&x!==y;x--)if(b=(x===w?0:u(B[x]))+(x===y+1?0:u(B[x-1])),u(z[x])<=Y*b){z[x]=0;break}x===y?A=3:x===w-1?A=1:(A=2,y=x)}switch(y++,A){case 1:for(_=B[w-2],B[w-2]=0,g=w-2;g>=y;g--)if(b=a(z[g],_),E=z[g]/b,S=_/b,z[g]=b,g!==y&&(_=-S*B[g-1],B[g-1]=E*B[g-1]),h)for(m=0;m<o;m++)b=E*V[m][g]+S*V[m][w-1],V[m][w-1]=-S*V[m][g]+E*V[m][w-1],V[m][g]=b;break;case 2:for(_=B[y-1],B[y-1]=0,g=y;g<w;g++)if(b=a(z[g],_),E=z[g]/b,S=_/b,z[g]=b,_=-S*B[g],B[g]=E*B[g],l)for(m=0;m<n;m++)b=E*U[m][g]+S*U[m][y-1],U[m][y-1]=-S*U[m][g]+E*U[m][y-1],U[m][g]=b;break;case 3:for(k=M(M(M(M(u(z[w-1]),u(z[w-2])),u(B[w-2])),u(z[y])),u(B[y])),O=z[y]/k,P=B[y]/k,N=(C=z[w-1]/k)*(L=B[w-2]/k)*(C*L),F=0,(0!=(I=(((D=z[w-2]/k)+C)*(D-C)+L*L)/2)||0!==N)&&(F=R(I*I+N),0>I&&(F=-F),F=N/(I+F)),_=(O+C)*(O-C)+F,j=O*P,g=y;g<w-1;g++){if(E=_/(b=a(_,j)),S=j/b,g!==y&&(B[g-1]=b),_=E*z[g]+S*B[g],B[g]=E*B[g]-S*z[g],j=S*z[g+1],z[g+1]=E*z[g+1],h)for(m=0;m<o;m++)b=E*V[m][g]+S*V[m][g+1],V[m][g+1]=-S*V[m][g]+E*V[m][g+1],V[m][g]=b;if(E=_/(b=a(_,j)),S=j/b,z[g]=b,_=E*B[g]+S*z[g+1],z[g+1]=-S*B[g]+E*z[g+1],j=S*B[g+1],B[g+1]=E*B[g+1],l&&g<n-1)for(m=0;m<n;m++)b=E*U[m][g]+S*U[m][g+1],U[m][g+1]=-S*U[m][g]+E*U[m][g+1],U[m][g]=b}B[w-2]=_;break;case 4:if(0>=z[y]&&(z[y]=0>z[y]?-z[y]:0,h))for(m=0;m<=W;m++)V[m][y]=-V[m][y];for(;y<W&&!(z[y]>=z[y+1]);){if(b=z[y],z[y]=z[y+1],z[y+1]=b,h&&y<o-1)for(m=0;m<o;m++)b=V[m][y+1],V[m][y+1]=V[m][y],V[m][y]=b;if(l&&y<n-1)for(m=0;m<n;m++)b=U[m][y+1],U[m][y+1]=U[m][y],U[m][y]=b;y++}w--}}if(d){var X=V;V=U,U=X}this.m=n,this.n=o,this.s=z,this.U=U,this.V=V}var i=n(6),o=n(39),a=o.hypotenuse,s=o.getFilled2DArray;r.prototype={get condition(){return this.s[0]/this.s[v(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var t=M(this.m,this.n)*this.s[0]*2.220446049250313e-16,e=0,n=this.s,r=0,i=n.length;r<i;r++)n[r]>t&&e++;return e},get diagonal(){return this.s},get threshold(){return 1.1102230246251565e-16*M(this.m,this.n)*this.s[0]},get leftSingularVectors(){return i.Matrix.isMatrix(this.U)||(this.U=new i.Matrix(this.U)),this.U},get rightSingularVectors(){return i.Matrix.isMatrix(this.V)||(this.V=new i.Matrix(this.V)),this.V},get diagonalMatrix(){return i.Matrix.diag(this.s)},solve:function(t){var e,n=this.threshold,r=this.s.length,o=i.Matrix.zeros(r,r);for(e=0;e<r;e++)o[e][e]=u(this.s[e])<=n?0:1/this.s[e];var a,s,c,l=this.U,h=this.rightSingularVectors,f=h.mmul(o),d=h.rows,p=l.length,m=i.Matrix.zeros(d,p);for(e=0;e<d;e++)for(a=0;a<p;a++){for(c=0,s=0;s<r;s++)c+=f[e][s]*l[a][s];m[e][a]=c}return m.mmul(t)},solveForDiagonal:function(t){return this.solve(i.Matrix.diag(t))},inverse:function(){var t,e,n=this.V,r=this.threshold,o=n.length,a=n[0].length,s=new i.Matrix(o,this.s.length);for(t=0;t<o;t++)for(e=0;e<a;e++)s[t][e]=u(this.s[e])>r?n[t][e]/this.s[e]:0;var c,l,h=this.U,f=h.length,d=h[0].length,p=new i.Matrix(o,f);for(t=0;t<o;t++)for(e=0;e<f;e++){for(l=0,c=0;c<d;c++)l+=s[t][c]*h[e][c];p[t][e]=l}return p}},t.exports=r},function(e,t,i){"use strict";function n(e){function t(t,e){if(t.rows!==e.rows||t.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal")}function n(t,e){return t-e}function x(t,e){for(var n in e)t=t.replace(new RegExp("%"+n+"%","g"),e[n]);return t}void 0===e&&(e=Object);class w extends e{static get[Symbol.species](){return this}static from1DArray(t,e,n){if(t*e!==n.length)throw new RangeError("Data length does not match given dimensions");for(var r=new this(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)r.set(i,o,n[i*e+o]);return r}static rowVector(t){for(var e=new this(1,t.length),n=0;n<t.length;n++)e.set(0,n,t[n]);return e}static columnVector(t){for(var e=new this(t.length,1),n=0;n<t.length;n++)e.set(n,0,t[n]);return e}static empty(t,e){return new this(t,e)}static zeros(t,e){return this.empty(t,e).fill(0)}static ones(t,e){return this.empty(t,e).fill(1)}static rand(t,e,n){void 0===n&&(n=Math.random);for(var r=this.empty(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)r.set(i,o,n());return r}static randInt(t,e,n,r){void 0===n&&(n=1e3),void 0===r&&(r=Math.random);for(var i=this.empty(t,e),o=0;o<t;o++)for(var a,s=0;s<e;s++)a=g(r()*n),i.set(o,s,a);return i}static eye(t,e,n){void 0===e&&(e=t),void 0===n&&(n=1);for(var r=v(t,e),i=this.zeros(t,e),o=0;o<r;o++)i.set(o,o,n);return i}static diag(t,e,n){var r=t.length;void 0===e&&(e=r),void 0===n&&(n=e);for(var i=v(r,e,n),o=this.zeros(e,n),a=0;a<i;a++)o.set(a,a,t[a]);return o}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),o=0;o<n;o++)for(var a=0;a<r;a++)i.set(o,a,v(t.get(o,a),e.get(o,a)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),o=0;o<n;o++)for(var a=0;a<r;a++)i.set(o,a,M(t.get(o,a),e.get(o,a)));return i}static checkMatrix(t){return w.isMatrix(t)?t:new this(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=this.rows,n=this.columns,r=0;r<e;r++)for(var i=0;i<n;i++)t.call(this,r,i);return this}to1DArray(){for(var t=Array(this.size),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t[e*this.columns+n]=this.get(e,n);return t}to2DArray(){for(var t=Array(this.rows),e=0;e<this.rows;e++){t[e]=Array(this.columns);for(var n=0;n<this.columns;n++)t[e][n]=this.get(e,n)}return t}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t,e){t=t||1,e=e||1;for(var n=new this.constructor[Symbol.species](this.rows*t,this.columns*e),r=0;r<t;r++)for(var i=0;i<e;i++)n.setSubMatrix(this,this.rows*r,this.columns*i);return n}fill(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,t);return this}neg(){return this.mulS(-1)}getRow(t){l.checkRowIndex(this,t);for(var e=Array(this.columns),n=0;n<this.columns;n++)e[n]=this.get(t,n);return e}getRowVector(t){return this.constructor.rowVector(this.getRow(t))}setRow(t,e){l.checkRowIndex(this,t),e=l.checkRowVector(this,e);for(var n=0;n<this.columns;n++)this.set(t,n,e[n]);return this}swapRows(t,e){l.checkRowIndex(this,t),l.checkRowIndex(this,e);for(var n,r=0;r<this.columns;r++)n=this.get(t,r),this.set(t,r,this.get(e,r)),this.set(e,r,n);return this}getColumn(t){l.checkColumnIndex(this,t);for(var e=Array(this.rows),n=0;n<this.rows;n++)e[n]=this.get(n,t);return e}getColumnVector(t){return this.constructor.columnVector(this.getColumn(t))}setColumn(t,e){l.checkColumnIndex(this,t),e=l.checkColumnVector(this,e);for(var n=0;n<this.rows;n++)this.set(n,t,e[n]);return this}swapColumns(t,e){l.checkColumnIndex(this,t),l.checkColumnIndex(this,e);for(var n,r=0;r<this.rows;r++)n=this.get(r,t),this.set(r,t,this.get(r,e)),this.set(r,e,n);return this}addRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[n]);return this}subRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[n]);return this}mulRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[n]);return this}divRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[n]);return this}addColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[e]);return this}subColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[e]);return this}mulColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[e]);return this}divColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[e]);return this}mulRow(t,e){l.checkRowIndex(this,t);for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this}mulColumn(t,e){l.checkColumnIndex(this,t);for(var n=0;n<this.rows;n++)this.set(n,t,this.get(n,t)*e);return this}max(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)>t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}min(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)<t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}maxRow(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxRowIndex(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r),n[1]=r);return n}minRow(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minRowIndex(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r),n[1]=r);return n}maxColumn(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t));return e}maxColumnIndex(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t),n[0]=r);return n}minColumn(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t));return e}minColumnIndex(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t),n[0]=r);return n}diag(){for(var t=v(this.rows,this.columns),e=Array(t),n=0;n<t;n++)e[n]=this.get(n,n);return e}sum(t){return"row"===t?l.sumByRow(this):"column"===t?l.sumByColumn(this):l.sumAll(this)}mean(){return this.sum()/this.size}prod(){for(var t=1,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t*=this.get(e,n);return t}cumulativeSum(){for(var t=0,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t+=this.get(e,n),this.set(e,n,t);return this}dot(t){w.isMatrix(t)&&(t=t.to1DArray());var e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n}mmul(t){t=this.constructor.checkMatrix(t),this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var e=this.rows,n=this.columns,r=t.columns,i=new this.constructor[Symbol.species](e,r),o=Array(n),a=0;a<r;a++){for(var s=0;s<n;s++)o[s]=t.get(s,a);for(var u,c=0;c<e;c++){for(u=0,s=0;s<n;s++)u+=this.get(c,s)*o[s];i.set(c,a,u)}}return i}strassen2x2(t){var e=new this.constructor[Symbol.species](2,2),n=this.get(0,0),r=t.get(0,0),i=this.get(0,1),o=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),c=t.get(1,1),l=(n+u)*(r+c),h=(a+u)*r,f=n*(o-c),d=u*(s-r),p=(n+i)*c;return e.set(0,0,l+d-p+(i-u)*(s+c)),e.set(0,1,f+p),e.set(1,0,h+d),e.set(1,1,l-h+f+(a-n)*(r+o)),e}strassen3x3(t){var e=new this.constructor[Symbol.species](3,3),n=this.get(0,0),r=this.get(0,1),i=this.get(0,2),o=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),c=this.get(2,1),l=this.get(2,2),h=t.get(0,0),f=t.get(0,1),d=t.get(0,2),p=t.get(1,0),m=t.get(1,1),g=t.get(1,2),v=t.get(2,0),y=t.get(2,1),w=t.get(2,2),b=(n-o)*(-f+m),x=(-n+o+a)*(h-f+m),_=(o+a)*(-h+f),M=n*h,E=(-n+u+c)*(h-d+g),S=(-n+u)*(d-g),T=(u+c)*(-h+d),A=(-i+c+l)*(m+v-y),k=(i-l)*(m-y),C=i*v,R=(c+l)*(-v+y),D=(-i+a+s)*(g+v-w),L=(i-s)*(g-w),O=(a+s)*(-v+w);return e.set(0,0,M+C+r*p),e.set(0,1,(n+r+i-o-a-c-l)*m+x+_+M+A+C+R),e.set(0,2,M+E+T+(n+r+i-a-s-u-c)*g+C+D+O),e.set(1,0,b+a*(-h+f+p-m-g-v+w)+x+M+C+D+L),e.set(1,1,b+x+_+M+s*y),e.set(1,2,C+D+L+O+o*d),e.set(2,0,M+E+S+c*(-h+d+p-m-g-v+y)+A+k+C),e.set(2,1,A+k+C+R+u*f),e.set(2,2,M+E+S+T+l*w),e}mmulStrassen(t){function e(t,e,n){return t.rows===e&&t.columns===n?t:w.zeros(e,n).setSubMatrix(t,0,0)}var n=this.clone(),r=n.rows,i=n.columns,o=t.rows,a=t.columns;i!==o&&console.warn(`Multiplying ${r} x ${i} and ${o} x ${a} matrix: dimensions do not match.`);var s=M(r,o),u=M(i,a);return function t(n,r,i,o){if(512>=i||512>=o)return n.mmul(r);1==i%2&&1==o%2?(n=e(n,i+1,o+1),r=e(r,i+1,o+1)):1==i%2?(n=e(n,i+1,o),r=e(r,i+1,o)):1==o%2&&(n=e(n,i,o+1),r=e(r,i,o+1));var a=parseInt(n.rows/2),s=parseInt(n.columns/2),u=n.subMatrix(0,a-1,0,s-1),c=r.subMatrix(0,a-1,0,s-1),l=n.subMatrix(0,a-1,s,n.columns-1),h=r.subMatrix(0,a-1,s,r.columns-1),f=n.subMatrix(a,n.rows-1,0,s-1),d=r.subMatrix(a,r.rows-1,0,s-1),p=n.subMatrix(a,n.rows-1,s,n.columns-1),m=r.subMatrix(a,r.rows-1,s,r.columns-1),g=t(w.add(u,p),w.add(c,m),a,s),v=t(w.add(f,p),c,a,s),y=t(u,w.sub(h,m),a,s),b=t(p,w.sub(d,c),a,s),x=t(w.add(u,l),m,a,s),_=t(w.sub(f,u),w.add(c,h),a,s),M=t(w.sub(l,p),w.add(d,m),a,s),E=w.add(g,b);E.sub(x),E.add(M);var S=w.add(y,x),T=w.add(v,b),A=w.sub(g,v);A.add(y),A.add(_);var k=w.zeros(2*E.rows,2*E.columns);return(k=(k=(k=(k=k.setSubMatrix(E,0,0)).setSubMatrix(S,E.rows,0)).setSubMatrix(T,0,E.columns)).setSubMatrix(A,E.rows,E.columns)).subMatrix(0,i-1,0,o-1)}(n=e(n,s,u),t=e(t,s,u),s,u)}scaleRows(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n,r=this.constructor.empty(this.rows,this.columns),i=0;i<this.rows;i++)n=s.scale(this.getRow(i),{min:t,max:e}),r.setRow(i,n);return r}scaleColumns(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n,r=this.constructor.empty(this.rows,this.columns),i=0;i<this.columns;i++)n=s.scale(this.getColumn(i),{min:t,max:e}),r.setColumn(i,n);return r}kroneckerProduct(t){t=this.constructor.checkMatrix(t);for(var e=this.rows,n=this.columns,r=t.rows,i=t.columns,o=new this.constructor[Symbol.species](e*r,n*i),a=0;a<e;a++)for(var s=0;s<n;s++)for(var u=0;u<r;u++)for(var c=0;c<i;c++)o[r*a+u][i*s+c]=this.get(a,s)*t.get(u,c);return o}transpose(){for(var t=new this.constructor[Symbol.species](this.columns,this.rows),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(n,e,this.get(e,n));return t}sortRows(t){void 0===t&&(t=n);for(var e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t){void 0===t&&(t=n);for(var e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,n,r){l.checkRange(this,t,e,n,r);for(var i=new this.constructor[Symbol.species](e-t+1,r-n+1),o=t;o<=e;o++)for(var a=n;a<=r;a++)i[o-t][a-n]=this.get(o,a);return i}subMatrixRow(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.columns-1),e>n||0>e||e>=this.columns||0>n||n>=this.columns)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](t.length,n-e+1),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(0>t[i]||t[i]>=this.rows)throw new RangeError("Row index out of range: "+t[i]);r.set(i,o-e,this.get(t[i],o))}return r}subMatrixColumn(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.rows-1),e>n||0>e||e>=this.rows||0>n||n>=this.rows)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](n-e+1,t.length),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(0>t[i]||t[i]>=this.columns)throw new RangeError("Column index out of range: "+t[i]);r.set(o-e,i,this.get(o,t[i]))}return r}setSubMatrix(t,e,n){t=this.constructor.checkMatrix(t),l.checkRange(this,e,e+t.rows-1,n,n+t.columns-1);for(var r=0;r<t.rows;r++)for(var i=0;i<t.columns;i++)this[e+r][n+i]=t.get(r,i);return this}selection(t,e){for(var n,r=l.checkIndices(this,t,e),i=new this.constructor[Symbol.species](t.length,e.length),o=0;o<r.row.length;o++){n=r.row[o];for(var a=0;a<r.column.length;a++)i[o][a]=this.get(n,r.column[a])}return i}trace(){for(var t=v(this.rows,this.columns),e=0,n=0;n<t;n++)e+=this.get(n,n);return e}transposeView(){return new c(this)}rowView(t){return l.checkRowIndex(this,t),new m(this,t)}columnView(t){return l.checkColumnIndex(this,t),new p(this,t)}flipRowView(){return new k(this)}flipColumnView(){return new j(this)}subMatrixView(t,e,n,r){return new d(this,t,e,n,r)}selectionView(t,e){return new h(this,t,e)}det(){var t,e,n,r,i,a;if(this.isSquare())return 2===this.columns?(t=this.get(0,0),e=this.get(0,1),n=this.get(1,0),t*this.get(1,1)-e*n):3===this.columns?(r=this.selectionView([1,2],[1,2]),i=this.selectionView([1,2],[0,2]),a=this.selectionView([1,2],[0,1]),t=this.get(0,0),e=this.get(0,1),n=this.get(0,2),t*r.det()-e*i.det()+n*a.det()):new o(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(t){void 0===t&&(t=a);for(var e=new r(this,{autoTranspose:!0}),n=e.leftSingularVectors,i=e.rightSingularVectors,o=e.diagonal,s=0;s<o.length;s++)o[s]=u(o[s])>t?1/o[s]:0;return o=this.constructor[Symbol.species].diag(o),i.mmul(o.mmul(n.transposeView()))}}w.prototype.klass="Matrix",w.random=w.rand,w.diagonal=w.diag,w.prototype.diagonal=w.prototype.diag,w.identity=w.eye,w.prototype.negate=w.prototype.neg,w.prototype.tensorProduct=w.prototype.kroneckerProduct,w.prototype.determinant=w.prototype.det;var f="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",y="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",b="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",R="\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",I="\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",S="\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",C="\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",V="\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",D="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",z="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",_="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",P=V,A=[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]],L=!0,U=!1,F,i;try{for(var T=A[Symbol.iterator](),q;!(L=(q=T.next()).done);L=!0){var N=q.value,O=eval(x(f,{name:N[1],op:N[0]})),E=eval(x(y,{name:N[1]+"S",op:N[0]})),B=eval(x(b,{name:N[1]+"M",op:N[0]})),Q=eval(x(R,{name:N[1]}));for(F=1;F<N.length;F++)w.prototype[N[F]]=O,w.prototype[N[F]+"S"]=E,w.prototype[N[F]+"M"]=B,w[N[F]]=Q}}catch(e){U=!0,i=e}finally{try{!L&&T.return&&T.return()}finally{if(U)throw i}}var W=[["~","not"]];["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(t){W.push(["Math."+t,t])});var X=!0,J=!1,Y;try{for(var H=W[Symbol.iterator](),K;!(X=(K=H.next()).done);X=!0){var G=K.value,Z=eval(x(I,{name:G[1],method:G[0]})),$=eval(x(S,{name:G[1]}));for(F=1;F<G.length;F++)w.prototype[G[F]]=Z,w[G[F]]=$}}catch(e){J=!0,Y=e}finally{try{!X&&H.return&&H.return()}finally{if(J)throw Y}}var ee=[["Math.pow",1,"pow"]],te=!0,ie=!1,ne;try{for(var oe=ee[Symbol.iterator](),se;!(te=(se=oe.next()).done);te=!0){var re=se.value,ae="arg0";for(F=1;F<re[1];F++)ae+=`, arg${F}`;if(1!==re[1]){var le=eval(x(C,{name:re[2],method:re[0],args:ae})),ce=eval(x(V,{name:re[2],args:ae}));for(F=2;F<re.length;F++)w.prototype[re[F]]=le,w[re[F]]=ce}else{var ue={name:re[2],args:ae,method:re[0]},me=eval(x(_,ue)),de=eval(x(D,ue)),ge=eval(x(z,ue)),he=eval(x(P,ue));for(F=2;F<re.length;F++)w.prototype[re[F]]=me,w.prototype[re[F]+"M"]=ge,w.prototype[re[F]+"S"]=de,w[re[F]]=he}}}catch(e){ie=!0,ne=e}finally{try{!te&&oe.return&&oe.return()}finally{if(ie)throw ne}}return w}e.exports=n;var o=i(77),r=i(78),s=i(1),l=i(26),c=i(229),m=i(230),d=i(231),h=i(232),p=i(233),k=i(234),j=i(235)},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);var e,n,o,a,s,c,l,h,f,d,p=(t=i.Matrix.checkMatrix(t)).clone(),m=p.rows,g=p.columns,y=Array(m),w=1;for(e=0;e<m;e++)y[e]=e;for(f=Array(m),n=0;n<g;n++){for(e=0;e<m;e++)f[e]=p[e][n];for(e=0;e<m;e++){for(h=p[e],d=v(e,n),s=0,o=0;o<d;o++)s+=h[o]*f[o];h[n]=f[e]-=s}for(a=n,e=n+1;e<m;e++)u(f[e])>u(f[a])&&(a=e);if(a!==n){for(o=0;o<g;o++)c=p[a][o],p[a][o]=p[n][o],p[n][o]=c;l=y[a],y[a]=y[n],y[n]=l,w=-w}if(n<m&&0!==p[n][n])for(e=n+1;e<m;e++)p[e][n]/=p[n][n]}this.LU=p,this.pivotVector=y,this.pivotSign=w}var i=n(7);r.prototype={isSingular:function(){for(var t=this.LU,e=t.columns,n=0;n<e;n++)if(0===t[n][n])return!0;return!1},get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var e=this.pivotSign,n=t.columns,r=0;r<n;r++)e*=t[r][r];return e},get lowerTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new i.Matrix(e,n),o=0;o<e;o++)for(var a=0;a<n;a++)r[o][a]=o>a?t[o][a]:o===a?1:0;return r},get upperTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new i.Matrix(e,n),o=0;o<e;o++)for(var a=0;a<n;a++)r[o][a]=o<=a?t[o][a]:0;return r},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(t){t=i.Matrix.checkMatrix(t);var e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var n,r,o,a=t.columns,s=t.subMatrixRow(this.pivotVector,0,a-1),u=e.columns;for(o=0;o<u;o++)for(n=o+1;n<u;n++)for(r=0;r<a;r++)s[n][r]-=s[o][r]*e[n][o];for(o=u-1;0<=o;o--){for(r=0;r<a;r++)s[o][r]/=e[o][o];for(n=0;n<o;n++)for(r=0;r<a;r++)s[n][r]-=s[o][r]*e[n][o]}return s}},t.exports=r},function(t,e,n){"use strict";function r(t,e){if(!(this instanceof r))return new r(t,e);t=i.Matrix.checkMatrix(t),e=e||{};var n=t.rows,o=t.columns,c=v(n,o),l=!0,h=!0;!1===e.computeLeftSingularVectors&&(l=!1),!1===e.computeRightSingularVectors&&(h=!1);var f,d=!1;if(n<o)if(!0===e.autoTranspose){n=(f=t.transpose()).rows,o=f.columns,d=!0;var p=l;l=h,h=p}else f=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else f=t.clone();var m,g,y,w,b,x,_,E,S,T,A,k,C,D,L,O,P,I,N,F,j,z=Array(v(n+1,o)),U=s(n,c,0),V=s(o,o,0),B=Array(o),H=Array(n),q=v(n-1,o),G=M(0,v(o-2,n));for(y=0,T=M(q,G);y<T;y++){if(y<q){for(z[y]=0,m=y;m<n;m++)z[y]=a(z[y],f[m][y]);if(0!==z[y]){for(0>f[y][y]&&(z[y]=-z[y]),m=y;m<n;m++)f[m][y]/=z[y];f[y][y]+=1}z[y]=-z[y]}for(g=y+1;g<o;g++){if(y<q&&0!==z[y]){for(b=0,m=y;m<n;m++)b+=f[m][y]*f[m][g];for(b=-b/f[y][y],m=y;m<n;m++)f[m][g]+=b*f[m][y]}B[g]=f[y][g]}if(l&&y<q)for(m=y;m<n;m++)U[m][y]=f[m][y];if(y<G){for(B[y]=0,m=y+1;m<o;m++)B[y]=a(B[y],B[m]);if(0!==B[y]){for(0>B[y+1]&&(B[y]=0-B[y]),m=y+1;m<o;m++)B[m]/=B[y];B[y+1]+=1}if(B[y]=-B[y],y+1<n&&0!==B[y]){for(m=y+1;m<n;m++)H[m]=0;for(g=y+1;g<o;g++)for(m=y+1;m<n;m++)H[m]+=B[g]*f[m][g];for(g=y+1;g<o;g++)for(b=-B[g]/B[y+1],m=y+1;m<n;m++)f[m][g]+=b*H[m]}if(h)for(m=y+1;m<o;m++)V[m][y]=B[m]}}if(w=v(o,n+1),q<o&&(z[q]=f[q][q]),n<w&&(z[w-1]=0),G+1<w&&(B[G]=f[G][w-1]),B[w-1]=0,l){for(g=q;g<c;g++){for(m=0;m<n;m++)U[m][g]=0;U[g][g]=1}for(y=q-1;0<=y;y--)if(0!==z[y]){for(g=y+1;g<c;g++){for(b=0,m=y;m<n;m++)b+=U[m][y]*U[m][g];for(b=-b/U[y][y],m=y;m<n;m++)U[m][g]+=b*U[m][y]}for(m=y;m<n;m++)U[m][y]=-U[m][y];for(U[y][y]=1+U[y][y],m=0;m<y-1;m++)U[m][y]=0}else{for(m=0;m<n;m++)U[m][y]=0;U[y][y]=1}}if(h)for(y=o-1;0<=y;y--){if(y<G&&0!==B[y])for(g=y+1;g<o;g++){for(b=0,m=y+1;m<o;m++)b+=V[m][y]*V[m][g];for(b=-b/V[y+1][y],m=y+1;m<o;m++)V[m][g]+=b*V[m][y]}for(m=0;m<o;m++)V[m][y]=0;V[y][y]=1}for(var W=w-1,Y=2.220446049250313e-16;0<w;){for(y=w-2;-1<=y&&-1!==y;y--)if(u(B[y])<=Y*(u(z[y])+u(z[y+1]))){B[y]=0;break}if(y===w-2)A=4;else{for(x=w-1;x>=y&&x!==y;x--)if(b=(x===w?0:u(B[x]))+(x===y+1?0:u(B[x-1])),u(z[x])<=Y*b){z[x]=0;break}x===y?A=3:x===w-1?A=1:(A=2,y=x)}switch(y++,A){case 1:for(_=B[w-2],B[w-2]=0,g=w-2;g>=y;g--)if(b=a(z[g],_),E=z[g]/b,S=_/b,z[g]=b,g!==y&&(_=-S*B[g-1],B[g-1]=E*B[g-1]),h)for(m=0;m<o;m++)b=E*V[m][g]+S*V[m][w-1],V[m][w-1]=-S*V[m][g]+E*V[m][w-1],V[m][g]=b;break;case 2:for(_=B[y-1],B[y-1]=0,g=y;g<w;g++)if(b=a(z[g],_),E=z[g]/b,S=_/b,z[g]=b,_=-S*B[g],B[g]=E*B[g],l)for(m=0;m<n;m++)b=E*U[m][g]+S*U[m][y-1],U[m][y-1]=-S*U[m][g]+E*U[m][y-1],U[m][g]=b;break;case 3:for(k=M(M(M(M(u(z[w-1]),u(z[w-2])),u(B[w-2])),u(z[y])),u(B[y])),O=z[y]/k,P=B[y]/k,N=(C=z[w-1]/k)*(L=B[w-2]/k)*(C*L),F=0,(0!=(I=(((D=z[w-2]/k)+C)*(D-C)+L*L)/2)||0!==N)&&(F=R(I*I+N),0>I&&(F=-F),F=N/(I+F)),_=(O+C)*(O-C)+F,j=O*P,g=y;g<w-1;g++){if(E=_/(b=a(_,j)),S=j/b,g!==y&&(B[g-1]=b),_=E*z[g]+S*B[g],B[g]=E*B[g]-S*z[g],j=S*z[g+1],z[g+1]=E*z[g+1],h)for(m=0;m<o;m++)b=E*V[m][g]+S*V[m][g+1],V[m][g+1]=-S*V[m][g]+E*V[m][g+1],V[m][g]=b;if(E=_/(b=a(_,j)),S=j/b,z[g]=b,_=E*B[g]+S*z[g+1],z[g+1]=-S*B[g]+E*z[g+1],j=S*B[g+1],B[g+1]=E*B[g+1],l&&g<n-1)for(m=0;m<n;m++)b=E*U[m][g]+S*U[m][g+1],U[m][g+1]=-S*U[m][g]+E*U[m][g+1],U[m][g]=b}B[w-2]=_;break;case 4:if(0>=z[y]&&(z[y]=0>z[y]?-z[y]:0,h))for(m=0;m<=W;m++)V[m][y]=-V[m][y];for(;y<W&&!(z[y]>=z[y+1]);){if(b=z[y],z[y]=z[y+1],z[y+1]=b,h&&y<o-1)for(m=0;m<o;m++)b=V[m][y+1],V[m][y+1]=V[m][y],V[m][y]=b;if(l&&y<n-1)for(m=0;m<n;m++)b=U[m][y+1],U[m][y+1]=U[m][y],U[m][y]=b;y++}w--}}if(d){var X=V;V=U,U=X}this.m=n,this.n=o,this.s=z,this.U=U,this.V=V}var i=n(7),o=n(41),a=o.hypotenuse,s=o.getFilled2DArray;r.prototype={get condition(){return this.s[0]/this.s[v(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var t=M(this.m,this.n)*this.s[0]*2.220446049250313e-16,e=0,n=this.s,r=0,i=n.length;r<i;r++)n[r]>t&&e++;return e},get diagonal(){return this.s},get threshold(){return 1.1102230246251565e-16*M(this.m,this.n)*this.s[0]},get leftSingularVectors(){return i.Matrix.isMatrix(this.U)||(this.U=new i.Matrix(this.U)),this.U},get rightSingularVectors(){return i.Matrix.isMatrix(this.V)||(this.V=new i.Matrix(this.V)),this.V},get diagonalMatrix(){return i.Matrix.diag(this.s)},solve:function(t){var e,n=this.threshold,r=this.s.length,o=i.Matrix.zeros(r,r);for(e=0;e<r;e++)o[e][e]=u(this.s[e])<=n?0:1/this.s[e];var a,s,c,l=this.U,h=this.rightSingularVectors,f=h.mmul(o),d=h.rows,p=l.length,m=i.Matrix.zeros(d,p);for(e=0;e<d;e++)for(a=0;a<p;a++){for(c=0,s=0;s<r;s++)c+=f[e][s]*l[a][s];m[e][a]=c}return m.mmul(t)},solveForDiagonal:function(t){return this.solve(i.Matrix.diag(t))},inverse:function(){var t,e,n=this.V,r=this.threshold,o=n.length,a=n[0].length,s=new i.Matrix(o,this.s.length);for(t=0;t<o;t++)for(e=0;e<a;e++)s[t][e]=u(this.s[e])>r?n[t][e]/this.s[e]:0;var c,l,h=this.U,f=h.length,d=h[0].length,p=new i.Matrix(o,f);for(t=0;t<o;t++)for(e=0;e<f;e++){for(l=0,c=0;c<d;c++)l+=s[t][c]*h[e][c];p[t][e]=l}return p}},t.exports=r},function(t,e,n){"use strict";var r=n(40);t.exports={transpose:function(t){return"number"==typeof t?t:t.clone().transpose()},add:function(t,e){return"number"==typeof t&&"number"==typeof e?t+e:"number"==typeof t?this.add(e,t):t.clone().add(e)},subtract:function(t,e){return"number"==typeof t&&"number"==typeof e?t-e:"number"==typeof t?this.subtract(e,t):t.clone().sub(e)},multiply:function(t,e){if("number"==typeof t&&"number"==typeof e)return t*e;if("number"==typeof t)return this.multiply(e,t);var n=t.clone();return"number"==typeof e?n.mul(e):n=n.mmul(e),1==n.rows&&1==n.columns?n[0][0]:n},dotMultiply:function(t,e){return t.clone().mul(e)},dotDivide:function(t,e){return t.clone().div(e)},diag:function(t){var e,n,i=null,o=t.rows,a=t.columns;if("undefined"==typeof a&&"object"==typeof t)if(t[0]&&t[0].length)for(n=v(o=t.length,a=t[0].length),i=r.zeros(a,a),e=0;e<a;e++)i[e][e]=t[e][e];else for(i=r.zeros(a=t.length,a),e=0;e<a;e++)i[e][e]=t[e];if(1==o)for(i=r.zeros(a,a),e=0;e<a;e++)i[e][e]=t[0][e];else if(0<o&&0<a)for(n=v(o,a),i=Array(n),e=0;e<n;e++)i[e]=t[e][e];return i},min:function(t,e){if("number"==typeof t&&"number"==typeof e)return v(t,e);for(var n=t.rows,i=t.columns,o=new r(n,i),a=0;a<n;a++)for(var s=0;s<i;s++)o[a][s]=t[a][s]<e[a][s]?t[a][s]:e[a][s];return o},max:function(t,e){if("number"==typeof t&&"number"==typeof e)return M(t,e);for(var n=t.rows,i=t.columns,o=new r(n,i),a=0;a<n;a++)for(var s=0;s<i;s++)o[a][s]=t[a][s]>e[a][s]?t[a][s]:e[a][s];return o},solve:function(t,e){return t.solve(e)},inv:function(t){return"number"==typeof t?1/t:t.inverse()},sqrt:function(t){if("number"==typeof t)return R(t);for(var e=t.rows,n=t.columns,i=new r(e,n),o=0;o<e;o++)for(var a=0;a<n;a++)i[o][a]=R(t[o][a]);return i},exp:function(t){if("number"==typeof t)return R(t);for(var e=t.rows,n=t.columns,i=new r(e,n),a=0;a<e;a++)for(var s=0;s<n;s++)i[a][s]=o(t[a][s]);return i},dotPow:function(t,e){if("number"==typeof t)return c(t,e);for(var n=t.rows,i=t.columns,o=new r(n,i),a=0;a<n;a++)for(var s=0;s<i;s++)o[a][s]=c(t[a][s],e);return o},abs:function(t){if("number"==typeof t)return u(t);for(var e=t.rows,n=t.columns,i=new r(e,n),o=0;o<e;o++)for(var a=0;a<n;a++)i[o][a]=u(t[o][a]);return i},matrix:function(t,e){return new r(t,e)},ones:function(t,e){return r.ones(t,e)},zeros:function(t,e){return r.zeros(t,e)},random:function(t,e){return r.rand(t,e)},eye:function(t,e){return r.eye(t,e)}}},function(e,t,i){"use strict";function n(e){function t(t,e){if(t.rows!==e.rows||t.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal")}function n(t,e){return t-e}function x(t,e){for(var n in e)t=t.replace(new RegExp("%"+n+"%","g"),e[n]);return t}void 0===e&&(e=Object);class w extends e{static get[Symbol.species](){return this}static from1DArray(t,e,n){if(t*e!==n.length)throw new RangeError("Data length does not match given dimensions");for(var r=new this(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)r.set(i,o,n[i*e+o]);return r}static rowVector(t){for(var e=new this(1,t.length),n=0;n<t.length;n++)e.set(0,n,t[n]);return e}static columnVector(t){for(var e=new this(t.length,1),n=0;n<t.length;n++)e.set(n,0,t[n]);return e}static empty(t,e){return new this(t,e)}static zeros(t,e){return this.empty(t,e).fill(0)}static ones(t,e){return this.empty(t,e).fill(1)}static rand(t,e,n){void 0===n&&(n=Math.random);for(var r=this.empty(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)r.set(i,o,n());return r}static randInt(t,e,n,r){void 0===n&&(n=1e3),void 0===r&&(r=Math.random);for(var i=this.empty(t,e),o=0;o<t;o++)for(var a,s=0;s<e;s++)a=g(r()*n),i.set(o,s,a);return i}static eye(t,e,n){void 0===e&&(e=t),void 0===n&&(n=1);for(var r=v(t,e),i=this.zeros(t,e),o=0;o<r;o++)i.set(o,o,n);return i}static diag(t,e,n){var r=t.length;void 0===e&&(e=r),void 0===n&&(n=e);for(var i=v(r,e,n),o=this.zeros(e,n),a=0;a<i;a++)o.set(a,a,t[a]);return o}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),o=0;o<n;o++)for(var a=0;a<r;a++)i.set(o,a,v(t.get(o,a),e.get(o,a)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),o=0;o<n;o++)for(var a=0;a<r;a++)i.set(o,a,M(t.get(o,a),e.get(o,a)));return i}static checkMatrix(t){return w.isMatrix(t)?t:new this(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=this.rows,n=this.columns,r=0;r<e;r++)for(var i=0;i<n;i++)t.call(this,r,i);return this}to1DArray(){for(var t=Array(this.size),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t[e*this.columns+n]=this.get(e,n);return t}to2DArray(){for(var t=Array(this.rows),e=0;e<this.rows;e++){t[e]=Array(this.columns);for(var n=0;n<this.columns;n++)t[e][n]=this.get(e,n)}return t}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t,e){t=t||1,e=e||1;for(var n=new this.constructor[Symbol.species](this.rows*t,this.columns*e),r=0;r<t;r++)for(var i=0;i<e;i++)n.setSubMatrix(this,this.rows*r,this.columns*i);return n}fill(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,t);return this}neg(){return this.mulS(-1)}getRow(t){l.checkRowIndex(this,t);for(var e=Array(this.columns),n=0;n<this.columns;n++)e[n]=this.get(t,n);return e}getRowVector(t){return this.constructor.rowVector(this.getRow(t))}setRow(t,e){l.checkRowIndex(this,t),e=l.checkRowVector(this,e);for(var n=0;n<this.columns;n++)this.set(t,n,e[n]);return this}swapRows(t,e){l.checkRowIndex(this,t),l.checkRowIndex(this,e);for(var n,r=0;r<this.columns;r++)n=this.get(t,r),this.set(t,r,this.get(e,r)),this.set(e,r,n);return this}getColumn(t){l.checkColumnIndex(this,t);for(var e=Array(this.rows),n=0;n<this.rows;n++)e[n]=this.get(n,t);return e}getColumnVector(t){return this.constructor.columnVector(this.getColumn(t))}setColumn(t,e){l.checkColumnIndex(this,t),e=l.checkColumnVector(this,e);for(var n=0;n<this.rows;n++)this.set(n,t,e[n]);return this}swapColumns(t,e){l.checkColumnIndex(this,t),l.checkColumnIndex(this,e);for(var n,r=0;r<this.rows;r++)n=this.get(r,t),this.set(r,t,this.get(r,e)),this.set(r,e,n);return this}addRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[n]);return this}subRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[n]);return this}mulRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[n]);return this}divRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[n]);return this}addColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[e]);return this}subColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[e]);return this}mulColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[e]);return this}divColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[e]);return this}mulRow(t,e){l.checkRowIndex(this,t);for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this}mulColumn(t,e){l.checkColumnIndex(this,t);for(var n=0;n<this.rows;n++)this.set(n,t,this.get(n,t)*e);return this}max(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)>t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}min(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)<t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}maxRow(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxRowIndex(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r),n[1]=r);return n}minRow(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minRowIndex(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r),n[1]=r);return n}maxColumn(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t));return e}maxColumnIndex(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t),n[0]=r);return n}minColumn(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t));return e}minColumnIndex(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t),n[0]=r);return n}diag(){for(var t=v(this.rows,this.columns),e=Array(t),n=0;n<t;n++)e[n]=this.get(n,n);return e}sum(t){return"row"===t?l.sumByRow(this):"column"===t?l.sumByColumn(this):l.sumAll(this)}mean(){return this.sum()/this.size}prod(){for(var t=1,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t*=this.get(e,n);return t}cumulativeSum(){for(var t=0,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t+=this.get(e,n),this.set(e,n,t);return this}dot(t){w.isMatrix(t)&&(t=t.to1DArray());var e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n}mmul(t){t=this.constructor.checkMatrix(t),this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var e=this.rows,n=this.columns,r=t.columns,i=new this.constructor[Symbol.species](e,r),o=Array(n),a=0;a<r;a++){for(var s=0;s<n;s++)o[s]=t.get(s,a);for(var u,c=0;c<e;c++){for(u=0,s=0;s<n;s++)u+=this.get(c,s)*o[s];i.set(c,a,u)}}return i}strassen2x2(t){var e=new this.constructor[Symbol.species](2,2),n=this.get(0,0),r=t.get(0,0),i=this.get(0,1),o=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),c=t.get(1,1),l=(n+u)*(r+c),h=(a+u)*r,f=n*(o-c),d=u*(s-r),p=(n+i)*c;return e.set(0,0,l+d-p+(i-u)*(s+c)),e.set(0,1,f+p),e.set(1,0,h+d),e.set(1,1,l-h+f+(a-n)*(r+o)),e}strassen3x3(t){var e=new this.constructor[Symbol.species](3,3),n=this.get(0,0),r=this.get(0,1),i=this.get(0,2),o=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),c=this.get(2,1),l=this.get(2,2),h=t.get(0,0),f=t.get(0,1),d=t.get(0,2),p=t.get(1,0),m=t.get(1,1),g=t.get(1,2),v=t.get(2,0),y=t.get(2,1),w=t.get(2,2),b=(n-o)*(-f+m),x=(-n+o+a)*(h-f+m),_=(o+a)*(-h+f),M=n*h,E=(-n+u+c)*(h-d+g),S=(-n+u)*(d-g),T=(u+c)*(-h+d),A=(-i+c+l)*(m+v-y),k=(i-l)*(m-y),C=i*v,R=(c+l)*(-v+y),D=(-i+a+s)*(g+v-w),L=(i-s)*(g-w),O=(a+s)*(-v+w);return e.set(0,0,M+C+r*p),e.set(0,1,(n+r+i-o-a-c-l)*m+x+_+M+A+C+R),e.set(0,2,M+E+T+(n+r+i-a-s-u-c)*g+C+D+O),e.set(1,0,b+a*(-h+f+p-m-g-v+w)+x+M+C+D+L),e.set(1,1,b+x+_+M+s*y),e.set(1,2,C+D+L+O+o*d),e.set(2,0,M+E+S+c*(-h+d+p-m-g-v+y)+A+k+C),e.set(2,1,A+k+C+R+u*f),e.set(2,2,M+E+S+T+l*w),e}mmulStrassen(t){function e(t,e,n){return t.rows===e&&t.columns===n?t:w.zeros(e,n).setSubMatrix(t,0,0)}var n=this.clone(),r=n.rows,i=n.columns,o=t.rows,a=t.columns;i!==o&&console.warn(`Multiplying ${r} x ${i} and ${o} x ${a} matrix: dimensions do not match.`);var s=M(r,o),u=M(i,a);return function t(n,r,i,o){if(512>=i||512>=o)return n.mmul(r);1==i%2&&1==o%2?(n=e(n,i+1,o+1),r=e(r,i+1,o+1)):1==i%2?(n=e(n,i+1,o),r=e(r,i+1,o)):1==o%2&&(n=e(n,i,o+1),r=e(r,i,o+1));var a=parseInt(n.rows/2),s=parseInt(n.columns/2),u=n.subMatrix(0,a-1,0,s-1),c=r.subMatrix(0,a-1,0,s-1),l=n.subMatrix(0,a-1,s,n.columns-1),h=r.subMatrix(0,a-1,s,r.columns-1),f=n.subMatrix(a,n.rows-1,0,s-1),d=r.subMatrix(a,r.rows-1,0,s-1),p=n.subMatrix(a,n.rows-1,s,n.columns-1),m=r.subMatrix(a,r.rows-1,s,r.columns-1),g=t(w.add(u,p),w.add(c,m),a,s),v=t(w.add(f,p),c,a,s),y=t(u,w.sub(h,m),a,s),b=t(p,w.sub(d,c),a,s),x=t(w.add(u,l),m,a,s),_=t(w.sub(f,u),w.add(c,h),a,s),M=t(w.sub(l,p),w.add(d,m),a,s),E=w.add(g,b);E.sub(x),E.add(M);var S=w.add(y,x),T=w.add(v,b),A=w.sub(g,v);A.add(y),A.add(_);var k=w.zeros(2*E.rows,2*E.columns);return(k=(k=(k=(k=k.setSubMatrix(E,0,0)).setSubMatrix(S,E.rows,0)).setSubMatrix(T,0,E.columns)).setSubMatrix(A,E.rows,E.columns)).subMatrix(0,i-1,0,o-1)}(n=e(n,s,u),t=e(t,s,u),s,u)}scaleRows(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n,r=this.constructor.empty(this.rows,this.columns),i=0;i<this.rows;i++)n=s.scale(this.getRow(i),{min:t,max:e}),r.setRow(i,n);return r}scaleColumns(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n,r=this.constructor.empty(this.rows,this.columns),i=0;i<this.columns;i++)n=s.scale(this.getColumn(i),{min:t,max:e}),r.setColumn(i,n);return r}kroneckerProduct(t){t=this.constructor.checkMatrix(t);for(var e=this.rows,n=this.columns,r=t.rows,i=t.columns,o=new this.constructor[Symbol.species](e*r,n*i),a=0;a<e;a++)for(var s=0;s<n;s++)for(var u=0;u<r;u++)for(var c=0;c<i;c++)o[r*a+u][i*s+c]=this.get(a,s)*t.get(u,c);return o}transpose(){for(var t=new this.constructor[Symbol.species](this.columns,this.rows),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(n,e,this.get(e,n));return t}sortRows(t){void 0===t&&(t=n);for(var e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t){void 0===t&&(t=n);for(var e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,n,r){l.checkRange(this,t,e,n,r);for(var i=new this.constructor[Symbol.species](e-t+1,r-n+1),o=t;o<=e;o++)for(var a=n;a<=r;a++)i[o-t][a-n]=this.get(o,a);return i}subMatrixRow(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.columns-1),e>n||0>e||e>=this.columns||0>n||n>=this.columns)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](t.length,n-e+1),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(0>t[i]||t[i]>=this.rows)throw new RangeError("Row index out of range: "+t[i]);r.set(i,o-e,this.get(t[i],o))}return r}subMatrixColumn(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.rows-1),e>n||0>e||e>=this.rows||0>n||n>=this.rows)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](n-e+1,t.length),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(0>t[i]||t[i]>=this.columns)throw new RangeError("Column index out of range: "+t[i]);r.set(o-e,i,this.get(o,t[i]))}return r}setSubMatrix(t,e,n){t=this.constructor.checkMatrix(t),l.checkRange(this,e,e+t.rows-1,n,n+t.columns-1);for(var r=0;r<t.rows;r++)for(var i=0;i<t.columns;i++)this[e+r][n+i]=t.get(r,i);return this}selection(t,e){for(var n,r=l.checkIndices(this,t,e),i=new this.constructor[Symbol.species](t.length,e.length),o=0;o<r.row.length;o++){n=r.row[o];for(var a=0;a<r.column.length;a++)i[o][a]=this.get(n,r.column[a])}return i}trace(){for(var t=v(this.rows,this.columns),e=0,n=0;n<t;n++)e+=this.get(n,n);return e}transposeView(){return new c(this)}rowView(t){return l.checkRowIndex(this,t),new m(this,t)}columnView(t){return l.checkColumnIndex(this,t),new p(this,t)}flipRowView(){return new k(this)}flipColumnView(){return new j(this)}subMatrixView(t,e,n,r){return new d(this,t,e,n,r)}selectionView(t,e){return new h(this,t,e)}det(){var t,e,n,r,i,a;if(this.isSquare())return 2===this.columns?(t=this.get(0,0),e=this.get(0,1),n=this.get(1,0),t*this.get(1,1)-e*n):3===this.columns?(r=this.selectionView([1,2],[1,2]),i=this.selectionView([1,2],[0,2]),a=this.selectionView([1,2],[0,1]),t=this.get(0,0),e=this.get(0,1),n=this.get(0,2),t*r.det()-e*i.det()+n*a.det()):new o(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(t){void 0===t&&(t=a);for(var e=new r(this,{autoTranspose:!0}),n=e.leftSingularVectors,i=e.rightSingularVectors,o=e.diagonal,s=0;s<o.length;s++)o[s]=u(o[s])>t?1/o[s]:0;return o=this.constructor[Symbol.species].diag(o),i.mmul(o.mmul(n.transposeView()))}}w.prototype.klass="Matrix",w.random=w.rand,w.diagonal=w.diag,w.prototype.diagonal=w.prototype.diag,w.identity=w.eye,w.prototype.negate=w.prototype.neg,w.prototype.tensorProduct=w.prototype.kroneckerProduct,w.prototype.determinant=w.prototype.det;var f="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",y="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",b="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",R="\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",I="\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",S="\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",C="\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",V="\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",D="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",z="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",_="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",P=V,A=[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]],L=!0,U=!1,F,i;try{for(var T=A[Symbol.iterator](),q;!(L=(q=T.next()).done);L=!0){var N=q.value,O=eval(x(f,{name:N[1],op:N[0]})),E=eval(x(y,{name:N[1]+"S",op:N[0]})),B=eval(x(b,{name:N[1]+"M",op:N[0]})),Q=eval(x(R,{name:N[1]}));for(F=1;F<N.length;F++)w.prototype[N[F]]=O,w.prototype[N[F]+"S"]=E,w.prototype[N[F]+"M"]=B,w[N[F]]=Q}}catch(e){U=!0,i=e}finally{try{!L&&T.return&&T.return()}finally{if(U)throw i}}var W=[["~","not"]];["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(t){W.push(["Math."+t,t])});var X=!0,J=!1,Y;try{for(var H=W[Symbol.iterator](),K;!(X=(K=H.next()).done);X=!0){var G=K.value,Z=eval(x(I,{name:G[1],method:G[0]})),$=eval(x(S,{name:G[1]}));for(F=1;F<G.length;F++)w.prototype[G[F]]=Z,w[G[F]]=$}}catch(e){J=!0,Y=e}finally{try{!X&&H.return&&H.return()}finally{if(J)throw Y}}var ee=[["Math.pow",1,"pow"]],te=!0,ie=!1,ne;try{for(var oe=ee[Symbol.iterator](),se;!(te=(se=oe.next()).done);te=!0){var re=se.value,ae="arg0";for(F=1;F<re[1];F++)ae+=`, arg${F}`;if(1!==re[1]){var le=eval(x(C,{name:re[2],method:re[0],args:ae})),ce=eval(x(V,{name:re[2],args:ae}));for(F=2;F<re.length;F++)w.prototype[re[F]]=le,w[re[F]]=ce}else{var ue={name:re[2],args:ae,method:re[0]},me=eval(x(_,ue)),de=eval(x(D,ue)),ge=eval(x(z,ue)),he=eval(x(P,ue));for(F=2;F<re.length;F++)w.prototype[re[F]]=me,w.prototype[re[F]+"M"]=ge,w.prototype[re[F]+"S"]=de,w[re[F]]=he}}}catch(e){ie=!0,ne=e}finally{try{!te&&oe.return&&oe.return()}finally{if(ie)throw ne}}return w}e.exports=n;var o=i(81),r=i(82),s=i(1),l=i(27),c=i(242),m=i(243),d=i(244),h=i(245),p=i(246),k=i(247),j=i(248)},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);var e,n,o,a,s,c,l,h,f,d,p=(t=i.Matrix.checkMatrix(t)).clone(),m=p.rows,g=p.columns,y=Array(m),w=1;for(e=0;e<m;e++)y[e]=e;for(f=Array(m),n=0;n<g;n++){for(e=0;e<m;e++)f[e]=p[e][n];for(e=0;e<m;e++){for(h=p[e],d=v(e,n),s=0,o=0;o<d;o++)s+=h[o]*f[o];h[n]=f[e]-=s}for(a=n,e=n+1;e<m;e++)u(f[e])>u(f[a])&&(a=e);if(a!==n){for(o=0;o<g;o++)c=p[a][o],p[a][o]=p[n][o],p[n][o]=c;l=y[a],y[a]=y[n],y[n]=l,w=-w}if(n<m&&0!==p[n][n])for(e=n+1;e<m;e++)p[e][n]/=p[n][n]}this.LU=p,this.pivotVector=y,this.pivotSign=w}var i=n(8);r.prototype={isSingular:function(){for(var t=this.LU,e=t.columns,n=0;n<e;n++)if(0===t[n][n])return!0;return!1},get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var e=this.pivotSign,n=t.columns,r=0;r<n;r++)e*=t[r][r];return e},get lowerTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new i.Matrix(e,n),o=0;o<e;o++)for(var a=0;a<n;a++)r[o][a]=o>a?t[o][a]:o===a?1:0;return r},get upperTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new i.Matrix(e,n),o=0;o<e;o++)for(var a=0;a<n;a++)r[o][a]=o<=a?t[o][a]:0;return r},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(t){t=i.Matrix.checkMatrix(t);var e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var n,r,o,a=t.columns,s=t.subMatrixRow(this.pivotVector,0,a-1),u=e.columns;for(o=0;o<u;o++)for(n=o+1;n<u;n++)for(r=0;r<a;r++)s[n][r]-=s[o][r]*e[n][o];for(o=u-1;0<=o;o--){for(r=0;r<a;r++)s[o][r]/=e[o][o];for(n=0;n<o;n++)for(r=0;r<a;r++)s[n][r]-=s[o][r]*e[n][o]}return s}},t.exports=r},function(t,e,n){"use strict";function r(t,e){if(!(this instanceof r))return new r(t,e);t=i.Matrix.checkMatrix(t),e=e||{};var n=t.rows,o=t.columns,c=v(n,o),l=!0,h=!0;!1===e.computeLeftSingularVectors&&(l=!1),!1===e.computeRightSingularVectors&&(h=!1);var f,d=!1;if(n<o)if(!0===e.autoTranspose){n=(f=t.transpose()).rows,o=f.columns,d=!0;var p=l;l=h,h=p}else f=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else f=t.clone();var m,g,y,w,b,x,_,E,S,T,A,k,C,D,L,O,P,I,N,F,j,z=Array(v(n+1,o)),U=s(n,c,0),V=s(o,o,0),B=Array(o),H=Array(n),q=v(n-1,o),G=M(0,v(o-2,n));for(y=0,T=M(q,G);y<T;y++){if(y<q){for(z[y]=0,m=y;m<n;m++)z[y]=a(z[y],f[m][y]);if(0!==z[y]){for(0>f[y][y]&&(z[y]=-z[y]),m=y;m<n;m++)f[m][y]/=z[y];f[y][y]+=1}z[y]=-z[y]}for(g=y+1;g<o;g++){if(y<q&&0!==z[y]){for(b=0,m=y;m<n;m++)b+=f[m][y]*f[m][g];for(b=-b/f[y][y],m=y;m<n;m++)f[m][g]+=b*f[m][y]}B[g]=f[y][g]}if(l&&y<q)for(m=y;m<n;m++)U[m][y]=f[m][y];if(y<G){for(B[y]=0,m=y+1;m<o;m++)B[y]=a(B[y],B[m]);if(0!==B[y]){for(0>B[y+1]&&(B[y]=0-B[y]),m=y+1;m<o;m++)B[m]/=B[y];B[y+1]+=1}if(B[y]=-B[y],y+1<n&&0!==B[y]){for(m=y+1;m<n;m++)H[m]=0;for(g=y+1;g<o;g++)for(m=y+1;m<n;m++)H[m]+=B[g]*f[m][g];for(g=y+1;g<o;g++)for(b=-B[g]/B[y+1],m=y+1;m<n;m++)f[m][g]+=b*H[m]}if(h)for(m=y+1;m<o;m++)V[m][y]=B[m]}}if(w=v(o,n+1),q<o&&(z[q]=f[q][q]),n<w&&(z[w-1]=0),G+1<w&&(B[G]=f[G][w-1]),B[w-1]=0,l){for(g=q;g<c;g++){for(m=0;m<n;m++)U[m][g]=0;U[g][g]=1}for(y=q-1;0<=y;y--)if(0!==z[y]){for(g=y+1;g<c;g++){for(b=0,m=y;m<n;m++)b+=U[m][y]*U[m][g];for(b=-b/U[y][y],m=y;m<n;m++)U[m][g]+=b*U[m][y]}for(m=y;m<n;m++)U[m][y]=-U[m][y];for(U[y][y]=1+U[y][y],m=0;m<y-1;m++)U[m][y]=0}else{for(m=0;m<n;m++)U[m][y]=0;U[y][y]=1}}if(h)for(y=o-1;0<=y;y--){if(y<G&&0!==B[y])for(g=y+1;g<o;g++){for(b=0,m=y+1;m<o;m++)b+=V[m][y]*V[m][g];for(b=-b/V[y+1][y],m=y+1;m<o;m++)V[m][g]+=b*V[m][y]}for(m=0;m<o;m++)V[m][y]=0;V[y][y]=1}for(var W=w-1,Y=2.220446049250313e-16;0<w;){for(y=w-2;-1<=y&&-1!==y;y--)if(u(B[y])<=Y*(u(z[y])+u(z[y+1]))){B[y]=0;break}if(y===w-2)A=4;else{for(x=w-1;x>=y&&x!==y;x--)if(b=(x===w?0:u(B[x]))+(x===y+1?0:u(B[x-1])),u(z[x])<=Y*b){z[x]=0;break}x===y?A=3:x===w-1?A=1:(A=2,y=x)}switch(y++,A){case 1:for(_=B[w-2],B[w-2]=0,g=w-2;g>=y;g--)if(b=a(z[g],_),E=z[g]/b,S=_/b,z[g]=b,g!==y&&(_=-S*B[g-1],B[g-1]=E*B[g-1]),h)for(m=0;m<o;m++)b=E*V[m][g]+S*V[m][w-1],V[m][w-1]=-S*V[m][g]+E*V[m][w-1],V[m][g]=b;break;case 2:for(_=B[y-1],B[y-1]=0,g=y;g<w;g++)if(b=a(z[g],_),E=z[g]/b,S=_/b,z[g]=b,_=-S*B[g],B[g]=E*B[g],l)for(m=0;m<n;m++)b=E*U[m][g]+S*U[m][y-1],U[m][y-1]=-S*U[m][g]+E*U[m][y-1],U[m][g]=b;break;case 3:for(k=M(M(M(M(u(z[w-1]),u(z[w-2])),u(B[w-2])),u(z[y])),u(B[y])),O=z[y]/k,P=B[y]/k,N=(C=z[w-1]/k)*(L=B[w-2]/k)*(C*L),F=0,(0!=(I=(((D=z[w-2]/k)+C)*(D-C)+L*L)/2)||0!==N)&&(F=R(I*I+N),0>I&&(F=-F),F=N/(I+F)),_=(O+C)*(O-C)+F,j=O*P,g=y;g<w-1;g++){if(E=_/(b=a(_,j)),S=j/b,g!==y&&(B[g-1]=b),_=E*z[g]+S*B[g],B[g]=E*B[g]-S*z[g],j=S*z[g+1],z[g+1]=E*z[g+1],h)for(m=0;m<o;m++)b=E*V[m][g]+S*V[m][g+1],V[m][g+1]=-S*V[m][g]+E*V[m][g+1],V[m][g]=b;if(E=_/(b=a(_,j)),S=j/b,z[g]=b,_=E*B[g]+S*z[g+1],z[g+1]=-S*B[g]+E*z[g+1],j=S*B[g+1],B[g+1]=E*B[g+1],l&&g<n-1)for(m=0;m<n;m++)b=E*U[m][g]+S*U[m][g+1],U[m][g+1]=-S*U[m][g]+E*U[m][g+1],U[m][g]=b}B[w-2]=_;break;case 4:if(0>=z[y]&&(z[y]=0>z[y]?-z[y]:0,h))for(m=0;m<=W;m++)V[m][y]=-V[m][y];for(;y<W&&!(z[y]>=z[y+1]);){if(b=z[y],z[y]=z[y+1],z[y+1]=b,h&&y<o-1)for(m=0;m<o;m++)b=V[m][y+1],V[m][y+1]=V[m][y],V[m][y]=b;if(l&&y<n-1)for(m=0;m<n;m++)b=U[m][y+1],U[m][y+1]=U[m][y],U[m][y]=b;y++}w--}}if(d){var X=V;V=U,U=X}this.m=n,this.n=o,this.s=z,this.U=U,this.V=V}var i=n(8),o=n(42),a=o.hypotenuse,s=o.getFilled2DArray;r.prototype={get condition(){return this.s[0]/this.s[v(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var t=M(this.m,this.n)*this.s[0]*2.220446049250313e-16,e=0,n=this.s,r=0,i=n.length;r<i;r++)n[r]>t&&e++;return e},get diagonal(){return this.s},get threshold(){return 1.1102230246251565e-16*M(this.m,this.n)*this.s[0]},get leftSingularVectors(){return i.Matrix.isMatrix(this.U)||(this.U=new i.Matrix(this.U)),this.U},get rightSingularVectors(){return i.Matrix.isMatrix(this.V)||(this.V=new i.Matrix(this.V)),this.V},get diagonalMatrix(){return i.Matrix.diag(this.s)},solve:function(t){var e,n=this.threshold,r=this.s.length,o=i.Matrix.zeros(r,r);for(e=0;e<r;e++)o[e][e]=u(this.s[e])<=n?0:1/this.s[e];var a,s,c,l=this.U,h=this.rightSingularVectors,f=h.mmul(o),d=h.rows,p=l.length,m=i.Matrix.zeros(d,p);for(e=0;e<d;e++)for(a=0;a<p;a++){for(c=0,s=0;s<r;s++)c+=f[e][s]*l[a][s];m[e][a]=c}return m.mmul(t)},solveForDiagonal:function(t){return this.solve(i.Matrix.diag(t))},inverse:function(){var t,e,n=this.V,r=this.threshold,o=n.length,a=n[0].length,s=new i.Matrix(o,this.s.length);for(t=0;t<o;t++)for(e=0;e<a;e++)s[t][e]=u(this.s[e])>r?n[t][e]/this.s[e]:0;var c,l,h=this.U,f=h.length,d=h[0].length,p=new i.Matrix(o,f);for(t=0;t<o;t++)for(e=0;e<f;e++){for(l=0,c=0;c<d;c++)l+=s[t][c]*h[e][c];p[t][e]=l}return p}},t.exports=r},function(e,t,i){"use strict";function n(e){function t(t,e){if(t.rows!==e.rows||t.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal")}function n(t,e){return t-e}function x(t,e){for(var n in e)t=t.replace(new RegExp("%"+n+"%","g"),e[n]);return t}void 0===e&&(e=Object);class w extends e{static get[Symbol.species](){return this}static from1DArray(t,e,n){if(t*e!==n.length)throw new RangeError("Data length does not match given dimensions");for(var r=new this(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)r.set(i,o,n[i*e+o]);return r}static rowVector(t){for(var e=new this(1,t.length),n=0;n<t.length;n++)e.set(0,n,t[n]);return e}static columnVector(t){for(var e=new this(t.length,1),n=0;n<t.length;n++)e.set(n,0,t[n]);return e}static empty(t,e){return new this(t,e)}static zeros(t,e){return this.empty(t,e).fill(0)}static ones(t,e){return this.empty(t,e).fill(1)}static rand(t,e,n){void 0===n&&(n=Math.random);for(var r=this.empty(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)r.set(i,o,n());return r}static randInt(t,e,n,r){void 0===n&&(n=1e3),void 0===r&&(r=Math.random);for(var i=this.empty(t,e),o=0;o<t;o++)for(var a,s=0;s<e;s++)a=g(r()*n),i.set(o,s,a);return i}static eye(t,e,n){void 0===e&&(e=t),void 0===n&&(n=1);for(var r=v(t,e),i=this.zeros(t,e),o=0;o<r;o++)i.set(o,o,n);return i}static diag(t,e,n){var r=t.length;void 0===e&&(e=r),void 0===n&&(n=e);for(var i=v(r,e,n),o=this.zeros(e,n),a=0;a<i;a++)o.set(a,a,t[a]);return o}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),o=0;o<n;o++)for(var a=0;a<r;a++)i.set(o,a,v(t.get(o,a),e.get(o,a)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),o=0;o<n;o++)for(var a=0;a<r;a++)i.set(o,a,M(t.get(o,a),e.get(o,a)));return i}static checkMatrix(t){return w.isMatrix(t)?t:new this(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=this.rows,n=this.columns,r=0;r<e;r++)for(var i=0;i<n;i++)t.call(this,r,i);return this}to1DArray(){for(var t=Array(this.size),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t[e*this.columns+n]=this.get(e,n);return t}to2DArray(){for(var t=Array(this.rows),e=0;e<this.rows;e++){t[e]=Array(this.columns);for(var n=0;n<this.columns;n++)t[e][n]=this.get(e,n)}return t}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t,e){t=t||1,e=e||1;for(var n=new this.constructor[Symbol.species](this.rows*t,this.columns*e),r=0;r<t;r++)for(var i=0;i<e;i++)n.setSubMatrix(this,this.rows*r,this.columns*i);return n}fill(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,t);return this}neg(){return this.mulS(-1)}getRow(t){l.checkRowIndex(this,t);for(var e=Array(this.columns),n=0;n<this.columns;n++)e[n]=this.get(t,n);return e}getRowVector(t){return this.constructor.rowVector(this.getRow(t))}setRow(t,e){l.checkRowIndex(this,t),e=l.checkRowVector(this,e);for(var n=0;n<this.columns;n++)this.set(t,n,e[n]);return this}swapRows(t,e){l.checkRowIndex(this,t),l.checkRowIndex(this,e);for(var n,r=0;r<this.columns;r++)n=this.get(t,r),this.set(t,r,this.get(e,r)),this.set(e,r,n);return this}getColumn(t){l.checkColumnIndex(this,t);for(var e=Array(this.rows),n=0;n<this.rows;n++)e[n]=this.get(n,t);return e}getColumnVector(t){return this.constructor.columnVector(this.getColumn(t))}setColumn(t,e){l.checkColumnIndex(this,t),e=l.checkColumnVector(this,e);for(var n=0;n<this.rows;n++)this.set(n,t,e[n]);return this}swapColumns(t,e){l.checkColumnIndex(this,t),l.checkColumnIndex(this,e);for(var n,r=0;r<this.rows;r++)n=this.get(r,t),this.set(r,t,this.get(r,e)),this.set(r,e,n);return this}addRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[n]);return this}subRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[n]);return this}mulRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[n]);return this}divRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[n]);return this}addColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[e]);return this}subColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[e]);return this}mulColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[e]);return this}divColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[e]);return this}mulRow(t,e){l.checkRowIndex(this,t);for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this}mulColumn(t,e){l.checkColumnIndex(this,t);for(var n=0;n<this.rows;n++)this.set(n,t,this.get(n,t)*e);return this}max(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)>t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}min(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)<t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}maxRow(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxRowIndex(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r),n[1]=r);return n}minRow(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minRowIndex(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r),n[1]=r);return n}maxColumn(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t));return e}maxColumnIndex(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t),n[0]=r);return n}minColumn(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t));return e}minColumnIndex(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t),n[0]=r);return n}diag(){for(var t=v(this.rows,this.columns),e=Array(t),n=0;n<t;n++)e[n]=this.get(n,n);return e}sum(t){return"row"===t?l.sumByRow(this):"column"===t?l.sumByColumn(this):l.sumAll(this)}mean(){return this.sum()/this.size}prod(){for(var t=1,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t*=this.get(e,n);return t}cumulativeSum(){for(var t=0,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t+=this.get(e,n),this.set(e,n,t);return this}dot(t){w.isMatrix(t)&&(t=t.to1DArray());var e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n}mmul(t){t=this.constructor.checkMatrix(t),this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var e=this.rows,n=this.columns,r=t.columns,i=new this.constructor[Symbol.species](e,r),o=Array(n),a=0;a<r;a++){for(var s=0;s<n;s++)o[s]=t.get(s,a);for(var u,c=0;c<e;c++){for(u=0,s=0;s<n;s++)u+=this.get(c,s)*o[s];i.set(c,a,u)}}return i}strassen2x2(t){var e=new this.constructor[Symbol.species](2,2),n=this.get(0,0),r=t.get(0,0),i=this.get(0,1),o=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),c=t.get(1,1),l=(n+u)*(r+c),h=(a+u)*r,f=n*(o-c),d=u*(s-r),p=(n+i)*c;return e.set(0,0,l+d-p+(i-u)*(s+c)),e.set(0,1,f+p),e.set(1,0,h+d),e.set(1,1,l-h+f+(a-n)*(r+o)),e}strassen3x3(t){var e=new this.constructor[Symbol.species](3,3),n=this.get(0,0),r=this.get(0,1),i=this.get(0,2),o=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),c=this.get(2,1),l=this.get(2,2),h=t.get(0,0),f=t.get(0,1),d=t.get(0,2),p=t.get(1,0),m=t.get(1,1),g=t.get(1,2),v=t.get(2,0),y=t.get(2,1),w=t.get(2,2),b=(n-o)*(-f+m),x=(-n+o+a)*(h-f+m),_=(o+a)*(-h+f),M=n*h,E=(-n+u+c)*(h-d+g),S=(-n+u)*(d-g),T=(u+c)*(-h+d),A=(-i+c+l)*(m+v-y),k=(i-l)*(m-y),C=i*v,R=(c+l)*(-v+y),D=(-i+a+s)*(g+v-w),L=(i-s)*(g-w),O=(a+s)*(-v+w);return e.set(0,0,M+C+r*p),e.set(0,1,(n+r+i-o-a-c-l)*m+x+_+M+A+C+R),e.set(0,2,M+E+T+(n+r+i-a-s-u-c)*g+C+D+O),e.set(1,0,b+a*(-h+f+p-m-g-v+w)+x+M+C+D+L),e.set(1,1,b+x+_+M+s*y),e.set(1,2,C+D+L+O+o*d),e.set(2,0,M+E+S+c*(-h+d+p-m-g-v+y)+A+k+C),e.set(2,1,A+k+C+R+u*f),e.set(2,2,M+E+S+T+l*w),e}mmulStrassen(t){function e(t,e,n){return t.rows===e&&t.columns===n?t:w.zeros(e,n).setSubMatrix(t,0,0)}var n=this.clone(),r=n.rows,i=n.columns,o=t.rows,a=t.columns;i!==o&&console.warn(`Multiplying ${r} x ${i} and ${o} x ${a} matrix: dimensions do not match.`);var s=M(r,o),u=M(i,a);return function t(n,r,i,o){if(512>=i||512>=o)return n.mmul(r);1==i%2&&1==o%2?(n=e(n,i+1,o+1),r=e(r,i+1,o+1)):1==i%2?(n=e(n,i+1,o),r=e(r,i+1,o)):1==o%2&&(n=e(n,i,o+1),r=e(r,i,o+1));var a=parseInt(n.rows/2),s=parseInt(n.columns/2),u=n.subMatrix(0,a-1,0,s-1),c=r.subMatrix(0,a-1,0,s-1),l=n.subMatrix(0,a-1,s,n.columns-1),h=r.subMatrix(0,a-1,s,r.columns-1),f=n.subMatrix(a,n.rows-1,0,s-1),d=r.subMatrix(a,r.rows-1,0,s-1),p=n.subMatrix(a,n.rows-1,s,n.columns-1),m=r.subMatrix(a,r.rows-1,s,r.columns-1),g=t(w.add(u,p),w.add(c,m),a,s),v=t(w.add(f,p),c,a,s),y=t(u,w.sub(h,m),a,s),b=t(p,w.sub(d,c),a,s),x=t(w.add(u,l),m,a,s),_=t(w.sub(f,u),w.add(c,h),a,s),M=t(w.sub(l,p),w.add(d,m),a,s),E=w.add(g,b);E.sub(x),E.add(M);var S=w.add(y,x),T=w.add(v,b),A=w.sub(g,v);A.add(y),A.add(_);var k=w.zeros(2*E.rows,2*E.columns);return(k=(k=(k=(k=k.setSubMatrix(E,0,0)).setSubMatrix(S,E.rows,0)).setSubMatrix(T,0,E.columns)).setSubMatrix(A,E.rows,E.columns)).subMatrix(0,i-1,0,o-1)}(n=e(n,s,u),t=e(t,s,u),s,u)}scaleRows(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n,r=this.constructor.empty(this.rows,this.columns),i=0;i<this.rows;i++)n=s.scale(this.getRow(i),{min:t,max:e}),r.setRow(i,n);return r}scaleColumns(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n,r=this.constructor.empty(this.rows,this.columns),i=0;i<this.columns;i++)n=s.scale(this.getColumn(i),{min:t,max:e}),r.setColumn(i,n);return r}kroneckerProduct(t){t=this.constructor.checkMatrix(t);for(var e=this.rows,n=this.columns,r=t.rows,i=t.columns,o=new this.constructor[Symbol.species](e*r,n*i),a=0;a<e;a++)for(var s=0;s<n;s++)for(var u=0;u<r;u++)for(var c=0;c<i;c++)o[r*a+u][i*s+c]=this.get(a,s)*t.get(u,c);return o}transpose(){for(var t=new this.constructor[Symbol.species](this.columns,this.rows),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(n,e,this.get(e,n));return t}sortRows(t){void 0===t&&(t=n);for(var e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t){void 0===t&&(t=n);for(var e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,n,r){l.checkRange(this,t,e,n,r);for(var i=new this.constructor[Symbol.species](e-t+1,r-n+1),o=t;o<=e;o++)for(var a=n;a<=r;a++)i[o-t][a-n]=this.get(o,a);return i}subMatrixRow(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.columns-1),e>n||0>e||e>=this.columns||0>n||n>=this.columns)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](t.length,n-e+1),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(0>t[i]||t[i]>=this.rows)throw new RangeError("Row index out of range: "+t[i]);r.set(i,o-e,this.get(t[i],o))}return r}subMatrixColumn(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.rows-1),e>n||0>e||e>=this.rows||0>n||n>=this.rows)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](n-e+1,t.length),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(0>t[i]||t[i]>=this.columns)throw new RangeError("Column index out of range: "+t[i]);r.set(o-e,i,this.get(o,t[i]))}return r}setSubMatrix(t,e,n){t=this.constructor.checkMatrix(t),l.checkRange(this,e,e+t.rows-1,n,n+t.columns-1);for(var r=0;r<t.rows;r++)for(var i=0;i<t.columns;i++)this[e+r][n+i]=t.get(r,i);return this}selection(t,e){for(var n,r=l.checkIndices(this,t,e),i=new this.constructor[Symbol.species](t.length,e.length),o=0;o<r.row.length;o++){n=r.row[o];for(var a=0;a<r.column.length;a++)i[o][a]=this.get(n,r.column[a])}return i}trace(){for(var t=v(this.rows,this.columns),e=0,n=0;n<t;n++)e+=this.get(n,n);return e}transposeView(){return new c(this)}rowView(t){return l.checkRowIndex(this,t),new m(this,t)}columnView(t){return l.checkColumnIndex(this,t),new p(this,t)}flipRowView(){return new k(this)}flipColumnView(){return new j(this)}subMatrixView(t,e,n,r){return new d(this,t,e,n,r)}selectionView(t,e){return new h(this,t,e)}det(){var t,e,n,r,i,a;if(this.isSquare())return 2===this.columns?(t=this.get(0,0),e=this.get(0,1),n=this.get(1,0),t*this.get(1,1)-e*n):3===this.columns?(r=this.selectionView([1,2],[1,2]),i=this.selectionView([1,2],[0,2]),a=this.selectionView([1,2],[0,1]),t=this.get(0,0),e=this.get(0,1),n=this.get(0,2),t*r.det()-e*i.det()+n*a.det()):new o(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(t){void 0===t&&(t=a);for(var e=new r(this,{autoTranspose:!0}),n=e.leftSingularVectors,i=e.rightSingularVectors,o=e.diagonal,s=0;s<o.length;s++)o[s]=u(o[s])>t?1/o[s]:0;return o=this.constructor[Symbol.species].diag(o),i.mmul(o.mmul(n.transposeView()))}}w.prototype.klass="Matrix",w.random=w.rand,w.diagonal=w.diag,w.prototype.diagonal=w.prototype.diag,w.identity=w.eye,w.prototype.negate=w.prototype.neg,w.prototype.tensorProduct=w.prototype.kroneckerProduct,w.prototype.determinant=w.prototype.det;var f="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",y="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",b="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",R="\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",I="\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",S="\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",C="\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",V="\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",D="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",z="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",_="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",P=V,A=[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]],L=!0,U=!1,F,i;try{for(var T=A[Symbol.iterator](),q;!(L=(q=T.next()).done);L=!0){var N=q.value,O=eval(x(f,{name:N[1],op:N[0]})),E=eval(x(y,{name:N[1]+"S",op:N[0]})),B=eval(x(b,{name:N[1]+"M",op:N[0]})),Q=eval(x(R,{name:N[1]}));for(F=1;F<N.length;F++)w.prototype[N[F]]=O,w.prototype[N[F]+"S"]=E,w.prototype[N[F]+"M"]=B,w[N[F]]=Q}}catch(e){U=!0,i=e}finally{try{!L&&T.return&&T.return()}finally{if(U)throw i}}var W=[["~","not"]];["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(t){W.push(["Math."+t,t])});var X=!0,J=!1,Y;try{for(var H=W[Symbol.iterator](),K;!(X=(K=H.next()).done);X=!0){var G=K.value,Z=eval(x(I,{name:G[1],method:G[0]})),$=eval(x(S,{name:G[1]}));for(F=1;F<G.length;F++)w.prototype[G[F]]=Z,w[G[F]]=$}}catch(e){J=!0,Y=e}finally{try{!X&&H.return&&H.return()}finally{if(J)throw Y}}var ee=[["Math.pow",1,"pow"]],te=!0,ie=!1,ne;try{for(var oe=ee[Symbol.iterator](),se;!(te=(se=oe.next()).done);te=!0){var re=se.value,ae="arg0";for(F=1;F<re[1];F++)ae+=`, arg${F}`;if(1!==re[1]){var le=eval(x(C,{name:re[2],method:re[0],args:ae})),ce=eval(x(V,{name:re[2],args:ae}));for(F=2;F<re.length;F++)w.prototype[re[F]]=le,w[re[F]]=ce}else{var ue={name:re[2],args:ae,method:re[0]},me=eval(x(_,ue)),de=eval(x(D,ue)),ge=eval(x(z,ue)),he=eval(x(P,ue));for(F=2;F<re.length;F++)w.prototype[re[F]]=me,w.prototype[re[F]+"M"]=ge,w.prototype[re[F]+"S"]=de,w[re[F]]=he}}}catch(e){ie=!0,ne=e}finally{try{!te&&oe.return&&oe.return()}finally{if(ie)throw ne}}return w}e.exports=n;var o=i(84),r=i(85),s=i(1),l=i(28),c=i(258),m=i(259),d=i(260),h=i(261),p=i(262),k=i(263),j=i(264)},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);var e,n,o,a,s,c,l,h,f,d,p=(t=i.Matrix.checkMatrix(t)).clone(),m=p.rows,g=p.columns,y=Array(m),w=1;for(e=0;e<m;e++)y[e]=e;for(f=Array(m),n=0;n<g;n++){for(e=0;e<m;e++)f[e]=p[e][n];for(e=0;e<m;e++){for(h=p[e],d=v(e,n),s=0,o=0;o<d;o++)s+=h[o]*f[o];h[n]=f[e]-=s}for(a=n,e=n+1;e<m;e++)u(f[e])>u(f[a])&&(a=e);if(a!==n){for(o=0;o<g;o++)c=p[a][o],p[a][o]=p[n][o],p[n][o]=c;l=y[a],y[a]=y[n],y[n]=l,w=-w}if(n<m&&0!==p[n][n])for(e=n+1;e<m;e++)p[e][n]/=p[n][n]}this.LU=p,this.pivotVector=y,this.pivotSign=w}var i=n(9);r.prototype={isSingular:function(){for(var t=this.LU,e=t.columns,n=0;n<e;n++)if(0===t[n][n])return!0;return!1},get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var e=this.pivotSign,n=t.columns,r=0;r<n;r++)e*=t[r][r];return e},get lowerTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new i.Matrix(e,n),o=0;o<e;o++)for(var a=0;a<n;a++)r[o][a]=o>a?t[o][a]:o===a?1:0;return r},get upperTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new i.Matrix(e,n),o=0;o<e;o++)for(var a=0;a<n;a++)r[o][a]=o<=a?t[o][a]:0;return r},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(t){t=i.Matrix.checkMatrix(t);var e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var n,r,o,a=t.columns,s=t.subMatrixRow(this.pivotVector,0,a-1),u=e.columns;for(o=0;o<u;o++)for(n=o+1;n<u;n++)for(r=0;r<a;r++)s[n][r]-=s[o][r]*e[n][o];for(o=u-1;0<=o;o--){for(r=0;r<a;r++)s[o][r]/=e[o][o];for(n=0;n<o;n++)for(r=0;r<a;r++)s[n][r]-=s[o][r]*e[n][o]}return s}},t.exports=r},function(t,e,n){"use strict";function r(t,e){if(!(this instanceof r))return new r(t,e);t=i.Matrix.checkMatrix(t),e=e||{};var n=t.rows,o=t.columns,c=v(n,o),l=!0,h=!0;!1===e.computeLeftSingularVectors&&(l=!1),!1===e.computeRightSingularVectors&&(h=!1);var f,d=!1;if(n<o)if(!0===e.autoTranspose){n=(f=t.transpose()).rows,o=f.columns,d=!0;var p=l;l=h,h=p}else f=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else f=t.clone();var m,g,y,w,b,x,_,E,S,T,A,k,C,D,L,O,P,I,N,F,j,z=Array(v(n+1,o)),U=s(n,c,0),V=s(o,o,0),B=Array(o),H=Array(n),q=v(n-1,o),G=M(0,v(o-2,n));for(y=0,T=M(q,G);y<T;y++){if(y<q){for(z[y]=0,m=y;m<n;m++)z[y]=a(z[y],f[m][y]);if(0!==z[y]){for(0>f[y][y]&&(z[y]=-z[y]),m=y;m<n;m++)f[m][y]/=z[y];f[y][y]+=1}z[y]=-z[y]}for(g=y+1;g<o;g++){if(y<q&&0!==z[y]){for(b=0,m=y;m<n;m++)b+=f[m][y]*f[m][g];for(b=-b/f[y][y],m=y;m<n;m++)f[m][g]+=b*f[m][y]}B[g]=f[y][g]}if(l&&y<q)for(m=y;m<n;m++)U[m][y]=f[m][y];if(y<G){for(B[y]=0,m=y+1;m<o;m++)B[y]=a(B[y],B[m]);if(0!==B[y]){for(0>B[y+1]&&(B[y]=0-B[y]),m=y+1;m<o;m++)B[m]/=B[y];B[y+1]+=1}if(B[y]=-B[y],y+1<n&&0!==B[y]){for(m=y+1;m<n;m++)H[m]=0;for(g=y+1;g<o;g++)for(m=y+1;m<n;m++)H[m]+=B[g]*f[m][g];for(g=y+1;g<o;g++)for(b=-B[g]/B[y+1],m=y+1;m<n;m++)f[m][g]+=b*H[m]}if(h)for(m=y+1;m<o;m++)V[m][y]=B[m]}}if(w=v(o,n+1),q<o&&(z[q]=f[q][q]),n<w&&(z[w-1]=0),G+1<w&&(B[G]=f[G][w-1]),B[w-1]=0,l){for(g=q;g<c;g++){for(m=0;m<n;m++)U[m][g]=0;U[g][g]=1}for(y=q-1;0<=y;y--)if(0!==z[y]){for(g=y+1;g<c;g++){for(b=0,m=y;m<n;m++)b+=U[m][y]*U[m][g];for(b=-b/U[y][y],m=y;m<n;m++)U[m][g]+=b*U[m][y]}for(m=y;m<n;m++)U[m][y]=-U[m][y];for(U[y][y]=1+U[y][y],m=0;m<y-1;m++)U[m][y]=0}else{for(m=0;m<n;m++)U[m][y]=0;U[y][y]=1}}if(h)for(y=o-1;0<=y;y--){if(y<G&&0!==B[y])for(g=y+1;g<o;g++){for(b=0,m=y+1;m<o;m++)b+=V[m][y]*V[m][g];for(b=-b/V[y+1][y],m=y+1;m<o;m++)V[m][g]+=b*V[m][y]}for(m=0;m<o;m++)V[m][y]=0;V[y][y]=1}for(var W=w-1,Y=2.220446049250313e-16;0<w;){for(y=w-2;-1<=y&&-1!==y;y--)if(u(B[y])<=Y*(u(z[y])+u(z[y+1]))){B[y]=0;break}if(y===w-2)A=4;else{for(x=w-1;x>=y&&x!==y;x--)if(b=(x===w?0:u(B[x]))+(x===y+1?0:u(B[x-1])),u(z[x])<=Y*b){z[x]=0;break}x===y?A=3:x===w-1?A=1:(A=2,y=x)}switch(y++,A){case 1:for(_=B[w-2],B[w-2]=0,g=w-2;g>=y;g--)if(b=a(z[g],_),E=z[g]/b,S=_/b,z[g]=b,g!==y&&(_=-S*B[g-1],B[g-1]=E*B[g-1]),h)for(m=0;m<o;m++)b=E*V[m][g]+S*V[m][w-1],V[m][w-1]=-S*V[m][g]+E*V[m][w-1],V[m][g]=b;break;case 2:for(_=B[y-1],B[y-1]=0,g=y;g<w;g++)if(b=a(z[g],_),E=z[g]/b,S=_/b,z[g]=b,_=-S*B[g],B[g]=E*B[g],l)for(m=0;m<n;m++)b=E*U[m][g]+S*U[m][y-1],U[m][y-1]=-S*U[m][g]+E*U[m][y-1],U[m][g]=b;break;case 3:for(k=M(M(M(M(u(z[w-1]),u(z[w-2])),u(B[w-2])),u(z[y])),u(B[y])),O=z[y]/k,P=B[y]/k,N=(C=z[w-1]/k)*(L=B[w-2]/k)*(C*L),F=0,(0!=(I=(((D=z[w-2]/k)+C)*(D-C)+L*L)/2)||0!==N)&&(F=R(I*I+N),0>I&&(F=-F),F=N/(I+F)),_=(O+C)*(O-C)+F,j=O*P,g=y;g<w-1;g++){if(E=_/(b=a(_,j)),S=j/b,g!==y&&(B[g-1]=b),_=E*z[g]+S*B[g],B[g]=E*B[g]-S*z[g],j=S*z[g+1],z[g+1]=E*z[g+1],h)for(m=0;m<o;m++)b=E*V[m][g]+S*V[m][g+1],V[m][g+1]=-S*V[m][g]+E*V[m][g+1],V[m][g]=b;if(E=_/(b=a(_,j)),S=j/b,z[g]=b,_=E*B[g]+S*z[g+1],z[g+1]=-S*B[g]+E*z[g+1],j=S*B[g+1],B[g+1]=E*B[g+1],l&&g<n-1)for(m=0;m<n;m++)b=E*U[m][g]+S*U[m][g+1],U[m][g+1]=-S*U[m][g]+E*U[m][g+1],U[m][g]=b}B[w-2]=_;break;case 4:if(0>=z[y]&&(z[y]=0>z[y]?-z[y]:0,h))for(m=0;m<=W;m++)V[m][y]=-V[m][y];for(;y<W&&!(z[y]>=z[y+1]);){if(b=z[y],z[y]=z[y+1],z[y+1]=b,h&&y<o-1)for(m=0;m<o;m++)b=V[m][y+1],V[m][y+1]=V[m][y],V[m][y]=b;if(l&&y<n-1)for(m=0;m<n;m++)b=U[m][y+1],U[m][y+1]=U[m][y],U[m][y]=b;y++}w--}}if(d){var X=V;V=U,U=X}this.m=n,this.n=o,this.s=z,this.U=U,this.V=V}var i=n(9),o=n(43),a=o.hypotenuse,s=o.getFilled2DArray;r.prototype={get condition(){return this.s[0]/this.s[v(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var t=M(this.m,this.n)*this.s[0]*2.220446049250313e-16,e=0,n=this.s,r=0,i=n.length;r<i;r++)n[r]>t&&e++;return e},get diagonal(){return this.s},get threshold(){return 1.1102230246251565e-16*M(this.m,this.n)*this.s[0]},get leftSingularVectors(){return i.Matrix.isMatrix(this.U)||(this.U=new i.Matrix(this.U)),this.U},get rightSingularVectors(){return i.Matrix.isMatrix(this.V)||(this.V=new i.Matrix(this.V)),this.V},get diagonalMatrix(){return i.Matrix.diag(this.s)},solve:function(t){var e,n=this.threshold,r=this.s.length,o=i.Matrix.zeros(r,r);for(e=0;e<r;e++)o[e][e]=u(this.s[e])<=n?0:1/this.s[e];var a,s,c,l=this.U,h=this.rightSingularVectors,f=h.mmul(o),d=h.rows,p=l.length,m=i.Matrix.zeros(d,p);for(e=0;e<d;e++)for(a=0;a<p;a++){for(c=0,s=0;s<r;s++)c+=f[e][s]*l[a][s];m[e][a]=c}return m.mmul(t)},solveForDiagonal:function(t){return this.solve(i.Matrix.diag(t))},inverse:function(){var t,e,n=this.V,r=this.threshold,o=n.length,a=n[0].length,s=new i.Matrix(o,this.s.length);for(t=0;t<o;t++)for(e=0;e<a;e++)s[t][e]=u(this.s[e])>r?n[t][e]/this.s[e]:0;var c,l,h=this.U,f=h.length,d=h[0].length,p=new i.Matrix(o,f);for(t=0;t<o;t++)for(e=0;e<f;e++){for(l=0,c=0;c<d;c++)l+=s[t][c]*h[e][c];p[t][e]=l}return p}},t.exports=r},function(t){"use strict";class e{constructor(t,e){if(t.length!==t[0].length)throw new Error("Confusion matrix must be square");if(e.length!==t.length)throw new Error("Confusion matrix and labels should have the same length");this.labels=e,this.matrix=t}static fromLabels(t,n,r={}){if(n.length!==t.length)throw new Error("predicted and actual must have the same length");var i;i=r.labels?new Set(r.labels):new Set([...t,...n]),i=Array.from(i),r.sort&&i.sort(r.sort);for(var o=Array.from({length:i.length}),a=0;a<o.length;a++)o[a]=Array(o.length),o[a].fill(0);for(var s=0;s<n.length;s++){var u=i.indexOf(t[s]),c=i.indexOf(n[s]);0<=u&&0<=c&&o[u][c]++}return new e(o,i)}getMatrix(){return this.matrix}getLabels(){return this.labels}getTotalCount(){for(var t=0,e=0;e<this.matrix.length;e++)for(var n=0;n<this.matrix.length;n++)t+=this.matrix[e][n];return t}getTrueCount(){for(var t=0,e=0;e<this.matrix.length;e++)t+=this.matrix[e][e];return t}getFalseCount(){return this.getTotalCount()-this.getTrueCount()}getTruePositiveCount(t){var e=this.getIndex(t);return this.matrix[e][e]}getTrueNegativeCount(t){for(var e=this.getIndex(t),n=0,r=0;r<this.matrix.length;r++)for(var i=0;i<this.matrix.length;i++)r!==e&&i!==e&&(n+=this.matrix[r][i]);return n}getFalsePositiveCount(t){for(var e=this.getIndex(t),n=0,r=0;r<this.matrix.length;r++)r!==e&&(n+=this.matrix[r][e]);return n}getFalseNegativeCount(t){for(var e=this.getIndex(t),n=0,r=0;r<this.matrix.length;r++)r!==e&&(n+=this.matrix[e][r]);return n}getPositiveCount(t){return this.getTruePositiveCount(t)+this.getFalseNegativeCount(t)}getNegativeCount(t){return this.getTrueNegativeCount(t)+this.getFalsePositiveCount(t)}getIndex(t){var e=this.labels.indexOf(t);if(-1===e)throw new Error("The label does not exist");return e}getTruePositiveRate(t){return this.getTruePositiveCount(t)/this.getPositiveCount(t)}getTrueNegativeRate(t){return this.getTrueNegativeCount(t)/this.getNegativeCount(t)}getPositivePredictiveValue(t){var e=this.getTruePositiveCount(t);return e/(e+this.getFalsePositiveCount(t))}getNegativePredictiveValue(t){var e=this.getTrueNegativeCount(t);return e/(e+this.getFalseNegativeCount(t))}getFalseNegativeRate(t){return 1-this.getTruePositiveRate(t)}getFalsePositiveRate(t){return 1-this.getTrueNegativeRate(t)}getFalseDiscoveryRate(t){var e=this.getFalsePositiveCount(t);return e/(e+this.getTruePositiveCount(t))}getFalseOmissionRate(t){var e=this.getFalseNegativeCount(t);return e/(e+this.getTruePositiveCount(t))}getF1Score(t){var e=this.getTruePositiveCount(t);return 2*e/(2*e+this.getFalsePositiveCount(t)+this.getFalseNegativeCount(t))}getMatthewsCorrelationCoefficient(t){var e=this.getTruePositiveCount(t),n=this.getTrueNegativeCount(t),r=this.getFalsePositiveCount(t),i=this.getFalseNegativeCount(t);return(e*n-r*i)/R((e+r)*(e+i)*(n+r)*(n+i))}getInformedness(t){return this.getTruePositiveRate(t)+this.getTrueNegativeRate(t)-1}getMarkedness(t){return this.getPositivePredictiveValue(t)+this.getNegativePredictiveValue(t)-1}getConfusionTable(t){return[[this.getTruePositiveCount(t),this.getFalseNegativeCount(t)],[this.getFalsePositiveCount(t),this.getTrueNegativeCount(t)]]}getAccuracy(){for(var t=0,e=0,n=0;n<this.matrix.length;n++)for(var r=0;r<this.matrix.length;r++)n===r?t+=this.matrix[n][r]:e+=this.matrix[n][r];return t/(t+e)}getCount(t,e){var n=this.getIndex(t),r=this.getIndex(e);return this.matrix[n][r]}get accuracy(){return this.getAccuracy()}get total(){return this.getTotalCount()}}t.exports=e},function(t,e,n){"use strict";function i(t,e){t&&(this.means=e.means,this.calculateProbabilities=e.calculateProbabilities)}function a(t,e,n){for(var r,i=0,a=-1,u=0;u<n.length;++u){r=n[u][0];for(var c=1;c<n[0][1].length+1;++c)r+=s(t[c-1],e[u][c-1],n[u][c][0],n[u][c][1]);(r=o(r))>i&&(i=r,a=u)}return a}function s(t,e,n,i){return r(n*o((t-=e)*t/i))}function u(t,e){for(var n=t.columns,r=0,i=Array(100),o=0;o<e.length;o++)void 0===i[e[o]]&&(i[e[o]]=0,r++),i[e[o]]++;var a=Array(r),s=Array(r);for(o=0;o<r;++o)a[o]=new c(i[o],n),s[o]=0;for(o=0;o<t.rows;++o)a[e[o]].setRow(s[e[o]],t.getRow(o)),s[e[o]]++;return a}var c=n(276),l=n(2);t.exports.NaiveBayes=i,t.exports.separateClasses=u,i.prototype.train=function(t,e){var n=R(2*Math.PI);if((t=c.isMatrix(t)?t.clone():new c(t)).rows!==e.length)throw new RangeError("the size of the training set and the training labels must be the same.");var i=u(t,e),o=Array(i.length);this.means=Array(i.length);for(var a=0;a<i.length;++a){var s=l.matrix.mean(i[a]),h=l.matrix.standardDeviation(i[a],s),f=r(i[a].rows/t.rows);o[a]=Array(s.length+1),o[a][0]=f;for(var d,p=1;p<s.length+1;++p)o[a][p]=[1/(n*(d=h[p-1])),-2*d*d];this.means[a]=s}this.calculateProbabilities=o},i.prototype.predict=function(t){if(t[0].length===this.calculateProbabilities[0].length)throw new RangeError("the dataset must have the same features as the training set");for(var e=Array(t.length),n=0;n<e.length;++n)e[n]=a(t[n],this.means,this.calculateProbabilities);return e},i.prototype.export=function(){return{modelName:"NaiveBayes",means:this.means,calculateProbabilities:this.calculateProbabilities}},i.load=function(t){if("NaiveBayes"!==t.modelName)throw new RangeError("The given model is invalid!");return new i(!0,t)}},function(e,t,i){"use strict";function n(e){function t(t,e){if(t.rows!==e.rows||t.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal")}function n(t,e){return t-e}function x(t,e){for(var n in e)t=t.replace(new RegExp("%"+n+"%","g"),e[n]);return t}void 0===e&&(e=Object);class w extends e{static get[Symbol.species](){return this}static from1DArray(t,e,n){if(t*e!==n.length)throw new RangeError("Data length does not match given dimensions");for(var r=new this(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)r.set(i,o,n[i*e+o]);return r}static rowVector(t){for(var e=new this(1,t.length),n=0;n<t.length;n++)e.set(0,n,t[n]);return e}static columnVector(t){for(var e=new this(t.length,1),n=0;n<t.length;n++)e.set(n,0,t[n]);return e}static empty(t,e){return new this(t,e)}static zeros(t,e){return this.empty(t,e).fill(0)}static ones(t,e){return this.empty(t,e).fill(1)}static rand(t,e,n){void 0===n&&(n=Math.random);for(var r=this.empty(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)r.set(i,o,n());return r}static randInt(t,e,n,r){void 0===n&&(n=1e3),void 0===r&&(r=Math.random);for(var i=this.empty(t,e),o=0;o<t;o++)for(var a,s=0;s<e;s++)a=g(r()*n),i.set(o,s,a);return i}static eye(t,e,n){void 0===e&&(e=t),void 0===n&&(n=1);for(var r=v(t,e),i=this.zeros(t,e),o=0;o<r;o++)i.set(o,o,n);return i}static diag(t,e,n){var r=t.length;void 0===e&&(e=r),void 0===n&&(n=e);for(var i=v(r,e,n),o=this.zeros(e,n),a=0;a<i;a++)o.set(a,a,t[a]);return o}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),o=0;o<n;o++)for(var a=0;a<r;a++)i.set(o,a,v(t.get(o,a),e.get(o,a)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),o=0;o<n;o++)for(var a=0;a<r;a++)i.set(o,a,M(t.get(o,a),e.get(o,a)));return i}static checkMatrix(t){return w.isMatrix(t)?t:new this(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=this.rows,n=this.columns,r=0;r<e;r++)for(var i=0;i<n;i++)t.call(this,r,i);return this}to1DArray(){for(var t=Array(this.size),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t[e*this.columns+n]=this.get(e,n);return t}to2DArray(){for(var t=Array(this.rows),e=0;e<this.rows;e++){t[e]=Array(this.columns);for(var n=0;n<this.columns;n++)t[e][n]=this.get(e,n)}return t}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t,e){t=t||1,e=e||1;for(var n=new this.constructor[Symbol.species](this.rows*t,this.columns*e),r=0;r<t;r++)for(var i=0;i<e;i++)n.setSubMatrix(this,this.rows*r,this.columns*i);return n}fill(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,t);return this}neg(){return this.mulS(-1)}getRow(t){l.checkRowIndex(this,t);for(var e=Array(this.columns),n=0;n<this.columns;n++)e[n]=this.get(t,n);return e}getRowVector(t){return this.constructor.rowVector(this.getRow(t))}setRow(t,e){l.checkRowIndex(this,t),e=l.checkRowVector(this,e);for(var n=0;n<this.columns;n++)this.set(t,n,e[n]);return this}swapRows(t,e){l.checkRowIndex(this,t),l.checkRowIndex(this,e);for(var n,r=0;r<this.columns;r++)n=this.get(t,r),this.set(t,r,this.get(e,r)),this.set(e,r,n);return this}getColumn(t){l.checkColumnIndex(this,t);for(var e=Array(this.rows),n=0;n<this.rows;n++)e[n]=this.get(n,t);return e}getColumnVector(t){return this.constructor.columnVector(this.getColumn(t))}setColumn(t,e){l.checkColumnIndex(this,t),e=l.checkColumnVector(this,e);for(var n=0;n<this.rows;n++)this.set(n,t,e[n]);return this}swapColumns(t,e){l.checkColumnIndex(this,t),l.checkColumnIndex(this,e);for(var n,r=0;r<this.rows;r++)n=this.get(r,t),this.set(r,t,this.get(r,e)),this.set(r,e,n);return this}addRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[n]);return this}subRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[n]);return this}mulRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[n]);return this}divRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[n]);return this}addColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[e]);return this}subColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[e]);return this}mulColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[e]);return this}divColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[e]);return this}mulRow(t,e){l.checkRowIndex(this,t);for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this}mulColumn(t,e){l.checkColumnIndex(this,t);for(var n=0;n<this.rows;n++)this.set(n,t,this.get(n,t)*e);return this}max(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)>t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}min(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)<t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}maxRow(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxRowIndex(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r),n[1]=r);return n}minRow(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minRowIndex(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r),n[1]=r);return n}maxColumn(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t));return e}maxColumnIndex(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t),n[0]=r);return n}minColumn(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t));return e}minColumnIndex(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t),n[0]=r);return n}diag(){for(var t=v(this.rows,this.columns),e=Array(t),n=0;n<t;n++)e[n]=this.get(n,n);return e}sum(t){return"row"===t?l.sumByRow(this):"column"===t?l.sumByColumn(this):l.sumAll(this)}mean(){return this.sum()/this.size}prod(){for(var t=1,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t*=this.get(e,n);return t}cumulativeSum(){for(var t=0,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t+=this.get(e,n),this.set(e,n,t);return this}dot(t){w.isMatrix(t)&&(t=t.to1DArray());var e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n}mmul(t){t=this.constructor.checkMatrix(t),this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var e=this.rows,n=this.columns,r=t.columns,i=new this.constructor[Symbol.species](e,r),o=Array(n),a=0;a<r;a++){for(var s=0;s<n;s++)o[s]=t.get(s,a);for(var u,c=0;c<e;c++){for(u=0,s=0;s<n;s++)u+=this.get(c,s)*o[s];i.set(c,a,u)}}return i}strassen2x2(t){var e=new this.constructor[Symbol.species](2,2),n=this.get(0,0),r=t.get(0,0),i=this.get(0,1),o=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),c=t.get(1,1),l=(n+u)*(r+c),h=(a+u)*r,f=n*(o-c),d=u*(s-r),p=(n+i)*c;return e.set(0,0,l+d-p+(i-u)*(s+c)),e.set(0,1,f+p),e.set(1,0,h+d),e.set(1,1,l-h+f+(a-n)*(r+o)),e}strassen3x3(t){var e=new this.constructor[Symbol.species](3,3),n=this.get(0,0),r=this.get(0,1),i=this.get(0,2),o=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),c=this.get(2,1),l=this.get(2,2),h=t.get(0,0),f=t.get(0,1),d=t.get(0,2),p=t.get(1,0),m=t.get(1,1),g=t.get(1,2),v=t.get(2,0),y=t.get(2,1),w=t.get(2,2),b=(n-o)*(-f+m),x=(-n+o+a)*(h-f+m),_=(o+a)*(-h+f),M=n*h,E=(-n+u+c)*(h-d+g),S=(-n+u)*(d-g),T=(u+c)*(-h+d),A=(-i+c+l)*(m+v-y),k=(i-l)*(m-y),C=i*v,R=(c+l)*(-v+y),D=(-i+a+s)*(g+v-w),L=(i-s)*(g-w),O=(a+s)*(-v+w);return e.set(0,0,M+C+r*p),e.set(0,1,(n+r+i-o-a-c-l)*m+x+_+M+A+C+R),e.set(0,2,M+E+T+(n+r+i-a-s-u-c)*g+C+D+O),e.set(1,0,b+a*(-h+f+p-m-g-v+w)+x+M+C+D+L),e.set(1,1,b+x+_+M+s*y),e.set(1,2,C+D+L+O+o*d),e.set(2,0,M+E+S+c*(-h+d+p-m-g-v+y)+A+k+C),e.set(2,1,A+k+C+R+u*f),e.set(2,2,M+E+S+T+l*w),e}mmulStrassen(t){function e(t,e,n){return t.rows===e&&t.columns===n?t:w.zeros(e,n).setSubMatrix(t,0,0)}var n=this.clone(),r=n.rows,i=n.columns,o=t.rows,a=t.columns;i!==o&&console.warn(`Multiplying ${r} x ${i} and ${o} x ${a} matrix: dimensions do not match.`);var s=M(r,o),u=M(i,a);return function t(n,r,i,o){if(512>=i||512>=o)return n.mmul(r);1==i%2&&1==o%2?(n=e(n,i+1,o+1),r=e(r,i+1,o+1)):1==i%2?(n=e(n,i+1,o),r=e(r,i+1,o)):1==o%2&&(n=e(n,i,o+1),r=e(r,i,o+1));var a=parseInt(n.rows/2),s=parseInt(n.columns/2),u=n.subMatrix(0,a-1,0,s-1),c=r.subMatrix(0,a-1,0,s-1),l=n.subMatrix(0,a-1,s,n.columns-1),h=r.subMatrix(0,a-1,s,r.columns-1),f=n.subMatrix(a,n.rows-1,0,s-1),d=r.subMatrix(a,r.rows-1,0,s-1),p=n.subMatrix(a,n.rows-1,s,n.columns-1),m=r.subMatrix(a,r.rows-1,s,r.columns-1),g=t(w.add(u,p),w.add(c,m),a,s),v=t(w.add(f,p),c,a,s),y=t(u,w.sub(h,m),a,s),b=t(p,w.sub(d,c),a,s),x=t(w.add(u,l),m,a,s),_=t(w.sub(f,u),w.add(c,h),a,s),M=t(w.sub(l,p),w.add(d,m),a,s),E=w.add(g,b);E.sub(x),E.add(M);var S=w.add(y,x),T=w.add(v,b),A=w.sub(g,v);A.add(y),A.add(_);var k=w.zeros(2*E.rows,2*E.columns);return(k=(k=(k=(k=k.setSubMatrix(E,0,0)).setSubMatrix(S,E.rows,0)).setSubMatrix(T,0,E.columns)).setSubMatrix(A,E.rows,E.columns)).subMatrix(0,i-1,0,o-1)}(n=e(n,s,u),t=e(t,s,u),s,u)}scaleRows(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n,r=this.constructor.empty(this.rows,this.columns),i=0;i<this.rows;i++)n=s.scale(this.getRow(i),{min:t,max:e}),r.setRow(i,n);return r}scaleColumns(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n,r=this.constructor.empty(this.rows,this.columns),i=0;i<this.columns;i++)n=s.scale(this.getColumn(i),{min:t,max:e}),r.setColumn(i,n);return r}kroneckerProduct(t){t=this.constructor.checkMatrix(t);for(var e=this.rows,n=this.columns,r=t.rows,i=t.columns,o=new this.constructor[Symbol.species](e*r,n*i),a=0;a<e;a++)for(var s=0;s<n;s++)for(var u=0;u<r;u++)for(var c=0;c<i;c++)o[r*a+u][i*s+c]=this.get(a,s)*t.get(u,c);return o}transpose(){for(var t=new this.constructor[Symbol.species](this.columns,this.rows),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(n,e,this.get(e,n));return t}sortRows(t){void 0===t&&(t=n);for(var e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t){void 0===t&&(t=n);for(var e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,n,r){l.checkRange(this,t,e,n,r);for(var i=new this.constructor[Symbol.species](e-t+1,r-n+1),o=t;o<=e;o++)for(var a=n;a<=r;a++)i[o-t][a-n]=this.get(o,a);return i}subMatrixRow(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.columns-1),e>n||0>e||e>=this.columns||0>n||n>=this.columns)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](t.length,n-e+1),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(0>t[i]||t[i]>=this.rows)throw new RangeError("Row index out of range: "+t[i]);r.set(i,o-e,this.get(t[i],o))}return r}subMatrixColumn(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.rows-1),e>n||0>e||e>=this.rows||0>n||n>=this.rows)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](n-e+1,t.length),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(0>t[i]||t[i]>=this.columns)throw new RangeError("Column index out of range: "+t[i]);r.set(o-e,i,this.get(o,t[i]))}return r}setSubMatrix(t,e,n){t=this.constructor.checkMatrix(t),l.checkRange(this,e,e+t.rows-1,n,n+t.columns-1);for(var r=0;r<t.rows;r++)for(var i=0;i<t.columns;i++)this[e+r][n+i]=t.get(r,i);return this}selection(t,e){for(var n,r=l.checkIndices(this,t,e),i=new this.constructor[Symbol.species](t.length,e.length),o=0;o<r.row.length;o++){n=r.row[o];for(var a=0;a<r.column.length;a++)i[o][a]=this.get(n,r.column[a])}return i}trace(){for(var t=v(this.rows,this.columns),e=0,n=0;n<t;n++)e+=this.get(n,n);return e}transposeView(){return new c(this)}rowView(t){return l.checkRowIndex(this,t),new m(this,t)}columnView(t){return l.checkColumnIndex(this,t),new p(this,t)}flipRowView(){return new k(this)}flipColumnView(){return new j(this)}subMatrixView(t,e,n,r){return new d(this,t,e,n,r)}selectionView(t,e){return new h(this,t,e)}det(){var t,e,n,r,i,a;if(this.isSquare())return 2===this.columns?(t=this.get(0,0),e=this.get(0,1),n=this.get(1,0),t*this.get(1,1)-e*n):3===this.columns?(r=this.selectionView([1,2],[1,2]),i=this.selectionView([1,2],[0,2]),a=this.selectionView([1,2],[0,1]),t=this.get(0,0),e=this.get(0,1),n=this.get(0,2),t*r.det()-e*i.det()+n*a.det()):new o(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(t){void 0===t&&(t=a);for(var e=new r(this,{autoTranspose:!0}),n=e.leftSingularVectors,i=e.rightSingularVectors,o=e.diagonal,s=0;s<o.length;s++)o[s]=u(o[s])>t?1/o[s]:0;return o=this.constructor[Symbol.species].diag(o),i.mmul(o.mmul(n.transposeView()))}}w.prototype.klass="Matrix",w.random=w.rand,w.diagonal=w.diag,w.prototype.diagonal=w.prototype.diag,w.identity=w.eye,w.prototype.negate=w.prototype.neg,w.prototype.tensorProduct=w.prototype.kroneckerProduct,w.prototype.determinant=w.prototype.det;var f="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",y="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",b="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",R="\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",I="\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",S="\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",C="\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",V="\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",D="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",z="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",_="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",P=V,A=[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]],L=!0,U=!1,F,i;try{for(var T=A[Symbol.iterator](),q;!(L=(q=T.next()).done);L=!0){var N=q.value,O=eval(x(f,{name:N[1],op:N[0]})),E=eval(x(y,{name:N[1]+"S",op:N[0]})),B=eval(x(b,{name:N[1]+"M",op:N[0]})),Q=eval(x(R,{name:N[1]}));for(F=1;F<N.length;F++)w.prototype[N[F]]=O,w.prototype[N[F]+"S"]=E,w.prototype[N[F]+"M"]=B,w[N[F]]=Q}}catch(e){U=!0,i=e}finally{try{!L&&T.return&&T.return()}finally{if(U)throw i}}var W=[["~","not"]];["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(t){W.push(["Math."+t,t])});var X=!0,J=!1,Y;try{for(var H=W[Symbol.iterator](),K;!(X=(K=H.next()).done);X=!0){var G=K.value,Z=eval(x(I,{name:G[1],method:G[0]})),$=eval(x(S,{name:G[1]}));for(F=1;F<G.length;F++)w.prototype[G[F]]=Z,w[G[F]]=$}}catch(e){J=!0,Y=e}finally{try{!X&&H.return&&H.return()}finally{if(J)throw Y}}var ee=[["Math.pow",1,"pow"]],te=!0,ie=!1,ne;try{for(var oe=ee[Symbol.iterator](),se;!(te=(se=oe.next()).done);te=!0){var re=se.value,ae="arg0";for(F=1;F<re[1];F++)ae+=`, arg${F}`;if(1!==re[1]){var le=eval(x(C,{name:re[2],method:re[0],args:ae})),ce=eval(x(V,{name:re[2],args:ae}));for(F=2;F<re.length;F++)w.prototype[re[F]]=le,w[re[F]]=ce}else{var ue={name:re[2],args:ae,method:re[0]},me=eval(x(_,ue)),de=eval(x(D,ue)),ge=eval(x(z,ue)),he=eval(x(P,ue));for(F=2;F<re.length;F++)w.prototype[re[F]]=me,w.prototype[re[F]+"M"]=ge,w.prototype[re[F]+"S"]=de,w[re[F]]=he}}}catch(e){ie=!0,ne=e}finally{try{!te&&oe.return&&oe.return()}finally{if(ie)throw ne}}return w}e.exports=n;var o=i(89),r=i(90),s=i(1),l=i(29),c=i(278),m=i(279),d=i(280),h=i(281),p=i(282),k=i(283),j=i(284)},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);var e,n,o,a,s,c,l,h,f,d,p=(t=i.Matrix.checkMatrix(t)).clone(),m=p.rows,g=p.columns,y=Array(m),w=1;for(e=0;e<m;e++)y[e]=e;for(f=Array(m),n=0;n<g;n++){for(e=0;e<m;e++)f[e]=p[e][n];for(e=0;e<m;e++){for(h=p[e],d=v(e,n),s=0,o=0;o<d;o++)s+=h[o]*f[o];h[n]=f[e]-=s}for(a=n,e=n+1;e<m;e++)u(f[e])>u(f[a])&&(a=e);if(a!==n){for(o=0;o<g;o++)c=p[a][o],p[a][o]=p[n][o],p[n][o]=c;l=y[a],y[a]=y[n],y[n]=l,w=-w}if(n<m&&0!==p[n][n])for(e=n+1;e<m;e++)p[e][n]/=p[n][n]}this.LU=p,this.pivotVector=y,this.pivotSign=w}var i=n(10);r.prototype={isSingular:function(){for(var t=this.LU,e=t.columns,n=0;n<e;n++)if(0===t[n][n])return!0;return!1},get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var e=this.pivotSign,n=t.columns,r=0;r<n;r++)e*=t[r][r];return e},get lowerTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new i.Matrix(e,n),o=0;o<e;o++)for(var a=0;a<n;a++)r[o][a]=o>a?t[o][a]:o===a?1:0;return r},get upperTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new i.Matrix(e,n),o=0;o<e;o++)for(var a=0;a<n;a++)r[o][a]=o<=a?t[o][a]:0;return r},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(t){t=i.Matrix.checkMatrix(t);var e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var n,r,o,a=t.columns,s=t.subMatrixRow(this.pivotVector,0,a-1),u=e.columns;for(o=0;o<u;o++)for(n=o+1;n<u;n++)for(r=0;r<a;r++)s[n][r]-=s[o][r]*e[n][o];for(o=u-1;0<=o;o--){for(r=0;r<a;r++)s[o][r]/=e[o][o];for(n=0;n<o;n++)for(r=0;r<a;r++)s[n][r]-=s[o][r]*e[n][o]}return s}},t.exports=r},function(t,e,n){"use strict";function r(t,e){if(!(this instanceof r))return new r(t,e);t=i.Matrix.checkMatrix(t),e=e||{};var n=t.rows,o=t.columns,c=v(n,o),l=!0,h=!0;!1===e.computeLeftSingularVectors&&(l=!1),!1===e.computeRightSingularVectors&&(h=!1);var f,d=!1;if(n<o)if(!0===e.autoTranspose){n=(f=t.transpose()).rows,o=f.columns,d=!0;var p=l;l=h,h=p}else f=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else f=t.clone();var m,g,y,w,b,x,_,E,S,T,A,k,C,D,L,O,P,I,N,F,j,z=Array(v(n+1,o)),U=s(n,c,0),V=s(o,o,0),B=Array(o),H=Array(n),q=v(n-1,o),G=M(0,v(o-2,n));for(y=0,T=M(q,G);y<T;y++){if(y<q){for(z[y]=0,m=y;m<n;m++)z[y]=a(z[y],f[m][y]);if(0!==z[y]){for(0>f[y][y]&&(z[y]=-z[y]),m=y;m<n;m++)f[m][y]/=z[y];f[y][y]+=1}z[y]=-z[y]}for(g=y+1;g<o;g++){if(y<q&&0!==z[y]){for(b=0,m=y;m<n;m++)b+=f[m][y]*f[m][g];for(b=-b/f[y][y],m=y;m<n;m++)f[m][g]+=b*f[m][y]}B[g]=f[y][g]}if(l&&y<q)for(m=y;m<n;m++)U[m][y]=f[m][y];if(y<G){for(B[y]=0,m=y+1;m<o;m++)B[y]=a(B[y],B[m]);if(0!==B[y]){for(0>B[y+1]&&(B[y]=0-B[y]),m=y+1;m<o;m++)B[m]/=B[y];B[y+1]+=1}if(B[y]=-B[y],y+1<n&&0!==B[y]){for(m=y+1;m<n;m++)H[m]=0;for(g=y+1;g<o;g++)for(m=y+1;m<n;m++)H[m]+=B[g]*f[m][g];for(g=y+1;g<o;g++)for(b=-B[g]/B[y+1],m=y+1;m<n;m++)f[m][g]+=b*H[m]}if(h)for(m=y+1;m<o;m++)V[m][y]=B[m]}}if(w=v(o,n+1),q<o&&(z[q]=f[q][q]),n<w&&(z[w-1]=0),G+1<w&&(B[G]=f[G][w-1]),B[w-1]=0,l){for(g=q;g<c;g++){for(m=0;m<n;m++)U[m][g]=0;U[g][g]=1}for(y=q-1;0<=y;y--)if(0!==z[y]){for(g=y+1;g<c;g++){for(b=0,m=y;m<n;m++)b+=U[m][y]*U[m][g];for(b=-b/U[y][y],m=y;m<n;m++)U[m][g]+=b*U[m][y]}for(m=y;m<n;m++)U[m][y]=-U[m][y];for(U[y][y]=1+U[y][y],m=0;m<y-1;m++)U[m][y]=0}else{for(m=0;m<n;m++)U[m][y]=0;U[y][y]=1}}if(h)for(y=o-1;0<=y;y--){if(y<G&&0!==B[y])for(g=y+1;g<o;g++){for(b=0,m=y+1;m<o;m++)b+=V[m][y]*V[m][g];for(b=-b/V[y+1][y],m=y+1;m<o;m++)V[m][g]+=b*V[m][y]}for(m=0;m<o;m++)V[m][y]=0;V[y][y]=1}for(var W=w-1,Y=2.220446049250313e-16;0<w;){for(y=w-2;-1<=y&&-1!==y;y--)if(u(B[y])<=Y*(u(z[y])+u(z[y+1]))){B[y]=0;break}if(y===w-2)A=4;else{for(x=w-1;x>=y&&x!==y;x--)if(b=(x===w?0:u(B[x]))+(x===y+1?0:u(B[x-1])),u(z[x])<=Y*b){z[x]=0;break}x===y?A=3:x===w-1?A=1:(A=2,y=x)}switch(y++,A){case 1:for(_=B[w-2],B[w-2]=0,g=w-2;g>=y;g--)if(b=a(z[g],_),E=z[g]/b,S=_/b,z[g]=b,g!==y&&(_=-S*B[g-1],B[g-1]=E*B[g-1]),h)for(m=0;m<o;m++)b=E*V[m][g]+S*V[m][w-1],V[m][w-1]=-S*V[m][g]+E*V[m][w-1],V[m][g]=b;break;case 2:for(_=B[y-1],B[y-1]=0,g=y;g<w;g++)if(b=a(z[g],_),E=z[g]/b,S=_/b,z[g]=b,_=-S*B[g],B[g]=E*B[g],l)for(m=0;m<n;m++)b=E*U[m][g]+S*U[m][y-1],U[m][y-1]=-S*U[m][g]+E*U[m][y-1],U[m][g]=b;break;case 3:for(k=M(M(M(M(u(z[w-1]),u(z[w-2])),u(B[w-2])),u(z[y])),u(B[y])),O=z[y]/k,P=B[y]/k,N=(C=z[w-1]/k)*(L=B[w-2]/k)*(C*L),F=0,(0!=(I=(((D=z[w-2]/k)+C)*(D-C)+L*L)/2)||0!==N)&&(F=R(I*I+N),0>I&&(F=-F),F=N/(I+F)),_=(O+C)*(O-C)+F,j=O*P,g=y;g<w-1;g++){if(E=_/(b=a(_,j)),S=j/b,g!==y&&(B[g-1]=b),_=E*z[g]+S*B[g],B[g]=E*B[g]-S*z[g],j=S*z[g+1],z[g+1]=E*z[g+1],h)for(m=0;m<o;m++)b=E*V[m][g]+S*V[m][g+1],V[m][g+1]=-S*V[m][g]+E*V[m][g+1],V[m][g]=b;if(E=_/(b=a(_,j)),S=j/b,z[g]=b,_=E*B[g]+S*z[g+1],z[g+1]=-S*B[g]+E*z[g+1],j=S*B[g+1],B[g+1]=E*B[g+1],l&&g<n-1)for(m=0;m<n;m++)b=E*U[m][g]+S*U[m][g+1],U[m][g+1]=-S*U[m][g]+E*U[m][g+1],U[m][g]=b}B[w-2]=_;break;case 4:if(0>=z[y]&&(z[y]=0>z[y]?-z[y]:0,h))for(m=0;m<=W;m++)V[m][y]=-V[m][y];for(;y<W&&!(z[y]>=z[y+1]);){if(b=z[y],z[y]=z[y+1],z[y+1]=b,h&&y<o-1)for(m=0;m<o;m++)b=V[m][y+1],V[m][y+1]=V[m][y],V[m][y]=b;if(l&&y<n-1)for(m=0;m<n;m++)b=U[m][y+1],U[m][y+1]=U[m][y],U[m][y]=b;y++}w--}}if(d){var X=V;V=U,U=X}this.m=n,this.n=o,this.s=z,this.U=U,this.V=V}var i=n(10),o=n(44),a=o.hypotenuse,s=o.getFilled2DArray;r.prototype={get condition(){return this.s[0]/this.s[v(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var t=M(this.m,this.n)*this.s[0]*2.220446049250313e-16,e=0,n=this.s,r=0,i=n.length;r<i;r++)n[r]>t&&e++;return e},get diagonal(){return this.s},get threshold(){return 1.1102230246251565e-16*M(this.m,this.n)*this.s[0]},get leftSingularVectors(){return i.Matrix.isMatrix(this.U)||(this.U=new i.Matrix(this.U)),this.U},get rightSingularVectors(){return i.Matrix.isMatrix(this.V)||(this.V=new i.Matrix(this.V)),this.V},get diagonalMatrix(){return i.Matrix.diag(this.s)},solve:function(t){var e,n=this.threshold,r=this.s.length,o=i.Matrix.zeros(r,r);for(e=0;e<r;e++)o[e][e]=u(this.s[e])<=n?0:1/this.s[e];var a,s,c,l=this.U,h=this.rightSingularVectors,f=h.mmul(o),d=h.rows,p=l.length,m=i.Matrix.zeros(d,p);for(e=0;e<d;e++)for(a=0;a<p;a++){for(c=0,s=0;s<r;s++)c+=f[e][s]*l[a][s];m[e][a]=c}return m.mmul(t)},solveForDiagonal:function(t){return this.solve(i.Matrix.diag(t))},inverse:function(){var t,e,n=this.V,r=this.threshold,o=n.length,a=n[0].length,s=new i.Matrix(o,this.s.length);for(t=0;t<o;t++)for(e=0;e<a;e++)s[t][e]=u(this.s[e])>r?n[t][e]/this.s[e]:0;var c,l,h=this.U,f=h.length,d=h[0].length,p=new i.Matrix(o,f);for(t=0;t<o;t++)for(e=0;e<f;e++){for(l=0,c=0;c<d;c++)l+=s[t][c]*h[e][c];p[t][e]=l}return p}},t.exports=r},function(e,t,i){"use strict";function n(e){function t(t,e){if(t.rows!==e.rows||t.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal")}function n(t,e){return t-e}function x(t,e){for(var n in e)t=t.replace(new RegExp("%"+n+"%","g"),e[n]);return t}void 0===e&&(e=Object);class w extends e{static get[Symbol.species](){return this}static from1DArray(t,e,n){if(t*e!==n.length)throw new RangeError("Data length does not match given dimensions");for(var r=new this(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)r.set(i,o,n[i*e+o]);return r}static rowVector(t){for(var e=new this(1,t.length),n=0;n<t.length;n++)e.set(0,n,t[n]);return e}static columnVector(t){for(var e=new this(t.length,1),n=0;n<t.length;n++)e.set(n,0,t[n]);return e}static empty(t,e){return new this(t,e)}static zeros(t,e){return this.empty(t,e).fill(0)}static ones(t,e){return this.empty(t,e).fill(1)}static rand(t,e,n){void 0===n&&(n=Math.random);for(var r=this.empty(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)r.set(i,o,n());return r}static randInt(t,e,n,r){void 0===n&&(n=1e3),void 0===r&&(r=Math.random);for(var i=this.empty(t,e),o=0;o<t;o++)for(var a,s=0;s<e;s++)a=g(r()*n),i.set(o,s,a);return i}static eye(t,e,n){void 0===e&&(e=t),void 0===n&&(n=1);for(var r=v(t,e),i=this.zeros(t,e),o=0;o<r;o++)i.set(o,o,n);return i}static diag(t,e,n){var r=t.length;void 0===e&&(e=r),void 0===n&&(n=e);for(var i=v(r,e,n),o=this.zeros(e,n),a=0;a<i;a++)o.set(a,a,t[a]);return o}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),o=0;o<n;o++)for(var a=0;a<r;a++)i.set(o,a,v(t.get(o,a),e.get(o,a)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),o=0;o<n;o++)for(var a=0;a<r;a++)i.set(o,a,M(t.get(o,a),e.get(o,a)));return i}static checkMatrix(t){return w.isMatrix(t)?t:new this(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=this.rows,n=this.columns,r=0;r<e;r++)for(var i=0;i<n;i++)t.call(this,r,i);return this}to1DArray(){for(var t=Array(this.size),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t[e*this.columns+n]=this.get(e,n);return t}to2DArray(){for(var t=Array(this.rows),e=0;e<this.rows;e++){t[e]=Array(this.columns);for(var n=0;n<this.columns;n++)t[e][n]=this.get(e,n)}return t}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t,e){t=t||1,e=e||1;for(var n=new this.constructor[Symbol.species](this.rows*t,this.columns*e),r=0;r<t;r++)for(var i=0;i<e;i++)n.setSubMatrix(this,this.rows*r,this.columns*i);return n}fill(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,t);return this}neg(){return this.mulS(-1)}getRow(t){l.checkRowIndex(this,t);for(var e=Array(this.columns),n=0;n<this.columns;n++)e[n]=this.get(t,n);return e}getRowVector(t){return this.constructor.rowVector(this.getRow(t))}setRow(t,e){l.checkRowIndex(this,t),e=l.checkRowVector(this,e);for(var n=0;n<this.columns;n++)this.set(t,n,e[n]);return this}swapRows(t,e){l.checkRowIndex(this,t),l.checkRowIndex(this,e);for(var n,r=0;r<this.columns;r++)n=this.get(t,r),this.set(t,r,this.get(e,r)),this.set(e,r,n);return this}getColumn(t){l.checkColumnIndex(this,t);for(var e=Array(this.rows),n=0;n<this.rows;n++)e[n]=this.get(n,t);return e}getColumnVector(t){return this.constructor.columnVector(this.getColumn(t))}setColumn(t,e){l.checkColumnIndex(this,t),e=l.checkColumnVector(this,e);for(var n=0;n<this.rows;n++)this.set(n,t,e[n]);return this}swapColumns(t,e){l.checkColumnIndex(this,t),l.checkColumnIndex(this,e);for(var n,r=0;r<this.rows;r++)n=this.get(r,t),this.set(r,t,this.get(r,e)),this.set(r,e,n);return this}addRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[n]);return this}subRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[n]);return this}mulRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[n]);return this}divRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[n]);return this}addColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[e]);return this}subColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[e]);return this}mulColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[e]);return this}divColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[e]);return this}mulRow(t,e){l.checkRowIndex(this,t);for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this}mulColumn(t,e){l.checkColumnIndex(this,t);for(var n=0;n<this.rows;n++)this.set(n,t,this.get(n,t)*e);return this}max(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)>t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}min(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)<t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}maxRow(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxRowIndex(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r),n[1]=r);return n}minRow(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minRowIndex(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r),n[1]=r);return n}maxColumn(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t));return e}maxColumnIndex(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t),n[0]=r);return n}minColumn(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t));return e}minColumnIndex(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t),n[0]=r);return n}diag(){for(var t=v(this.rows,this.columns),e=Array(t),n=0;n<t;n++)e[n]=this.get(n,n);return e}sum(t){return"row"===t?l.sumByRow(this):"column"===t?l.sumByColumn(this):l.sumAll(this)}mean(){return this.sum()/this.size}prod(){for(var t=1,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t*=this.get(e,n);return t}cumulativeSum(){for(var t=0,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t+=this.get(e,n),this.set(e,n,t);return this}dot(t){w.isMatrix(t)&&(t=t.to1DArray());var e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n}mmul(t){t=this.constructor.checkMatrix(t),this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var e=this.rows,n=this.columns,r=t.columns,i=new this.constructor[Symbol.species](e,r),o=Array(n),a=0;a<r;a++){for(var s=0;s<n;s++)o[s]=t.get(s,a);for(var u,c=0;c<e;c++){for(u=0,s=0;s<n;s++)u+=this.get(c,s)*o[s];i.set(c,a,u)}}return i}strassen2x2(t){var e=new this.constructor[Symbol.species](2,2),n=this.get(0,0),r=t.get(0,0),i=this.get(0,1),o=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),c=t.get(1,1),l=(n+u)*(r+c),h=(a+u)*r,f=n*(o-c),d=u*(s-r),p=(n+i)*c;return e.set(0,0,l+d-p+(i-u)*(s+c)),e.set(0,1,f+p),e.set(1,0,h+d),e.set(1,1,l-h+f+(a-n)*(r+o)),e}strassen3x3(t){var e=new this.constructor[Symbol.species](3,3),n=this.get(0,0),r=this.get(0,1),i=this.get(0,2),o=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),c=this.get(2,1),l=this.get(2,2),h=t.get(0,0),f=t.get(0,1),d=t.get(0,2),p=t.get(1,0),m=t.get(1,1),g=t.get(1,2),v=t.get(2,0),y=t.get(2,1),w=t.get(2,2),b=(n-o)*(-f+m),x=(-n+o+a)*(h-f+m),_=(o+a)*(-h+f),M=n*h,E=(-n+u+c)*(h-d+g),S=(-n+u)*(d-g),T=(u+c)*(-h+d),A=(-i+c+l)*(m+v-y),k=(i-l)*(m-y),C=i*v,R=(c+l)*(-v+y),D=(-i+a+s)*(g+v-w),L=(i-s)*(g-w),O=(a+s)*(-v+w);return e.set(0,0,M+C+r*p),e.set(0,1,(n+r+i-o-a-c-l)*m+x+_+M+A+C+R),e.set(0,2,M+E+T+(n+r+i-a-s-u-c)*g+C+D+O),e.set(1,0,b+a*(-h+f+p-m-g-v+w)+x+M+C+D+L),e.set(1,1,b+x+_+M+s*y),e.set(1,2,C+D+L+O+o*d),e.set(2,0,M+E+S+c*(-h+d+p-m-g-v+y)+A+k+C),e.set(2,1,A+k+C+R+u*f),e.set(2,2,M+E+S+T+l*w),e}mmulStrassen(t){function e(t,e,n){return t.rows===e&&t.columns===n?t:w.zeros(e,n).setSubMatrix(t,0,0)}var n=this.clone(),r=n.rows,i=n.columns,o=t.rows,a=t.columns;i!==o&&console.warn(`Multiplying ${r} x ${i} and ${o} x ${a} matrix: dimensions do not match.`);var s=M(r,o),u=M(i,a);return function t(n,r,i,o){if(512>=i||512>=o)return n.mmul(r);1==i%2&&1==o%2?(n=e(n,i+1,o+1),r=e(r,i+1,o+1)):1==i%2?(n=e(n,i+1,o),r=e(r,i+1,o)):1==o%2&&(n=e(n,i,o+1),r=e(r,i,o+1));var a=parseInt(n.rows/2),s=parseInt(n.columns/2),u=n.subMatrix(0,a-1,0,s-1),c=r.subMatrix(0,a-1,0,s-1),l=n.subMatrix(0,a-1,s,n.columns-1),h=r.subMatrix(0,a-1,s,r.columns-1),f=n.subMatrix(a,n.rows-1,0,s-1),d=r.subMatrix(a,r.rows-1,0,s-1),p=n.subMatrix(a,n.rows-1,s,n.columns-1),m=r.subMatrix(a,r.rows-1,s,r.columns-1),g=t(w.add(u,p),w.add(c,m),a,s),v=t(w.add(f,p),c,a,s),y=t(u,w.sub(h,m),a,s),b=t(p,w.sub(d,c),a,s),x=t(w.add(u,l),m,a,s),_=t(w.sub(f,u),w.add(c,h),a,s),M=t(w.sub(l,p),w.add(d,m),a,s),E=w.add(g,b);E.sub(x),E.add(M);var S=w.add(y,x),T=w.add(v,b),A=w.sub(g,v);A.add(y),A.add(_);var k=w.zeros(2*E.rows,2*E.columns);return(k=(k=(k=(k=k.setSubMatrix(E,0,0)).setSubMatrix(S,E.rows,0)).setSubMatrix(T,0,E.columns)).setSubMatrix(A,E.rows,E.columns)).subMatrix(0,i-1,0,o-1)}(n=e(n,s,u),t=e(t,s,u),s,u)}scaleRows(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n,r=this.constructor.empty(this.rows,this.columns),i=0;i<this.rows;i++)n=s.scale(this.getRow(i),{min:t,max:e}),r.setRow(i,n);return r}scaleColumns(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n,r=this.constructor.empty(this.rows,this.columns),i=0;i<this.columns;i++)n=s.scale(this.getColumn(i),{min:t,max:e}),r.setColumn(i,n);return r}kroneckerProduct(t){t=this.constructor.checkMatrix(t);for(var e=this.rows,n=this.columns,r=t.rows,i=t.columns,o=new this.constructor[Symbol.species](e*r,n*i),a=0;a<e;a++)for(var s=0;s<n;s++)for(var u=0;u<r;u++)for(var c=0;c<i;c++)o[r*a+u][i*s+c]=this.get(a,s)*t.get(u,c);return o}transpose(){for(var t=new this.constructor[Symbol.species](this.columns,this.rows),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(n,e,this.get(e,n));return t}sortRows(t){void 0===t&&(t=n);for(var e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t){void 0===t&&(t=n);for(var e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,n,r){l.checkRange(this,t,e,n,r);for(var i=new this.constructor[Symbol.species](e-t+1,r-n+1),o=t;o<=e;o++)for(var a=n;a<=r;a++)i[o-t][a-n]=this.get(o,a);return i}subMatrixRow(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.columns-1),e>n||0>e||e>=this.columns||0>n||n>=this.columns)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](t.length,n-e+1),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(0>t[i]||t[i]>=this.rows)throw new RangeError("Row index out of range: "+t[i]);r.set(i,o-e,this.get(t[i],o))}return r}subMatrixColumn(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.rows-1),e>n||0>e||e>=this.rows||0>n||n>=this.rows)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](n-e+1,t.length),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(0>t[i]||t[i]>=this.columns)throw new RangeError("Column index out of range: "+t[i]);r.set(o-e,i,this.get(o,t[i]))}return r}setSubMatrix(t,e,n){t=this.constructor.checkMatrix(t),l.checkRange(this,e,e+t.rows-1,n,n+t.columns-1);for(var r=0;r<t.rows;r++)for(var i=0;i<t.columns;i++)this[e+r][n+i]=t.get(r,i);return this}selection(t,e){for(var n,r=l.checkIndices(this,t,e),i=new this.constructor[Symbol.species](t.length,e.length),o=0;o<r.row.length;o++){n=r.row[o];for(var a=0;a<r.column.length;a++)i[o][a]=this.get(n,r.column[a])}return i}trace(){for(var t=v(this.rows,this.columns),e=0,n=0;n<t;n++)e+=this.get(n,n);return e}transposeView(){return new c(this)}rowView(t){return l.checkRowIndex(this,t),new m(this,t)}columnView(t){return l.checkColumnIndex(this,t),new p(this,t)}flipRowView(){return new k(this)}flipColumnView(){return new j(this)}subMatrixView(t,e,n,r){return new d(this,t,e,n,r)}selectionView(t,e){return new h(this,t,e)}det(){var t,e,n,r,i,a;if(this.isSquare())return 2===this.columns?(t=this.get(0,0),e=this.get(0,1),n=this.get(1,0),t*this.get(1,1)-e*n):3===this.columns?(r=this.selectionView([1,2],[1,2]),i=this.selectionView([1,2],[0,2]),a=this.selectionView([1,2],[0,1]),t=this.get(0,0),e=this.get(0,1),n=this.get(0,2),t*r.det()-e*i.det()+n*a.det()):new o(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(t){void 0===t&&(t=a);for(var e=new r(this,{autoTranspose:!0}),n=e.leftSingularVectors,i=e.rightSingularVectors,o=e.diagonal,s=0;s<o.length;s++)o[s]=u(o[s])>t?1/o[s]:0;return o=this.constructor[Symbol.species].diag(o),i.mmul(o.mmul(n.transposeView()))}}w.prototype.klass="Matrix",w.random=w.rand,w.diagonal=w.diag,w.prototype.diagonal=w.prototype.diag,w.identity=w.eye,w.prototype.negate=w.prototype.neg,w.prototype.tensorProduct=w.prototype.kroneckerProduct,w.prototype.determinant=w.prototype.det;var f="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",y="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",b="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",R="\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",I="\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",S="\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",C="\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",V="\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",D="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",z="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",_="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",P=V,A=[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]],L=!0,U=!1,F,i;try{for(var T=A[Symbol.iterator](),q;!(L=(q=T.next()).done);L=!0){var N=q.value,O=eval(x(f,{name:N[1],op:N[0]})),E=eval(x(y,{name:N[1]+"S",op:N[0]})),B=eval(x(b,{name:N[1]+"M",op:N[0]})),Q=eval(x(R,{name:N[1]}));for(F=1;F<N.length;F++)w.prototype[N[F]]=O,w.prototype[N[F]+"S"]=E,w.prototype[N[F]+"M"]=B,w[N[F]]=Q}}catch(e){U=!0,i=e}finally{try{!L&&T.return&&T.return()}finally{if(U)throw i}}var W=[["~","not"]];["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(t){W.push(["Math."+t,t])});var X=!0,J=!1,Y;try{for(var H=W[Symbol.iterator](),K;!(X=(K=H.next()).done);X=!0){var G=K.value,Z=eval(x(I,{name:G[1],method:G[0]})),$=eval(x(S,{name:G[1]}));for(F=1;F<G.length;F++)w.prototype[G[F]]=Z,w[G[F]]=$}}catch(e){J=!0,Y=e}finally{try{!X&&H.return&&H.return()}finally{if(J)throw Y}}var ee=[["Math.pow",1,"pow"]],te=!0,ie=!1,ne;try{for(var oe=ee[Symbol.iterator](),se;!(te=(se=oe.next()).done);te=!0){var re=se.value,ae="arg0";for(F=1;F<re[1];F++)ae+=`, arg${F}`;if(1!==re[1]){var le=eval(x(C,{name:re[2],method:re[0],args:ae})),ce=eval(x(V,{name:re[2],args:ae}));for(F=2;F<re.length;F++)w.prototype[re[F]]=le,w[re[F]]=ce}else{var ue={name:re[2],args:ae,method:re[0]},me=eval(x(_,ue)),de=eval(x(D,ue)),ge=eval(x(z,ue)),he=eval(x(P,ue));for(F=2;F<re.length;F++)w.prototype[re[F]]=me,w.prototype[re[F]+"M"]=ge,w.prototype[re[F]+"S"]=de,w[re[F]]=he}}}catch(e){ie=!0,ne=e}finally{try{!te&&oe.return&&oe.return()}finally{if(ie)throw ne}}return w}e.exports=n;var o=i(92),r=i(93),s=i(1),l=i(30),c=i(292),m=i(293),d=i(294),h=i(295),p=i(296),k=i(297),j=i(298)},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);var e,n,o,a,s,c,l,h,f,d,p=(t=i.Matrix.checkMatrix(t)).clone(),m=p.rows,g=p.columns,y=Array(m),w=1;for(e=0;e<m;e++)y[e]=e;for(f=Array(m),n=0;n<g;n++){for(e=0;e<m;e++)f[e]=p[e][n];for(e=0;e<m;e++){for(h=p[e],d=v(e,n),s=0,o=0;o<d;o++)s+=h[o]*f[o];h[n]=f[e]-=s}for(a=n,e=n+1;e<m;e++)u(f[e])>u(f[a])&&(a=e);if(a!==n){for(o=0;o<g;o++)c=p[a][o],p[a][o]=p[n][o],p[n][o]=c;l=y[a],y[a]=y[n],y[n]=l,w=-w}if(n<m&&0!==p[n][n])for(e=n+1;e<m;e++)p[e][n]/=p[n][n]}this.LU=p,this.pivotVector=y,this.pivotSign=w}var i=n(11);r.prototype={isSingular:function(){for(var t=this.LU,e=t.columns,n=0;n<e;n++)if(0===t[n][n])return!0;return!1},get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var e=this.pivotSign,n=t.columns,r=0;r<n;r++)e*=t[r][r];return e},get lowerTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new i.Matrix(e,n),o=0;o<e;o++)for(var a=0;a<n;a++)r[o][a]=o>a?t[o][a]:o===a?1:0;return r},get upperTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new i.Matrix(e,n),o=0;o<e;o++)for(var a=0;a<n;a++)r[o][a]=o<=a?t[o][a]:0;return r},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(t){t=i.Matrix.checkMatrix(t);var e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var n,r,o,a=t.columns,s=t.subMatrixRow(this.pivotVector,0,a-1),u=e.columns;for(o=0;o<u;o++)for(n=o+1;n<u;n++)for(r=0;r<a;r++)s[n][r]-=s[o][r]*e[n][o];for(o=u-1;0<=o;o--){for(r=0;r<a;r++)s[o][r]/=e[o][o];for(n=0;n<o;n++)for(r=0;r<a;r++)s[n][r]-=s[o][r]*e[n][o]}return s}},t.exports=r},function(t,e,n){"use strict";function r(t,e){if(!(this instanceof r))return new r(t,e);t=i.Matrix.checkMatrix(t),e=e||{};var n=t.rows,o=t.columns,c=v(n,o),l=!0,h=!0;!1===e.computeLeftSingularVectors&&(l=!1),!1===e.computeRightSingularVectors&&(h=!1);var f,d=!1;if(n<o)if(!0===e.autoTranspose){n=(f=t.transpose()).rows,o=f.columns,d=!0;var p=l;l=h,h=p}else f=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else f=t.clone();var m,g,y,w,b,x,_,E,S,T,A,k,C,D,L,O,P,I,N,F,j,z=Array(v(n+1,o)),U=s(n,c,0),V=s(o,o,0),B=Array(o),H=Array(n),q=v(n-1,o),G=M(0,v(o-2,n));for(y=0,T=M(q,G);y<T;y++){if(y<q){for(z[y]=0,m=y;m<n;m++)z[y]=a(z[y],f[m][y]);if(0!==z[y]){for(0>f[y][y]&&(z[y]=-z[y]),m=y;m<n;m++)f[m][y]/=z[y];f[y][y]+=1}z[y]=-z[y]}for(g=y+1;g<o;g++){if(y<q&&0!==z[y]){for(b=0,m=y;m<n;m++)b+=f[m][y]*f[m][g];for(b=-b/f[y][y],m=y;m<n;m++)f[m][g]+=b*f[m][y]}B[g]=f[y][g]}if(l&&y<q)for(m=y;m<n;m++)U[m][y]=f[m][y];if(y<G){for(B[y]=0,m=y+1;m<o;m++)B[y]=a(B[y],B[m]);if(0!==B[y]){for(0>B[y+1]&&(B[y]=0-B[y]),m=y+1;m<o;m++)B[m]/=B[y];B[y+1]+=1}if(B[y]=-B[y],y+1<n&&0!==B[y]){for(m=y+1;m<n;m++)H[m]=0;for(g=y+1;g<o;g++)for(m=y+1;m<n;m++)H[m]+=B[g]*f[m][g];for(g=y+1;g<o;g++)for(b=-B[g]/B[y+1],m=y+1;m<n;m++)f[m][g]+=b*H[m]}if(h)for(m=y+1;m<o;m++)V[m][y]=B[m]}}if(w=v(o,n+1),q<o&&(z[q]=f[q][q]),n<w&&(z[w-1]=0),G+1<w&&(B[G]=f[G][w-1]),B[w-1]=0,l){for(g=q;g<c;g++){for(m=0;m<n;m++)U[m][g]=0;U[g][g]=1}for(y=q-1;0<=y;y--)if(0!==z[y]){for(g=y+1;g<c;g++){for(b=0,m=y;m<n;m++)b+=U[m][y]*U[m][g];for(b=-b/U[y][y],m=y;m<n;m++)U[m][g]+=b*U[m][y]}for(m=y;m<n;m++)U[m][y]=-U[m][y];for(U[y][y]=1+U[y][y],m=0;m<y-1;m++)U[m][y]=0}else{for(m=0;m<n;m++)U[m][y]=0;U[y][y]=1}}if(h)for(y=o-1;0<=y;y--){if(y<G&&0!==B[y])for(g=y+1;g<o;g++){for(b=0,m=y+1;m<o;m++)b+=V[m][y]*V[m][g];for(b=-b/V[y+1][y],m=y+1;m<o;m++)V[m][g]+=b*V[m][y]}for(m=0;m<o;m++)V[m][y]=0;V[y][y]=1}for(var W=w-1,Y=2.220446049250313e-16;0<w;){for(y=w-2;-1<=y&&-1!==y;y--)if(u(B[y])<=Y*(u(z[y])+u(z[y+1]))){B[y]=0;break}if(y===w-2)A=4;else{for(x=w-1;x>=y&&x!==y;x--)if(b=(x===w?0:u(B[x]))+(x===y+1?0:u(B[x-1])),u(z[x])<=Y*b){z[x]=0;break}x===y?A=3:x===w-1?A=1:(A=2,y=x)}switch(y++,A){case 1:for(_=B[w-2],B[w-2]=0,g=w-2;g>=y;g--)if(b=a(z[g],_),E=z[g]/b,S=_/b,z[g]=b,g!==y&&(_=-S*B[g-1],B[g-1]=E*B[g-1]),h)for(m=0;m<o;m++)b=E*V[m][g]+S*V[m][w-1],V[m][w-1]=-S*V[m][g]+E*V[m][w-1],V[m][g]=b;break;case 2:for(_=B[y-1],B[y-1]=0,g=y;g<w;g++)if(b=a(z[g],_),E=z[g]/b,S=_/b,z[g]=b,_=-S*B[g],B[g]=E*B[g],l)for(m=0;m<n;m++)b=E*U[m][g]+S*U[m][y-1],U[m][y-1]=-S*U[m][g]+E*U[m][y-1],U[m][g]=b;break;case 3:for(k=M(M(M(M(u(z[w-1]),u(z[w-2])),u(B[w-2])),u(z[y])),u(B[y])),O=z[y]/k,P=B[y]/k,N=(C=z[w-1]/k)*(L=B[w-2]/k)*(C*L),F=0,(0!=(I=(((D=z[w-2]/k)+C)*(D-C)+L*L)/2)||0!==N)&&(F=R(I*I+N),0>I&&(F=-F),F=N/(I+F)),_=(O+C)*(O-C)+F,j=O*P,g=y;g<w-1;g++){if(E=_/(b=a(_,j)),S=j/b,g!==y&&(B[g-1]=b),_=E*z[g]+S*B[g],B[g]=E*B[g]-S*z[g],j=S*z[g+1],z[g+1]=E*z[g+1],h)for(m=0;m<o;m++)b=E*V[m][g]+S*V[m][g+1],V[m][g+1]=-S*V[m][g]+E*V[m][g+1],V[m][g]=b;if(E=_/(b=a(_,j)),S=j/b,z[g]=b,_=E*B[g]+S*z[g+1],z[g+1]=-S*B[g]+E*z[g+1],j=S*B[g+1],B[g+1]=E*B[g+1],l&&g<n-1)for(m=0;m<n;m++)b=E*U[m][g]+S*U[m][g+1],U[m][g+1]=-S*U[m][g]+E*U[m][g+1],U[m][g]=b}B[w-2]=_;break;case 4:if(0>=z[y]&&(z[y]=0>z[y]?-z[y]:0,h))for(m=0;m<=W;m++)V[m][y]=-V[m][y];for(;y<W&&!(z[y]>=z[y+1]);){if(b=z[y],z[y]=z[y+1],z[y+1]=b,h&&y<o-1)for(m=0;m<o;m++)b=V[m][y+1],V[m][y+1]=V[m][y],V[m][y]=b;if(l&&y<n-1)for(m=0;m<n;m++)b=U[m][y+1],U[m][y+1]=U[m][y],U[m][y]=b;y++}w--}}if(d){var X=V;V=U,U=X}this.m=n,this.n=o,this.s=z,this.U=U,this.V=V}var i=n(11),o=n(46),a=o.hypotenuse,s=o.getFilled2DArray;r.prototype={get condition(){return this.s[0]/this.s[v(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var t=M(this.m,this.n)*this.s[0]*2.220446049250313e-16,e=0,n=this.s,r=0,i=n.length;r<i;r++)n[r]>t&&e++;return e},get diagonal(){return this.s},get threshold(){return 1.1102230246251565e-16*M(this.m,this.n)*this.s[0]},get leftSingularVectors(){return i.Matrix.isMatrix(this.U)||(this.U=new i.Matrix(this.U)),this.U},get rightSingularVectors(){return i.Matrix.isMatrix(this.V)||(this.V=new i.Matrix(this.V)),this.V},get diagonalMatrix(){return i.Matrix.diag(this.s)},solve:function(t){var e,n=this.threshold,r=this.s.length,o=i.Matrix.zeros(r,r);for(e=0;e<r;e++)o[e][e]=u(this.s[e])<=n?0:1/this.s[e];var a,s,c,l=this.U,h=this.rightSingularVectors,f=h.mmul(o),d=h.rows,p=l.length,m=i.Matrix.zeros(d,p);for(e=0;e<d;e++)for(a=0;a<p;a++){for(c=0,s=0;s<r;s++)c+=f[e][s]*l[a][s];m[e][a]=c}return m.mmul(t)},solveForDiagonal:function(t){return this.solve(i.Matrix.diag(t))},inverse:function(){var t,e,n=this.V,r=this.threshold,o=n.length,a=n[0].length,s=new i.Matrix(o,this.s.length);for(t=0;t<o;t++)for(e=0;e<a;e++)s[t][e]=u(this.s[e])>r?n[t][e]/this.s[e]:0;var c,l,h=this.U,f=h.length,d=h[0].length,p=new i.Matrix(o,f);for(t=0;t<o;t++)for(e=0;e<f;e++){for(l=0,c=0;c<d;c++)l+=s[t][c]*h[e][c];p[t][e]=l}return p}},t.exports=r},function(t,e,n){"use strict";var r=n(305);e.updateClusterID=function(t,e,n,i){for(var o=0;o<t.length;o++)n[o]=r(e,t[o],{distanceFunction:i});return n},e.updateCenters=function(t,e,n){for(var r=t[0].length,i=Array(n),o=Array(n),a=0;a<n;a++){i[a]=Array(r),o[a]=0;for(var s=0;s<r;s++)i[a][s]=0}for(var u=0;u<t.length;u++){o[e[u]]++;for(var c=0;c<r;c++)i[e[u]][c]+=t[u][c]}for(var l=0;l<n;l++)for(var h=0;h<r;h++)i[l][h]/=o[l];return i},e.calculateDistanceMatrix=function(t,e){for(var n=Array(t.length),r=0;r<t.length;++r)for(var i=r;i<t.length;++i){n[r]||(n[r]=Array(t.length)),n[i]||(n[i]=Array(t.length));var o=e(t[r],t[i]);n[r][i]=o,n[i][r]=o}return n},e.converged=function(t,e,n,r){for(var i=0;i<t.length;i++)if(n(t[i],e[i])>r)return!1;return!0}},function(t,e,n){"use strict";function r(t){i.call(this),this.index=t,this.distance=0,this.children=[]}var i=n(48);n(313).inherits(r,i),t.exports=r},function(t){"use strict";function e(t,e,n,r){this.x=t,this.y=e,this.weights=n,this.som=r,this.neighbors={}}e.prototype.adjustWeights=function(t,e,n){for(var r=0,i=this.weights.length;r<i;r++)this.weights[r]+=e*n*(t[r]-this.weights[r])},e.prototype.getDistance=function(t){return M(u(this.x-t.x),u(this.y-t.y))},e.prototype.getDistanceTorus=function(t){var e=u(this.x-t.x),n=u(this.y-t.y);return M(v(e,this.som.gridDim.x-e),v(n,this.som.gridDim.y-n))},e.prototype.getNeighbors=function(t){var e,n,r,i;return this.neighbors[t]||(this.neighbors[t]=[,,],0<this[t]?e=this[t]-1:this.som.torus&&(e=this.som.gridDim[t]-1),"undefined"!=typeof e&&("x"===t?(n=e,r=this.y):(n=this.x,r=e),this.neighbors[t][0]=this.som.nodes[n][r]),this[t]<this.som.gridDim[t]-1?i=this[t]+1:this.som.torus&&(i=0),"undefined"!=typeof i&&("x"===t?(n=i,r=this.y):(n=this.x,r=i),this.neighbors[t][1]=this.som.nodes[n][r])),this.neighbors[t]},e.prototype.getPos=function(t,e){var n,r,i=this.getNeighbors(t),o=this.som.distance;i[0]?i[1]?o(e,i[0].weights)<o(e,i[1].weights)?(n=i[0],r=-1):(n=i[1],r=1):(n=i[0],r=-1):(n=i[1],r=1);var a=1-o(e,this.weights),s=1-o(e,n.weights);return.5+(a-s)/(2-a-s)*.5*r},e.prototype.getPosition=function(t){return[this.getPos("x",t),this.getPos("y",t)]},t.exports=e},function(e,t,i){"use strict";function n(e){function t(t,e){if(t.rows!==e.rows||t.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal")}function n(t,e){return t-e}function x(t,e){for(var n in e)t=t.replace(new RegExp("%"+n+"%","g"),e[n]);return t}void 0===e&&(e=Object);class w extends e{static get[Symbol.species](){return this}static from1DArray(t,e,n){if(t*e!==n.length)throw new RangeError("Data length does not match given dimensions");for(var r=new this(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)r.set(i,o,n[i*e+o]);return r}static rowVector(t){for(var e=new this(1,t.length),n=0;n<t.length;n++)e.set(0,n,t[n]);return e}static columnVector(t){for(var e=new this(t.length,1),n=0;n<t.length;n++)e.set(n,0,t[n]);return e}static empty(t,e){return new this(t,e)}static zeros(t,e){return this.empty(t,e).fill(0)}static ones(t,e){return this.empty(t,e).fill(1)}static rand(t,e,n){void 0===n&&(n=Math.random);for(var r=this.empty(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)r.set(i,o,n());return r}static randInt(t,e,n,r){void 0===n&&(n=1e3),void 0===r&&(r=Math.random);for(var i=this.empty(t,e),o=0;o<t;o++)for(var a,s=0;s<e;s++)a=g(r()*n),i.set(o,s,a);return i}static eye(t,e,n){void 0===e&&(e=t),void 0===n&&(n=1);for(var r=v(t,e),i=this.zeros(t,e),o=0;o<r;o++)i.set(o,o,n);return i}static diag(t,e,n){var r=t.length;void 0===e&&(e=r),void 0===n&&(n=e);for(var i=v(r,e,n),o=this.zeros(e,n),a=0;a<i;a++)o.set(a,a,t[a]);return o}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),o=0;o<n;o++)for(var a=0;a<r;a++)i.set(o,a,v(t.get(o,a),e.get(o,a)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),o=0;o<n;o++)for(var a=0;a<r;a++)i.set(o,a,M(t.get(o,a),e.get(o,a)));return i}static checkMatrix(t){return w.isMatrix(t)?t:new this(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=this.rows,n=this.columns,r=0;r<e;r++)for(var i=0;i<n;i++)t.call(this,r,i);return this}to1DArray(){for(var t=Array(this.size),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t[e*this.columns+n]=this.get(e,n);return t}to2DArray(){for(var t=Array(this.rows),e=0;e<this.rows;e++){t[e]=Array(this.columns);for(var n=0;n<this.columns;n++)t[e][n]=this.get(e,n)}return t}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t,e){t=t||1,e=e||1;for(var n=new this.constructor[Symbol.species](this.rows*t,this.columns*e),r=0;r<t;r++)for(var i=0;i<e;i++)n.setSubMatrix(this,this.rows*r,this.columns*i);return n}fill(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,t);return this}neg(){return this.mulS(-1)}getRow(t){l.checkRowIndex(this,t);for(var e=Array(this.columns),n=0;n<this.columns;n++)e[n]=this.get(t,n);return e}getRowVector(t){return this.constructor.rowVector(this.getRow(t))}setRow(t,e){l.checkRowIndex(this,t),e=l.checkRowVector(this,e);for(var n=0;n<this.columns;n++)this.set(t,n,e[n]);return this}swapRows(t,e){l.checkRowIndex(this,t),l.checkRowIndex(this,e);for(var n,r=0;r<this.columns;r++)n=this.get(t,r),this.set(t,r,this.get(e,r)),this.set(e,r,n);return this}getColumn(t){l.checkColumnIndex(this,t);for(var e=Array(this.rows),n=0;n<this.rows;n++)e[n]=this.get(n,t);return e}getColumnVector(t){return this.constructor.columnVector(this.getColumn(t))}setColumn(t,e){l.checkColumnIndex(this,t),e=l.checkColumnVector(this,e);for(var n=0;n<this.rows;n++)this.set(n,t,e[n]);return this}swapColumns(t,e){l.checkColumnIndex(this,t),l.checkColumnIndex(this,e);for(var n,r=0;r<this.rows;r++)n=this.get(r,t),this.set(r,t,this.get(r,e)),this.set(r,e,n);return this}addRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[n]);return this}subRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[n]);return this}mulRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[n]);return this}divRowVector(t){t=l.checkRowVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[n]);return this}addColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[e]);return this}subColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[e]);return this}mulColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[e]);return this}divColumnVector(t){t=l.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[e]);return this}mulRow(t,e){l.checkRowIndex(this,t);for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this}mulColumn(t,e){l.checkColumnIndex(this,t);for(var n=0;n<this.rows;n++)this.set(n,t,this.get(n,t)*e);return this}max(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)>t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}min(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)<t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}maxRow(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxRowIndex(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r),n[1]=r);return n}minRow(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minRowIndex(t){l.checkRowIndex(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r),n[1]=r);return n}maxColumn(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t));return e}maxColumnIndex(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t),n[0]=r);return n}minColumn(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t));return e}minColumnIndex(t){l.checkColumnIndex(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t),n[0]=r);return n}diag(){for(var t=v(this.rows,this.columns),e=Array(t),n=0;n<t;n++)e[n]=this.get(n,n);return e}sum(t){return"row"===t?l.sumByRow(this):"column"===t?l.sumByColumn(this):l.sumAll(this)}mean(){return this.sum()/this.size}prod(){for(var t=1,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t*=this.get(e,n);return t}cumulativeSum(){for(var t=0,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t+=this.get(e,n),this.set(e,n,t);return this}dot(t){w.isMatrix(t)&&(t=t.to1DArray());var e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n}mmul(t){t=this.constructor.checkMatrix(t),this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var e=this.rows,n=this.columns,r=t.columns,i=new this.constructor[Symbol.species](e,r),o=Array(n),a=0;a<r;a++){for(var s=0;s<n;s++)o[s]=t.get(s,a);for(var u,c=0;c<e;c++){for(u=0,s=0;s<n;s++)u+=this.get(c,s)*o[s];i.set(c,a,u)}}return i}strassen2x2(t){var e=new this.constructor[Symbol.species](2,2),n=this.get(0,0),r=t.get(0,0),i=this.get(0,1),o=t.get(0,1),a=this.get(1,0),s=t.get(1,0),u=this.get(1,1),c=t.get(1,1),l=(n+u)*(r+c),h=(a+u)*r,f=n*(o-c),d=u*(s-r),p=(n+i)*c;return e.set(0,0,l+d-p+(i-u)*(s+c)),e.set(0,1,f+p),e.set(1,0,h+d),e.set(1,1,l-h+f+(a-n)*(r+o)),e}strassen3x3(t){var e=new this.constructor[Symbol.species](3,3),n=this.get(0,0),r=this.get(0,1),i=this.get(0,2),o=this.get(1,0),a=this.get(1,1),s=this.get(1,2),u=this.get(2,0),c=this.get(2,1),l=this.get(2,2),h=t.get(0,0),f=t.get(0,1),d=t.get(0,2),p=t.get(1,0),m=t.get(1,1),g=t.get(1,2),v=t.get(2,0),y=t.get(2,1),w=t.get(2,2),b=(n-o)*(-f+m),x=(-n+o+a)*(h-f+m),_=(o+a)*(-h+f),M=n*h,E=(-n+u+c)*(h-d+g),S=(-n+u)*(d-g),T=(u+c)*(-h+d),A=(-i+c+l)*(m+v-y),k=(i-l)*(m-y),C=i*v,R=(c+l)*(-v+y),D=(-i+a+s)*(g+v-w),L=(i-s)*(g-w),O=(a+s)*(-v+w);return e.set(0,0,M+C+r*p),e.set(0,1,(n+r+i-o-a-c-l)*m+x+_+M+A+C+R),e.set(0,2,M+E+T+(n+r+i-a-s-u-c)*g+C+D+O),e.set(1,0,b+a*(-h+f+p-m-g-v+w)+x+M+C+D+L),e.set(1,1,b+x+_+M+s*y),e.set(1,2,C+D+L+O+o*d),e.set(2,0,M+E+S+c*(-h+d+p-m-g-v+y)+A+k+C),e.set(2,1,A+k+C+R+u*f),e.set(2,2,M+E+S+T+l*w),e}mmulStrassen(t){function e(t,e,n){return t.rows===e&&t.columns===n?t:w.zeros(e,n).setSubMatrix(t,0,0)}var n=this.clone(),r=n.rows,i=n.columns,o=t.rows,a=t.columns;i!==o&&console.warn(`Multiplying ${r} x ${i} and ${o} x ${a} matrix: dimensions do not match.`);var s=M(r,o),u=M(i,a);return function t(n,r,i,o){if(512>=i||512>=o)return n.mmul(r);1==i%2&&1==o%2?(n=e(n,i+1,o+1),r=e(r,i+1,o+1)):1==i%2?(n=e(n,i+1,o),r=e(r,i+1,o)):1==o%2&&(n=e(n,i,o+1),r=e(r,i,o+1));var a=parseInt(n.rows/2),s=parseInt(n.columns/2),u=n.subMatrix(0,a-1,0,s-1),c=r.subMatrix(0,a-1,0,s-1),l=n.subMatrix(0,a-1,s,n.columns-1),h=r.subMatrix(0,a-1,s,r.columns-1),f=n.subMatrix(a,n.rows-1,0,s-1),d=r.subMatrix(a,r.rows-1,0,s-1),p=n.subMatrix(a,n.rows-1,s,n.columns-1),m=r.subMatrix(a,r.rows-1,s,r.columns-1),g=t(w.add(u,p),w.add(c,m),a,s),v=t(w.add(f,p),c,a,s),y=t(u,w.sub(h,m),a,s),b=t(p,w.sub(d,c),a,s),x=t(w.add(u,l),m,a,s),_=t(w.sub(f,u),w.add(c,h),a,s),M=t(w.sub(l,p),w.add(d,m),a,s),E=w.add(g,b);E.sub(x),E.add(M);var S=w.add(y,x),T=w.add(v,b),A=w.sub(g,v);A.add(y),A.add(_);var k=w.zeros(2*E.rows,2*E.columns);return(k=(k=(k=(k=k.setSubMatrix(E,0,0)).setSubMatrix(S,E.rows,0)).setSubMatrix(T,0,E.columns)).setSubMatrix(A,E.rows,E.columns)).subMatrix(0,i-1,0,o-1)}(n=e(n,s,u),t=e(t,s,u),s,u)}scaleRows(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n,r=this.constructor.empty(this.rows,this.columns),i=0;i<this.rows;i++)n=s.scale(this.getRow(i),{min:t,max:e}),r.setRow(i,n);return r}scaleColumns(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n,r=this.constructor.empty(this.rows,this.columns),i=0;i<this.columns;i++)n=s.scale(this.getColumn(i),{min:t,max:e}),r.setColumn(i,n);return r}kroneckerProduct(t){t=this.constructor.checkMatrix(t);for(var e=this.rows,n=this.columns,r=t.rows,i=t.columns,o=new this.constructor[Symbol.species](e*r,n*i),a=0;a<e;a++)for(var s=0;s<n;s++)for(var u=0;u<r;u++)for(var c=0;c<i;c++)o[r*a+u][i*s+c]=this.get(a,s)*t.get(u,c);return o}transpose(){for(var t=new this.constructor[Symbol.species](this.columns,this.rows),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(n,e,this.get(e,n));return t}sortRows(t){void 0===t&&(t=n);for(var e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t){void 0===t&&(t=n);for(var e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,n,r){l.checkRange(this,t,e,n,r);for(var i=new this.constructor[Symbol.species](e-t+1,r-n+1),o=t;o<=e;o++)for(var a=n;a<=r;a++)i[o-t][a-n]=this.get(o,a);return i}subMatrixRow(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.columns-1),e>n||0>e||e>=this.columns||0>n||n>=this.columns)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](t.length,n-e+1),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(0>t[i]||t[i]>=this.rows)throw new RangeError("Row index out of range: "+t[i]);r.set(i,o-e,this.get(t[i],o))}return r}subMatrixColumn(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.rows-1),e>n||0>e||e>=this.rows||0>n||n>=this.rows)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](n-e+1,t.length),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(0>t[i]||t[i]>=this.columns)throw new RangeError("Column index out of range: "+t[i]);r.set(o-e,i,this.get(o,t[i]))}return r}setSubMatrix(t,e,n){t=this.constructor.checkMatrix(t),l.checkRange(this,e,e+t.rows-1,n,n+t.columns-1);for(var r=0;r<t.rows;r++)for(var i=0;i<t.columns;i++)this[e+r][n+i]=t.get(r,i);return this}selection(t,e){for(var n,r=l.checkIndices(this,t,e),i=new this.constructor[Symbol.species](t.length,e.length),o=0;o<r.row.length;o++){n=r.row[o];for(var a=0;a<r.column.length;a++)i[o][a]=this.get(n,r.column[a])}return i}trace(){for(var t=v(this.rows,this.columns),e=0,n=0;n<t;n++)e+=this.get(n,n);return e}transposeView(){return new c(this)}rowView(t){return l.checkRowIndex(this,t),new m(this,t)}columnView(t){return l.checkColumnIndex(this,t),new p(this,t)}flipRowView(){return new k(this)}flipColumnView(){return new j(this)}subMatrixView(t,e,n,r){return new d(this,t,e,n,r)}selectionView(t,e){return new h(this,t,e)}det(){var t,e,n,r,i,a;if(this.isSquare())return 2===this.columns?(t=this.get(0,0),e=this.get(0,1),n=this.get(1,0),t*this.get(1,1)-e*n):3===this.columns?(r=this.selectionView([1,2],[1,2]),i=this.selectionView([1,2],[0,2]),a=this.selectionView([1,2],[0,1]),t=this.get(0,0),e=this.get(0,1),n=this.get(0,2),t*r.det()-e*i.det()+n*a.det()):new o(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(t){void 0===t&&(t=a);for(var e=new r(this,{autoTranspose:!0}),n=e.leftSingularVectors,i=e.rightSingularVectors,o=e.diagonal,s=0;s<o.length;s++)o[s]=u(o[s])>t?1/o[s]:0;return o=this.constructor[Symbol.species].diag(o),i.mmul(o.mmul(n.transposeView()))}}w.prototype.klass="Matrix",w.random=w.rand,w.diagonal=w.diag,w.prototype.diagonal=w.prototype.diag,w.identity=w.eye,w.prototype.negate=w.prototype.neg,w.prototype.tensorProduct=w.prototype.kroneckerProduct,w.prototype.determinant=w.prototype.det;var f="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",y="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",b="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",R="\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",I="\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",S="\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",C="\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",V="\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",D="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",z="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",_="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",P=V,A=[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]],L=!0,U=!1,F,i;try{for(var T=A[Symbol.iterator](),q;!(L=(q=T.next()).done);L=!0){var N=q.value,O=eval(x(f,{name:N[1],op:N[0]})),E=eval(x(y,{name:N[1]+"S",op:N[0]})),B=eval(x(b,{name:N[1]+"M",op:N[0]})),Q=eval(x(R,{name:N[1]}));for(F=1;F<N.length;F++)w.prototype[N[F]]=O,w.prototype[N[F]+"S"]=E,w.prototype[N[F]+"M"]=B,w[N[F]]=Q}}catch(e){U=!0,i=e}finally{try{!L&&T.return&&T.return()}finally{if(U)throw i}}var W=[["~","not"]];["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(t){W.push(["Math."+t,t])});var X=!0,J=!1,Y;try{for(var H=W[Symbol.iterator](),K;!(X=(K=H.next()).done);X=!0){var G=K.value,Z=eval(x(I,{name:G[1],method:G[0]})),$=eval(x(S,{name:G[1]}));for(F=1;F<G.length;F++)w.prototype[G[F]]=Z,w[G[F]]=$}}catch(e){J=!0,Y=e}finally{try{!X&&H.return&&H.return()}finally{if(J)throw Y}}var ee=[["Math.pow",1,"pow"]],te=!0,ie=!1,ne;try{for(var oe=ee[Symbol.iterator](),se;!(te=(se=oe.next()).done);te=!0){var re=se.value,ae="arg0";for(F=1;F<re[1];F++)ae+=`, arg${F}`;if(1!==re[1]){var le=eval(x(C,{name:re[2],method:re[0],args:ae})),ce=eval(x(V,{name:re[2],args:ae}));for(F=2;F<re.length;F++)w.prototype[re[F]]=le,w[re[F]]=ce}else{var ue={name:re[2],args:ae,method:re[0]},me=eval(x(_,ue)),de=eval(x(D,ue)),ge=eval(x(z,ue)),he=eval(x(P,ue));for(F=2;F<re.length;F++)w.prototype[re[F]]=me,w.prototype[re[F]+"M"]=ge,w.prototype[re[F]+"S"]=de,w[re[F]]=he}}}catch(e){ie=!0,ne=e}finally{try{!te&&oe.return&&oe.return()}finally{if(ie)throw ne}}return w}e.exports=n;var o=i(98),r=i(99),s=i(1),l=i(31),c=i(323),m=i(324),d=i(325),h=i(326),p=i(327),k=i(328),j=i(329)},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);var e,n,o,a,s,c,l,h,f,d,p=(t=i.Matrix.checkMatrix(t)).clone(),m=p.rows,g=p.columns,y=Array(m),w=1;for(e=0;e<m;e++)y[e]=e;for(f=Array(m),n=0;n<g;n++){for(e=0;e<m;e++)f[e]=p[e][n];for(e=0;e<m;e++){for(h=p[e],d=v(e,n),s=0,o=0;o<d;o++)s+=h[o]*f[o];h[n]=f[e]-=s}for(a=n,e=n+1;e<m;e++)u(f[e])>u(f[a])&&(a=e);if(a!==n){for(o=0;o<g;o++)c=p[a][o],p[a][o]=p[n][o],p[n][o]=c;l=y[a],y[a]=y[n],y[n]=l,w=-w}if(n<m&&0!==p[n][n])for(e=n+1;e<m;e++)p[e][n]/=p[n][n]}this.LU=p,this.pivotVector=y,this.pivotSign=w}var i=n(12);r.prototype={isSingular:function(){for(var t=this.LU,e=t.columns,n=0;n<e;n++)if(0===t[n][n])return!0;return!1},get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var e=this.pivotSign,n=t.columns,r=0;r<n;r++)e*=t[r][r];return e},get lowerTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new i.Matrix(e,n),o=0;o<e;o++)for(var a=0;a<n;a++)r[o][a]=o>a?t[o][a]:o===a?1:0;return r},get upperTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new i.Matrix(e,n),o=0;o<e;o++)for(var a=0;a<n;a++)r[o][a]=o<=a?t[o][a]:0;return r},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(t){t=i.Matrix.checkMatrix(t);var e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var n,r,o,a=t.columns,s=t.subMatrixRow(this.pivotVector,0,a-1),u=e.columns;for(o=0;o<u;o++)for(n=o+1;n<u;n++)for(r=0;r<a;r++)s[n][r]-=s[o][r]*e[n][o];for(o=u-1;0<=o;o--){for(r=0;r<a;r++)s[o][r]/=e[o][o];for(n=0;n<o;n++)for(r=0;r<a;r++)s[n][r]-=s[o][r]*e[n][o]}return s}},t.exports=r},function(t,e,n){"use strict";function r(t,e){if(!(this instanceof r))return new r(t,e);t=i.Matrix.checkMatrix(t),e=e||{};var n=t.rows,o=t.columns,c=v(n,o),l=!0,h=!0;!1===e.computeLeftSingularVectors&&(l=!1),!1===e.computeRightSingularVectors&&(h=!1);var f,d=!1;if(n<o)if(!0===e.autoTranspose){n=(f=t.transpose()).rows,o=f.columns,d=!0;var p=l;l=h,h=p}else f=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else f=t.clone();var m,g,y,w,b,x,_,E,S,T,A,k,C,D,L,O,P,I,N,F,j,z=Array(v(n+1,o)),U=s(n,c,0),V=s(o,o,0),B=Array(o),H=Array(n),q=v(n-1,o),G=M(0,v(o-2,n));for(y=0,T=M(q,G);y<T;y++){if(y<q){for(z[y]=0,m=y;m<n;m++)z[y]=a(z[y],f[m][y]);if(0!==z[y]){for(0>f[y][y]&&(z[y]=-z[y]),m=y;m<n;m++)f[m][y]/=z[y];f[y][y]+=1}z[y]=-z[y]}for(g=y+1;g<o;g++){if(y<q&&0!==z[y]){for(b=0,m=y;m<n;m++)b+=f[m][y]*f[m][g];for(b=-b/f[y][y],m=y;m<n;m++)f[m][g]+=b*f[m][y]}B[g]=f[y][g]}if(l&&y<q)for(m=y;m<n;m++)U[m][y]=f[m][y];if(y<G){for(B[y]=0,m=y+1;m<o;m++)B[y]=a(B[y],B[m]);if(0!==B[y]){for(0>B[y+1]&&(B[y]=0-B[y]),m=y+1;m<o;m++)B[m]/=B[y];B[y+1]+=1}if(B[y]=-B[y],y+1<n&&0!==B[y]){for(m=y+1;m<n;m++)H[m]=0;for(g=y+1;g<o;g++)for(m=y+1;m<n;m++)H[m]+=B[g]*f[m][g];for(g=y+1;g<o;g++)for(b=-B[g]/B[y+1],m=y+1;m<n;m++)f[m][g]+=b*H[m]}if(h)for(m=y+1;m<o;m++)V[m][y]=B[m]}}if(w=v(o,n+1),q<o&&(z[q]=f[q][q]),n<w&&(z[w-1]=0),G+1<w&&(B[G]=f[G][w-1]),B[w-1]=0,l){for(g=q;g<c;g++){for(m=0;m<n;m++)U[m][g]=0;U[g][g]=1}for(y=q-1;0<=y;y--)if(0!==z[y]){for(g=y+1;g<c;g++){for(b=0,m=y;m<n;m++)b+=U[m][y]*U[m][g];for(b=-b/U[y][y],m=y;m<n;m++)U[m][g]+=b*U[m][y]}for(m=y;m<n;m++)U[m][y]=-U[m][y];for(U[y][y]=1+U[y][y],m=0;m<y-1;m++)U[m][y]=0}else{for(m=0;m<n;m++)U[m][y]=0;U[y][y]=1}}if(h)for(y=o-1;0<=y;y--){if(y<G&&0!==B[y])for(g=y+1;g<o;g++){for(b=0,m=y+1;m<o;m++)b+=V[m][y]*V[m][g];for(b=-b/V[y+1][y],m=y+1;m<o;m++)V[m][g]+=b*V[m][y]}for(m=0;m<o;m++)V[m][y]=0;V[y][y]=1}for(var W=w-1,Y=2.220446049250313e-16;0<w;){for(y=w-2;-1<=y&&-1!==y;y--)if(u(B[y])<=Y*(u(z[y])+u(z[y+1]))){B[y]=0;break}if(y===w-2)A=4;else{for(x=w-1;x>=y&&x!==y;x--)if(b=(x===w?0:u(B[x]))+(x===y+1?0:u(B[x-1])),u(z[x])<=Y*b){z[x]=0;break}x===y?A=3:x===w-1?A=1:(A=2,y=x)}switch(y++,A){case 1:for(_=B[w-2],B[w-2]=0,g=w-2;g>=y;g--)if(b=a(z[g],_),E=z[g]/b,S=_/b,z[g]=b,g!==y&&(_=-S*B[g-1],B[g-1]=E*B[g-1]),h)for(m=0;m<o;m++)b=E*V[m][g]+S*V[m][w-1],V[m][w-1]=-S*V[m][g]+E*V[m][w-1],V[m][g]=b;break;case 2:for(_=B[y-1],B[y-1]=0,g=y;g<w;g++)if(b=a(z[g],_),E=z[g]/b,S=_/b,z[g]=b,_=-S*B[g],B[g]=E*B[g],l)for(m=0;m<n;m++)b=E*U[m][g]+S*U[m][y-1],U[m][y-1]=-S*U[m][g]+E*U[m][y-1],U[m][g]=b;break;case 3:for(k=M(M(M(M(u(z[w-1]),u(z[w-2])),u(B[w-2])),u(z[y])),u(B[y])),O=z[y]/k,P=B[y]/k,N=(C=z[w-1]/k)*(L=B[w-2]/k)*(C*L),F=0,(0!=(I=(((D=z[w-2]/k)+C)*(D-C)+L*L)/2)||0!==N)&&(F=R(I*I+N),0>I&&(F=-F),F=N/(I+F)),_=(O+C)*(O-C)+F,j=O*P,g=y;g<w-1;g++){if(E=_/(b=a(_,j)),S=j/b,g!==y&&(B[g-1]=b),_=E*z[g]+S*B[g],B[g]=E*B[g]-S*z[g],j=S*z[g+1],z[g+1]=E*z[g+1],h)for(m=0;m<o;m++)b=E*V[m][g]+S*V[m][g+1],V[m][g+1]=-S*V[m][g]+E*V[m][g+1],V[m][g]=b;if(E=_/(b=a(_,j)),S=j/b,z[g]=b,_=E*B[g]+S*z[g+1],z[g+1]=-S*B[g]+E*z[g+1],j=S*B[g+1],B[g+1]=E*B[g+1],l&&g<n-1)for(m=0;m<n;m++)b=E*U[m][g]+S*U[m][g+1],U[m][g+1]=-S*U[m][g]+E*U[m][g+1],U[m][g]=b}B[w-2]=_;break;case 4:if(0>=z[y]&&(z[y]=0>z[y]?-z[y]:0,h))for(m=0;m<=W;m++)V[m][y]=-V[m][y];for(;y<W&&!(z[y]>=z[y+1]);){if(b=z[y],z[y]=z[y+1],z[y+1]=b,h&&y<o-1)for(m=0;m<o;m++)b=V[m][y+1],V[m][y+1]=V[m][y],V[m][y]=b;if(l&&y<n-1)for(m=0;m<n;m++)b=U[m][y+1],U[m][y+1]=U[m][y],U[m][y]=b;y++}w--}}if(d){var X=V;V=U,U=X}this.m=n,this.n=o,this.s=z,this.U=U,this.V=V}var i=n(12),o=n(50),a=o.hypotenuse,s=o.getFilled2DArray;r.prototype={get condition(){return this.s[0]/this.s[v(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var t=M(this.m,this.n)*this.s[0]*2.220446049250313e-16,e=0,n=this.s,r=0,i=n.length;r<i;r++)n[r]>t&&e++;return e},get diagonal(){return this.s},get threshold(){return 1.1102230246251565e-16*M(this.m,this.n)*this.s[0]},get leftSingularVectors(){return i.Matrix.isMatrix(this.U)||(this.U=new i.Matrix(this.U)),this.U},get rightSingularVectors(){return i.Matrix.isMatrix(this.V)||(this.V=new i.Matrix(this.V)),this.V},get diagonalMatrix(){return i.Matrix.diag(this.s)},solve:function(t){var e,n=this.threshold,r=this.s.length,o=i.Matrix.zeros(r,r);for(e=0;e<r;e++)o[e][e]=u(this.s[e])<=n?0:1/this.s[e];var a,s,c,l=this.U,h=this.rightSingularVectors,f=h.mmul(o),d=h.rows,p=l.length,m=i.Matrix.zeros(d,p);for(e=0;e<d;e++)for(a=0;a<p;a++){for(c=0,s=0;s<r;s++)c+=f[e][s]*l[a][s];m[e][a]=c}return m.mmul(t)},solveForDiagonal:function(t){return this.solve(i.Matrix.diag(t))},inverse:function(){var t,e,n=this.V,r=this.threshold,o=n.length,a=n[0].length,s=new i.Matrix(o,this.s.length);for(t=0;t<o;t++)for(e=0;e<a;e++)s[t][e]=u(this.s[e])>r?n[t][e]/this.s[e]:0;var c,l,h=this.U,f=h.length,d=h[0].length,p=new i.Matrix(o,f);for(t=0;t<o;t++)for(e=0;e<f;e++){for(l=0,c=0;c<d;c++)l+=s[t][c]*h[e][c];p[t][e]=l}return p}},t.exports=r},function(t,e,n){"use strict";var r=n(49),i=n(101),o=n(102);class a{constructor(t){this.inputSize=t.inputSize,this.outputSize=t.outputSize,this.regularization=t.regularization,this.epsilon=t.epsilon,this.activation=t.activation,this.activationParam=t.activationParam;var e=o[t.activation],n=e.activation.length,i=1<n?n=>e.activation(n,t.activationParam):e.activation,a=1<n?n=>e.derivate(n,t.activationParam):e.derivate;this.activationFunction=function(t,e){this[t][e]=i(this[t][e])},this.derivate=function(t,e){this[t][e]=a(this[t][e])},t.model?(this.W=r.checkMatrix(t.W),this.b=r.checkMatrix(t.b)):(this.W=r.rand(this.inputSize,this.outputSize),this.b=r.zeros(1,this.outputSize),this.W.apply(function(e,n){this[e][n]/=R(t.inputSize)}))}forward(t){var e=t.mmul(this.W).addRowVector(this.b);return e.apply(this.activationFunction),this.a=e.clone(),e}backpropagation(t,e){this.dW=e.transposeView().mmul(t),this.db=i.sumCol(t);var n=e.clone();return t.mmul(this.W.transposeView()).mul(n.apply(this.derivate))}update(){this.dW.add(this.W.clone().mul(this.regularization)),this.W.add(this.dW.mul(-this.epsilon)),this.b.add(this.db.mul(-this.epsilon))}toJSON(){return{model:"Layer",inputSize:this.inputSize,outputSize:this.outputSize,regularization:this.regularization,epsilon:this.epsilon,activation:this.activation,W:this.W,b:this.b}}static load(t){if("Layer"!==t.model)throw new RangeError("the current model is not a Layer model");return new a(t)}}t.exports=a},function(t,e,n){"use strict";var r=n(49);t.exports={dictOutputs:function(t){for(var e={},n={},r=t.length,i=0,o=0;o<r;o+=1)void 0===e[t[o]]&&(e[t[o]]=i,n[i]=t[o],i++);return{inputs:e,outputs:n}},sumCol:function(t){for(var e=r.zeros(1,t.columns),n=0;n<t.rows;++n)for(var i=0;i<t.columns;++i)e[0][i]+=t[n][i];return e},sumRow:function(t){for(var e=r.zeros(t.rows,1),n=0;n<t.rows;++n)for(var i=0;i<t.columns;++i)e[n][0]+=t[n][i];return e}}},function(t){"use strict";function e(t){return 1/(1+o(-t))}function i(t,e){return 0>t?e*(o(t)-1):t}var a=Math.cos,s=Math.sin,c={tanh:{activation:n,derivate:t=>1-t*t},identity:{activation:t=>t,derivate:()=>1},logistic:{activation:e,derivate:t=>e(t)*(1-e(t))},arctan:{activation:Math.atan,derivate:t=>1/(t*t+1)},softsign:{activation:t=>t/(1+u(t)),derivate:t=>1/((1+u(t))*(1+u(t)))},relu:{activation:t=>0>t?0:t,derivate:t=>0>t?0:1},softplus:{activation:t=>r(1+o(t)),derivate:t=>1/(1+o(-t))},bent:{activation:t=>(R(t*t+1)-1)/2+t,derivate:t=>t/(2*R(t*t+1))+1},sinusoid:{activation:s,derivate:a},sinc:{activation:t=>0===t?1:s(t)/t,derivate:t=>0===t?0:a(t)/t-s(t)/(t*t)},gaussian:{activation:t=>o(-t*t),derivate:t=>-2*t*o(-t*t)},"parametric-relu":{activation:(t,e)=>0>t?e*t:t,derivate:(t,e)=>0>t?e:1},"exponential-elu":{activation:i,derivate:(t,e)=>0>t?i(t,e)+e:1},"soft-exponential":{activation:function(t,e){return 0>e?-r(1-e*(t+e))/e:0<e?(o(e*t)-1)/e+e:t},derivate:function(t,e){return 0>e?1/(1-e*(e+t)):o(e*t)}}};t.exports=c},function(t,e,n){"use strict";var r=n(13);e.ArrayUtils=e.AU=n(1),e.BitArray=n(119),e.HashTable=n(54),e.Matrix=r.default,e.PadArray=n(57),e.Regression=n(124),e.binarySearch=n(55),e.numSort=n(56);var i=e.Math={},o=n(145);i.Distance=o.distance,i.Similarity=o.similarity,i.DistanceMatrix=n(68),i.SG=n(191),i.SGG=n(205),i.Matrix=r,i.SparseMatrix=n(208),i.Kernel=n(37);var a=e.Stat={};a.array=n(2).array,a.matrix=n(2).matrix,a.PCA=n(209),a.Performance=n(223);var s=e.Optimization={};s.BellOptimizer=n(225),s.LevenbergMarquardt=n(253),(e.RNG={}).XSadd=n(269);var u=e.SL={};u.CV=n(270),u.CrossValidation=u.CV,u.CM=n(86),u.ConfusionMatrix=u.CM,u.SVM=n(272),u.KNN=n(273),u.NaiveBayes=n(275),u.PLS=n(289);var c=e.Clust={};c.kmeans=n(304),c.hclust=n(309);var l=e.NN=e.nn={};l.SOM=n(319),l.FNN=n(321)},function(){"use strict";Symbol.species||(Symbol.species=Symbol.for("@@species"))},function(t,e,n){"use strict";function r(t){for(var e=Array(t[0].length),n=0;n<e.length;++n)e[n]=Array(t.length);for(n=0;n<t.length;++n)for(var r=0;r<t[0].length;++r)e[r][n]=t[n][r];return e}var i=n(2).array;t.exports={coordArrayToPoints:function(t,e){if(0!=t.length%e)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var n,r=Array(t.length/e),i=0,o=0;o<t.length;o+=e){n=Array(e);for(var a=0;a<e;++a)n[a]=t[o+a];r[i]=n,i++}return r},coordArrayToCoordMatrix:function(t,e){if(0!=t.length%e)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var n=Array(e),r=t.length/e,i=0;i<n.length;i++)n[i]=Array(r);for(i=0;i<t.length;i+=e)for(var o,a=0;a<e;++a)o=g(i/e),n[a][o]=t[i+a];return n},coordMatrixToCoordArray:function(t){for(var e=Array(t.length*t[0].length),n=0,r=0;r<t[0].length;++r)for(var i=0;i<t.length;++i)e[n]=t[i][r],++n;return e},coordMatrixToPoints:r,pointsToCoordArray:function(t){for(var e=Array(t.length*t[0].length),n=0,r=0;r<t.length;++r)for(var i=0;i<t[0].length;++i)e[n]=t[r][i],++n;return e},pointsToCoordMatrix:r,applyDotProduct:function(t,e){var n,r;t.length<=e.length?(r=t,n=e):(r=e,n=t);for(var i,o=n.length-r.length+1,a=Array(o),s=0;s<o;++s){i=0;for(var u=0;u<r.length;++u)i+=r[u]*n[s+u];a[s]=i}return a},scale:function(t,e){var n=e.inPlace?t:Array(t.length),r=e.max,o=e.min;if("number"==typeof r)if("number"==typeof o)for(var a=i.minMax(t),s=(r-o)/(a.max-a.min),u=0;u<n.length;u++)n[u]=(t[u]-a.min)*s+o;else for(s=r/i.max(t),u=0;u<n.length;u++)n[u]=t[u]*s;else if("number"==typeof o)for(s=o/i.min(t),u=0;u<n.length;u++)n[u]=t[u]*s;return n}}},function(t,e,n){"use strict";function i(t,e){return t-e}var o=n(52);e.max=function(t){for(var e=-1/0,n=0;n<t.length;n++)for(var r=0;r<t[n].length;r++)t[n][r]>e&&(e=t[n][r]);return e},e.min=function(t){for(var e=1/0,n=0;n<t.length;n++)for(var r=0;r<t[n].length;r++)t[n][r]<e&&(e=t[n][r]);return e},e.minMax=function(t){for(var e=1/0,n=-1/0,r=0;r<t.length;r++)for(var i=0;i<t[r].length;i++)t[r][i]<e&&(e=t[r][i]),t[r][i]>n&&(n=t[r][i]);return{min:e,max:n}},e.entropy=function(t,e){"undefined"==typeof e&&(e=0);for(var n=0,i=t.length,o=t[0].length,a=0;a<i;a++)for(var s=0;s<o;s++)n+=t[a][s]*r(t[a][s]+e);return-n},e.mean=function(t,e){"undefined"==typeof e&&(e=0);var n,r,i,o,a=t.length,s=t[0].length;if(-1===e){for(n=[0],r=a*s,i=0;i<a;i++)for(o=0;o<s;o++)n[0]+=t[i][o];n[0]/=r}else if(0===e)for(n=Array(s),r=a,o=0;o<s;o++){for(n[o]=0,i=0;i<a;i++)n[o]+=t[i][o];n[o]/=r}else{if(1!==e)throw new Error("Invalid dimension");for(n=Array(a),r=s,o=0;o<a;o++){for(n[o]=0,i=0;i<s;i++)n[o]+=t[o][i];n[o]/=r}}return n},e.sum=function(t,e){"undefined"==typeof e&&(e=0);var n,r,i,o=t.length,a=t[0].length;if(-1===e)for(n=[0],r=0;r<o;r++)for(i=0;i<a;i++)n[0]+=t[r][i];else if(0===e)for(n=Array(a),i=0;i<a;i++)for(n[i]=0,r=0;r<o;r++)n[i]+=t[r][i];else{if(1!==e)throw new Error("Invalid dimension");for(n=Array(o),i=0;i<o;i++)for(n[i]=0,r=0;r<a;r++)n[i]+=t[i][r]}return n},e.product=function(t,e){"undefined"==typeof e&&(e=0);var n,r,i,o=t.length,a=t[0].length;if(-1===e)for(n=[1],r=0;r<o;r++)for(i=0;i<a;i++)n[0]*=t[r][i];else if(0===e)for(n=Array(a),i=0;i<a;i++)for(n[i]=1,r=0;r<o;r++)n[i]*=t[r][i];else{if(1!==e)throw new Error("Invalid dimension");for(n=Array(o),i=0;i<o;i++)for(n[i]=1,r=0;r<a;r++)n[i]*=t[i][r]}return n},e.standardDeviation=function(t,n,r){for(var i=e.variance(t,n,r),o=i.length,a=0;a<o;a++)i[a]=R(i[a]);return i},e.variance=function(t,n,r){"undefined"==typeof r&&(r=!0),n=n||e.mean(t);var i=t.length;if(0===i)return[];for(var o=t[0].length,a=Array(o),s=0;s<o;s++){for(var u=0,c=0,l=0,h=0;h<i;h++)u+=l=t[h][s]-n[s],c+=l*l;a[s]=r?(c-u*u/i)/(i-1):(c-u*u/i)/i}return a},e.median=function(t){for(var e,n=t.length,r=t[0].length,o=Array(r),a=0;a<r;a++){e=Array(n);for(var s=0;s<n;s++)e[s]=t[s][a];e.sort(i);var u=e.length;o[a]=0==u%2?.5*(e[u/2]+e[u/2-1]):e[g(u/2)]}return o},e.mode=function(t){var e,n,r=t.length,i=t[0].length,o=Array(i);for(e=0;e<i;e++){for(var a=Array(r),s=0;s<r;s++)a[s]=0;var u=Array(r),c=0;for(n=0;n<r;n++){var l=u.indexOf(t[n][e]);0<=l?a[l]++:(u[c]=t[n][e],a[c]=1,c++)}var h=0,f=0;for(n=0;n<c;n++)a[n]>h&&(h=a[n],f=n);o[e]=u[f]}return o},e.skewness=function(t,n){"undefined"==typeof n&&(n=!0);for(var r=e.mean(t),i=t.length,o=r.length,a=Array(o),s=0;s<o;s++){for(var u,l=0,h=0,f=0;f<i;f++)l+=(u=t[f][s]-r[s])*u,h+=u*u*u;var d=h/i/c(l/i,1.5);if(n){var p=R(i*(i-1));a[s]=p/(i-2)*d}else a[s]=d}return a},e.kurtosis=function(t,n){"undefined"==typeof n&&(n=!0);for(var r=e.mean(t),i=t.length,o=t[0].length,a=Array(o),s=0;s<o;s++){for(var u,c=0,l=0,h=0;h<i;h++)c+=(u=t[h][s]-r[s])*u,l+=u*u*u*u;var f=c/i,d=l/i;if(n){var p=c/(i-1);a[s]=i*(i+1)/((i-1)*(i-2)*(i-3))*(l/(p*p))-(i-1)*(i-1)/((i-2)*(i-3))*3}else a[s]=d/(f*f)-3}return a},e.standardError=function(t){for(var n=t.length,r=e.standardDeviation(t),i=r.length,o=Array(i),a=R(n),s=0;s<i;s++)o[s]=r[s]/a;return o},e.covariance=function(t,n){return e.scatter(t,void 0,n)},e.scatter=function(t,n,r){"undefined"==typeof r&&(r=0),"undefined"==typeof n&&(0===r?n=t.length-1:1===r&&(n=t[0].length-1));var i=e.mean(t,r),o=t.length;if(0===o)return[[]];var a,s,u,c,l,h=t[0].length;if(0===r){for(a=Array(h),s=0;s<h;s++)a[s]=Array(h);for(s=0;s<h;s++)for(u=s;u<h;u++){for(c=0,l=0;l<o;l++)c+=(t[l][u]-i[u])*(t[l][s]-i[s]);a[s][u]=c/=n,a[u][s]=c}}else{if(1!==r)throw new Error("Invalid dimension");for(a=Array(o),s=0;s<o;s++)a[s]=Array(o);for(s=0;s<o;s++)for(u=s;u<o;u++){for(c=0,l=0;l<h;l++)c+=(t[u][l]-i[u])*(t[s][l]-i[s]);a[s][u]=c/=n,a[u][s]=c}}return a},e.correlation=function(t){var n,r,i=e.mean(t),o=e.standardDeviation(t,!0,i),a=e.zScores(t,i,o),s=t.length,u=t[0].length,c=Array(u);for(n=0;n<u;n++)c[n]=Array(u);for(n=0;n<u;n++)for(r=n;r<u;r++){for(var l=0,h=0,f=a.length;h<f;h++)l+=a[h][r]*a[h][n];c[n][r]=l/=s-1,c[r][n]=l}return c},e.zScores=function(t,n,r){return n=n||e.mean(t),"undefined"==typeof r&&(r=e.standardDeviation(t,!0,n)),e.standardize(e.center(t,n,!1),r,!0)},e.center=function(t,n,r){n=n||e.mean(t);var i,o,a,s=t,u=t.length;if(!r)for(s=Array(u),i=0;i<u;i++)s[i]=Array(t[i].length);for(i=0;i<u;i++){var c=s[i];for(o=0,a=c.length;o<a;o++)c[o]=t[i][o]-n[o]}return s},e.standardize=function(t,n,r){"undefined"==typeof n&&(n=e.standardDeviation(t));var i,o,a,s=t,u=t.length;if(!r)for(s=Array(u),i=0;i<u;i++)s[i]=Array(t[i].length);for(i=0;i<u;i++){var c=s[i],l=t[i];for(o=0,a=c.length;o<a;o++)0===n[o]||isNaN(n[o])||(c[o]=l[o]/n[o])}return s},e.weightedVariance=function(t,n){var r=e.mean(t),i=t.length;if(0===i)return[];for(var o=t[0].length,a=Array(o),s=0;s<o;s++){for(var u=0,c=0,l=0,h=0;h<i;h++){var f=t[h][s]-r[s],d=n[h];u+=d*(f*f),l+=d,c+=d*d}a[s]=u*(l/(l*l-c))}return a},e.weightedMean=function(t,e,n){"undefined"==typeof n&&(n=0);var r=t.length;if(0===r)return[];var i,a,s,u,c,l,h=t[0].length;if(0===n){for(i=Array(h),a=0;a<h;a++)i[a]=0;for(a=0;a<r;a++)for(l=t[a],c=e[a],u=0;u<h;u++)i[u]+=l[u]*c}else{if(1!==n)throw new Error("Invalid dimension");for(i=Array(r),a=0;a<r;a++)i[a]=0;for(u=0;u<r;u++)for(l=t[u],c=e[u],a=0;a<h;a++)i[u]+=l[a]*c}var f=o.sum(e);if(0!==f)for(a=0,s=i.length;a<s;a++)i[a]/=f;return i},e.weightedCovariance=function(t,n,r,i){i=i||0,r=r||e.weightedMean(t,n,i);for(var o=0,a=0,s=0,u=n.length;s<u;s++)o+=n[s],a+=n[s]*n[s];return e.weightedScatter(t,n,r,o/(o*o-a),i)},e.weightedScatter=function(t,n,r,i,o){o=o||0,r=r||e.weightedMean(t,n,o),"undefined"==typeof i&&(i=1);var a=t.length;if(0===a)return[[]];var s,u,c,l,h,f=t[0].length;if(0===o){for(s=Array(f),u=0;u<f;u++)s[u]=Array(f);for(u=0;u<f;u++)for(c=u;c<f;c++){for(h=0,l=0;l<a;l++)h+=n[l]*(t[l][c]-r[c])*(t[l][u]-r[u]);s[u][c]=h*i,s[c][u]=h*i}}else{if(1!==o)throw new Error("Invalid dimension");for(s=Array(a),u=0;u<a;u++)s[u]=Array(a);for(u=0;u<a;u++)for(c=u;c<a;c++){for(h=0,l=0;l<f;l++)h+=n[l]*(t[c][l]-r[c])*(t[u][l]-r[u]);s[u][c]=h*i,s[c][u]=h*i}}return s}},function(n,r){"use strict";function i(e,n,r,i,o){function s(t,e,n,r){return(r-e)/(n-t)}var u=e.length,c=(i-r)/(o-1),l=r-c/2,h=Array(o),f=e[e.length-1]-e[e.length-2],d=l,p=l+c,m=t,g=0,v=e[0]-(e[1]-e[0]),y=0,w=0,b=0,x=0,_=0,M=0,E=0,S=0;t:for(;;){for(;0<=v-p;){var T=a(0,p-m,b,g);if(h[S]=((M=w+T)-_)/c,++S===o)break t;d=p,p+=c,_=M}m<=d&&d<=v&&(_=w+(T=a(0,d-m,b,g))),w+=a(m,v,b,x),m=v,g=y,E<u?(v=e[E],y=n[E],E++):E===u&&(v+=f,y=0),x=-(b=s(m,g,v,y))*m+g}return h}function o(t,n,r,i,o){var a=t.length,s=(i-r)/(o-1),u=t[t.length-1]-t[t.length-2],c=r-s/2,l=Array(o),h=c,f=c+s,d=-e,p=0,m=t[0],g=n[0],v=0,y=!0,w=0,b=0,x=1,_=0;t:for(;;){if(d>=m)throw new Error("x must be an increasing serie");for(;0<d-f;){if(y&&(b++,y=!1),l[_]=0>=b?0:w/b,++_===o)break t;h=f,f+=s,w=0,b=0}d>h&&(w+=p,b++),(d==-e||1<v)&&b--,d=m,p=g,x<a?(m=t[x],g=n[x],x++):(m+=u,g=0,v++)}return l}function a(t,e,n,r){return.5*n*e*e+r*e-(.5*n*t*t+r*t)}r.getEquallySpacedData=function(t,e,n){if(1<t.length&&t[0]>t[1]&&(t=t.slice().reverse(),e=e.slice().reverse()),t.length!==e.length)throw new RangeError("the x and y vector doesn't have the same size.");void 0===n&&(n={});var r=void 0===n.from?t[0]:n.from;if(isNaN(r)||!isFinite(r))throw new RangeError("'From' value must be a number");var a=void 0===n.to?t[t.length-1]:n.to;if(isNaN(a)||!isFinite(a))throw new RangeError("'To' value must be a number");var s=r>a;if(s){var u=r;r=a,a=u}var c=void 0===n.numberOfPoints?100:n.numberOfPoints;if(isNaN(c)||!isFinite(c))throw new RangeError("'Number of points' value must be a number");if(1>c)throw new RangeError("the number of point must be higher than 1");var l="slot"==("slot"===n.variant?"slot":"smooth")?o(t,e,r,a,c):i(t,e,r,a,c);return s?l.reverse():l},r.integral=a},function(t,e,n){"use strict";e.SNV=function(t){for(var e=r.mean(t),n=r.standardDeviation(t),i=t.slice(),o=0;o<t.length;o++)i[o]=(i[o]-e)/n;return i};var r=n(2).array},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(14),i=r&&r.__esModule?r:{default:r};e.default=class extends i.default{constructor(t){super(t,t.columns,t.rows)}set(t,e,n){return this.matrix.set(e,t,n),this}get(t,e){return this.matrix.get(e,t)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(14),i=r&&r.__esModule?r:{default:r};e.default=class extends i.default{constructor(t,e){super(t,1,t.columns),this.row=e}set(t,e,n){return this.matrix.set(this.row,e,n),this}get(t,e){return this.matrix.get(this.row,e)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(14),i=r&&r.__esModule?r:{default:r},o=n(23);e.default=class extends i.default{constructor(t,e,n,r,i){(0,o.checkRange)(t,e,n,r,i),super(t,n-e+1,i-r+1),this.startRow=e,this.startColumn=r}set(t,e,n){return this.matrix.set(this.startRow+t,this.startColumn+e,n),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(14),i=r&&r.__esModule?r:{default:r},o=n(23);e.default=class extends i.default{constructor(t,e,n){var r=(0,o.checkIndices)(t,e,n);super(t,r.row.length,r.column.length),this.rowIndices=r.row,this.columnIndices=r.column}set(t,e,n){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],n),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(14),i=r&&r.__esModule?r:{default:r};e.default=class extends i.default{constructor(t,e){super(t,t.rows,1),this.column=e}set(t,e,n){return this.matrix.set(t,this.column,n),this}get(t){return this.matrix.get(t,this.column)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(14),i=r&&r.__esModule?r:{default:r};e.default=class extends i.default{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(this.rows-t-1,e,n),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(14),i=r&&r.__esModule?r:{default:r};e.default=class extends i.default{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(t,this.columns-e-1,n),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){return t=o.default.checkMatrix(t),e=o.default.checkMatrix(e),t.isSquare()?new a.default(t).solve(e):new s.default(t).solve(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.inverse=function(t){return i(t=o.default.checkMatrix(t),o.default.eye(t.rows))},e.solve=i;var o=r(n(4)),a=r(n(33)),s=r(n(53))},function(t,e,n){"use strict";function r(t,e){if(e=Object.assign({},d,e),!(this instanceof r))return new r(t,e);if(!(t=h.default.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");var n,u,c=t.columns,l=(0,f.getFilled2DArray)(c,c,0),p=Array(c),m=Array(c),g=t;if(e.assumeSymmetric||t.isSymmetric()){for(n=0;n<c;n++)for(u=0;u<c;u++)l[n][u]=g.get(n,u);i(c,m,p,l),o(c,m,p,l)}else{var v=(0,f.getFilled2DArray)(c,c,0),y=Array(c);for(u=0;u<c;u++)for(n=0;n<c;n++)v[n][u]=g.get(n,u);a(c,v,y,l),s(c,m,p,l,v)}this.n=c,this.e=m,this.d=p,this.V=l}function i(t,e,n,r){var i,o,a,s,c,l,h,f;for(c=0;c<t;c++)n[c]=r[t-1][c];for(s=t-1;0<s;s--){for(f=0,a=0,l=0;l<s;l++)f+=u(n[l]);if(0===f)for(e[s]=n[s-1],c=0;c<s;c++)n[c]=r[s-1][c],r[s][c]=0,r[c][s]=0;else{for(l=0;l<s;l++)n[l]/=f,a+=n[l]*n[l];for(i=n[s-1],o=R(a),0<i&&(o=-o),e[s]=f*o,a-=i*o,n[s-1]=i-o,c=0;c<s;c++)e[c]=0;for(c=0;c<s;c++){for(r[c][s]=i=n[c],o=e[c]+r[c][c]*i,l=c+1;l<=s-1;l++)o+=r[l][c]*n[l],e[l]+=r[l][c]*i;e[c]=o}for(i=0,c=0;c<s;c++)e[c]/=a,i+=e[c]*n[c];for(h=i/(a+a),c=0;c<s;c++)e[c]-=h*n[c];for(c=0;c<s;c++){for(i=n[c],o=e[c],l=c;l<=s-1;l++)r[l][c]-=i*e[l]+o*n[l];n[c]=r[s-1][c],r[s][c]=0}}n[s]=a}for(s=0;s<t-1;s++){if(r[t-1][s]=r[s][s],r[s][s]=1,0!==(a=n[s+1])){for(l=0;l<=s;l++)n[l]=r[l][s+1]/a;for(c=0;c<=s;c++){for(o=0,l=0;l<=s;l++)o+=r[l][s+1]*r[l][c];for(l=0;l<=s;l++)r[l][c]-=o*n[l]}}for(l=0;l<=s;l++)r[l][s+1]=0}for(c=0;c<t;c++)n[c]=r[t-1][c],r[t-1][c]=0;r[t-1][t-1]=1,e[0]=0}function o(t,e,n,r){var i,o,a,s,c,l,h,d,p,m,g,v,y,w,b,x;for(a=1;a<t;a++)e[a-1]=e[a];e[t-1]=0;var _=0,E=0,S=2.220446049250313e-16;for(l=0;l<t;l++){for(E=M(E,u(n[l])+u(e[l])),h=l;h<t&&!(u(e[h])<=S*E);)h++;if(h>l)do{for(p=(0,f.hypotenuse)(d=(n[l+1]-(i=n[l]))/(2*e[l]),1),0>d&&(p=-p),n[l]=e[l]/(d+p),n[l+1]=e[l]*(d+p),m=n[l+1],o=i-n[l],a=l+2;a<t;a++)n[a]-=o;for(_+=o,d=n[h],v=g=1,y=g,w=e[l+1],b=0,x=0,a=h-1;a>=l;a--)for(y=v,v=g,x=b,i=g*e[a],o=g*d,p=(0,f.hypotenuse)(d,e[a]),e[a+1]=b*p,d=(g=d/p)*n[a]-(b=e[a]/p)*i,n[a+1]=o+b*(g*i+b*n[a]),c=0;c<t;c++)r[c][a+1]=b*r[c][a]+g*(o=r[c][a+1]),r[c][a]=g*r[c][a]-b*o;e[l]=b*(d=-b*x*y*w*e[l]/m),n[l]=g*d}while(u(e[l])>S*E);n[l]+=_,e[l]=0}for(a=0;a<t-1;a++){for(c=a,d=n[a],s=a+1;s<t;s++)n[s]<d&&(c=s,d=n[s]);if(c!==a)for(n[c]=n[a],n[a]=d,s=0;s<t;s++)d=r[s][a],r[s][a]=r[s][c],r[s][c]=d}}function a(t,e,n,r){var i,o,a,s,c,l,h,f=t-1;for(l=1;l<=f-1;l++){for(h=0,s=l;s<=f;s++)h+=u(e[s][l-1]);if(0!==h){for(a=0,s=f;s>=l;s--)n[s]=e[s][l-1]/h,a+=n[s]*n[s];for(o=R(a),0<n[l]&&(o=-o),a-=n[l]*o,n[l]-=o,c=l;c<t;c++){for(i=0,s=f;s>=l;s--)i+=n[s]*e[s][c];for(i/=a,s=l;s<=f;s++)e[s][c]-=i*n[s]}for(s=0;s<=f;s++){for(i=0,c=f;c>=l;c--)i+=n[c]*e[s][c];for(i/=a,c=l;c<=f;c++)e[s][c]-=i*n[c]}n[l]=h*n[l],e[l][l-1]=h*o}}for(s=0;s<t;s++)for(c=0;c<t;c++)r[s][c]=s===c?1:0;for(l=f-1;l>=1;l--)if(0!==e[l][l-1]){for(s=l+1;s<=f;s++)n[s]=e[s][l-1];for(c=l;c<=f;c++){for(o=0,s=l;s<=f;s++)o+=n[s]*r[s][c];for(o=o/n[l]/e[l][l-1],s=l;s<=f;s++)r[s][c]+=o*n[s]}}}function s(t,e,n,r,i){var o,a,s,l,h,f,d,p,m,g,y,w,b,x,_,E=t-1,S=t-1,T=2.220446049250313e-16,A=0,k=0,C=0,D=0,L=0,O=0,P=0,I=0;for(o=0;o<t;o++)for((o<0||o>S)&&(n[o]=i[o][o],e[o]=0),a=M(o-1,0);a<t;a++)k+=u(i[o][a]);for(;E>=0;){for(l=E;l>0&&(0===(O=u(i[l-1][l-1])+u(i[l][l]))&&(O=k),!(u(i[l][l-1])<T*O));)l--;if(l===E)i[E][E]+=A,n[E]=i[E][E],e[E]=0,E--,I=0;else if(l===E-1){if(P=R(u(D=(C=(i[E-1][E-1]-i[E][E])/2)*C+(d=i[E][E-1]*i[E-1][E]))),i[E][E]+=A,i[E-1][E-1]=i[E-1][E-1]+A,p=i[E][E],0<=D){for(n[E-1]=p+(P=0<=C?C+P:C-P),n[E]=n[E-1],0!==P&&(n[E]=p-d/P),e[E-1]=0,e[E]=0,C=(p=i[E][E-1])/(O=u(p)+u(P)),C/=L=R(C*C+(D=P/O)*D),D/=L,a=E-1;a<t;a++)i[E-1][a]=D*(P=i[E-1][a])+C*i[E][a],i[E][a]=D*i[E][a]-C*P;for(o=0;o<=E;o++)i[o][E-1]=D*(P=i[o][E-1])+C*i[o][E],i[o][E]=D*i[o][E]-C*P;for(o=0;o<=S;o++)r[o][E-1]=D*(P=r[o][E-1])+C*r[o][E],r[o][E]=D*r[o][E]-C*P}else n[E-1]=p+C,n[E]=p+C,e[E-1]=P,e[E]=-P;E-=2,I=0}else{if(p=i[E][E],m=0,d=0,l<E&&(m=i[E-1][E-1],d=i[E][E-1]*i[E-1][E]),10==I){for(A+=p,o=0;o<=E;o++)i[o][o]-=p;p=m=.75*(O=u(i[E][E-1])+u(i[E-1][E-2])),d=-.4375*O*O}if(30==I&&0<(O=(O=(m-p)/2)*O+d)){for(O=R(O),m<p&&(O=-O),O=p-d/((m-p)/2+O),o=0;o<=E;o++)i[o][o]-=O;A+=O,p=m=d=.964}for(++I,h=E-2;h>=l&&(C=((L=p-(P=i[h][h]))*(O=m-P)-d)/i[h+1][h]+i[h][h+1],D=i[h+1][h+1]-P-L-O,L=i[h+2][h+1],C/=O=u(C)+u(D)+u(L),D/=O,L/=O,h!==l)&&!(u(i[h][h-1])*(u(D)+u(L))<T*(u(C)*(u(i[h-1][h-1])+u(P)+u(i[h+1][h+1]))));)h--;for(o=h+2;o<=E;o++)i[o][o-2]=0,o>h+2&&(i[o][o-3]=0);for(s=h;s<=E-1&&(x=s!==E-1,s!==h&&(C=i[s][s-1],D=i[s+1][s-1],L=x?i[s+2][s-1]:0,0!==(p=u(C)+u(D)+u(L))&&(C/=p,D/=p,L/=p)),0!==p);s++)if(O=R(C*C+D*D+L*L),0>C&&(O=-O),0!==O){for(s===h?l!==h&&(i[s][s-1]=-i[s][s-1]):i[s][s-1]=-O*p,p=(C+=O)/O,m=D/O,P=L/O,D/=C,L/=C,a=s;a<t;a++)C=i[s][a]+D*i[s+1][a],x&&(i[s+2][a]=i[s+2][a]-(C+=L*i[s+2][a])*P),i[s][a]-=C*p,i[s+1][a]=i[s+1][a]-C*m;for(o=0;o<=v(E,s+3);o++)C=p*i[o][s]+m*i[o][s+1],x&&(i[o][s+2]=i[o][s+2]-(C+=P*i[o][s+2])*L),i[o][s]-=C,i[o][s+1]=i[o][s+1]-C*D;for(o=0;o<=S;o++)C=p*r[o][s]+m*r[o][s+1],x&&(r[o][s+2]=r[o][s+2]-(C+=P*r[o][s+2])*L),r[o][s]-=C,r[o][s+1]=r[o][s+1]-C*D}}}if(0!==k){for(E=t-1;0<=E;E--)if(C=n[E],0===(D=e[E]))for(l=E,i[E][E]=1,o=E-1;0<=o;o--){for(d=i[o][o]-C,L=0,a=l;a<=E;a++)L+=i[o][a]*i[a][E];if(0>e[o])P=d,O=L;else if(l=o,0===e[o]?i[o][E]=0===d?-L/(T*k):-L/d:(m=i[o+1][o],i[o][E]=f=((p=i[o][o+1])*O-P*L)/(D=(n[o]-C)*(n[o]-C)+e[o]*e[o]),i[o+1][E]=u(p)>u(P)?(-L-d*f)/p:(-O-m*f)/P),1<T*(f=u(i[o][E]))*f)for(a=o;a<=E;a++)i[a][E]/=f}else if(0>D)for(l=E-1,u(i[E][E-1])>u(i[E-1][E])?(i[E-1][E-1]=D/i[E][E-1],i[E-1][E]=-(i[E][E]-C)/i[E][E-1]):(_=c(0,-i[E-1][E],i[E-1][E-1]-C,D),i[E-1][E-1]=_[0],i[E-1][E]=_[1]),i[E][E-1]=0,i[E][E]=1,o=E-2;0<=o;o--){for(g=0,y=0,a=l;a<=E;a++)g+=i[o][a]*i[a][E-1],y+=i[o][a]*i[a][E];if(d=i[o][o]-C,0>e[o])P=d,L=g,O=y;else if(l=o,0===e[o]?(_=c(-g,-y,d,D),i[o][E-1]=_[0],i[o][E]=_[1]):(p=i[o][o+1],m=i[o+1][o],b=2*(n[o]-C)*D,0==(w=(n[o]-C)*(n[o]-C)+e[o]*e[o]-D*D)&&0===b&&(w=T*k*(u(d)+u(D)+u(p)+u(m)+u(P))),_=c(p*L-P*g+D*y,p*O-P*y-D*g,w,b),i[o][E-1]=_[0],i[o][E]=_[1],u(p)>u(P)+u(D)?(i[o+1][E-1]=(-g-d*i[o][E-1]+D*i[o][E])/p,i[o+1][E]=(-y-d*i[o][E]-D*i[o][E-1])/p):(_=c(-L-m*i[o][E-1],-O-m*i[o][E],P,D),i[o+1][E-1]=_[0],i[o+1][E]=_[1])),1<T*(f=M(u(i[o][E-1]),u(i[o][E])))*f)for(a=o;a<=E;a++)i[a][E-1]=i[a][E-1]/f,i[a][E]/=f}for(o=0;o<t;o++)if(o<0||o>S)for(a=o;a<t;a++)r[o][a]=i[o][a];for(a=t-1;a>=0;a--)for(o=0;o<=S;o++){for(P=0,s=0;s<=v(a,S);s++)P+=r[o][s]*i[s][a];r[o][a]=P}}}function c(t,e,n,r){var i,o;return u(n)>u(r)?[(t+(i=r/n)*e)/(o=n+i*r),(e-i*t)/o]:[((i=n/r)*t+e)/(o=r+i*n),(i*e-t)/o]}Object.defineProperty(e,"__esModule",{value:!0});var l=n(4),h=l&&l.__esModule?l:{default:l},f=n(34),d={assumeSymmetric:!1};r.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return h.default.isMatrix(this.V)||(this.V=new h.default(this.V)),this.V},get diagonalMatrix(){var t,e,n=this.n,r=this.e,i=this.d,o=new h.default(n,n);for(t=0;t<n;t++){for(e=0;e<n;e++)o[t][e]=0;o[t][t]=i[t],0<r[t]?o[t][t+1]=r[t]:0>r[t]&&(o[t][t-1]=r[t])}return o}},e.default=r},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);if(!(t=o.default.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");var e,n,i,a=t,s=a.rows,u=new o.default(s,s),c=!0;for(n=0;n<s;n++){var l=u[n],h=0;for(i=0;i<n;i++){var f=u[i],d=0;for(e=0;e<i;e++)d+=f[e]*l[e];l[i]=d=(a[n][i]-d)/u[i][i],h+=d*d}for(c&=0<(h=a[n][n]-h),u[n][n]=R(M(h,0)),i=n+1;i<s;i++)u[n][i]=0}if(!c)throw new Error("Matrix is not positive definite");this.L=u}Object.defineProperty(e,"__esModule",{value:!0});var i=n(4),o=i&&i.__esModule?i:{default:i};r.prototype={get lowerTriangularMatrix(){return this.L},solve:function(t){t=o.default.checkMatrix(t);var e=this.L,n=e.rows;if(t.rows!==n)throw new Error("Matrix dimensions do not match");var r,i,a,s=t.columns,u=t.clone();for(a=0;a<n;a++)for(i=0;i<s;i++){for(r=0;r<a;r++)u[a][i]-=u[r][i]*e[a][r];u[a][i]/=e[a][a]}for(a=n-1;0<=a;a--)for(i=0;i<s;i++){for(r=a+1;r<n;r++)u[a][i]-=u[r][i]*e[r][a];u[a][i]/=e[a][a]}return u}},e.default=r},function(t,e,n){"use strict";function r(t){for(var e,n="",r=0;r<t.length;r++)e=(t[r]>>>0).toString(2),n+="00000000000000000000000000000000".substr(e.length)+e;return n}var i=n(120);t.exports={count:function(t){for(var e=0,n=0;n<t.length;n++)e+=i[255&t[n]]+i[255&t[n]>>8]+i[255&t[n]>>16]+i[255&t[n]>>24];return e},and:function(t,e){for(var n=Array(t.length),r=0;r<t.length;r++)n[r]=t[r]&e[r];return n},or:function(t,e){for(var n=Array(t.length),r=0;r<t.length;r++)n[r]=t[r]|e[r];return n},xor:function(t,e){for(var n=Array(t.length),r=0;r<t.length;r++)n[r]=t[r]^e[r];return n},not:function(t){for(var e=Array(t.length),n=0;n<e.length;n++)e[n]=~t[n];return e},getBit:function(t,e){return!!(t[e>>5]&1<<31-e%32)},setBit:function(t,e,n){var r=e>>5,i=1<<31-e%32;return t[r]=n?i|t[r]:~i&t[r],t},toBinaryString:r,parseBinaryString:function(t){for(var e=t.length/32,n=Array(e),r=0;r<e;r++)n[r]=0|parseInt(t.substr(32*r,32),2);return n},toHexString:function(t){for(var e,n="",r=0;r<t.length;r++)e=(t[r]>>>0).toString(16),n+="00000000".substr(e.length)+e;return n},parseHexString:function(t){for(var e=t.length/8,n=Array(e),r=0;r<e;r++)n[r]=0|parseInt(t.substr(8*r,8),16);return n},toDebug:function(t){for(var e=r(t),n="",i=0;i<t.length;i++){n+="0000".substr((32*i).toString(16).length)+(32*i).toString(16)+":";for(var o=0;32>o;o+=4)n+=" "+e.substr(32*i+o,4);i<t.length-1&&(n+="\n")}return n}}},function(t){"use strict";for(var e=Array(256),n=0;256>n;n++){for(var r=n,i=0;r;)r&=r-1,i++;e[n]=i}t.exports=e},function(t){"use strict";t.exports=function(t,e){t=t||0;for(var n=Array(t),r=0;r<t;r++)n[r]=e;return n}},function(t,e,n){"use strict";var r=n(55),i=n(56).asc,o=2147483647,a=[o,5,11,23,47,97,197,397,797,1597,3203,6421,12853,25717,51437,102877,205759,411527,823117,1646237,3292489,6584983,13169977,26339969,52679969,105359939,210719881,421439783,842879579,1685759167,433,877,1759,3527,7057,14143,28289,56591,113189,226379,452759,905551,1811107,3622219,7244441,14488931,28977863,57955739,115911563,231823147,463646329,927292699,1854585413,953,1907,3821,7643,15287,30577,61169,122347,244703,489407,978821,1957651,3915341,7830701,15661423,31322867,62645741,125291483,250582987,501165979,1002331963,2004663929,1039,2081,4177,8363,16729,33461,66923,133853,267713,535481,1070981,2141977,4283963,8567929,17135863,34271747,68543509,137087021,274174111,548348231,1096696463,31,67,137,277,557,1117,2237,4481,8963,17929,35863,71741,143483,286973,573953,1147921,2295859,4591721,9183457,18366923,36733847,73467739,146935499,293871013,587742049,1175484103,599,1201,2411,4831,9677,19373,38747,77509,155027,310081,620171,1240361,2480729,4961459,9922933,19845871,39691759,79383533,158767069,317534141,635068283,1270136683,311,631,1277,2557,5119,10243,20507,41017,82037,164089,328213,656429,1312867,2625761,5251529,10503061,21006137,42012281,84024581,168049163,336098327,672196673,1344393353,3,7,17,37,79,163,331,673,1361,2729,5471,10949,21911,43853,87719,175447,350899,701819,1403641,2807303,5614657,11229331,22458671,44917381,89834777,179669557,359339171,718678369,1437356741,43,89,179,359,719,1439,2879,5779,11579,23159,46327,92657,185323,370661,741337,1482707,2965421,5930887,11861791,23723597,47447201,94894427,189788857,379577741,759155483,1518310967,379,761,1523,3049,6101,12203,24407,48817,97649,195311,390647,781301,1562611,3125257,6250537,12501169,25002389,50004791,100009607,200019221,400038451,800076929,1600153859,13,29,59,127,257,521,1049,2099,4201,8419,16843,33703,67409,134837,269683,539389,1078787,2157587,4315183,8630387,17260781,34521589,69043189,138086407,276172823,552345671,1104691373,19,41,83,167,337,677,1361,2729,5471,10949,21911,43853,87719,175447,350899,701819,1403641,2807303,5614657,11229331,22458671,44917381,89834777,179669557,359339171,718678369,1437356741,53,107,223,449,907,1823,3659,7321,14653,29311,58631,117269,234539,469099,938207,1876417,3752839,7505681,15011389,30022781,60045577,120091177,240182359,480364727,960729461,1921458943];a.sort(i),e.nextPrime=function(t){var e=r(a,t,i);return 0>e&&(e=~e),a[e]},e.largestPrime=o},function(t){"use strict";t.exports=Number.isNaN||function(t){return t!=t}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.RobustPolynomialRegression=e.TheilSenRegression=e.PolinomialFitting2D=e.KRR=e.KernelRidgeRegression=e.NonLinearRegression=e.NLR=e.MultivariateLinearRegression=e.PowerRegression=e.ExponentialRegression=e.PolynomialRegression=e.SLR=e.SimpleLinearRegression=void 0;var i=n(36);Object.defineProperty(e,"SimpleLinearRegression",{enumerable:!0,get:function(){return r(i).default}}),Object.defineProperty(e,"SLR",{enumerable:!0,get:function(){return r(i).default}});var o=n(58);Object.defineProperty(e,"PolynomialRegression",{enumerable:!0,get:function(){return r(o).default}});var a=n(127);Object.defineProperty(e,"ExponentialRegression",{enumerable:!0,get:function(){return r(a).default}});var s=n(128);Object.defineProperty(e,"PowerRegression",{enumerable:!0,get:function(){return r(s).default}});var u=n(129);Object.defineProperty(e,"MultivariateLinearRegression",{enumerable:!0,get:function(){return r(u).default}});var c=n(130);Object.defineProperty(e,"KernelRidgeRegression",{enumerable:!0,get:function(){return r(c).default}}),Object.defineProperty(e,"KRR",{enumerable:!0,get:function(){return r(c).default}});var l=n(141);Object.defineProperty(e,"PolinomialFitting2D",{enumerable:!0,get:function(){return r(l).default}});var h=n(142);Object.defineProperty(e,"TheilSenRegression",{enumerable:!0,get:function(){return r(h).default}});var f=n(143);Object.defineProperty(e,"RobustPolynomialRegression",{enumerable:!0,get:function(){return r(f).default}});var d={PotentialRegression:r(n(144)).default};e.NLR=d,e.NonLinearRegression=d},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){return 0>t?(t=0-t,"number"==typeof e?"- "+t.toPrecision(e):"- "+t.toString()):"number"==typeof e?t.toPrecision(e):t.toString()}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if(!Array.isArray(t)||!Array.isArray(e))throw new TypeError("x and y must be arrays");if(t.length!==e.length)throw new RangeError("x and y arrays must have the same length")}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(3),s=i(a),u=i(n(36));class c extends s.default{constructor(t,e){super(),!0===t?(this.A=e.A,this.B=e.B):((0,a.checkArrayLength)(t,e),function(t,e,n){for(var i=e.length,a=Array(i),s=0;s<i;s++)a[s]=r(n[s]);var c=new u.default(e,a);t.A=c.slope,t.B=o(c.intercept)}(this,t,e))}_predict(t){return this.B*o(t*this.A)}toJSON(){return{name:"exponentialRegression",A:this.A,B:this.B}}toString(t){return"f(x) = "+(0,a.maybeToPrecision)(this.B,t)+" * e^("+(0,a.maybeToPrecision)(this.A,t)+" * x)"}toLaTeX(t){return 0<=this.A?"f(x) = "+(0,a.maybeToPrecision)(this.B,t)+"e^{"+(0,a.maybeToPrecision)(this.A,t)+"x}":"f(x) = \\frac{"+(0,a.maybeToPrecision)(this.B,t)+"}{e^{"+(0,a.maybeToPrecision)(-this.A,t)+"x}}"}static load(t){if("exponentialRegression"!==t.name)throw new TypeError("not a exponential regression model");return new c(!0,t)}}e.default=c},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(3),s=i(a),u=i(n(36));class l extends s.default{constructor(t,e){super(),!0===t?(this.A=e.A,this.B=e.B):((0,a.checkArrayLength)(t,e),function(t,e,n){for(var i=e.length,a=Array(i),s=Array(i),c=0;c<i;c++)a[c]=r(e[c]),s[c]=r(n[c]);var l=new u.default(a,s);t.A=o(l.intercept),t.B=l.slope}(this,t,e))}_predict(t){return this.A*c(t,this.B)}toJSON(){return{name:"powerRegression",A:this.A,B:this.B}}toString(t){return"f(x) = "+(0,a.maybeToPrecision)(this.A,t)+" * x^"+(0,a.maybeToPrecision)(this.B,t)}toLaTeX(t){return 0<=this.B?"f(x) = "+(0,a.maybeToPrecision)(this.A,t)+"x^{"+(0,a.maybeToPrecision)(this.B,t)+"}":"f(x) = \\frac{"+(0,a.maybeToPrecision)(this.A,t)+"}{x^{"+(0,a.maybeToPrecision)(-this.B,t)+"}}"}static load(t){if("powerRegression"!==t.name)throw new TypeError("not a power regression model");return new l(!0,t)}}e.default=l},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(13),o=r(i),a=r(n(3));class s extends a.default{constructor(t,e,n={}){var r=n.intercept,a=!(void 0!==r)||r;super(),!0===t?(this.weights=e.weights,this.inputs=e.inputs,this.outputs=e.outputs,this.intercept=e.intercept):(a&&(t=new o.default(t)).addColumn(Array(t.length).fill(1)),this.weights=new i.SVD(t,{autoTranspose:!0}).solve(e).to2DArray(),this.inputs=t[0].length,this.outputs=e[0].length,a&&this.inputs--,this.intercept=a)}predict(t){if(Array.isArray(t)){if("number"==typeof t[0])return this._predict(t);if(Array.isArray(t[0])){for(var e=Array(t.length),n=0;n<t.length;n++)e[n]=this._predict(t[n]);return e}}throw new TypeError("x must be a matrix or array of numbers")}_predict(t){var e=Array(this.outputs);if(this.intercept)for(var n=0;n<this.outputs;n++)e[n]=this.weights[this.inputs][n];else e.fill(0);for(var r=0;r<this.inputs;r++)for(var i=0;i<this.outputs;i++)e[i]+=this.weights[r][i]*t[r];return e}score(){throw new Error("score method is not implemented yet")}toJSON(){return{name:"multivariateLinearRegression",weights:this.weights,inputs:this.inputs,outputs:this.outputs,intercept:this.intercept}}static load(t){if("multivariateLinearRegression"!==t.name)throw new Error("not a MLR model");return new s(!0,t)}}e.default=s},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(13),o=r(n(37)),a=r(n(3)),s={lambda:.1,kernelType:"gaussian",kernelOptions:{},computeCoefficient:!1};class u extends a.default{constructor(t,e,n){if(super(),!0===t)this.alpha=e.alpha,this.inputs=e.inputs,this.kernelType=e.kernelType,this.kernelOptions=e.kernelOptions,this.kernel=new o.default(e.kernelType,e.kernelOptions);else{n=Object.assign({},s,n);var r=new o.default(n.kernelType,n.kernelOptions),a=r.compute(t),u=t.length;a.add(i.Matrix.eye(u,u).mul(n.lambda)),this.alpha=(0,i.solve)(a,e),this.inputs=t,this.kernelType=n.kernelType,this.kernelOptions=n.kernelOptions,this.kernel=r}}_predict(t){return this.kernel.compute([t],this.inputs).mmul(this.alpha)[0]}toJSON(){return{name:"kernelRidgeRegression",alpha:this.alpha,inputs:this.inputs,kernelType:this.kernelType,kernelOptions:this.kernelOptions}}static load(t){if("kernelRidgeRegression"!==t.name)throw new TypeError("not a KRR model");return new u(!0,t)}}e.default=u},function(t,e,n){"use strict";var r=n(0).squared,i={sigma:1};t.exports=class{constructor(t){t=Object.assign({},i,t),this.sigma=t.sigma,this.divisor=2*t.sigma*t.sigma}compute(t,e){var n=r(t,e);return o(-n/this.divisor)}}},function(t){"use strict";var e={degree:1,constant:1,scale:1};t.exports=class{constructor(t){t=Object.assign({},e,t),this.degree=t.degree,this.constant=t.constant,this.scale=t.scale}compute(t,e){for(var n=0,r=0;r<t.length;r++)n+=t[r]*e[r];return c(this.scale*n+this.constant,this.degree)}}},function(t){"use strict";var e={sigma:1,degree:1};t.exports=class{constructor(t){t=Object.assign({},e,t),this.sigma=t.sigma,this.degree=t.degree}compute(t,e){for(var n=0,r=v(t.length,e.length),i=1;i<=r;++i)n+=c(o(-this.sigma*c(c(t[i-1],i)-c(e[i-1],i),2)),this.degree);return n}}},function(t,e,n){"use strict";var r=n(0).squared,i={sigma:1};t.exports=class{constructor(t){t=Object.assign({},i,t),this.sigma=t.sigma}compute(t,e){return 1/(1+r(t,e)/(this.sigma*this.sigma))}}},function(t,e,n){"use strict";var r=n(0),i={sigma:1};t.exports=class{constructor(t){t=Object.assign({},i,t),this.sigma=t.sigma,this.divisor=2*t.sigma*t.sigma}compute(t,e){var n=r(t,e);return o(-n/this.divisor)}}},function(t){"use strict";t.exports=class{compute(t,e){for(var n=v(t.length,e.length),r=0,i=0;i<n;++i)r+=v(t[i],e[i]);return r}}},function(t,e,n){"use strict";var r=n(0),i={sigma:1};t.exports=class{constructor(t){t=Object.assign({},i,t),this.sigma=t.sigma}compute(t,e){var n=r(t,e);return o(-n/this.sigma)}}},function(t,e,n){"use strict";var r=n(0).squared,i={constant:1};t.exports=class{constructor(t){t=Object.assign({},i,t),this.constant=t.constant}compute(t,e){return R(r(t,e)+this.constant*this.constant)}}},function(t,e,n){"use strict";var r=n(0).squared,i={constant:1};t.exports=class{constructor(t){t=Object.assign({},i,t),this.constant=t.constant}compute(t,e){var n=r(t,e);return 1-n/(n+this.constant)}}},function(t){"use strict";var e={alpha:.01,constant:-Math.E};t.exports=class{constructor(t){t=Object.assign({},e,t),this.alpha=t.alpha,this.constant=t.constant}compute(t,e){for(var r=0,i=0;i<t.length;i++)r+=t[i]*e[i];return n(this.alpha*r+this.constant)}}},function(t,e,n){"use strict";function r(t,e){for(var n=t.clone(),r=0;r<t.rows;++r)n[r][0]=c(n[r][0],e);return n}function i(t,e){this[t][e]=u(this[t][e])}Object.defineProperty(e,"__esModule",{value:!0});var o=n(13),a=n(3),s=a&&a.__esModule?a:{default:a},l={order:2};class h extends s.default{constructor(t,e,n){super(),!0===t?(this.coefficients=o.Matrix.columnVector(e.coefficients),this.order=e.order,e.r&&(this.r=e.r,this.r2=e.r2),e.chi2&&(this.chi2=e.chi2)):(n=Object.assign({},l,n),this.order=n.order,this.coefficients=[],this.X=t,this.y=e,this.train(this.X,this.y,n))}train(t,e){if(o.Matrix.isMatrix(t)||(t=new o.Matrix(t)),o.Matrix.isMatrix(e)||(e=o.Matrix.columnVector(e)),e.rows!==t.rows&&(e=e.transpose()),2!==t.columns)throw new RangeError("You give X with "+t.columns+" columns and it must be 2");if(t.rows!==e.rows)throw new RangeError("X and y must have the same rows");var n=t.rows,a=(this.order+2)*(this.order+1)/2;this.coefficients=Array(a);var s=t.getColumnVector(0),u=t.getColumnVector(1),l=1/s.clone().apply(i).max(),h=1/u.clone().apply(i).max(),f=1/e.clone().apply(i).max();s.mulColumn(0,l),u.mulColumn(0,h),e.mulColumn(0,f);for(var d,p=new o.Matrix(n,a),m=0,g=0;g<=this.order;++g){d=this.order-g;for(var v,y=0;y<=d;++y)v=r(s,g).mulColumnVector(r(u,y)),p.setColumn(m,v),m++}var w=new o.SVD(p.transpose(),{computeLeftSingularVectors:!0,computeRightSingularVectors:!0,autoTranspose:!1}),b=o.Matrix.rowVector(w.diagonal);b=b.apply(function(t,e){this[t][e]=1e-15<=this[t][e]?1/this[t][e]:0});var x=o.Matrix.zeros(n,a);for(g=0;g<a;++g)x[g][g]=b[0][g];var _=w.rightSingularVectors;for(this.coefficients=w.leftSingularVectors.mmul((b=x).transpose()).mmul(_.transpose()).mmul(e),m=0,g=0;g<=a;++g)for(d=this.order-g,y=0;y<=d;++y)this.coefficients[m][0]=this.coefficients[m][0]*c(l,g)*c(h,y)/f,m++}_predict(t){for(var e=t[0],n=t[1],r=0,i=0,o=0;o<=this.order;o++)for(var a=0;a<=this.order-o;a++)r+=c(e,o)*c(n,a)*this.coefficients[i][0],i++;return r}toJSON(){return{name:"polyfit2D",order:this.order,coefficients:this.coefficients}}static load(t){if("polyfit2D"!==t.name)throw new TypeError("not a polyfit2D model");return new h(!0,t)}}e.default=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=r&&r.__esModule?r:{default:r},o=n(2).array.median;class a extends i.default{constructor(t,e){super(),!0===t?(this.slope=e.slope,this.intercept=e.intercept,this.coefficients=e.coefficients):((0,r.checkArrayLength)(t,e),function(t,e,n){for(var r=e.length,i=Array(r*r),a=0,s=0;s<r;++s)for(var u=s+1;u<r;++u)e[s]!==e[u]&&(i[a++]=(n[u]-n[s])/(e[u]-e[s]));i.length=a;for(var c=o(i),l=Array(r),h=0;h<r;++h)l[h]=n[h]-c*e[h];t.slope=c,t.intercept=o(l),t.coefficients=[t.intercept,t.slope]}(this,t,e))}toJSON(){return{name:"TheilSenRegression",slope:this.slope,intercept:this.intercept}}_predict(t){return this.slope*t+this.intercept}computeX(t){return(t-this.intercept)/this.slope}toString(t){var e="f(x) = ";if(this.slope){var n=(0,r.maybeToPrecision)(this.slope,t);if(e+=(1e-5>u(n-1)?"":n+" * ")+"x",this.intercept){var i=u(this.intercept);e+=" "+(i===this.intercept?"+":"-")+" "+(0,r.maybeToPrecision)(i,t)}}else e+=(0,r.maybeToPrecision)(this.intercept,t);return e}toLaTeX(t){return this.toString(t)}static load(t){if("TheilSenRegression"!==t.name)throw new TypeError("not a Theil-Sen model");return new a(!0,t)}}e.default=a},function(t,e,n){"use strict";function r(t,e){for(var n=t.slice(),r=t.slice(),i=0;i<n.length;i++){r[i]=[t[i].y],n[i]=Array(e.length);for(var o=0;o<e.length;o++)n[i][o]=c(t[i].x,e[o])}return(0,u.solve)(n,r).to1DArray()}function i(t,e,n){for(var r=0,i=0;i<e.length;i++)r+=n[i]*c(t,e[i]);return r}function o(t){t.sort((t,e)=>t.residual-e.residual);var e=t.length,n=g(e/2);return 0==e%2?t[n-1]:t[n]}Object.defineProperty(e,"__esModule",{value:!0});var a=n(3),s=a&&a.__esModule?a:{default:a},u=n(13);class l extends s.default{constructor(t,e,n){super(),!0===t?(this.degree=e.degree,this.powers=e.powers,this.coefficients=e.coefficients):((0,a.checkArrayLength)(t,e),function(t,e,n,a){for(var s=Array(a),u=0;u<a;u++)s[u]=u;for(var c,l=function(t,e,n){for(var r=g(t.length/n),i=Array(r),o=0;o<t.length;o++){for(var a=g(Math.random()*r),s=0;s<t.length;){if(!i[a]){i[a]=[{x:t[o],y:e[o]}];break}if(i[a].length<n){i[a].push({x:t[o],y:e[o]});break}s++,a=(a+1)%r}if(s===t.length)return i}return i}(e,n,a),h=0;h<l.length;h++){for(var f=r(l[h],s),d=e.slice(),p=0;p<e.length;p++)d[p]=n[p]-i(e[p],s,f),d[p]={residual:d[p]*d[p],coefficients:f};var m=o(d);(!c||m.residual<c.residual)&&(c=m)}t.degree=a,t.powers=s,t.coefficients=c.coefficients}(this,t,e,n))}toJSON(){return{name:"robustPolynomialRegression",degree:this.degree,powers:this.powers,coefficients:this.coefficients}}_predict(t){return i(t,this.powers,this.coefficients)}toString(t){return this._toFormula(t,!1)}toLaTeX(t){return this._toFormula(t,!0)}_toFormula(t,e){var n="^",r="",i=" * ";e&&(n="^{",r="}",i="");for(var o="",s="",u=0;u<this.coefficients.length;u++)s="",0!==this.coefficients[u]&&(s=0===this.powers[u]?(0,a.maybeToPrecision)(this.coefficients[u],t):1===this.powers[u]?(0,a.maybeToPrecision)(this.coefficients[u],t)+i+"x":(0,a.maybeToPrecision)(this.coefficients[u],t)+i+"x"+n+this.powers[u]+r,0<this.coefficients[u]&&u!==this.coefficients.length-1?s=" + "+s:u!==this.coefficients.length-1&&(s=" "+s)),o=s+o;return"+"===o.charAt(0)&&(o=o.slice(1)),"f(x) = "+o}static load(t){if("robustPolynomialRegression"!==t.name)throw new TypeError("not a RobustPolynomialRegression model");return new l(!0,t)}}e.default=l},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),o=r(i),a=r(n(58));class s extends o.default{constructor(t,e,n){if(super(),!0===t)this.A=e.A,this.M=e.M;else{if(t.length!==e.length)throw new RangeError("input and output array have a different length");var r=new a.default(t,e,[n]);this.A=r.coefficients[0],this.M=n}}_predict(t){return this.A*c(t,this.M)}toJSON(){return{name:"potentialRegression",A:this.A,M:this.M}}toString(t){return"f(x) = "+(0,i.maybeToPrecision)(this.A,t)+" * x^"+this.M}toLaTeX(t){return 0<=this.M?"f(x) = "+(0,i.maybeToPrecision)(this.A,t)+"x^{"+this.M+"}":"f(x) = \\frac{"+(0,i.maybeToPrecision)(this.A,t)+"}{x^{"+-this.M+"}}"}static load(t){if("potentialRegression"!==t.name)throw new TypeError("not a potential regression model");return new s(!0,t)}}e.default=s},function(t,e,n){"use strict";e.distance=n(146),e.similarity=n(183)},function(t,e,n){"use strict";e.additiveSymmetric=n(147),e.avg=n(148),e.bhattacharyya=n(149),e.canberra=n(150),e.chebyshev=n(151),e.clark=n(152),e.czekanowski=n(153),e.dice=n(60),e.divergence=n(154),e.euclidean=n(0),e.fidelity=n(155),e.gower=n(156),e.harmonicMean=n(157),e.hellinger=n(158),e.innerProduct=n(159),e.intersection=n(61),e.jaccard=n(62),e.jeffreys=n(160),e.jensenDifference=n(161),e.jensenShannon=n(162),e.kdivergence=n(163),e.kulczynski=n(63),e.kullbackLeibler=n(164),e.kumarHassebrook=n(165),e.kumarJohnson=n(166),e.lorentzian=n(167),e.manhattan=n(168),e.matusita=n(169),e.minkowski=n(170),e.motyka=n(64),e.neyman=n(171),e.pearson=n(172),e.probabilisticSymmetric=n(173),e.ruzicka=n(174),e.soergel=n(175),e.sorensen=n(176),e.squared=n(177),e.squaredChord=n(65),e.squaredEuclidean=n(0).squared,e.taneja=n(178),e.tanimoto=n(179),e.topsoe=n(180),e.tree=n(181),e.waveHedges=n(182)},function(t){"use strict";t.exports=function(t,e){for(var n=0,r=t.length,i=0;n<r;n++)i+=(t[n]-e[n])*(t[n]-e[n])*(t[n]+e[n])/(t[n]*e[n]);return 2*i}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,r=0,i=0,o=0,a=0;a<n;a++)i+=o=u(t[a]-e[a]),r<o&&(r=o);return(r+i)/2}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,i=0,o=0;o<n;o++)i+=R(t[o]*e[o]);return-r(i)}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,r=0,i=0;i<n;i++)r+=u(t[i]-e[i])/(t[i]+e[i]);return r}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,r=0,i=0,o=0;o<n;o++)r<(i=u(t[o]-e[o]))&&(r=i);return r}},function(t){"use strict";t.exports=function(t,e){for(var n=0,r=t.length,i=0;n<r;n++)i+=R((t[n]-e[n])*(t[n]-e[n])/((t[n]+e[n])*(t[n]+e[n])));return 2*i}},function(t,e,n){"use strict";var r=n(59);t.exports=function(t,e){return 1-r(t,e)}},function(t){"use strict";t.exports=function(t,e){for(var n=0,r=t.length,i=0;n<r;n++)i+=(t[n]-e[n])*(t[n]-e[n])/((t[n]+e[n])*(t[n]+e[n]));return 2*i}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,r=0,i=0;i<n;i++)r+=R(t[i]*e[i]);return r}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,r=0,i=0;i<n;i++)r+=u(t[i]-e[i]);return r/n}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,r=0,i=0;i<n;i++)r+=t[i]*e[i]/(t[i]+e[i]);return 2*r}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,r=0,i=0;i<n;i++)r+=R(t[i]*e[i]);return 2*R(1-r)}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,r=0,i=0;i<n;i++)r+=t[i]*e[i];return r}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,i=0,o=0;o<n;o++)i+=(t[o]-e[o])*r(t[o]/e[o]);return i}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,i=0,o=0;o<n;o++)i+=(t[o]*r(t[o])+e[o]*r(e[o]))/2-(t[o]+e[o])/2*r((t[o]+e[o])/2);return i}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,i=0,o=0,a=0;a<n;a++)i+=t[a]*r(2*t[a]/(t[a]+e[a])),o+=e[a]*r(2*e[a]/(t[a]+e[a]));return(i+o)/2}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,i=0,o=0;o<n;o++)i+=t[o]*r(2*t[o]/(t[o]+e[o]));return i}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,i=0,o=0;o<n;o++)i+=t[o]*r(t[o]/e[o]);return i}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,r=0,i=0,o=0,a=0;a<n;a++)r+=t[a]*e[a],i+=t[a]*t[a],o+=e[a]*e[a];return r/(i+o-r)}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,r=0,i=0;i<n;i++)r+=c(t[i]*t[i]-e[i]*e[i],2)/(2*c(t[i]*e[i],1.5));return r}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,i=0,o=0;o<n;o++)i+=r(u(t[o]-e[o])+1);return i}},function(t){"use strict";t.exports=function(t,e){for(var n=0,r=t.length,i=0;n<r;n++)i+=u(t[n]-e[n]);return i}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,r=0,i=0;i<n;i++)r+=R(t[i]*e[i]);return R(2-2*r)}},function(t){"use strict";t.exports=function(t,e,n){for(var r=0,i=t.length,o=0;r<i;r++)o+=c(u(t[r]-e[r]),n);return c(o,1/n)}},function(t){"use strict";t.exports=function(t,e){for(var n=0,r=t.length,i=0;n<r;n++)i+=(t[n]-e[n])*(t[n]-e[n])/t[n];return i}},function(t){"use strict";t.exports=function(t,e){for(var n=0,r=t.length,i=0;n<r;n++)i+=(t[n]-e[n])*(t[n]-e[n])/e[n];return i}},function(t){"use strict";t.exports=function(t,e){for(var n=0,r=t.length,i=0;n<r;n++)i+=(t[n]-e[n])*(t[n]-e[n])/(t[n]+e[n]);return 2*i}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,r=0,i=0,o=0;o<n;o++)r+=v(t[o],e[o]),i+=M(t[o],e[o]);return r/i}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,r=0,i=0,o=0;o<n;o++)r+=u(t[o]-e[o]),i+=M(t[o],e[o]);return r/i}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,r=0,i=0,o=0;o<n;o++)r+=u(t[o]-e[o]),i+=t[o]+e[o];return r/i}},function(t){"use strict";t.exports=function(t,e){for(var n=0,r=t.length,i=0;n<r;n++)i+=(t[n]-e[n])*(t[n]-e[n])/(t[n]+e[n]);return i}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,i=0,o=0;o<n;o++)i+=(t[o]+e[o])/2*r((t[o]+e[o])/(2*R(t[o]*e[o])));return i}},function(t,e,n){"use strict";var r=n(66);t.exports=function(t,e,n){if(n)return 1-r(t,e,n);for(var i=t.length,o=0,a=0,s=0,u=0;u<i;u++)o+=t[u],a+=e[u],s+=v(t[u],e[u]);return(o+a-2*s)/(o+a-s)}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,i=0,o=0;o<n;o++)i+=t[o]*r(2*t[o]/(t[o]+e[o]))+e[o]*r(2*e[o]/(t[o]+e[o]));return i}},function(t){"use strict";function e(t,n,r,i,o,a){if(o=o||.16,a=a||.01,!(i-r<o)){for(var s=0,u=0;t[u]<i;u++)t[u]>r&&(s+=n[u]);if(!(s<a)){for(var c=0,l=0;t[l]<i;l++)t[u]>r&&(c+=t[l]*n[l]);return 1e-5>(c/=s)-r||1e-5>i-c?void 0:c-r<o/4?e(t,n,c,i,o,a):i-c<o/4?e(t,n,r,c,o,a):{sum:s,center:c,left:e(t,n,r,c,o,a),right:e(t,n,c,i,o,a)}}}}var n={minWindow:.16,threshold:.01,alpha:.1,beta:.33,gamma:.001};t.exports={calc:function(t,r,i,a,s){for(var c in s=s||{},n)s.hasOwnProperty(c)||(s[c]=n[c]);return function t(e,n,r,i,a){return void 0===e||void 0===n?0:i*(r*v(e.sum,n.sum)/M(e.sum,n.sum)+(1-r)*o(-a*u(e.center-n.center)))+(1-i)*(t(e.left,n.left,r,i,a)+t(e.right,n.right,r,i,a))}(t.sum?t:e(t.x,t.y,i,a,s.minWindow,s.threshold),r.sum?r:e(r.x,r.y,i,a,s.minWindow,s.threshold),s.alpha,s.beta,s.gamma)},createTree:e}},function(t){"use strict";t.exports=function(t,e){for(var n=t.length,r=0,i=0;i<n;i++)r+=1-v(t[i],e[i])/M(t[i],e[i]);return r}},function(t,e,n){"use strict";e.cosine=n(67),e.czekanowski=n(59),e.dice=n(184),e.intersection=n(185),e.jaccard=n(186),e.kulczynski=n(187),e.motyka=n(188),e.pearson=n(189),e.squaredChord=n(190),e.tanimoto=n(66)},function(t,e,n){"use strict";var r=n(60);t.exports=function(t,e){return 1-r(t,e)}},function(t,e,n){"use strict";var r=n(61);t.exports=function(t,e){return 1-r(t,e)}},function(t,e,n){"use strict";var r=n(62);t.exports=function(t,e){return 1-r(t,e)}},function(t,e,n){"use strict";var r=n(63);t.exports=function(t,e){return 1/r(t,e)}},function(t,e,n){"use strict";var r=n(64);t.exports=function(t,e){return 1-r(t,e)}},function(t,e,n){"use strict";var r=n(2).array,i=n(67);t.exports=function(t,e){for(var n=r.mean(t),o=r.mean(e),a=Array(t.length),s=Array(e.length),u=0;u<a.length;u++)a[u]=t[u]-n,s[u]=e[u]-o;return i(a,s)}},function(t,e,n){"use strict";var r=n(65);t.exports=function(t,e){return 1-r(t,e)}},function(t,e,n){"use strict";var r=n(192),i=n(57),o=n(35),a={windowSize:5,derivative:1,polynomial:2,pad:"none",padValue:"replicate"};t.exports=function(t,e,n){if(0==(n=o({},a,n)).windowSize%2||5>n.windowSize||!m(n.windowSize))throw new RangeError("Invalid window size (should be odd and at least 5 integer number)");if(0>n.derivative||!m(n.derivative))throw new RangeError("Derivative should be a positive integer");if(1>n.polynomial||!m(n.polynomial))throw new RangeError("Polynomial should be a positive integer");var s,u,l=g(n.windowSize/2);"pre"===n.pad&&(t=i(t,{size:l,value:n.padValue}));var h=Array(t.length-2*l);if(5!==n.windowSize||2!==n.polynomial||1!==n.derivative&&2!==n.derivative){for(var f=r.ones(n.windowSize,n.polynomial+1),d=-(n.windowSize-1)/2,p=0;p<f.length;p++)for(var v=0;v<f[p].length;v++)(0!=d+1||0!==v)&&(f[p][v]=c(d+p,v));var y=f.transposeView();s=(s=y.mmul(f).inverse().mmul(y))[n.derivative],u=1}else 1===n.derivative?(s=[-2,-1,0,1,2],u=10):(s=[2,-1,-2,-1,2],u=7);for(var w,b=u*c(e,n.derivative),x=l;x<t.length-l;x++){w=0;for(var _=0;_<s.length;_++)w+=s[_]*t[_+x-l]/b;h[x-l]=w}return"post"===n.pad&&(h=i(h,{size:l,value:n.padValue})),h}},function(t,e,n){"use strict";t.exports=n(5).Matrix,t.exports.Decompositions=t.exports.DC=n(201)},function(){"use strict";Symbol.species||(Symbol.species=Symbol.for("@@species"))},function(t,e,n){"use strict";var r=n(15);t.exports=class extends r{constructor(t){super(t,t.columns,t.rows)}set(t,e,n){return this.matrix.set(e,t,n),this}get(t,e){return this.matrix.get(e,t)}}},function(t,e,n){"use strict";var r=n(15);t.exports=class extends r{constructor(t,e){super(t,1,t.columns),this.row=e}set(t,e,n){return this.matrix.set(this.row,e,n),this}get(t,e){return this.matrix.get(this.row,e)}}},function(t,e,n){"use strict";var r=n(15),i=n(24);t.exports=class extends r{constructor(t,e,n,r,o){i.checkRange(t,e,n,r,o),super(t,n-e+1,o-r+1),this.startRow=e,this.startColumn=r}set(t,e,n){return this.matrix.set(this.startRow+t,this.startColumn+e,n),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}}},function(t,e,n){"use strict";var r=n(15),i=n(24);t.exports=class extends r{constructor(t,e,n){var r=i.checkIndices(t,e,n);super(t,r.row.length,r.column.length),this.rowIndices=r.row,this.columnIndices=r.column}set(t,e,n){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],n),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}},function(t,e,n){"use strict";var r=n(15);t.exports=class extends r{constructor(t,e){super(t,t.rows,1),this.column=e}set(t,e,n){return this.matrix.set(t,this.column,n),this}get(t){return this.matrix.get(t,this.column)}}},function(t,e,n){"use strict";var r=n(15);t.exports=class extends r{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(this.rows-t-1,e,n),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}}},function(t,e,n){"use strict";var r=n(15);t.exports=class extends r{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(t,this.columns-e-1,n),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}}},function(t,e,n){"use strict";function r(t){return i(t=o.checkMatrix(t),o.eye(t.rows))}function i(t,e){return t=o.checkMatrix(t),e=o.checkMatrix(e),t.isSquare()?new u(t).solve(e):new c(t).solve(e)}var o=n(5).Matrix,a=n(71),s=n(202),u=n(70),c=n(203),l=n(204);o.inverse=o.inv=r,o.prototype.inverse=o.prototype.inv=function(){return r(this)},o.solve=i,o.prototype.solve=function(t){return i(this,t)},t.exports={SingularValueDecomposition:a,SVD:a,EigenvalueDecomposition:s,EVD:s,LuDecomposition:u,LU:u,QrDecomposition:c,QR:c,CholeskyDecomposition:l,CHO:l,inverse:r,solve:i}},function(t,e,n){"use strict";function r(t,e){if(e=Object.assign({},p,e),!(this instanceof r))return new r(t,e);if(!(t=l.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");var n,u,c=t.columns,h=d(c,c,0),f=Array(c),m=Array(c),g=t;if(e.assumeSymmetric||t.isSymmetric()){for(n=0;n<c;n++)for(u=0;u<c;u++)h[n][u]=g.get(n,u);i(c,m,f,h),o(c,m,f,h)}else{var v=d(c,c,0),y=Array(c);for(u=0;u<c;u++)for(n=0;n<c;n++)v[n][u]=g.get(n,u);a(c,v,y,h),s(c,m,f,h,v)}this.n=c,this.e=m,this.d=f,this.V=h}function i(t,e,n,r){var i,o,a,s,c,l,h,f;for(c=0;c<t;c++)n[c]=r[t-1][c];for(s=t-1;0<s;s--){for(f=0,a=0,l=0;l<s;l++)f+=u(n[l]);if(0===f)for(e[s]=n[s-1],c=0;c<s;c++)n[c]=r[s-1][c],r[s][c]=0,r[c][s]=0;else{for(l=0;l<s;l++)n[l]/=f,a+=n[l]*n[l];for(i=n[s-1],o=R(a),0<i&&(o=-o),e[s]=f*o,a-=i*o,n[s-1]=i-o,c=0;c<s;c++)e[c]=0;for(c=0;c<s;c++){for(r[c][s]=i=n[c],o=e[c]+r[c][c]*i,l=c+1;l<=s-1;l++)o+=r[l][c]*n[l],e[l]+=r[l][c]*i;e[c]=o}for(i=0,c=0;c<s;c++)e[c]/=a,i+=e[c]*n[c];for(h=i/(a+a),c=0;c<s;c++)e[c]-=h*n[c];for(c=0;c<s;c++){for(i=n[c],o=e[c],l=c;l<=s-1;l++)r[l][c]-=i*e[l]+o*n[l];n[c]=r[s-1][c],r[s][c]=0}}n[s]=a}for(s=0;s<t-1;s++){if(r[t-1][s]=r[s][s],r[s][s]=1,0!==(a=n[s+1])){for(l=0;l<=s;l++)n[l]=r[l][s+1]/a;for(c=0;c<=s;c++){for(o=0,l=0;l<=s;l++)o+=r[l][s+1]*r[l][c];for(l=0;l<=s;l++)r[l][c]-=o*n[l]}}for(l=0;l<=s;l++)r[l][s+1]=0}for(c=0;c<t;c++)n[c]=r[t-1][c],r[t-1][c]=0;r[t-1][t-1]=1,e[0]=0}function o(t,e,n,r){var i,o,a,s,c,l,h,d,p,m,g,v,y,w,b,x;for(a=1;a<t;a++)e[a-1]=e[a];e[t-1]=0;var _=0,E=0,S=2.220446049250313e-16;for(l=0;l<t;l++){for(E=M(E,u(n[l])+u(e[l])),h=l;h<t&&!(u(e[h])<=S*E);)h++;if(h>l)do{for(p=f(d=(n[l+1]-(i=n[l]))/(2*e[l]),1),0>d&&(p=-p),n[l]=e[l]/(d+p),n[l+1]=e[l]*(d+p),m=n[l+1],o=i-n[l],a=l+2;a<t;a++)n[a]-=o;for(_+=o,d=n[h],v=g=1,y=g,w=e[l+1],b=0,x=0,a=h-1;a>=l;a--)for(y=v,v=g,x=b,i=g*e[a],o=g*d,p=f(d,e[a]),e[a+1]=b*p,d=(g=d/p)*n[a]-(b=e[a]/p)*i,n[a+1]=o+b*(g*i+b*n[a]),c=0;c<t;c++)r[c][a+1]=b*r[c][a]+g*(o=r[c][a+1]),r[c][a]=g*r[c][a]-b*o;e[l]=b*(d=-b*x*y*w*e[l]/m),n[l]=g*d}while(u(e[l])>S*E);n[l]+=_,e[l]=0}for(a=0;a<t-1;a++){for(c=a,d=n[a],s=a+1;s<t;s++)n[s]<d&&(c=s,d=n[s]);if(c!==a)for(n[c]=n[a],n[a]=d,s=0;s<t;s++)d=r[s][a],r[s][a]=r[s][c],r[s][c]=d}}function a(t,e,n,r){var i,o,a,s,c,l,h,f=t-1;for(l=1;l<=f-1;l++){for(h=0,s=l;s<=f;s++)h+=u(e[s][l-1]);if(0!==h){for(a=0,s=f;s>=l;s--)n[s]=e[s][l-1]/h,a+=n[s]*n[s];for(o=R(a),0<n[l]&&(o=-o),a-=n[l]*o,n[l]-=o,c=l;c<t;c++){for(i=0,s=f;s>=l;s--)i+=n[s]*e[s][c];for(i/=a,s=l;s<=f;s++)e[s][c]-=i*n[s]}for(s=0;s<=f;s++){for(i=0,c=f;c>=l;c--)i+=n[c]*e[s][c];for(i/=a,c=l;c<=f;c++)e[s][c]-=i*n[c]}n[l]=h*n[l],e[l][l-1]=h*o}}for(s=0;s<t;s++)for(c=0;c<t;c++)r[s][c]=s===c?1:0;for(l=f-1;l>=1;l--)if(0!==e[l][l-1]){for(s=l+1;s<=f;s++)n[s]=e[s][l-1];for(c=l;c<=f;c++){for(o=0,s=l;s<=f;s++)o+=n[s]*r[s][c];for(o=o/n[l]/e[l][l-1],s=l;s<=f;s++)r[s][c]+=o*n[s]}}}function s(t,e,n,r,i){var o,a,s,l,h,f,d,p,m,g,y,w,b,x,_,E=t-1,S=t-1,T=2.220446049250313e-16,A=0,k=0,C=0,D=0,L=0,O=0,P=0,I=0;for(o=0;o<t;o++)for((o<0||o>S)&&(n[o]=i[o][o],e[o]=0),a=M(o-1,0);a<t;a++)k+=u(i[o][a]);for(;E>=0;){for(l=E;l>0&&(0===(O=u(i[l-1][l-1])+u(i[l][l]))&&(O=k),!(u(i[l][l-1])<T*O));)l--;if(l===E)i[E][E]+=A,n[E]=i[E][E],e[E]=0,E--,I=0;else if(l===E-1){if(P=R(u(D=(C=(i[E-1][E-1]-i[E][E])/2)*C+(d=i[E][E-1]*i[E-1][E]))),i[E][E]+=A,i[E-1][E-1]=i[E-1][E-1]+A,p=i[E][E],0<=D){for(n[E-1]=p+(P=0<=C?C+P:C-P),n[E]=n[E-1],0!==P&&(n[E]=p-d/P),e[E-1]=0,e[E]=0,C=(p=i[E][E-1])/(O=u(p)+u(P)),C/=L=R(C*C+(D=P/O)*D),D/=L,a=E-1;a<t;a++)i[E-1][a]=D*(P=i[E-1][a])+C*i[E][a],i[E][a]=D*i[E][a]-C*P;for(o=0;o<=E;o++)i[o][E-1]=D*(P=i[o][E-1])+C*i[o][E],i[o][E]=D*i[o][E]-C*P;for(o=0;o<=S;o++)r[o][E-1]=D*(P=r[o][E-1])+C*r[o][E],r[o][E]=D*r[o][E]-C*P}else n[E-1]=p+C,n[E]=p+C,e[E-1]=P,e[E]=-P;E-=2,I=0}else{if(p=i[E][E],m=0,d=0,l<E&&(m=i[E-1][E-1],d=i[E][E-1]*i[E-1][E]),10==I){for(A+=p,o=0;o<=E;o++)i[o][o]-=p;p=m=.75*(O=u(i[E][E-1])+u(i[E-1][E-2])),d=-.4375*O*O}if(30==I&&0<(O=(O=(m-p)/2)*O+d)){for(O=R(O),m<p&&(O=-O),O=p-d/((m-p)/2+O),o=0;o<=E;o++)i[o][o]-=O;A+=O,p=m=d=.964}for(++I,h=E-2;h>=l&&(C=((L=p-(P=i[h][h]))*(O=m-P)-d)/i[h+1][h]+i[h][h+1],D=i[h+1][h+1]-P-L-O,L=i[h+2][h+1],C/=O=u(C)+u(D)+u(L),D/=O,L/=O,h!==l)&&!(u(i[h][h-1])*(u(D)+u(L))<T*(u(C)*(u(i[h-1][h-1])+u(P)+u(i[h+1][h+1]))));)h--;for(o=h+2;o<=E;o++)i[o][o-2]=0,o>h+2&&(i[o][o-3]=0);for(s=h;s<=E-1&&(x=s!==E-1,s!==h&&(C=i[s][s-1],D=i[s+1][s-1],L=x?i[s+2][s-1]:0,0!==(p=u(C)+u(D)+u(L))&&(C/=p,D/=p,L/=p)),0!==p);s++)if(O=R(C*C+D*D+L*L),0>C&&(O=-O),0!==O){for(s===h?l!==h&&(i[s][s-1]=-i[s][s-1]):i[s][s-1]=-O*p,p=(C+=O)/O,m=D/O,P=L/O,D/=C,L/=C,a=s;a<t;a++)C=i[s][a]+D*i[s+1][a],x&&(i[s+2][a]=i[s+2][a]-(C+=L*i[s+2][a])*P),i[s][a]-=C*p,i[s+1][a]=i[s+1][a]-C*m;for(o=0;o<=v(E,s+3);o++)C=p*i[o][s]+m*i[o][s+1],x&&(i[o][s+2]=i[o][s+2]-(C+=P*i[o][s+2])*L),i[o][s]-=C,i[o][s+1]=i[o][s+1]-C*D;for(o=0;o<=S;o++)C=p*r[o][s]+m*r[o][s+1],x&&(r[o][s+2]=r[o][s+2]-(C+=P*r[o][s+2])*L),r[o][s]-=C,r[o][s+1]=r[o][s+1]-C*D}}}if(0!==k){for(E=t-1;0<=E;E--)if(C=n[E],0===(D=e[E]))for(l=E,i[E][E]=1,o=E-1;0<=o;o--){for(d=i[o][o]-C,L=0,a=l;a<=E;a++)L+=i[o][a]*i[a][E];if(0>e[o])P=d,O=L;else if(l=o,0===e[o]?i[o][E]=0===d?-L/(T*k):-L/d:(m=i[o+1][o],i[o][E]=f=((p=i[o][o+1])*O-P*L)/(D=(n[o]-C)*(n[o]-C)+e[o]*e[o]),i[o+1][E]=u(p)>u(P)?(-L-d*f)/p:(-O-m*f)/P),1<T*(f=u(i[o][E]))*f)for(a=o;a<=E;a++)i[a][E]/=f}else if(0>D)for(l=E-1,u(i[E][E-1])>u(i[E-1][E])?(i[E-1][E-1]=D/i[E][E-1],i[E-1][E]=-(i[E][E]-C)/i[E][E-1]):(_=c(0,-i[E-1][E],i[E-1][E-1]-C,D),i[E-1][E-1]=_[0],i[E-1][E]=_[1]),i[E][E-1]=0,i[E][E]=1,o=E-2;0<=o;o--){for(g=0,y=0,a=l;a<=E;a++)g+=i[o][a]*i[a][E-1],y+=i[o][a]*i[a][E];if(d=i[o][o]-C,0>e[o])P=d,L=g,O=y;else if(l=o,0===e[o]?(_=c(-g,-y,d,D),i[o][E-1]=_[0],i[o][E]=_[1]):(p=i[o][o+1],m=i[o+1][o],b=2*(n[o]-C)*D,0==(w=(n[o]-C)*(n[o]-C)+e[o]*e[o]-D*D)&&0===b&&(w=T*k*(u(d)+u(D)+u(p)+u(m)+u(P))),_=c(p*L-P*g+D*y,p*O-P*y-D*g,w,b),i[o][E-1]=_[0],i[o][E]=_[1],u(p)>u(P)+u(D)?(i[o+1][E-1]=(-g-d*i[o][E-1]+D*i[o][E])/p,i[o+1][E]=(-y-d*i[o][E]-D*i[o][E-1])/p):(_=c(-L-m*i[o][E-1],-O-m*i[o][E],P,D),i[o+1][E-1]=_[0],i[o+1][E]=_[1])),1<T*(f=M(u(i[o][E-1]),u(i[o][E])))*f)for(a=o;a<=E;a++)i[a][E-1]=i[a][E-1]/f,i[a][E]/=f}for(o=0;o<t;o++)if(o<0||o>S)for(a=o;a<t;a++)r[o][a]=i[o][a];for(a=t-1;a>=0;a--)for(o=0;o<=S;o++){for(P=0,s=0;s<=v(a,S);s++)P+=r[o][s]*i[s][a];r[o][a]=P}}}function c(t,e,n,r){var i,o;return u(n)>u(r)?[(t+(i=r/n)*e)/(o=n+i*r),(e-i*t)/o]:[((i=n/r)*t+e)/(o=r+i*n),(i*e-t)/o]}var l=n(5).Matrix,h=n(38),f=h.hypotenuse,d=h.getFilled2DArray,p={assumeSymmetric:!1};r.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return l.isMatrix(this.V)||(this.V=new l(this.V)),this.V},get diagonalMatrix(){var t,e,n=this.n,r=this.e,i=this.d,o=new l(n,n);for(t=0;t<n;t++){for(e=0;e<n;e++)o[t][e]=0;o[t][t]=i[t],0<r[t]?o[t][t+1]=r[t]:0>r[t]&&(o[t][t-1]=r[t])}return o}},t.exports=r},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);var e,n,a,s,u=(t=i.checkMatrix(t)).clone(),c=t.rows,l=t.columns,h=Array(l);for(a=0;a<l;a++){var f=0;for(e=a;e<c;e++)f=o(f,u[e][a]);if(0!==f){for(0>u[a][a]&&(f=-f),e=a;e<c;e++)u[e][a]/=f;for(u[a][a]+=1,n=a+1;n<l;n++){for(s=0,e=a;e<c;e++)s+=u[e][a]*u[e][n];for(s=-s/u[a][a],e=a;e<c;e++)u[e][n]+=s*u[e][a]}}h[a]=-f}this.QR=u,this.Rdiag=h}var i=n(5).Matrix,o=n(38).hypotenuse;r.prototype={solve:function(t){t=i.checkMatrix(t);var e=this.QR,n=e.rows;if(t.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var r,o,a,s,u=t.columns,c=t.clone(),l=e.columns;for(a=0;a<l;a++)for(o=0;o<u;o++){for(s=0,r=a;r<n;r++)s+=e[r][a]*c[r][o];for(s=-s/e[a][a],r=a;r<n;r++)c[r][o]+=s*e[r][a]}for(a=l-1;0<=a;a--){for(o=0;o<u;o++)c[a][o]/=this.Rdiag[a];for(r=0;r<a;r++)for(o=0;o<u;o++)c[r][o]-=c[a][o]*e[r][a]}return c.subMatrix(0,l-1,0,u-1)},isFullRank:function(){for(var t=this.QR.columns,e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0},get upperTriangularMatrix(){var t,e,n=this.QR,r=n.columns,o=new i(r,r);for(t=0;t<r;t++)for(e=0;e<r;e++)o[t][e]=t<e?n[t][e]:t===e?this.Rdiag[t]:0;return o},get orthogonalMatrix(){var t,e,n,r,o=this.QR,a=o.rows,s=o.columns,u=new i(a,s);for(n=s-1;0<=n;n--){for(t=0;t<a;t++)u[t][n]=0;for(u[n][n]=1,e=n;e<s;e++)if(0!==o[n][n]){for(r=0,t=n;t<a;t++)r+=o[t][n]*u[t][e];for(r=-r/o[n][n],t=n;t<a;t++)u[t][e]+=r*o[t][n]}}return u}},t.exports=r},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);if(!(t=i.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");var e,n,o,a=t,s=a.rows,u=new i(s,s),c=!0;for(n=0;n<s;n++){var l=u[n],h=0;for(o=0;o<n;o++){var f=u[o],d=0;for(e=0;e<o;e++)d+=f[e]*l[e];l[o]=d=(a[n][o]-d)/u[o][o],h+=d*d}for(c&=0<(h=a[n][n]-h),u[n][n]=R(M(h,0)),o=n+1;o<s;o++)u[n][o]=0}if(!c)throw new Error("Matrix is not positive definite");this.L=u}var i=n(5).Matrix;r.prototype={get lowerTriangularMatrix(){return this.L},solve:function(t){t=i.checkMatrix(t);var e=this.L,n=e.rows;if(t.rows!==n)throw new Error("Matrix dimensions do not match");var r,o,a,s=t.columns,u=t.clone();for(a=0;a<n;a++)for(o=0;o<s;o++){for(r=0;r<a;r++)u[a][o]-=u[r][o]*e[a][r];u[a][o]/=e[a][a]}for(a=n-1;0<=a;a--)for(o=0;o<s;o++){for(r=a+1;r<n;r++)u[a][o]-=u[r][o]*e[r][a];u[a][o]/=e[a][a]}return u}},t.exports=r},function(t,e,n){"use strict";function r(t,e,n,r){for(var i=0,o=0,a=e-n;a<e+n;a++)0<=a&&a<t.length-1&&(i+=t[a+1]-t[a],o++);return c(i/o,r)}function i(t,e,n,r){return 0<n?(4*n-2)/(n*(2*e-n+1))*(t*i(t,e,n-1,r)+r*i(t,e,n-1,r-1))-(n-1)*(2*e+n)/(n*(2*e-n+1))*i(t,e,n-2,r):0==n&&0==r?1:0}function o(t,e){var n=1;if(t>=e)for(var r=t-e+1;r<=t;r++)n*=r;return n}function a(t,e,n,r,a){for(var s=0,u=0;u<=r;u++)s+=(2*u+1)*(o(2*n,u)/o(2*n+u+1,u+1))*i(t,n,u,0)*i(e,n,u,a);return s}function s(t,e,n){for(var r=Array(t),i=g(t/2),o=-i;o<=i;o++){r[o+i]=Array(t);for(var s=-i;s<=i;s++)r[o+i][s+i]=a(s,o,i,e,n)}return r}var u=n(35),l=(n(206),{windowSize:9,derivative:0,polynomial:3});t.exports=function(t,e,n){if(0==(n=u({},l,n)).windowSize%2||5>n.windowSize||!m(n.windowSize))throw new RangeError("Invalid window size (should be odd and at least 5 integer number)");if(n.windowSize>t.length)throw new RangeError("Window size is higher than the data length "+n.windowSize+">"+t.length);if(0>n.derivative||!m(n.derivative))throw new RangeError("Derivative should be a positive integer");if(1>n.polynomial||!m(n.polynomial))throw new RangeError("Polynomial should be a positive integer");6<=n.polynomial&&console.warn("You should not use polynomial grade higher than 5 if you are not sure that your data arises from such a model. Possible polynomial oscillation problems");var i=n.windowSize,o=g(i/2),a=t.length,h=Array(a),f=s(i,n.polynomial,n.derivative),d=0,p=!0;"[object Array]"===Object.prototype.toString.call(e)?p=!1:d=c(e,n.derivative);for(var v=0;v<o;v++){for(var y=f[o-v-1],w=f[o+v+1],b=0,x=0,_=0;_<i;_++)b+=y[_]*t[_],x+=w[_]*t[a-i+_-1];p?(h[o-v-1]=b/d,h[a-o+v]=x/d):(d=r(e,o-v-1,o,n.derivative),h[o-v-1]=b/d,d=r(e,a-o+v,o,n.derivative),h[a-o+v]=x/d)}var M,E=f[o];for(v=i;v<a+1;v++){for(M=0,_=0;_<i;_++)M+=E[_]*t[_+v-i];p||(d=r(e,v-o-1,o,n.derivative)),h[v-o-1]=M/d}return h}},function(t,e,n){"use strict";e.array=n(72),e.matrix=n(207)},function(t,e,n){"use strict";function i(t,e){"undefined"==typeof e&&(e=0);var n,r,i,o,a=t.length,s=t[0].length;if(-1===e){for(n=[0],r=a*s,i=0;i<a;i++)for(o=0;o<s;o++)n[0]+=t[i][o];n[0]/=r}else if(0===e)for(n=Array(s),r=a,o=0;o<s;o++){for(n[o]=0,i=0;i<a;i++)n[o]+=t[i][o];n[o]/=r}else{if(1!==e)throw new Error("Invalid dimension");for(n=Array(a),r=s,o=0;o<a;o++){for(n[o]=0,i=0;i<s;i++)n[o]+=t[o][i];n[o]/=r}}return n}function o(t,e,n){for(var r=a(t,e,n),i=r.length,o=0;o<i;o++)r[o]=R(r[o]);return r}function a(t,e,n){"undefined"==typeof n&&(n=!0),e=e||i(t);var r=t.length;if(0===r)return[];for(var o=t[0].length,a=Array(o),s=0;s<o;s++){for(var u=0,c=0,l=0,h=0;h<r;h++)u+=l=t[h][s]-e[s],c+=l*l;a[s]=n?(c-u*u/r)/(r-1):(c-u*u/r)/r}return a}function s(t,e,n){"undefined"==typeof n&&(n=0),"undefined"==typeof e&&(0===n?e=t.length-1:1===n&&(e=t[0].length-1));var r=i(t,n),o=t.length;if(0===o)return[[]];var a,s,u,c,l,h=t[0].length;if(0===n){for(a=Array(h),s=0;s<h;s++)a[s]=Array(h);for(s=0;s<h;s++)for(u=s;u<h;u++){for(c=0,l=0;l<o;l++)c+=(t[l][u]-r[u])*(t[l][s]-r[s]);a[s][u]=c/=e,a[u][s]=c}}else{if(1!==n)throw new Error("Invalid dimension");for(a=Array(o),s=0;s<o;s++)a[s]=Array(o);for(s=0;s<o;s++)for(u=s;u<o;u++){for(c=0,l=0;l<h;l++)c+=(t[u][l]-r[u])*(t[s][l]-r[s]);a[s][u]=c/=e,a[u][s]=c}}return a}function u(t,e,n){return e=e||i(t),"undefined"==typeof n&&(n=o(t,!0,e)),h(l(t,e,!1),n,!0)}function l(t,e,n){e=e||i(t);var r,o,a,s=t,u=t.length;if(!n)for(s=Array(u),r=0;r<u;r++)s[r]=Array(t[r].length);for(r=0;r<u;r++){var c=s[r];for(o=0,a=c.length;o<a;o++)c[o]=t[r][o]-e[o]}return s}function h(t,e,n){"undefined"==typeof e&&(e=o(t));var r,i,a,s=t,u=t.length;if(!n)for(s=Array(u),r=0;r<u;r++)s[r]=Array(t[r].length);for(r=0;r<u;r++){var c=s[r],l=t[r];for(i=0,a=c.length;i<a;i++)0===e[i]||isNaN(e[i])||(c[i]=l[i]/e[i])}return s}function f(t,e,n){"undefined"==typeof n&&(n=0);var r=t.length;if(0===r)return[];var i,o,a,s,u,c,l=t[0].length;if(0===n){for(i=Array(l),o=0;o<l;o++)i[o]=0;for(o=0;o<r;o++)for(c=t[o],u=e[o],s=0;s<l;s++)i[s]+=c[s]*u}else{if(1!==n)throw new Error("Invalid dimension");for(i=Array(r),o=0;o<r;o++)i[o]=0;for(s=0;s<r;s++)for(c=t[s],u=e[s],o=0;o<l;o++)i[s]+=c[o]*u}var h=p.sum(e);if(0!==h)for(o=0,a=i.length;o<a;o++)i[o]/=h;return i}function d(t,e,n,r,i){i=i||0,n=n||f(t,e,i),"undefined"==typeof r&&(r=1);var o=t.length;if(0===o)return[[]];var a,s,u,c,l,h=t[0].length;if(0===i){for(a=Array(h),s=0;s<h;s++)a[s]=Array(h);for(s=0;s<h;s++)for(u=s;u<h;u++){for(l=0,c=0;c<o;c++)l+=e[c]*(t[c][u]-n[u])*(t[c][s]-n[s]);a[s][u]=l*r,a[u][s]=l*r}}else{if(1!==i)throw new Error("Invalid dimension");for(a=Array(o),s=0;s<o;s++)a[s]=Array(o);for(s=0;s<o;s++)for(u=s;u<o;u++){for(l=0,c=0;c<h;c++)l+=e[c]*(t[u][c]-n[u])*(t[s][c]-n[s]);a[s][u]=l*r,a[u][s]=l*r}}return a}var p=n(72);t.exports={entropy:function(t,e){"undefined"==typeof e&&(e=0);for(var n=0,i=t.length,o=t[0].length,a=0;a<i;a++)for(var s=0;s<o;s++)n+=t[a][s]*r(t[a][s]+e);return-n},mean:i,standardDeviation:o,variance:a,median:function(t){for(var e,n=t.length,r=t[0].length,i=Array(r),o=0;o<r;o++){e=Array(n);for(var a=0;a<n;a++)e[a]=t[a][o];e.sort();var s=e.length;i[o]=0==s%2?.5*(e[s/2]+e[s/2-1]):e[g(s/2)]}return i},mode:function(t){var e,n,r=t.length,i=t[0].length,o=Array(i);for(e=0;e<i;e++){for(var a=Array(r),s=0;s<r;s++)a[s]=0;var u=Array(r),c=0;for(n=0;n<r;n++){var l=u.indexOf(t[n][e]);0<=l?a[l]++:(u[c]=t[n][e],a[c]=1,c++)}var h=0,f=0;for(n=0;n<c;n++)a[n]>h&&(h=a[n],f=n);o[e]=u[f]}return o},skewness:function(t,e){"undefined"==typeof e&&(e=!0);for(var n=i(t),r=t.length,o=n.length,a=Array(o),s=0;s<o;s++){for(var u,l=0,h=0,f=0;f<r;f++)l+=(u=t[f][s]-n[s])*u,h+=u*u*u;var d=h/r/c(l/r,1.5);if(e){var p=R(r*(r-1));a[s]=p/(r-2)*d}else a[s]=d}return a},kurtosis:function(t,e){"undefined"==typeof e&&(e=!0);for(var n=i(t),r=t.length,o=t[0].length,a=Array(o),s=0;s<o;s++){for(var u,c=0,l=0,h=0;h<r;h++)c+=(u=t[h][s]-n[s])*u,l+=u*u*u*u;var f=c/r,d=l/r;if(e){var p=c/(r-1);a[s]=r*(r+1)/((r-1)*(r-2)*(r-3))*(l/(p*p))-(r-1)*(r-1)/((r-2)*(r-3))*3}else a[s]=d/(f*f)-3}return a},standardError:function(t){for(var e=t.length,n=o(t),r=n.length,i=Array(r),a=R(e),s=0;s<r;s++)i[s]=n[s]/a;return i},covariance:function(t,e){return s(t,void 0,e)},scatter:s,correlation:function(t){var e,n,r=i(t),a=u(t,r,o(t,!0,r)),s=t.length,c=t[0].length,l=Array(c);for(e=0;e<c;e++)l[e]=Array(c);for(e=0;e<c;e++)for(n=e;n<c;n++){for(var h=0,f=0,d=a.length;f<d;f++)h+=a[f][n]*a[f][e];l[e][n]=h/=s-1,l[n][e]=h}return l},zScores:u,center:l,standardize:h,weightedVariance:function(t,e){var n=i(t),r=t.length;if(0===r)return[];for(var o=t[0].length,a=Array(o),s=0;s<o;s++){for(var u=0,c=0,l=0,h=0;h<r;h++){var f=t[h][s]-n[s],d=e[h];u+=d*(f*f),l+=d,c+=d*d}a[s]=u*(l/(l*l-c))}return a},weightedMean:f,weightedCovariance:function(t,e,n,r){r=r||0,n=n||f(t,e,r);for(var i=0,o=0,a=0,s=e.length;a<s;a++)i+=e[a],o+=e[a]*e[a];return d(t,e,n,i/(i*i-o),r)},weightedScatter:d}},function(e,t,n){"use strict";function o(t,e){for(var n in e)t=t.replace(new RegExp("%"+n+"%","g"),e[n]);return t}var s=n(54);class r{constructor(t,e,n={}){if(t instanceof r){var i=t;this._init(i.rows,i.columns,i.elements.clone(),i.threshold)}else if(Array.isArray(t)){var o=t;t=o.length,n=e||{},this._init(t,e=o[0].length,new s(n),n.threshold);for(var a=0;a<t;a++)for(var c,l=0;l<e;l++)c=o[a][l],this.threshold&&u(c)<this.threshold&&(c=0),0!==c&&this.elements.set(a*e+l,o[a][l])}else this._init(t,e,new s(n),n.threshold)}_init(t,e,n,r){this.rows=t,this.columns=e,this.elements=n,this.threshold=r||0}static eye(t=1,e=t){for(var n=v(t,e),i=new r(t,e,{initialCapacity:n}),o=0;o<n;o++)i.set(o,o,1);return i}clone(){return new r(this)}to2DArray(){for(var t=Array(this.rows),e=0;e<this.rows;e++){t[e]=Array(this.columns);for(var n=0;n<this.columns;n++)t[e][n]=this.get(e,n)}return t}isSquare(){return this.rows===this.columns}isSymmetric(){if(!this.isSquare())return!1;var t=!0;return this.forEachNonZero((e,n,r)=>this.get(n,e)===r?r:(t=!1,!1)),t}get cardinality(){return this.elements.size}get size(){return this.rows*this.columns}get(t,e){return this.elements.get(t*this.columns+e)}set(t,e,n){return this.threshold&&u(n)<this.threshold&&(n=0),0===n?this.elements.remove(t*this.columns+e):this.elements.set(t*this.columns+e,n),this}mmul(t){this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var e=new r(this.rows,t.columns);return this.forEachNonZero((n,r,i)=>(t.forEachNonZero((t,o,a)=>(r===t&&e.set(n,o,e.get(n,o)+i*a),a)),i)),e}kroneckerProduct(t){var e=t.rows,n=t.columns,i=new r(this.rows*e,this.columns*n,{initialCapacity:this.cardinality*t.cardinality});return this.forEachNonZero((r,o,a)=>(t.forEachNonZero((t,s,u)=>(i.set(e*r+t,n*o+s,a*u),u)),a)),i}forEachNonZero(t){return this.elements.forEachPair((e,n)=>{var r=t(0|e/this.columns,e%this.columns,n);return!1!==r&&(this.threshold&&u(r)<this.threshold&&(r=0),r!==n&&(0===r?this.elements.remove(e,!0):this.elements.set(e,r)),!0)}),this.elements.maybeShrinkCapacity(),this}getNonZeros(){var t=this.cardinality,e=Array(t),n=Array(t),r=Array(t),i=0;return this.forEachNonZero((t,o,a)=>(e[i]=t,n[i]=o,r[i]=a,i++,a)),{rows:e,columns:n,values:r}}setThreshold(t){return 0!==t&&t!==this.threshold&&(this.threshold=t,this.forEachNonZero((t,e,n)=>n)),this}}r.prototype.klass="Matrix",r.identity=r.eye,r.prototype.tensorProduct=r.prototype.kroneckerProduct,e.exports=r;var a="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",l="\n(function %name%S(value) {\n    this.forEachNonZero((i, j, v) => v %op% value);\n    return this;\n})\n",c="\n(function %name%M(matrix) {\n    matrix.forEachNonZero((i, j, v) => {\n        this.set(i, j, this.get(i, j) %op% v);\n        return v;\n    });\n    return this;\n})\n",m="\n(function %name%(matrix, value) {\n    var newMatrix = new SparseMatrix(matrix);\n    return newMatrix.%name%(value);\n})\n",d="\n(function %name%() {\n    this.forEachNonZero((i, j, v) => %method%(v));\n    return this;\n})\n",g="\n(function %name%(matrix) {\n    var newMatrix = new SparseMatrix(matrix);\n    return newMatrix.%name%();\n})\n",h=[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]],p=!0,k=!1,j;try{for(var x=h[Symbol.iterator](),w,f;!(p=(w=x.next()).done);p=!0){f=w.value;for(var y=1;y<f.length;y++)r.prototype[f[y]]=eval(o(a,{name:f[y],op:f[0]})),r.prototype[f[y]+"S"]=eval(o(l,{name:f[y]+"S",op:f[0]})),r.prototype[f[y]+"M"]=eval(o(c,{name:f[y]+"M",op:f[0]})),r[f[y]]=eval(o(m,{name:f[y]}))}}catch(e){k=!0,j=e}finally{try{!p&&x.return&&x.return()}finally{if(k)throw j}}var i=[["~","not"]];["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(t){i.push(["Math."+t,t])});var M=!0,b=!1,R;try{for(var I=i[Symbol.iterator](),S,C;!(M=(S=I.next()).done);M=!0){C=S.value;for(var y=1;y<C.length;y++)r.prototype[C[y]]=eval(o(d,{name:C[y],method:C[0]})),r[C[y]]=eval(o(g,{name:C[y]}))}}catch(e){b=!0,R=e}finally{try{!M&&I.return&&I.return()}finally{if(b)throw R}}},function(t,e,n){"use strict";var r=n(210),i=r.DC.EVD,o=r.DC.SVD,a=n(2).matrix,s=a.mean,u=a.standardDeviation,c={isCovarianceMatrix:!1,center:!0,scale:!1};class l{constructor(t,e){if(!0===t){var n=e;return this.center=n.center,this.scale=n.scale,this.means=n.means,this.stdevs=n.stdevs,this.U=r.checkMatrix(n.U),void(this.S=n.S)}if(e=Object.assign({},c,e),this.center=!1,this.scale=!1,this.means=null,this.stdevs=null,e.isCovarianceMatrix)this._computeFromCovarianceMatrix(t);else if("boolean"==typeof e.useCovarianceMatrix?e.useCovarianceMatrix:t.length>t[0].length){var i=(t=this._adjust(t,e)).transposeView().mmul(t).div(t.rows-1);this._computeFromCovarianceMatrix(i)}else{t=this._adjust(t,e);var a=new o(t,{computeLeftSingularVectors:!1,computeRightSingularVectors:!0,autoTranspose:!0});this.U=a.rightSingularVectors;for(var s=a.diagonal,u=Array(s.length),l=0;l<s.length;l++)u[l]=s[l]*s[l]/(t.length-1);this.S=u}}static load(t){if("PCA"!==t.name)throw new RangeError("Invalid model: "+t.name);return new l(!0,t)}predict(t){return t=new r(t),this.center&&(t.subRowVector(this.means),this.scale&&t.divRowVector(this.stdevs)),t.mmul(this.U)}getExplainedVariance(){for(var t=0,e=0;e<this.S.length;e++)t+=this.S[e];return this.S.map(e=>e/t)}getCumulativeVariance(){for(var t=this.getExplainedVariance(),e=1;e<t.length;e++)t[e]+=t[e-1];return t}getEigenvectors(){return this.U}getEigenvalues(){return this.S}getStandardDeviations(){return this.S.map(t=>R(t))}getLoadings(){return this.U.transpose()}toJSON(){return{name:"PCA",center:this.center,scale:this.scale,means:this.means,stdevs:this.stdevs,U:this.U,S:this.S}}_adjust(t,e){if(this.center=!!e.center,this.scale=!!e.scale,t=new r(t),this.center){var n=s(t),i=this.scale?u(t,n,!0):null;if(this.means=n,t.subRowVector(n),this.scale){for(var o=0;o<i.length;o++)if(0===i[o])throw new RangeError("Cannot scale the dataset (standard deviation is zero at index "+o);this.stdevs=i,t.divRowVector(i)}}return t}_computeFromCovarianceMatrix(t){var e=new i(t,{assumeSymmetric:!0});this.U=e.eigenvectorMatrix;for(var n=0;n<this.U.length;n++)this.U[n].reverse();this.S=e.realEigenvalues.reverse()}}t.exports=l},function(t,e,n){"use strict";t.exports=n(6).Matrix,t.exports.Decompositions=t.exports.DC=n(219)},function(){"use strict";Symbol.species||(Symbol.species=Symbol.for("@@species"))},function(t,e,n){"use strict";var r=n(16);t.exports=class extends r{constructor(t){super(t,t.columns,t.rows)}set(t,e,n){return this.matrix.set(e,t,n),this}get(t,e){return this.matrix.get(e,t)}}},function(t,e,n){"use strict";var r=n(16);t.exports=class extends r{constructor(t,e){super(t,1,t.columns),this.row=e}set(t,e,n){return this.matrix.set(this.row,e,n),this}get(t,e){return this.matrix.get(this.row,e)}}},function(t,e,n){"use strict";var r=n(16),i=n(25);t.exports=class extends r{constructor(t,e,n,r,o){i.checkRange(t,e,n,r,o),super(t,n-e+1,o-r+1),this.startRow=e,this.startColumn=r}set(t,e,n){return this.matrix.set(this.startRow+t,this.startColumn+e,n),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}}},function(t,e,n){"use strict";var r=n(16),i=n(25);t.exports=class extends r{constructor(t,e,n){var r=i.checkIndices(t,e,n);super(t,r.row.length,r.column.length),this.rowIndices=r.row,this.columnIndices=r.column}set(t,e,n){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],n),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}},function(t,e,n){"use strict";var r=n(16);t.exports=class extends r{constructor(t,e){super(t,t.rows,1),this.column=e}set(t,e,n){return this.matrix.set(t,this.column,n),this}get(t){return this.matrix.get(t,this.column)}}},function(t,e,n){"use strict";var r=n(16);t.exports=class extends r{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(this.rows-t-1,e,n),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}}},function(t,e,n){"use strict";var r=n(16);t.exports=class extends r{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(t,this.columns-e-1,n),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}}},function(t,e,n){"use strict";function r(t){return i(t=o.checkMatrix(t),o.eye(t.rows))}function i(t,e){return t=o.checkMatrix(t),e=o.checkMatrix(e),t.isSquare()?new u(t).solve(e):new c(t).solve(e)}var o=n(6).Matrix,a=n(75),s=n(220),u=n(74),c=n(221),l=n(222);o.inverse=o.inv=r,o.prototype.inverse=o.prototype.inv=function(){return r(this)},o.solve=i,o.prototype.solve=function(t){return i(this,t)},t.exports={SingularValueDecomposition:a,SVD:a,EigenvalueDecomposition:s,EVD:s,LuDecomposition:u,LU:u,QrDecomposition:c,QR:c,CholeskyDecomposition:l,CHO:l,inverse:r,solve:i}},function(t,e,n){"use strict";function r(t,e){if(e=Object.assign({},p,e),!(this instanceof r))return new r(t,e);if(!(t=l.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");var n,u,c=t.columns,h=d(c,c,0),f=Array(c),m=Array(c),g=t;if(e.assumeSymmetric||t.isSymmetric()){for(n=0;n<c;n++)for(u=0;u<c;u++)h[n][u]=g.get(n,u);i(c,m,f,h),o(c,m,f,h)}else{var v=d(c,c,0),y=Array(c);for(u=0;u<c;u++)for(n=0;n<c;n++)v[n][u]=g.get(n,u);a(c,v,y,h),s(c,m,f,h,v)}this.n=c,this.e=m,this.d=f,this.V=h}function i(t,e,n,r){var i,o,a,s,c,l,h,f;for(c=0;c<t;c++)n[c]=r[t-1][c];for(s=t-1;0<s;s--){for(f=0,a=0,l=0;l<s;l++)f+=u(n[l]);if(0===f)for(e[s]=n[s-1],c=0;c<s;c++)n[c]=r[s-1][c],r[s][c]=0,r[c][s]=0;else{for(l=0;l<s;l++)n[l]/=f,a+=n[l]*n[l];for(i=n[s-1],o=R(a),0<i&&(o=-o),e[s]=f*o,a-=i*o,n[s-1]=i-o,c=0;c<s;c++)e[c]=0;for(c=0;c<s;c++){for(r[c][s]=i=n[c],o=e[c]+r[c][c]*i,l=c+1;l<=s-1;l++)o+=r[l][c]*n[l],e[l]+=r[l][c]*i;e[c]=o}for(i=0,c=0;c<s;c++)e[c]/=a,i+=e[c]*n[c];for(h=i/(a+a),c=0;c<s;c++)e[c]-=h*n[c];for(c=0;c<s;c++){for(i=n[c],o=e[c],l=c;l<=s-1;l++)r[l][c]-=i*e[l]+o*n[l];n[c]=r[s-1][c],r[s][c]=0}}n[s]=a}for(s=0;s<t-1;s++){if(r[t-1][s]=r[s][s],r[s][s]=1,0!==(a=n[s+1])){for(l=0;l<=s;l++)n[l]=r[l][s+1]/a;for(c=0;c<=s;c++){for(o=0,l=0;l<=s;l++)o+=r[l][s+1]*r[l][c];for(l=0;l<=s;l++)r[l][c]-=o*n[l]}}for(l=0;l<=s;l++)r[l][s+1]=0}for(c=0;c<t;c++)n[c]=r[t-1][c],r[t-1][c]=0;r[t-1][t-1]=1,e[0]=0}function o(t,e,n,r){var i,o,a,s,c,l,h,d,p,m,g,v,y,w,b,x;for(a=1;a<t;a++)e[a-1]=e[a];e[t-1]=0;var _=0,E=0,S=2.220446049250313e-16;for(l=0;l<t;l++){for(E=M(E,u(n[l])+u(e[l])),h=l;h<t&&!(u(e[h])<=S*E);)h++;if(h>l)do{for(p=f(d=(n[l+1]-(i=n[l]))/(2*e[l]),1),0>d&&(p=-p),n[l]=e[l]/(d+p),n[l+1]=e[l]*(d+p),m=n[l+1],o=i-n[l],a=l+2;a<t;a++)n[a]-=o;for(_+=o,d=n[h],v=g=1,y=g,w=e[l+1],b=0,x=0,a=h-1;a>=l;a--)for(y=v,v=g,x=b,i=g*e[a],o=g*d,p=f(d,e[a]),e[a+1]=b*p,d=(g=d/p)*n[a]-(b=e[a]/p)*i,n[a+1]=o+b*(g*i+b*n[a]),c=0;c<t;c++)r[c][a+1]=b*r[c][a]+g*(o=r[c][a+1]),r[c][a]=g*r[c][a]-b*o;e[l]=b*(d=-b*x*y*w*e[l]/m),n[l]=g*d}while(u(e[l])>S*E);n[l]+=_,e[l]=0}for(a=0;a<t-1;a++){for(c=a,d=n[a],s=a+1;s<t;s++)n[s]<d&&(c=s,d=n[s]);if(c!==a)for(n[c]=n[a],n[a]=d,s=0;s<t;s++)d=r[s][a],r[s][a]=r[s][c],r[s][c]=d}}function a(t,e,n,r){var i,o,a,s,c,l,h,f=t-1;for(l=1;l<=f-1;l++){for(h=0,s=l;s<=f;s++)h+=u(e[s][l-1]);if(0!==h){for(a=0,s=f;s>=l;s--)n[s]=e[s][l-1]/h,a+=n[s]*n[s];for(o=R(a),0<n[l]&&(o=-o),a-=n[l]*o,n[l]-=o,c=l;c<t;c++){for(i=0,s=f;s>=l;s--)i+=n[s]*e[s][c];for(i/=a,s=l;s<=f;s++)e[s][c]-=i*n[s]}for(s=0;s<=f;s++){for(i=0,c=f;c>=l;c--)i+=n[c]*e[s][c];for(i/=a,c=l;c<=f;c++)e[s][c]-=i*n[c]}n[l]=h*n[l],e[l][l-1]=h*o}}for(s=0;s<t;s++)for(c=0;c<t;c++)r[s][c]=s===c?1:0;for(l=f-1;l>=1;l--)if(0!==e[l][l-1]){for(s=l+1;s<=f;s++)n[s]=e[s][l-1];for(c=l;c<=f;c++){for(o=0,s=l;s<=f;s++)o+=n[s]*r[s][c];for(o=o/n[l]/e[l][l-1],s=l;s<=f;s++)r[s][c]+=o*n[s]}}}function s(t,e,n,r,i){var o,a,s,l,h,f,d,p,m,g,y,w,b,x,_,E=t-1,S=t-1,T=2.220446049250313e-16,A=0,k=0,C=0,D=0,L=0,O=0,P=0,I=0;for(o=0;o<t;o++)for((o<0||o>S)&&(n[o]=i[o][o],e[o]=0),a=M(o-1,0);a<t;a++)k+=u(i[o][a]);for(;E>=0;){for(l=E;l>0&&(0===(O=u(i[l-1][l-1])+u(i[l][l]))&&(O=k),!(u(i[l][l-1])<T*O));)l--;if(l===E)i[E][E]+=A,n[E]=i[E][E],e[E]=0,E--,I=0;else if(l===E-1){if(P=R(u(D=(C=(i[E-1][E-1]-i[E][E])/2)*C+(d=i[E][E-1]*i[E-1][E]))),i[E][E]+=A,i[E-1][E-1]=i[E-1][E-1]+A,p=i[E][E],0<=D){for(n[E-1]=p+(P=0<=C?C+P:C-P),n[E]=n[E-1],0!==P&&(n[E]=p-d/P),e[E-1]=0,e[E]=0,C=(p=i[E][E-1])/(O=u(p)+u(P)),C/=L=R(C*C+(D=P/O)*D),D/=L,a=E-1;a<t;a++)i[E-1][a]=D*(P=i[E-1][a])+C*i[E][a],i[E][a]=D*i[E][a]-C*P;for(o=0;o<=E;o++)i[o][E-1]=D*(P=i[o][E-1])+C*i[o][E],i[o][E]=D*i[o][E]-C*P;for(o=0;o<=S;o++)r[o][E-1]=D*(P=r[o][E-1])+C*r[o][E],r[o][E]=D*r[o][E]-C*P}else n[E-1]=p+C,n[E]=p+C,e[E-1]=P,e[E]=-P;E-=2,I=0}else{if(p=i[E][E],m=0,d=0,l<E&&(m=i[E-1][E-1],d=i[E][E-1]*i[E-1][E]),10==I){for(A+=p,o=0;o<=E;o++)i[o][o]-=p;p=m=.75*(O=u(i[E][E-1])+u(i[E-1][E-2])),d=-.4375*O*O}if(30==I&&0<(O=(O=(m-p)/2)*O+d)){for(O=R(O),m<p&&(O=-O),O=p-d/((m-p)/2+O),o=0;o<=E;o++)i[o][o]-=O;A+=O,p=m=d=.964}for(++I,h=E-2;h>=l&&(C=((L=p-(P=i[h][h]))*(O=m-P)-d)/i[h+1][h]+i[h][h+1],D=i[h+1][h+1]-P-L-O,L=i[h+2][h+1],C/=O=u(C)+u(D)+u(L),D/=O,L/=O,h!==l)&&!(u(i[h][h-1])*(u(D)+u(L))<T*(u(C)*(u(i[h-1][h-1])+u(P)+u(i[h+1][h+1]))));)h--;for(o=h+2;o<=E;o++)i[o][o-2]=0,o>h+2&&(i[o][o-3]=0);for(s=h;s<=E-1&&(x=s!==E-1,s!==h&&(C=i[s][s-1],D=i[s+1][s-1],L=x?i[s+2][s-1]:0,0!==(p=u(C)+u(D)+u(L))&&(C/=p,D/=p,L/=p)),0!==p);s++)if(O=R(C*C+D*D+L*L),0>C&&(O=-O),0!==O){for(s===h?l!==h&&(i[s][s-1]=-i[s][s-1]):i[s][s-1]=-O*p,p=(C+=O)/O,m=D/O,P=L/O,D/=C,L/=C,a=s;a<t;a++)C=i[s][a]+D*i[s+1][a],x&&(i[s+2][a]=i[s+2][a]-(C+=L*i[s+2][a])*P),i[s][a]-=C*p,i[s+1][a]=i[s+1][a]-C*m;for(o=0;o<=v(E,s+3);o++)C=p*i[o][s]+m*i[o][s+1],x&&(i[o][s+2]=i[o][s+2]-(C+=P*i[o][s+2])*L),i[o][s]-=C,i[o][s+1]=i[o][s+1]-C*D;for(o=0;o<=S;o++)C=p*r[o][s]+m*r[o][s+1],x&&(r[o][s+2]=r[o][s+2]-(C+=P*r[o][s+2])*L),r[o][s]-=C,r[o][s+1]=r[o][s+1]-C*D}}}if(0!==k){for(E=t-1;0<=E;E--)if(C=n[E],0===(D=e[E]))for(l=E,i[E][E]=1,o=E-1;0<=o;o--){for(d=i[o][o]-C,L=0,a=l;a<=E;a++)L+=i[o][a]*i[a][E];if(0>e[o])P=d,O=L;else if(l=o,0===e[o]?i[o][E]=0===d?-L/(T*k):-L/d:(m=i[o+1][o],i[o][E]=f=((p=i[o][o+1])*O-P*L)/(D=(n[o]-C)*(n[o]-C)+e[o]*e[o]),i[o+1][E]=u(p)>u(P)?(-L-d*f)/p:(-O-m*f)/P),1<T*(f=u(i[o][E]))*f)for(a=o;a<=E;a++)i[a][E]/=f}else if(0>D)for(l=E-1,u(i[E][E-1])>u(i[E-1][E])?(i[E-1][E-1]=D/i[E][E-1],i[E-1][E]=-(i[E][E]-C)/i[E][E-1]):(_=c(0,-i[E-1][E],i[E-1][E-1]-C,D),i[E-1][E-1]=_[0],i[E-1][E]=_[1]),i[E][E-1]=0,i[E][E]=1,o=E-2;0<=o;o--){for(g=0,y=0,a=l;a<=E;a++)g+=i[o][a]*i[a][E-1],y+=i[o][a]*i[a][E];if(d=i[o][o]-C,0>e[o])P=d,L=g,O=y;else if(l=o,0===e[o]?(_=c(-g,-y,d,D),i[o][E-1]=_[0],i[o][E]=_[1]):(p=i[o][o+1],m=i[o+1][o],b=2*(n[o]-C)*D,0==(w=(n[o]-C)*(n[o]-C)+e[o]*e[o]-D*D)&&0===b&&(w=T*k*(u(d)+u(D)+u(p)+u(m)+u(P))),_=c(p*L-P*g+D*y,p*O-P*y-D*g,w,b),i[o][E-1]=_[0],i[o][E]=_[1],u(p)>u(P)+u(D)?(i[o+1][E-1]=(-g-d*i[o][E-1]+D*i[o][E])/p,i[o+1][E]=(-y-d*i[o][E]-D*i[o][E-1])/p):(_=c(-L-m*i[o][E-1],-O-m*i[o][E],P,D),i[o+1][E-1]=_[0],i[o+1][E]=_[1])),1<T*(f=M(u(i[o][E-1]),u(i[o][E])))*f)for(a=o;a<=E;a++)i[a][E-1]=i[a][E-1]/f,i[a][E]/=f}for(o=0;o<t;o++)if(o<0||o>S)for(a=o;a<t;a++)r[o][a]=i[o][a];for(a=t-1;a>=0;a--)for(o=0;o<=S;o++){for(P=0,s=0;s<=v(a,S);s++)P+=r[o][s]*i[s][a];r[o][a]=P}}}function c(t,e,n,r){var i,o;return u(n)>u(r)?[(t+(i=r/n)*e)/(o=n+i*r),(e-i*t)/o]:[((i=n/r)*t+e)/(o=r+i*n),(i*e-t)/o]}var l=n(6).Matrix,h=n(39),f=h.hypotenuse,d=h.getFilled2DArray,p={assumeSymmetric:!1};r.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return l.isMatrix(this.V)||(this.V=new l(this.V)),this.V},get diagonalMatrix(){var t,e,n=this.n,r=this.e,i=this.d,o=new l(n,n);for(t=0;t<n;t++){for(e=0;e<n;e++)o[t][e]=0;o[t][t]=i[t],0<r[t]?o[t][t+1]=r[t]:0>r[t]&&(o[t][t-1]=r[t])}return o}},t.exports=r},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);var e,n,a,s,u=(t=i.checkMatrix(t)).clone(),c=t.rows,l=t.columns,h=Array(l);for(a=0;a<l;a++){var f=0;for(e=a;e<c;e++)f=o(f,u[e][a]);if(0!==f){for(0>u[a][a]&&(f=-f),e=a;e<c;e++)u[e][a]/=f;for(u[a][a]+=1,n=a+1;n<l;n++){for(s=0,e=a;e<c;e++)s+=u[e][a]*u[e][n];for(s=-s/u[a][a],e=a;e<c;e++)u[e][n]+=s*u[e][a]}}h[a]=-f}this.QR=u,this.Rdiag=h}var i=n(6).Matrix,o=n(39).hypotenuse;r.prototype={solve:function(t){t=i.checkMatrix(t);var e=this.QR,n=e.rows;if(t.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var r,o,a,s,u=t.columns,c=t.clone(),l=e.columns;for(a=0;a<l;a++)for(o=0;o<u;o++){for(s=0,r=a;r<n;r++)s+=e[r][a]*c[r][o];for(s=-s/e[a][a],r=a;r<n;r++)c[r][o]+=s*e[r][a]}for(a=l-1;0<=a;a--){for(o=0;o<u;o++)c[a][o]/=this.Rdiag[a];for(r=0;r<a;r++)for(o=0;o<u;o++)c[r][o]-=c[a][o]*e[r][a]}return c.subMatrix(0,l-1,0,u-1)},isFullRank:function(){for(var t=this.QR.columns,e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0},get upperTriangularMatrix(){var t,e,n=this.QR,r=n.columns,o=new i(r,r);for(t=0;t<r;t++)for(e=0;e<r;e++)o[t][e]=t<e?n[t][e]:t===e?this.Rdiag[t]:0;return o},get orthogonalMatrix(){var t,e,n,r,o=this.QR,a=o.rows,s=o.columns,u=new i(a,s);for(n=s-1;0<=n;n--){for(t=0;t<a;t++)u[t][n]=0;for(u[n][n]=1,e=n;e<s;e++)if(0!==o[n][n]){for(r=0,t=n;t<a;t++)r+=o[t][n]*u[t][e];for(r=-r/o[n][n],t=n;t<a;t++)u[t][e]+=r*o[t][n]}}return u}},t.exports=r},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);if(!(t=i.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");var e,n,o,a=t,s=a.rows,u=new i(s,s),c=!0;for(n=0;n<s;n++){var l=u[n],h=0;for(o=0;o<n;o++){var f=u[o],d=0;for(e=0;e<o;e++)d+=f[e]*l[e];l[o]=d=(a[n][o]-d)/u[o][o],h+=d*d}for(c&=0<(h=a[n][n]-h),u[n][n]=R(M(h,0)),o=n+1;o<s;o++)u[n][o]=0}if(!c)throw new Error("Matrix is not positive definite");this.L=u}var i=n(6).Matrix;r.prototype={get lowerTriangularMatrix(){return this.L},solve:function(t){t=i.checkMatrix(t);var e=this.L,n=e.rows;if(t.rows!==n)throw new Error("Matrix dimensions do not match");var r,o,a,s=t.columns,u=t.clone();for(a=0;a<n;a++)for(o=0;o<s;o++){for(r=0;r<a;r++)u[a][o]-=u[r][o]*e[a][r];u[a][o]/=e[a][a]}for(a=n-1;0<=a;a--)for(o=0;o<s;o++){for(r=a+1;r<n;r++)u[a][o]-=u[r][o]*e[r][a];u[a][o]/=e[a][a]}return u}},t.exports=r},function(n,r,i){"use strict";var o=i(224);class a{constructor(n,r,i){if(i=i||{},n.length!==r.length||n[0].length!==r[0].length)throw new Error("dimensions of prediction and target do not match");var o=n.length,a=n[0].length,s=!i.max,u=[];if(i.all)for(var c=0;c<o;c++)for(var l=0;l<a;l++)u.push({pred:n[c][l],targ:r[c][l]});else{if(3>o||o!==a)throw new Error('When "all" option is false, the prediction matrix must be square and have at least 3 columns');for(c=0;c<o-1;c++)for(l=c+1;l<a;l++)u.push({pred:n[c][l],targ:r[c][l]})}u.sort(s?(t,e)=>t.pred-e.pred:(t,e)=>e.pred-t.pred);var h=this.cutoffs=[s?t:e],f=this.fp=[0],d=this.tp=[0],p=0,m=0,g=u[0].pred,v=0,y=0;for(c=0;c<u.length;c++)u[c].pred!==g&&(h.push(g),f.push(y),d.push(v),g=u[c].pred),u[c].targ?(p++,v++):(m++,y++);h.push(g),f.push(y),d.push(v);var w=h.length,b=this.fn=Array(w),x=this.tn=Array(w),_=this.nPosPred=Array(w),M=this.nNegPred=Array(w);for(c=0;c<w;c++)b[c]=p-d[c],x[c]=m-f[c],_[c]=d[c]+f[c],M[c]=x[c]+b[c];this.nPos=p,this.nNeg=m,this.nSamples=p+m}getMeasure(t){if("string"!=typeof t)throw new Error("No measure specified");if(!o[t])throw new Error(`The specified measure (${t}) does not exist`);return o[t](this)}getAURC(){for(var t=this.cutoffs.length,e=Array(t),n=Array(t),r=0;r<t;r++)e[r]=this.fp[r]/this.nNeg,n[r]=this.tp[r]/this.nPos;var i=0;for(r=1;r<t;r++)i+=.5*(e[r]-e[r-1])*(n[r]+n[r-1]);return i}getAUDC(){for(var t=this.cutoffs.length,e=Array(t),n=Array(t),r=0;r<t;r++)e[r]=this.fn[r]/this.nPos,n[r]=this.fp[r]/this.nNeg;var i=0;for(r=1;r<t;r++)i+=.5*(e[r]+e[r-1])*(n[r]-n[r-1]);return i}getDistribution(t){for(var e=this.cutoffs.length,n=(t=t||{}).xMin||g(100*this.cutoffs[e-1])/100,r=t.xMax||s(100*this.cutoffs[1])/100,i=t.interval||g((r-n)/20*1e7-1)/1e7,o=[],a=[],u=[],c=[],l=[],h=this.tp[e-1],f=0,d=this.fp[e-1],p=0,m=n,v=e-1;m<=r;m+=i){for(;this.cutoffs[v]<m;)v--;o.push(m);var y=h-f-this.tp[v],w=d-p-this.fp[v];f+=y,p+=w,a.push(w),u.push(y),c.push(100-(d-this.fp[v])/d*100),l.push(100-(h-this.tp[v])/h*100)}return{xLabels:o,interValues:a,intraValues:u,interCumPercent:c,intraCumPercent:l}}}a.names={acc:"Accuracy",err:"Error rate",fpr:"False positive rate",tpr:"True positive rate",fnr:"False negative rate",tnr:"True negative rate",ppv:"Positive predictive value",npv:"Negative predictive value",pcfall:"Prediction-conditioned fallout",pcmiss:"Prediction-conditioned miss",lift:"Lift value",rpp:"Rate of positive predictions",rnp:"Rate of negative predictions",threshold:"Threshold"},n.exports=a},function(t,e){"use strict";e.acc=(t=>{for(var e=t.cutoffs.length,n=Array(e),r=0;r<e;r++)n[r]=(t.tn[r]+t.tp[r])/(e-1);return n}),e.err=(t=>{for(var e=t.cutoffs.length,n=Array(e),r=0;r<e;r++)n[r]=t.fn[r]+t.fp[r]/(e-1);return n}),e.fpr=(t=>{for(var e=t.cutoffs.length,n=Array(e),r=0;r<e;r++)n[r]=t.fp[r]/t.nNeg;return n}),e.tpr=(t=>{for(var e=t.cutoffs.length,n=Array(e),r=0;r<e;r++)n[r]=t.tp[r]/t.nPos;return n}),e.fnr=(t=>{for(var e=t.cutoffs.length,n=Array(e),r=0;r<e;r++)n[r]=t.fn[r]/t.nPos;return n}),e.tnr=(t=>{for(var e=t.cutoffs.length,n=Array(e),r=0;r<e;r++)n[r]=t.tn[r]/t.nNeg;return n}),e.ppv=(t=>{for(var e=t.cutoffs.length,n=Array(e),r=0;r<e;r++)n[r]=0===t.fp[r]+t.tp[r]?0:t.tp[r]/(t.fp[r]+t.tp[r]);return n}),e.npv=(t=>{for(var e=t.cutoffs.length,n=Array(e),r=0;r<e;r++)n[r]=0===t.fn[r]+t.tn[r]?0:t.tn[r]/(t.fn[r]+t.tn[r]);return n}),e.pcfall=(t=>{for(var e=t.cutoffs.length,n=Array(e),r=0;r<e;r++)n[r]=0===t.fp[r]+t.tp[r]?1:1-t.tp[r]/(t.fp[r]+t.tp[r]);return n}),e.pcmiss=(t=>{for(var e=t.cutoffs.length,n=Array(e),r=0;r<e;r++)n[r]=0===t.fn[r]+t.tn[r]?1:1-t.tn[r]/(t.fn[r]+t.tn[r]);return n}),e.lift=(t=>{for(var e=t.cutoffs.length,n=Array(e),r=0;r<e;r++)n[r]=0===t.nPosPred[r]?0:t.tp[r]/t.nPos/(t.nPosPred[r]/t.nSamples);return n}),e.rpp=(t=>{for(var e=t.cutoffs.length,n=Array(e),r=0;r<e;r++)n[r]=t.nPosPred[r]/t.nSamples;return n}),e.rnp=(t=>{for(var e=t.cutoffs.length,n=Array(e),r=0;r<e;r++)n[r]=t.nNegPred[r]/t.nSamples;return n}),e.threshold=(t=>{var e=t.cutoffs.slice();return e[0]=e[1],e})},function(t,e,n){"use strict";function r(t,e){var n,r,i,o,a=e.length/3,s=t.rows,u=p.zeros(t.length,1);for(r=0;r<a;r++)for(o=c(e[r+2*a][0]/2,2),n=e[r+a][0]*o,i=0;i<s;i++)u[i][0]+=n/(c(t[i][0]-e[r][0],2)+o);return u}function i(t,e){for(var n=e[1][0]*c(e[2][0]/2,2),r=t.rows,i=new p(t.rows,t.columns),o=0;o<r;o++)i[o][0]=n/(c(t[o][0]-e[0][0],2)+c(e[2][0]/2,2));return i}function a(t,e){for(var n=e[2][0]*e[2][0]/2,r=t.rows,i=new p(t.rows,t.columns),a=0;a<r;a++)i[a][0]=e[1][0]*o(-(t[a][0]-e[0][0])*(t[a][0]-e[0][0])/n);return i}function s(t,e,n){var r=h(t,(n=n||{}).percentage||0);if(null===r||3>r[0].rows)return null;var o=r[0],a=r[1],s=r[2],c=[o.rows/R(a.dot(a))],l=(n=Object.create(n.LMOptions||[3,100,.001,.001,.001,.01,.01,11,9,1]),u(o[0][0]-o[1][0])),d=new p([[-l/1e4],[-.001],[-l/1e4]]),m=new p([[e.x],[1],[e.width]]),g=new p([[e.x-l],[.75],[e.width/4]]),v=new p([[e.x+l],[1.25],[4*e.width]]),y=f.optimize(i,m,o,a,c,d,g,v,[],n);return[(y=y.p)[0],[y[1][0]*s],y[2]]}function l(t,e,n){var r=h(t,(n=n||{}).percentage||0);if(null===r||3>r[0].rows)return null;var i=r[0],o=r[1],s=r[2],c=[i.rows/R(o.dot(o))],l=(n=Object.create(n.LMOptions||[3,100,.001,.001,.001,.01,.01,11,9,1]),u(i[0][0]-i[1][0])),d=new p([[-l/1e4],[-.001],[-l/1e4]]),m=(d=new p([[-u(i[0][0]-i[1][0])/1e3],[-.001],[-e.width/1e3]]),new p([[e.x],[1],[e.width]])),g=new p([[e.x-l],[.75],[e.width/4]]),v=new p([[e.x+l],[1.25],[4*e.width]]),y=f.optimize(a,m,i,o,c,d,g,v,[],n);return[(y=y.p)[0],[y[1][0]*s],y[2]]}function h(t,e){var n,r,i,o=t.length,a=null,s=null,u=0;if(2==o){var c=t[0].length;if(a=Array(c),s=Array(c),r=t[1],"number"==typeof(n=t[0])[0])for(i=0;i<c;i++)a[i]=n[i],s[i]=r[i],r[i]>u&&(u=r[i]);else if("object"==typeof n[0])for(i=0;i<c;i++)a[i]=n[i][0],s[i]=r[i][0],r[i][0]>u&&(u=r[i][0])}else for(c=o,a=Array(c),s=Array(c),i=0;i<c;i++)a[i]=t[i][0],s[i]=t[i][1],s[i]>u&&(u=s[i]);for(i=0;i<c;i++)s[i]/=u;if(e)for(i=c-1;0<=i;i--)s[i]<e&&(s.splice(i,1),a.splice(i,1));return 0<a.length?[new p([a]).transpose(),new p([s]).transpose(),u]:null}var f=n(226),d=f.Matrix.algebra,p=n(240);t.exports.optimizeSingleLorentzian=s,t.exports.optimizeLorentzianSum=function(t,e,n){var i=h(t);if(null===i||3>i[0].rows)return null;var o,a=i[0],s=i[1],c=i[2],l=[a.rows/d.sqrt(s.dot(s))],m=(n=Object.create(n||[3,100,.001,.001,.001,.01,.01,11,9,1]),e.length),g=new p(3*m,1),v=new p(3*m,1),y=new p(3*m,1),w=new p(3*m,1),b=u(a[0][0]-a[1][0]);for(o=0;o<m;o++)g[o][0]=e[o].x,g[o+m][0]=1,g[o+2*m][0]=e[o].width,v[o][0]=e[o].x-b,v[o+m][0]=0,v[o+2*m][0]=e[o].width/4,y[o][0]=e[o].x+b,y[o+m][0]=1.5,y[o+2*m][0]=4*e[o].width,w[o][0]=-b/1e3,w[o+m][0]=-.001,w[o+2*m][0]=-b/1e3;w=-u(a[0][0]-a[1][0])/1e4;var x=f.optimize(r,g,a,s,l,w,v,y,[],n);x=x.p;var _=Array(m);for(o=0;o<m;o++)_[o]=[x[o],[x[o+m][0]*c],x[o+2*m]];return _},t.exports.optimizeSingleGaussian=l,t.exports.optimizeGaussianSum=function(t,e,n){var i=h(t);if(null===i||3>i[0].rows)return null;var o,a=i[0],s=i[1],c=i[2],l=a.rows,m=new p(l,1),g=l/d.sqrt(s.dot(s));for(o=0;o<l;o++)m[o][0]=g;n=Object.create(n||[3,100,.001,.001,.001,.01,.01,11,9,2]);var v=e.length,y=new p(3*v,1),w=new p(3*v,1),b=new p(3*v,1),x=new p(3*v,1),_=u(a[0][0]-a[1][0]);for(o=0;o<v;o++)y[o][0]=e[o].x,y[o+v][0]=e[o].y/c,y[o+2*v][0]=e[o].width,w[o][0]=e[o].x-_,w[o+v][0]=.8*e[o].y/c,w[o+2*v][0]=e[o].width/2,b[o][0]=e[o].x+_,b[o+v][0]=1.2*e[o].y/c,b[o+2*v][0]=2*e[o].width,x[o][0]=-_/1e3,x[o+v][0]=-.001,x[o+2*v][0]=-_/1e3;var M=f.optimize(r,y,a,s,m,x,w,b,[],n);M=M.p;var E=Array(v);for(o=0;o<v;o++)E[o]=[M[o],[M[o+v][0]*c],M[o+2*v]];return E},t.exports.singleGaussian=a,t.exports.singleLorentzian=i,t.exports.optimizeGaussianTrain=function(t,e,n){var r=h(t);if(null===r||3>r[0].rows)return null;for(var i,o,a,s,u=r[0],c=r[1],f=r[2],d=0,p=u.length,m=[],g=0;g<e.length;g++){for(i=e[g].x-1.5*e[g].width;u[d++]<i&&d<p;);for(i=e[g].x+1.5*e[g].width,o=[],a=[];u[d]<=i&&d<p;)o.push(u[d][0]),a.push(c[d][0]*f),d++;s=l([o,a],e[g],n),m.push(s?{x:s[0][0],y:s[1][0],width:s[2][0],opt:!0}:{x:e[g].x,y:e[g].y,width:e[g].width,opt:!1})}return m},t.exports.optimizeLorentzianTrain=function(t,e,n){var r=h(t);if(null===r||3>r[0].rows)return null;for(var i,o,a,u,c=r[0],l=r[1],f=r[2],d=0,p=c.length,m=[],g=0;g<e.length;g++){for(i=e[g].x-1.5*e[g].width;c[d++]<i&&d<p;);for(i=e[g].x+1.5*e[g].width,o=[],a=[];c[d]<=i&&d<p;)o.push(c[d][0]),a.push(l[d][0]*f),d++;u=s([o,a],e[g],n),m.push(u?{x:u[0][0],y:u[1][0],width:u[2][0],opt:!0}:{x:e[g].x,y:e[g].y,width:e[g].width,opt:!1})}return m}},function(t,e,n){"use strict";t.exports=n(227),t.exports.Matrix=n(40),t.exports.Matrix.algebra=n(79)},function(t,e,n){"use strict";var r=n(40),i=n(79);t.exports={optimize:function(t,e,n,o,a,s,c,l,h,f){var d=0;if("object"!=typeof e[0])for(var p=0;p<e.length;p++)e[p]=[e[p]];var m=e.length,g=o.length,y=r.zeros(m,1),w=r.zeros(g,1),b=-2e-4,x=-2e-4,_=r.zeros(g,m);if(n.length==o.length){a=a||R((g-m+1)/i.multiply(i.transpose(o),o)),s=s||.001,c=c||i.multiply(u(e),-100),l=l||i.multiply(u(e),100),h=h||1;var E=(f=f||[3,10*m,.001,.001,.001,.01,.01,11,9,1])[1],S=f[2],T=f[5],A=f[6],k=f[7],C=f[8],D=f[9];if(!s.length||1==s.length){var L=Array(m);for(p=0;p<m;p++)L[p]=[s];s=L}var O=[];for(p=0;p<s.length;p++)0!=s[p][0]&&O.push(p);var P=O.length,I=!1,N=null;if(!a.length||a.length<g){var F=i.multiply(r.ones(g,1),a[0]);N=i.dotMultiply(F,F)}else N=i.dotMultiply(a,a);var j=this.lm_matx(t,n,y,w,1,_,e,o,N,s,h),z=j.JtWJ,U=j.JtWdy,V=(b=j.Chi_sq,j.y_hat);_=j.J,M(u(U))<S&&(console.log(" *** Your Initial Guess is Extremely Close to Optimal ***"),console.log(" *** epsilon_1 = ",S),I=!0),1===D?lambda=A:(lambda=A*M(i.diag(z)),nu=2),x=b;for(var B=null;!I&&d<=E;){++d,B=i.solve(i.add(z,i.multiply(1===D?i.diag(i.diag(z)):r.eye(m),lambda)),U);var H=Array(O.length);for($=0;$<O.length;$++)H[$]=B[O[$]];var q=i.add(e,H);for($=0;$<q.length;$++)q[$][0]=v(M(c[$][0],q[$][0]),l[$][0]);var G=i.subtract(o,t(n,q,h)),W=i.multiply(i.transpose(G),i.dotMultiply(G,N));if(2==D){var Y=i.multiply(i.transpose(U),B),X=i.multiply(Y,i.inv(i.add(i.multiply(i.subtract(W-b),.5)),i.multiply(Y,2)));B=i.multiply(X,B);for(var $=0;$<O.length;$++)H[$]=B[O[$]];q=i.add(e,H),q=i.min(i.max(c,q),l),G=i.subtract(o,t(n,q,h)),W=i.multiply(i.transpose(G),mat.dotMultiply(G,N))}var Q=(b-W)/i.multiply(i.multiply(i.transpose(B),2),i.add(i.multiply(lambda,B),U));Q>T?(dX2=b-x,x=b,y=e,e=q,z=(j=this.lm_matx(t,n,y,w=V,dX2,_,e,o,N,s,h)).JtWJ,U=j.JtWdy,b=j.Chi_sq,V=j.y_hat,_=j.J,1===D?lambda=M(lambda/C,1e-7):2===D?lambda=M(lambda/(1+X),1e-7):3===D&&(lambda=i.multiply(M(1/3,3^1-(2*Q-1)),lambda),nu=2)):(b=x,0==d%(2*m)&&(z=(j=this.lm_matx(t,n,y,w,-1,_,e,o,N,s,h)).JtWJ,U=j.JtWdy,dX2=j.Chi_sq,V=j.y_hat,_=j.J),1===D?lambda=v(lambda*k,1e7):2===D?lambda+=u((W-b)/2/X):3===D&&(lambda*=nu,nu*=2))}return(N=i.multiply(i.multiply(i.transpose(G),G),r.ones(g,1))).apply(function(t,e){N[t][e]=(g-P+1)/N[t][e]}),z=(j=this.lm_matx(t,n,y,w,-1,_,e,o,N,s,h)).JtWJ,U=j.JtWdy,V=j.y_hat,_=j.J,{p:e,X2:b=j.Chi_sq}}console.log("lm.m error: the length of t must equal the length of y_dat"),length_t=n.length,length_y_dat=o.length,b=0},lm_FD_J:function(t,e,n,o,a,s){var c=o.length,l=n.length;a=a||i.multiply(r.ones(l,1),.001);for(var h=n.clone(),f=new r(c,l),d=Array(l),p=0;p<l;p++){if(d[p]=a[p]*(1+u(n[p][0])),n[p]=[h[p][0]+d[p]],0!=d[p])if(y1=t(e,n,s),0>a[p][0])for(var m=i.dotDivide(i.subtract(y1,o),d[p]),g=0;g<c;g++)f[g][p]=m[g][0];else for(n[p][0]=h[p][0]-d[p],m=i.dotDivide(i.subtract(y1,t(e,n,s)),2*d[p]),g=0;g<c;g++)f[g][p]=m[g][0];n[p]=h[p]}return f},lm_Broyden_J:function(t,e,n,r,o){var a=i.subtract(r,t),s=i.transpose(a);return s.div(i.multiply(s,a)),i.add(n,i.multiply(i.subtract(o,i.add(e,i.multiply(n,a))),s))},lm_matx:function(t,e,n,o,a,s,u,c,l,h,f,d){var p=u.length;h=h||.001;var m=t(e,u,f);s=0==d%(2*p)||0<a?this.lm_FD_J(t,e,u,m,h,f):this.lm_Broyden_J(n,o,s,u,m);var g=i.subtract(c,m),v=i.multiply(i.transpose(g),i.dotMultiply(g,l)),y=i.transpose(s);return{JtWJ:i.multiply(y,i.dotMultiply(s,i.multiply(l,r.ones(1,p)))),JtWdy:i.multiply(y,i.dotMultiply(l,g)),Chi_sq:v,y_hat:m,J:s}}}},function(){"use strict";Symbol.species||(Symbol.species=Symbol.for("@@species"))},function(t,e,n){"use strict";var r=n(17);t.exports=class extends r{constructor(t){super(t,t.columns,t.rows)}set(t,e,n){return this.matrix.set(e,t,n),this}get(t,e){return this.matrix.get(e,t)}}},function(t,e,n){"use strict";var r=n(17);t.exports=class extends r{constructor(t,e){super(t,1,t.columns),this.row=e}set(t,e,n){return this.matrix.set(this.row,e,n),this}get(t,e){return this.matrix.get(this.row,e)}}},function(t,e,n){"use strict";var r=n(17),i=n(26);t.exports=class extends r{constructor(t,e,n,r,o){i.checkRange(t,e,n,r,o),super(t,n-e+1,o-r+1),this.startRow=e,this.startColumn=r}set(t,e,n){return this.matrix.set(this.startRow+t,this.startColumn+e,n),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}}},function(t,e,n){"use strict";var r=n(17),i=n(26);t.exports=class extends r{constructor(t,e,n){var r=i.checkIndices(t,e,n);super(t,r.row.length,r.column.length),this.rowIndices=r.row,this.columnIndices=r.column}set(t,e,n){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],n),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}},function(t,e,n){"use strict";var r=n(17);t.exports=class extends r{constructor(t,e){super(t,t.rows,1),this.column=e}set(t,e,n){return this.matrix.set(t,this.column,n),this}get(t){return this.matrix.get(t,this.column)}}},function(t,e,n){"use strict";var r=n(17);t.exports=class extends r{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(this.rows-t-1,e,n),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}}},function(t,e,n){"use strict";var r=n(17);t.exports=class extends r{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(t,this.columns-e-1,n),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}}},function(t,e,n){"use strict";function r(t){return i(t=o.checkMatrix(t),o.eye(t.rows))}function i(t,e){return t=o.checkMatrix(t),e=o.checkMatrix(e),t.isSquare()?new u(t).solve(e):new c(t).solve(e)}var o=n(7).Matrix,a=n(78),s=n(237),u=n(77),c=n(238),l=n(239);o.inverse=o.inv=r,o.prototype.inverse=o.prototype.inv=function(){return r(this)},o.solve=i,o.prototype.solve=function(t){return i(this,t)},t.exports={SingularValueDecomposition:a,SVD:a,EigenvalueDecomposition:s,EVD:s,LuDecomposition:u,LU:u,QrDecomposition:c,QR:c,CholeskyDecomposition:l,CHO:l,inverse:r,solve:i}},function(t,e,n){"use strict";function r(t,e){if(e=Object.assign({},p,e),!(this instanceof r))return new r(t,e);if(!(t=l.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");var n,u,c=t.columns,h=d(c,c,0),f=Array(c),m=Array(c),g=t;if(e.assumeSymmetric||t.isSymmetric()){for(n=0;n<c;n++)for(u=0;u<c;u++)h[n][u]=g.get(n,u);i(c,m,f,h),o(c,m,f,h)}else{var v=d(c,c,0),y=Array(c);for(u=0;u<c;u++)for(n=0;n<c;n++)v[n][u]=g.get(n,u);a(c,v,y,h),s(c,m,f,h,v)}this.n=c,this.e=m,this.d=f,this.V=h}function i(t,e,n,r){var i,o,a,s,c,l,h,f;for(c=0;c<t;c++)n[c]=r[t-1][c];for(s=t-1;0<s;s--){for(f=0,a=0,l=0;l<s;l++)f+=u(n[l]);if(0===f)for(e[s]=n[s-1],c=0;c<s;c++)n[c]=r[s-1][c],r[s][c]=0,r[c][s]=0;else{for(l=0;l<s;l++)n[l]/=f,a+=n[l]*n[l];for(i=n[s-1],o=R(a),0<i&&(o=-o),e[s]=f*o,a-=i*o,n[s-1]=i-o,c=0;c<s;c++)e[c]=0;for(c=0;c<s;c++){for(r[c][s]=i=n[c],o=e[c]+r[c][c]*i,l=c+1;l<=s-1;l++)o+=r[l][c]*n[l],e[l]+=r[l][c]*i;e[c]=o}for(i=0,c=0;c<s;c++)e[c]/=a,i+=e[c]*n[c];for(h=i/(a+a),c=0;c<s;c++)e[c]-=h*n[c];for(c=0;c<s;c++){for(i=n[c],o=e[c],l=c;l<=s-1;l++)r[l][c]-=i*e[l]+o*n[l];n[c]=r[s-1][c],r[s][c]=0}}n[s]=a}for(s=0;s<t-1;s++){if(r[t-1][s]=r[s][s],r[s][s]=1,0!==(a=n[s+1])){for(l=0;l<=s;l++)n[l]=r[l][s+1]/a;for(c=0;c<=s;c++){for(o=0,l=0;l<=s;l++)o+=r[l][s+1]*r[l][c];for(l=0;l<=s;l++)r[l][c]-=o*n[l]}}for(l=0;l<=s;l++)r[l][s+1]=0}for(c=0;c<t;c++)n[c]=r[t-1][c],r[t-1][c]=0;r[t-1][t-1]=1,e[0]=0}function o(t,e,n,r){var i,o,a,s,c,l,h,d,p,m,g,v,y,w,b,x;for(a=1;a<t;a++)e[a-1]=e[a];e[t-1]=0;var _=0,E=0,S=2.220446049250313e-16;for(l=0;l<t;l++){for(E=M(E,u(n[l])+u(e[l])),h=l;h<t&&!(u(e[h])<=S*E);)h++;if(h>l)do{for(p=f(d=(n[l+1]-(i=n[l]))/(2*e[l]),1),0>d&&(p=-p),n[l]=e[l]/(d+p),n[l+1]=e[l]*(d+p),m=n[l+1],o=i-n[l],a=l+2;a<t;a++)n[a]-=o;for(_+=o,d=n[h],v=g=1,y=g,w=e[l+1],b=0,x=0,a=h-1;a>=l;a--)for(y=v,v=g,x=b,i=g*e[a],o=g*d,p=f(d,e[a]),e[a+1]=b*p,d=(g=d/p)*n[a]-(b=e[a]/p)*i,n[a+1]=o+b*(g*i+b*n[a]),c=0;c<t;c++)r[c][a+1]=b*r[c][a]+g*(o=r[c][a+1]),r[c][a]=g*r[c][a]-b*o;e[l]=b*(d=-b*x*y*w*e[l]/m),n[l]=g*d}while(u(e[l])>S*E);n[l]+=_,e[l]=0}for(a=0;a<t-1;a++){for(c=a,d=n[a],s=a+1;s<t;s++)n[s]<d&&(c=s,d=n[s]);if(c!==a)for(n[c]=n[a],n[a]=d,s=0;s<t;s++)d=r[s][a],r[s][a]=r[s][c],r[s][c]=d}}function a(t,e,n,r){var i,o,a,s,c,l,h,f=t-1;for(l=1;l<=f-1;l++){for(h=0,s=l;s<=f;s++)h+=u(e[s][l-1]);if(0!==h){for(a=0,s=f;s>=l;s--)n[s]=e[s][l-1]/h,a+=n[s]*n[s];for(o=R(a),0<n[l]&&(o=-o),a-=n[l]*o,n[l]-=o,c=l;c<t;c++){for(i=0,s=f;s>=l;s--)i+=n[s]*e[s][c];for(i/=a,s=l;s<=f;s++)e[s][c]-=i*n[s]}for(s=0;s<=f;s++){for(i=0,c=f;c>=l;c--)i+=n[c]*e[s][c];for(i/=a,c=l;c<=f;c++)e[s][c]-=i*n[c]}n[l]=h*n[l],e[l][l-1]=h*o}}for(s=0;s<t;s++)for(c=0;c<t;c++)r[s][c]=s===c?1:0;for(l=f-1;l>=1;l--)if(0!==e[l][l-1]){for(s=l+1;s<=f;s++)n[s]=e[s][l-1];for(c=l;c<=f;c++){for(o=0,s=l;s<=f;s++)o+=n[s]*r[s][c];for(o=o/n[l]/e[l][l-1],s=l;s<=f;s++)r[s][c]+=o*n[s]}}}function s(t,e,n,r,i){var o,a,s,l,h,f,d,p,m,g,y,w,b,x,_,E=t-1,S=t-1,T=2.220446049250313e-16,A=0,k=0,C=0,D=0,L=0,O=0,P=0,I=0;for(o=0;o<t;o++)for((o<0||o>S)&&(n[o]=i[o][o],e[o]=0),a=M(o-1,0);a<t;a++)k+=u(i[o][a]);for(;E>=0;){for(l=E;l>0&&(0===(O=u(i[l-1][l-1])+u(i[l][l]))&&(O=k),!(u(i[l][l-1])<T*O));)l--;if(l===E)i[E][E]+=A,n[E]=i[E][E],e[E]=0,E--,I=0;else if(l===E-1){if(P=R(u(D=(C=(i[E-1][E-1]-i[E][E])/2)*C+(d=i[E][E-1]*i[E-1][E]))),i[E][E]+=A,i[E-1][E-1]=i[E-1][E-1]+A,p=i[E][E],0<=D){for(n[E-1]=p+(P=0<=C?C+P:C-P),n[E]=n[E-1],0!==P&&(n[E]=p-d/P),e[E-1]=0,e[E]=0,C=(p=i[E][E-1])/(O=u(p)+u(P)),C/=L=R(C*C+(D=P/O)*D),D/=L,a=E-1;a<t;a++)i[E-1][a]=D*(P=i[E-1][a])+C*i[E][a],i[E][a]=D*i[E][a]-C*P;for(o=0;o<=E;o++)i[o][E-1]=D*(P=i[o][E-1])+C*i[o][E],i[o][E]=D*i[o][E]-C*P;for(o=0;o<=S;o++)r[o][E-1]=D*(P=r[o][E-1])+C*r[o][E],r[o][E]=D*r[o][E]-C*P}else n[E-1]=p+C,n[E]=p+C,e[E-1]=P,e[E]=-P;E-=2,I=0}else{if(p=i[E][E],m=0,d=0,l<E&&(m=i[E-1][E-1],d=i[E][E-1]*i[E-1][E]),10==I){for(A+=p,o=0;o<=E;o++)i[o][o]-=p;p=m=.75*(O=u(i[E][E-1])+u(i[E-1][E-2])),d=-.4375*O*O}if(30==I&&0<(O=(O=(m-p)/2)*O+d)){for(O=R(O),m<p&&(O=-O),O=p-d/((m-p)/2+O),o=0;o<=E;o++)i[o][o]-=O;A+=O,p=m=d=.964}for(++I,h=E-2;h>=l&&(C=((L=p-(P=i[h][h]))*(O=m-P)-d)/i[h+1][h]+i[h][h+1],D=i[h+1][h+1]-P-L-O,L=i[h+2][h+1],C/=O=u(C)+u(D)+u(L),D/=O,L/=O,h!==l)&&!(u(i[h][h-1])*(u(D)+u(L))<T*(u(C)*(u(i[h-1][h-1])+u(P)+u(i[h+1][h+1]))));)h--;for(o=h+2;o<=E;o++)i[o][o-2]=0,o>h+2&&(i[o][o-3]=0);for(s=h;s<=E-1&&(x=s!==E-1,s!==h&&(C=i[s][s-1],D=i[s+1][s-1],L=x?i[s+2][s-1]:0,0!==(p=u(C)+u(D)+u(L))&&(C/=p,D/=p,L/=p)),0!==p);s++)if(O=R(C*C+D*D+L*L),0>C&&(O=-O),0!==O){for(s===h?l!==h&&(i[s][s-1]=-i[s][s-1]):i[s][s-1]=-O*p,p=(C+=O)/O,m=D/O,P=L/O,D/=C,L/=C,a=s;a<t;a++)C=i[s][a]+D*i[s+1][a],x&&(i[s+2][a]=i[s+2][a]-(C+=L*i[s+2][a])*P),i[s][a]-=C*p,i[s+1][a]=i[s+1][a]-C*m;for(o=0;o<=v(E,s+3);o++)C=p*i[o][s]+m*i[o][s+1],x&&(i[o][s+2]=i[o][s+2]-(C+=P*i[o][s+2])*L),i[o][s]-=C,i[o][s+1]=i[o][s+1]-C*D;for(o=0;o<=S;o++)C=p*r[o][s]+m*r[o][s+1],x&&(r[o][s+2]=r[o][s+2]-(C+=P*r[o][s+2])*L),r[o][s]-=C,r[o][s+1]=r[o][s+1]-C*D}}}if(0!==k){for(E=t-1;0<=E;E--)if(C=n[E],0===(D=e[E]))for(l=E,i[E][E]=1,o=E-1;0<=o;o--){for(d=i[o][o]-C,L=0,a=l;a<=E;a++)L+=i[o][a]*i[a][E];if(0>e[o])P=d,O=L;else if(l=o,0===e[o]?i[o][E]=0===d?-L/(T*k):-L/d:(m=i[o+1][o],i[o][E]=f=((p=i[o][o+1])*O-P*L)/(D=(n[o]-C)*(n[o]-C)+e[o]*e[o]),i[o+1][E]=u(p)>u(P)?(-L-d*f)/p:(-O-m*f)/P),1<T*(f=u(i[o][E]))*f)for(a=o;a<=E;a++)i[a][E]/=f}else if(0>D)for(l=E-1,u(i[E][E-1])>u(i[E-1][E])?(i[E-1][E-1]=D/i[E][E-1],i[E-1][E]=-(i[E][E]-C)/i[E][E-1]):(_=c(0,-i[E-1][E],i[E-1][E-1]-C,D),i[E-1][E-1]=_[0],i[E-1][E]=_[1]),i[E][E-1]=0,i[E][E]=1,o=E-2;0<=o;o--){for(g=0,y=0,a=l;a<=E;a++)g+=i[o][a]*i[a][E-1],y+=i[o][a]*i[a][E];if(d=i[o][o]-C,0>e[o])P=d,L=g,O=y;else if(l=o,0===e[o]?(_=c(-g,-y,d,D),i[o][E-1]=_[0],i[o][E]=_[1]):(p=i[o][o+1],m=i[o+1][o],b=2*(n[o]-C)*D,0==(w=(n[o]-C)*(n[o]-C)+e[o]*e[o]-D*D)&&0===b&&(w=T*k*(u(d)+u(D)+u(p)+u(m)+u(P))),_=c(p*L-P*g+D*y,p*O-P*y-D*g,w,b),i[o][E-1]=_[0],i[o][E]=_[1],u(p)>u(P)+u(D)?(i[o+1][E-1]=(-g-d*i[o][E-1]+D*i[o][E])/p,i[o+1][E]=(-y-d*i[o][E]-D*i[o][E-1])/p):(_=c(-L-m*i[o][E-1],-O-m*i[o][E],P,D),i[o+1][E-1]=_[0],i[o+1][E]=_[1])),1<T*(f=M(u(i[o][E-1]),u(i[o][E])))*f)for(a=o;a<=E;a++)i[a][E-1]=i[a][E-1]/f,i[a][E]/=f}for(o=0;o<t;o++)if(o<0||o>S)for(a=o;a<t;a++)r[o][a]=i[o][a];for(a=t-1;a>=0;a--)for(o=0;o<=S;o++){for(P=0,s=0;s<=v(a,S);s++)P+=r[o][s]*i[s][a];r[o][a]=P}}}function c(t,e,n,r){var i,o;return u(n)>u(r)?[(t+(i=r/n)*e)/(o=n+i*r),(e-i*t)/o]:[((i=n/r)*t+e)/(o=r+i*n),(i*e-t)/o]}var l=n(7).Matrix,h=n(41),f=h.hypotenuse,d=h.getFilled2DArray,p={assumeSymmetric:!1};r.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return l.isMatrix(this.V)||(this.V=new l(this.V)),this.V},get diagonalMatrix(){var t,e,n=this.n,r=this.e,i=this.d,o=new l(n,n);for(t=0;t<n;t++){for(e=0;e<n;e++)o[t][e]=0;o[t][t]=i[t],0<r[t]?o[t][t+1]=r[t]:0>r[t]&&(o[t][t-1]=r[t])}return o}},t.exports=r},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);var e,n,a,s,u=(t=i.checkMatrix(t)).clone(),c=t.rows,l=t.columns,h=Array(l);for(a=0;a<l;a++){var f=0;for(e=a;e<c;e++)f=o(f,u[e][a]);if(0!==f){for(0>u[a][a]&&(f=-f),e=a;e<c;e++)u[e][a]/=f;for(u[a][a]+=1,n=a+1;n<l;n++){for(s=0,e=a;e<c;e++)s+=u[e][a]*u[e][n];for(s=-s/u[a][a],e=a;e<c;e++)u[e][n]+=s*u[e][a]}}h[a]=-f}this.QR=u,this.Rdiag=h}var i=n(7).Matrix,o=n(41).hypotenuse;r.prototype={solve:function(t){t=i.checkMatrix(t);var e=this.QR,n=e.rows;if(t.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var r,o,a,s,u=t.columns,c=t.clone(),l=e.columns;for(a=0;a<l;a++)for(o=0;o<u;o++){for(s=0,r=a;r<n;r++)s+=e[r][a]*c[r][o];for(s=-s/e[a][a],r=a;r<n;r++)c[r][o]+=s*e[r][a]}for(a=l-1;0<=a;a--){for(o=0;o<u;o++)c[a][o]/=this.Rdiag[a];for(r=0;r<a;r++)for(o=0;o<u;o++)c[r][o]-=c[a][o]*e[r][a]}return c.subMatrix(0,l-1,0,u-1)},isFullRank:function(){for(var t=this.QR.columns,e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0},get upperTriangularMatrix(){var t,e,n=this.QR,r=n.columns,o=new i(r,r);for(t=0;t<r;t++)for(e=0;e<r;e++)o[t][e]=t<e?n[t][e]:t===e?this.Rdiag[t]:0;return o},get orthogonalMatrix(){var t,e,n,r,o=this.QR,a=o.rows,s=o.columns,u=new i(a,s);for(n=s-1;0<=n;n--){for(t=0;t<a;t++)u[t][n]=0;for(u[n][n]=1,e=n;e<s;e++)if(0!==o[n][n]){for(r=0,t=n;t<a;t++)r+=o[t][n]*u[t][e];for(r=-r/o[n][n],t=n;t<a;t++)u[t][e]+=r*o[t][n]}}return u}},t.exports=r},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);if(!(t=i.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");var e,n,o,a=t,s=a.rows,u=new i(s,s),c=!0;for(n=0;n<s;n++){var l=u[n],h=0;for(o=0;o<n;o++){var f=u[o],d=0;for(e=0;e<o;e++)d+=f[e]*l[e];l[o]=d=(a[n][o]-d)/u[o][o],h+=d*d}for(c&=0<(h=a[n][n]-h),u[n][n]=R(M(h,0)),o=n+1;o<s;o++)u[n][o]=0}if(!c)throw new Error("Matrix is not positive definite");this.L=u}var i=n(7).Matrix;r.prototype={get lowerTriangularMatrix(){return this.L},solve:function(t){t=i.checkMatrix(t);var e=this.L,n=e.rows;if(t.rows!==n)throw new Error("Matrix dimensions do not match");var r,o,a,s=t.columns,u=t.clone();for(a=0;a<n;a++)for(o=0;o<s;o++){for(r=0;r<a;r++)u[a][o]-=u[r][o]*e[a][r];u[a][o]/=e[a][a]}for(a=n-1;0<=a;a--)for(o=0;o<s;o++){for(r=a+1;r<n;r++)u[a][o]-=u[r][o]*e[r][a];u[a][o]/=e[a][a]}return u}},t.exports=r},function(t,e,n){"use strict";t.exports=n(8).Matrix,t.exports.Decompositions=t.exports.DC=n(249)},function(){"use strict";Symbol.species||(Symbol.species=Symbol.for("@@species"))},function(t,e,n){"use strict";var r=n(18);t.exports=class extends r{constructor(t){super(t,t.columns,t.rows)}set(t,e,n){return this.matrix.set(e,t,n),this}get(t,e){return this.matrix.get(e,t)}}},function(t,e,n){"use strict";var r=n(18);t.exports=class extends r{constructor(t,e){super(t,1,t.columns),this.row=e}set(t,e,n){return this.matrix.set(this.row,e,n),this}get(t,e){return this.matrix.get(this.row,e)}}},function(t,e,n){"use strict";var r=n(18),i=n(27);t.exports=class extends r{constructor(t,e,n,r,o){i.checkRange(t,e,n,r,o),super(t,n-e+1,o-r+1),this.startRow=e,this.startColumn=r}set(t,e,n){return this.matrix.set(this.startRow+t,this.startColumn+e,n),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}}},function(t,e,n){"use strict";var r=n(18),i=n(27);t.exports=class extends r{constructor(t,e,n){var r=i.checkIndices(t,e,n);super(t,r.row.length,r.column.length),this.rowIndices=r.row,this.columnIndices=r.column}set(t,e,n){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],n),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}},function(t,e,n){"use strict";var r=n(18);t.exports=class extends r{constructor(t,e){super(t,t.rows,1),this.column=e}set(t,e,n){return this.matrix.set(t,this.column,n),this}get(t){return this.matrix.get(t,this.column)}}},function(t,e,n){"use strict";var r=n(18);t.exports=class extends r{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(this.rows-t-1,e,n),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}}},function(t,e,n){"use strict";var r=n(18);t.exports=class extends r{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(t,this.columns-e-1,n),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}}},function(t,e,n){"use strict";function r(t){return i(t=o.checkMatrix(t),o.eye(t.rows))}function i(t,e){return t=o.checkMatrix(t),e=o.checkMatrix(e),t.isSquare()?new u(t).solve(e):new c(t).solve(e)}var o=n(8).Matrix,a=n(82),s=n(250),u=n(81),c=n(251),l=n(252);o.inverse=o.inv=r,o.prototype.inverse=o.prototype.inv=function(){return r(this)},o.solve=i,o.prototype.solve=function(t){return i(this,t)},t.exports={SingularValueDecomposition:a,SVD:a,EigenvalueDecomposition:s,EVD:s,LuDecomposition:u,LU:u,QrDecomposition:c,QR:c,CholeskyDecomposition:l,CHO:l,inverse:r,solve:i}},function(t,e,n){"use strict";function r(t,e){if(e=Object.assign({},p,e),!(this instanceof r))return new r(t,e);if(!(t=l.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");var n,u,c=t.columns,h=d(c,c,0),f=Array(c),m=Array(c),g=t;if(e.assumeSymmetric||t.isSymmetric()){for(n=0;n<c;n++)for(u=0;u<c;u++)h[n][u]=g.get(n,u);i(c,m,f,h),o(c,m,f,h)}else{var v=d(c,c,0),y=Array(c);for(u=0;u<c;u++)for(n=0;n<c;n++)v[n][u]=g.get(n,u);a(c,v,y,h),s(c,m,f,h,v)}this.n=c,this.e=m,this.d=f,this.V=h}function i(t,e,n,r){var i,o,a,s,c,l,h,f;for(c=0;c<t;c++)n[c]=r[t-1][c];for(s=t-1;0<s;s--){for(f=0,a=0,l=0;l<s;l++)f+=u(n[l]);if(0===f)for(e[s]=n[s-1],c=0;c<s;c++)n[c]=r[s-1][c],r[s][c]=0,r[c][s]=0;else{for(l=0;l<s;l++)n[l]/=f,a+=n[l]*n[l];for(i=n[s-1],o=R(a),0<i&&(o=-o),e[s]=f*o,a-=i*o,n[s-1]=i-o,c=0;c<s;c++)e[c]=0;for(c=0;c<s;c++){for(r[c][s]=i=n[c],o=e[c]+r[c][c]*i,l=c+1;l<=s-1;l++)o+=r[l][c]*n[l],e[l]+=r[l][c]*i;e[c]=o}for(i=0,c=0;c<s;c++)e[c]/=a,i+=e[c]*n[c];for(h=i/(a+a),c=0;c<s;c++)e[c]-=h*n[c];for(c=0;c<s;c++){for(i=n[c],o=e[c],l=c;l<=s-1;l++)r[l][c]-=i*e[l]+o*n[l];n[c]=r[s-1][c],r[s][c]=0}}n[s]=a}for(s=0;s<t-1;s++){if(r[t-1][s]=r[s][s],r[s][s]=1,0!==(a=n[s+1])){for(l=0;l<=s;l++)n[l]=r[l][s+1]/a;for(c=0;c<=s;c++){for(o=0,l=0;l<=s;l++)o+=r[l][s+1]*r[l][c];for(l=0;l<=s;l++)r[l][c]-=o*n[l]}}for(l=0;l<=s;l++)r[l][s+1]=0}for(c=0;c<t;c++)n[c]=r[t-1][c],r[t-1][c]=0;r[t-1][t-1]=1,e[0]=0}function o(t,e,n,r){var i,o,a,s,c,l,h,d,p,m,g,v,y,w,b,x;for(a=1;a<t;a++)e[a-1]=e[a];e[t-1]=0;var _=0,E=0,S=2.220446049250313e-16;for(l=0;l<t;l++){for(E=M(E,u(n[l])+u(e[l])),h=l;h<t&&!(u(e[h])<=S*E);)h++;if(h>l)do{for(p=f(d=(n[l+1]-(i=n[l]))/(2*e[l]),1),0>d&&(p=-p),n[l]=e[l]/(d+p),n[l+1]=e[l]*(d+p),m=n[l+1],o=i-n[l],a=l+2;a<t;a++)n[a]-=o;for(_+=o,d=n[h],v=g=1,y=g,w=e[l+1],b=0,x=0,a=h-1;a>=l;a--)for(y=v,v=g,x=b,i=g*e[a],o=g*d,p=f(d,e[a]),e[a+1]=b*p,d=(g=d/p)*n[a]-(b=e[a]/p)*i,n[a+1]=o+b*(g*i+b*n[a]),c=0;c<t;c++)r[c][a+1]=b*r[c][a]+g*(o=r[c][a+1]),r[c][a]=g*r[c][a]-b*o;e[l]=b*(d=-b*x*y*w*e[l]/m),n[l]=g*d}while(u(e[l])>S*E);n[l]+=_,e[l]=0}for(a=0;a<t-1;a++){for(c=a,d=n[a],s=a+1;s<t;s++)n[s]<d&&(c=s,d=n[s]);if(c!==a)for(n[c]=n[a],n[a]=d,s=0;s<t;s++)d=r[s][a],r[s][a]=r[s][c],r[s][c]=d}}function a(t,e,n,r){var i,o,a,s,c,l,h,f=t-1;for(l=1;l<=f-1;l++){for(h=0,s=l;s<=f;s++)h+=u(e[s][l-1]);if(0!==h){for(a=0,s=f;s>=l;s--)n[s]=e[s][l-1]/h,a+=n[s]*n[s];for(o=R(a),0<n[l]&&(o=-o),a-=n[l]*o,n[l]-=o,c=l;c<t;c++){for(i=0,s=f;s>=l;s--)i+=n[s]*e[s][c];for(i/=a,s=l;s<=f;s++)e[s][c]-=i*n[s]}for(s=0;s<=f;s++){for(i=0,c=f;c>=l;c--)i+=n[c]*e[s][c];for(i/=a,c=l;c<=f;c++)e[s][c]-=i*n[c]}n[l]=h*n[l],e[l][l-1]=h*o}}for(s=0;s<t;s++)for(c=0;c<t;c++)r[s][c]=s===c?1:0;for(l=f-1;l>=1;l--)if(0!==e[l][l-1]){for(s=l+1;s<=f;s++)n[s]=e[s][l-1];for(c=l;c<=f;c++){for(o=0,s=l;s<=f;s++)o+=n[s]*r[s][c];for(o=o/n[l]/e[l][l-1],s=l;s<=f;s++)r[s][c]+=o*n[s]}}}function s(t,e,n,r,i){var o,a,s,l,h,f,d,p,m,g,y,w,b,x,_,E=t-1,S=t-1,T=2.220446049250313e-16,A=0,k=0,C=0,D=0,L=0,O=0,P=0,I=0;for(o=0;o<t;o++)for((o<0||o>S)&&(n[o]=i[o][o],e[o]=0),a=M(o-1,0);a<t;a++)k+=u(i[o][a]);for(;E>=0;){for(l=E;l>0&&(0===(O=u(i[l-1][l-1])+u(i[l][l]))&&(O=k),!(u(i[l][l-1])<T*O));)l--;if(l===E)i[E][E]+=A,n[E]=i[E][E],e[E]=0,E--,I=0;else if(l===E-1){if(P=R(u(D=(C=(i[E-1][E-1]-i[E][E])/2)*C+(d=i[E][E-1]*i[E-1][E]))),i[E][E]+=A,i[E-1][E-1]=i[E-1][E-1]+A,p=i[E][E],0<=D){for(n[E-1]=p+(P=0<=C?C+P:C-P),n[E]=n[E-1],0!==P&&(n[E]=p-d/P),e[E-1]=0,e[E]=0,C=(p=i[E][E-1])/(O=u(p)+u(P)),C/=L=R(C*C+(D=P/O)*D),D/=L,a=E-1;a<t;a++)i[E-1][a]=D*(P=i[E-1][a])+C*i[E][a],i[E][a]=D*i[E][a]-C*P;for(o=0;o<=E;o++)i[o][E-1]=D*(P=i[o][E-1])+C*i[o][E],i[o][E]=D*i[o][E]-C*P;for(o=0;o<=S;o++)r[o][E-1]=D*(P=r[o][E-1])+C*r[o][E],r[o][E]=D*r[o][E]-C*P}else n[E-1]=p+C,n[E]=p+C,e[E-1]=P,e[E]=-P;E-=2,I=0}else{if(p=i[E][E],m=0,d=0,l<E&&(m=i[E-1][E-1],d=i[E][E-1]*i[E-1][E]),10==I){for(A+=p,o=0;o<=E;o++)i[o][o]-=p;p=m=.75*(O=u(i[E][E-1])+u(i[E-1][E-2])),d=-.4375*O*O}if(30==I&&0<(O=(O=(m-p)/2)*O+d)){for(O=R(O),m<p&&(O=-O),O=p-d/((m-p)/2+O),o=0;o<=E;o++)i[o][o]-=O;A+=O,p=m=d=.964}for(++I,h=E-2;h>=l&&(C=((L=p-(P=i[h][h]))*(O=m-P)-d)/i[h+1][h]+i[h][h+1],D=i[h+1][h+1]-P-L-O,L=i[h+2][h+1],C/=O=u(C)+u(D)+u(L),D/=O,L/=O,h!==l)&&!(u(i[h][h-1])*(u(D)+u(L))<T*(u(C)*(u(i[h-1][h-1])+u(P)+u(i[h+1][h+1]))));)h--;for(o=h+2;o<=E;o++)i[o][o-2]=0,o>h+2&&(i[o][o-3]=0);for(s=h;s<=E-1&&(x=s!==E-1,s!==h&&(C=i[s][s-1],D=i[s+1][s-1],L=x?i[s+2][s-1]:0,0!==(p=u(C)+u(D)+u(L))&&(C/=p,D/=p,L/=p)),0!==p);s++)if(O=R(C*C+D*D+L*L),0>C&&(O=-O),0!==O){for(s===h?l!==h&&(i[s][s-1]=-i[s][s-1]):i[s][s-1]=-O*p,p=(C+=O)/O,m=D/O,P=L/O,D/=C,L/=C,a=s;a<t;a++)C=i[s][a]+D*i[s+1][a],x&&(i[s+2][a]=i[s+2][a]-(C+=L*i[s+2][a])*P),i[s][a]-=C*p,i[s+1][a]=i[s+1][a]-C*m;for(o=0;o<=v(E,s+3);o++)C=p*i[o][s]+m*i[o][s+1],x&&(i[o][s+2]=i[o][s+2]-(C+=P*i[o][s+2])*L),i[o][s]-=C,i[o][s+1]=i[o][s+1]-C*D;for(o=0;o<=S;o++)C=p*r[o][s]+m*r[o][s+1],x&&(r[o][s+2]=r[o][s+2]-(C+=P*r[o][s+2])*L),r[o][s]-=C,r[o][s+1]=r[o][s+1]-C*D}}}if(0!==k){for(E=t-1;0<=E;E--)if(C=n[E],0===(D=e[E]))for(l=E,i[E][E]=1,o=E-1;0<=o;o--){for(d=i[o][o]-C,L=0,a=l;a<=E;a++)L+=i[o][a]*i[a][E];if(0>e[o])P=d,O=L;else if(l=o,0===e[o]?i[o][E]=0===d?-L/(T*k):-L/d:(m=i[o+1][o],i[o][E]=f=((p=i[o][o+1])*O-P*L)/(D=(n[o]-C)*(n[o]-C)+e[o]*e[o]),i[o+1][E]=u(p)>u(P)?(-L-d*f)/p:(-O-m*f)/P),1<T*(f=u(i[o][E]))*f)for(a=o;a<=E;a++)i[a][E]/=f}else if(0>D)for(l=E-1,u(i[E][E-1])>u(i[E-1][E])?(i[E-1][E-1]=D/i[E][E-1],i[E-1][E]=-(i[E][E]-C)/i[E][E-1]):(_=c(0,-i[E-1][E],i[E-1][E-1]-C,D),i[E-1][E-1]=_[0],i[E-1][E]=_[1]),i[E][E-1]=0,i[E][E]=1,o=E-2;0<=o;o--){for(g=0,y=0,a=l;a<=E;a++)g+=i[o][a]*i[a][E-1],y+=i[o][a]*i[a][E];if(d=i[o][o]-C,0>e[o])P=d,L=g,O=y;else if(l=o,0===e[o]?(_=c(-g,-y,d,D),i[o][E-1]=_[0],i[o][E]=_[1]):(p=i[o][o+1],m=i[o+1][o],b=2*(n[o]-C)*D,0==(w=(n[o]-C)*(n[o]-C)+e[o]*e[o]-D*D)&&0===b&&(w=T*k*(u(d)+u(D)+u(p)+u(m)+u(P))),_=c(p*L-P*g+D*y,p*O-P*y-D*g,w,b),i[o][E-1]=_[0],i[o][E]=_[1],u(p)>u(P)+u(D)?(i[o+1][E-1]=(-g-d*i[o][E-1]+D*i[o][E])/p,i[o+1][E]=(-y-d*i[o][E]-D*i[o][E-1])/p):(_=c(-L-m*i[o][E-1],-O-m*i[o][E],P,D),i[o+1][E-1]=_[0],i[o+1][E]=_[1])),1<T*(f=M(u(i[o][E-1]),u(i[o][E])))*f)for(a=o;a<=E;a++)i[a][E-1]=i[a][E-1]/f,i[a][E]/=f}for(o=0;o<t;o++)if(o<0||o>S)for(a=o;a<t;a++)r[o][a]=i[o][a];for(a=t-1;a>=0;a--)for(o=0;o<=S;o++){for(P=0,s=0;s<=v(a,S);s++)P+=r[o][s]*i[s][a];r[o][a]=P}}}function c(t,e,n,r){var i,o;return u(n)>u(r)?[(t+(i=r/n)*e)/(o=n+i*r),(e-i*t)/o]:[((i=n/r)*t+e)/(o=r+i*n),(i*e-t)/o]}var l=n(8).Matrix,h=n(42),f=h.hypotenuse,d=h.getFilled2DArray,p={assumeSymmetric:!1};r.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return l.isMatrix(this.V)||(this.V=new l(this.V)),this.V},get diagonalMatrix(){var t,e,n=this.n,r=this.e,i=this.d,o=new l(n,n);for(t=0;t<n;t++){for(e=0;e<n;e++)o[t][e]=0;o[t][t]=i[t],0<r[t]?o[t][t+1]=r[t]:0>r[t]&&(o[t][t-1]=r[t])}return o}},t.exports=r},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);var e,n,a,s,u=(t=i.checkMatrix(t)).clone(),c=t.rows,l=t.columns,h=Array(l);for(a=0;a<l;a++){var f=0;for(e=a;e<c;e++)f=o(f,u[e][a]);if(0!==f){for(0>u[a][a]&&(f=-f),e=a;e<c;e++)u[e][a]/=f;for(u[a][a]+=1,n=a+1;n<l;n++){for(s=0,e=a;e<c;e++)s+=u[e][a]*u[e][n];for(s=-s/u[a][a],e=a;e<c;e++)u[e][n]+=s*u[e][a]}}h[a]=-f}this.QR=u,this.Rdiag=h}var i=n(8).Matrix,o=n(42).hypotenuse;r.prototype={solve:function(t){t=i.checkMatrix(t);var e=this.QR,n=e.rows;if(t.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var r,o,a,s,u=t.columns,c=t.clone(),l=e.columns;for(a=0;a<l;a++)for(o=0;o<u;o++){for(s=0,r=a;r<n;r++)s+=e[r][a]*c[r][o];for(s=-s/e[a][a],r=a;r<n;r++)c[r][o]+=s*e[r][a]}for(a=l-1;0<=a;a--){for(o=0;o<u;o++)c[a][o]/=this.Rdiag[a];for(r=0;r<a;r++)for(o=0;o<u;o++)c[r][o]-=c[a][o]*e[r][a]}return c.subMatrix(0,l-1,0,u-1)},isFullRank:function(){for(var t=this.QR.columns,e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0},get upperTriangularMatrix(){var t,e,n=this.QR,r=n.columns,o=new i(r,r);for(t=0;t<r;t++)for(e=0;e<r;e++)o[t][e]=t<e?n[t][e]:t===e?this.Rdiag[t]:0;return o},get orthogonalMatrix(){var t,e,n,r,o=this.QR,a=o.rows,s=o.columns,u=new i(a,s);for(n=s-1;0<=n;n--){for(t=0;t<a;t++)u[t][n]=0;for(u[n][n]=1,e=n;e<s;e++)if(0!==o[n][n]){for(r=0,t=n;t<a;t++)r+=o[t][n]*u[t][e];for(r=-r/o[n][n],t=n;t<a;t++)u[t][e]+=r*o[t][n]}}return u}},t.exports=r},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);if(!(t=i.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");var e,n,o,a=t,s=a.rows,u=new i(s,s),c=!0;for(n=0;n<s;n++){var l=u[n],h=0;for(o=0;o<n;o++){var f=u[o],d=0;for(e=0;e<o;e++)d+=f[e]*l[e];l[o]=d=(a[n][o]-d)/u[o][o],h+=d*d}for(c&=0<(h=a[n][n]-h),u[n][n]=R(M(h,0)),o=n+1;o<s;o++)u[n][o]=0}if(!c)throw new Error("Matrix is not positive definite");this.L=u}var i=n(8).Matrix;r.prototype={get lowerTriangularMatrix(){return this.L},solve:function(t){t=i.checkMatrix(t);var e=this.L,n=e.rows;if(t.rows!==n)throw new Error("Matrix dimensions do not match");var r,o,a,s=t.columns,u=t.clone();for(a=0;a<n;a++)for(o=0;o<s;o++){for(r=0;r<a;r++)u[a][o]-=u[r][o]*e[a][r];u[a][o]/=e[a][a]}for(a=n-1;0<=a;a--)for(o=0;o<s;o++){for(r=a+1;r<n;r++)u[a][o]-=u[r][o]*e[r][a];u[a][o]/=e[a][a]}return u}},t.exports=r},function(t,e,n){"use strict";var r=n(254),i=n(255),o={damping:void 0,gradientDifference:.1,initialValues:void 0,maxIterations:100,errorTolerance:.01};t.exports=function(t,e,n){if(!n||!n.damping||0>=n.damping)throw new TypeError("The damping option should be a positive number");if(!(n=Object.assign({},o,n)).initialValues){n.initialValues=Array(e.length);for(var a=0;a<e.length;a++)n.initialValues[a]=1}if(!t.x||!t.y)throw new TypeError("The data parameter should have a x and y elements");if(t.x.constructor!==Array||2>t.x.length||t.y.constructor!==Array||2>t.y.length)throw new TypeError("The data parameter elements should be an array with more than 2 points");if(t.x.length!==t.y.length)throw new RangeError("The data parameter elements should have the same size");for(var s=n.initialValues,u=r(t,s,e),c=u<=n.errorTolerance,l=0;l<n.maxIterations&&!c;l++)s=i(t,s,n.damping,n.gradientDifference,e),c=(u=r(t,s,e))<=n.errorTolerance;return{parameterValues:s,parameterError:u,iterations:l}}},function(t){"use strict";t.exports=function(t,e,n){for(var r=0,i=n(...e),o=0;o<t.x.length;o++)r+=u(t.y[o]-i(t.x[o]));return r}},function(t,e,n){"use strict";var r=n(256);t.exports=function(t,e,n,i,o){var a=r.eye(o.length).mul(n*i*i),s=function(t,e,n,i){for(var o=i.length,a=t.x.length,s=Array(o),u=i(...e),c=0;c<o;c++){s[c]=Array(a);var l=e.concat();l[c]+=n;for(var h=i(...l),f=0;f<a;f++)s[c][f]=u(t.x[f])-h(t.x[f])}return new r(s)}(t,e,i,o),u=function(t,e,n){for(var i=t.x.length,o=Array(i),a=n(...e),s=0;s<i;s++)o[s]=t.y[s]-a(t.x[s]);return new r([o])}(t,e,o).transpose();e=new r([e]);var c=r.inv(a.add(s.mmul(s.transposeView())));return(e=e.sub(c.mmul(s).mmul(u).mul(i).transposeView())).to1DArray()}},function(t,e,n){"use strict";t.exports=n(9).Matrix,t.exports.Decompositions=t.exports.DC=n(265)},function(){"use strict";Symbol.species||(Symbol.species=Symbol.for("@@species"))},function(t,e,n){"use strict";var r=n(19);t.exports=class extends r{constructor(t){super(t,t.columns,t.rows)}set(t,e,n){return this.matrix.set(e,t,n),this}get(t,e){return this.matrix.get(e,t)}}},function(t,e,n){"use strict";var r=n(19);t.exports=class extends r{constructor(t,e){super(t,1,t.columns),this.row=e}set(t,e,n){return this.matrix.set(this.row,e,n),this}get(t,e){return this.matrix.get(this.row,e)}}},function(t,e,n){"use strict";var r=n(19),i=n(28);t.exports=class extends r{constructor(t,e,n,r,o){i.checkRange(t,e,n,r,o),super(t,n-e+1,o-r+1),this.startRow=e,this.startColumn=r}set(t,e,n){return this.matrix.set(this.startRow+t,this.startColumn+e,n),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}}},function(t,e,n){"use strict";var r=n(19),i=n(28);t.exports=class extends r{constructor(t,e,n){var r=i.checkIndices(t,e,n);super(t,r.row.length,r.column.length),this.rowIndices=r.row,this.columnIndices=r.column}set(t,e,n){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],n),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}},function(t,e,n){"use strict";var r=n(19);t.exports=class extends r{constructor(t,e){super(t,t.rows,1),this.column=e}set(t,e,n){return this.matrix.set(t,this.column,n),this}get(t){return this.matrix.get(t,this.column)}}},function(t,e,n){"use strict";var r=n(19);t.exports=class extends r{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(this.rows-t-1,e,n),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}}},function(t,e,n){"use strict";var r=n(19);t.exports=class extends r{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(t,this.columns-e-1,n),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}}},function(t,e,n){"use strict";function r(t){return i(t=o.checkMatrix(t),o.eye(t.rows))}function i(t,e){return t=o.checkMatrix(t),e=o.checkMatrix(e),t.isSquare()?new u(t).solve(e):new c(t).solve(e)}var o=n(9).Matrix,a=n(85),s=n(266),u=n(84),c=n(267),l=n(268);o.inverse=o.inv=r,o.prototype.inverse=o.prototype.inv=function(){return r(this)},o.solve=i,o.prototype.solve=function(t){return i(this,t)},t.exports={SingularValueDecomposition:a,SVD:a,EigenvalueDecomposition:s,EVD:s,LuDecomposition:u,LU:u,QrDecomposition:c,QR:c,CholeskyDecomposition:l,CHO:l,inverse:r,solve:i}},function(t,e,n){"use strict";function r(t,e){if(e=Object.assign({},p,e),!(this instanceof r))return new r(t,e);if(!(t=l.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");var n,u,c=t.columns,h=d(c,c,0),f=Array(c),m=Array(c),g=t;if(e.assumeSymmetric||t.isSymmetric()){for(n=0;n<c;n++)for(u=0;u<c;u++)h[n][u]=g.get(n,u);i(c,m,f,h),o(c,m,f,h)}else{var v=d(c,c,0),y=Array(c);for(u=0;u<c;u++)for(n=0;n<c;n++)v[n][u]=g.get(n,u);a(c,v,y,h),s(c,m,f,h,v)}this.n=c,this.e=m,this.d=f,this.V=h}function i(t,e,n,r){var i,o,a,s,c,l,h,f;for(c=0;c<t;c++)n[c]=r[t-1][c];for(s=t-1;0<s;s--){for(f=0,a=0,l=0;l<s;l++)f+=u(n[l]);if(0===f)for(e[s]=n[s-1],c=0;c<s;c++)n[c]=r[s-1][c],r[s][c]=0,r[c][s]=0;else{for(l=0;l<s;l++)n[l]/=f,a+=n[l]*n[l];for(i=n[s-1],o=R(a),0<i&&(o=-o),e[s]=f*o,a-=i*o,n[s-1]=i-o,c=0;c<s;c++)e[c]=0;for(c=0;c<s;c++){for(r[c][s]=i=n[c],o=e[c]+r[c][c]*i,l=c+1;l<=s-1;l++)o+=r[l][c]*n[l],e[l]+=r[l][c]*i;e[c]=o}for(i=0,c=0;c<s;c++)e[c]/=a,i+=e[c]*n[c];for(h=i/(a+a),c=0;c<s;c++)e[c]-=h*n[c];for(c=0;c<s;c++){for(i=n[c],o=e[c],l=c;l<=s-1;l++)r[l][c]-=i*e[l]+o*n[l];n[c]=r[s-1][c],r[s][c]=0}}n[s]=a}for(s=0;s<t-1;s++){if(r[t-1][s]=r[s][s],r[s][s]=1,0!==(a=n[s+1])){for(l=0;l<=s;l++)n[l]=r[l][s+1]/a;for(c=0;c<=s;c++){for(o=0,l=0;l<=s;l++)o+=r[l][s+1]*r[l][c];for(l=0;l<=s;l++)r[l][c]-=o*n[l]}}for(l=0;l<=s;l++)r[l][s+1]=0}for(c=0;c<t;c++)n[c]=r[t-1][c],r[t-1][c]=0;r[t-1][t-1]=1,e[0]=0}function o(t,e,n,r){var i,o,a,s,c,l,h,d,p,m,g,v,y,w,b,x;for(a=1;a<t;a++)e[a-1]=e[a];e[t-1]=0;var _=0,E=0,S=2.220446049250313e-16;for(l=0;l<t;l++){for(E=M(E,u(n[l])+u(e[l])),h=l;h<t&&!(u(e[h])<=S*E);)h++;if(h>l)do{for(p=f(d=(n[l+1]-(i=n[l]))/(2*e[l]),1),0>d&&(p=-p),n[l]=e[l]/(d+p),n[l+1]=e[l]*(d+p),m=n[l+1],o=i-n[l],a=l+2;a<t;a++)n[a]-=o;for(_+=o,d=n[h],v=g=1,y=g,w=e[l+1],b=0,x=0,a=h-1;a>=l;a--)for(y=v,v=g,x=b,i=g*e[a],o=g*d,p=f(d,e[a]),e[a+1]=b*p,d=(g=d/p)*n[a]-(b=e[a]/p)*i,n[a+1]=o+b*(g*i+b*n[a]),c=0;c<t;c++)r[c][a+1]=b*r[c][a]+g*(o=r[c][a+1]),r[c][a]=g*r[c][a]-b*o;e[l]=b*(d=-b*x*y*w*e[l]/m),n[l]=g*d}while(u(e[l])>S*E);n[l]+=_,e[l]=0}for(a=0;a<t-1;a++){for(c=a,d=n[a],s=a+1;s<t;s++)n[s]<d&&(c=s,d=n[s]);if(c!==a)for(n[c]=n[a],n[a]=d,s=0;s<t;s++)d=r[s][a],r[s][a]=r[s][c],r[s][c]=d}}function a(t,e,n,r){var i,o,a,s,c,l,h,f=t-1;for(l=1;l<=f-1;l++){for(h=0,s=l;s<=f;s++)h+=u(e[s][l-1]);if(0!==h){for(a=0,s=f;s>=l;s--)n[s]=e[s][l-1]/h,a+=n[s]*n[s];for(o=R(a),0<n[l]&&(o=-o),a-=n[l]*o,n[l]-=o,c=l;c<t;c++){for(i=0,s=f;s>=l;s--)i+=n[s]*e[s][c];for(i/=a,s=l;s<=f;s++)e[s][c]-=i*n[s]}for(s=0;s<=f;s++){for(i=0,c=f;c>=l;c--)i+=n[c]*e[s][c];for(i/=a,c=l;c<=f;c++)e[s][c]-=i*n[c]}n[l]=h*n[l],e[l][l-1]=h*o}}for(s=0;s<t;s++)for(c=0;c<t;c++)r[s][c]=s===c?1:0;for(l=f-1;l>=1;l--)if(0!==e[l][l-1]){for(s=l+1;s<=f;s++)n[s]=e[s][l-1];for(c=l;c<=f;c++){for(o=0,s=l;s<=f;s++)o+=n[s]*r[s][c];for(o=o/n[l]/e[l][l-1],s=l;s<=f;s++)r[s][c]+=o*n[s]}}}function s(t,e,n,r,i){var o,a,s,l,h,f,d,p,m,g,y,w,b,x,_,E=t-1,S=t-1,T=2.220446049250313e-16,A=0,k=0,C=0,D=0,L=0,O=0,P=0,I=0;for(o=0;o<t;o++)for((o<0||o>S)&&(n[o]=i[o][o],e[o]=0),a=M(o-1,0);a<t;a++)k+=u(i[o][a]);for(;E>=0;){for(l=E;l>0&&(0===(O=u(i[l-1][l-1])+u(i[l][l]))&&(O=k),!(u(i[l][l-1])<T*O));)l--;if(l===E)i[E][E]+=A,n[E]=i[E][E],e[E]=0,E--,I=0;else if(l===E-1){if(P=R(u(D=(C=(i[E-1][E-1]-i[E][E])/2)*C+(d=i[E][E-1]*i[E-1][E]))),i[E][E]+=A,i[E-1][E-1]=i[E-1][E-1]+A,p=i[E][E],0<=D){for(n[E-1]=p+(P=0<=C?C+P:C-P),n[E]=n[E-1],0!==P&&(n[E]=p-d/P),e[E-1]=0,e[E]=0,C=(p=i[E][E-1])/(O=u(p)+u(P)),C/=L=R(C*C+(D=P/O)*D),D/=L,a=E-1;a<t;a++)i[E-1][a]=D*(P=i[E-1][a])+C*i[E][a],i[E][a]=D*i[E][a]-C*P;for(o=0;o<=E;o++)i[o][E-1]=D*(P=i[o][E-1])+C*i[o][E],i[o][E]=D*i[o][E]-C*P;for(o=0;o<=S;o++)r[o][E-1]=D*(P=r[o][E-1])+C*r[o][E],r[o][E]=D*r[o][E]-C*P}else n[E-1]=p+C,n[E]=p+C,e[E-1]=P,e[E]=-P;E-=2,I=0}else{if(p=i[E][E],m=0,d=0,l<E&&(m=i[E-1][E-1],d=i[E][E-1]*i[E-1][E]),10==I){for(A+=p,o=0;o<=E;o++)i[o][o]-=p;p=m=.75*(O=u(i[E][E-1])+u(i[E-1][E-2])),d=-.4375*O*O}if(30==I&&0<(O=(O=(m-p)/2)*O+d)){for(O=R(O),m<p&&(O=-O),O=p-d/((m-p)/2+O),o=0;o<=E;o++)i[o][o]-=O;A+=O,p=m=d=.964}for(++I,h=E-2;h>=l&&(C=((L=p-(P=i[h][h]))*(O=m-P)-d)/i[h+1][h]+i[h][h+1],D=i[h+1][h+1]-P-L-O,L=i[h+2][h+1],C/=O=u(C)+u(D)+u(L),D/=O,L/=O,h!==l)&&!(u(i[h][h-1])*(u(D)+u(L))<T*(u(C)*(u(i[h-1][h-1])+u(P)+u(i[h+1][h+1]))));)h--;for(o=h+2;o<=E;o++)i[o][o-2]=0,o>h+2&&(i[o][o-3]=0);for(s=h;s<=E-1&&(x=s!==E-1,s!==h&&(C=i[s][s-1],D=i[s+1][s-1],L=x?i[s+2][s-1]:0,0!==(p=u(C)+u(D)+u(L))&&(C/=p,D/=p,L/=p)),0!==p);s++)if(O=R(C*C+D*D+L*L),0>C&&(O=-O),0!==O){for(s===h?l!==h&&(i[s][s-1]=-i[s][s-1]):i[s][s-1]=-O*p,p=(C+=O)/O,m=D/O,P=L/O,D/=C,L/=C,a=s;a<t;a++)C=i[s][a]+D*i[s+1][a],x&&(i[s+2][a]=i[s+2][a]-(C+=L*i[s+2][a])*P),i[s][a]-=C*p,i[s+1][a]=i[s+1][a]-C*m;for(o=0;o<=v(E,s+3);o++)C=p*i[o][s]+m*i[o][s+1],x&&(i[o][s+2]=i[o][s+2]-(C+=P*i[o][s+2])*L),i[o][s]-=C,i[o][s+1]=i[o][s+1]-C*D;for(o=0;o<=S;o++)C=p*r[o][s]+m*r[o][s+1],x&&(r[o][s+2]=r[o][s+2]-(C+=P*r[o][s+2])*L),r[o][s]-=C,r[o][s+1]=r[o][s+1]-C*D}}}if(0!==k){for(E=t-1;0<=E;E--)if(C=n[E],0===(D=e[E]))for(l=E,i[E][E]=1,o=E-1;0<=o;o--){for(d=i[o][o]-C,L=0,a=l;a<=E;a++)L+=i[o][a]*i[a][E];if(0>e[o])P=d,O=L;else if(l=o,0===e[o]?i[o][E]=0===d?-L/(T*k):-L/d:(m=i[o+1][o],i[o][E]=f=((p=i[o][o+1])*O-P*L)/(D=(n[o]-C)*(n[o]-C)+e[o]*e[o]),i[o+1][E]=u(p)>u(P)?(-L-d*f)/p:(-O-m*f)/P),1<T*(f=u(i[o][E]))*f)for(a=o;a<=E;a++)i[a][E]/=f}else if(0>D)for(l=E-1,u(i[E][E-1])>u(i[E-1][E])?(i[E-1][E-1]=D/i[E][E-1],i[E-1][E]=-(i[E][E]-C)/i[E][E-1]):(_=c(0,-i[E-1][E],i[E-1][E-1]-C,D),i[E-1][E-1]=_[0],i[E-1][E]=_[1]),i[E][E-1]=0,i[E][E]=1,o=E-2;0<=o;o--){for(g=0,y=0,a=l;a<=E;a++)g+=i[o][a]*i[a][E-1],y+=i[o][a]*i[a][E];if(d=i[o][o]-C,0>e[o])P=d,L=g,O=y;else if(l=o,0===e[o]?(_=c(-g,-y,d,D),i[o][E-1]=_[0],i[o][E]=_[1]):(p=i[o][o+1],m=i[o+1][o],b=2*(n[o]-C)*D,0==(w=(n[o]-C)*(n[o]-C)+e[o]*e[o]-D*D)&&0===b&&(w=T*k*(u(d)+u(D)+u(p)+u(m)+u(P))),_=c(p*L-P*g+D*y,p*O-P*y-D*g,w,b),i[o][E-1]=_[0],i[o][E]=_[1],u(p)>u(P)+u(D)?(i[o+1][E-1]=(-g-d*i[o][E-1]+D*i[o][E])/p,i[o+1][E]=(-y-d*i[o][E]-D*i[o][E-1])/p):(_=c(-L-m*i[o][E-1],-O-m*i[o][E],P,D),i[o+1][E-1]=_[0],i[o+1][E]=_[1])),1<T*(f=M(u(i[o][E-1]),u(i[o][E])))*f)for(a=o;a<=E;a++)i[a][E-1]=i[a][E-1]/f,i[a][E]/=f}for(o=0;o<t;o++)if(o<0||o>S)for(a=o;a<t;a++)r[o][a]=i[o][a];for(a=t-1;a>=0;a--)for(o=0;o<=S;o++){for(P=0,s=0;s<=v(a,S);s++)P+=r[o][s]*i[s][a];r[o][a]=P}}}function c(t,e,n,r){var i,o;return u(n)>u(r)?[(t+(i=r/n)*e)/(o=n+i*r),(e-i*t)/o]:[((i=n/r)*t+e)/(o=r+i*n),(i*e-t)/o]}var l=n(9).Matrix,h=n(43),f=h.hypotenuse,d=h.getFilled2DArray,p={assumeSymmetric:!1};r.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return l.isMatrix(this.V)||(this.V=new l(this.V)),this.V},get diagonalMatrix(){var t,e,n=this.n,r=this.e,i=this.d,o=new l(n,n);for(t=0;t<n;t++){for(e=0;e<n;e++)o[t][e]=0;o[t][t]=i[t],0<r[t]?o[t][t+1]=r[t]:0>r[t]&&(o[t][t-1]=r[t])}return o}},t.exports=r},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);var e,n,a,s,u=(t=i.checkMatrix(t)).clone(),c=t.rows,l=t.columns,h=Array(l);for(a=0;a<l;a++){var f=0;for(e=a;e<c;e++)f=o(f,u[e][a]);if(0!==f){for(0>u[a][a]&&(f=-f),e=a;e<c;e++)u[e][a]/=f;for(u[a][a]+=1,n=a+1;n<l;n++){for(s=0,e=a;e<c;e++)s+=u[e][a]*u[e][n];for(s=-s/u[a][a],e=a;e<c;e++)u[e][n]+=s*u[e][a]}}h[a]=-f}this.QR=u,this.Rdiag=h}var i=n(9).Matrix,o=n(43).hypotenuse;r.prototype={solve:function(t){t=i.checkMatrix(t);var e=this.QR,n=e.rows;if(t.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var r,o,a,s,u=t.columns,c=t.clone(),l=e.columns;for(a=0;a<l;a++)for(o=0;o<u;o++){for(s=0,r=a;r<n;r++)s+=e[r][a]*c[r][o];for(s=-s/e[a][a],r=a;r<n;r++)c[r][o]+=s*e[r][a]}for(a=l-1;0<=a;a--){for(o=0;o<u;o++)c[a][o]/=this.Rdiag[a];for(r=0;r<a;r++)for(o=0;o<u;o++)c[r][o]-=c[a][o]*e[r][a]}return c.subMatrix(0,l-1,0,u-1)},isFullRank:function(){for(var t=this.QR.columns,e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0},get upperTriangularMatrix(){var t,e,n=this.QR,r=n.columns,o=new i(r,r);for(t=0;t<r;t++)for(e=0;e<r;e++)o[t][e]=t<e?n[t][e]:t===e?this.Rdiag[t]:0;return o},get orthogonalMatrix(){var t,e,n,r,o=this.QR,a=o.rows,s=o.columns,u=new i(a,s);for(n=s-1;0<=n;n--){for(t=0;t<a;t++)u[t][n]=0;for(u[n][n]=1,e=n;e<s;e++)if(0!==o[n][n]){for(r=0,t=n;t<a;t++)r+=o[t][n]*u[t][e];for(r=-r/o[n][n],t=n;t<a;t++)u[t][e]+=r*o[t][n]}}return u}},t.exports=r},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);if(!(t=i.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");var e,n,o,a=t,s=a.rows,u=new i(s,s),c=!0;for(n=0;n<s;n++){var l=u[n],h=0;for(o=0;o<n;o++){var f=u[o],d=0;for(e=0;e<o;e++)d+=f[e]*l[e];l[o]=d=(a[n][o]-d)/u[o][o],h+=d*d}for(c&=0<(h=a[n][n]-h),u[n][n]=R(M(h,0)),o=n+1;o<s;o++)u[n][o]=0}if(!c)throw new Error("Matrix is not positive definite");this.L=u}var i=n(9).Matrix;r.prototype={get lowerTriangularMatrix(){return this.L},solve:function(t){t=i.checkMatrix(t);var e=this.L,n=e.rows;if(t.rows!==n)throw new Error("Matrix dimensions do not match");var r,o,a,s=t.columns,u=t.clone();for(a=0;a<n;a++)for(o=0;o<s;o++){for(r=0;r<a;r++)u[a][o]-=u[r][o]*e[a][r];u[a][o]/=e[a][a]}for(a=n-1;0<=a;a--)for(o=0;o<s;o++){for(r=a+1;r<n;r++)u[a][o]-=u[r][o]*e[r][a];u[a][o]/=e[a][a]}return u}},t.exports=r},function(t,e){"use strict";function n(t,e){var n=65535&(t>>>=0);return((t-n)*(e>>>=0)>>>0)+n*e>>>0}function r(t){var e=t.state[0];e^=e<<a,e^=e>>>s,e^=t.state[3]<<u,t.state[0]=t.state[1],t.state[1]=t.state[2],t.state[2]=t.state[3],t.state[3]=e}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n,r=0;r<e.length;r++)(n=e[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(){var e=0>=arguments.length||void 0===arguments[0]?Date.now():arguments[0];(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.state=new Uint32Array(4),this.init(e)}return i(t,[{key:"init",value:function(t){this.state[0]=t,this.state[1]=0,this.state[2]=0,this.state[3]=0;for(var e=1;e<8;e++)this.state[3&e]^=e+n(1812433253,this.state[3&e-1]^this.state[3&e-1]>>>30>>>0)>>>0;for(function(t){0===t.state[0]&&0===t.state[1]&&0===t.state[2]&&0===t.state[3]&&(t.state[0]=88,t.state[1]=83,t.state[2]=65,t.state[3]=68)}(this),e=0;e<8;e++)r(this)}},{key:"getUint32",value:function(){return r(this),this.state[3]+this.state[2]>>>0}},{key:"getFloat",value:function(){return(this.getUint32()>>>8)*(1/16777216)}},{key:"random",get:function(){return this._random||(this._random=this.getFloat.bind(this)),this._random}}]),t}();e.default=o;var a=15,s=18,u=11;t.exports=e.default},function(t,e,n){"use strict";function r(t,e){if(t.length!==e.length)throw new Error("features and labels should have the same length")}function i(t,e){return Array(t).fill(0).map(()=>Array(e).fill(0))}function o(t){for(var e=new Set,n=0;n<t.length;n++)e.add(t[n]);return Array.from(e)}function a(t,e,n,r,i,o,a,s){var u,c=i.map(function(t){return e[t]}),l=o.map(function(t){return e[t]}),h=i.map(function(t){return n[t]}),f=o.map(function(t){return n[t]});t.prototype.train?(u=new t(r)).train(l,f):u=new t(l,f,r);for(var d=u.predict(c),p=0;p<d.length;p++)a[s.indexOf(h[p])][s.indexOf(d[p])]++}var s=n(86),u={},c=n(271);u.leaveOneOut=function(t,e,n,r){return u.leavePOut(t,e,n,r,1)},u.leavePOut=function(t,e,n,u,l){r(e,n);for(var h=o(n),f=i(h.length,h.length),d=e.length,p=c(l,d),m=Array(d),g=0;g<d;g++)m[g]=g;var v,y=!0,w=!1;try{for(var b,x=p[Symbol.iterator]();!(y=(b=x.next()).done);y=!0){for(var _=b.value,M=m.slice(),E=_.length-1;0<=E;E--)M.splice(_[E],1);a(t,e,n,u,_,M,f,h)}}catch(t){w=!0,v=t}finally{try{!y&&x.return&&x.return()}finally{if(w)throw v}}return new s(f,h)},u.kFold=function(t,e,n,u,c){r(e,n);for(var l=o(n),h=i(l.length,l.length),f=e.length,d=Array(f),p=0;p<f;p++)d[p]=p;for(var m=g(f/c),v=[],y=[];d.length;){var w=g(Math.random()*d.length);v.push(d[w]),d.splice(w,1),v.length===m&&(y.push(v),v=[])}for(v.length&&y.push(v),y=y.slice(0,c),p=0;p<y.length;p++){for(var b=y[p],x=[],_=0;_<y.length;_++)_!==p&&(x=x.concat(y[_]));a(t,e,n,u,b,x,h,l)}return new s(h,l)},t.exports=u},function(t){"use strict";var e={mode:"index"};t.exports=function*(t,n,r){function i(){var t,e,n;for(e=1;0>=h[e];)e++;if(0===h[e-1]){for(t=e-1;1!==t;t--)h[t]=-1;h[e]=0,o=s=0,h[1]=1,a=e-1}else{1<e&&(h[e-1]=0);do{e++}while(0<h[e]);for(n=e-1,t=e;0===h[t];)h[t++]=-1;if(-1===h[t])h[t]=h[n],s=h[n]-1,o=t-1,a=n-1,h[n]=-1;else{if(t===h[0])return 0;h[e]=h[t],s=h[t]-1,h[t]=0,o=e-1,a=t-1}}return 1}r=Object.assign({},e,r);for(var o,a,s,u=Array(n),c=Array(t),l=Array(n),h=Array(n+2),f=0;f<n;f++)u[f]=f,l[f]=f<n-t?0:1;for(f=0;f<t;f++)c[f]=n-t+f;for(f=0;f<h.length;f++)h[f]=0===f?n+1:f<=n-t?0:f<=n?f-n+t:-2;if("index"===r.mode)for(yield c.slice();i();)c[s]=u[o],yield c.slice();else{if("mask"!==r.mode)throw new Error("Invalid mode");for(yield l.slice();i();)l[o]=1,l[a]=0,yield l.slice()}}},function(t,e,n){"use strict";function r(t){this.options=Object.assign({},a,t),this.kernel=new i(this.options.kernel,this.options.kernelOptions),this.b=0}var i=n(37),o=n(2).array,a={C:1,tol:1e-4,maxPasses:10,maxIterations:1e4,kernel:"linear",alphaTol:1e-6,random:Math.random,whitening:!0};r.prototype.train=function(t,e){if(t.length!==e.length)throw new Error("Features and labels should have the same length");if(2>t.length)throw new Error("Cannot train with less than 2 observations");if(this._trained=!1,this._loaded=!1,this.N=e.length,this.D=t[0].length,this.options.whitening){this.X=Array(this.N);for(var n=0;n<this.N;n++)this.X[n]=Array(this.D);this.minMax=Array(this.D);for(var r,i=0;i<this.D;i++){for(r=Array(this.N),n=0;n<this.N;n++)r[n]=t[n][i];for(this.minMax[i]=o.minMax(r),n=0;n<this.N;n++)this.X[n][i]=(t[n][i]-this.minMax[i].min)/(this.minMax[i].max-this.minMax[i].min)}}else this.X=t;this.Y=e,this.b=0,this.W=void 0;var a=this.kernel.compute(this.X),s=e.length,c=Array(s).fill(0);this.alphas=c;for(var l=0;l<s;l++)c[l]=0;for(var h,f=0,d=0,p=0,m=0,y=0,w=0,b=0,x=0,_=0,E=0,S=0;m<this.options.maxPasses&&p<this.options.maxIterations;){for(h=0,n=0;n<s;n++)if(y=this._marginOnePrecomputed(n,a)-e[n],e[n]*y<-this.options.tol&&c[n]<this.options.C||e[n]*y>this.options.tol&&0<c[n]){for(i=n;i===n;)i=g(this.options.random()*s);if(w=this._marginOnePrecomputed(i,a)-e[i],b=c[n],x=c[i],e[n]===e[i]?(_=M(0,b+x-this.options.C),E=v(this.options.C,b+x)):(_=M(0,x-b),E=v(this.options.C,this.options.C+x+b)),1e-4>u(_-E))continue;if(0<=(S=2*a[n][i]-a[n][n]-a[i][i]))continue;var T=c[i]-e[i]*(y-w)/S;if(T>E?T=E:T<_&&(T=_),.001>u(x-T))continue;c[i]=T,c[n]+=e[n]*e[i]*(x-T),this.b=((f=this.b-y-e[n]*(c[n]-b)*a[n][n]-e[i]*(c[i]-x)*a[n][i])+(d=this.b-w-e[n]*(c[n]-b)*a[n][i]-e[i]*(c[i]-x)*a[i][i]))/2,c[n]<this.options.C&&0<c[n]&&(this.b=f),c[i]<this.options.C&&0<c[i]&&(this.b=d),h+=1}p++,0==h?m+=1:m=0}if(p===this.options.maxIterations)throw new Error("max iterations reached");if(this.iterations=p,"linear"===this.options.kernel){this.W=Array(this.D);for(var A=0;A<this.D;A++){this.W[A]=0;for(var k=0;k<s;k++)this.W[A]+=e[k]*c[k]*this.X[k][A]}}var C=[],R=[],D=[];for(this._supportVectorIdx=[],n=0;n<this.N;n++)this.alphas[n]>this.options.alphaTol&&(C.push(this.X[n]),R.push(e[n]),D.push(this.alphas[n]),this._supportVectorIdx.push(n));this.X=C,this.Y=R,this.N=C.length,this.alphas=D,this._trained=!0},r.prototype.predictOne=function(t){return 0<this.marginOne(t)?1:-1},r.prototype.predict=function(t){if(!this._trained&&!this._loaded)throw new Error("Cannot predict, you need to train the SVM first");return Array.isArray(t)&&Array.isArray(t[0])?t.map(this.predictOne.bind(this)):this.predictOne(t)},r.prototype.marginOne=function(t,e){this.options.whitening&&!e&&(t=this._applyWhitening(t));var n,r=this.b;if("linear"===this.options.kernel&&this.W)for(n=0;n<this.W.length;n++)r+=this.W[n]*t[n];else for(n=0;n<this.N;n++)r+=this.alphas[n]*this.Y[n]*this.kernel.compute([t],[this.X[n]])[0][0];return r},r.prototype._marginOnePrecomputed=function(t,e){var n,r=this.b;for(n=0;n<this.N;n++)r+=this.alphas[n]*this.Y[n]*e[t][n];return r},r.prototype.margin=function(t){return Array.isArray(t)?t.map(this.marginOne.bind(this)):this.marginOne(t)},r.prototype.supportVectors=function(){if(!this._trained&&!this._loaded)throw new Error("Cannot get support vectors, you need to train the SVM first");if(this._loaded&&"linear"===this.options.kernel)throw new Error("Cannot get support vectors from saved linear model, you need to train the SVM to have them");return this._supportVectorIdx},r.load=function(t){this._loaded=!0,this._trained=!1;var e=new r(t.options);return"linear"===t.options.kernel?(e.W=t.W.slice(),e.D=e.W.length):(e.X=t.X.slice(),e.Y=t.Y.slice(),e.alphas=t.alphas.slice(),e.N=e.X.length,e.D=e.X[0].length),e.minMax=t.minMax,e.b=t.b,e._loaded=!0,e._trained=!1,e},r.prototype.toJSON=function(){if(!this._trained&&!this._loaded)throw new Error("Cannot export, you need to train the SVM first");var t={};return t.options=Object.assign({},this.options),t.b=this.b,t.minMax=this.minMax,"linear"===t.options.kernel?t.W=this.W.slice():(t.X=this.X.slice(),t.Y=this.Y.slice(),t.alphas=this.alphas.slice()),t},r.prototype._applyWhitening=function(t){if(!this.minMax)throw new Error("Could not apply whitening");for(var e=Array(t.length),n=0;n<t.length;n++)e[n]=(t[n]-this.minMax[n].min)/(this.minMax[n].max-this.minMax[n].min);return e},t.exports=r},function(t,e,n){"use strict";function r(t,e){for(var n=t.kdTree.nearest(e,t.k),r=Array(t.classes),i=-1,o=-1,a=n[0][0].length-1,s=0;s<r.length;++s)r[s]=0;for(s=0;s<n.length;++s){var u=n[s][0][a],c=++r[u];c>o&&(i=u,o=c)}return i}Object.defineProperty(e,"__esModule",{value:!0});var i=n(274),o=n(0),a=o&&o.__esModule?o:{default:o};class s{constructor(t,e,n={}){if(!0===t){var r=e;return this.kdTree=new i.kdTree(r.kdTree,n),this.k=r.k,this.classes=r.classes,void(this.isEuclidean=r.isEuclidean)}for(var o=n.distance,s=void 0===o?a.default:o,u=n.k,c=void 0===u?t[0].length+1:u,l=new Set(e).size,h=Array(t.length),f=0;f<h.length;++f)h[f]=t[f].slice();for(f=0;f<e.length;++f)h[f].push(e[f]);this.kdTree=new i.kdTree(h,s),this.k=c,this.classes=l,this.isEuclidean=s===a.default}static load(t,e=a.default){if("KNN"!==t.name)throw new Error("invalid model: "+t.name);if(!t.isEuclidean&&e===a.default)throw new Error("a custom distance function was used to create the model. Please provide it again");if(t.isEuclidean&&e!==a.default)throw new Error("the model was created with the default distance function. Do not load it with another one");return new s(!0,t,e)}toJSON(){return{name:"KNN",kdTree:this.kdTree.toJSON(),k:this.k,classes:this.classes,isEuclidean:this.isEuclidean}}predict(t){if(Array.isArray(t)){if("number"==typeof t[0])return r(this,t);if(Array.isArray(t[0])&&"number"==typeof t[0][0]){for(var e=Array(t.length),n=0;n<t.length;n++)e[n]=r(this,t[n]);return e}}throw new TypeError("dataset to predict must be an array or a matrix")}}e.default=s},function(t,e){"use strict";function n(t,e,n){this.obj=t,this.left=null,this.right=null,this.parent=n,this.dimension=e}function i(t){this.content=[],this.scoreFunction=t}Object.defineProperty(e,"__esModule",{value:!0}),i.prototype={push:function(t){this.content.push(t),this.bubbleUp(this.content.length-1)},pop:function(){var t=this.content[0],e=this.content.pop();return 0<this.content.length&&(this.content[0]=e,this.sinkDown(0)),t},peek:function(){return this.content[0]},remove:function(t){for(var e=this.content.length,n=0;n<e;n++)if(this.content[n]==t){var r=this.content.pop();return void(n!=e-1&&(this.content[n]=r,this.scoreFunction(r)<this.scoreFunction(t)?this.bubbleUp(n):this.sinkDown(n)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(t){for(var e=this.content[t];0<t;){var n=g((t+1)/2)-1,r=this.content[n];if(!(this.scoreFunction(e)<this.scoreFunction(r)))break;this.content[n]=e,this.content[t]=r,t=n}},sinkDown:function(t){for(var e=this.content.length,n=this.content[t],r=this.scoreFunction(n);;){var i=2*(t+1),o=i-1,a=null;if(o<e){var s=this.scoreFunction(this.content[o]);s<r&&(a=o)}if(i<e&&this.scoreFunction(this.content[i])<(null==a?r:s)&&(a=i),null==a)break;this.content[t]=this.content[a],this.content[a]=n,t=a}}},e.kdTree=function(t,e){var o,a=this;if(Array.isArray(t)){o=Array(t[0].length);for(var s=0;s<o.length;++s)o[s]=s;this.root=function t(e,r,i){var a,s,u=r%o.length;return 0===e.length?null:1===e.length?new n(e[0],u,i):(e.sort(function(t,e){return t[o[u]]-e[o[u]]}),(s=new n(e[a=g(e.length/2)],u,i)).left=t(e.slice(0,a),r+1,s),s.right=t(e.slice(a+1),r+1,s),s)}(t,0,null)}else o=t.dimensions,function(t){a.root=t,function t(e){e.left&&(e.left.parent=e,t(e.left)),e.right&&(e.right.parent=e,t(e.right))}(a.root)}(t);this.toJSON=function(t,e=!0){t||(t=this.root);var r=new n(t.obj,t.dimension,null);return t.left&&(r.left=a.toJSON(t.left,!1)),t.right&&(r.right=a.toJSON(t.right,!1)),e&&(r.dimensions=o),r},this.insert=function(t){var e,r,i=function e(n,r){if(null===n)return r;var i=o[n.dimension];return e(t[i]<n.obj[i]?n.left:n.right,n)}(this.root,null);return null===i?void(this.root=new n(t,0,null)):(e=new n(t,(i.dimension+1)%o.length,i),void(t[r=o[i.dimension]]<i.obj[r]?i.left=e:i.right=e))},this.remove=function(t){var e=function e(n){if(null===n)return null;if(n.obj===t)return n;var r=o[n.dimension];return e(t[r]<n.obj[r]?n.left:n.right)}(a.root);null===e||function t(e){function n(t,e){var r,i,a,s,u;return null===t?null:(r=o[e],t.dimension===e?null===t.left?t:n(t.left,e):(i=t.obj[r],a=n(t.left,e),s=n(t.right,e),u=t,null!==a&&a.obj[r]<i&&(u=a),null!==s&&s.obj[r]<u.obj[r]&&(u=s),u))}var r,i,s;return null===e.left&&null===e.right?null===e.parent?void(a.root=null):void(e.obj[s=o[e.parent.dimension]]<e.parent.obj[s]?e.parent.left=null:e.parent.right=null):void(null===e.right?(r=n(e.left,e.dimension),i=r.obj,t(r),e.right=e.left,e.left=null,e.obj=i):(r=n(e.right,e.dimension),i=r.obj,t(r),e.obj=i))}(e)},this.nearest=function(t,n,r){var s,c,l;if(l=new i(function(t){return-t[1]}),r)for(s=0;s<n;s+=1)l.push([null,r]);for(a.root&&function r(i){function a(t,e){l.push([t,e]),l.size()>n&&l.pop()}var s,c,h,f,d=o[i.dimension],p=e(t,i.obj),m={};for(f=0;f<o.length;f+=1)m[o[f]]=f===i.dimension?t[o[f]]:i.obj[o[f]];return c=e(m,i.obj),null===i.right&&null===i.left?void((l.size()<n||p<l.peek()[1])&&a(i,p)):(r(s=null===i.right?i.left:null===i.left?i.right:t[d]<i.obj[d]?i.left:i.right),(l.size()<n||p<l.peek()[1])&&a(i,p),void((l.size()<n||u(c)<l.peek()[1])&&(h=s===i.left?i.right:i.left,null!==h&&r(h))))}(a.root),c=[],s=0;s<v(n,l.content.length);s+=1)l.content[s][0]&&c.push([l.content[s][0].obj,l.content[s][1]]);return c},this.balanceFactor=function(){return function t(e){return null===e?0:M(t(e.left),t(e.right))+1}(a.root)/(r(function t(e){return null===e?0:t(e.left)+t(e.right)+1}(a.root))/.6931471805599453)}},e.BinaryHeap=i},function(t,e,n){"use strict";t.exports=e=n(87).NaiveBayes,e.separateClasses=n(87).separateClasses},function(t,e,n){"use strict";t.exports=n(10).Matrix,t.exports.Decompositions=t.exports.DC=n(285)},function(){"use strict";Symbol.species||(Symbol.species=Symbol.for("@@species"))},function(t,e,n){"use strict";var r=n(20);t.exports=class extends r{constructor(t){super(t,t.columns,t.rows)}set(t,e,n){return this.matrix.set(e,t,n),this}get(t,e){return this.matrix.get(e,t)}}},function(t,e,n){"use strict";var r=n(20);t.exports=class extends r{constructor(t,e){super(t,1,t.columns),this.row=e}set(t,e,n){return this.matrix.set(this.row,e,n),this}get(t,e){return this.matrix.get(this.row,e)}}},function(t,e,n){"use strict";var r=n(20),i=n(29);t.exports=class extends r{constructor(t,e,n,r,o){i.checkRange(t,e,n,r,o),super(t,n-e+1,o-r+1),this.startRow=e,this.startColumn=r}set(t,e,n){return this.matrix.set(this.startRow+t,this.startColumn+e,n),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}}},function(t,e,n){"use strict";var r=n(20),i=n(29);t.exports=class extends r{constructor(t,e,n){var r=i.checkIndices(t,e,n);super(t,r.row.length,r.column.length),this.rowIndices=r.row,this.columnIndices=r.column}set(t,e,n){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],n),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}},function(t,e,n){"use strict";var r=n(20);t.exports=class extends r{constructor(t,e){super(t,t.rows,1),this.column=e}set(t,e,n){return this.matrix.set(t,this.column,n),this}get(t){return this.matrix.get(t,this.column)}}},function(t,e,n){"use strict";var r=n(20);t.exports=class extends r{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(this.rows-t-1,e,n),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}}},function(t,e,n){"use strict";var r=n(20);t.exports=class extends r{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(t,this.columns-e-1,n),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}}},function(t,e,n){"use strict";function r(t){return i(t=o.checkMatrix(t),o.eye(t.rows))}function i(t,e){return t=o.checkMatrix(t),e=o.checkMatrix(e),t.isSquare()?new u(t).solve(e):new c(t).solve(e)}var o=n(10).Matrix,a=n(90),s=n(286),u=n(89),c=n(287),l=n(288);o.inverse=o.inv=r,o.prototype.inverse=o.prototype.inv=function(){return r(this)},o.solve=i,o.prototype.solve=function(t){return i(this,t)},t.exports={SingularValueDecomposition:a,SVD:a,EigenvalueDecomposition:s,EVD:s,LuDecomposition:u,LU:u,QrDecomposition:c,QR:c,CholeskyDecomposition:l,CHO:l,inverse:r,solve:i}},function(t,e,n){"use strict";function r(t,e){if(e=Object.assign({},p,e),!(this instanceof r))return new r(t,e);if(!(t=l.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");var n,u,c=t.columns,h=d(c,c,0),f=Array(c),m=Array(c),g=t;if(e.assumeSymmetric||t.isSymmetric()){for(n=0;n<c;n++)for(u=0;u<c;u++)h[n][u]=g.get(n,u);i(c,m,f,h),o(c,m,f,h)}else{var v=d(c,c,0),y=Array(c);for(u=0;u<c;u++)for(n=0;n<c;n++)v[n][u]=g.get(n,u);a(c,v,y,h),s(c,m,f,h,v)}this.n=c,this.e=m,this.d=f,this.V=h}function i(t,e,n,r){var i,o,a,s,c,l,h,f;for(c=0;c<t;c++)n[c]=r[t-1][c];for(s=t-1;0<s;s--){for(f=0,a=0,l=0;l<s;l++)f+=u(n[l]);if(0===f)for(e[s]=n[s-1],c=0;c<s;c++)n[c]=r[s-1][c],r[s][c]=0,r[c][s]=0;else{for(l=0;l<s;l++)n[l]/=f,a+=n[l]*n[l];for(i=n[s-1],o=R(a),0<i&&(o=-o),e[s]=f*o,a-=i*o,n[s-1]=i-o,c=0;c<s;c++)e[c]=0;for(c=0;c<s;c++){for(r[c][s]=i=n[c],o=e[c]+r[c][c]*i,l=c+1;l<=s-1;l++)o+=r[l][c]*n[l],e[l]+=r[l][c]*i;e[c]=o}for(i=0,c=0;c<s;c++)e[c]/=a,i+=e[c]*n[c];for(h=i/(a+a),c=0;c<s;c++)e[c]-=h*n[c];for(c=0;c<s;c++){for(i=n[c],o=e[c],l=c;l<=s-1;l++)r[l][c]-=i*e[l]+o*n[l];n[c]=r[s-1][c],r[s][c]=0}}n[s]=a}for(s=0;s<t-1;s++){if(r[t-1][s]=r[s][s],r[s][s]=1,0!==(a=n[s+1])){for(l=0;l<=s;l++)n[l]=r[l][s+1]/a;for(c=0;c<=s;c++){for(o=0,l=0;l<=s;l++)o+=r[l][s+1]*r[l][c];for(l=0;l<=s;l++)r[l][c]-=o*n[l]}}for(l=0;l<=s;l++)r[l][s+1]=0}for(c=0;c<t;c++)n[c]=r[t-1][c],r[t-1][c]=0;r[t-1][t-1]=1,e[0]=0}function o(t,e,n,r){var i,o,a,s,c,l,h,d,p,m,g,v,y,w,b,x;for(a=1;a<t;a++)e[a-1]=e[a];e[t-1]=0;var _=0,E=0,S=2.220446049250313e-16;for(l=0;l<t;l++){for(E=M(E,u(n[l])+u(e[l])),h=l;h<t&&!(u(e[h])<=S*E);)h++;if(h>l)do{for(p=f(d=(n[l+1]-(i=n[l]))/(2*e[l]),1),0>d&&(p=-p),n[l]=e[l]/(d+p),n[l+1]=e[l]*(d+p),m=n[l+1],o=i-n[l],a=l+2;a<t;a++)n[a]-=o;for(_+=o,d=n[h],v=g=1,y=g,w=e[l+1],b=0,x=0,a=h-1;a>=l;a--)for(y=v,v=g,x=b,i=g*e[a],o=g*d,p=f(d,e[a]),e[a+1]=b*p,d=(g=d/p)*n[a]-(b=e[a]/p)*i,n[a+1]=o+b*(g*i+b*n[a]),c=0;c<t;c++)r[c][a+1]=b*r[c][a]+g*(o=r[c][a+1]),r[c][a]=g*r[c][a]-b*o;e[l]=b*(d=-b*x*y*w*e[l]/m),n[l]=g*d}while(u(e[l])>S*E);n[l]+=_,e[l]=0}for(a=0;a<t-1;a++){for(c=a,d=n[a],s=a+1;s<t;s++)n[s]<d&&(c=s,d=n[s]);if(c!==a)for(n[c]=n[a],n[a]=d,s=0;s<t;s++)d=r[s][a],r[s][a]=r[s][c],r[s][c]=d}}function a(t,e,n,r){var i,o,a,s,c,l,h,f=t-1;for(l=1;l<=f-1;l++){for(h=0,s=l;s<=f;s++)h+=u(e[s][l-1]);if(0!==h){for(a=0,s=f;s>=l;s--)n[s]=e[s][l-1]/h,a+=n[s]*n[s];for(o=R(a),0<n[l]&&(o=-o),a-=n[l]*o,n[l]-=o,c=l;c<t;c++){for(i=0,s=f;s>=l;s--)i+=n[s]*e[s][c];for(i/=a,s=l;s<=f;s++)e[s][c]-=i*n[s]}for(s=0;s<=f;s++){for(i=0,c=f;c>=l;c--)i+=n[c]*e[s][c];for(i/=a,c=l;c<=f;c++)e[s][c]-=i*n[c]}n[l]=h*n[l],e[l][l-1]=h*o}}for(s=0;s<t;s++)for(c=0;c<t;c++)r[s][c]=s===c?1:0;for(l=f-1;l>=1;l--)if(0!==e[l][l-1]){for(s=l+1;s<=f;s++)n[s]=e[s][l-1];for(c=l;c<=f;c++){for(o=0,s=l;s<=f;s++)o+=n[s]*r[s][c];for(o=o/n[l]/e[l][l-1],s=l;s<=f;s++)r[s][c]+=o*n[s]}}}function s(t,e,n,r,i){var o,a,s,l,h,f,d,p,m,g,y,w,b,x,_,E=t-1,S=t-1,T=2.220446049250313e-16,A=0,k=0,C=0,D=0,L=0,O=0,P=0,I=0;for(o=0;o<t;o++)for((o<0||o>S)&&(n[o]=i[o][o],e[o]=0),a=M(o-1,0);a<t;a++)k+=u(i[o][a]);for(;E>=0;){for(l=E;l>0&&(0===(O=u(i[l-1][l-1])+u(i[l][l]))&&(O=k),!(u(i[l][l-1])<T*O));)l--;if(l===E)i[E][E]+=A,n[E]=i[E][E],e[E]=0,E--,I=0;else if(l===E-1){if(P=R(u(D=(C=(i[E-1][E-1]-i[E][E])/2)*C+(d=i[E][E-1]*i[E-1][E]))),i[E][E]+=A,i[E-1][E-1]=i[E-1][E-1]+A,p=i[E][E],0<=D){for(n[E-1]=p+(P=0<=C?C+P:C-P),n[E]=n[E-1],0!==P&&(n[E]=p-d/P),e[E-1]=0,e[E]=0,C=(p=i[E][E-1])/(O=u(p)+u(P)),C/=L=R(C*C+(D=P/O)*D),D/=L,a=E-1;a<t;a++)i[E-1][a]=D*(P=i[E-1][a])+C*i[E][a],i[E][a]=D*i[E][a]-C*P;for(o=0;o<=E;o++)i[o][E-1]=D*(P=i[o][E-1])+C*i[o][E],i[o][E]=D*i[o][E]-C*P;for(o=0;o<=S;o++)r[o][E-1]=D*(P=r[o][E-1])+C*r[o][E],r[o][E]=D*r[o][E]-C*P}else n[E-1]=p+C,n[E]=p+C,e[E-1]=P,e[E]=-P;E-=2,I=0}else{if(p=i[E][E],m=0,d=0,l<E&&(m=i[E-1][E-1],d=i[E][E-1]*i[E-1][E]),10==I){for(A+=p,o=0;o<=E;o++)i[o][o]-=p;p=m=.75*(O=u(i[E][E-1])+u(i[E-1][E-2])),d=-.4375*O*O}if(30==I&&0<(O=(O=(m-p)/2)*O+d)){for(O=R(O),m<p&&(O=-O),O=p-d/((m-p)/2+O),o=0;o<=E;o++)i[o][o]-=O;A+=O,p=m=d=.964}for(++I,h=E-2;h>=l&&(C=((L=p-(P=i[h][h]))*(O=m-P)-d)/i[h+1][h]+i[h][h+1],D=i[h+1][h+1]-P-L-O,L=i[h+2][h+1],C/=O=u(C)+u(D)+u(L),D/=O,L/=O,h!==l)&&!(u(i[h][h-1])*(u(D)+u(L))<T*(u(C)*(u(i[h-1][h-1])+u(P)+u(i[h+1][h+1]))));)h--;for(o=h+2;o<=E;o++)i[o][o-2]=0,o>h+2&&(i[o][o-3]=0);for(s=h;s<=E-1&&(x=s!==E-1,s!==h&&(C=i[s][s-1],D=i[s+1][s-1],L=x?i[s+2][s-1]:0,0!==(p=u(C)+u(D)+u(L))&&(C/=p,D/=p,L/=p)),0!==p);s++)if(O=R(C*C+D*D+L*L),0>C&&(O=-O),0!==O){for(s===h?l!==h&&(i[s][s-1]=-i[s][s-1]):i[s][s-1]=-O*p,p=(C+=O)/O,m=D/O,P=L/O,D/=C,L/=C,a=s;a<t;a++)C=i[s][a]+D*i[s+1][a],x&&(i[s+2][a]=i[s+2][a]-(C+=L*i[s+2][a])*P),i[s][a]-=C*p,i[s+1][a]=i[s+1][a]-C*m;for(o=0;o<=v(E,s+3);o++)C=p*i[o][s]+m*i[o][s+1],x&&(i[o][s+2]=i[o][s+2]-(C+=P*i[o][s+2])*L),i[o][s]-=C,i[o][s+1]=i[o][s+1]-C*D;for(o=0;o<=S;o++)C=p*r[o][s]+m*r[o][s+1],x&&(r[o][s+2]=r[o][s+2]-(C+=P*r[o][s+2])*L),r[o][s]-=C,r[o][s+1]=r[o][s+1]-C*D}}}if(0!==k){for(E=t-1;0<=E;E--)if(C=n[E],0===(D=e[E]))for(l=E,i[E][E]=1,o=E-1;0<=o;o--){for(d=i[o][o]-C,L=0,a=l;a<=E;a++)L+=i[o][a]*i[a][E];if(0>e[o])P=d,O=L;else if(l=o,0===e[o]?i[o][E]=0===d?-L/(T*k):-L/d:(m=i[o+1][o],i[o][E]=f=((p=i[o][o+1])*O-P*L)/(D=(n[o]-C)*(n[o]-C)+e[o]*e[o]),i[o+1][E]=u(p)>u(P)?(-L-d*f)/p:(-O-m*f)/P),1<T*(f=u(i[o][E]))*f)for(a=o;a<=E;a++)i[a][E]/=f}else if(0>D)for(l=E-1,u(i[E][E-1])>u(i[E-1][E])?(i[E-1][E-1]=D/i[E][E-1],i[E-1][E]=-(i[E][E]-C)/i[E][E-1]):(_=c(0,-i[E-1][E],i[E-1][E-1]-C,D),i[E-1][E-1]=_[0],i[E-1][E]=_[1]),i[E][E-1]=0,i[E][E]=1,o=E-2;0<=o;o--){for(g=0,y=0,a=l;a<=E;a++)g+=i[o][a]*i[a][E-1],y+=i[o][a]*i[a][E];if(d=i[o][o]-C,0>e[o])P=d,L=g,O=y;else if(l=o,0===e[o]?(_=c(-g,-y,d,D),i[o][E-1]=_[0],i[o][E]=_[1]):(p=i[o][o+1],m=i[o+1][o],b=2*(n[o]-C)*D,0==(w=(n[o]-C)*(n[o]-C)+e[o]*e[o]-D*D)&&0===b&&(w=T*k*(u(d)+u(D)+u(p)+u(m)+u(P))),_=c(p*L-P*g+D*y,p*O-P*y-D*g,w,b),i[o][E-1]=_[0],i[o][E]=_[1],u(p)>u(P)+u(D)?(i[o+1][E-1]=(-g-d*i[o][E-1]+D*i[o][E])/p,i[o+1][E]=(-y-d*i[o][E]-D*i[o][E-1])/p):(_=c(-L-m*i[o][E-1],-O-m*i[o][E],P,D),i[o+1][E-1]=_[0],i[o+1][E]=_[1])),1<T*(f=M(u(i[o][E-1]),u(i[o][E])))*f)for(a=o;a<=E;a++)i[a][E-1]=i[a][E-1]/f,i[a][E]/=f}for(o=0;o<t;o++)if(o<0||o>S)for(a=o;a<t;a++)r[o][a]=i[o][a];for(a=t-1;a>=0;a--)for(o=0;o<=S;o++){for(P=0,s=0;s<=v(a,S);s++)P+=r[o][s]*i[s][a];r[o][a]=P}}}function c(t,e,n,r){var i,o;return u(n)>u(r)?[(t+(i=r/n)*e)/(o=n+i*r),(e-i*t)/o]:[((i=n/r)*t+e)/(o=r+i*n),(i*e-t)/o]}var l=n(10).Matrix,h=n(44),f=h.hypotenuse,d=h.getFilled2DArray,p={assumeSymmetric:!1};r.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return l.isMatrix(this.V)||(this.V=new l(this.V)),this.V},get diagonalMatrix(){var t,e,n=this.n,r=this.e,i=this.d,o=new l(n,n);for(t=0;t<n;t++){for(e=0;e<n;e++)o[t][e]=0;o[t][t]=i[t],0<r[t]?o[t][t+1]=r[t]:0>r[t]&&(o[t][t-1]=r[t])}return o}},t.exports=r},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);var e,n,a,s,u=(t=i.checkMatrix(t)).clone(),c=t.rows,l=t.columns,h=Array(l);for(a=0;a<l;a++){var f=0;for(e=a;e<c;e++)f=o(f,u[e][a]);if(0!==f){for(0>u[a][a]&&(f=-f),e=a;e<c;e++)u[e][a]/=f;for(u[a][a]+=1,n=a+1;n<l;n++){for(s=0,e=a;e<c;e++)s+=u[e][a]*u[e][n];for(s=-s/u[a][a],e=a;e<c;e++)u[e][n]+=s*u[e][a]}}h[a]=-f}this.QR=u,this.Rdiag=h}var i=n(10).Matrix,o=n(44).hypotenuse;r.prototype={solve:function(t){t=i.checkMatrix(t);var e=this.QR,n=e.rows;if(t.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var r,o,a,s,u=t.columns,c=t.clone(),l=e.columns;for(a=0;a<l;a++)for(o=0;o<u;o++){for(s=0,r=a;r<n;r++)s+=e[r][a]*c[r][o];for(s=-s/e[a][a],r=a;r<n;r++)c[r][o]+=s*e[r][a]}for(a=l-1;0<=a;a--){for(o=0;o<u;o++)c[a][o]/=this.Rdiag[a];for(r=0;r<a;r++)for(o=0;o<u;o++)c[r][o]-=c[a][o]*e[r][a]}return c.subMatrix(0,l-1,0,u-1)},isFullRank:function(){for(var t=this.QR.columns,e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0},get upperTriangularMatrix(){var t,e,n=this.QR,r=n.columns,o=new i(r,r);for(t=0;t<r;t++)for(e=0;e<r;e++)o[t][e]=t<e?n[t][e]:t===e?this.Rdiag[t]:0;return o},get orthogonalMatrix(){var t,e,n,r,o=this.QR,a=o.rows,s=o.columns,u=new i(a,s);for(n=s-1;0<=n;n--){for(t=0;t<a;t++)u[t][n]=0;for(u[n][n]=1,e=n;e<s;e++)if(0!==o[n][n]){for(r=0,t=n;t<a;t++)r+=o[t][n]*u[t][e];for(r=-r/o[n][n],t=n;t<a;t++)u[t][e]+=r*o[t][n]}}return u}},t.exports=r},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);if(!(t=i.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");var e,n,o,a=t,s=a.rows,u=new i(s,s),c=!0;for(n=0;n<s;n++){var l=u[n],h=0;for(o=0;o<n;o++){var f=u[o],d=0;for(e=0;e<o;e++)d+=f[e]*l[e];l[o]=d=(a[n][o]-d)/u[o][o],h+=d*d}for(c&=0<(h=a[n][n]-h),u[n][n]=R(M(h,0)),o=n+1;o<s;o++)u[n][o]=0}if(!c)throw new Error("Matrix is not positive definite");this.L=u}var i=n(10).Matrix;r.prototype={get lowerTriangularMatrix(){return this.L},solve:function(t){t=i.checkMatrix(t);var e=this.L,n=e.rows;if(t.rows!==n)throw new Error("Matrix dimensions do not match");var r,o,a,s=t.columns,u=t.clone();for(a=0;a<n;a++)for(o=0;o<s;o++){for(r=0;r<a;r++)u[a][o]-=u[r][o]*e[a][r];u[a][o]/=e[a][a]}for(a=n-1;0<=a;a--)for(o=0;o<s;o++){for(r=a+1;r<n;r++)u[a][o]-=u[r][o]*e[r][a];u[a][o]/=e[a][a]}return u}},t.exports=r},function(t,e,n){"use strict";t.exports=e=n(290),e.Utils=n(47),e.OPLS=n(303)},function(t,e,n){"use strict";function r(t,e){for(var n=0,r=0;r<t.rows;r++)n+=t[r][e];return n}function i(t){for(var e,n=0,i=-1/0,o=0;o<t.columns;++o)(e=r(t,o))>i&&(i=e,n=o);return n}var o=n(45),a=n(47);class s{constructor(t,e){if(!0===t){var n=e;this.meanX=n.meanX,this.stdDevX=n.stdDevX,this.meanY=n.meanY,this.stdDevY=n.stdDevY,this.PBQ=o.checkMatrix(n.PBQ),this.R2X=n.R2X}else{if(t.length!==e.length)throw new RangeError("The number of X rows must be equal to the number of Y rows");var r=a.featureNormalize(t);this.X=r.result,this.meanX=r.means,this.stdDevX=r.std;var i=a.featureNormalize(e);this.Y=i.result,this.meanY=i.means,this.stdDevY=i.std}}train(t){void 0===t&&(t={});var e=t.latentVectors;void 0===e&&(e=v(this.X.length-1,this.X[0].length));var n=t.tolerance;void 0===n&&(n=1e-5);for(var r=this.X,s=this.Y,u=r.rows,c=r.columns,l=s.rows,h=s.columns,f=r.clone().mul(r).sum(),d=s.clone().mul(s).sum(),p=e,m=o.zeros(u,p),g=o.zeros(c,p),y=o.zeros(l,p),w=o.zeros(h,p),b=o.zeros(p,p),x=g.clone(),_=0;a.norm(s)>n&&_<p;){for(var M=r.transpose(),E=s.transpose(),S=i(r.clone().mulM(r)),T=i(s.clone().mulM(s)),A=r.getColumnVector(S),k=s.getColumnVector(T),C=o.zeros(u,1);a.norm(A.clone().sub(C))>n;){var R=M.mmul(k);R.div(a.norm(R)),C=A,A=r.mmul(R);var D=E.mmul(A);D.div(a.norm(D)),k=s.mmul(D)}var L=M.mmul(C=A),O=C.transpose().mmul(C)[0][0],P=L.div(O),I=a.norm(P);P.div(I),C.mul(I),R.mul(I),L=k.transpose().mmul(C),O=C.transpose().mmul(C)[0][0];var N=L.div(O)[0][0];r.sub(C.mmul(P.transpose())),s.sub(C.clone().mul(N).mmul(D.transpose())),m.setColumn(_,C),g.setColumn(_,P),y.setColumn(_,k),w.setColumn(_,D),x.setColumn(_,R),b[_][_]=N,_++}m=m.subMatrix(0,m.rows-1,0,--_),g=g.subMatrix(0,g.rows-1,0,_),y=y.subMatrix(0,y.rows-1,0,_),w=w.subMatrix(0,w.rows-1,0,_),x=x.subMatrix(0,x.rows-1,0,_),b=b.subMatrix(0,_,0,_),this.ssqYcal=d,this.E=r,this.F=s,this.T=m,this.P=g,this.U=y,this.Q=w,this.W=x,this.B=b,this.PBQ=g.mmul(b).mmul(w.transpose()),this.R2X=C.transpose().mmul(C).mmul(P.transpose().mmul(P)).div(f)[0][0]}predict(t){var e=o.checkMatrix(t);return(e=e.subRowVector(this.meanX).divRowVector(this.stdDevX)).mmul(this.PBQ).mulRowVector(this.stdDevY).addRowVector(this.meanY)}getExplainedVariance(){return this.R2X}toJSON(){return{name:"PLS",R2X:this.R2X,meanX:this.meanX,stdDevX:this.stdDevX,meanY:this.meanY,stdDevY:this.stdDevY,PBQ:this.PBQ}}static load(t){if("PLS"!==t.name)throw new RangeError("Invalid model: "+t.name);return new s(!0,t)}}t.exports=s},function(){"use strict";Symbol.species||(Symbol.species=Symbol.for("@@species"))},function(t,e,n){"use strict";var r=n(21);t.exports=class extends r{constructor(t){super(t,t.columns,t.rows)}set(t,e,n){return this.matrix.set(e,t,n),this}get(t,e){return this.matrix.get(e,t)}}},function(t,e,n){"use strict";var r=n(21);t.exports=class extends r{constructor(t,e){super(t,1,t.columns),this.row=e}set(t,e,n){return this.matrix.set(this.row,e,n),this}get(t,e){return this.matrix.get(this.row,e)}}},function(t,e,n){"use strict";var r=n(21),i=n(30);t.exports=class extends r{constructor(t,e,n,r,o){i.checkRange(t,e,n,r,o),super(t,n-e+1,o-r+1),this.startRow=e,this.startColumn=r}set(t,e,n){return this.matrix.set(this.startRow+t,this.startColumn+e,n),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}}},function(t,e,n){"use strict";var r=n(21),i=n(30);t.exports=class extends r{constructor(t,e,n){var r=i.checkIndices(t,e,n);super(t,r.row.length,r.column.length),this.rowIndices=r.row,this.columnIndices=r.column}set(t,e,n){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],n),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}},function(t,e,n){"use strict";var r=n(21);t.exports=class extends r{constructor(t,e){super(t,t.rows,1),this.column=e}set(t,e,n){return this.matrix.set(t,this.column,n),this}get(t){return this.matrix.get(t,this.column)}}},function(t,e,n){"use strict";var r=n(21);t.exports=class extends r{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(this.rows-t-1,e,n),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}}},function(t,e,n){"use strict";var r=n(21);t.exports=class extends r{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(t,this.columns-e-1,n),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}}},function(t,e,n){"use strict";function r(t){return i(t=o.checkMatrix(t),o.eye(t.rows))}function i(t,e){return t=o.checkMatrix(t),e=o.checkMatrix(e),t.isSquare()?new u(t).solve(e):new c(t).solve(e)}var o=n(11).Matrix,a=n(93),s=n(300),u=n(92),c=n(301),l=n(302);o.inverse=o.inv=r,o.prototype.inverse=o.prototype.inv=function(){return r(this)},o.solve=i,o.prototype.solve=function(t){return i(this,t)},t.exports={SingularValueDecomposition:a,SVD:a,EigenvalueDecomposition:s,EVD:s,LuDecomposition:u,LU:u,QrDecomposition:c,QR:c,CholeskyDecomposition:l,CHO:l,inverse:r,solve:i}},function(t,e,n){"use strict";function r(t,e){if(e=Object.assign({},p,e),!(this instanceof r))return new r(t,e);if(!(t=l.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");var n,u,c=t.columns,h=d(c,c,0),f=Array(c),m=Array(c),g=t;if(e.assumeSymmetric||t.isSymmetric()){for(n=0;n<c;n++)for(u=0;u<c;u++)h[n][u]=g.get(n,u);i(c,m,f,h),o(c,m,f,h)}else{var v=d(c,c,0),y=Array(c);for(u=0;u<c;u++)for(n=0;n<c;n++)v[n][u]=g.get(n,u);a(c,v,y,h),s(c,m,f,h,v)}this.n=c,this.e=m,this.d=f,this.V=h}function i(t,e,n,r){var i,o,a,s,c,l,h,f;for(c=0;c<t;c++)n[c]=r[t-1][c];for(s=t-1;0<s;s--){for(f=0,a=0,l=0;l<s;l++)f+=u(n[l]);if(0===f)for(e[s]=n[s-1],c=0;c<s;c++)n[c]=r[s-1][c],r[s][c]=0,r[c][s]=0;else{for(l=0;l<s;l++)n[l]/=f,a+=n[l]*n[l];for(i=n[s-1],o=R(a),0<i&&(o=-o),e[s]=f*o,a-=i*o,n[s-1]=i-o,c=0;c<s;c++)e[c]=0;for(c=0;c<s;c++){for(r[c][s]=i=n[c],o=e[c]+r[c][c]*i,l=c+1;l<=s-1;l++)o+=r[l][c]*n[l],e[l]+=r[l][c]*i;e[c]=o}for(i=0,c=0;c<s;c++)e[c]/=a,i+=e[c]*n[c];for(h=i/(a+a),c=0;c<s;c++)e[c]-=h*n[c];for(c=0;c<s;c++){for(i=n[c],o=e[c],l=c;l<=s-1;l++)r[l][c]-=i*e[l]+o*n[l];n[c]=r[s-1][c],r[s][c]=0}}n[s]=a}for(s=0;s<t-1;s++){if(r[t-1][s]=r[s][s],r[s][s]=1,0!==(a=n[s+1])){for(l=0;l<=s;l++)n[l]=r[l][s+1]/a;for(c=0;c<=s;c++){for(o=0,l=0;l<=s;l++)o+=r[l][s+1]*r[l][c];for(l=0;l<=s;l++)r[l][c]-=o*n[l]}}for(l=0;l<=s;l++)r[l][s+1]=0}for(c=0;c<t;c++)n[c]=r[t-1][c],r[t-1][c]=0;r[t-1][t-1]=1,e[0]=0}function o(t,e,n,r){var i,o,a,s,c,l,h,d,p,m,g,v,y,w,b,x;for(a=1;a<t;a++)e[a-1]=e[a];e[t-1]=0;var _=0,E=0,S=2.220446049250313e-16;for(l=0;l<t;l++){for(E=M(E,u(n[l])+u(e[l])),h=l;h<t&&!(u(e[h])<=S*E);)h++;if(h>l)do{for(p=f(d=(n[l+1]-(i=n[l]))/(2*e[l]),1),0>d&&(p=-p),n[l]=e[l]/(d+p),n[l+1]=e[l]*(d+p),m=n[l+1],o=i-n[l],a=l+2;a<t;a++)n[a]-=o;for(_+=o,d=n[h],v=g=1,y=g,w=e[l+1],b=0,x=0,a=h-1;a>=l;a--)for(y=v,v=g,x=b,i=g*e[a],o=g*d,p=f(d,e[a]),e[a+1]=b*p,d=(g=d/p)*n[a]-(b=e[a]/p)*i,n[a+1]=o+b*(g*i+b*n[a]),c=0;c<t;c++)r[c][a+1]=b*r[c][a]+g*(o=r[c][a+1]),r[c][a]=g*r[c][a]-b*o;e[l]=b*(d=-b*x*y*w*e[l]/m),n[l]=g*d}while(u(e[l])>S*E);n[l]+=_,e[l]=0}for(a=0;a<t-1;a++){for(c=a,d=n[a],s=a+1;s<t;s++)n[s]<d&&(c=s,d=n[s]);if(c!==a)for(n[c]=n[a],n[a]=d,s=0;s<t;s++)d=r[s][a],r[s][a]=r[s][c],r[s][c]=d}}function a(t,e,n,r){var i,o,a,s,c,l,h,f=t-1;for(l=1;l<=f-1;l++){for(h=0,s=l;s<=f;s++)h+=u(e[s][l-1]);if(0!==h){for(a=0,s=f;s>=l;s--)n[s]=e[s][l-1]/h,a+=n[s]*n[s];for(o=R(a),0<n[l]&&(o=-o),a-=n[l]*o,n[l]-=o,c=l;c<t;c++){for(i=0,s=f;s>=l;s--)i+=n[s]*e[s][c];for(i/=a,s=l;s<=f;s++)e[s][c]-=i*n[s]}for(s=0;s<=f;s++){for(i=0,c=f;c>=l;c--)i+=n[c]*e[s][c];for(i/=a,c=l;c<=f;c++)e[s][c]-=i*n[c]}n[l]=h*n[l],e[l][l-1]=h*o}}for(s=0;s<t;s++)for(c=0;c<t;c++)r[s][c]=s===c?1:0;for(l=f-1;l>=1;l--)if(0!==e[l][l-1]){for(s=l+1;s<=f;s++)n[s]=e[s][l-1];for(c=l;c<=f;c++){for(o=0,s=l;s<=f;s++)o+=n[s]*r[s][c];for(o=o/n[l]/e[l][l-1],s=l;s<=f;s++)r[s][c]+=o*n[s]}}}function s(t,e,n,r,i){var o,a,s,l,h,f,d,p,m,g,y,w,b,x,_,E=t-1,S=t-1,T=2.220446049250313e-16,A=0,k=0,C=0,D=0,L=0,O=0,P=0,I=0;for(o=0;o<t;o++)for((o<0||o>S)&&(n[o]=i[o][o],e[o]=0),a=M(o-1,0);a<t;a++)k+=u(i[o][a]);for(;E>=0;){for(l=E;l>0&&(0===(O=u(i[l-1][l-1])+u(i[l][l]))&&(O=k),!(u(i[l][l-1])<T*O));)l--;if(l===E)i[E][E]+=A,n[E]=i[E][E],e[E]=0,E--,I=0;else if(l===E-1){if(P=R(u(D=(C=(i[E-1][E-1]-i[E][E])/2)*C+(d=i[E][E-1]*i[E-1][E]))),i[E][E]+=A,i[E-1][E-1]=i[E-1][E-1]+A,p=i[E][E],0<=D){for(n[E-1]=p+(P=0<=C?C+P:C-P),n[E]=n[E-1],0!==P&&(n[E]=p-d/P),e[E-1]=0,e[E]=0,C=(p=i[E][E-1])/(O=u(p)+u(P)),C/=L=R(C*C+(D=P/O)*D),D/=L,a=E-1;a<t;a++)i[E-1][a]=D*(P=i[E-1][a])+C*i[E][a],i[E][a]=D*i[E][a]-C*P;for(o=0;o<=E;o++)i[o][E-1]=D*(P=i[o][E-1])+C*i[o][E],i[o][E]=D*i[o][E]-C*P;for(o=0;o<=S;o++)r[o][E-1]=D*(P=r[o][E-1])+C*r[o][E],r[o][E]=D*r[o][E]-C*P}else n[E-1]=p+C,n[E]=p+C,e[E-1]=P,e[E]=-P;E-=2,I=0}else{if(p=i[E][E],m=0,d=0,l<E&&(m=i[E-1][E-1],d=i[E][E-1]*i[E-1][E]),10==I){for(A+=p,o=0;o<=E;o++)i[o][o]-=p;p=m=.75*(O=u(i[E][E-1])+u(i[E-1][E-2])),d=-.4375*O*O}if(30==I&&0<(O=(O=(m-p)/2)*O+d)){for(O=R(O),m<p&&(O=-O),O=p-d/((m-p)/2+O),o=0;o<=E;o++)i[o][o]-=O;A+=O,p=m=d=.964}for(++I,h=E-2;h>=l&&(C=((L=p-(P=i[h][h]))*(O=m-P)-d)/i[h+1][h]+i[h][h+1],D=i[h+1][h+1]-P-L-O,L=i[h+2][h+1],C/=O=u(C)+u(D)+u(L),D/=O,L/=O,h!==l)&&!(u(i[h][h-1])*(u(D)+u(L))<T*(u(C)*(u(i[h-1][h-1])+u(P)+u(i[h+1][h+1]))));)h--;for(o=h+2;o<=E;o++)i[o][o-2]=0,o>h+2&&(i[o][o-3]=0);for(s=h;s<=E-1&&(x=s!==E-1,s!==h&&(C=i[s][s-1],D=i[s+1][s-1],L=x?i[s+2][s-1]:0,0!==(p=u(C)+u(D)+u(L))&&(C/=p,D/=p,L/=p)),0!==p);s++)if(O=R(C*C+D*D+L*L),0>C&&(O=-O),0!==O){for(s===h?l!==h&&(i[s][s-1]=-i[s][s-1]):i[s][s-1]=-O*p,p=(C+=O)/O,m=D/O,P=L/O,D/=C,L/=C,a=s;a<t;a++)C=i[s][a]+D*i[s+1][a],x&&(i[s+2][a]=i[s+2][a]-(C+=L*i[s+2][a])*P),i[s][a]-=C*p,i[s+1][a]=i[s+1][a]-C*m;for(o=0;o<=v(E,s+3);o++)C=p*i[o][s]+m*i[o][s+1],x&&(i[o][s+2]=i[o][s+2]-(C+=P*i[o][s+2])*L),i[o][s]-=C,i[o][s+1]=i[o][s+1]-C*D;for(o=0;o<=S;o++)C=p*r[o][s]+m*r[o][s+1],x&&(r[o][s+2]=r[o][s+2]-(C+=P*r[o][s+2])*L),r[o][s]-=C,r[o][s+1]=r[o][s+1]-C*D}}}if(0!==k){for(E=t-1;0<=E;E--)if(C=n[E],0===(D=e[E]))for(l=E,i[E][E]=1,o=E-1;0<=o;o--){for(d=i[o][o]-C,L=0,a=l;a<=E;a++)L+=i[o][a]*i[a][E];if(0>e[o])P=d,O=L;else if(l=o,0===e[o]?i[o][E]=0===d?-L/(T*k):-L/d:(m=i[o+1][o],i[o][E]=f=((p=i[o][o+1])*O-P*L)/(D=(n[o]-C)*(n[o]-C)+e[o]*e[o]),i[o+1][E]=u(p)>u(P)?(-L-d*f)/p:(-O-m*f)/P),1<T*(f=u(i[o][E]))*f)for(a=o;a<=E;a++)i[a][E]/=f}else if(0>D)for(l=E-1,u(i[E][E-1])>u(i[E-1][E])?(i[E-1][E-1]=D/i[E][E-1],i[E-1][E]=-(i[E][E]-C)/i[E][E-1]):(_=c(0,-i[E-1][E],i[E-1][E-1]-C,D),i[E-1][E-1]=_[0],i[E-1][E]=_[1]),i[E][E-1]=0,i[E][E]=1,o=E-2;0<=o;o--){for(g=0,y=0,a=l;a<=E;a++)g+=i[o][a]*i[a][E-1],y+=i[o][a]*i[a][E];if(d=i[o][o]-C,0>e[o])P=d,L=g,O=y;else if(l=o,0===e[o]?(_=c(-g,-y,d,D),i[o][E-1]=_[0],i[o][E]=_[1]):(p=i[o][o+1],m=i[o+1][o],b=2*(n[o]-C)*D,0==(w=(n[o]-C)*(n[o]-C)+e[o]*e[o]-D*D)&&0===b&&(w=T*k*(u(d)+u(D)+u(p)+u(m)+u(P))),_=c(p*L-P*g+D*y,p*O-P*y-D*g,w,b),i[o][E-1]=_[0],i[o][E]=_[1],u(p)>u(P)+u(D)?(i[o+1][E-1]=(-g-d*i[o][E-1]+D*i[o][E])/p,i[o+1][E]=(-y-d*i[o][E]-D*i[o][E-1])/p):(_=c(-L-m*i[o][E-1],-O-m*i[o][E],P,D),i[o+1][E-1]=_[0],i[o+1][E]=_[1])),1<T*(f=M(u(i[o][E-1]),u(i[o][E])))*f)for(a=o;a<=E;a++)i[a][E-1]=i[a][E-1]/f,i[a][E]/=f}for(o=0;o<t;o++)if(o<0||o>S)for(a=o;a<t;a++)r[o][a]=i[o][a];for(a=t-1;a>=0;a--)for(o=0;o<=S;o++){for(P=0,s=0;s<=v(a,S);s++)P+=r[o][s]*i[s][a];r[o][a]=P}}}function c(t,e,n,r){var i,o;return u(n)>u(r)?[(t+(i=r/n)*e)/(o=n+i*r),(e-i*t)/o]:[((i=n/r)*t+e)/(o=r+i*n),(i*e-t)/o]}var l=n(11).Matrix,h=n(46),f=h.hypotenuse,d=h.getFilled2DArray,p={assumeSymmetric:!1};r.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return l.isMatrix(this.V)||(this.V=new l(this.V)),this.V},get diagonalMatrix(){var t,e,n=this.n,r=this.e,i=this.d,o=new l(n,n);for(t=0;t<n;t++){for(e=0;e<n;e++)o[t][e]=0;o[t][t]=i[t],0<r[t]?o[t][t+1]=r[t]:0>r[t]&&(o[t][t-1]=r[t])}return o}},t.exports=r},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);var e,n,a,s,u=(t=i.checkMatrix(t)).clone(),c=t.rows,l=t.columns,h=Array(l);for(a=0;a<l;a++){var f=0;for(e=a;e<c;e++)f=o(f,u[e][a]);if(0!==f){for(0>u[a][a]&&(f=-f),e=a;e<c;e++)u[e][a]/=f;for(u[a][a]+=1,n=a+1;n<l;n++){for(s=0,e=a;e<c;e++)s+=u[e][a]*u[e][n];for(s=-s/u[a][a],e=a;e<c;e++)u[e][n]+=s*u[e][a]}}h[a]=-f}this.QR=u,this.Rdiag=h}var i=n(11).Matrix,o=n(46).hypotenuse;r.prototype={solve:function(t){t=i.checkMatrix(t);var e=this.QR,n=e.rows;if(t.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var r,o,a,s,u=t.columns,c=t.clone(),l=e.columns;for(a=0;a<l;a++)for(o=0;o<u;o++){for(s=0,r=a;r<n;r++)s+=e[r][a]*c[r][o];for(s=-s/e[a][a],r=a;r<n;r++)c[r][o]+=s*e[r][a]}for(a=l-1;0<=a;a--){for(o=0;o<u;o++)c[a][o]/=this.Rdiag[a];for(r=0;r<a;r++)for(o=0;o<u;o++)c[r][o]-=c[a][o]*e[r][a]}return c.subMatrix(0,l-1,0,u-1)},isFullRank:function(){for(var t=this.QR.columns,e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0},get upperTriangularMatrix(){var t,e,n=this.QR,r=n.columns,o=new i(r,r);for(t=0;t<r;t++)for(e=0;e<r;e++)o[t][e]=t<e?n[t][e]:t===e?this.Rdiag[t]:0;return o},get orthogonalMatrix(){var t,e,n,r,o=this.QR,a=o.rows,s=o.columns,u=new i(a,s);for(n=s-1;0<=n;n--){for(t=0;t<a;t++)u[t][n]=0;for(u[n][n]=1,e=n;e<s;e++)if(0!==o[n][n]){for(r=0,t=n;t<a;t++)r+=o[t][n]*u[t][e];for(r=-r/o[n][n],t=n;t<a;t++)u[t][e]+=r*o[t][n]}}return u}},t.exports=r},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);if(!(t=i.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");var e,n,o,a=t,s=a.rows,u=new i(s,s),c=!0;for(n=0;n<s;n++){var l=u[n],h=0;for(o=0;o<n;o++){var f=u[o],d=0;for(e=0;e<o;e++)d+=f[e]*l[e];l[o]=d=(a[n][o]-d)/u[o][o],h+=d*d}for(c&=0<(h=a[n][n]-h),u[n][n]=R(M(h,0)),o=n+1;o<s;o++)u[n][o]=0}if(!c)throw new Error("Matrix is not positive definite");this.L=u}var i=n(11).Matrix;r.prototype={get lowerTriangularMatrix(){return this.L},solve:function(t){t=i.checkMatrix(t);var e=this.L,n=e.rows;if(t.rows!==n)throw new Error("Matrix dimensions do not match");var r,o,a,s=t.columns,u=t.clone();for(a=0;a<n;a++)for(o=0;o<s;o++){for(r=0;r<a;r++)u[a][o]-=u[r][o]*e[a][r];u[a][o]/=e[a][a]}for(a=n-1;0<=a;a--)for(o=0;o<s;o++){for(r=a+1;r<n;r++)u[a][o]-=u[r][o]*e[r][a];u[a][o]/=e[a][a]}return u}},t.exports=r},function(t,e,n){"use strict";function r(t,e,n){var r=new i(t),a=new i(e);r=o.featureNormalize(r).result,a=o.featureNormalize(a).result;var s=r.clone().mul(r).sum(),u=r.transpose().mmul(a);u.div(o.norm(u));for(var c=Array(n),l=Array(n),h=Array(n),f=0;f<n;f++){var d=r.mmul(u),p=r.transpose().mmul(d),m=d.transpose().mmul(d)[0][0],g=p.div(m);p=u.transpose().mmul(g)[0][0],m=u.transpose().mmul(u)[0][0];var v=g.sub(u.clone().mul(p/m));v.div(o.norm(v));var y=r.mmul(v);p=r.transpose().mmul(y),m=y.transpose().mmul(y)[0][0];var w=p.div(m);r.sub(y.mmul(w.transpose())),c[f]=v.getColumn(0),l[f]=y.getColumn(0),h[f]=w.getColumn(0)}this.Xosc=r;var b=this.Xosc.clone().mul(this.Xosc).sum();this.R2X=1-b/s,this.W=c,this.T=l,this.P=h,this.numberOSC=n}var i=n(45),o=n(47);t.exports=r,r.prototype.correctDataset=function(t){for(var e=new i(t),n=e.clone().mul(e).sum(),r=0;r<this.numberOSC;r++){var o=this.W.getColumnVector(r),a=this.P.getColumnVector(r),s=e.mmul(o);e.sub(s.mmul(a))}return{datasetOsc:e,R2Dataset:1-e.clone().mul(e).sum()/n}}},function(t,n,r){"use strict";function i(t,e,n,r,i,a){n=o.updateClusterID(e,t,n,i.distanceFunction);var u=o.updateCenters(e,n,r),c=o.converged(u,t,i.distanceFunction,i.tolerance);return new s(n,u,c,a,i.distanceFunction)}var o=r(94),a=r(306),s=r(308),u={maxIterations:100,tolerance:1e-6,withIterations:!1,initialization:"mostDistant",distanceFunction:r(0).squared};t.exports=function(t,n,r){if(r=Object.assign({},u,r),0>=n||n>t.length||!m(n))throw new Error("K should be a positive integer bigger than the number of points");var s;if(Array.isArray(r.initialization)){if(r.initialization.length!==n)throw new Error("The initial centers should have the same length as K");s=r.initialization}else switch(r.initialization){case"random":s=a.random(t,n);break;case"mostDistant":s=a.mostDistant(t,n,o.calculateDistanceMatrix(t,r.distanceFunction));break;default:throw new Error('Unknown initialization method: "'+r.initialization+'"')}0===r.maxIterations&&(r.maxIterations=e);var c=Array(t.length);if(r.withIterations)return function*(t,e,n,r,o){for(var a,s=!1,u=0;!s&&u<o.maxIterations;)yield(a=i(t,e,n,r,o,++u)).computeInformation(e),s=a.converged,t=a.centroids}(s,t,c,n,r);for(var l,h=!1,f=0;!h&&f<r.maxIterations;)h=(l=i(s,t,c,n,r,++f)).converged,s=l.centroids;return l.computeInformation(t)}},function(n,r,i){"use strict";var o={distanceFunction:i(0).squared,similarityFunction:!1,returnVector:!1};n.exports=function(n,r,i){var a=(i=i||o).distanceFunction||o.distanceFunction,s=i.similarityFunction||o.similarityFunction,u=i.returnVector||o.returnVector,c=-1;if("function"==typeof s)for(var l,h=t,f=0;f<n.length;f++)(l=s(r,n[f]))>h&&(h=l,c=f);else{if("function"!=typeof a)throw new Error("A similarity or distance function it's required");for(var d,p=e,m=0;m<n.length;m++)(d=a(r,n[m]))<p&&(p=d,c=m)}return u?n[c]:c}},function(t,n,r){"use strict";var i=r(307).Picker;n.random=function(t,e){for(var n=new i(t),r=Array(e),o=0;o<e;++o)r[o]=n.pick();return r},n.mostDistant=function(t,n,r){var i=Array(n);if(i[0]=g(Math.random()*t.length),1<n){for(var o={dist:-1,index:-1},a=0;a<t.length;++a)r[i[0]][a]>o.dist&&(o.dist=r[i[0]][a],o.index=a);if(i[1]=o.index,2<n)for(var s,u=2;u<n;++u){s={dist:-1,index:-1};for(var c,l=0;l<t.length;++l){c={dist:e,index:-1};for(var h=0;h<u;++h)r[h][l]<c.dist&&-1===i.indexOf(l)&&(c={dist:r[h][l],index:l});c.dist!==e&&c.dist>s.dist&&(s=Object.assign({},c))}i[u]=s.index}}return i.map(e=>t[e])}},function(t){"use strict";(function(){var e;(e="undefined"!=typeof t&&t.exports?t.exports:this.RandomSelection={}).Picker=function(t){this._originalOptions=t,this._remainingOptions=[]},e.Picker.prototype={pick:function(){0===this._remainingOptions.length&&(this._remainingOptions=function(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n]);return e}(this._originalOptions));var t=g(Math.random()*this._remainingOptions.length);return this._remainingOptions.splice(t,1)[0]}}}).call(void 0)},function(t,e,n){"use strict";function r(t,e,n,r,i){this.clusters=t,this.centroids=e,this.converged=n,this.iterations=r,this[o]=i}var i=n(94),o=Symbol("distance");r.prototype.nearest=function(t){var e=Array(t.length),n=this.centroids.map(function(t){return t.centroid});return i.updateClusterID(t,n,e,this[o])},r.prototype.computeInformation=function(t){for(var e=this.centroids.map(function(t){return{centroid:t,error:0,size:0}}),n=0;n<t.length;n++)e[this.clusters[n]].error+=this[o](t[n],this.centroids[this.clusters[n]]),e[this.clusters[n]].size++;for(var i=0;i<this.centroids.length;i++)e[i].error/=e[i].size;return new r(this.clusters,e,this.converged,this.iterations,this[o])},t.exports=r},function(t,e,n){"use strict";e.agnes=n(310),e.diana=n(318)},function(t,e,n){"use strict";function r(t,e,n){for(var r=1e101,i=0;i<t.length;i++)for(var o=0;o<e.length;o++)r=v(n[t[i]][e[o]],r);return r}function i(t,e,n){for(var r=-1,i=0;i<t.length;i++)for(var o=0;o<e.length;o++)r=M(n[t[i]][e[o]],r);return r}function o(t,e,n){for(var r=0,i=0;i<t.length;i++)for(var o=0;o<e.length;o++)r+=n[t[i]][e[o]];return r/(t.length*e.length)}function a(t,e,n){for(var r=Array(t.length*e.length),i=0;i<t.length;i++)for(var o=0;o<e.length;o++)r[i*e.length+o]=n[t[i]][e[o]];return function(t,e){void 0===e&&(e=!1),e||(t=[].concat(t).sort(u));var n=t.length,r=g(n/2);return 0==n%2?.5*(t[r-1]+t[r]):t[r]}(r)}function s(t,e,n){return a(t,e,n)*t.length*e.length/(t.length+e.length)}function u(t,e){return t-e}var c=n(0),l=n(95),h=n(48),f=n(68),d={disFunc:c,kind:"single",isDistanceMatrix:!1};t.exports=function(t,e){e=Object.assign({},d,e);var n=t.length,u=t;if(e.isDistanceMatrix||(u=f(t,e.disFunc)),"string"==typeof e.kind)switch(e.kind){case"single":e.kind=r;break;case"complete":e.kind=i;break;case"average":e.kind=o;break;case"centroid":e.kind=a;break;case"ward":e.kind=s;break;default:throw new RangeError("Unknown kind of similarity")}else if("function"!=typeof e.kind)throw new TypeError("Undefined kind of similarity");for(var c=Array(n),p=0;p<u.length;p++)c[p]=new l(p);for(var m=1e6,g={},y=0;1<c.length;){g={},m=1e6;for(var w=0;w<c.length;w++)for(var b=w+1;b<c.length;b++){var x,_;if(c[w]instanceof l)x=[c[w].index];else{x=Array(c[w].index.length);for(var M=0;M<x.length;M++)x[M]=c[w].index[M].index}if(c[b]instanceof l)_=[c[b].index];else{_=Array(c[b].index.length);for(var E=0;E<_.length;E++)_[E]=c[b].index[E].index}(y=e.kind(x,_,u).toFixed(4))in g?g[y].push([c[w],c[b]]):g[y]=[[c[w],c[b]]],m=v(y,m)}for(var S,T=g[m.toFixed(4)],A=Array(T.length),k=0;0<T.length;){S=T.shift();for(var C=0;C<T.length;C++)if(0<T[C].filter(function(t){return-1!==S.indexOf(t)}).length){var R=T[C].filter(function(t){return-1===S.indexOf(t)});S=S.concat(R),T.splice(C--,1)}A[k++]=S}A.length=k;for(var D,L=0;L<A.length;L++){(D=new h).children=A[L].concat(),D.distance=m,D.index=Array(n);for(var O=0,P=0;P<A[L].length;P++)A[L][P]instanceof l?D.index[O++]=A[L][P]:(O+=A[L][P].index.length,D.index=A[L][P].index.concat(D.index)),c.splice(c.indexOf(A[L][P]),1);D.index.length=O,c.push(D)}}return c[0]}},function(t,e,n){"use strict";t.exports=n(312)},function(t,e){"use strict";var n,r;(function(){var i,o,a,s,u,c,l,h,f,d,p,m,y,w,b;a=g,d=v,o=function(t,e){return t<e?-1:t>e?1:0},f=function(t,e,n,r,i){var s;if(null==n&&(n=0),null==i&&(i=o),0>n)throw new Error("lo must be non-negative");for(null==r&&(r=t.length);n<r;)0>i(e,t[s=a((n+r)/2)])?r=s:n=s+1;return[].splice.apply(t,[n,n-n].concat(e)),e},c=function(t,e,n){return null==n&&(n=o),t.push(e),w(t,0,t.length-1,n)},u=function(t,e){var n,r;return null==e&&(e=o),n=t.pop(),t.length?(r=t[0],t[0]=n,b(t,0,e)):r=n,r},h=function(t,e,n){var r;return null==n&&(n=o),r=t[0],t[0]=e,b(t,0,n),r},l=function(t,e,n){var r;return null==n&&(n=o),t.length&&0>n(t[0],e)&&(e=(r=[t[0],e])[0],t[0]=r[1],b(t,0,n)),e},s=function(t,e){var n,r,i,s,u;for(null==e&&(e=o),i=(function(){u=[];for(var e=0,n=a(t.length/2);0<=n?e<n:e>n;0<=n?e++:e--)u.push(e);return u}).apply(this).reverse(),s=[],n=0,r=i.length;n<r;n++)s.push(b(t,i[n],e));return s},y=function(t,e,n){var r;if(null==n&&(n=o),-1!==(r=t.indexOf(e)))return w(t,0,r,n),b(t,r,n)},p=function(t,e,n){var r,i,a,u;if(null==n&&(n=o),!(r=t.slice(0,e)).length)return r;for(s(r,n),i=0,a=(u=t.slice(e)).length;i<a;i++)l(r,u[i],n);return r.sort(n).reverse()},m=function(t,e,n){var r,i,a,c,l,h,p,m,g;if(null==n&&(n=o),10*e<=t.length){if(!(a=t.slice(0,e).sort(n)).length)return a;for(i=a[a.length-1],c=0,h=(p=t.slice(e)).length;c<h;c++)0>n(r=p[c],i)&&(f(a,r,0,null,n),a.pop(),i=a[a.length-1]);return a}for(s(t,n),g=[],l=0,m=d(e,t.length);0<=m?l<m:l>m;0<=m?++l:--l)g.push(u(t,n));return g},w=function(t,e,n,r){var i,a,s;for(null==r&&(r=o),i=t[n];n>e&&0>r(i,a=t[s=n-1>>1]);)t[n]=a,n=s;return t[n]=i},b=function(t,e,n){var r,i,a,s,u;for(null==n&&(n=o),i=t.length,u=e,a=t[e],r=2*e+1;r<i;)(s=r+1)<i&&!(0>n(t[r],t[s]))&&(r=s),t[e]=t[r],r=2*(e=r)+1;return t[e]=a,w(t,u,e,n)},i=function(){function t(t){this.cmp=null==t?o:t,this.nodes=[]}return t.push=c,t.pop=u,t.replace=h,t.pushpop=l,t.heapify=s,t.updateItem=y,t.nlargest=p,t.nsmallest=m,t.prototype.push=function(t){return c(this.nodes,t,this.cmp)},t.prototype.pop=function(){return u(this.nodes,this.cmp)},t.prototype.peek=function(){return this.nodes[0]},t.prototype.contains=function(t){return-1!==this.nodes.indexOf(t)},t.prototype.replace=function(t){return h(this.nodes,t,this.cmp)},t.prototype.pushpop=function(t){return l(this.nodes,t,this.cmp)},t.prototype.heapify=function(){return s(this.nodes,this.cmp)},t.prototype.updateItem=function(t){return y(this.nodes,t,this.cmp)},t.prototype.clear=function(){return this.nodes=[]},t.prototype.empty=function(){return 0===this.nodes.length},t.prototype.size=function(){return this.nodes.length},t.prototype.clone=function(){var e;return(e=new t).nodes=this.nodes.slice(0),e},t.prototype.toArray=function(){return this.nodes.slice(0)},t.prototype.insert=t.prototype.push,t.prototype.top=t.prototype.peek,t.prototype.front=t.prototype.peek,t.prototype.has=t.prototype.contains,t.prototype.copy=t.prototype.clone,t}(),function(i,o){void 0!==(r="function"==typeof(n=o)?n.apply(e,[]):n)&&(t.exports=r)}(0,function(){return i})}).call(void 0)},function(t,e,n){"use strict";(function(t,r){function i(t,n){var r={seen:[],stylize:a};return 3<=arguments.length&&(r.depth=arguments[2]),4<=arguments.length&&(r.colors=arguments[3]),f(n)?r.showHidden=n:n&&e._extend(r,n),g(r.showHidden)&&(r.showHidden=!1),g(r.depth)&&(r.depth=2),g(r.colors)&&(r.colors=!1),g(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),s(r,t,r.depth)}function o(t,e){var n=i.styles[e];return n?"\x1b["+i.colors[n][0]+"m"+t+"\x1b["+i.colors[n][1]+"m":t}function a(t){return t}function s(t,n,r){if(t.customInspect&&n&&x(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return m(i)||(i=s(t,i,r)),i}var o=u(t,n);if(o)return o;var a=Object.keys(n),f=function(t){var e={};return a.forEach(function(t){e[t]=!0}),e}();if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),b(n)&&(0<=a.indexOf("message")||0<=a.indexOf("description")))return c(n);if(0===a.length){if(x(n))return t.stylize("[Function"+(n.name?": "+n.name:"")+"]","special");if(v(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return t.stylize(Date.prototype.toString.call(n),"date");if(b(n))return c(n)}var d,p="",g=!1,y=["{","}"];return h(n)&&(g=!0,y=["[","]"]),x(n)&&(p=" [Function"+(n.name?": "+n.name:"")+"]"),v(n)&&(p=" "+RegExp.prototype.toString.call(n)),w(n)&&(p=" "+Date.prototype.toUTCString.call(n)),b(n)&&(p=" "+c(n)),0!==a.length||g&&0!=n.length?0>r?v(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),d=g?function(t,e,n,r,i){for(var o=[],a=0,s=e.length;a<s;++a)E(e,a+"")?o.push(l(t,e,n,r,a+"",!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(l(t,e,n,r,i,!0))}),o}(t,n,r,f,a):a.map(function(e){return l(t,n,r,f,e,g)}),t.seen.pop(),function(t,e,n){return 60<t.reduce(function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}(d,p,y)):y[0]+p+y[1]}function u(t,e){if(g(e))return t.stylize("undefined","undefined");if(m(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return p(e)?t.stylize(""+e,"number"):f(e)?t.stylize(""+e,"boolean"):d(e)?t.stylize("null","null"):void 0}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function l(t,e,n,r,i,o){var a,u,c;if((c=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?u=t.stylize(c.set?"[Getter/Setter]":"[Getter]","special"):c.set&&(u=t.stylize("[Setter]","special")),E(r,i)||(a="["+i+"]"),u||(0>t.seen.indexOf(c.value)?-1<(u=d(n)?s(t,c.value,null):s(t,c.value,n-1)).indexOf("\n")&&(u=o?u.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+u.split("\n").map(function(t){return"   "+t}).join("\n")):u=t.stylize("[Circular]","special")),g(a)){if(o&&i.match(/^\d+$/))return u;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+u}function h(t){return Array.isArray(t)}function f(t){return"boolean"==typeof t}function d(t){return null===t}function p(t){return"number"==typeof t}function m(t){return"string"==typeof t}function g(t){return void 0===t}function v(t){return y(t)&&"[object RegExp]"===_(t)}function y(t){return"object"==typeof t&&null!==t}function w(t){return y(t)&&"[object Date]"===_(t)}function b(t){return y(t)&&("[object Error]"===_(t)||t instanceof Error)}function x(t){return"function"==typeof t}function _(t){return Object.prototype.toString.call(t)}function M(t){return 10>t?"0"+t.toString(10):t.toString(10)}function E(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var S=/%[sdj%]/g;e.format=function(t){if(!m(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(i(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,o=r.length,a=(t+"").replace(S,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return r[n++]+"";case"%d":return+r[n++];case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),s=r[n];n<o;s=r[++n])a+=d(s)||!y(s)?" "+s:" "+i(s);return a},e.deprecate=function(n,i){if(g(t.process))return function(){return e.deprecate(n,i).apply(this,arguments)};if(!0===r.noDeprecation)return n;var o=!1;return function(){if(!o){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation?console.trace(i):console.error(i),o=!0}return n.apply(this,arguments)}};var T,A={};e.debuglog=function(t){if(g(T)&&(T=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!A[t])if(new RegExp("\\b"+t+"\\b","i").test(T)){var n=r.pid;A[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else A[t]=function(){};return A[t]},e.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=h,e.isBoolean=f,e.isNull=d,e.isNullOrUndefined=function(t){return null==t},e.isNumber=p,e.isString=m,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=g,e.isRegExp=v,e.isObject=y,e.isDate=w,e.isError=b,e.isFunction=x,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t},e.isBuffer=n(316);var k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];e.log=function(){console.log("%s - %s",function(){var t=new Date,e=[M(t.getHours()),M(t.getMinutes()),M(t.getSeconds())].join(":");return[t.getDate(),k[t.getMonth()],e].join(" ")}(),e.format.apply(e,arguments))},e.inherits=n(317),e._extend=function(t,e){if(!e||!y(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(e,n(314),n(315))},function(t){"use strict";var e=function(){return this}();try{e=e||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(e=window)}t.exports=e},function(t){"use strict";function e(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function r(t){if(u===setTimeout)return setTimeout(t,0);if((u===e||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(e){try{return u.call(null,t,0)}catch(e){return u.call(this,t,0)}}}function i(){d&&h&&(d=!1,h.length?f=h.concat(f):p=-1,f.length&&o())}function o(){if(!d){var t=r(i);d=!0;for(var e=f.length;e;){for(h=f,f=[];++p<e;)h&&h[p].run();p=-1,e=f.length}h=null,d=!1,function(t){if(c===clearTimeout)return clearTimeout(t);if((c===n||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(t);try{c(t)}catch(e){try{return c.call(null,t)}catch(e){return c.call(this,t)}}}(t)}}function a(t,e){this.fun=t,this.array=e}function s(){}var u,c,l=t.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:e}catch(t){u=e}try{c="function"==typeof clearTimeout?clearTimeout:n}catch(t){c=n}}();var h,f=[],d=!1,p=-1;l.nextTick=function(t){var e=Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];f.push(new a(t,e)),1!==f.length||d||r(o)},a.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=s,l.addListener=s,l.once=s,l.off=s,l.removeListener=s,l.removeAllListeners=s,l.emit=s,l.prependListener=s,l.prependOnceListener=s,l.listeners=function(){return[]},l.binding=function(){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},function(t){"use strict";t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t){"use strict";t.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){"use strict";function r(t,e,n){for(var r=1e101,i=0;i<t.length;i++)for(var o,a=i;a<e.length;a++)o=n(t[i],e[a]),r=v(o,r);return r}function i(t,e,n){for(var r=-1,i=0;i<t.length;i++)for(var o,a=i;a<e.length;a++)o=n(t[i],e[a]),r=M(o,r);return r}function o(t,e,n){for(var r=0,i=0;i<t.length;i++)for(var o=0;o<e.length;o++)r+=n(t[i],e[o]);return r/(t.length*e.length)}function a(t,e,n){for(var r=0,i=0,o=0,a=0,s=0;s<t.length;s++)r+=t[s][0],i+=t[s][1];for(var u=0;u<e.length;u++)o+=e[u][0],a+=e[u][1];return n([r/=t.length,i/=t.length],[o/=e.length,a/=e.length])}function s(t,e,n){for(var r=0,i=0,o=0,a=0,s=0;s<t.length;s++)r+=t[s][0],i+=t[s][1];for(var u=0;u<e.length;u++)o+=e[u][0],a+=e[u][1];return n([r/=t.length,i/=t.length],[o/=e.length,a/=e.length])*t.length*e.length/(t.length+e.length)}function u(t,e,n){for(var r={d:0,p:0},i=Array(t[0].length),o=0;o<t[0].length;o++)i[o]=e[t[0][o]];for(var a=Array(t[1].length),s=0;s<t[1].length;s++)a[s]=e[t[1][s]];for(var u,c,l=0;l<i.length;l++){u=0;for(var h=0;h<i.length;h++)l!==h&&(u+=n(i[l],i[h]));u/=i.length-1,c=0;for(var f=0;f<a.length;f++)c+=n(i[l],a[f]);u-(c/=a.length)>r.d&&(r.d=u-c,r.p=l)}return r}function c(t,e,n){for(var r=0,i=0,o=0;o<t.length;o++)for(var a=o;a<t.length;a++)r+=n(e[t[o].index],e[t[a].index]),i++;return r/i}var l=n(0),h=n(95),f=n(48),d={dist:l,kind:"single"};t.exports=function(t,e){if("string"==typeof(e=Object.assign({},d,e)).kind)switch(e.kind){case"single":e.kind=r;break;case"complete":e.kind=i;break;case"average":e.kind=o;break;case"centroid":e.kind=a;break;case"ward":e.kind=s;break;default:throw new RangeError("Unknown kind of similarity")}else if("function"!=typeof e.kind)throw new TypeError("Undefined kind of similarity");var n=new f;n.children=Array(t.length),n.index=Array(t.length);for(var l=0;l<t.length;l++)n.children[l]=new h(l),n.index[l]=new h(l);n.distance=c(n.index,t,e.dist);for(var p,m,g,v,y,w=[n];0<w.length;){m=0,g=0;for(var b=0;b<w.length;b++){p=0;for(var x=0;x<w[b].length;x++)for(var _=x+1;_<w[b].length;_++)p=M(e.dist(t[w[b].index[x].index],t[w[b].index[_].index]),p);p>m&&(m=p,g=b)}if(m=0,2===w[g].index.length)w[g].children=[w[g].index[0],w[g].index[1]],w[g].distance=e.dist(t[w[g].index[0].index],t[w[g].index[1].index]);else if(3===w[g].index.length){w[g].children=[w[g].index[0],w[g].index[1],w[g].index[2]];var E=[e.dist(t[w[g].index[0].index],t[w[g].index[1].index]),e.dist(t[w[g].index[1].index],t[w[g].index[2].index])];w[g].distance=(E[0]+E[1])/2}else{for(var S=new f,T=new f,A=[Array(w[g].index.length),[]],k=0;k<A[0].length;k++)A[0][k]=k;for(var C=0;C<A[0].length;C++){v=0;for(var R=0;R<A[0].length;R++)C!==R&&(v+=e.dist(t[w[g].index[A[0][R]].index],t[w[g].index[A[0][C]].index]));(v/=A[0].length-1)>m&&(m=v,y=C)}for(A[1]=[y],A[0].splice(y,1),v=u(A,t,e.dist);0<v.d;)A[1].push(A[0][v.p]),A[0].splice(v.p,1),v=u(A,t,e.dist);var D=Array(A[0].length);S.index=Array(A[0].length);for(var L=0;L<D.length;L++)D[L]=t[w[g].index[A[0][L]].index],S.index[L]=w[g].index[A[0][L]],S.children[L]=w[g].index[A[0][L]];var O=Array(A[1].length);T.index=Array(A[1].length);for(var P=0;P<O.length;P++)O[P]=t[w[g].index[A[1][P]].index],T.index[P]=w[g].index[A[1][P]],T.children[P]=w[g].index[A[1][P]];S.distance=c(S.index,t,e.dist),T.distance=c(T.index,t,e.dist),w.push(S),w.push(T),w[g].children=[S,T]}w.splice(g,1)}return n}},function(e,t,i){"use strict";function n(t,e,n,r){for(var i in this.x=t,this.y=e,n=n||{},this.options={},p)this.options[i]=n.hasOwnProperty(i)?n[i]:p[i];if("number"==typeof this.options.fields)this.numWeights=this.options.fields;else{if(!Array.isArray(this.options.fields))throw new Error("Invalid fields definition");this.numWeights=this.options.fields.length;var o=s(this.options.fields);this.extractor=o.extractor,this.creator=o.creator}if("rect"===this.options.gridType)this.nodeType=d,this.gridDim={x:t,y:e};else{this.nodeType=h;var a=this.x-g(this.y/2);this.gridDim={x:a,y:this.y,z:-(0-a-this.y)}}if(this.torus=this.options.torus,this.distanceMethod=this.torus?"getDistanceTorus":"getDistance",this.distance=this.options.distance,this.maxDistance=m(this.distance,this.numWeights),!0!==r){if(!(0<t&&0<e))throw new Error("x and y must be positive");this.times={findBMU:0,adjust:0},this.randomizer=this.options.randomizer,this.iterationCount=0,this.iterations=this.options.iterations,this.startLearningRate=this.learningRate=this.options.learningRate,this.mapRadius=g(M(t,e)/2),this.algorithmMethod=this.options.method,this._initNodes(),this.done=!1}else this.done=!0}function s(t){for(var e=t.length,n=Array(e),r=Array(e),i=0;i<e;i++)n[i]=a(t[i].range),r[i]=c(t[i].range);return{extractor:function(r){for(var i=Array(e),o=0;o<e;o++)i[o]=n[o](r[t[o].name]);return i},creator:function(n){for(var i={},o=0;o<e;o++)i[t[o].name]=r[o](n[o]);return i}}}function a(t){return function(e){return(e-t[0])/(t[1]-t[0])}}function c(t){return function(e){return t[0]+e*(t[1]-t[0])}}function l(t,e){for(var n=0,r=0,i=t.length;r<i;r++)n+=(t[r]-e[r])*(t[r]-e[r]);return n}function u(t,e){return t[g(e()*t.length)]}function m(t,e){for(var n=Array(e),r=Array(e),i=0;i<e;i++)n[i]=0,r[i]=1;return t(n,r)}var d=i(96),h=i(320),p={fields:3,randomizer:Math.random,distance:l,iterations:10,learningRate:.1,gridType:"rect",torus:!0,method:"random"};n.load=function(e,t){if("SOM"===e.name){var o=e.data.length,s=e.data[0].length;t?e.options.distance=t:e.options.distance&&(e.options.distance=eval("("+e.options.distance+")"));var r=new n(o,s,e.options,!0);r.nodes=Array(o);for(var a=0;a<o;a++){r.nodes[a]=Array(s);for(var i=0;i<s;i++)r.nodes[a][i]=new r.nodeType(a,i,e.data[a][i],r)}return r}throw new Error("expecting a SOM model")},n.prototype.export=function(t){if(!this.done)throw new Error("model is not ready yet");for(var e={name:"SOM",options:{fields:this.options.fields,gridType:this.options.gridType,torus:this.options.torus},data:Array(this.x)},n=0;n<this.x;n++){e.data[n]=Array(this.y);for(var r=0;r<this.y;r++)e.data[n][r]=this.nodes[n][r].weights}return t&&(e.options.distance=this.distance.toString()),e},n.prototype._initNodes=function(){var t,e,n,r=Date.now();for(this.nodes=Array(this.x),t=0;t<this.x;t++)for(this.nodes[t]=Array(this.y),e=0;e<this.y;e++){var i=Array(this.numWeights);for(n=0;n<this.numWeights;n++)i[n]=this.randomizer();this.nodes[t][e]=new this.nodeType(t,e,i,this)}this.times.initNodes=Date.now()-r},n.prototype.setTraining=function(t){if(this.trainingSet)throw new Error("training set has already been set");var e,n=Date.now(),i=t,o=t.length;if(this.extractor)for(i=Array(o),e=0;e<o;e++)i[e]=this.extractor(t[e]);this.numIterations=this.iterations*o,this.timeConstant="random"===this.algorithmMethod?this.numIterations/r(this.mapRadius):o/r(this.mapRadius),this.trainingSet=i,this.times.setTraining=Date.now()-n},n.prototype.trainOne=function(){return!this.done&&(0<this.numIterations--?("random"===this.algorithmMethod?(t=this.mapRadius*o(-this.iterationCount/this.timeConstant),e=u(this.trainingSet,this.randomizer),this._adjust(e,t),this.learningRate=this.startLearningRate*o(-this.iterationCount/this.numIterations)):(n=-g(this.iterationCount/this.trainingSet.length),t=this.mapRadius*o(n/this.timeConstant),this._adjust(e=this.trainingSet[this.iterationCount%this.trainingSet.length],t),0==(this.iterationCount+1)%this.trainingSet.length&&(this.learningRate=this.startLearningRate*o(n/g(this.numIterations/this.trainingSet.length)))),this.iterationCount++,!0):(this.done=!0,!1));var t,e,n},n.prototype._adjust=function(t,e){var n,r,i,a,s=Date.now(),u=this._findBestMatchingUnit(t),c=Date.now();this.times.findBMU+=c-s;var l=g(e),h=u.x+l,f=u.y-l,d=u.y+l;for(n=u.x-l;n<=h;n++){var p=n;for(0>n?p+=this.x:n>=this.x&&(p-=this.x),r=f;r<=d;r++){var m=r;0>r?m+=this.y:r>=this.y&&(m-=this.y),(i=u[this.distanceMethod](this.nodes[p][m]))<e&&(a=o(-i/(2*e)),this.nodes[p][m].adjustWeights(t,this.learningRate,a))}}this.times.adjust+=Date.now()-c},n.prototype.train=function(t){if(!this.done)for(this.setTraining(t);this.trainOne(););},n.prototype.getConvertedNodes=function(){for(var t=Array(this.x),e=0;e<this.x;e++){t[e]=Array(this.y);for(var n,r=0;r<this.y;r++)n=this.nodes[e][r],t[e][r]=this.creator?this.creator(n.weights):n.weights}return t},n.prototype._findBestMatchingUnit=function(t){for(var e,n,r=1/0,i=0;i<this.x;i++)for(var o=0;o<this.y;o++)(n=this.distance(this.nodes[i][o].weights,t))<r&&(r=n,e=this.nodes[i][o]);return e},n.prototype.predict=function(t,e){if("boolean"==typeof t&&(e=t,t=null),t||(t=this.trainingSet),Array.isArray(t)&&(Array.isArray(t[0])||"object"==typeof t[0])){var n=this;return t.map(function(t){return n._predict(t,e)})}return this._predict(t,e)},n.prototype._predict=function(t,e){Array.isArray(t)||(t=this.extractor(t));var n=this._findBestMatchingUnit(t),r=[n.x,n.y];return e&&(r[2]=n.getPosition(t)),r},n.prototype.getQuantizationError=function(){for(var t=this.getFit(),e=t.length,n=0,r=0;r<e;r++)n+=t[r];return n/e},n.prototype.getFit=function(t){t||(t=this.trainingSet);for(var e,n=t.length,r=Array(n),i=0;i<n;i++)e=this._findBestMatchingUnit(t[i]),r[i]=R(this.distance(t[i],e.weights));return r},e.exports=n},function(t,e,n){"use strict";function r(t,e,n,r){i.call(this,t,e,n,r),this.hX=t-g(e/2),this.z=0-this.hX-e}var i=n(96);(r.prototype=new i).constructor=r,r.prototype.getDistance=function(t){return M(u(this.hX-t.hX),u(this.y-t.y),u(this.z-t.z))},r.prototype.getDistanceTorus=function(t){var e=u(this.hX-t.hX),n=u(this.y-t.y),r=u(this.z-t.z);return M(v(e,this.som.gridDim.x-e),v(n,this.som.gridDim.y-n),v(r,this.som.gridDim.z-r))},r.prototype.getPosition=function(){throw new Error("Unimplemented : cannot get position of the points for hexagonal grid")},t.exports=r},function(t,e,n){"use strict";var r=n(49),i=n(100),o=n(334),a=n(101),s=n(102);class u{constructor(t){if((t=t||{}).model){this.hiddenLayers=t.hiddenLayers,this.iterations=t.iterations,this.learningRate=t.learningRate,this.regularization=t.regularization,this.dicts=t.dicts,this.activation=t.activation,this.activationParam=t.activationParam,this.model=Array(t.layers.length);for(var e=0;e<this.model.length-1;++e)this.model[e]=i.load(t.layers[e]);this.model[this.model.length-1]=o.load(t.layers[this.model.length-1])}else this.hiddenLayers=void 0===t.hiddenLayers?[10]:t.hiddenLayers,this.iterations=void 0===t.iterations?50:t.iterations,this.learningRate=void 0===t.learningRate?.01:t.learningRate,this.regularization=void 0===t.regularization?.01:t.regularization,this.activation=void 0===t.activation?"tanh":t.activation,this.activationParam=void 0===t.activationParam?1:t.activationParam,this.activation in Object.keys(s)||(this.activation="tanh")}buildNetwork(t,e){var n=this.hiddenLayers.length-1+2;this.model=Array(n),this.model[0]=new i({inputSize:t,outputSize:this.hiddenLayers[0],activation:this.activation,activationParam:this.activationParam,regularization:this.regularization,epsilon:this.learningRate});for(var r=1;r<this.hiddenLayers.length;++r)this.model[r]=new i({inputSize:this.hiddenLayers[r-1],outputSize:this.hiddenLayers[r],activation:this.activation,activationParam:this.activationParam,regularization:this.regularization,epsilon:this.learningRate});this.model[n-1]=new o({inputSize:this.hiddenLayers[this.hiddenLayers.length-1],outputSize:e,activation:this.activation,activationParam:this.activationParam,regularization:this.regularization,epsilon:this.learningRate})}train(t,e){t=r.checkMatrix(t),this.dicts=a.dictOutputs(e);var n=t.columns,i=Object.keys(this.dicts.inputs).length;this.buildNetwork(n,i);for(var o,s=0;s<this.iterations;++s)o=this.propagate(t),this.backpropagation(t,e,o)}propagate(t){for(var e=t,n=0;n<this.model.length;++n)e=this.model[n].forward(e);return e.divColumnVector(a.sumRow(e))}backpropagation(t,e,n){for(var r=0;r<n.length;++r)n[r][this.dicts.inputs[e[r]]]-=1;var i=n;for(r=this.model.length-1;0<=r;--r)i=this.model[r].backpropagation(i,0<r?this.model[r-1].a:t);for(r=0;r<this.model.length;++r)this.model[r].update()}predict(t){t=r.checkMatrix(t);for(var e=Array(t.rows),n=this.propagate(t),i=0;i<t.rows;++i)e[i]=this.dicts.outputs[n.maxRowIndex(i)[1]];return e}toJSON(){for(var t={model:"FNN",hiddenLayers:this.hiddenLayers,iterations:this.iterations,learningRate:this.learningRate,regularization:this.regularization,activation:this.activation,activationParam:this.activationParam,dicts:this.dicts,layers:Array(this.model.length)},e=0;e<this.model.length;++e)t.layers[e]=this.model[e].toJSON();return t}static load(t){if("FNN"!==t.model)throw new RangeError("the current model is not a feed forward network");return new u(t)}}t.exports=u},function(){"use strict";Symbol.species||(Symbol.species=Symbol.for("@@species"))},function(t,e,n){"use strict";var r=n(22);t.exports=class extends r{constructor(t){super(t,t.columns,t.rows)}set(t,e,n){return this.matrix.set(e,t,n),this}get(t,e){return this.matrix.get(e,t)}}},function(t,e,n){"use strict";var r=n(22);t.exports=class extends r{constructor(t,e){super(t,1,t.columns),this.row=e}set(t,e,n){return this.matrix.set(this.row,e,n),this}get(t,e){return this.matrix.get(this.row,e)}}},function(t,e,n){"use strict";var r=n(22),i=n(31);t.exports=class extends r{constructor(t,e,n,r,o){i.checkRange(t,e,n,r,o),super(t,n-e+1,o-r+1),this.startRow=e,this.startColumn=r}set(t,e,n){return this.matrix.set(this.startRow+t,this.startColumn+e,n),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}}},function(t,e,n){"use strict";var r=n(22),i=n(31);t.exports=class extends r{constructor(t,e,n){var r=i.checkIndices(t,e,n);super(t,r.row.length,r.column.length),this.rowIndices=r.row,this.columnIndices=r.column}set(t,e,n){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],n),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}},function(t,e,n){"use strict";var r=n(22);t.exports=class extends r{constructor(t,e){super(t,t.rows,1),this.column=e}set(t,e,n){return this.matrix.set(t,this.column,n),this}get(t){return this.matrix.get(t,this.column)}}},function(t,e,n){"use strict";var r=n(22);t.exports=class extends r{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(this.rows-t-1,e,n),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}}},function(t,e,n){"use strict";var r=n(22);t.exports=class extends r{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(t,this.columns-e-1,n),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}}},function(t,e,n){"use strict";function r(t){return i(t=o.checkMatrix(t),o.eye(t.rows))}function i(t,e){return t=o.checkMatrix(t),e=o.checkMatrix(e),t.isSquare()?new u(t).solve(e):new c(t).solve(e)}var o=n(12).Matrix,a=n(99),s=n(331),u=n(98),c=n(332),l=n(333);o.inverse=o.inv=r,o.prototype.inverse=o.prototype.inv=function(){return r(this)},o.solve=i,o.prototype.solve=function(t){return i(this,t)},t.exports={SingularValueDecomposition:a,SVD:a,EigenvalueDecomposition:s,EVD:s,LuDecomposition:u,LU:u,QrDecomposition:c,QR:c,CholeskyDecomposition:l,CHO:l,inverse:r,solve:i}},function(t,e,n){"use strict";function r(t,e){if(e=Object.assign({},p,e),!(this instanceof r))return new r(t,e);if(!(t=l.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");var n,u,c=t.columns,h=d(c,c,0),f=Array(c),m=Array(c),g=t;if(e.assumeSymmetric||t.isSymmetric()){for(n=0;n<c;n++)for(u=0;u<c;u++)h[n][u]=g.get(n,u);i(c,m,f,h),o(c,m,f,h)}else{var v=d(c,c,0),y=Array(c);for(u=0;u<c;u++)for(n=0;n<c;n++)v[n][u]=g.get(n,u);a(c,v,y,h),s(c,m,f,h,v)}this.n=c,this.e=m,this.d=f,this.V=h}function i(t,e,n,r){var i,o,a,s,c,l,h,f;for(c=0;c<t;c++)n[c]=r[t-1][c];for(s=t-1;0<s;s--){for(f=0,a=0,l=0;l<s;l++)f+=u(n[l]);if(0===f)for(e[s]=n[s-1],c=0;c<s;c++)n[c]=r[s-1][c],r[s][c]=0,r[c][s]=0;else{for(l=0;l<s;l++)n[l]/=f,a+=n[l]*n[l];for(i=n[s-1],o=R(a),0<i&&(o=-o),e[s]=f*o,a-=i*o,n[s-1]=i-o,c=0;c<s;c++)e[c]=0;for(c=0;c<s;c++){for(r[c][s]=i=n[c],o=e[c]+r[c][c]*i,l=c+1;l<=s-1;l++)o+=r[l][c]*n[l],e[l]+=r[l][c]*i;e[c]=o}for(i=0,c=0;c<s;c++)e[c]/=a,i+=e[c]*n[c];for(h=i/(a+a),c=0;c<s;c++)e[c]-=h*n[c];for(c=0;c<s;c++){for(i=n[c],o=e[c],l=c;l<=s-1;l++)r[l][c]-=i*e[l]+o*n[l];n[c]=r[s-1][c],r[s][c]=0}}n[s]=a}for(s=0;s<t-1;s++){if(r[t-1][s]=r[s][s],r[s][s]=1,0!==(a=n[s+1])){for(l=0;l<=s;l++)n[l]=r[l][s+1]/a;for(c=0;c<=s;c++){for(o=0,l=0;l<=s;l++)o+=r[l][s+1]*r[l][c];for(l=0;l<=s;l++)r[l][c]-=o*n[l]}}for(l=0;l<=s;l++)r[l][s+1]=0}for(c=0;c<t;c++)n[c]=r[t-1][c],r[t-1][c]=0;r[t-1][t-1]=1,e[0]=0}function o(t,e,n,r){var i,o,a,s,c,l,h,d,p,m,g,v,y,w,b,x;for(a=1;a<t;a++)e[a-1]=e[a];e[t-1]=0;var _=0,E=0,S=2.220446049250313e-16;for(l=0;l<t;l++){for(E=M(E,u(n[l])+u(e[l])),h=l;h<t&&!(u(e[h])<=S*E);)h++;if(h>l)do{for(p=f(d=(n[l+1]-(i=n[l]))/(2*e[l]),1),0>d&&(p=-p),n[l]=e[l]/(d+p),n[l+1]=e[l]*(d+p),m=n[l+1],o=i-n[l],a=l+2;a<t;a++)n[a]-=o;for(_+=o,d=n[h],v=g=1,y=g,w=e[l+1],b=0,x=0,a=h-1;a>=l;a--)for(y=v,v=g,x=b,i=g*e[a],o=g*d,p=f(d,e[a]),e[a+1]=b*p,d=(g=d/p)*n[a]-(b=e[a]/p)*i,n[a+1]=o+b*(g*i+b*n[a]),c=0;c<t;c++)r[c][a+1]=b*r[c][a]+g*(o=r[c][a+1]),r[c][a]=g*r[c][a]-b*o;e[l]=b*(d=-b*x*y*w*e[l]/m),n[l]=g*d}while(u(e[l])>S*E);n[l]+=_,e[l]=0}for(a=0;a<t-1;a++){for(c=a,d=n[a],s=a+1;s<t;s++)n[s]<d&&(c=s,d=n[s]);if(c!==a)for(n[c]=n[a],n[a]=d,s=0;s<t;s++)d=r[s][a],r[s][a]=r[s][c],r[s][c]=d}}function a(t,e,n,r){var i,o,a,s,c,l,h,f=t-1;for(l=1;l<=f-1;l++){for(h=0,s=l;s<=f;s++)h+=u(e[s][l-1]);if(0!==h){for(a=0,s=f;s>=l;s--)n[s]=e[s][l-1]/h,a+=n[s]*n[s];for(o=R(a),0<n[l]&&(o=-o),a-=n[l]*o,n[l]-=o,c=l;c<t;c++){for(i=0,s=f;s>=l;s--)i+=n[s]*e[s][c];for(i/=a,s=l;s<=f;s++)e[s][c]-=i*n[s]}for(s=0;s<=f;s++){for(i=0,c=f;c>=l;c--)i+=n[c]*e[s][c];for(i/=a,c=l;c<=f;c++)e[s][c]-=i*n[c]}n[l]=h*n[l],e[l][l-1]=h*o}}for(s=0;s<t;s++)for(c=0;c<t;c++)r[s][c]=s===c?1:0;for(l=f-1;l>=1;l--)if(0!==e[l][l-1]){for(s=l+1;s<=f;s++)n[s]=e[s][l-1];for(c=l;c<=f;c++){for(o=0,s=l;s<=f;s++)o+=n[s]*r[s][c];for(o=o/n[l]/e[l][l-1],s=l;s<=f;s++)r[s][c]+=o*n[s]}}}function s(t,e,n,r,i){var o,a,s,l,h,f,d,p,m,g,y,w,b,x,_,E=t-1,S=t-1,T=2.220446049250313e-16,A=0,k=0,C=0,D=0,L=0,O=0,P=0,I=0;for(o=0;o<t;o++)for((o<0||o>S)&&(n[o]=i[o][o],e[o]=0),a=M(o-1,0);a<t;a++)k+=u(i[o][a]);for(;E>=0;){for(l=E;l>0&&(0===(O=u(i[l-1][l-1])+u(i[l][l]))&&(O=k),!(u(i[l][l-1])<T*O));)l--;if(l===E)i[E][E]+=A,n[E]=i[E][E],e[E]=0,E--,I=0;else if(l===E-1){if(P=R(u(D=(C=(i[E-1][E-1]-i[E][E])/2)*C+(d=i[E][E-1]*i[E-1][E]))),i[E][E]+=A,i[E-1][E-1]=i[E-1][E-1]+A,p=i[E][E],0<=D){for(n[E-1]=p+(P=0<=C?C+P:C-P),n[E]=n[E-1],0!==P&&(n[E]=p-d/P),e[E-1]=0,e[E]=0,C=(p=i[E][E-1])/(O=u(p)+u(P)),C/=L=R(C*C+(D=P/O)*D),D/=L,a=E-1;a<t;a++)i[E-1][a]=D*(P=i[E-1][a])+C*i[E][a],i[E][a]=D*i[E][a]-C*P;for(o=0;o<=E;o++)i[o][E-1]=D*(P=i[o][E-1])+C*i[o][E],i[o][E]=D*i[o][E]-C*P;for(o=0;o<=S;o++)r[o][E-1]=D*(P=r[o][E-1])+C*r[o][E],r[o][E]=D*r[o][E]-C*P}else n[E-1]=p+C,n[E]=p+C,e[E-1]=P,e[E]=-P;E-=2,I=0}else{if(p=i[E][E],m=0,d=0,l<E&&(m=i[E-1][E-1],d=i[E][E-1]*i[E-1][E]),10==I){for(A+=p,o=0;o<=E;o++)i[o][o]-=p;p=m=.75*(O=u(i[E][E-1])+u(i[E-1][E-2])),d=-.4375*O*O}if(30==I&&0<(O=(O=(m-p)/2)*O+d)){for(O=R(O),m<p&&(O=-O),O=p-d/((m-p)/2+O),o=0;o<=E;o++)i[o][o]-=O;A+=O,p=m=d=.964}for(++I,h=E-2;h>=l&&(C=((L=p-(P=i[h][h]))*(O=m-P)-d)/i[h+1][h]+i[h][h+1],D=i[h+1][h+1]-P-L-O,L=i[h+2][h+1],C/=O=u(C)+u(D)+u(L),D/=O,L/=O,h!==l)&&!(u(i[h][h-1])*(u(D)+u(L))<T*(u(C)*(u(i[h-1][h-1])+u(P)+u(i[h+1][h+1]))));)h--;for(o=h+2;o<=E;o++)i[o][o-2]=0,o>h+2&&(i[o][o-3]=0);for(s=h;s<=E-1&&(x=s!==E-1,s!==h&&(C=i[s][s-1],D=i[s+1][s-1],L=x?i[s+2][s-1]:0,0!==(p=u(C)+u(D)+u(L))&&(C/=p,D/=p,L/=p)),0!==p);s++)if(O=R(C*C+D*D+L*L),0>C&&(O=-O),0!==O){for(s===h?l!==h&&(i[s][s-1]=-i[s][s-1]):i[s][s-1]=-O*p,p=(C+=O)/O,m=D/O,P=L/O,D/=C,L/=C,a=s;a<t;a++)C=i[s][a]+D*i[s+1][a],x&&(i[s+2][a]=i[s+2][a]-(C+=L*i[s+2][a])*P),i[s][a]-=C*p,i[s+1][a]=i[s+1][a]-C*m;for(o=0;o<=v(E,s+3);o++)C=p*i[o][s]+m*i[o][s+1],x&&(i[o][s+2]=i[o][s+2]-(C+=P*i[o][s+2])*L),i[o][s]-=C,i[o][s+1]=i[o][s+1]-C*D;for(o=0;o<=S;o++)C=p*r[o][s]+m*r[o][s+1],x&&(r[o][s+2]=r[o][s+2]-(C+=P*r[o][s+2])*L),r[o][s]-=C,r[o][s+1]=r[o][s+1]-C*D}}}if(0!==k){for(E=t-1;0<=E;E--)if(C=n[E],0===(D=e[E]))for(l=E,i[E][E]=1,o=E-1;0<=o;o--){for(d=i[o][o]-C,L=0,a=l;a<=E;a++)L+=i[o][a]*i[a][E];if(0>e[o])P=d,O=L;else if(l=o,0===e[o]?i[o][E]=0===d?-L/(T*k):-L/d:(m=i[o+1][o],i[o][E]=f=((p=i[o][o+1])*O-P*L)/(D=(n[o]-C)*(n[o]-C)+e[o]*e[o]),i[o+1][E]=u(p)>u(P)?(-L-d*f)/p:(-O-m*f)/P),1<T*(f=u(i[o][E]))*f)for(a=o;a<=E;a++)i[a][E]/=f}else if(0>D)for(l=E-1,u(i[E][E-1])>u(i[E-1][E])?(i[E-1][E-1]=D/i[E][E-1],i[E-1][E]=-(i[E][E]-C)/i[E][E-1]):(_=c(0,-i[E-1][E],i[E-1][E-1]-C,D),i[E-1][E-1]=_[0],i[E-1][E]=_[1]),i[E][E-1]=0,i[E][E]=1,o=E-2;0<=o;o--){for(g=0,y=0,a=l;a<=E;a++)g+=i[o][a]*i[a][E-1],y+=i[o][a]*i[a][E];if(d=i[o][o]-C,0>e[o])P=d,L=g,O=y;else if(l=o,0===e[o]?(_=c(-g,-y,d,D),i[o][E-1]=_[0],i[o][E]=_[1]):(p=i[o][o+1],m=i[o+1][o],b=2*(n[o]-C)*D,0==(w=(n[o]-C)*(n[o]-C)+e[o]*e[o]-D*D)&&0===b&&(w=T*k*(u(d)+u(D)+u(p)+u(m)+u(P))),_=c(p*L-P*g+D*y,p*O-P*y-D*g,w,b),i[o][E-1]=_[0],i[o][E]=_[1],u(p)>u(P)+u(D)?(i[o+1][E-1]=(-g-d*i[o][E-1]+D*i[o][E])/p,i[o+1][E]=(-y-d*i[o][E]-D*i[o][E-1])/p):(_=c(-L-m*i[o][E-1],-O-m*i[o][E],P,D),i[o+1][E-1]=_[0],i[o+1][E]=_[1])),1<T*(f=M(u(i[o][E-1]),u(i[o][E])))*f)for(a=o;a<=E;a++)i[a][E-1]=i[a][E-1]/f,i[a][E]/=f}for(o=0;o<t;o++)if(o<0||o>S)for(a=o;a<t;a++)r[o][a]=i[o][a];for(a=t-1;a>=0;a--)for(o=0;o<=S;o++){for(P=0,s=0;s<=v(a,S);s++)P+=r[o][s]*i[s][a];r[o][a]=P}}}function c(t,e,n,r){var i,o;return u(n)>u(r)?[(t+(i=r/n)*e)/(o=n+i*r),(e-i*t)/o]:[((i=n/r)*t+e)/(o=r+i*n),(i*e-t)/o]}var l=n(12).Matrix,h=n(50),f=h.hypotenuse,d=h.getFilled2DArray,p={assumeSymmetric:!1};r.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return l.isMatrix(this.V)||(this.V=new l(this.V)),this.V},get diagonalMatrix(){var t,e,n=this.n,r=this.e,i=this.d,o=new l(n,n);for(t=0;t<n;t++){for(e=0;e<n;e++)o[t][e]=0;o[t][t]=i[t],0<r[t]?o[t][t+1]=r[t]:0>r[t]&&(o[t][t-1]=r[t])}return o}},t.exports=r},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);var e,n,a,s,u=(t=i.checkMatrix(t)).clone(),c=t.rows,l=t.columns,h=Array(l);for(a=0;a<l;a++){var f=0;for(e=a;e<c;e++)f=o(f,u[e][a]);if(0!==f){for(0>u[a][a]&&(f=-f),e=a;e<c;e++)u[e][a]/=f;for(u[a][a]+=1,n=a+1;n<l;n++){for(s=0,e=a;e<c;e++)s+=u[e][a]*u[e][n];for(s=-s/u[a][a],e=a;e<c;e++)u[e][n]+=s*u[e][a]}}h[a]=-f}this.QR=u,this.Rdiag=h}var i=n(12).Matrix,o=n(50).hypotenuse;r.prototype={solve:function(t){t=i.checkMatrix(t);var e=this.QR,n=e.rows;if(t.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var r,o,a,s,u=t.columns,c=t.clone(),l=e.columns;for(a=0;a<l;a++)for(o=0;o<u;o++){for(s=0,r=a;r<n;r++)s+=e[r][a]*c[r][o];for(s=-s/e[a][a],r=a;r<n;r++)c[r][o]+=s*e[r][a]}for(a=l-1;0<=a;a--){for(o=0;o<u;o++)c[a][o]/=this.Rdiag[a];for(r=0;r<a;r++)for(o=0;o<u;o++)c[r][o]-=c[a][o]*e[r][a]}return c.subMatrix(0,l-1,0,u-1)},isFullRank:function(){for(var t=this.QR.columns,e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0},get upperTriangularMatrix(){var t,e,n=this.QR,r=n.columns,o=new i(r,r);for(t=0;t<r;t++)for(e=0;e<r;e++)o[t][e]=t<e?n[t][e]:t===e?this.Rdiag[t]:0;return o},get orthogonalMatrix(){var t,e,n,r,o=this.QR,a=o.rows,s=o.columns,u=new i(a,s);for(n=s-1;0<=n;n--){for(t=0;t<a;t++)u[t][n]=0;for(u[n][n]=1,e=n;e<s;e++)if(0!==o[n][n]){for(r=0,t=n;t<a;t++)r+=o[t][n]*u[t][e];for(r=-r/o[n][n],t=n;t<a;t++)u[t][e]+=r*o[t][n]}}return u}},t.exports=r},function(t,e,n){"use strict";function r(t){if(!(this instanceof r))return new r(t);if(!(t=i.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");var e,n,o,a=t,s=a.rows,u=new i(s,s),c=!0;for(n=0;n<s;n++){var l=u[n],h=0;for(o=0;o<n;o++){var f=u[o],d=0;for(e=0;e<o;e++)d+=f[e]*l[e];l[o]=d=(a[n][o]-d)/u[o][o],h+=d*d}for(c&=0<(h=a[n][n]-h),u[n][n]=R(M(h,0)),o=n+1;o<s;o++)u[n][o]=0}if(!c)throw new Error("Matrix is not positive definite");this.L=u}var i=n(12).Matrix;r.prototype={get lowerTriangularMatrix(){return this.L},solve:function(t){t=i.checkMatrix(t);var e=this.L,n=e.rows;if(t.rows!==n)throw new Error("Matrix dimensions do not match");var r,o,a,s=t.columns,u=t.clone();for(a=0;a<n;a++)for(o=0;o<s;o++){for(r=0;r<a;r++)u[a][o]-=u[r][o]*e[a][r];u[a][o]/=e[a][a]}for(a=n-1;0<=a;a--)for(o=0;o<s;o++){for(r=a+1;r<n;r++)u[a][o]-=u[r][o]*e[r][a];u[a][o]/=e[a][a]}return u}},t.exports=r},function(t,e,n){"use strict";var r=n(100);class i extends r{constructor(t){super(t),this.activationFunction=function(t,e){this[t][e]=o(this[t][e])}}static load(t){if("Layer"!==t.model)throw new RangeError("the current model is not a Layer model");return new i(t)}}t.exports=i}])});