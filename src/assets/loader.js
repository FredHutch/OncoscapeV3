!function(e){var n={};function t(a){if(n[a])return n[a].exports;var r=n[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=n,t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:a})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=0)}([function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a={1:"Missense",2:"Silent",4:"Frame_Shift_Del",8:"Splice_Site",16:"Nonsense_Mutation",32:"Frame_Shift_Ins",64:"RNA",128:"In_Frame_Del",256:"In_Frame_Ins",512:"Nonstop_Mutation",1024:"Translation_Start_Site",2048:"De_novo_Start_OutOfFrame",4096:"De_novo_Start_InFrame",8192:"Intron",16384:"3'UTR",32768:"IGR",65536:"5'UTR",131072:"Targeted_Region",262144:"Read-through",524288:"5'Flank",1048576:"3'Flank",2097152:"Splice_Site_SNP",4194304:"Splice_Site_Del",8388608:"Splice_Site_Ins",16777216:"Indel",33554432:"R"},r="https://s3-us-west-2.amazonaws.com/notitia/tcga/",i=new Headers;i.append("Content-Type","application/json"),i.append("Accept-Encoding","gzip");var u={method:"GET",headers:i,mode:"cors",cache:"default"},o=((new Date).getTime(),function(e){var n=new Date;console.log(e+" : "+n.getMinutes()+":"+n.getSeconds())}),s=function(e){return e.name=e.name.replace(/ /gi,"").toLowerCase(),"clinical"===e.dataType||"patient"===e.dataType?d(e.name,e.file):"psmap"===e.dataType?m(e.name,e.file):"gistic_threshold"===e.dataType?f(e.name,e.file):"gistic"===e.dataType?l(e.name,e.file):"mut"===e.dataType?p(e.name,e.file):"rna"===e.dataType?h(e.name,e.file):"events"===e.dataType?c(e.name,e.file):null},c=function(e,n){return fetch(r+n+".gz",u).then(function(e){return o("Events Loaded"),e.json()}).then(function(n){o("Events Parsed");var t=Object.keys(n.map).reduce(function(e,t){return e.push({type:n.map[t],subtype:t}),e},[]),a=n.data.map(function(e){return Object.assign({p:e[0],start:e[2],end:e[3],data:e[4]},t[e[1]])});return o("Events Processed"),new Promise(function(n,t){n([{tbl:e,data:a}])})})},d=function(e,n){return o("Clinical Requested"),fetch(r+n+".gz",u).then(function(e){return o("Clinical Loaded"),e.json()}).then(function(e){o("Clinical Parsed");var n=Object.keys(e.fields).map(function(n,t){return{ctype:2,key:n,label:n.replace(/_/gi," "),tbl:"patient",type:Array.isArray(e.fields[n])?"STRING":"NUMBER",values:e.fields[n]}}),t=e.ids.map(function(t,a){return n.reduce(function(n,t,r){var i=e.values[a][r];return n[t.key]="NUMBER"===t.type?i:t.values[i],n},{p:t})});return o("Clinical Processed"),new Promise(function(e,n){e([{tbl:"patient",data:t}])})})},f=function(e,n){return o("Gistic Threshold Requested"),fetch(r+n+".gz",u).then(function(e){return o("Gistic Threshold Loaded"),e.json()}).then(function(n){o("Gistic Threshold Parsed");var t=n.ids.map(function(e,n){return{i:n,s:e}}),a=n.values.map(function(e,t){var a=e.reduce(function(e,n){return e.min=Math.min(e.min,n),e.max=Math.max(e.max,n),e.mean+=n,e},{m:n.genes[t],d:e,min:1/0,max:-1/0,mean:0});return a.mean/=e.length,a});return o("Gistic Threshold Processed"),new Promise(function(n,r){n([{tbl:e,data:a},{tbl:e+"Map",data:t}])})})},l=function(e,n){return o("Gistic Requested"),fetch(r+n+".gz",u).then(function(e){return o("Gistic Loaded"),e.json()}).then(function(n){o("Gistic Parsed");var t=n.ids.map(function(e,n){return{i:n,s:e}}),a=n.values.map(function(e,t){var a=e.reduce(function(e,n){return e.min=Math.min(e.min,n),e.max=Math.max(e.max,n),e.mean+=n,e},{m:n.genes[t],d:e,min:1/0,max:-1/0,mean:0});return a.mean/=e.length,a});return o("Gistic Processed"),new Promise(function(n,r){n([{tbl:e,data:a},{tbl:e+"Map",data:t}])})})},m=function(e,n){return fetch(r+n+".gz",u).then(function(e){return o("PS Map Loaded"),e.json()}).then(function(e){o("Patient Sample Map Parsed");var n=Object.keys(e).reduce(function(n,t){return e[t].forEach(function(e){n.push({p:t,s:e})}),n},[]);return o("Patient Sample Map Processed"),new Promise(function(e,t){e([{tbl:"patientSampleMap",data:n}])})})},p=function(e,n){return o("Mutation Requested"),fetch(r+n+".gz",u).then(function(e){return o("Mutation Loaded"),e.json()}).then(function(e){o("Mutation Parsed");var n=e.ids,t=e.genes,r=a,i=Object.keys(r),u=e.values.map(function(e){return e.split("-").map(function(e){return parseInt(e,10)}).map(function(e,a){return 0===a?t[e]:1===a?n[e]:e})}).reduce(function(e,n){return e.push.apply(e,i.filter(function(e){return parseInt(e,10)&n[2]}).map(function(e){return{m:n[0],s:n[1],t:r[e]}})),e},[]);return o("Mutation Processed"),new Promise(function(e,n){e([{tbl:"mut",data:u}])})})},h=function(e,n){return o("RNA Requested"),fetch(r+n+".gz",u).then(function(e){return o("RNA Loaded"),e.json()}).then(function(n){o("RNA Parsed");var t=n.ids.map(function(e,n){return{i:n,s:e}}),a=n.values.map(function(e,t){var a=e.reduce(function(e,n){return e.min=Math.min(e.min,n),e.max=Math.max(e.max,n),e.mean+=n,e},{m:n.genes[t],d:e,min:1/0,max:-1/0,mean:0});return a.mean/=e.length,a});return o("RNA Processed"),new Promise(function(n,r){n([{tbl:e,data:a},{tbl:e+"Map",data:t}])})})};onmessage=function(e){var n=self;switch(e.data.cmd){case"load":s(e.data.file).then(function(e){n.postMessage(JSON.stringify(e))})}}}]);